# 前言

现代移动设备是一台功能强大的设备。技术已经发展到这样的程度，当前一代的手机和平板电脑能够运行图形和声音都令人印象深刻的游戏和应用，甚至可以与家用游戏机和电脑上的游戏相媲美。

然而，编写能够在众多可用设备上运行的游戏是困难的。有许多不同的平台需要支持（例如，Android 和 iOS），并且每个平台都可以有在能力和处理能力方面有很大差异的设备。

这就是 Marmalade SDK 发挥作用的地方！Marmalade 是一个跨平台解决方案，它允许我们用 C++（大多数视频游戏开发者已经熟悉的语言）编写一次视频游戏的源代码，然后将其部署到包括 iOS、Android 和 BlackBerry PlayBook 在内的多个平台。

在本书中，我们将学习如何使用 Marmalade SDK 来实现现代移动视频游戏所需的所有功能。

# 本书涵盖的内容

第一章, *Marmalade 入门*: 我们通过学习如何安装 SDK 并构建一个简单的“Hello World”应用程序开始我们的 Marmalade SDK 之旅。然后我们将发现如何部署和运行最终程序到多个不同的移动平台。

第二章, *资源管理和 2D 图形渲染*: 大多数视频游戏都是媒体丰富的体验，充满了出色的图形和惊人的音效和音乐。在本章中，我们首先将探讨 Marmalade 如何通过使用内置的资源管理系统使我们能够轻松地将图形和其他资源加载到内存中。然后我们将发现如何在屏幕上渲染简单的二维图形。

第三章, *用户输入*: 我们的游戏需要允许用户提供输入来控制动作；因此，在本章中，我们将探讨如何响应键盘、触摸屏和加速度计输入。

第四章, *3D 图形渲染*: 移动设备现在配备了图形处理单元，这使得它们能够轻松渲染美丽的 3D 图形。在简要概述 3D 渲染的基本原理之后，我们将学习如何使用 Marmalade 渲染一个旋转的立方体，首先是通过在代码中生成 3D 模型数据，然后通过发现我们如何可以使用 3D 建模软件包创建和导出可以在 Marmalade 应用程序中加载和绘制的 3D 模型。

第五章, *动画 3D 图形*: 在前一章的基础上，我们将介绍如何通过使 3D 图形动画化来使其更有趣。

第六章，*实现字体、用户界面和本地化*：在用户甚至能够玩我们的游戏的第一关之前，他们首先需要导航其菜单系统。本章涵盖了 Marmalade 对字体渲染的支持、用户界面可以构建的方式，并以查看如何本地化游戏以支持多种语言结束。

第七章，*添加声音和视频*：声音和音乐都是视频游戏非常重要的方面，可以使游戏感觉更加沉浸和刺激，因此学习如何将这些元素添加到游戏中是本章的主要目标。Marmalade 还允许我们显示全动作视频剪辑，因此我们也会简要地看看这一点。

第八章，*支持广泛的设备*：不同的移动设备具有不同的功能，在主要处理器和图形渲染能力方面也可能有所不同。在本章中，我们将探讨 Marmalade 如何通过允许我们的游戏适应其运行的硬件，帮助我们支持尽可能广泛的设备。我们还将查看使用 Marmalade 内置的压缩和解压缩文件支持来减小游戏安装包大小的功能。

第九章，*添加社交媒体和其他在线服务*：由于大多数设备现在都永久连接到互联网，本章探讨了我们可以添加到我们的游戏中的在线功能的一些选项，从与 Facebook 集成到显示广告作为可能的收入来源。

第十章扩展 Marmalade")，*使用扩展开发工具包(EDK)扩展 Marmalade*：虽然 Marmalade SDK 在标准化编写视频游戏的大部分正常要求方面做得很好，例如显示图形或播放声音，但有时会出现需要访问 Marmalade 不支持直接的功能的设备功能。本章展示了我们如何访问 Windows、iOS 和 Android 上的底层 SDK，以便访问我们否则无法访问的设备功能。

# 你需要这本书的东西

为了充分利用本书的内容，你需要以下几样东西：

+   至少 1GB RAM 的互联网连接 PC，运行 Windows XP Service Pack 2、Vista 或 Windows 7

+   Microsoft Visual Studio 2005/2008/2010（C++ Express 版本适合此用途）

+   Marmalade SDK 的授权副本

第一章将解释如何安装合适的 Microsoft Visual Studio 版本，以及如何获取 Marmalade 并为其购买许可证。

对于制作 iOS 部署，你还需要注册 Apple 的 iOS 开发者计划；有关此内容的更多详细信息也提供在第一章中。

对于 3D 图形章节，如果你有支持的建模软件包，那将是有益的。Marmalade 直接支持 Autodesk 3DS Max 和 Autodesk Maya，但一个更便宜的替代方案是开源的 Blender 软件包。

# 本书面向对象

本书旨在向您展示如何使用 Marmalade 来实现视频游戏所需的功能。它不是编写视频游戏的指南，尽管本书提供了与每个章节同步增长的简单游戏的示例代码。

由于 Marmalade SDK 是用 C++实现的，因此你预计已经能够编写这种编程语言。

你还应该对涉及 2D 和 3D 图形渲染的概念有实际了解。相关章节提供了简要概述，但它们仅作为复习和介绍书中后续部分使用的术语。

# 惯例

在这本书中，你会发现许多不同风格的文本，用于区分不同类型的信息。以下是一些这些风格的示例，以及它们含义的解释。

文本中的代码词汇将如下所示：“用于`platform`的值通常是操作系统的名称。”

代码块将以如下方式设置：

```swift
{OS=IPHONE}
Message="Hello iOS!"
{}
{OS=QNX}
Message="Hello BlackBerry!"
{}
```

当我们希望引起你对代码块中特定部分的注意时，相关的行或项目将以粗体显示：

```swift
{OS=IPHONE}
Message="Hello iOS!"
{}
{OS=QNX}
Message="Hello BlackBerry!"
{}
```

任何命令行输入或输出将如下所示：

```swift
C:\PlayBook> blackberry-debugtokenrequest -cskpass <password> -keystoresigtool.p12 -storepass <password> -deviceId 0x<device id> debugtoken.bar

```

**新术语**和**重要词汇**将以粗体显示。你在屏幕上看到的，例如在菜单或对话框中的文字，将以如下方式显示：“”

### 注意

警告或重要注意事项将以如下方式显示。

### 小贴士

小贴士和技巧将以如下方式显示。

# 读者反馈

我们欢迎读者的反馈。告诉我们你对这本书的看法——你喜欢什么或可能不喜欢什么。读者反馈对我们开发你真正能从中获得最大收益的标题非常重要。

要向我们发送一般反馈，只需发送电子邮件到`<feedback@packtpub.com>`，并在邮件主题中提及书名。

如果你在一个领域有专业知识，并且你对撰写或为书籍做出贡献感兴趣，请参阅我们的作者指南[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在你已经是 Packt 书籍的骄傲拥有者，我们有一些事情可以帮助你从购买中获得最大收益。

## 下载示例代码

您可以从[`www.PacktPub.com`](http://www.PacktPub.com)的账户下载您购买的所有 Packt 书籍的示例代码文件。如果您在其他地方购买了这本书，您可以访问[`www.PacktPub.com/support`](http://www.PacktPub.com/support)并注册，以便直接将文件通过电子邮件发送给您。

## 下载本书彩色图像

我们还为您提供了一个包含本书中使用的截图/图表彩色图像的 PDF 文件。彩色图像将帮助您更好地理解输出的变化。您可以从[`www.packtpub.com/sites/default/files/downloads/3363OT_images.pdf`](http://www.packtpub.com/sites/default/files/downloads/3363OT_images.pdf)下载此文件。

## 错误清单

尽管我们已经尽一切努力确保我们内容的准确性，但错误仍然可能发生。如果您在我们的某本书中找到错误——可能是文本或代码中的错误——如果您能向我们报告这一点，我们将不胜感激。通过这样做，您可以节省其他读者的挫败感，并帮助我们改进本书的后续版本。如果您发现任何错误清单，请通过访问[`www.packtpub.com/support`](http://www.packtpub.com/support)，选择您的书籍，点击**错误提交表单**链接，并输入您的错误详细信息来报告它们。一旦您的错误得到验证，您的提交将被接受，错误将被上传到我们的网站，或添加到该标题的错误清单中。任何现有的错误清单都可以通过从[`www.packtpub.com/support`](http://www.packtpub.com/support)选择您的标题来查看。

## 盗版

网络上版权材料的盗版是一个持续存在的问题，涉及所有媒体。在 Packt，我们非常重视我们版权和许可证的保护。如果您在互联网上发现我们作品的任何非法副本，无论形式如何，请立即提供位置地址或网站名称，以便我们可以追究补救措施。

请通过链接<mailto:copyright@packtpub.com>与我们联系，并提供涉嫌盗版材料的链接。

我们感谢您在保护我们作者和我们为您提供有价值内容的能力方面的帮助。

## 咨询

如果您在本书的任何方面遇到问题，可以通过链接<mailto:questions@packtpub.com>与我们联系，我们将尽力解决。
