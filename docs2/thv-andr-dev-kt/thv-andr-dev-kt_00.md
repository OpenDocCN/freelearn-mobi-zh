# 前言

作为一名 Android 开发者，我认为自己很荣幸能成为这样一个社区的一员，这个社区有能力触及并改善全球用户的日常生活。Android 开发不仅仅是编写代码；它还关乎创造能够引起共鸣、激发灵感和以有意义方式连接人们的体验。我必须承认，我对 Android 开发的热情源于我们作为开发者对个人和社区产生的深远影响。

Android 社区是一个充满活力和动态的生态系统，以创新、协作和对卓越不懈追求为特点。从简单的应用早期到今天功能丰富的复杂应用，Android 开发者不断推动着可能性的边界。这本书是对这种创新精神的致敬。它旨在帮助你积累构建对用户真正有价值的应用程序所需的技术和知识。

无论你是在创建消息应用、社交网络平台还是视频流媒体服务（正如本书所做的那样），Android 开发的核心理念保持不变——对质量的承诺、对用户体验的关注以及学习和适应的渴望。当你开始这段旅程时，请记住，你是一个全球开发者社区的一员，你们有着共同的激情和奉献。我们一起可以继续创新，并创建出对世界产生影响的优秀应用。

# 这本书面向的对象

如果你是一名中级 Android 工程师，这本书适合你，因为它将教你如何解决在实际应用中出现的各种问题，并可作为你日常工作的参考。这本书也可以帮助初级工程师，因为它将开始让他们接触复杂问题及其最佳解决方案。

对 Android 和 Kotlin 概念有基本了解将大有裨益，例如视图（Views）、活动（Activities）、生命周期（lifecycles）和 Kotlin 协程（Kotlin coroutines）。

# 这本书涵盖的内容

在*第一章*《为您的消息应用构建 UI》中，你将开始构建 WhatsPackt 消息应用，重点关注做出关键技术决策和创建开发所需的结构。本章将指导你定义应用的结构和导航，设置和组织模块，以及选择依赖注入框架。你还将通过 Jetpack Navigation 和 Jetpack Compose 获得实际操作经验，以构建主屏幕、聊天列表和消息列表，为应用的用户界面打下坚实的基础。

在*第二章*《设置 WhatsPackt 的通讯能力》中，您将探索如何使用 WebSockets 将 WhatsPackt 通讯应用连接到后端服务器，实现实时一对一的对话。本章涵盖了建立 WebSocket 连接、在 ViewModel 中处理消息以及实施最佳实践来更新用户界面和管理消息存储。此外，您还将学习如何管理同步和错误处理，并实现推送通知以提醒用户有新消息。到本章结束时，您将全面了解创建强大通讯系统所需的基本技术。

在*第三章*《备份您的 WhatsPackt 消息》中，您将专注于 WhatsPackt 通讯应用中的数据处理和持久性，确保消息被正确存储并且可以快速检索，即使在设备故障或意外删除的情况下。本章介绍了 Room，一个简化 Android 数据库管理的持久性库，并指导您了解其架构和实现。您还将学习创建有效的缓存机制，为 Firebase 设置和安全的云存储进行备份，并使用 WorkManager 安排异步任务，确保您的聊天数据的安全和可靠性。到本章结束时，您将为您的通讯应用拥有一个强大的数据持久性策略。

在*第四章*《构建 Packtagram UI》中，您将从设置一个健壮的项目结构、定义文件层次结构和模块开始创建 Packtagram，一个类似 Instagram 的社交网络应用。本章涵盖了项目组织的基本方面和选择合适的架构模式以实现可扩展性。然后，您将开发用户友好的新闻源和故事界面，确保无缝的导航和交互。此外，您还将学习如何使用 Retrofit 和 Moshi 从服务器检索数据，并实施有效的数据缓存策略，通过减少网络调用来提高性能和用户体验。

在*第五章*《使用 CameraX 创建照片编辑器》中，您将通过集成 CameraX，一个用于无缝拍照和编辑的强大工具，来增强 Packtagram 应用。本章将指导您实现 CameraX，以改变摄影体验，使用户能够通过直观的编辑工具调整和个性化他们的照片。此外，您还将探索使用机器学习来识别照片主题并建议相关标签，为应用的功能添加智能层。

在*第六章*，*将视频和编辑功能添加到 Packtagram 中*，您将通过集成视频功能来提升 Packtagram 应用的功能，将其转变为一个综合的多媒体平台。本章涵盖了使用 CameraX 库捕获高质量视频，并使用 FFmpeg 处理添加字幕和滤镜等任务。您还将学习如何高效地将视频上传到 Firebase 的云存储，确保大文件处理的流畅性和用户体验的改善。到本章结束时，您将显著丰富 Packtagram，使其成为一个适用于照片和视频分享的多功能平台。

在*第七章*，*启动视频流应用并添加身份验证*，您将开始创建 Packtflix 视频流应用，重点关注多媒体内容交付和用户身份验证。本章从从头开始设置项目结构和模块开始。您将使用 OAuth2 实现强大的用户身份验证，以确保对账户和个人偏好的安全访问。在身份验证之后，您将使用 Jetpack Compose 构建动态和响应式的列表来展示电影，并为每部电影或系列创建详细的屏幕，为用户提供所有必要的信息。到本章结束时，您将为您的流应用打下坚实的基础。

在*第八章*，*使用 ExoPlayer 将媒体播放添加到 Packtflix 中*，您将通过集成 ExoPlayer 强大的视频播放功能来增强 Packtflix 应用，ExoPlayer 是一个提供广泛定制和多种媒体格式支持的通用库。本章从概述 Android 中的媒体选项开始，强调 ExoPlayer 的优势。您将学习 ExoPlayer 的基础知识，包括其架构和关键组件，以及如何将其集成到您的应用中。随后，您将创建一个响应式的视频播放用户界面，管理播放控制，并调整视频质量。此外，您还将添加字幕以确保可访问性，通过高质量的视频内容丰富用户体验。

在*第九章*，*扩展 Packtflix 应用中的视频播放功能*，您将通过扩展视频播放功能来扩展 Packtflix 应用的能力，重点关注**画中画**（**PiP**）模式和媒体投射。本章将指导您创建一个覆盖在其他应用之上的小型视频播放器，使用户在多任务处理时可以继续观看。此外，您还将学习使用 MediaRouter 和 Cast SDK 将视频播放传输到更大的屏幕，例如带有 Google Chromecast 的电视。到本章结束时，您将深刻理解 PiP 功能和媒体投射，显著提升您的 Android 应用的用户体验。

# 为了充分利用这本书

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Android Studio Jellyfish &#124; 2023.3.1 | Windows, macOS, 或 Linux |

您需要在您的计算机上安装 Android Studio，因为它是本章中使用的首选开发环境。此外，建议您对 Git 有基本的了解，因为您将需要它来下载和管理书中提供的代码仓库。

**如果您正在使用这本书的数字版，我们建议您自己输入代码或从书的 GitHub 仓库（下一节中提供链接）获取代码。这样做将帮助您避免与代码的复制和粘贴相关的任何潜在错误。**

# 下载示例代码文件

您可以从 GitHub 下载这本书的示例代码文件[`github.com/PacktPublishing/Thriving-in-Android-Development-using-Kotlin`](https://github.com/PacktPublishing/Thriving-in-Android-Development-using-Kotlin)。如果代码有更新，它将在 GitHub 仓库中更新。

我们还提供来自我们丰富的图书和视频目录的其他代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“例如，在`:app`模块的`build.gradle`文件中，在`dependencies`部分包含以下代码。”

代码块设置如下：

```java
class MessagesRepository @Inject constructor(    private val dataSource: MessagesSocketDataSource ): IMessagesRepository {    override suspend fun getMessages(): Flow<Message> {        return dataSource.connect()    }
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```java
Scaffold(
    topBar = {
        TopAppBar(
            title = {
               Text(stringResource(R.string.chat_title,
               uiState.name.orEmpty()))
            }
        )
    },
```

**粗体**：表示新术语、重要单词或您在屏幕上看到的单词。例如，菜单或对话框中的单词以**粗体**显示。以下是一个示例：“Android Studio 将为我们提供一系列模板以开始。我们将选择**Empty Activity**选项，如下面的截图所示：”

小贴士或重要提示

看起来像这样。

# 联系我们

欢迎读者反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请通过电子邮件发送至 customercare@packtpub.com，并在邮件主题中提及书名。

**勘误表**：尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，如果您能向我们报告，我们将不胜感激。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**：如果你在互联网上以任何形式遇到我们作品的非法副本，如果你能提供位置地址或网站名称，我们将不胜感激。请通过 copyright@packtpub.com 与我们联系，并提供材料的链接。

**如果你有兴趣成为作者**：如果你在某个领域有专业知识，并且对撰写或参与一本书籍感兴趣，请访问 [authors.packtpub.com.](http://authors.packtpub.com.)

# 分享你的想法

一旦你阅读了《使用 Kotlin 在 Android 开发中茁壮成长》，我们很乐意听听你的想法！请 [点击此处直接进入此书的亚马逊评论页面](https://packt.link/r/1-837-63129-8) 并分享你的反馈。

你的评论对我们和科技社区都很重要，并将帮助我们确保我们提供高质量的内容。

# 下载此书的免费 PDF 副本

感谢您购买此书！

你喜欢在旅途中阅读，但无法随身携带你的印刷书籍吗？

你的电子书购买是否与你的选择设备不兼容？

不要担心，现在，每当你购买 Packt 书籍时，你都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何设备上阅读。直接从你最喜欢的技术书籍中搜索、复制和粘贴代码到你的应用程序中。

优惠远不止于此，你还可以获得独家折扣、时事通讯和每日免费内容的每日电子邮件。

按照以下简单步骤获取优惠：

1.  扫描下面的二维码或访问以下链接

![](img/B19443_QR_Free_PDF.jpg)

[`packt.link/free-ebook/9781837631292`](https://packt.link/free-ebook/9781837631292)

1.  提交你的购买证明

1.  就这样！我们将直接将你的免费 PDF 和其他优惠发送到你的电子邮件。
