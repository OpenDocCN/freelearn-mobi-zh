- en: Chapter 9. Handling Multiple Devices and Networking your Apps
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第九章. 处理多个设备和应用的网络连接
- en: Allowing your application to integrate with social networks is a great way to
    promote your finished product. Many games enable the player to upload their high
    scores and share them among other users playing the same title. Some provide challenges
    that need to be completed successfully in order to unlock achievements. Social
    networks enhance the gaming experience and provide great exposure for the developer.
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 允许您的应用程序集成到社交网络中是推广您最终产品的一个好方法。许多游戏允许玩家上传他们的高分，并与玩相同游戏的用户分享。一些游戏提供需要成功完成的挑战，以解锁成就。社交网络增强了游戏体验，并为开发者提供了很好的曝光。
- en: We'll also go into more detail about build configuration since we're getting
    more accustomed to programming. Understanding the importance of configuring your
    device builds is mandatory for cross-platform development. This is a capability
    that Corona SDK can handle with ease across iOS and Android devices.
  id: totrans-2
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 我们还将更详细地介绍构建配置，因为我们越来越习惯于编程。了解配置您的设备构建的重要性对于跨平台开发是强制性的。这是 Corona SDK 可以轻松处理
    iOS 和 Android 设备的能力。
- en: 'In this chapter, we will learn the following topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将学习以下主题：
- en: Revisiting configuration settings
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 重新访问配置设置
- en: Posting messages to Twitter
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发布 Twitter 消息
- en: Posting messages to Facebook
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发布 Facebook 消息
- en: Adding achievements and leaderboards with OpenFeint
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 OpenFeint 添加成就和排行榜
- en: Let's add in these finishing touches!
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们添加这些最后的修饰吧！
- en: Return to configuration
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 返回配置
- en: Build settings and runtime configuration were briefly discussed in [Chapter
    2](ch02.html "Chapter 2. Lua Crash Course and the Corona Framework"), *Lua Crash
    Course and the Corona Framework*. Let's get into more specific details on handling
    a variety of devices on the iOS and Android platform.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第二章](ch02.html "第二章。Lua 快速入门和 Corona 框架")中简要讨论了构建设置和运行时配置，即《Lua 快速入门和 Corona
    框架》。现在让我们更具体地探讨在 iOS 和 Android 平台上处理各种设备的方法。
- en: Build configuration
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 构建配置
- en: There are a variety of ways to handle device orientation to match the settings
    your game design requires.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 有多种处理设备方向的方法，以匹配您游戏设计所需的方向设置。
- en: Orientation support (iOS)
  id: totrans-13
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 方向支持（iOS）
- en: There are scenarios in which you want the native UI elements to autorotate,
    or to be oriented in a certain way, but you also want to maintain a fixed coordinate
    system within Corona.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些场景下，您希望原生 UI 元素自动旋转，或者以某种特定方式旋转，但同时也想在 Corona 中保持一个固定的坐标系。
- en: 'To lock Corona''s orientation while allowing native iPhone UI elements to rotate,
    add a content parameter in `build.settings` as follows:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 要锁定 Corona 的方向，同时允许原生 iPhone UI 元素旋转，请在 `build.settings` 中添加一个内容参数，如下所示：
- en: '[PRE0]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: To lock Corona's internal coordinate system to portrait orientation while locking
    iPhone UI elements to landscape orientation, you could do the following in `build.settings:`
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 要将 Corona 的内部坐标系锁定为纵向方向，同时将 iPhone UI 元素锁定为横向方向，您可以在 `build.settings` 中执行以下操作：
- en: '[PRE1]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Orientation support (Android)
  id: totrans-19
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 方向支持（Android）
- en: 'The Android platform supports two orientations: `portrait` and `landscapeRight`.
    The orientations *landscapeLeft* and *portraitUpsideDown* have no effect on Android.
    Also, autorotation is not currently supported on Android. The default orientation
    doesn''t affect Android devices. The orientation is initialized to the actual
    orientation of the device (unless only one orientation is specified).'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: Android 平台支持两种方向：`portrait` 和 `landscapeRight`。方向 `landscapeLeft` 和 `portraitUpsideDown`
    对 Android 没有影响。此外，Android 目前不支持自动旋转。默认方向不影响 Android 设备。方向初始化为设备的实际方向（除非只指定了一个方向）。
- en: 'Here is an example of an Android-specific `build.settings` file (you may also
    combine Android and iPhone settings in the same file):'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是一个 Android 特定的 `build.settings` 文件示例（您也可以在同一文件中结合 Android 和 iPhone 设置）：
- en: '[PRE2]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Version code and version name (Android)
  id: totrans-23
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 版本代码和版本名称（Android）
- en: The `versionCode` and `versionName` can be set within an optional`"android"`
    table in `build.settings`.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '`versionCode` 和 `versionName` 可以在 `build.settings` 中的可选 `"android"` 表中设置。'
- en: The `versionCode` field is defaulted to`"1"`, while the `versionName` field
    is defaulted at`"1.0"` if it's not set in the `build.settings` file. When an updated
    version of an application is submitted to the Google Play Store, the `versionCode`
    and `versionName` also have to be updated. All version numbers for `versionCode`
    have to be whole numbers. The `versionCode` cannot contain any decimal numbers.
    The `versionName` can contain decimals.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '`versionCode`字段默认为`"1"`，而`versionName`字段在`build.settings`文件中未设置时默认为`"1.0"`。当将应用程序的更新版本提交到Google
    Play Store时，`versionCode`和`versionName`也必须更新。所有`versionCode`的版本号都必须是整数。`versionCode`不能包含任何小数。`versionName`可以包含小数。'
- en: For more information, see *android:versionCode* and *android:versionName:*`http://developer.android.com/guide/topics/manifest/manifest-element.html#vcode.`
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 更多信息，请参阅*android:versionCode*和*android:versionName:*`http://developer.android.com/guide/topics/manifest/manifest-element.html#vcode.`
- en: Note
  id: totrans-27
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The `versionCode` is an internal number used to distinguish application releases
    for the Google Play Store. It is not the same as the version provided by the Corona
    build dialog. The `versionName` is the version number shown to users.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '`versionCode`是一个内部数字，用于区分Google Play Store中的应用程序发布。它不同于Corona构建对话框中提供的版本。`versionName`是显示给用户的版本号。'
- en: Application permissions (Android)
  id: totrans-29
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 应用权限（Android）
- en: An optional`"androidPermissions"` table can be used to specify permissions,
    using string values as given in the *Android Manifest Reference:* [http://developer.android.com/reference/android/Manifest.permission.html](http://developer.android.com/reference/android/Manifest.permission.html).
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用可选的`"androidPermissions"`表来指定权限，使用与*AndroidManifest Reference:* [http://developer.android.com/reference/android/Manifest.permission.html](http://developer.android.com/reference/android/Manifest.permission.html)中给出的字符串值。
- en: Developers should use permissions that match their application requirements.
    For example, if network access is required, the Internet permission needs to be
    set.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 开发者应使用符合其应用程序要求的权限。例如，如果需要网络访问，则需要设置Internet权限。
- en: Content scaling on an easier level
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在更简单的层面上进行内容缩放
- en: Content scaling throughout multiple devices can be frustrating at times if you've
    never addressed them before. While the iPhone and iPhone 4 are easy to scale across
    evenly, it takes some other individual sizes to manipulate screen sizes with the
    iPad, which is at 768 x 1024\. The Droid is 480 x 854 and Samsung Galaxy tablet
    is 600 x 1024 just to name a few.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您以前从未处理过这些问题，那么在多台设备上进行内容缩放有时可能会令人沮丧。虽然iPhone和iPhone 4可以轻松地在均匀的范围内进行缩放，但需要一些其他个别尺寸来使用iPad调整屏幕尺寸，其分辨率为768
    x 1024。Droid的分辨率为480 x 854，三星Galaxy平板电脑的分辨率为600 x 1024，仅举几个例子。
- en: When setting up your `config.lua` like we've done in the previous chapters,
    we had our content set to `width = 320, height = 480`, and `scale = "letterbox"`.
    If building for Android devices,`"zoomStretch"` works best to accommodate varying
    screen sizes on the platform. This helps to build between iOS/Android devices
    together and present display images that are large enough to fit on a variety
    of screen sizes.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 当设置您的`config.lua`，就像我们在前面的章节中所做的那样，我们将内容设置为`width = 320, height = 480`，和`scale
    = "letterbox"`。如果为Android设备构建，`"zoomStretch"`最适合适应平台上的不同屏幕尺寸。这有助于在iOS/Android设备之间构建，并展示足够大的显示图像，以适应各种屏幕尺寸。
- en: 'If you want to scale for larger screen sizes and then scale down, use the screen
    size of the iPad. Your `config.lua` would look similar to the following code:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想要适应更大的屏幕尺寸然后缩小，请使用iPad的屏幕尺寸。您的`config.lua`将类似于以下代码：
- en: '[PRE3]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: While the preceding example is another solution to scale content, it's important
    to remember the limitations in texture memory involved with larger (high resolution)
    images. While devices such as the iPad, iPhone 4, and the Samsung Galaxy tablet
    will handle this just fine, the iPhone 3GS and older devices will have far less
    texture memory available to handle large graphics.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然前面的例子是另一种缩放内容的方法，但重要的是要记住，与较大的（高分辨率）图像相关的纹理内存限制。虽然iPad、iPhone 4和三星Galaxy平板电脑可以很好地处理这个问题，但iPhone
    3GS和更老设备将拥有远少于纹理内存来处理大型图形。
- en: A way to resolve this potential problem is to use *Dynamic Image Resolution*
    to substitute assets that are better suited for low-end devices and high-end devices.
    We will discuss this topic in more detail later in this section.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 解决这个潜在问题的方法之一是使用*动态图像分辨率*来替换更适合低端设备和高端设备的资源。我们将在本节稍后更详细地讨论这个话题。
- en: The best of both worlds
  id: totrans-39
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 两者之最佳
- en: As you may have noticed, some of the background images we used in our sample
    apps are scaled at 380 x 570\. This happens to be the size that fills the entire
    screen on all common devices for both iOS and Android. And better yet, it is a
    middle ground for compensating for higher- and lower-resolution images on any
    device.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 如您可能已注意到，我们在示例应用中使用的某些背景图片的尺寸为380 x 570。这个尺寸恰好是iOS和Android所有常见设备上整个屏幕的填充尺寸。而且，它还是补偿任何设备上高分辨率和低分辨率图片的中间地带。
- en: 'In order for your content to be displayed as evenly as possible, the following
    must be set up accordingly:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 为了尽可能均匀地显示您的内容，以下设置必须相应地进行：
- en: 'Settings for the `config.lua` are as follows:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '`config.lua`的设置如下：'
- en: '[PRE4]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'In any file that contains any of your display images, a typical background
    would be displayed as follows:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在包含任何显示图片的任何文件中，典型的背景显示如下：
- en: '[PRE5]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Any content with a size of 320 x 480 is considered the focus area. Anything
    outside of the area is cropped, but will fill the screen with content on any device.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 任何大小为320 x 480的内容都被认为是焦点区域。任何在该区域之外的内容将被裁剪，但在任何设备上都会用内容填充整个屏幕。
- en: The deeper meaning of dynamic image resolutions
  id: totrans-47
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 动态图像分辨率的深层含义
- en: We know we can swap base images`"image.png"` used for iOS devices (3GS and lower)
    and double-resolution images`"image@2x.png"` (for the iPhone 4 which has retina
    display). This only occurs since Apple devices can tell when the screen size is
    twice the resolution size of the original content.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 我们知道我们可以交换用于iOS设备的基图像`"image.png"`（用于3GS及以下）和双分辨率图像`"image@2x.png"`（用于具有视网膜显示屏的iPhone
    4）。这仅发生在苹果设备能够判断屏幕尺寸是原始内容分辨率的两倍时。
- en: A naming scheme is available for use to handle devices such as the iPad and
    Android handsets. Knowing how to handle the scaling of assets affected for the
    device proposed is half the battle. We'll have to define what resolution scale
    needs to be addressed for Corona to access the assets they're directed towards.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 可用命名方案来处理iPad和Android手机等设备。了解如何处理针对提议的设备受影响的资源缩放是成功的一半。我们将不得不定义Corona需要解决的分辨率缩放级别。
- en: 'By using the line: `display.newImageRect( [parentGroup,] filename [, baseDirectory]
    w, h )` will call out your dynamic resolution images.'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下行：`display.newImageRect( [parentGroup,] filename [, baseDirectory] w, h
    )`将调用您的动态分辨率图片。
- en: 'Typically, we''ve used `["@2x"] = 2` to call out the higher resolution image
    when available in our project for iOS devices:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，我们使用`["@2x"] = 2`来调用iOS设备项目中可用的更高分辨率图片：
- en: '[PRE6]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The preceding example will only work for iPhone 4 and iPad since it surpasses
    the base size of 320 x 480 on both devices. If we wanted to make it accessible
    to the Droid, the scale threshold would be 1.5\. For an Android tablet to work,
    such as the Samsung Galaxy tablet, the scale threshold is 1.875\. So how do we
    figure out these numbers? Simple. Take the width of the higher-end device and
    divide it by 320 (the base size). For example:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的示例仅适用于iPhone 4和iPad，因为它超过了这两个设备上的基本尺寸320 x 480。如果我们想让它对Droid可用，缩放阈值将是1.5。对于三星Galaxy平板等Android平板来说，缩放阈值是1.875。那么我们如何得出这些数字呢？很简单。取高端设备的宽度除以320（基本尺寸）。例如：
- en: The Droid dimensions are 480 x 854\. Divide 480 by 320 and it equals 1.5.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: Droid的尺寸为480 x 854。将480除以320等于1.5。
- en: The Samsung Galaxy tablet dimensions are 600 x 1024\. Divide 600 by 320 and
    it equals 1.875.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 三星Galaxy平板的尺寸为600 x 1024。将600除以320等于1.875。
- en: 'If trying to manage both iOS and Android devices in the same project, you can
    change your `imageSuffix` in the `config.lua` as follows:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 如果试图在同一个项目中管理iOS和Android设备，您可以在`config.lua`中更改您的`imageSuffix`如下：
- en: '[PRE7]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: -- or
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: -- 或者
- en: '[PRE8]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Using either of the preceding examples will trigger the proposed Android devices
    to display the higher resolution image.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 使用上述任一示例将触发提议的Android设备显示更高分辨率的图片。
- en: The `imageSuffix` doesn't necessarily have to be`"@2x"`, it can be anything
    like`"@2", "_lrg"`, or even`"-2x"`. As long as your higher-resolution image has
    the intended suffix after the primary image name, it'll work just fine.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '`imageSuffix`不一定必须是`"@2x"`，它可以像`"@2", "_lrg"`或甚至`"-2x"`这样的任何东西。只要您的更高分辨率图片在主图片名称后有预期的后缀，它就能正常工作。'
- en: High-resolution sprite sheets
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 高分辨率精灵图集
- en: High-resolution sprite sheets are not handled the same way as dynamic image
    resolutions. While you can continue using the same naming convention to differentiate
    your high-resolution images from your basic images, the image will not be able
    to use `display.newImageRect()when` referring to sprite sheets.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 高分辨率精灵表的处理方式与动态图像分辨率不同。虽然您可以使用相同的命名约定来区分您的高分辨率图像和基本图像，但精灵表将无法使用`display.newImageRect()`来引用。
- en: 'If your current content scale is `width = 320, height = 480`, and `scale =
    "letterbox"` in your `config.lua` file, then the scale output for the following
    devices will demonstrate the following:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您当前的内容缩放比例在`config.lua`文件中设置为`width = 320, height = 480`，并且`scale = "letterbox"`，那么以下设备的缩放输出将展示以下内容：
- en: '`iPhone = 1`'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`iPhone = 1`'
- en: '`iPhone 4 = 0.5`'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`iPhone 4 = 0.5`'
- en: '`Droid = 0.666666668653488`'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Droid = 0.666666668653488`'
- en: '`iPad = 0.46875`'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`iPad = 0.46875`'
- en: Applying a basic sprite sheet that matches the scale for an iPhone will display
    sharp and clean images. When the same sprite sheet is applied to the iPhone 4,
    the display will match the content scale of the device, but the sprite sheet will
    look slightly pixilated and blurry around the edges. Using `display.contentScaleX`
    and calling some methods will solve that problem for you. Notice that `displayScale
    < 1` will access the high-resolution sprite sheet based on the preceding device
    scale.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 应用一个与iPhone缩放匹配的基本精灵表，将显示清晰、干净的图像。当相同的精灵表应用于iPhone 4时，显示将匹配设备的内容缩放，但精灵表在边缘会略显像素化和模糊。使用`display.contentScaleX`和调用一些方法可以为您解决这个问题。请注意，`displayScale
    < 1`将根据前述设备缩放访问高分辨率精灵表。
- en: '[PRE9]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Networking your apps
  id: totrans-71
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络化您的应用
- en: When you have completed developing your main game framework, it's good to think
    about how to network it if you decide to do so.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 当您完成主要游戏框架的开发后，如果您决定进行网络化，考虑一下如何实现它是很好的。
- en: We all have used some kind of networking tool during some point in our lives,
    such as Twitter and Facebook. Maybe you currently use these applications, but
    the point is you've read updates from other users about a new game that came out
    or someone is spreading the word to download a game and compete with them. You
    can be that developer and develop the game they're talking about!
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在生活的某个时刻都使用过某种网络工具，比如推特和Facebook。也许您目前正在使用这些应用程序，但重点是您已经阅读了其他用户关于新游戏发布的更新，或者有人正在传播下载游戏并与他们竞争的消息。您可以成为那个开发者，开发他们正在谈论的游戏！
- en: Incorporating networking mechanisms in your game does not have to be a hassle.
    It only takes several lines of code to get it working.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在您的游戏中加入网络机制并不麻烦。只需几行代码就可以让它工作。
- en: Posting to Twitter
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 发布到推特
- en: Tweet, tweet, tweet... Twitter is a networking tool that connects you to the
    latest information that appeals to your interests. It is also a great tool to
    share information with others about your business and of course your game. Reach
    out to the game development audience by promoting your application.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 推特，推特，推特……推特是一种连接您与最新感兴趣信息的网络工具。它也是一个分享您业务和游戏信息的优秀工具。通过推广您的应用程序来接触游戏开发社区。
- en: 'In order for posting on Twitter to work, you need to create a Twitter account
    at: [http://twitter.com/](http://twitter.com/) and make sure that you''re logged
    in.'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 为了在推特上发布内容，您需要在以下网址创建一个推特账户：[http://twitter.com/](http://twitter.com/) 并确保您已登录。
- en: Time for action—adding Twitter in your apps
  id: totrans-78
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实践时间——在您的应用中添加推特
- en: We're going to implement Twitter in our apps by accessing a web service through
    UI buttons.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过UI按钮访问一个网络服务，在我们的应用中实现推特功能。
- en: In the `Chapter 9` folder, copy the `Twitter Web Pop-Up` project folder to your
    desktop. All the configuration, libraries, and assets needed are already included.
    You can download the project files accompanying this book from the Packt website.
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`Chapter 9`文件夹中，将`Twitter Web Pop-Up`项目文件夹复制到您的桌面。所有需要的配置、库和资源都已经包含在内。您可以从Packt网站下载本书附带的项目文件。
- en: Create a new `main.lua` file and save it to the project folder.
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新的`main.lua`文件并将其保存到项目文件夹中。
- en: 'Set the following variables at the beginning of the code:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在代码开头设置以下变量：
- en: '[PRE10]'
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Create a local function called `onOpenTouch()` with an event parameter. Add
    in an `if` statement so the event receives a`"release"` action.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`onOpenTouch()`的局部函数，并带有事件参数。添加一个`if`语句，以便事件接收一个`"release"`动作。
- en: '[PRE11]'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Using the local variable called `message`, add in the following string statement
    and concatenate `score`.
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用名为`message`的局部变量，添加以下字符串语句并将`score`连接起来。
- en: '[PRE12]'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Add in `local myString` and apply a `string.gsub()` for `message` to replace
    space instances.
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加 `local myString` 并对 `message` 应用 `string.gsub()` 以替换空格实例。
- en: '[PRE13]'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Introduce the `native.showWebPopup()` function that links to the Twitter account.
    Concatenate `myString` to include the pre-loaded message. Close the function.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 介绍 `native.showWebPopup()` 函数，该函数链接到 Twitter 账户。将 `myString` 拼接到预加载的消息中。关闭函数。
- en: '[PRE14]'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Set up the `openBtn` UI function.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置 `openBtn` UI 函数。
- en: '[PRE15]'
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Create a local function called `onCloseTouch()` with an `event` parameter. Add
    an `if` statement with `event.phase == "release"` to activate `native.cancelWebPopup()`.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为 `onCloseTouch()` 的本地函数，带有 `event` 参数。添加一个 `if` 语句，其中 `event.phase ==
    "release"` 以激活 `native.cancelWebPopup()`。
- en: '[PRE16]'
  id: totrans-95
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Set up the `closeBtn` UI function.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置 `closeBtn` UI 函数。
- en: '[PRE17]'
  id: totrans-97
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Save the file and run the project in the simulator. Make sure you're connected
    to the Internet to see the results.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存文件并在模拟器中运行项目。确保你已连接到互联网以查看结果。
- en: Note
  id: totrans-99
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: If you're currently not logged in to your Twitter account, you'll be asked to
    log in before you see the results of the tweet from our code.
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你目前未登录到你的 Twitter 账户，你将需要在看到我们代码中推文的成果之前登录。
- en: '![Time for action—adding Twitter in your apps](img/1888_09_01.jpg)'
  id: totrans-101
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![添加 Twitter 到你的应用的时间——行动时刻](img/1888_09_01.jpg)'
- en: What just happened?
  id: totrans-102
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 刚才发生了什么？
- en: Near the top of the code we set a variable, `local score = 100`. This will be
    used in our Twitter message.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在代码的顶部附近，我们设置了一个变量 `local score = 100`。这将在我们的 Twitter 消息中使用。
- en: In the `onOpenTouch(event)` function, a web pop-up will load upon the release
    of `openBtn`. The text that will be posted is displayed in a string format under
    the variable, local message. You will notice that we concatenate `score` into
    the string so it displays the value in the message post.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `onOpenTouch(event)` 函数中，当释放 `openBtn` 时，将加载一个网页弹出窗口。将要发布的文本以字符串格式显示在变量 `local
    message` 下。你会注意到我们将 `score` 拼接到字符串中，以便在消息发布中显示其值。
- en: '`local myString, string.gsub()` is used to replace all the instances indicated
    in a pattern inside the string. In this case, it takes the string inside message
    and searches for every empty space between each word and replaces it with `%20\.
    %20` encodes URL parameters to indicate spaces. The extra `%` acts as an escape
    character.'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '`local myString, string.gsub()` 用于替换字符串中模式指示的所有实例。在这种情况下，它将消息中的字符串内部搜索每个单词之间的每个空格，并将其替换为
    `%20\. %20`。`%20` 编码 URL 参数以表示空格。额外的 `%` 作为转义字符。'
- en: The `native.showWebPopup()` function displays at dimensions 320 x 300; about
    half the screen size on a device. The URL to display the Twitter message dialog
    is added and concatenates `myString`.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: '`native.showWebPopup()` 函数以 320 x 300 的尺寸显示；大约占设备屏幕尺寸的一半。要显示的 Twitter 消息对话框的
    URL 被添加并拼接 `myString`。'
- en: When the web pop-up no longer needs to be used and needs to be closed, `onCloseTouch(event)`
    is called by `closeBtn`. This will take the `event` parameter`"release"` and call
    the `native.cancelWebPopup()`. This particular function will dismiss the current
    web pop-up.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 当网页弹出窗口不再需要使用并需要关闭时，`onCloseTouch(event)` 由 `closeBtn` 调用。这将获取 `event` 参数 `"release"`
    并调用 `native.cancelWebPopup()`。这个特定的函数将关闭当前的网页弹出窗口。
- en: Posting to Facebook
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 发布到 Facebook
- en: Another social networking tool that can be used to share information about your
    game is Facebook. You can easily customize a post to link information about your
    game or share messages about high scores and insist upon other users downloading
    it.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个可以用来分享你的游戏信息的社交网络工具是 Facebook。你可以轻松自定义帖子以链接有关你的游戏的信息或分享关于高分的信息，并坚持要求其他用户下载它。
- en: 'In order to post messages to Facebook, you need to be logged in to your Facebook
    account or create one at: [http://www.facebook.com/](http://www.facebook.com/).
    You will have to obtain an App ID from the *Facebook Developer* website at: [https://developers.facebook.com/](http://https://developers.facebook.com/).
    The App ID is a unique identifier for your site that determines what the right
    level of security is in place between the user and the app page/website.'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 为了发布到 Facebook，你需要登录到你的 Facebook 账户或在此处创建一个：[http://www.facebook.com/](http://www.facebook.com/)。你将需要从
    *Facebook 开发者* 网站获取一个 App ID：[https://developers.facebook.com/](https://developers.facebook.com/)。App
    ID 是你网站的唯一标识符，它决定了用户和应用程序页面/网站之间应有的安全级别。
- en: 'Once you have created an App ID, you will also need to edit the app information
    and choose how you want it to integrate with Facebook. You are given several choices,
    such as: Website, Native iOS App, and Native Android App, just to name a few.
    The website integration must be selected and filled in with a valid URL in order
    for Facebook to redirect to the specified URL for posts dealing with web pop-ups.'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您创建了 App ID，您还需要编辑应用信息并选择您希望如何与 Facebook 集成。您有几种选择，例如：网站、原生 iOS 应用和原生 Android
    应用，仅举几例。必须选择网站集成并填写有效的 URL，以便 Facebook 将重定向到处理网页弹窗的指定 URL。
- en: Time for action—adding Facebook to your apps
  id: totrans-112
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 操作时间——将 Facebook 添加到您的应用中
- en: Similar to our Twitter example, we'll be incorporating Facebook posts with a
    web pop-up as well.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 与我们的 Twitter 示例类似，我们还将结合使用带有网页弹窗的 Facebook 帖子。
- en: In the `Chapter 9` folder, copy the `Facebook Web Pop-Up` project folder to
    your desktop. All the configuration, libraries, and assets needed are already
    included. You can download the project files accompanying this book from the Packt
    website.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 `第 9 章` 文件夹中，将 `Facebook Web Pop-Up` 项目文件夹复制到您的桌面。所有必要的配置、库和资源都已包含在内。您可以从
    Packt 网站下载本书附带的项目文件。
- en: Create a new `main.lua` file and save it to the project folder.
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新的 `main.lua` 文件并将其保存到项目文件夹中。
- en: 'Set the following variables at the beginning of the code:'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在代码开头设置以下变量：
- en: '[PRE18]'
  id: totrans-117
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Create a local function called `onOpenTouch()` with an event parameter. Add
    in an `if` statement when the event receives a`"release"` action.
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为 `onOpenTouch()` 的本地函数，并带有事件参数。当事件接收到 `"release"` 动作时，添加一个 `if` 语句。
- en: '[PRE19]'
  id: totrans-119
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Add in the following local variables that include the strings we'll be implementing
    into the Facebook post.
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加以下本地变量，包括我们将要实现到 Facebook 帖子中的字符串。
- en: '[PRE20]'
  id: totrans-121
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Introduce the native web pop-up function that links to the Facebook account.
    Include parameters for the Facebook Dialog box that redirects the URL of your
    preferred website, the display with a touch mode that connects to your app URL,
    and an image URL that presents your app icon or company logo. Concatenate all
    variables with string methods to output all messages. Close the function. Add
    in the `openBtn` UI function. (You will need to replace all the URL information
    below with your own).
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 介绍链接到 Facebook 账户的本地网页弹窗功能。包括 Facebook 对话框的参数，该对话框重定向您首选网站的 URL，以触摸模式显示并连接到您的应用
    URL，以及显示您的应用图标或公司标志的图像 URL。使用字符串方法连接所有变量以输出所有消息。关闭函数。添加 `openBtn` UI 函数。（您需要将以下所有
    URL 信息替换为您自己的）。
- en: '[PRE21]'
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Note
  id: totrans-124
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: 'More information pertaining to the Facebook Dialog can be found on the *Facebook
    Developers* website at: [http://developers.facebook.com/docs/reference/dialogs/](http://developers.facebook.com/docs/reference/dialogs/).'
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 更多有关 Facebook 对话的信息可以在 *Facebook 开发者* 网站上找到：[http://developers.facebook.com/docs/reference/dialogs/](http://developers.facebook.com/docs/reference/dialogs/)。
- en: Create a local function called `onCloseTouch()` with an event parameter. Add
    an `if` statement with `event.phase == "release"` to activate `native.cancelWebPopup()`.
    Set up the `closeBtn` UI function.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为 `onCloseTouch()` 的本地函数，并带有事件参数。添加一个 `if` 语句，条件为 `event.phase == "release"`
    以激活 `native.cancelWebPopup()`。设置 `closeBtn` UI 函数。
- en: '[PRE22]'
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Save the file and run the project in the simulator. Make sure you're connected
    to the Internet and your Facebook account to see the results.![Time for action—adding
    Facebook to your apps](img/1888_09_02.jpg)
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存文件并在模拟器中运行项目。确保您已连接到互联网，并且您的 Facebook 账户，以便查看结果。![操作时间——将 Facebook 添加到您的应用中](img/1888_09_02.jpg)
- en: What just happened?
  id: totrans-129
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 刚才发生了什么？
- en: Within the `onOpenTouch(event)` function, several variables are called when
    `openBtn` is pressed and released. Notice that `local appId` indicates a string
    of numbers that you can obtain after creating an app on the Facebook Developers
    website.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `onOpenTouch(event)` 函数中，当按下并释放 `openBtn` 时，会调用几个变量。请注意，`local appId` 指示的是在
    Facebook 开发者网站上创建应用后可以获得的数字字符串。
- en: '`message1, message2`, and `message3` are the strings that display the message
    post. `myString1, myString2`, and `myString3` help replace the spaces indicated
    in `message1, message2`, and `message3`.'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '`message1, message2` 和 `message3` 是显示消息帖子的字符串。`myString1, myString2` 和 `myString3`
    帮助替换 `message1, message2` 和 `message3` 中的空格。'
- en: 'The `native.showWebPopup()` function displays with a dimension of 320 x 300
    and presents the dialog URL to Facebook. The following parameters display accordingly:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: '`native.showWebPopup()` 函数以 320 x 300 的尺寸显示，并将对话框 URL 显示给 Facebook。以下参数相应显示：'
- en: '`app_id`—Example: `"1234567"` (This is your unique ID created on the Facebook
    Developer website).'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`app_id` — 示例：`"1234567"`（这是你在 Facebook 开发者网站上创建的唯一 ID）。'
- en: '`redirect_uri`—The URL to redirect to after the user clicks a button on the
    dialog. This is required in the parameters.'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`redirect_uri` — 用户点击对话框中的按钮后要重定向到的 URL。这是参数中必需的。'
- en: '`display`—Displays the mode to render the dialog.'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`display` — 显示用于渲染对话框的模式。'
- en: '`touch`—Used on smart phone devices like iPhone and Android. Fits the dialog
    screen within small dimensions.'
  id: totrans-136
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`touch` — 用于智能手机设备，如 iPhone 和 Android。使对话框屏幕适应小尺寸。'
- en: '`link`—The link attached to the post.'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`link` — 附带在帖子中的链接。'
- en: '`picture`—The URL of a picture to the post.'
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`picture` — 发布帖子的图片的 URL。'
- en: '`name—name` of the link attachment.'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`name—name` — 链接附件的名称。'
- en: '`caption`—Caption of the link (appears beneath the link name).'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`caption` — 链接的标题（出现在链接名称下方）。'
- en: '`description`—Description of the link (appears beneath the link caption).'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`description` — 链接的描述（出现在链接标题下方）。'
- en: When the web pop-up no longer needs to be used and needs to be closed, `onCloseTouch(event)`
    is called by `closeBtn`. This will take the event parameter`"release"` and call
    `native.cancelWebPopup()`. This particular function will dismiss the current web
    pop-up.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 当不再需要使用网页弹出窗口并需要关闭时，`closeBtn` 会调用 `onCloseTouch(event)`。这将获取事件参数 `"release"`
    并调用 `native.cancelWebPopup()`。这个特定的函数将关闭当前的网页弹出窗口。
- en: Facebook Connect
  id: totrans-143
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Facebook Connect
- en: This library supplies a number of functions that interface to [http://www.facebook.com](http://www.facebook.com)
    through the official Facebook Connect interface.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 该库提供了一系列函数，通过官方的 Facebook Connect 接口与 [http://www.facebook.com](http://www.facebook.com)
    进行交互。
- en: Time for action—posting scores using Facebook Connect
  id: totrans-145
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 行动时间 — 使用 Facebook Connect 发布分数
- en: Facebook Connect is another way to post on the wall feed by using the native
    Facebook UI features. We'll be creating a different way to post messages and scores
    to the newsfeed. In order to see how Facebook Connect operates, you need to load
    the build to a device to view the results. It will not run in the simulator.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: Facebook Connect 是通过使用本地的 Facebook UI 功能在墙面上发表帖子的另一种方式。我们将创建一种不同的方式来发布消息和分数到新闻源。为了了解
    Facebook Connect 的工作原理，你需要将构建加载到设备上以查看结果。它不会在模拟器中运行。
- en: In the `Chapter 9` folder, copy the `Facebook Connect` project folder to your
    desktop. All the configuration, libraries, and assets needed are already included.
    You can download the project files accompanying this book from the Packt website.
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 `第 9 章` 文件夹中，将 `Facebook Connect` 项目文件夹复制到你的桌面。所有需要的配置、库和资源都已经包含在内。你可以从 Packt
    网站下载本书附带的项目文件。
- en: Create a new `main.lua` file and save it to the project folder.
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新的 `main.lua` 文件并将其保存到项目文件夹中。
- en: 'Set up the following variables at the beginning of the code:'
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在代码开头设置以下变量：
- en: '[PRE23]'
  id: totrans-150
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Create a local function called `onFBTouch()` with an event parameter. Add in
    an `if` statement containing `event.phase == release`. Also include your Facebook
    app ID in a string format.
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个带有事件参数的局部函数 `onFBTouch()`。添加一个包含 `event.phase == release` 的 `if` 语句。同时包括你的
    Facebook 应用 ID，以字符串格式。
- en: '[PRE24]'
  id: totrans-152
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Create another local function within `onFBTouch(event)` called `facebookListener()`
    with an event parameter as well. Include an `if` statement that refers to`"session"
    == event.type`.
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 `onFBTouch(event)` 中创建另一个局部函数 `facebookListener()`，它也有一个事件参数。包括一个引用 `"session"`
    等于 `event.type` 的 `if` 语句。
- en: '[PRE25]'
  id: totrans-154
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Add in another `if` statement where`"login" == event.phase`. Include a local
    variable called `theMessage` to display the message you want to share with other
    Facebook users.
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 `if` 语句中添加另一个条件，其中 `"login"` 等于 `event.phase`。包含一个名为 `theMessage` 的局部变量来显示你想与其他
    Facebook 用户分享的消息。
- en: '[PRE26]'
  id: totrans-156
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Add in the `facebook.request()` function that will post the following messages
    to the user's Facebook wall. Close any remaining `if` statements with `end` in
    the `facebookListener(event)` function.
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加 `facebook.request()` 函数，该函数将以下消息发布到用户的 Facebook 墙上。在 `facebookListener(event)`
    函数中，使用 `end` 关闭任何剩余的 `if` 语句。
- en: '[PRE27]'
  id: totrans-158
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Note
  id: totrans-159
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: 'The `link` parameter demonstrates a URL for an iOS application. You can direct
    the URL to an Android application that will look something like: [https://play.google.com/store/apps/details?id=com.yourcompany.yourappname](https://play.google.com/store/apps/details?id=com.yourcompany.yourappname)
    or a general website URL of your choosing.'
  id: totrans-160
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`link` 参数演示了一个 iOS 应用的 URL。你可以将 URL 指向一个类似 [https://play.google.com/store/apps/details?id=com.yourcompany.yourappname](https://play.google.com/store/apps/details?id=com.yourcompany.yourappname)
    的 Android 应用，或者选择一个通用的网站 URL。'
- en: Call the `facebook.login()` that includes your appID, listener, and permissions
    to post on the user's Facebook wall. Close the remainder of the `onFBTouch(event)`
    function.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 调用包含你的appID、监听器和权限以在用户的Facebook墙上发布消息的`facebook.login()`。关闭`onFBTouch(event)`函数的其余部分。
- en: '[PRE28]'
  id: totrans-162
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: Enable the `fbBtn` UI function and save your file.
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用`fbBtn` UI功能并保存你的文件。
- en: '[PRE29]'
  id: totrans-164
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Create a new device build for either iOS or Android. Load the build to your
    device and run the application. You will be asked to log in to your Facebook account
    before you can see the results from the application.![Time for action—posting
    scores using Facebook Connect](img/1888_09_03.jpg)
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为iOS或Android创建一个新的设备构建。将构建加载到你的设备上并运行应用程序。在你可以看到应用程序的结果之前，你将被要求登录到你的Facebook账户。![行动时间——使用Facebook
    Connect发布分数](img/1888_09_03.jpg)
- en: What just happened?
  id: totrans-166
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 刚才发生了什么？
- en: One of the most important things that needs to be done is `require "facebook"`
    in order to have the Facebook API to work. We also created a local variable called
    `score` with the value of 100.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 需要完成的重要事情之一是`require "facebook"`，以便使Facebook API能够工作。我们还创建了一个名为`score`的局部变量，其值为100。
- en: The `onFBTouch(event)` function will initiate the event parameter upon`"release"`
    of `fbBtn`. Within the function, `fbAppID` is included with characters in a string
    format. This will be a unique set of numbers that you must obtain from the Facebook
    Developers website. The App ID will be created for you when you make an App page
    on the site.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: '`onFBTouch(event)`函数会在`fbBtn`的`"release"`事件发生时启动事件参数。在函数内部，`fbAppID`以字符串格式包含字符。这将是一组唯一的数字，你必须从Facebook开发者网站获取。当你在这个网站上创建一个应用页面时，App
    ID会为你创建。'
- en: 'Another function, `facebookListener(event)`, is created and it will initiate
    all `fbConnect` events. Under the `if` statement containing `("login" == event.phase
    )` will request to post a message to your feed through`"me/feed, "POST"`. The
    feed contains the following:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个函数`facebookListener(event)`被创建，它将启动所有`fbConnect`事件。在包含`("login" == event.phase)`的`if`语句中，将请求通过`"me/feed,
    "POST"`发布消息。该feed包含以下内容：
- en: '`message=theMessage`—Refers to the string belonging to the variable. It also
    concatenates scores so it displays the value as well.'
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`message=theMessage`—指的是属于变量的字符串。它还会连接分数，以便显示其值。'
- en: '`name`—A message that includes your app name or subject matter.'
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`name`—包含你的应用名称或主题的消息。'
- en: '`caption`—A short persuasive message to catch other users attention about playing
    the game.'
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`caption`—一个简短的具有说服力的消息，以吸引其他用户注意玩游戏。'
- en: '`link`—The URL to download the game from either the App Store or Google Play
    Store.'
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`link`—从App Store或Google Play Store下载游戏的URL。'
- en: '`picture`—A URL containing your image that displays your app icon or visual
    representation of the game.'
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`picture`—包含你的图像的URL，用于显示你的应用图标或游戏的视觉表示。'
- en: After the parameters are set, `facebook.login()` will refer to `fbAppID` and
    `facebookListener()` to see if a valid application ID is being used to post on
    Facebook. Upon success, the post is published through`"publish_stream".`
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 在设置好参数后，`facebook.login()`将引用`fbAppID`，`facebookListener()`将检查是否正在使用有效的应用程序ID在Facebook上发布。成功后，将通过`"publish_stream"`发布帖子。
- en: Have a go hero—create a dialog box
  id: totrans-176
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 尝试英雄——创建一个对话框
- en: 'See if you can figure out how to display a dialog box using Facebook Connect
    and using the same setup as the preceding example. The following line will display
    this as:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 看看你是否能找出如何使用Facebook Connect和与前面示例相同的设置来显示对话框。以下行将显示为：
- en: '[PRE30]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Now see where in the code `facebook.showDialog()` can be accessed. This is another
    way of posting messages to Facebook.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 现在看看代码中`facebook.showDialog()`可以访问的位置。这是另一种向Facebook发布消息的方法。
- en: The wonders of OpenFeint
  id: totrans-180
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: OpenFeint的奇妙之处
- en: OpenFeint is a third-party library that enables social gaming features such
    as public leaderboards and achievements. For more information, see [http://www.openfeint.com/](http://www.openfeint.com/).
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: OpenFeint是一个第三方库，它使社交游戏功能，如公开排行榜和成就成为可能。更多信息，请参阅[http://www.openfeint.com/](http://www.openfeint.com/)。
- en: It is very simple to implement leaderboards and achievements once you are ready
    to network your mobile game to the public.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你准备好将你的移动游戏公开联网，实现排行榜和成就系统非常简单。
- en: 'You will need to create a user account on the OpenFeint Developer site at:
    [http://www.openfeint.com/developers](http://www.openfeint.com/developers) to
    integrate its features in your application.'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要在OpenFeint开发者网站上创建一个用户账户：[http://www.openfeint.com/developers](http://www.openfeint.com/developers)，以将它的功能集成到你的应用程序中。
- en: Game network API
  id: totrans-184
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 游戏网络API
- en: Game network allows access to third-party libraries such as OpenFeint, Papaya,
    and Game Center which enable social gaming features such as public leaderboards
    and achievements. The API will be able to access those libraries once you implement
    them in your application. We'll be focusing on the easy-to-use OpenFeint library,
    which will implement the following features from the game network API.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 游戏网络允许访问第三方库，如 OpenFeint、Papaya 和 Game Center，这些库可以启用社交游戏功能，如公开排行榜和成就。一旦你在应用程序中实现它们，API
    将能够访问这些库。我们将重点关注易于使用的 OpenFeint 库，该库将实现游戏网络 API 的以下功能。
- en: 'The following line makes the game network features available under the OpenFeint
    namespace:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 以下行使游戏网络功能在 OpenFeint 命名空间下可用：
- en: '[PRE31]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: gameNetwork.init()
  id: totrans-188
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: gameNetwork.init()
- en: Initializes ans (product key, secret, display name, and so on) required by the
    game network provider. After you have logged in to your OpenFeint developer account,
    you'll need to select the **Add New Game** button and create a new application
    name. The **App ID, Product Key**, and **Product Secret** can be found in the
    **Application Information** section of your application name.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 初始化游戏网络提供者所需的产品密钥、密钥、显示名称等。登录到你的 OpenFeint 开发者账户后，你需要选择“添加新游戏”按钮并创建一个新的应用程序名称。**App
    ID、产品密钥**和**产品密钥**可以在应用程序名称的**应用程序信息**部分找到。
- en: 'Syntax:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 语法：
- en: '[PRE32]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'Parameters:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '`providerName`—The string of the game network provider ("openfeint")'
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`providerName`—游戏网络提供者的字符串 ("openfeint")'
- en: '`parms`—Additional parameters required by the`"openfeint"` provider'
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`parms`—"openfeint" 提供商所需的附加参数'
- en: '`Product Key`—The string of your application''s OpenFeint product key (provided
    by OpenFeint)'
  id: totrans-195
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Product Key`—应用程序 OpenFeint 产品密钥的字符串（由 OpenFeint 提供）'
- en: '`Product Secret`—The string of your application''s product secret (provided
    by OpenFeint)'
  id: totrans-196
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Product Secret`—应用程序产品密钥的字符串（由 OpenFeint 提供）'
- en: '`Display Name`—The string of the name to display in OpenFeint leaderboards
    and other views'
  id: totrans-197
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Display Name`—在 OpenFeint 排行榜和其他视图中显示的名称字符串'
- en: '`App ID`—The string of the application ID (provided by OpenFeint)'
  id: totrans-198
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`App ID`—应用程序 ID 的字符串（由 OpenFeint 提供）'
- en: 'Example:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE33]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: Initializes an app with the specified product key, secret, and display name.
    This should only be called once.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 使用指定的产品密钥、密钥和显示名称初始化应用程序。这应该只调用一次。
- en: gameNetwork.show()
  id: totrans-202
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: gameNetwork.show()
- en: Shows information from the game network provider on the screen.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 在屏幕上显示来自游戏网络提供者的信息。
- en: 'For the OpenFeint provider, launch the OpenFeint dashboard in one of the following
    configurations: leaderboards, challenges, achievements, friends, playing, or high
    score.'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 OpenFeint 提供商，以下配置中启动 OpenFeint 仪表板：排行榜、挑战、成就、好友、游戏、高分。
- en: 'Syntax:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 语法：
- en: '[PRE34]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Parameters:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '`name`—Strings supported by the OpenFeint provider:'
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`name`—OpenFeint 提供商支持的字符串：'
- en: '`gameNetwork.show()`—Launches the OpenFeint dashboard'
  id: totrans-209
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`gameNetwork.show()`—启动 OpenFeint 仪表板'
- en: '`gameNetwork.show( "leaderboards")`—Opens the user''s Leaderboard dashboard'
  id: totrans-210
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`gameNetwork.show( "leaderboards")`—打开用户的排行榜仪表板'
- en: '`gameNetwork.show( "challenges")`—Opens the user''s Challenge dashboard (not
    supported in Android)'
  id: totrans-211
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`gameNetwork.show( "challenges")`—打开用户的挑战仪表板（在 Android 上不支持）'
- en: '`gameNetwork.show( "achievements")`—Opens the user''s Achievements dashboard'
  id: totrans-212
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`gameNetwork.show( "achievements")`—打开用户的成就仪表板'
- en: '`gameNetwork.show( "friends")`—Opens the user''s Friends dashboard (not supported
    in Android)'
  id: totrans-213
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`gameNetwork.show( "friends")`—打开用户的好友仪表板（在 Android 上不支持）'
- en: '`gameNetwork.show( "playing ")`—Opens the user''s Playing dashboard (not supported
    in Android)'
  id: totrans-214
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`gameNetwork.show( "playing ")`—打开用户的游戏仪表板（在 Android 上不支持）'
- en: '`gameNetwork.show( "highscore", "LeaderboardID")`—Opens the user''s High Score
    dashboard for a particular item'
  id: totrans-215
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`gameNetwork.show( "highscore", "LeaderboardID")`—打开特定项目的用户高分仪表板'
- en: '`data-String`—When the OpenFeint dashboard view is`"highscore"`, the string
    should contain the`"leaderboardID"` property whose value is the corresponding
    OpenFeint leaderboard ID.'
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`data-String`—当 OpenFeint 仪表板视图为“highscore”时，字符串应包含“leaderboardID”属性，其值是对应的
    OpenFeint 排行榜 ID。'
- en: gameNetwork.request()
  id: totrans-217
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: gameNetwork.request()
- en: Send or request information to/from the game network provider.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 向/从游戏网络提供者发送或请求信息。
- en: 'Syntax:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 语法：
- en: '[PRE35]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Parameters:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '`command`—Strings supported by the OpenFeint provider:'
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`command`—OpenFeint 提供商支持的字符串：'
- en: '`setHighScore`'
  id: totrans-223
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`setHighScore`'
- en: '`unlockAchievement`'
  id: totrans-224
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`unlockAchievement`'
- en: '`uploadBlob`—Not supported on Android'
  id: totrans-225
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`uploadBlob`—在 Android 上不支持'
- en: '`downloadBlob`—Not supported on Android'
  id: totrans-226
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`downloadBlob`—在 Android 上不支持'
- en: '`parms`—Parameters used in the preceding OpenFeint commands:'
  id: totrans-227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`parms`—在先前的 OpenFeint 命令中使用的参数：'
- en: '`setHighScore: { leaderboardID="123456", score=50 }`'
  id: totrans-228
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`setHighScore: { leaderboardID="123456", score=50 }`'
- en: '`unlockAchievement: "achievementId"`'
  id: totrans-229
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`unlockAchievement: "achievementId"`'
- en: '`uploadBlob: "uploadBlob", key, data`'
  id: totrans-230
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`uploadBlob: "uploadBlob", key, data`'
- en: '`downloadBlob: key, [listener]`—listener for`"completion"` event with`"blob"`
    key set'
  id: totrans-231
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`downloadBlob: key, [listener]`—监听 `"completion"` 事件，其中 `"blob"` 键被设置'
- en: 'Example:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: 'The following unlocks the specified achievement:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 以下解锁指定的成就：
- en: '[PRE36]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'The following sets a high score on the leaderboard:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 以下在排行榜上设置高分：
- en: '[PRE37]'
  id: totrans-236
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'The preceding function takes a table as the parameter with the following elements:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的函数接受一个包含以下元素的表作为参数：
- en: '`leaderboardID:` String. The ID of the OpenFeint leaderboard where the high
    score should be posted.'
  id: totrans-238
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`leaderboardID:` 字符串。OpenFeint 排行榜的 ID，高分应在此排行榜上发布。'
- en: '`score:` Number. The new high score value to post to the specified leaderboard.'
  id: totrans-239
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`score:` 数字。要发布到指定排行榜的新高分值。'
- en: '`displayText:` String. An optional string to display in place of the numeric
    score specified by the value assigned to the score parameter.'
  id: totrans-240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`displayText:` 字符串。一个可选的字符串，用于显示在由分数参数分配的数值分数所在的位置。'
- en: 'The following saves a blob of game data in the cloud, using OpenFeint''s *Network
    Save Card* feature:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是在云中使用 OpenFeint 的 *网络保存卡* 功能保存游戏数据：
- en: '[PRE38]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'The following downloads data saved previously saved uploadBlob:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 以下下载之前保存并上传的 blob 数据：
- en: '[PRE39]'
  id: totrans-244
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: OpenFeint in a jiffy
  id: totrans-245
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 立刻使用 OpenFeint
- en: What better way to implement OpenFeint than by using a game we have already
    made in this book!
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 在这本书中我们已经制作的游戏中实现 OpenFeint 有什么更好的方法呢！
- en: Time for action—setting up OpenFeint leaderboards and achievements in Egg Drop
  id: totrans-247
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 操作时间——在 Egg Drop 中设置 OpenFeint 排行榜和成就
- en: We'll be incorporating our Egg Drop game with the OpenFeint features that we
    have discussed so far.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将把我们的 Egg Drop 游戏与到目前为止讨论过的 OpenFeint 功能结合起来。
- en: 'Create an account on the OpenFeint Developers site: [http://openfeint.com/developers](http://openfeint.com/developers).
    You can use **Egg Drop** as the game name to test and then delete it later. You
    can choose to have it work for iOS or Android or both. The choice is up to you.
    Once you''re logged in, click on the **Account Information** tab to view the **Product
    key, Product secret**, and **Client Application ID**. These will need to be added
    into your application.![Time for action—setting up OpenFeint leaderboards and
    achievements in Egg Drop](img/1888_09_04.jpg)'
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 OpenFeint 开发者网站上创建一个账户：[http://openfeint.com/developers](http://openfeint.com/developers)。您可以使用
    **Egg Drop** 作为游戏名称进行测试，然后稍后删除它。您可以选择使其适用于 iOS 或 Android 或两者都适用。选择权在您手中。登录后，点击
    **账户信息** 选项卡以查看 **产品密钥、产品密钥** 和 **客户端应用程序 ID**。这些需要添加到您的应用程序中。![操作时间——在 Egg Drop
    中设置 OpenFeint 排行榜和成就](img/1888_09_04.jpg)
- en: From the `Chapter 9` folder, copy the `Egg Drop with OF` project folder to your
    desktop. You can download the project files accompanying this book from the Packt
    website. Open up the `mainmenu.lua` file. Insert the game network features after
    the UI module and initialize it with information obtained from the OpenFeint developer
    account.
  id: totrans-250
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 `第 9 章` 文件夹中，将 `Egg Drop with OF` 项目文件夹复制到您的桌面。您可以从 Packt 网站下载本书附带的项目文件。打开
    `mainmenu.lua` 文件。在 UI 模块之后插入游戏网络功能，并使用从 OpenFeint 开发者账户获得的信息进行初始化。
- en: '[PRE40]'
  id: totrans-251
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Underneath the chunk of code pertaining to `optBtn`, create a new UI button
    called `local ofBtn` that transitions from offscreen to y=280 in 500 milliseconds.
    Add in a local function called `onOFTouch()` with an `event` parameter. Upon an
    `event.phase == "release"` have the game network display the leaderboard. Save
    and close your file.
  id: totrans-252
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在与 `optBtn` 相关的代码块下方，创建一个名为 `local ofBtn` 的新 UI 按钮，该按钮在 500 毫秒内从屏幕外过渡到 y=280。添加一个名为
    `onOFTouch()` 的本地函数，带有 `event` 参数。当 `event.phase == "release"` 时，让游戏网络显示排行榜。保存并关闭您的文件。
- en: '[PRE41]'
  id: totrans-253
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Go back into the OpenFeint developer portal and click on the **Features** tab
    and then the **Achievements** tab. Click on the orange button that says **Add
    Achievement**.![Time for action—setting up OpenFeint leaderboards and achievements
    in Egg Drop](img/1888_09_05.jpg)
  id: totrans-254
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 返回 OpenFeint 开发者门户，点击 **功能** 选项卡，然后点击 **成就** 选项卡。点击橙色按钮，上面写着 **添加成就**。![操作时间——在
    Egg Drop 中设置 OpenFeint 排行榜和成就](img/1888_09_05.jpg)
- en: The particular achievement we will create is when the character catches his
    first egg. Create a title for the achievement, determine a point value you want
    to determine out of 1000 Feint points, and write a short subscription. You can
    add an achievement icon if you wish, but is not necessary for this tutorial. Click
    on **Save Achievement** when you have finished.![Time for action—setting up OpenFeint
    leaderboards and achievements in Egg Drop](img/1888_09_06.jpg)
  id: totrans-255
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将创建的特定成就是当角色第一次接住鸡蛋时。为成就创建一个标题，确定您想要从1000个Feint积分中确定的点值，并写一个简短的订阅说明。如果您愿意，可以添加成就图标，但在这个教程中不是必需的。完成操作后，点击**保存成就**。![操作时间——在Egg
    Drop中设置OpenFeint排行榜和成就](img/1888_09_06.jpg)
- en: In the next screen, you will see the achievement added along with a **Unique
    ID**, which we'll be using to create an achievement in the game. You will be using
    your own Unique ID that is generated for you in OpenFeint unlike the one displayed
    in the following screenshot:![Time for action—setting up OpenFeint leaderboards
    and achievements in Egg Drop](img/1888_09_07.jpg)
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一屏，您将看到添加的成就以及一个**唯一标识符**，我们将使用它来在游戏中创建一个成就。您将使用为您在OpenFeint中生成的唯一标识符，而不是以下截图显示的那个：![操作时间——在Egg
    Drop中设置OpenFeint排行榜和成就](img/1888_09_07.jpg)
- en: Open the `maingame.lua` file in the project folder. In the `onEggCollision()`
    function, locate the `if` statement containing `event.force > 1.0 and self.isHit
    == false`. Create another `if` statement near the bottom of the function that
    requests `gameNetwork()`, the achievement, and your own Unique ID when one egg
    has been caught.
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在项目文件夹中打开`maingame.lua`文件。在`onEggCollision()`函数中，找到包含`event.force > 1.0 and
    self.isHit == false`的`if`语句。在函数底部附近创建另一个`if`语句，当接住一个鸡蛋时，请求`gameNetwork()`、成就和您的唯一标识符。
- en: '[PRE42]'
  id: totrans-258
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Go back to the OpenFeint developer portal and click on the **Leaderboards**
    tab. Click on the orange button that says **Add Leaderboard**. You can create
    any name that pertains to the level. You can keep the checkboxes as is. Click
    on the **Save Leaderboard** button.![Time for action—setting up OpenFeint leaderboards
    and achievements in Egg Drop](img/1888_09_08.jpg)
  id: totrans-259
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 返回OpenFeint开发者门户，点击**排行榜**标签。点击显示**添加排行榜**的橙色按钮。您可以创建任何与关卡相关的名称。您可以保留复选框不变。点击**保存排行榜**按钮。![操作时间——在Egg
    Drop中设置OpenFeint排行榜和成就](img/1888_09_08.jpg)
- en: You will be greeted with your new Unique ID for the Leaderboard on the next
    screen.![Time for action—setting up OpenFeint leaderboards and achievements in
    Egg Drop](img/1888_09_09.jpg)
  id: totrans-260
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一屏，您将看到排行榜的新唯一标识符。![操作时间——在Egg Drop中设置OpenFeint排行榜和成就](img/1888_09_09.jpg)
- en: In the `maingame.lua` file, locate the `callGameOver()` function. Within the
    `if` statement that says `gameScore > highScore`, add in the `gameNetwork()` request
    to post the highest score of the game to OpenFeint. Use the Unique ID to fill
    in the `Leaderboard ID`. You will be using your own Unique ID for the Leaderboard
    which was generated for you in OpenFeint to determine the high score, `score=gamescore`.
    Save your file.
  id: totrans-261
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`maingame.lua`文件中，找到`callGameOver()`函数。在说`gameScore > highScore`的`if`语句中，添加请求将游戏最高分发布到OpenFeint的`gameNetwork()`请求。使用唯一标识符填写`排行榜ID`。您将使用在OpenFeint中为您生成的唯一标识符来确定最高分，`score=gamescore`。保存您的文件。
- en: '[PRE43]'
  id: totrans-262
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE43]'
- en: Adding achievements and leaderboards is done! OpenFeint capabilities cannot
    be run on the simulator. You'll have to load the game build to a device to view
    the results.
  id: totrans-263
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 成就排行榜的添加已完成！OpenFeint的功能不能在模拟器上运行。您需要将游戏构建加载到设备上才能查看结果。
- en: What just happened?
  id: totrans-264
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 刚才发生了什么？
- en: '`gameNetwork.init()` initializes an app with the parameters `("openfeint","<OpenFeint
    Product Key>", "<OpenFeint Product Secret>", "Display Name", "<App ID>")` required
    by the game network provider.'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: '`gameNetwork.init()`使用游戏网络提供者所需的参数初始化一个应用，这些参数包括`("openfeint","<OpenFeint 产品密钥>",
    "<OpenFeint 产品密钥>", "显示名称", "<应用ID>")`。'
- en: The main menu displays `ofBtn` and establishes the connection to `gameNetwork.show
    ( "leaderboards" )` and opens the user's Leaderboard dashboard.
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 主菜单显示`ofBtn`并建立到`gameNetwork.show ( "leaderboards" )`的连接，并打开用户的排行榜仪表板。
- en: When adding achievements, we added `if eggCount == 1 then gameNetwork.request(
    "unlockAchievement", "1315272" ) end` in the `onEggCollision()` function because
    we know that `eggCount` is tracked through every collision made by the main character.
    This will unlock the achievement in OpenFeint since we specified it through the
    unique ID we created.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 当添加成就时，我们在`onEggCollision()`函数中添加了`if eggCount == 1 then gameNetwork.request(
    "unlockAchievement", "1315272" ) end`，因为我们知道`eggCount`是通过主要角色的每一次碰撞来跟踪的。这将解锁OpenFeint中的成就，因为我们通过我们创建的唯一ID指定了它。
- en: Leaderboards keep track of the high scores implemented overall in each level.
    We added `gameNetwork.request( "setHighScore", { leaderboardID="957686", score=gameScore
    } )` within the `callGameOver()` function and inside the `if` statement that compares
    `gameScore` and `highScore`. If a high score is achieved for the level, it is
    sent to the leaderboard in OpenFeint under the unique ID set in the developer
    portal.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 排行榜跟踪每个级别中实现的最高分。我们在`callGameOver()`函数和比较`gameScore`和`highScore`的`if`语句中添加了`gameNetwork.request(
    "setHighScore", { leaderboardID="957686", score=gameScore } )`。如果达到了该级别的最高分，它将被发送到OpenFeint中的排行榜，在开发者门户中设置的唯一ID下。
- en: Note
  id: totrans-269
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Having an OpenFeint membership does not cost any money when you register under
    the developer portal. When you have completed your game, make sure to register
    it so it will have full access to OpenFeint features amongst the public.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 当你在开发者门户下注册时，拥有OpenFeint会员不需要支付任何费用。当你完成你的游戏时，请确保注册它，这样它就可以在公众中完全访问OpenFeint功能。
- en: Have a go hero—adding more OpenFeint achievements
  id: totrans-271
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 尝试一下英雄——添加更多OpenFeint成就
- en: 'By using the current game, try coming up with other achievements that can be
    unlocked and figure out how they can be accessed by OpenFeint. Here are some ideas
    to get you started:'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 通过使用当前的游戏，尝试想出其他可以解锁的成就，并找出它们如何通过OpenFeint访问。以下是一些帮助你开始的想法：
- en: Reaching a certain amount of points
  id: totrans-273
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 达到一定数量的积分
- en: Catching a certain amount of eggs
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 捕捉一定数量的鸡蛋
- en: Catching a certain amount of eggs with all three lives available
  id: totrans-275
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在所有三个生命都可用的情况下，捕捉一定数量的鸡蛋
- en: There are many possibilities that can be created. Give it a try!
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 有许多可能性可以创造。试试看！
- en: Pop quiz—handling social networks
  id: totrans-277
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 快速问答——处理社交网络
- en: What is the specific API that scales down high-resolution sprite sheets?
  id: totrans-278
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 什么是指定降低高分辨率精灵图集的特定API？
- en: a. `object.xScale`
  id: totrans-279
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: a. `object.xScale`
- en: b. `display.contentScaleX`
  id: totrans-280
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: b. `display.contentScaleX`
- en: c. `object.xReference`
  id: totrans-281
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: c. `object.xReference`
- en: d. None of the above
  id: totrans-282
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: d. 以上都不是
- en: What is the maximum amount of Feint points that can be given to a user in OpenFeint
    throughout the application?
  id: totrans-283
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在整个应用程序中，可以向用户授予的最大Feint积分是多少？
- en: a. 200
  id: totrans-284
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: a. 200
- en: b. 750
  id: totrans-285
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: b. 750
- en: c. 10000
  id: totrans-286
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: c. 10000
- en: d. 1000
  id: totrans-287
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: d. 1000
- en: Which of the following are valid parameters required for `gameNetwork.init()?`
  id: totrans-288
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下哪个是`gameNetwork.init()`所需的有效参数？
- en: a. App ID
  id: totrans-289
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: a. App ID
- en: b. Product Key
  id: totrans-290
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: b. 产品密钥
- en: c. Product Secret
  id: totrans-291
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: c. 产品密钥
- en: d. All of the above
  id: totrans-292
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: d. 所有以上选项
- en: Summary
  id: totrans-293
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: We have covered several more areas on enhancing configuration settings and integrating
    three of the most popular social networks in today's media in our apps.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在我们的应用程序中涵盖了更多关于增强配置设置和集成当今媒体中最受欢迎的三个社交网络的内容。
- en: 'We took an in-depth look into:'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 我们深入研究了以下内容：
- en: Build settings
  id: totrans-296
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建设置
- en: Dynamic content scaling and dynamic image resolution
  id: totrans-297
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 动态内容缩放和动态图像分辨率
- en: High-resolution sprite sheets
  id: totrans-298
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 高分辨率精灵图集
- en: Post message feeds to Twitter and Facebook
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将消息推送到Twitter和Facebook
- en: Implement achievements and leaderboards in OpenFeint
  id: totrans-300
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在OpenFeint中实现成就和排行榜
- en: In the next chapter, we will go over the process on how to submit our games
    to the App Store and Google Play Store. You don't want to miss this for the world!
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将介绍如何将我们的游戏提交到App Store和Google Play Store的过程。你绝对不想错过这个机会！
