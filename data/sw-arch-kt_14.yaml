- en: '14'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '14'
- en: Security
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安全
- en: This chapter covers the fundamental principles and practices associated with
    system security, with a focus on the aspects that affect software architecture
    and the everyday life of engineers.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖了与系统安全相关的根本原则和实践，重点关注影响软件架构和工程师日常生活的方面。
- en: It begins by defining key concepts such as **confidentiality**, **integrity**,
    and **availability** (the **CIA** triad), which form the backbone of security
    strategies. The chapter outlines several types of threats, including malware,
    phishing, and insider attacks, highlighting the need for comprehensive risk assessment
    and management.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 它首先定义了关键概念，如**机密性**、**完整性**和**可用性**（**CIA**三要素），这些构成了安全策略的基石。本章概述了几种威胁类型，包括恶意软件、钓鱼和内部攻击，强调了进行全面风险评估和管理的重要性。
- en: Next, it explores various aspects of authentication and how it affects the engineering
    design of software features, such as **multi-factor authentication** (**MFA**).
    Then, we will discuss how to use access control to ensure that only authorized
    users can access certain resources.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，它探讨了各种认证方面及其如何影响软件功能的工程设计，例如**多因素认证**（**MFA**）。然后，我们将讨论如何使用访问控制确保只有授权用户可以访问特定资源。
- en: Additionally, the chapter addresses compliance with legal and regulatory requirements,
    such as the **General Data Protection Regulation** (**GDPR**) and the **Health
    Insurance Portability and Accountability Act** (**HIPAA**), and it shapes security
    practices. Moreover, we will explore some ways we can handle confidential data
    in the system.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，本章还讨论了遵守法律和监管要求，如**通用数据保护条例**（**GDPR**）和**健康保险可携带性和问责法案**（**HIPAA**），并塑造安全实践。此外，我们将探讨一些处理系统中机密数据的方法。
- en: We will delve into how network security shapes software architecture, such as
    security layers, encryption, and secure API designs that protect the system from
    malicious attacks.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将深入探讨网络安全如何塑造软件架构，例如安全层、加密和安全的API设计，这些设计可以保护系统免受恶意攻击。
- en: Finally, we will run an exercise of threat modeling with a real-life example.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们将通过一个真实案例进行威胁建模练习。
- en: 'We are going to cover the following topics:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将涵盖以下主题：
- en: Authentication
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 认证
- en: Authorization
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 授权
- en: Handling sensitive data
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 处理敏感数据
- en: Network security
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络安全
- en: DevSecOps and threat modeling
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: DevSecOps和威胁建模
- en: Technical requirements
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'You can find all the code files used in this chapter on GitHub: [https://github.com/PacktPublishing/Software-Architecture-with-Kotlin/tree/main/chapter-14](https://github.com/PacktPublishing/Software-Architecture-with-Kotlin/tree/main/chapter-14)'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在GitHub上找到本章使用的所有代码文件：[https://github.com/PacktPublishing/Software-Architecture-with-Kotlin/tree/main/chapter-14](https://github.com/PacktPublishing/Software-Architecture-with-Kotlin/tree/main/chapter-14)
- en: The importance of security in software architecture
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 软件架构中安全的重要性
- en: '**System security** refers to the processes, measures, and practices implemented
    to protect information systems from unauthorized access, misuse, damage, or disruption.
    It includes a wide range of mechanisms aimed at safeguarding the confidentiality,
    integrity, and availability of data and resources within a system.'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '**系统安全**指的是实施的过程、措施和实践，旨在保护信息系统免受未经授权的访问、滥用、损害或中断。它包括一系列旨在保护系统内数据和资源机密性、完整性和可用性的机制。'
- en: System security consists of multiple dimensions, including hardware, software,
    policies, and human factors, to create resistance against malicious threats and
    vulnerabilities.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 系统安全包括多个维度，包括硬件、软件、政策和人为因素，以对抗恶意威胁和漏洞。
- en: 'Software systems often handle sensitive information. Sensitive data can be
    grouped into several categories:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 软件系统通常处理敏感信息。敏感数据可以分成几个类别：
- en: '**Personally identifiable information (PII)**: Full names, dates of birth,
    addresses, telephone numbers, and personal email addresses'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**个人身份信息（PII）**：全名、出生日期、地址、电话号码和个人电子邮件地址'
- en: '**Personal information**: Health insurance policies, medical test results,
    treatment records, prescriptions, education certificates, transcripts, university
    grades, and student identification numbers'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**个人信息**：健康保险政策、医疗检测结果、治疗记录、处方、教育证书、成绩单、大学成绩和学号'
- en: '**Authentication credentials**: Passwords, PINs, security questions and answers,
    and fingerprints'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**认证凭证**：密码、PIN码、安全问题和答案以及指纹'
- en: '**Financial information**: Bank account details, credit card numbers, tax returns,
    financial statements, and income information'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**财务信息**：银行账户详情、信用卡号码、税务申报、财务报表和收入信息'
- en: '**Confidential business information**: Client lists, business plans, trade
    secrets, and internal communications'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**机密商业信息**：客户名单、商业计划、商业机密和内部通讯'
- en: '**Legal documents**: Contracts, litigation documents, and settlement agreements'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**法律文件**：合同、诉讼文件和和解协议'
- en: '**Intellectual property**: Copyrights, patents, trademarks, source code, user
    activity history, system data, and proprietary algorithms'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**知识产权**：版权、专利、商标、源代码、用户活动历史、系统数据和专有算法'
- en: '**Government and national security information**: Government contracts, intelligence
    reports, and classified documents'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**政府和国家安全信息**：政府合同、情报报告和机密文件'
- en: Ensuring security in software architecture shields sensitive data from unauthorized
    access, breaches, and leaks, maintaining confidentiality and privacy.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 确保软件架构的安全性可以保护敏感数据免受未经授权的访问、泄露和破坏，维护机密性和隐私。
- en: Security measures protect the integrity of data throughout its life cycle, free
    from unauthorized modifications. This can guarantee that users receive accurate
    and reliable information, which is important for decision-making and trust.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 安全措施在整个数据生命周期中保护数据的完整性，防止未经授权的修改。这可以保证用户接收到的信息准确可靠，这对于决策和信任至关重要。
- en: A secure software architecture is designed to withstand vicious attacks and
    ensure that services are available to legitimate users. This is critical for maintaining
    business continuity, building a positive reputation, fostering satisfaction and
    trust among users, and providing competitive advantages.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 一个安全的软件架构旨在抵御恶意攻击，并确保合法用户能够获得服务。这对于维持业务连续性、建立积极的声誉、培养用户满意度和信任以及提供竞争优势至关重要。
- en: Many industries are subject to regulations regarding data protection and privacy,
    such as GDPR in the European Union and HIPAA in the United States. Software architecture
    compliant with these regulations protects organizations from legal penalties and
    reputational damage.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 许多行业都受到关于数据保护和隐私的法规的约束，例如欧盟的GDPR和美国 HIPAA。符合这些法规的软件架构可以保护组织免受法律处罚和声誉损害。
- en: Security should be part of the early phase of software architecture design.
    The design process involves identifying potential threats and vulnerabilities.
    Proactively addressing security risks reduces the chance of security incidents
    from day one. It is also more cost-effective to implement security measures early
    than after a breach happens. The financial losses related to legal fees, remediations,
    and loss of business can be massive.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 安全应成为软件架构设计早期阶段的一部分。设计过程包括识别潜在威胁和漏洞。积极应对安全风险可以减少从第一天开始的安全事件发生的可能性。在发生漏洞之前实施安全措施也比之后更经济有效。与法律费用、补救措施和业务损失相关的财务损失可能非常巨大。
- en: Security threats are constantly evolving, and a well-designed software architecture
    is flexible to incorporate new security technologies and practices. This adaptability
    and extensibility are essential for staying ahead of potential vulnerabilities
    and maintaining a robust security posture.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 安全威胁不断演变，一个精心设计的软件架构能够灵活地融入新的安全技术和实践。这种适应性和可扩展性对于保持对潜在漏洞的领先地位和维持强大的安全态势至关重要。
- en: Security-focused architecture encourages the integration of secure coding practices
    into the software development cycle, such as **DevSecOps**. This cultural shift
    enhances overall security awareness within development teams.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 以安全为重点的架构鼓励将安全编码实践整合到软件开发周期中，例如**DevSecOps**。这种文化转变增强了开发团队的整体安全意识。
- en: A secure system is supported by logging, monitoring, and alerting mechanisms
    that facilitate quick detection and response to security incidents, as discussed
    in [*Chapter 11*](B21737_11.xhtml#_idTextAnchor358). This is essential for reducing
    damage and recovering from breaches effectively.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 一个安全系统依赖于日志记录、监控和警报机制，这些机制有助于快速检测和响应安全事件，正如在[*第11章*](B21737_11.xhtml#_idTextAnchor358)中讨论的那样。这对于减少损害和有效恢复漏洞至关重要。
- en: By prioritizing security from the beginning, organizations can build resilient
    systems that not only defend against current threats but also adapt to future
    challenges, fostering trust and enhancing their overall business success. One
    of the most discussed foundations of security is the CIA triad, which we are going
    to cover next.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 通过从一开始就优先考虑安全性，组织可以构建具有弹性的系统，这些系统能够不仅防御当前威胁，还能适应未来挑战，从而培养信任并增强其整体商业成功。安全性的最被讨论的基础之一是CIA三要素，我们将在下一部分介绍。
- en: The CIA triad
  id: totrans-37
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: CIA三要素
- en: 'The **CIA triad** is a foundational model in information security that outlines
    the three core principles of information security: **confidentiality**, **integrity**,
    and **availability**. It was initially mentioned in *Computer Security Technology
    Planning Study*, known as *The Anderson Report*, in 1972, authored by a team led
    by William Anderson. The concept was then discussed in the book, *Computer Security
    A Practitioner’s Approach* in the 1980s by Frederick Cohen. The term *CIA triad*
    was coined later by Steve Lipner around 1986\. The CIA triad was popularized by
    Willis Ware in 1993 from his study distributed by the US think tank, **Research
    and Development Corporation** (**RAND**). Since then, it has gained popularity
    in the cybersecurity landscape.'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '**CIA三要素**是信息安全的基础模型，概述了信息安全三个核心原则：**机密性**、**完整性**和**可用性**。它最初在1972年的《计算机安全技术规划研究》中提及，也称为**安德森报告**，由威廉·安德森领导的团队撰写。该概念随后在20世纪80年代由弗雷德里克·科恩在其著作《计算机安全实践者的方法》中讨论。术语**CIA三要素**后来由史蒂夫·利普纳在1986年左右提出。CIA三要素在1993年由威利斯·沃尔从其在美国智库**研究与开发公司**（**RAND**）分发的研究中推广。从那时起，它在网络安全领域获得了普及。'
- en: 'The CIA triad is shown in *Figure 14**.1*:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: CIA三要素如图*14.1*所示：
- en: '![Figure 14.1 – The CIA triad](img/B21737_14_1.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![图14.1 – CIA三要素](img/B21737_14_1.jpg)'
- en: Figure 14.1 – The CIA triad
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.1 – CIA三要素
- en: We will briefly introduce each principle in the following sections.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在以下部分简要介绍每个原则。
- en: Confidentiality
  id: totrans-43
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 机密性
- en: '**Confidentiality** ensures that sensitive information is only accessible to
    authorized individuals or systems. This includes keeping data away from bad actors
    with malicious intent. Individuals within an organization are also subject to
    limits on data access.'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '**机密性**确保敏感信息仅对授权的个人或系统可访问。这包括将数据远离具有恶意意图的恶意行为者。组织内的个人也受到数据访问的限制。'
- en: 'Common methods to maintain confidentiality include the following:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 维护机密性的常见方法包括以下内容：
- en: '**Authentication**: Confirm the identity of a user, device, or system. The
    primary goal is to ensure that an entity trying to access a system is who they
    claim to be.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**身份验证**：确认用户、设备或系统的身份。主要目标是确保试图访问系统的实体是其声明的身份。'
- en: '**Authorization**: Grant or deny an authenticated identity to specific resources,
    actions, or data within a system.'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**授权**：授予或拒绝已验证身份对系统内特定资源、操作或数据的访问权限。'
- en: '**Encryption**: Convert readable data into encoded data to prevent unauthorized
    access. Even if unauthorized individuals have obtained encrypted data, they need
    to also have the keys and know the decryption algorithm to unlock the data.'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**加密**：将可读数据转换为编码数据以防止未经授权的访问。即使未经授权的个人获得了加密数据，他们也需要拥有密钥并知道解密算法才能解锁数据。'
- en: '**Redaction**: Retain functionality and usability without exposing sensitive
    information.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**编辑**：在不暴露敏感信息的情况下保留功能性和可用性。'
- en: Some of these methods will be used and discussed in the sections ahead.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 其中一些方法将在接下来的部分中使用和讨论。
- en: Integrity
  id: totrans-51
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 完整性
- en: '**Integrity** refers to the accuracy and consistency of data throughout its
    life cycle. This principle ensures that information is not altered or tampered
    with by unauthorized users and that it remains accurate, trustworthy, and reliable.'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '**完整性**指的是数据在其整个生命周期中的准确性和一致性。这一原则确保信息不会被未经授权的用户更改或篡改，并且保持准确、可靠和可信。'
- en: 'Common techniques to ensure integrity include the following:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 确保完整性的常见技术包括以下内容：
- en: '**Checksums and hash functions**: A fixed-length string calculated from the
    data by an algorithm. Checksums or hash values usually come with the data itself.
    Any tampering with the data would produce a checksum (or hash value) different
    from the original checksum, so it is detected by the system as corrupted data.'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**校验和与哈希函数**：通过算法从数据计算出的固定长度字符串。校验和或哈希值通常与数据本身一起提供。任何对数据的篡改都会产生与原始校验和不同的校验和（或哈希值），因此系统会将其检测为损坏的数据。'
- en: '**Digital signatures**: A document is signed by a hash value generated by a
    private key from the sender. The recipient receives the document together with
    the digital signature. The recipient computes the hash value of the document using
    the same algorithm. The recipient decrypts the digital signature using the sender’s
    public key and retrieves the original hash value. Two hash values being identical
    confirms that the document has not been modified. The sender’s private and public
    keys form a pair, whereas the private key is only known to the sender and the
    public key is available to anyone.'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数字签名**：文档由发送者使用其私钥生成的哈希值进行签名。接收者收到文档及其数字签名。接收者使用相同的算法计算文档的哈希值。接收者使用发送者的公钥解密数字签名并检索原始哈希值。两个哈希值相同确认文档未被修改。发送者的私钥和公钥形成一对，其中私钥仅发送者知道，公钥对任何人都是可用的。'
- en: '**Versioning control**: Version control systems maintain a complete audit trail
    and history of changes made to a document. If errors or corruptions are detected,
    the document can be reverted to a previous version.'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**版本控制**：版本控制系统维护对文档所做的更改的完整审计跟踪和历史记录。如果检测到错误或损坏，可以将文档回滚到先前的版本。'
- en: Availability
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 可用性
- en: '**Availability** ensures that information and resources are accessible to authorized
    users when needed. This principle focuses on maintaining system functionality
    and minimizing downtime due to attacks, failures, or other disruptions.'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '**可用性**确保在需要时信息资源对授权用户是可访问的。这一原则侧重于保持系统功能并最小化由于攻击、故障或其他中断造成的停机时间。'
- en: 'Strategies to enhance availability include the following:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 提高可用性的策略包括以下内容：
- en: '**Redundancy**: Avoid a single point of failure by having extra components
    and alternative paths to ensure continued operations and data integrity in the
    event of failure.'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**冗余**：通过拥有额外的组件和替代路径来避免单点故障，以确保在发生故障时持续运行和保持数据完整性。'
- en: '**Load balancing**: Distribute incoming traffic across multiple servers to
    ensure incoming requests are served.'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**负载均衡**：将传入流量分配到多个服务器，以确保处理传入请求。'
- en: '**Regular backups**: Maintain copies of the database, file storage, and messaging
    store across multiple servers or locations to ensure data availability and to
    recover from data issues.'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**定期备份**：在多个服务器或位置维护数据库、文件存储和消息存储的副本，以确保数据可用性并从数据问题中恢复。'
- en: '**Disaster recovery planning and drills**: Outline specific steps to take during
    a disaster to bring the system back up and make it operational. Periodically run
    disaster recovery drills to verify the plan and identify gaps. Establish clear
    communication channels to keep engineers and stakeholders informed during a disaster.'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**灾难恢复计划和演练**：概述在灾难期间采取的具体步骤以恢复系统并使其运行。定期进行灾难恢复演练以验证计划并识别差距。在灾难期间建立清晰的沟通渠道，以保持工程师和利益相关者的信息。'
- en: Importance of the CIA triad
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 重要性：CIA 三角模型
- en: The CIA triad serves as a guiding framework for organizations to develop and
    implement effective security policies and practices. These three principles help
    organizations create a comprehensive approach to information security and protect
    the business from various threats and vulnerabilities.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: CIA三边模型作为组织发展和实施有效安全政策和实践的指导框架。这三个原则帮助组织创建一个全面的信息安全方法，并保护业务免受各种威胁和漏洞的侵害。
- en: We are going to go deeper into selected subjects that are based on the CIA triad.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将深入探讨基于CIA三边模型的选择性主题。
- en: Authentication
  id: totrans-67
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 认证
- en: '**Authentication** is the process of verifying the identity of a user or a
    device before granting access to resources. This is the first step of establishing
    trust between two parties. An oversimplified authentication process looks like
    *Figure 14**.2*:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '**认证**是在授予资源访问权限之前验证用户或设备身份的过程。这是建立双方之间信任的第一步。一个简化的认证过程看起来像 *图 14.2*：'
- en: '![Figure 14.2 – Oversimplified interaction of authentication](img/B21737_14_2.jpg)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![图 14.2 – 认证交互的简化表示](img/B21737_14_2.jpg)'
- en: Figure 14.2 – Oversimplified interaction of authentication
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.2 – 认证交互的简化表示
- en: The client (a user, a device, or a system) initiates the authentication with
    the target system, and it provides credentials to claim who it is. The system
    receives the credentials and starts the verification process. The system acknowledges
    a positive result if it can identify the client, otherwise, a rejection is sent
    back to the entity.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 客户端（用户、设备或系统）与目标系统启动认证，并提供凭证以声明其身份。系统接收凭证并开始验证过程。如果系统能够识别客户端，则确认结果为阳性，否则将向实体发送拒绝。
- en: This interaction is merely conceptual as actual authentication has a lot of
    aspects to consider. Firstly, the transport layer needs to be secured to ensure
    there is no eavesdropping, also known as **man-in-the-middle** (**MitM**) attacks.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 这种交互仅仅是概念性的，因为实际的认证需要考虑很多方面。首先，传输层需要被保护以确保没有窃听，也称为**中间人攻击**（**MitM**）。
- en: MitM attack
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: MitM攻击
- en: A MitM attack is a cyberattack where an attacker secretly intercepts and relays
    communication between two parties. The attacker eavesdrops and captures communication
    potentially containing sensitive information. The attack might alter the messages
    exchanged or record them for further malicious intents, such as identity theft
    and financial fraud. MitM attacks can occur in various forms, such as intercepting
    unencrypted Wi-Fi traffic, exploiting vulnerabilities in secure communications,
    or tricking users into connecting to malicious networks. The attack threatens
    the confidentiality and integrity of communication among individuals and organizations.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 中间人攻击是一种网络攻击，攻击者秘密地拦截并转发两个当事人之间的通信。攻击者窃听并捕获可能包含敏感信息的通信。攻击可能会更改交换的消息或记录它们以进行进一步的恶意目的，例如身份盗窃和金融欺诈。中间人攻击可以以各种形式发生，例如拦截未加密的Wi-Fi流量、利用安全通信中的漏洞或诱骗用户连接到恶意网络。这种攻击威胁到个人和组织之间通信的机密性和完整性。
- en: Transport Layer Security (TLS)
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 传输层安全（TLS）
- en: '**Transport Layer Security** (**TLS**) plays a significant role in securing
    communications over networks, as a defense against threats, such as MitM, we have
    just mentioned.'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '**传输层安全**（**TLS**）在网络通信安全中发挥着重要作用，作为对如我们刚才提到的中间人攻击等威胁的防御。'
- en: TLS evolved from its predecessor, **Secure Sockets Layer** (**SSL**). SSL was
    first developed by Netscape in 1994, as a protocol aimed to provide secure communications
    over the internet. It was never published due to security flaws. Subsequently,
    SSL 2.0 and SSL 3.0 were released, but they still faced vulnerabilities that led
    to the need for further development.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: TLS是从其前身**安全套接字层**（**SSL**）演变而来的。SSL最初由Netscape于1994年开发，旨在提供互联网上的安全通信协议。由于安全漏洞，它从未发布。随后，发布了SSL
    2.0和SSL 3.0，但它们仍然面临着需要进一步发展的漏洞。
- en: TLS was first released in 1999\. It was based on SSL 3.0 but it addressed the
    weaknesses of SSL and it provided better support for modern cryptographic algorithms.
    Subsequent versions of TLS have brought significant improvements in security and
    performance. TLS is widely used in various ways to secure communications on the
    internet, such as secure web browsing, email content encryption, secure messaging,
    **virtual private networks** (**VPNs**), and secure inter-system communications.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: TLS首次于1999年发布。它基于SSL 3.0，但解决了SSL的弱点，并提供了对现代加密算法的更好支持。TLS的后续版本在安全性和性能方面带来了重大改进。TLS广泛用于各种方式，以在互联网上确保通信安全，例如安全网页浏览、电子邮件内容加密、安全消息、**虚拟私人网络**（**VPNs**）和安全的系统间通信。
- en: 'TLS requires the client and server to exchange a few rounds of messages to
    establish a secure transport communication. TLS is built on top of **Transmission
    Control Protocol** (**TCP**). The first few steps are the messages exchanged to
    establish a TCP connection. Afterward, there are a few exchanges of messages to
    establish a TLS communication:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: TLS要求客户端和服务器交换几轮消息以建立安全的传输通信。TLS建立在**传输控制协议**（**TCP**）之上。最初的几个步骤是交换消息以建立TCP连接。之后，有几轮消息交换以建立TLS通信：
- en: '**Client hello**: The client initiates TLS by sending to the server a message
    specifying supported TLS versions, cipher suites (known as encryption algorithms),
    and a random number generated by the client.'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**客户端问候**：客户端通过向服务器发送一条消息来启动TLS，该消息指定了支持的TLS版本、密码套件（称为加密算法）以及客户端生成的随机数。'
- en: '**Server hello**: The server responds with its chosen TLS version and cipher
    suite, and a random number generated by the server.'
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**服务器问候**：服务器通过选择TLS版本和密码套件以及服务器生成的随机数来响应。'
- en: '**Server certificate**: The server sends its TLS certificate containing the
    server’s public key and is signed by a trusted **certificate authority** (**CA**).
    Certain cipher suites require the server to include additional key exchange parameters.'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**服务器证书**：服务器发送其包含服务器公钥并由受信任的**证书机构**（**CA**）签名的TLS证书。某些加密套件要求服务器包含额外的密钥交换参数。'
- en: CA
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: CA
- en: A CA is a trusted entity that issues digital certificates to verify the identity
    of individuals, organizations, or devices within a secure communication framework.
    CAs play a crucial role in **public key infrastructure** (**PKI**) by binding
    public keys to the identities of their owners, enabling secure protocols, such
    as TLS/SSL, for encrypted communication. They conduct identity verification before
    issuing certificates, maintain a chain of trust through root and intermediate
    certificates, and manage certificate revocation to ensure ongoing security. By
    providing this trust foundation, CAs enable users to confidently communicate and
    transact over the internet.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: CA是一个受信任的实体，它向个人、组织或设备颁发数字证书，以验证在安全通信框架内的身份。CA通过将公钥绑定到其所有者的身份，在**公钥基础设施**（**PKI**）中扮演着至关重要的角色，使TLS/SSL等安全协议能够进行加密通信。它们在颁发证书之前进行身份验证，通过根证书和中间证书维护信任链，并管理证书吊销以确保持续的安全性。通过提供这个信任基础，CA使用户能够自信地在互联网上进行通信和交易。
- en: '**Server hello done**: The server acknowledges finishing its part of the handshake.'
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**服务器握手完成**：服务器确认其握手部分的完成。'
- en: '**Client key exchange**: The client generates a pre-master secret, which is
    a random string without meaningful data, encrypts it with the server’s public
    key received from the server certificate, and sends it to the server.'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**客户端密钥交换**：客户端生成一个预主密钥，这是一个没有有意义数据的随机字符串，使用从服务器证书中接收到的服务器公钥对其进行加密，并将其发送到服务器。'
- en: '**Session keys creation**: Both the client and server use the pre-master secret
    along with the previously exchanged random numbers to generate session keys. These
    keys will be used for encrypting the data during the session.'
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**会话密钥生成**：客户端和服务器使用预主密钥以及之前交换的随机数来生成会话密钥。这些密钥将用于会话期间的数据加密。'
- en: '`Finished` messages, indicating that the handshake is complete and that they
    will now start using the session keys for secure communication.'
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`Finished`消息，表示握手已完成，他们现在将开始使用会话密钥进行安全通信。'
- en: 'The interaction is shown in *Figure 14**.3*:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 交互过程如图*14**.3*所示：
- en: '![Figure 14.3 – TLS handshaking](img/B21737_14_3.jpg)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![图14.3 – TLS握手](img/B21737_14_3.jpg)'
- en: Figure 14.3 – TLS handshaking
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.3 – TLS握手
- en: During the TLS handshake, both the client and server independently generate
    session keys that are unique to that session only. Any replay of messages outside
    the session is not valid and will be detected. The session key never exists in
    messages exchanged.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 在TLS握手过程中，客户端和服务器独立生成仅适用于该会话的会话密钥。任何会话外的消息重放都是无效的，并且将被检测到。会话密钥永远不会存在于交换的消息中。
- en: Also, if a MitM attacker wants to decrypt the content of application data, it
    needs the symmetric session key. The session key is formed by random numbers generated
    by both sides and the pre-master secret. The pre-master secret can only be decrypted
    by the server’s private key, which is never exposed in any message exchanged.
    In other words, the MitM attackers cannot read the encrypted application data.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，如果中间人攻击者想要解密应用程序数据的内容，它需要对称的会话密钥。会话密钥是由双方生成的随机数和预主密钥形成的。预主密钥只能由服务器的私钥解密，该私钥永远不会在任何消息中暴露。换句话说，中间人攻击者无法读取加密的应用程序数据。
- en: In addition, each message exchanged contains a sequence number. Any out-of-order
    message will be detected and not processed further. Each message also contains
    a **Message Authentication Code** (**MAC**) that acts like a checksum to confirm
    whether the data has been altered in transit.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，每个交换的消息都包含一个序列号。任何顺序错误的消息都将被检测到，并且不会进一步处理。每个消息还包含一个**消息认证码**（**MAC**），它就像一个校验和，用于确认数据在传输过程中是否被更改。
- en: TLS uses digital certificates issued by trusted CAs to authenticate the server’s
    identity. This prevents MitM attacks, where an attacker impersonates the server.
    In the case of mutual TLS, the client can also present a certificate to prove
    its identity, further enhancing security.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: TLS使用受信任的CA颁发的数字证书来验证服务器的身份。这防止了中间人攻击，其中攻击者冒充服务器。在双向TLS的情况下，客户端也可以出示证书以证明其身份，从而进一步增强安全性。
- en: At this point, we have confidence that we have secure transport between the
    clients and the server. However, we still need to verify the identity of the client
    to authorize resources and actions allowed. We are going to discuss further how
    to authenticate the client in the next section.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，我们相信我们已经在客户端和服务器之间建立了安全的传输。然而，我们仍然需要验证客户端的身份以授权资源和允许的操作。我们将在下一节进一步讨论如何验证客户端。
- en: Multi-factor authentication (MFA)
  id: totrans-97
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 多因素认证（MFA）
- en: 'Simple authentication requires only one such piece of evidence (known as a
    factor), typically a password. This approach has several weaknesses that make
    it inadequate for securing sensitive information:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 简单的身份验证只需要一个这样的证据（称为因素），通常是密码。这种方法有几个弱点，使其不足以保护敏感信息：
- en: '**Weak passwords**: Easily guessed by attackers'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**弱密码**：容易被攻击者猜到'
- en: '**Phishing**: Attackers trick users into revealing their passwords (e.g., fake
    landing page)'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**钓鱼攻击**：攻击者诱骗用户泄露他们的密码（例如，伪造的登录页面）'
- en: '**Password reuse**: If one password is compromised, attackers can access other
    services using the same password'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**密码重用**：如果一个密码被泄露，攻击者可以使用相同的密码访问其他服务'
- en: '**Brute force**: Automated tools can keep guessing the one password'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**暴力破解**：自动化工具可以不断猜测一个密码'
- en: '**Social engineering**: Manipulate users into sharing passwords'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**社会工程学**：操纵用户共享密码'
- en: '**No user verification**: Password verification only checks whether the provided
    credentials are the same as the ones in the record, instead of verifying that
    the person attempting to gain access is the actual user'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**无用户验证**：密码验证仅检查提供的凭据是否与记录中的凭据相同，而不是验证试图获取访问权限的人是否是实际用户'
- en: 'MFA aims to harden the authentication process by verifying multiple factors,
    further validating that the user is who they claim to be. These factors are categorized
    into three groups:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 多因素认证旨在通过验证多个因素来强化身份验证过程，进一步验证用户是他们所声称的人。这些因素分为三个类别：
- en: '**Knowledge factor**: Passwords, security questions and answers, PINs, or IDs'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**知识因素**：密码、安全问题和答案、PIN码或ID'
- en: '**Possession factor**: Smartphones, hardware tokens, authentication applications,
    and one-time passcodes'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**持有因素**：智能手机、硬件令牌、身份验证应用程序和一次性密码'
- en: '**Biometric factor**: Fingerprints, faces, and voices'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**生物识别因素**：指纹、面部和声音'
- en: At a minimum, MFA requires at least two factors from distinct categories. It
    is less likely for attackers to get a hold of multiple factors from a target user,
    and thus it reduces the risk of unauthorized access. Moreover, some industries,
    such as banking, have regulatory requirements to enforce the use of MFA to protect
    sensitive data.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 至少，多因素认证需要来自不同类别的至少两个因素。攻击者从目标用户那里获取多个因素的可能性较小，因此它降低了未经授权访问的风险。此外，一些行业，如银行，有监管要求强制使用多因素认证来保护敏感数据。
- en: It is worth pointing out that MFA does not necessarily require TLS, but using
    TLS for MFA is strongly recommended to ensure there is no eavesdropping and interception
    during the MFA process, especially when transmitting sensitive information, such
    as biometric data and passwords.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 值得指出的是，多因素认证不必要地需要TLS，但强烈建议使用TLS进行多因素认证，以确保在多因素认证过程中没有窃听和拦截，尤其是在传输敏感信息（如生物识别数据和密码）时。
- en: Implications of MFA to software architecture
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 多因素认证对软件架构的影响
- en: The prevalence of MFA in everyday life, such as online banking and e-commerce,
    has influenced modern software architecture. There is a strong need for dedicated
    services to focus on authentication and decouple from business logic. This is
    due to the high complexity of the authentication process and the sensitivity of
    the data it handles. It is better to have a service specialized in authentication
    that keeps sensitive data within its bounded context to reduce risks.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 多因素认证（MFA）在日常生活中的普及，例如在线银行和电子商务，已经影响了现代软件架构。迫切需要专门的服务来专注于身份验证并从业务逻辑中分离出来。这是由于身份验证过程的高度复杂性和处理数据的敏感性。最好有一个专门从事身份验证的服务，将敏感数据保持在其边界范围内以降低风险。
- en: 'Together with the rise of serverless cloud computing, as discussed in [*Chapter
    6*](B21737_06.xhtml#_idTextAnchor212), every organization that runs its services
    in the cloud must choose one of the following:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 与第6章中讨论的无服务器云计算的兴起一起，每个在云中运行其服务的组织都必须选择以下之一：
- en: The **identity providers** (**IdPs**) native to the cloud providers (e.g., Active
    Directory for Azure, Google Identity for GCP, Cognito for AWS)
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 云提供商原生的 **身份提供者**（**IdP**）（例如，Azure 的 Active Directory，GCP 的 Google Identity，AWS
    的 Cognito）
- en: Platform independent IdPs, such as Okta, Auth0, and Duo Security
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 平台独立的 IdP，例如 Okta，Auth0 和 Duo Security
- en: Write its own **identity and access management** (**IAM**) service, optionally
    as a proxy to other IdPs
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 编写自己的 **身份和访问管理**（**IAM**）服务，可选地作为其他 IdP 的代理
- en: No authentication required
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无需认证
- en: It is exceedingly rare these days to see systems skipping authentication. There
    are a few cases, such as public websites, anonymous surveys, and low-risk functions,
    such as calculators, that may not require authentication.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，很少看到系统跳过认证。有一些情况，例如公共网站、匿名调查以及低风险功能，如计算器，可能不需要认证。
- en: It may be justified to build an IAM service tailored to an organization’s needs.
    Unless the organization itself specializes in security solutions, IAM services
    belong to the generic subdomain, as discussed in [*Chapter 8*](B21737_08.xhtml#_idTextAnchor289).
    Most third-party IdPs provide the sufficient authentication capabilities required
    by an organization. If there is any organization-specific justification, it is
    recommended to build an IAM service to act as a proxy for a third-party IdP. If
    the third-party IdPs provide new features that are currently custom-built, this
    approach minimizes the impact of feature migration.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 根据组织的需要构建一个定制的 IAM 服务可能是合理的。除非组织本身专门从事安全解决方案，否则 IAM 服务属于通用的子域，如第 [*第8章*](B21737_08.xhtml#_idTextAnchor289)
    中所述。大多数第三方 IdP 提供了组织所需的足够认证能力。如果有任何特定于组织的理由，建议构建一个 IAM 服务作为第三方 IdP 的代理。如果第三方 IdP
    提供了目前定制的全新功能，这种方法可以最小化功能迁移的影响。
- en: A sample interaction of MFA
  id: totrans-120
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: MFA 的示例交互
- en: 'Given a user wants to log on to a system to request an operation from an application
    on a smart device, the messages exchange may look like *Figure 14**.4*:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 假设用户想要登录系统以从智能设备上的应用程序请求操作，消息交换可能看起来像 *图 14*。4：
- en: '![Figure 14.4 – A sample business request with MFA](img/B21737_14_4.jpg)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![图 14.4 – 带有 MFA 的示例业务请求](img/B21737_14_4.jpg)'
- en: Figure 14.4 – A sample business request with MFA
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.4 – 带有 MFA 的示例业务请求
- en: This is just a sample interaction because the communication varies with different
    IdPs and different factors involved in authentication. In this sample, the IdPs
    provide a white-label page themed for the organization.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 这只是一个示例交互，因为通信因不同的 IdP 和认证中涉及的不同因素而异。在这个示例中，IdP 为组织提供了一个定制的白色标签页面。
- en: White label page
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 白色标签页面
- en: A **white label page** is a customizable web page or application that can be
    re-branded and used by different organizations. The screen is themed for the target
    organization and the original organization’s branding is hidden. It is a common
    feature for a SaaS product to allow seamless integration with any organization
    while maintaining a consistent user experience.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '**白色标签页面**是一个可定制的网页或应用程序，可以被重新品牌化并由不同的组织使用。屏幕针对目标组织进行了主题设计，并隐藏了原始组织的品牌。这对于
    SaaS 产品来说是一个常见功能，允许与任何组织无缝集成，同时保持一致的用户体验。'
- en: 'The user signs in and provides the username and password, using HTTPS over
    TLS. The username and password are joined by a colon as a string:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 用户登录并使用 HTTPS over TLS 提供用户名和密码。用户名和密码由冒号连接成字符串：
- en: '[PRE0]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The string is then encoded in Base64 and is passed to the HTTP header as a
    part of the **HTTP basic authentication**. Since it is HTTPS, the header is also
    encrypted. The sign-in request is equivalent to the following command:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 字符串随后被编码为 Base64 并作为 **HTTP 基本认证**的一部分传递到 HTTP 标头。由于它是 HTTPS，因此标头也是加密的。登录请求等同于以下命令：
- en: '[PRE1]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: This data forms the knowledge factor of the authentication.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 这些数据构成了认证的知识因素。
- en: The IdP confirms that the username and password do exist and match, but then
    it issues a challenge to the client to enter a **one-time passcode** (**OTP**).
    The OTP is then sent to the user’s phone number via **Short Message Service**
    (**SMS**). The user who possesses the phone receives the OTP and enters the passcode.
    The passcode is sent from the client to the IdP to solve the challenge. This is
    the possession factor of the authentication.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: IdP 确认用户名和密码确实存在且匹配，然后向客户端发出一个 **一次性密码**（**OTP**）的挑战。OTP 然后通过 **短信服务**（**SMS**）发送到用户的手机号码。拥有手机的用户会收到
    OTP 并输入密码。密码从客户端发送到 IdP 以解决挑战。这是认证的占有因素。
- en: The IdP verifies whether the OTP is correct or not. If it is incorrect, the
    IdP responds to the client and reveals that the authentication has failed. If
    it is correct, the IdP generates a **JSON Web Token** (**JWT**) as an access token
    and sends it to the client as a response. Soon after, the IdP also informs the
    server that a user is successfully authenticated via a webhook.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 身份提供者（IdP）验证OTP是否正确。如果错误，IdP会向客户端响应并透露身份验证失败。如果正确，IdP会生成一个**JSON Web Token**（**JWT**）作为访问令牌并发送给客户端作为响应。随后，IdP还会通过webhook通知服务器用户已成功通过身份验证。
- en: 'A **JWT** is an encrypted JSON string used to carry claims about the roles
    and permissions of the user. It consists of three parts:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '**JWT**是一个加密的JSON字符串，用于携带关于用户角色和权限的声明。它由三部分组成：'
- en: '**Header**: The type of the token as “JWT” and the algorithm used to encrypt
    the token.'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标题**: 令牌的类型为“JWT”以及用于加密令牌的算法。'
- en: '**Payload**: Registered claims, such as issuer, audience, expiration time,
    and ID. Also contains public claims, such as application user roles, and private
    claims for information to be shared only between parties using the token.'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**有效载荷**: 注册的声明，如发行者、受众、过期时间和ID。还包含公共声明，如应用程序用户角色，以及仅用于使用令牌的各方之间共享的私有声明。'
- en: '**Signature**: The proof that the sender is who it claims to be and the whole
    JSON string has not been modified.'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**签名**: 发送者身份的证明以及整个JSON字符串未被修改的证据。'
- en: The authentication success response also triggers a screen redirect to the landing
    screen for the user to start making business requests.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 身份验证成功响应还会触发屏幕重定向到用户登录页面，以便用户开始进行业务请求。
- en: 'The authenticated user makes a business request. The client sends the request
    to the server with the access token attached to the HTTP header as a `Bearer`
    token:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 经身份验证的用户发起业务请求。客户端将带有附加到HTTP头部的访问令牌作为`Bearer`令牌发送请求到服务器：
- en: '[PRE2]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The server receives from the client the request along with the `Bearer` token.
    The server verifies with the IdP whether the token is valid. The IdP confirms
    that the token is valid, so the server processes the request and responds to the
    client.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器从客户端接收请求以及`Bearer`令牌。服务器与身份提供者（IdP）验证令牌是否有效。身份提供者（IdP）确认令牌有效，因此服务器处理请求并向客户端响应。
- en: The client can continue to use the `Bearer` token for other operations, without
    further authentication, until the session ends. The IdP is in control of the validity
    of the token throughout the session. The token can also be refreshed upon request
    to the IdP.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 客户端可以继续使用`Bearer`令牌进行其他操作，无需进一步身份验证，直到会话结束。在整个会话期间，身份提供者（IdP）控制令牌的有效性。根据请求，令牌也可以由身份提供者（IdP）刷新。
- en: The token exchange and refresh flows are a part of the industry standard protocol
    for authorization, **OAuth** ([https://oauth.net/2/](https://oauth.net/2/)).
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 令牌交换和刷新流程是行业标准授权协议的一部分，**OAuth** ([https://oauth.net/2/](https://oauth.net/2/))。
- en: OAuth
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: OAuth
- en: '**OAuth** is an authorization framework that enables third-party applications
    to obtain limited access to resources without exposing credentials. Users are
    granted access to their data from one service to another service through various
    grant types, such as authorization code, implicit, and client credentials. The
    user submits authentication requests to an authorization server, which then issues
    access tokens for accessing protected resources on a resource server. OAuth emphasizes
    flexibility and is widely adopted for secure delegated access in modern applications.'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: '**OAuth**是一个授权框架，它允许第三方应用程序在不暴露凭证的情况下获取对资源的有限访问。用户通过各种授权类型（如授权代码、隐式和客户端凭证）从一种服务访问另一种服务的数据。用户向授权服务器提交身份验证请求，授权服务器随后为访问资源服务器上受保护的资源颁发访问令牌。OAuth强调灵活性，并被广泛采用以实现现代应用程序中的安全委托访问。'
- en: This sample interaction also allows the `Bearer` token to be used for authentication
    of other systems that use the same IdP. As the user has already been authenticated
    by the IdP, other systems using the same IdP can verify the identity of the user
    in the same way. This mechanism enables the **single-sign-on** (**SSO**) experience
    where a user only needs to be authenticated once to access a basket of applications
    and systems that share the same IdP.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 此示例交互还允许使用`Bearer`令牌对使用相同身份提供者（IdP）的其他系统进行身份验证。由于用户已经通过身份提供者（IdP）进行了身份验证，因此使用相同身份提供者（IdP）的其他系统可以以相同的方式验证用户的身份。这种机制实现了**单点登录**（**SSO**）体验，用户只需进行一次身份验证即可访问共享相同身份提供者（IdP）的应用程序和系统集合。
- en: Step-up authentication
  id: totrans-147
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步进式身份验证
- en: Sometimes, the authenticated user is asked to perform additional verification
    beyond their initial authentication. This additional step is called **step-up
    authentication**.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，经过认证的用户需要执行超出其初始认证的额外验证。这一额外步骤被称为**提升认证**。
- en: Step-up authentication typically applies to deliberately chosen situations when
    they involve accessing sensitive information or high-risk actions, such as updating
    passwords, making a bank transfer, or moving the account data to an unfamiliar
    device.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 提升认证通常适用于故意选择的情况，当涉及访问敏感信息或高风险操作时，例如更新密码、进行银行转账或将账户数据移动到不熟悉的设备。
- en: Step-up authentication can also be dynamically applied based on the context
    of the access requests, such as a new geographic location, new device, new bank
    account, and so on.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 提升认证也可以根据访问请求的上下文动态应用，例如新的地理位置、新设备、新银行账户等。
- en: The simplest approach to step-up authentication is to repeat the same MFA process
    under TLS communication. Some companies would deliberately add more challenges,
    such as CAPTCHA or biometric verifications.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 最简单的提升认证方法是重复在TLS通信下相同的MFA过程。一些公司可能会故意增加更多的挑战，例如CAPTCHA或生物识别验证。
- en: By implementing step-up authentication, organizations can significantly reduce
    the risk of unauthorized access while maintaining a seamless user experience for
    lower-risk activities.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 通过实施提升认证，组织可以显著降低未经授权访问的风险，同时保持低风险活动的无缝用户体验。
- en: 'We go to great lengths to get to the point where the system has verified the
    identity of an entity entering the system. Now that the entity has signed in the
    system the next question is this: What can the entity access and execute in the
    system? We are going to explore this in the next section.'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 我们竭尽全力确保系统已验证进入系统的实体的身份。现在实体已登录系统，下一个问题是：实体可以在系统中访问和执行什么？我们将在下一节中探讨这个问题。
- en: Authorization
  id: totrans-154
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 授权
- en: '**Authorization** determines what resources a user or entity is allowed to
    access and what actions they can perform. After a user is authenticated, it is
    authorized to only interact with data and features explicitly granted rights.
    This restricts sensitive information to only individuals the system knows and
    maintains the integrity of systems.'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '**授权**决定了用户或实体可以访问哪些资源以及可以执行哪些操作。用户经过认证后，只能与明确授予权限的数据和功能进行交互。这限制了敏感信息只对系统已知并维护其完整性的个人。 '
- en: Authorization conforms to the **principle of least privilege** (**PoLP**), known
    as the **principle of minimal privilege** (**PoMP**) or the **principle of least
    authority** (**PoLA**). PoLP states that a user, entity, or system should have
    only the essential permissions to operate its functions. This minimizes risks
    and limits potential damage from accidents or malicious actions that we might
    not have anticipated or known.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 授权符合**最小权限原则**（**PoLP**），也称为**最小权限原则**（**PoMP**）或**最小权限原则**（**PoLA**）。PoLP指出，用户、实体或系统应仅具有操作其功能所必需的权限。这最小化了风险并限制了可能来自意外或恶意行为（我们可能没有预料或了解）的潜在损害。
- en: In addition, knowingly granting permissions for specific resources and actions
    improves accountability and compliance with security policies. Staying with the
    knowns promotes a safer sense of security.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，有意识地授予特定资源和操作的权限可以提高问责制并符合安全策略。坚持已知信息可以促进更安全的感知。
- en: 'As we have briefly mentioned, authorization has two elements: data and actions.
    They are different concepts in authorization and can be managed differently:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们简要提到的，授权有两个要素：数据和操作。它们在授权中是不同的概念，可以不同地管理：
- en: '**Data entitlement**: Whether the user is entitled to access specific data
    or resources'
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据权限**：用户是否有权访问特定的数据或资源'
- en: '**Permission**: Which actions the user is allowed to perform on a resource
    or data'
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**权限**：用户在资源或数据上允许执行的操作'
- en: For example, a user is entitled to see their own user account. A user in the
    Administrator role is entitled to see other users’ accounts. However, the user
    must be granted permission to read user accounts to start with. A user is granted
    write permission to update their own user account. A user in the Administrator
    role, however, may not have the write permission to update other users’ accounts.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，用户有权查看自己的用户账户。管理员角色的用户有权查看其他用户的账户。然而，用户必须首先被授予读取用户账户的权限。用户被授予写入权限以更新自己的用户账户。然而，管理员角色用户可能没有更新其他用户账户的写入权限。
- en: 'There are four typical approaches to implementing authorization:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 实施授权有四种典型方法：
- en: '**Role-based access** **control** (**RBAC**)'
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基于角色的访问** **控制** （**RBAC**）'
- en: '**Attribute-based access** **control** (**ABAC**)'
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基于属性的访问** **控制** （**ABAC**）'
- en: '**Access control** **lists** (**ACLs**)'
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**访问控制** **列表** （**ACLs**）'
- en: '**Policy-based access** **control** (**PBAC**)'
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基于策略的访问** **控制** （**PBAC**）'
- en: We are going to perform a deep dive into them.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将深入探讨这些方法。
- en: Role-based access control (RBAC)
  id: totrans-168
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基于角色的访问控制 (RBAC)
- en: 'An RBAC approach has users assigned to roles, and each role has specific permissions
    assigned to it. Users are granted permissions based on the assigned roles within
    the organization. This is illustrated in *Figure 14**.5*:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: RBAC 方法将用户分配到角色，每个角色都分配了特定的权限。用户根据组织内分配的角色获得权限。这如图 *图 14**.5* 所示：
- en: '![Figure 14.5 – An example of RBAC](img/B21737_14_5.jpg)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![图 14.5 – RBAC 的一个示例](img/B21737_14_5.jpg)'
- en: Figure 14.5 – An example of RBAC
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.5 – RBAC 的一个示例
- en: In the preceding RBAC configuration, Alex and Taylor are assigned the role of
    *Customer service support*, which is granted permissions to perform basic-level
    actions, such as updating a customer’s order. More advanced actions, such as refunding
    an order, can only be executed by a person such as Sam with the *Customer service*
    *supervisor* role.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的 RBAC 配置中，Alex 和 Taylor 被分配了 *客户服务支持* 角色，该角色被授予执行基本级别操作（如更新客户的订单）的权限。更高级的操作，如退款订单，只能由具有
    *客户服务* *主管* 角色的人如 Sam 执行。
- en: RBAC is commonly used in companies in which different job functions require
    various levels of access. It is more efficient than assigning permissions to users
    individually. It is also efficient in situations such as when an employee takes
    a holiday and another employee temporarily takes over the duty, or a new employee
    requires the same level of access as their teammates.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: RBAC 在需要不同访问级别的不同工作职能的公司中普遍使用。它比逐个分配权限更有效。在员工休假而另一位员工临时接管职责，或新员工需要与队友相同级别的访问权限的情况下，它也很有效。
- en: Access control lists (ACLs)
  id: totrans-174
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 访问控制列表 (ACLs)
- en: 'An ACL grants a list of users or groups of users to have access to a specific
    resource and defines which actions are allowed. This approach is suitable for
    granting permissions to resources that can be precisely specified, such as the
    following:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: ACL 授予一组用户或用户组访问特定资源的权限，并定义允许哪些操作。这种方法适用于授予可以精确指定的资源权限，例如以下内容：
- en: '**Filesystems**: Folders, read/write actions, and filenames'
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文件系统**: 文件夹、读写操作和文件名'
- en: '**HTTP paths**: **Uniform Resource Identifiers** (**URIs**) and HTTP methods'
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**HTTP 路径**: **统一资源标识符** （**URIs**） 和 HTTP 方法'
- en: '**Networking**: IP addresses, ports, and transport layer protocols'
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络**: IP 地址、端口和传输层协议'
- en: '**Database**: Schemas, tables, and actions'
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据库**: 模式、表和操作'
- en: Some of the ACLs also support wildcard matches for more flexible configuration.
    This approach is suitable for managing the entitlement of resources at a fine-grained
    level.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 一些 ACLs 也支持通配符匹配，以实现更灵活的配置。这种方法适用于在细粒度级别管理资源权限。
- en: Policy-based access control (PBAC)
  id: totrans-181
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基于策略的访问控制 (PBAC)
- en: PBAC grants permissions based on pre-defined policies that consider various
    criteria, such as user roles, attributes, and context.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: PBAC 基于预定义的策略授予权限，这些策略考虑了各种标准，例如用户角色、属性和上下文。
- en: These policies are pre-defined, but they support parameters. They are usually
    managed by GUI tools or set up as declarative configurations. The authorization
    tool itself may be custom-built, but the maintenance of policies does not require
    code change.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 这些策略是预先定义的，但它们支持参数。它们通常由 GUI 工具管理或设置为声明性配置。授权工具本身可能是定制的，但策略的维护不需要代码更改。
- en: The policies can be fine-grained and highly configurable. They can also be changed
    at runtime without deployment or restart. They are useful in dynamic environments
    where access needs to adapt based on real-time conditions or compliance requirements.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 策略可以是细粒度和高度可配置的。它们也可以在运行时更改，而无需部署或重启。在需要根据实时条件或合规性要求调整访问需求的环境中，它们非常有用。
- en: PBAC is effective for compliance regulatory requirements because well-defined
    policies can be treated as a technical implementation of compliance policies.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: PBAC对于符合监管要求非常有效，因为定义良好的策略可以被视为合规政策的技术实现。
- en: Attribute-based access control (ABAC)
  id: totrans-186
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基于属性的访问控制（ABAC）
- en: ABAC grants permissions to attributes associated with users, resources, and
    the environment. It provides the most flexible way to control permissions that
    can be sensitive to the context such as time and geographic locations.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: ABAC授予与用户、资源和环境相关的属性权限。它提供了最灵活的方式来控制权限，这些权限可能对上下文敏感，例如时间和地理位置。
- en: For example, a completed customer order can only be updated by a customer service
    supervisor, but an open order can be updated by both customer service support
    and supervisor.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，只有客户服务主管可以更新完成的客户订单，但开放订单可以由客户服务支持和主管共同更新。
- en: This approach is suitable for complex environments where access decisions depend
    on multiple, often dynamic, factors, such as user attributes (e.g., department,
    clearance level), resource attributes (e.g., sensitivity), time of access request,
    environment configurations, and so on. The control can be as granular as it needs
    to be.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法适用于复杂的环境，其中访问决策取决于多个、通常是动态的因素，例如用户属性（例如，部门、清查级别）、资源属性（例如，敏感性）、访问请求的时间、环境配置等。控制可以细粒度到所需的程度。
- en: Due to its high flexibility, ABAC is often written as code instead of configuration.
    Some of these ABAC policies may even involve the concept of permission inheritance,
    at either the user level or resource level. The implementation can easily become
    complex.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 由于其高度灵活性，ABAC通常被编写为代码而不是配置。其中一些ABAC策略甚至可能涉及权限继承的概念，无论是在用户级别还是资源级别。实现可能会变得复杂。
- en: Writing ABAC in code also brings the challenges of testing and maintenance.
    It is possible that a bug in ABAC code leads to leaks of resources to unauthorized
    persons.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 将ABAC编写为代码也带来了测试和维护的挑战。ABAC代码中的错误可能导致资源泄露给未经授权的人员。
- en: Impacts of authorization on software architecture
  id: totrans-192
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 授权对软件架构的影响
- en: There are several dimensions of how authorization impacts software architecture.
    Microservices, nanoservices, and FaaS (as discussed in [*Chapter 6*](B21737_06.xhtml#_idTextAnchor212))
    themselves require access to infrastructure resources, such as databases and filesystems.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 授权对软件架构的影响有几个维度。微服务、纳米服务和FaaS（如第6章所述[*](B21737_06.xhtml#_idTextAnchor212)）本身需要访问基础设施资源，如数据库和文件系统。
- en: If they are often run under cloud providers, RBAC and ALCs can be used in defining
    and restricting what resources which component is allowed to access, and which
    actions are allowed. More than often, organizations would use the cloud-native
    IdP to manage infrastructure permissions and data entitlements used by applications.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 如果它们经常在云提供商下运行，则RBAC和ALCs可以用于定义和限制组件可以访问哪些资源以及允许哪些操作。更常见的是，组织会使用云原生IdP来管理应用程序使用的基础设施权限和数据权益。
- en: As we mentioned when discussing PoLP, an application should be granted exactly
    sufficient permissions and data entitlements to perform its operations, but no
    more.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们在讨论PoLP时提到的，应用程序应授予恰好足够的权限和数据权益来执行其操作，但不应更多。
- en: If there is a need to grant write access to a specific resource (e.g., database
    schema) to more than one bounded context, then it can be a smell of unclear or
    leaky bounded context. An architecture review of the involved bounded context
    will be useful in understanding the needs and examining whether the boundary of
    applications can be improved.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 如果需要将特定资源的写访问权限（例如，数据库模式）授予多个边界上下文，那么这可能是不明确或泄漏的边界上下文的迹象。对涉及的边界上下文进行架构审查将有助于了解需求并检查应用程序边界的改进是否可行。
- en: End users, external systems, and other devices require access to both infrastructure
    and application data. There are a few use cases where they need access to the
    infrastructure resources.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 最终用户、外部系统和其他设备需要访问基础设施和应用数据。有一些用例需要它们访问基础设施资源。
- en: Use case – submit expense reimbursement request and approval
  id: totrans-198
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用例 – 提交报销请求和批准
- en: In an organization, all users are permitted to submit requests to reimburse
    expenses for business authorization:expense reimbursement request and approval”
    purposes. The financial operation team is responsible for reviewing these requests
    and deciding if the request should be approved or rejected.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 在一个组织中，所有用户都有权提交报销请求以进行业务授权：“报销请求和批准”。财务操作团队负责审查这些请求并决定是否批准或拒绝请求。
- en: 'In this setup, all users have the User role. The role is granted permissions
    to access these endpoints:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个设置中，所有用户都有用户角色。该角色被授予访问以下端点的权限：
- en: '`POST /expense`: This is to submit a new expense reimbursement request'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`POST /expense`：这是为了提交新的报销请求'
- en: '`GET /expense/{id}`: This is to see the expense reimbursement request of the
    given ID'
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`GET /expense/{id}`：这是为了查看给定ID的报销请求'
- en: 'Some users are assigned to the financial operations role. This role is granted
    permissions to access these endpoints:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 一些用户被分配到财务操作角色。该角色被授予访问以下端点的权限：
- en: '`GET /expense/{id}`: This is to see the expense reimbursement request of the
    given ID'
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`GET /expense/{id}`：这是为了查看给定ID的报销请求'
- en: '`PATCH /expense/{id}/result`: This is to either approve or reject the expense
    reimbursement request of the given ID'
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PATCH /expense/{id}/result`：这是为了批准或拒绝给定ID的报销请求'
- en: The corresponding permission control can be configured using RBAC and ACLs.
    Most IdPs, including cloud-native middleware, can support this setting.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 相应的权限控制可以使用RBAC和ACL进行配置。大多数身份提供者（IdP），包括云原生中间件，都可以支持此设置。
- en: Centralized or distributed authorization logic?
  id: totrans-207
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 集中式或分布式授权逻辑？
- en: It is often a question among engineers whether the authorization logic should
    be centralized or distributed when it is related to application data.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 工程师们经常问，当与应用程序数据相关时，授权逻辑应该是集中式还是分布式。
- en: This is not a simple yes or no question. It depends on the nature of the authorization
    logic. At the basic level, the user requesting a record of application data should
    have permission granted to read the data of the given type. If it is RBAC or ACL,
    it is reasonable to have a centralized service to confirm that u*ser X can read
    application data of* *type Y*.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 这不是一个简单的“是”或“否”的问题。它取决于授权逻辑的性质。在基本层面上，请求应用程序数据记录的用户应该被授予读取给定类型数据的权限。如果是RBAC或ACL，有一个集中的服务来确认用户X可以读取类型为Y的应用程序数据是合理的。
- en: Alternatively, permissions or roles can be encoded as part of the JWT custom
    claims. This approach reduces the time spent in resolving permissions. However,
    it implies the granted permissions can linger until the JWT expires, making dynamic
    authorization more difficult.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，权限或角色可以作为JWT自定义声明的一部分进行编码。这种方法减少了处理权限所需的时间。然而，这也意味着授予的权限可能会持续到JWT过期，使得动态授权变得更加困难。
- en: However, it gets complicated when deciding whether a user is entitled to see
    a given application’s data, which is the data entitlement question of whether
    *user X can read application data of type Y and of ID 123*. Answering this question
    often requires domain-specific knowledge that should stay within the bounded context,
    in other words, distributed.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，当决定用户是否有权查看特定应用程序的数据时，事情变得复杂，这是关于用户X是否可以读取类型为Y和ID为123的应用程序数据的权益问题。回答这个问题通常需要特定领域的知识，这些知识应该保持在有限范围内，换句话说，是分布式的。
- en: Moreover, other actions on application data imply that the user can read the
    data to begin with. The interweaving logic of permissions, data entitlement, and
    business logic has significantly increased the complexity of the operations. This
    is even more complicated with third-party API integration where data being authorized
    are distributed among services.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，对应用程序数据的其他操作意味着用户最初可以读取数据。权限、数据权益和业务逻辑的交织逻辑显著增加了操作复杂性。在与第三方API集成的情况下，数据授权分布在多个服务中，这更加复杂。
- en: 'Using the same example of expense reimbursement request and approval from the
    previous section, a sample interaction of permissions and data entitlements business
    flow looks like the diagram in *Figure 14**.6*:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 使用上一节中提到的报销请求和批准的相同示例，权限和数据权益业务流程的示例交互看起来像*图14.6*中的图表：
- en: '![Figure 14.6 – A sample interaction of permission and data entitlements business
    flow](img/B21737_14_6.jpg)'
  id: totrans-214
  prefs: []
  type: TYPE_IMG
  zh: '![图14.6 – 权限和数据权益业务流程的示例交互](img/B21737_14_6.jpg)'
- en: Figure 14.6 – A sample interaction of permission and data entitlements business
    flow
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.6 – 权限和数据权益业务流程的示例交互
- en: A user with a financial operations role needs to see the expense reimbursement
    request to decide whether to approve or reject it. So, the first request from
    the client is the get the expense reimbursement request by the given ID.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 担任财务操作角色的用户需要查看费用报销请求以决定是否批准或拒绝它。因此，客户端的第一个请求是按照给定的ID获取费用报销请求。
- en: The corresponding service, the expense service, makes a synchronous call to
    the authorization service, which is dedicated to user permissions, to check whether
    the given user has the permissions to read an expense reimbursement request.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 相应的服务，即费用服务，会对专门处理用户权限的授权服务进行同步调用，以检查给定用户是否有权限读取费用报销请求。
- en: The authorization service resolves the user’s permissions by its roles and returns
    a list of actions granted to the user. The expense service receives the list of
    granted actions, and on top of that, checks whether the user can see this particular
    expense reimbursement request.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 授权服务通过其角色解决用户的权限，并返回用户被授予的操作列表。费用服务接收被授予的操作列表，并且在此基础上，检查用户是否可以看到这个特定的费用报销请求。
- en: There could be domain-specific business rules, such as expense reimbursement
    requests can only be approved by a user of the same geographic jurisdiction. The
    expense service also further filters which actions can be performed on this expense
    reimbursement request. For example, if it is already approved, then the action
    to approve or reject is no longer available due to business logic, not due to
    permissions.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 可能存在特定领域的业务规则，例如，费用报销请求只能由同一地理管辖区的用户批准。费用服务还会进一步筛选可以对这笔费用报销请求执行哪些操作。例如，如果它已经被批准，那么批准或拒绝的操作将不再可用，这是由于业务逻辑，而不是由于权限。
- en: Combined with the result of permissions and data entitlements, if the user is
    not allowed to see the expense reimbursement request, an HTTP status 403 (Forbidden)
    is returned to the client. Otherwise, an HTTP status 200 (OK) is returned with
    the payload of a list of actions available to the user on this expense reimbursement
    request.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 结合权限和数据权益的结果，如果用户不允许查看费用报销请求，则向客户端返回HTTP状态码403（禁止）。否则，返回HTTP状态码200（OK），并附带用户在此费用报销请求上可用的操作列表的有效负载。
- en: Both services could have just returned a binary answer if the user could read
    the expense reimbursement request or not. However, returning a list of granted
    actions allows the list to be populated to the frontend application. The frontend
    application can enable and disable buttons to give the user clear expectations.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 如果用户能否读取费用报销请求，这两个服务本可以只返回一个二进制答案。然而，返回一个授权操作列表允许该列表被填充到前端应用程序中。前端应用程序可以启用和禁用按钮，以给用户明确的预期。
- en: The expense reimbursement request is presented to the user on a screen, and
    the user has decided on the approval. The client sends a `PATCH` request to update
    the result of the expense reimbursement request.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 费用报销请求在屏幕上展示给用户，用户已经决定批准。客户端发送一个`PATCH`请求来更新费用报销请求的结果。
- en: The expense service makes a synchronous call to the authorization service to
    check whether the given user has permissions to approve or reject an expense reimbursement
    request. The authorization service returns a list of actions granted to the user.
    The expense service checks further if it is possible to approve or reject this
    given expense reimbursement request.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 费用服务会对授权服务进行同步调用，以检查给定用户是否有权限批准或拒绝费用报销请求。授权服务返回用户被授予的操作列表。费用服务进一步检查是否可以批准或拒绝这笔特定的费用报销请求。
- en: If the expense reimbursement request is already approved or rejected, then an
    HTTP status 403 (Forbidden) is returned to the client. Otherwise, the expense
    service updates the result of the expense reimbursement request and returns an
    HTTP status 200 (OK) together with the payload of the updated expense reimbursement
    request.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 如果费用报销请求已经被批准或拒绝，则向客户端返回HTTP状态码403（禁止）。否则，费用服务更新费用报销请求的结果，并返回HTTP状态码200（OK），同时附带更新后的费用报销请求的有效负载。
- en: Scalability concerns for authorization
  id: totrans-225
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 授权的扩展性问题
- en: From this sample interaction, we can foresee that the authorization service
    is frequently synchronously called. It raises concerns about scalability. All
    business requests would need to be authorized, so the authorization service would
    be under the load of all other business-facing services combined.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 从这个示例交互中，我们可以预见授权服务会被频繁地同步调用。这引发了关于可扩展性的担忧。所有业务请求都需要授权，因此授权服务将承受所有面向业务的其他服务的总负载。
- en: Meanwhile, caching permissions locally may not be desirable, and even risky
    to do so. It is recommended to keep requests to the authorization service lean
    by designing efficient and non-chatty APIs. It is also worth considering a smaller
    size payload, such as a binary format.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 同时，本地缓存权限可能不可取，甚至是有风险的。建议通过设计高效且非冗余的API来保持对授权服务的请求简洁。考虑使用更小的有效负载大小，如二进制格式，也是值得考虑的。
- en: Scaling out any business-facing service that uses the authorization service
    would imply scaling out the authorization service considerably too. It is advised
    to set up metrics and monitoring to understand the usage of the authorization
    service per API client, so we understand if a service scales out to handle a greater
    number of requests, the authorization service needs to scale out proportionately.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展使用授权服务的任何面向业务的服务意味着也需要显著扩展授权服务。建议设置指标和监控，以了解每个API客户端对授权服务的使用情况，这样我们才能理解如果服务扩展以处理更多的请求，授权服务也需要相应地扩展。
- en: At this point of the chapter, we can authenticate users and authorize them with
    a list of allowed actions and accessible resources. Business operations on top
    of them would result in the system keeping sensitive data. We are going to explore
    the topic of handling sensitive data in the next section.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的这一部分，我们可以对用户进行身份验证，并使用允许的操作和可访问的资源列表对他们进行授权。在它们之上进行的业务操作会导致系统保留敏感数据。我们将在下一节探讨处理敏感数据的话题。
- en: Handling sensitive data
  id: totrans-230
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 处理敏感数据
- en: Handling sensitive data requires careful consideration and implementation of
    best practices to ensure its confidentiality, integrity, availability, and compliance
    with regulatory requirements. In this section, we’ll look at the key strategies
    for managing sensitive data.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 处理敏感数据需要仔细考虑和实施最佳实践，以确保其机密性、完整性、可用性和符合监管要求。在本节中，我们将探讨管理敏感数据的关键策略。
- en: Data classification
  id: totrans-232
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据分类
- en: 'We have discussed what data can be identified as sensitive at the beginning
    of the chapter. It is important for an organization to explicitly classify and
    document which field is sensitive. There are at least three categories of data
    sensitivity:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在本章的开头讨论了哪些数据可以被识别为敏感数据。对于组织来说，明确分类和记录哪些字段是敏感的非常重要。至少有三种数据敏感度类别：
- en: '**Confidential**: Only designated persons or roles can access'
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**机密**：仅指定人员或角色可以访问'
- en: '**Internal use**: Only members of the organization can access'
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**内部使用**：仅组织成员可以访问'
- en: '**Public**: Accessible to all'
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**公开**：对所有可访问'
- en: The documentation should serve as a guideline for everyone, including engineers,
    in the organization to handle them with care and caution.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 文档应作为指南，供组织中的每个人，包括工程师，小心谨慎地处理。
- en: Data in transit
  id: totrans-238
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 传输中的数据
- en: Data in transit under TLS communication is encrypted with session keys. This
    ensures that even if data is intercepted or accessed without authorization, it
    remains unreadable.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 在TLS通信中传输的数据使用会话密钥加密。这确保了即使数据被拦截或未经授权访问，它仍然是不可读的。
- en: How to prevent accidentally logging sensitive information
  id: totrans-240
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 如何防止意外记录敏感信息
- en: 'However, it is not safe and secure yet. It is not unusual to encounter sensitive
    information leaked by logging unknowingly:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，目前还不安全也不安全。无意中通过日志泄露敏感信息并不罕见：
- en: The full decrypted payload of requests, responses, or messages
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请求、响应或消息的完整解密有效负载
- en: An aggregate Kotlin object that transitively contains a sensitive field
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 递归包含敏感字段的聚合Kotlin对象
- en: An object of a generated class that contains a sensitive field
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 包含敏感字段的生成类的对象
- en: Troubleshooting or debugging information that contains sensitive information
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 包含敏感信息的故障排除或调试信息
- en: Sensitive fields themselves
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 敏感字段本身
- en: This is quite dangerous because the related code looks innocuous and the leak
    is often found after the fact. There are a few techniques to prevent this from
    happening.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 这非常危险，因为相关的代码看起来无害，泄露通常是在事后发现的。有一些技术可以防止这种情况发生。
- en: 'A common technique adopted by engineers is to override the `toString` function
    of a Kotlin data class:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 工程师采用的一种常见技术是重写Kotlin数据类的`toString`函数：
- en: '[PRE3]'
  id: totrans-249
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'This approach works, but it is not scalable because there are a lot of override
    functions to write. Alternatively, a value wrapper can work efficiently, as shown
    here:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法有效，但因为它需要编写大量的重写函数，所以不可扩展。作为替代，值包装器可以有效地工作，如下所示：
- en: '[PRE4]'
  id: totrans-251
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The `Secret` wrapper class works on a class or a field. The `toString` override
    function is simple as well.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: '`Secret`包装类作用于类或字段。`toString`重写函数也很简单。'
- en: 'There are also open source libraries that aim to solve this issue with minimal
    code. For example, the Redacted compiler plugin ([https://github.com/ZacSweers/redacted-compiler-plugin](https://github.com/ZacSweers/redacted-compiler-plugin))
    enables engineers to annotate a field or a class to be redacted, and therefore,
    the values are masked when `toString` is invoked. The setup is quite simple as
    well:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，还有一些开源库旨在用最少的代码解决这个问题。例如，Redacted编译器插件([https://github.com/ZacSweers/redacted-compiler-plugin](https://github.com/ZacSweers/redacted-compiler-plugin))允许工程师注解字段或类以进行红字，因此当调用`toString`时，值会被屏蔽。设置也很简单：
- en: 'The first step of the setup is its Gradle plugin:'
  id: totrans-254
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置的第一步是其Gradle插件：
- en: '[PRE5]'
  id: totrans-255
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Secondly, define a custom `Redacted` annotation class:'
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 其次，定义一个自定义的`Redacted`注解类：
- en: '[PRE6]'
  id: totrans-257
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Then, configure the plugin to use this annotation and configure the mask character
    in `build.gradle.kts`:'
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，配置插件以使用此注解，并在`build.gradle.kts`中配置屏蔽字符：
- en: '[PRE7]'
  id: totrans-259
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'We have the following data classes annotated with `Redacted`:'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 我们有以下用`Redacted`注解的数据类：
- en: '[PRE8]'
  id: totrans-261
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'We create one object per class and print them to the console in the main function:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 我们为每个类创建一个对象，并在主函数中将它们打印到控制台：
- en: fun main() {
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: fun main() {
- en: '[PRE9]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'We have the following result:'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 我们有以下结果：
- en: '[PRE10]'
  id: totrans-266
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: So, the sensitive information is masked as part of the `toString` function result.
    However, the values are not masked if the program is run from the IDE with this
    compiler plugin. The masked values are shown if the program is executed from the
    command line or Gradle tasks.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，敏感信息作为`toString`函数结果的一部分被屏蔽。然而，如果程序使用带有此编译器插件的IDE运行，则不会屏蔽值。如果从命令行或Gradle任务执行程序，则显示屏蔽的值。
- en: There are alternative approaches that use reflection as a means to redact or
    hide sensitive fields. They are not recommended due to the overhead of using reflection.
    Compile-time redaction is the most effective method.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些替代方法使用反射作为红字或隐藏敏感字段的手段。由于使用反射的开销，它们不建议使用。编译时红字是最高效的方法。
- en: As for the payload and objects of a generated class, a sensible way to prevent
    sensitive information leaks is to avoid logging them in a production environment.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 对于生成的类的负载和对象，一个防止敏感信息泄露的合理方式是在生产环境中避免记录它们。
- en: Data at rest
  id: totrans-270
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 静态数据
- en: Data at rest refers to the data stored on devices, filesystems, databases, and
    cloud environments. Data sitting in infrastructure is usually protected by MFA,
    RBAC, and ALCs, as discussed in previous sections. However, for sensitive information,
    additional steps need to be taken.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 静态数据指的是存储在设备、文件系统、数据库和云环境中的数据。在基础设施中坐着的通常由MFA、RBAC和ALCs保护，如前几节所述。然而，对于敏感信息，需要采取额外的步骤。
- en: Encryption
  id: totrans-272
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 加密
- en: 'Sensitive data needs to be stored in an encrypted state; the variations are
    in the *how*. Here are the common techniques:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 敏感数据需要以加密状态存储；差异在于*如何*。以下是常见的技巧：
- en: '**Encrypted databases**: All data stored in a database is stored in an encrypted
    and unreadable format. The data is automatically decrypted upon retrieval without
    the application code. These databases usually support authorization to ensure
    that only authorized users can interact with encrypted data. They also innately
    support encryption key generation, storage, and rotation for extra security. Some
    databases also support encryption when data is being transmitted in and out of
    the database. However, encrypting and decrypting all data, sensitive or not, increases
    latency.'
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**加密数据库**：数据库中存储的所有数据都以加密和不可读的格式存储。数据在检索时自动解密，无需应用代码。这些数据库通常支持授权，以确保只有授权用户才能与加密数据交互。它们还天生支持加密密钥的生成、存储和轮换，以提供额外的安全性。一些数据库还支持在数据进出数据库时进行加密。然而，对所有数据进行加密和解密，无论敏感与否，都会增加延迟。'
- en: '**Encrypted fields**: Only fields identified as sensitive data are encrypted.
    This approach works with all types of storage, such as database columns, events
    in messaging infrastructure, and files. It has less performance overhead compared
    to encrypted databases, However, doing it at a field level implies that applications
    need to handle aspects that are automatically by encrypted databases, such as
    the following:'
  id: totrans-275
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**加密字段**：只有被标识为敏感数据的字段才会被加密。这种方法适用于所有类型的存储，如数据库列、消息基础设施中的事件和文件。与加密数据库相比，这种方法具有更小的性能开销。然而，在字段级别执行意味着应用程序需要处理加密数据库自动处理的方面，如下所示：'
- en: Encryption and decryption algorithms
  id: totrans-276
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 加密和解密算法
- en: Symmetric or asymmetric encryption key
  id: totrans-277
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对称或非对称加密密钥
- en: Key generation and secret management
  id: totrans-278
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密钥生成和密钥管理
- en: Key rotation and re-encryption
  id: totrans-279
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密钥轮换和重新加密
- en: '**Hybrid**: Due to the performance overhead of encrypted databases and the
    additional work to handle encryption in application code, it may be justified
    to use a hybrid approach, in which only sensitive data are stored in encrypted
    databases, and the rest are kept in any type of storage.'
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**混合**：由于加密数据库的性能开销以及处理应用程序代码中加密的额外工作，可能有必要采用混合方法，其中仅将敏感数据存储在加密数据库中，其余数据则保存在任何类型的存储中。'
- en: '**Encrypted backups**: Sensitive data should be regularly backed up in encrypted
    format to ensure data can be restored security in case of data loss or breaches.'
  id: totrans-281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**加密备份**：敏感数据应定期以加密格式备份，以确保在数据丢失或泄露的情况下可以安全地恢复数据。'
- en: Data retention and anonymization
  id: totrans-282
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据保留和匿名化
- en: Local authorities and regulations have clear guidelines on how long data should
    be maintained, including sensitive data. During the retention period, it is the
    organization’s responsibility to keep them secure and safe. After the retention
    period, sensitive data may be deleted.
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 地方当局和法规对数据应保留多长时间有明确的指导方针，包括敏感数据。在保留期内，组织有责任确保它们的安全和保密。保留期过后，敏感数据可以被删除。
- en: There are also regulations (e.g., GDPR) that individuals have the right to request
    for privacy data to be erased from the system.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，还有一些法规（例如，GDPR）规定个人有权要求从系统中删除隐私数据。
- en: However, there may be complications for deleting sensitive data on its own.
    Some of the data have referential constraints and contain useful business insights,
    which need not identify individuals.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，单独删除敏感数据可能会出现一些复杂情况。其中一些数据具有引用约束，并包含有用的业务洞察，这些洞察不需要识别个人。
- en: 'There are several techniques that allow sensitive data to be anonymized and
    become not sensitive:'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 有几种技术可以使敏感数据匿名化，并使其不再敏感：
- en: '`anonymized@data.com`)'
  id: totrans-287
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`anonymized@data.com`)'
- en: '**Generalization**: Reduce the precision of sensitive values so they cannot
    identify a specific person or record (e.g., dates of birth reduced to months of
    birth, addresses trimmed to cities, etc.).'
  id: totrans-288
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**泛化**：降低敏感值的精度，以便无法识别特定个人或记录（例如，将出生日期缩减到出生月份，地址裁剪到城市等）。'
- en: '**Aggregation**: Summarize data into statistics so there is no reference to
    a person or a record.'
  id: totrans-289
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**聚合**：将数据汇总成统计数据，以便没有针对个人或记录的引用。'
- en: '**Lost decryption keys**: Delete the decryption keys so the data cannot be
    traced back to the individuals.'
  id: totrans-290
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**丢失解密密钥**：删除解密密钥，以便无法追踪数据到个人。'
- en: '**Periodic anonymization**: Aggressively scan data that has passed the retention
    period and anonymize it.'
  id: totrans-291
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**定期匿名化**：积极扫描已过保留期的数据，并将其匿名化。'
- en: '**Broken link**: An upfront database schema design that separates sensitive
    data and non-sensitive into different tables, and no tables have reference to
    the sensitive data table. This sensitive data record can be deleted anytime without
    issues (see an example in *Figure* *14**.7*).'
  id: totrans-292
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**断链**：一个预先设计的数据库模式，将敏感数据和非敏感数据分别存储在不同的表中，且没有任何表引用敏感数据表。这些敏感数据记录可以随时删除而不会出现问题（参见*图*
    *14**.7*）。'
- en: '![Figure 14.7 – Separation of sensitive and non-sensitive data for anonymization](img/B21737_14_7.jpg)'
  id: totrans-293
  prefs: []
  type: TYPE_IMG
  zh: '![图 14.7 – 敏感和非敏感数据的分离以实现匿名化](img/B21737_14_7.jpg)'
- en: Figure 14.7 – Separation of sensitive and non-sensitive data for anonymization
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.7 – 敏感和非敏感数据的分离以实现匿名化
- en: The user record table has a primary key user ID and this field can be used by
    other tables for reference. The sensitive personal record table is merely a complimentary
    table to keep only PII fields.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 用户记录表有一个主键用户ID，该字段可以被其他表用作参考。敏感个人信息记录表仅是一个补充表，仅保留PII字段。
- en: Proactively using these techniques helps organizations manage sensitive data
    and protect it from unauthorized access and potential breaches. They help maintain
    trust with customers and compliance with regulatory requirements.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 积极使用这些技术有助于组织管理敏感数据，并保护其免受未经授权的访问和潜在的安全漏洞。它们有助于与客户建立信任并符合监管要求。
- en: Coming next, we are going to briefly cover some practices for ensuring network
    security.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将简要介绍一些确保网络安全的实践。
- en: Network security
  id: totrans-298
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络安全
- en: Earlier in this chapter, we discussed how TLS works and how it prevents eavesdropping
    on network communications. However, there are other malicious attacks that do
    not require infiltrating the authentication and authorization processes.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章前面，我们讨论了TLS的工作原理以及它是如何防止网络通信窃听的。然而，还有其他不需要渗透认证和授权过程的恶意攻击。
- en: For example, **distributed denial of service** (**DDoS**) is a type of cyberattack
    in which a system is overwhelmed by multiple source systems, usually as bots and
    automated scripts, so that legitimate users cannot access the system. Attacks
    generative massive volume of traffic to saturate and exhaust the system’s resources,
    such as CPU, memory, and network.
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，**分布式拒绝服务**（**DDoS**）是一种网络攻击类型，其中系统被多个源系统（通常为机器人或自动化脚本）所淹没，以至于合法用户无法访问系统。攻击会生成大量流量以饱和和耗尽系统的资源，如CPU、内存和网络。
- en: The following are the key strategies to protect the system from these network-level
    attacks.
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些关键策略，用于保护系统免受这些网络级攻击。
- en: Web application firewalls (WAFs)
  id: totrans-302
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 网络应用防火墙（WAF）
- en: 'A **web application firewall** (**WAF**) is a security solution specialized
    in protecting systems on the internet. A WAF can run in the cloud, in a data center,
    or a mixture of both, as a front-runner before traffic from the internet reaches
    deeper inside the system. It provides a few key functions:'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: '**网络应用防火墙**（**WAF**）是一种专门用于保护互联网上系统的安全解决方案。WAF可以在云中、数据中心中运行，或两者兼而有之，作为互联网流量到达系统内部更深层次之前的前端。它提供了一些关键功能：'
- en: '**Geo-blocking and IP blacklisting**: Block traffic coming from and going to
    the list of IP addresses linked to malicious activity and block traffic from certain
    geographic regions.'
  id: totrans-304
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**地理封锁和IP黑名单**：阻止来自和前往与恶意活动相关的IP地址列表的流量，并阻止来自某些地理区域的流量。'
- en: '**Rate limiting**: Prevent the number of requests to the server from reaching
    the threshold in duration as per configuration.'
  id: totrans-305
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**速率限制**：防止服务器请求的数量达到配置的持续时间阈值。'
- en: '**Prevention of foreign script executions**: Prevent attackers from executing
    scripts that are not part of the system, such as unauthorized database commands,
    **cross-site scripting** (**XSS**) from web pages, and trojans.'
  id: totrans-306
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**防止外部脚本执行**：防止攻击者执行不属于系统的脚本，例如未经授权的数据库命令、来自网页的**跨站脚本**（**XSS**）和特洛伊木马。'
- en: '**Policy-based or rule-based access policies**: Highly configurable and customizable
    rules to set up the needs of each application at a fine-grained level.'
  id: totrans-307
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基于策略或基于规则的访问策略**：高度可配置和可定制的规则，以在细粒度级别设置每个应用程序的需求。'
- en: '**Frequent updates**: WAFs are updated frequently to adapt to the ever-changing
    landscape of security threats. WAFs address vulnerabilities outlined in the **Open
    Web Application Security Project** (**OWASP**) Top 10, which is updated periodically.'
  id: totrans-308
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**频繁更新**：WAF频繁更新以适应不断变化的网络安全威胁环境。WAF解决了**开放网络应用安全项目**（**OWASP**）Top 10中概述的漏洞，该漏洞定期更新。'
- en: Open Web Application Security Project (OWASP)
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 开放网络应用安全项目（OWASP）
- en: OWASP is an open source project with the mission to make software security visible
    and accessible to engineers and organizations. It is a global community of engineers,
    security experts, and organizations dedicated to providing free tools and knowledge
    to enhance the security of the digital environment. The OWASP Top 10 is a globally
    recognized list of the top 10 most crucial security risks. The list is updated
    regularly to reflect the evolution of security threats.
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: OWASP是一个开源项目，其使命是使软件安全对工程师和组织可见和可访问。它是一个全球性的工程师、安全专家和组织社区，致力于提供免费工具和知识，以增强数字环境的安全性。OWASP
    Top 10是全球公认的十大最关键安全风险列表。该列表定期更新，以反映安全威胁的发展。
- en: A WAF is a critical part of a comprehensive web security strategy, providing
    essential protection for web applications against a variety of attacks. An organization
    with ongoing concerns should have a WAF. A cloud-based system can choose a WAF
    from the native cloud provider, or from a WAF that can run in the cloud. A WAF
    helps organizations safeguard their applications, protect sensitive data, and
    maintain compliance with security standards.
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: WAF是全面网络安全策略的关键部分，为Web应用提供对各种攻击的基本保护。对持续存在担忧的组织应该拥有WAF。基于云的系统可以选择来自本地云提供商的WAF，或者选择可以在云中运行的WAF。WAF帮助组织保护其应用，保护敏感数据，并保持符合安全标准。
- en: Traffic routing and network segmentation
  id: totrans-312
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**流量路由和网络分段**'
- en: In contrast to traffic blacklisting and blocking, there should be explicit traffic
    routing that serves as an API gateway or proxy to applications. The explicit configuration
    serves as a whitelist of permitted traffic routes from the external world and
    helps conform to the PoLP.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 与流量黑名单和阻止相反，应该有明确的流量路由，作为API网关或代理到应用的接口。明确的配置充当了外部世界允许的流量路由的白名单，有助于符合PoLP。
- en: 'Explicitly configured traffic routes allow applying features such as the following:'
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 明确配置的流量路由允许应用以下功能：
- en: '**Distributed tracing**: Link requests that pass through multiple components
    as a holistic flow'
  id: totrans-315
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分布式跟踪**：将作为整体流通过多个组件传递的请求链接起来'
- en: '**Metrics**: Collect metrics such as packet loss, response time, connection
    time, and error rate'
  id: totrans-316
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**指标**：收集如数据包丢失、响应时间、连接时间和错误率等指标'
- en: '**Retrying**: Allow applications to retry an operation in the face of intermittent
    failures'
  id: totrans-317
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**重试**：允许应用程序在面临间歇性故障时重试操作'
- en: '**Circuit breaking**: Disallow applications to repeat operations that have
    been failing'
  id: totrans-318
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**断路器**：不允许应用程序重复执行失败的操作'
- en: '**Rate limiting**: Overlapped with the feature of WAF, limit the number of
    requests over a period'
  id: totrans-319
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**速率限制**：与WAF的功能重叠，限制一定时间内的请求数量'
- en: So far, the traffic routing we covered here is all for ingress, that is, traffic
    from the external world to internal applications. Traffic egress, from internal
    applications to external worlds, is equally important. For example, attackers
    may have installed trojans that quietly export sensitive data to an unidentified
    destination. This can be configured by routers, network switches, network ACLs,
    and WAF configurations. Cloud providers also have services that manage ingress
    and egress routes by rules and policies.
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们在这里讨论的交通路由都是针对入站流量，即从外部世界到内部应用的流量。出站流量，即从内部应用到外部世界的流量，同样重要。例如，攻击者可能已经安装了木马，悄无声息地将敏感数据传输到未知的目的地。这可以通过路由器、网络交换机、网络ACL和WAF配置来实现。云服务提供商也提供通过规则和政策管理入站和出站路由的服务。
- en: A **service mesh** is another approach to configure and control network communications,
    but it focuses on service-to-service communication. It provides a dedicated infrastructure
    layer that defines how one service communicates with another, ensuring all routes
    among services are explicitly defined. Apart from HTTP request routing, service
    mesh can be extended to other types of transports, such as messaging, files, and
    databases. It automatically detects and registers new instances of the service,
    so engineers can focus on business logic instead of network communication. Service
    mesh often uses the **Sidecar pattern** in which there is a proxy deployed alongside
    a backend service, and the proxy intercepts all inbound and outbound traffic for
    the service.
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: '**服务网格**是另一种配置和控制网络通信的方法，但它专注于服务间的通信。它提供了一个专门的底层基础设施，定义了服务之间如何通信，确保服务之间的所有路由都是明确定义的。除了HTTP请求路由外，服务网格还可以扩展到其他类型的传输，如消息传递、文件和数据库。它自动检测并注册服务的新实例，因此工程师可以专注于业务逻辑而不是网络通信。服务网格通常使用**边车模式**，其中在后台服务旁边部署了一个代理，代理拦截服务的所有入站和出站流量。'
- en: Sidecar pattern
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: '**边车模式**'
- en: The **Sidecar pattern** is an architectural design approach where a secondary
    service, known as a sidecar, is deployed alongside a primary service to extend
    its functions but to decouple from its code base. This sidecar typically runs
    in the same container or VM. The sidecar handles cross-cutting concerns, such
    as logging, monitoring, security, and communication. This pattern enhances the
    resilience and maintainability of services, but without coupling with them, and
    thus facilitates more efficient management of complex applications.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: '**边车模式**是一种架构设计方法，其中部署了一个称为边车的辅助服务，以扩展主要服务的功能，但与其代码库解耦。这个边车通常在同一个容器或虚拟机中运行。边车处理跨切面关注点，如日志记录、监控、安全和通信。这种模式增强了服务的弹性和可维护性，但不会与其耦合，从而便于更有效地管理复杂的应用程序。'
- en: '**Network segmentation** is another technique that divides a network into smaller,
    manageable segments to limit access and reduce the risk of being attacked. This
    helps contain breaches and enhances overall security. It can be implemented by
    setting up **virtual local area networks** (**VLANs**) or sub-networks.'
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: '**网络分段**是另一种技术，它将网络划分为更小、更易于管理的部分，以限制访问并降低被攻击的风险。这有助于限制违规行为并提高整体安全性。可以通过设置**虚拟局域网**（**VLANs**）或子网络来实现。'
- en: Antivirus and anti-malware solutions
  id: totrans-325
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 防病毒和反恶意软件解决方案
- en: Finally, antivirus and anti-malware solutions should be running in the infrastructure
    to scan, detect, and remove malicious software. They monitor running processes,
    scan stored files, and discover suspicious behaviors without manual intervention.
    These solutions are also automatically updated to stay with the latest threat
    definitions.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，在基础设施中应运行防病毒和反恶意软件解决方案，以扫描、检测和移除恶意软件。它们监控运行中的进程，扫描存储的文件，并发现可疑行为，而无需人工干预。这些解决方案也会自动更新以保持最新的威胁定义。
- en: Most of the network security strategies involve infrastructure solutions that
    involve application-specific configurations. In the next section, we will cover
    DevSecOps in which application engineers are proactively involved.
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数网络安全策略都涉及涉及特定应用程序配置的基础设施解决方案。在下一节中，我们将介绍DevSecOps，其中应用程序工程师会积极参与。
- en: DevSecOps
  id: totrans-328
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: DevSecOps
- en: '**DevSecOps** is a software development approach that integrates security best
    practices in the development process. It emphasizes that the responsibility of
    software security is shared among all members of the team, and security is an
    inseparable element in the development process.'
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: '**DevSecOps**是一种软件开发方法，它将安全最佳实践整合到开发过程中。它强调软件安全责任应由团队中的所有成员共同承担，安全是开发过程中的一个不可分割的元素。'
- en: 'There will still be security experts and potential security teams in an organization.
    They provide expertise, knowledge, tools, and guidance to development. DevSecOps
    embraces the following principles:'
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 在组织内仍将存在安全专家和潜在的安全团队。他们为开发提供专业知识、知识、工具和指导。DevSecOps拥抱以下原则：
- en: '**Shift left**: Security considerations are integrated early in the development
    process, as a part of the requirements. This enables the discovery, identification,
    and remediation of vulnerabilities before the application reaches production.'
  id: totrans-331
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**左移**：安全考虑因素在开发过程的早期就整合为需求的一部分。这使在应用程序达到生产之前就能发现、识别和修复漏洞。'
- en: '**Compliance as code**: Include regulatory requirements in the code with automated
    tests to validate compliance continuously.'
  id: totrans-332
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**合规性作为代码**：将监管要求纳入代码中，并使用自动化测试以持续验证合规性。'
- en: '**Collaboration and communication**: This encourages collaboration between
    development, security, and operations teams, fostering a culture of shared responsibility
    for software security.'
  id: totrans-333
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**协作与沟通**：这鼓励开发、安全和运维团队之间的协作，培养一种对软件安全共享责任的文化。'
- en: '**Automation**: Automate security processes, such as code vulnerability scanning,
    as a part of the **continuous integration / continuous deployment** (**CI/CD**)
    pipeline to provide quick feedback on security issues, and to allow the team to
    address these issues early in the development process. For example, **OWASP Dependency-Check**
    is a static analysis tool that identifies known vulnerabilities in project dependencies.
    This tool integrates with build tools such as Maven, Gradle, and Jenkins.'
  id: totrans-334
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自动化**：将安全流程自动化，例如代码漏洞扫描，作为**持续集成/持续部署**（**CI/CD**）管道的一部分，以提供对安全问题的快速反馈，并允许团队在开发早期阶段解决这些问题。例如，**OWASP
    Dependency-Check**是一个静态分析工具，用于识别项目依赖中的已知漏洞。此工具与构建工具（如Maven、Gradle和Jenkins）集成。'
- en: '**Continuous monitoring**: Continuously monitor security threats, vulnerabilities,
    and unusual behaviors in applications and infrastructure while running in all
    environments.'
  id: totrans-335
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**持续监控**：在所有环境中运行时，持续监控应用程序和基础设施中的安全威胁、漏洞和异常行为。'
- en: '**Threat modeling**: Discover and identify potential threats and vulnerabilities
    during the early stage of development, enabling teams to proactively address security
    concerns.'
  id: totrans-336
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**威胁建模**：在开发的早期阶段发现和识别潜在威胁和漏洞，使团队能够主动解决安全问题。'
- en: Benefits of DevSecOps
  id: totrans-337
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: DevSecOps的好处
- en: By integrating security throughout the whole software development cycle, organizations
    can identify and mitigate vulnerabilities early. It reduces the risk of security
    breaches, the cost of fixing security issues, and the cost of remediation.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 通过在整个软件开发周期中集成安全，组织可以早期识别和缓解漏洞。它降低了安全漏洞的风险、修复安全问题的成本和补救成本。
- en: Automation integrated within a CI/CD pipeline and collaboration helps find vulnerabilities
    early in the process. It saves time in delivering secure applications and reduces
    the time to market.
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 在CI/CD管道内集成的自动化和协作有助于在流程早期发现漏洞。它节省了交付安全应用的时间，并缩短了上市时间。
- en: Continuous monitoring and automated compliance checks help organizations meet
    regulatory requirements proactively and more effectively.
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 持续监控和自动合规性检查有助于组织积极有效地满足监管要求。
- en: DevSecOps is a cultural and technical shift in how an organization approaches
    software development and security. The practices in the DevSecOps process foster
    a culture of delivering resilient applications and responding to threats effectively,
    leading to a more secure technical ecosystem.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: DevSecOps是一种文化和技术转变，它改变了组织对待软件开发和安全的做法。DevSecOps流程中的实践培养了一种提供弹性应用和有效应对威胁的文化，从而导致了更安全的生态系统。
- en: A threat modeling exercise
  id: totrans-342
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 威胁建模练习
- en: We are going to run through an exercise of threat modeling ([https://owasp.org/www-project-threat-model/](https://owasp.org/www-project-threat-model/))
    to demonstrate how everyone in the team is involved in this activity. Product
    managers, the security team, and the development team should be involved in all
    the steps.
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将进行一次威胁建模练习（[https://owasp.org/www-project-threat-model/](https://owasp.org/www-project-threat-model/）），以展示团队中的每个人如何参与这项活动。产品经理、安全团队和开发团队应参与所有步骤。
- en: Threat modeling starts with a business scenario. We are going to use the same
    real-life example throughout the book. This is a software system that allows households
    to exchange services with each other via an agreed contract. The goal of this
    threat modeling exercise is to identify potential security threats and vulnerabilities
    in the system.
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁建模从业务场景开始。我们将在整个书中使用相同的真实生活示例。这是一个允许家庭通过约定的合同相互交换服务的软件系统。这次威胁建模练习的目标是识别系统中的潜在安全威胁和漏洞。
- en: Step 1 – visualize architecture and identify assets
  id: totrans-345
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第1步 – 可视化架构并识别资产
- en: 'The first step of threat modeling is to define the scope where threat modeling
    takes place. This includes architecture diagrams to demonstrate the following:'
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁建模的第一步是定义威胁建模发生的范围。这包括架构图来展示以下内容：
- en: Components inside the system
  id: totrans-347
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统内部组件
- en: Boundary of the system, entry points, and exit points
  id: totrans-348
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统边界、入口点和出口点
- en: Assets that require protection
  id: totrans-349
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 需要保护的资产
- en: 'There are a few choices of diagram format for this purpose, such as the **data
    flow diagram** (**DFD**) from structural analysis or container diagram (level
    2) from the **C4 model**, as covered in [*Chapter 1*](B21737_01.xhtml#_idTextAnchor013).
    The container diagram for the system is shown in *Figure 14**.8*:'
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 对于此目的，有几个图表格式可供选择，例如结构分析中的**数据流图**（**DFD**）或**C4模型**中的容器图（第2级），如[*第一章*](B21737_01.xhtml#_idTextAnchor013)所述。系统的容器图显示在*图14.8*中：
- en: '![Figure 14.8 – Container diagram of the system from a real-life example for
    threat modeling](img/B21737_14_8.jpg)'
  id: totrans-351
  prefs: []
  type: TYPE_IMG
  zh: '![图14.8 – 来自实际威胁建模示例的系统容器图](img/B21737_14_8.jpg)'
- en: Figure 14.8 – Container diagram of the system from a real-life example for threat
    modeling
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.8 – 来自实际威胁建模示例的系统容器图
- en: 'The dash-lined rectangle defines the boundary of the system and its internal
    network. We can assume the system runs in a cloud environment and it intends to
    use cloud-native services for cross-cutting functions. There are several components
    in this diagram:'
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 虚线矩形定义了系统和其内部网络的边界。我们可以假设系统运行在云环境中，并打算使用云原生服务来实现跨功能。此图中有几个组件：
- en: '**Mobile application**: A user interface on mobile devices for households.'
  id: totrans-354
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**移动应用程序**：家庭在移动设备上的用户界面。'
- en: '**WAF**: A cloud-based firewall middleware that blocks malicious IP addresses,
    limits the number of incoming requests, and prevents **XSS**.'
  id: totrans-355
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**WAF**：一个基于云的防火墙中间件，阻止恶意IP地址，限制传入请求的数量，并防止**XSS**。'
- en: '**API gateway/router**: A cloud-based middleware that routes requests from
    mobile applications to the appropriate services.'
  id: totrans-356
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**API网关/路由器**：一个基于云的中间件，将来自移动应用程序的请求路由到适当的服务。'
- en: '**Household service**: A backend service responsible for CRUD operations of
    household records.'
  id: totrans-357
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**家庭服务**：一个后端服务，负责家庭记录的CRUD操作。'
- en: '**Contract service**: A backend service responsible for managing the life cycle
    of a contract from drafted to exercised.'
  id: totrans-358
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**合同服务**：一个后端服务，负责管理从起草到执行合同的生命周期。'
- en: '**Notification service**: A backend service responsible for sending notifications
    to external users via emails.'
  id: totrans-359
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**通知服务**：一个后端服务，负责通过电子邮件向外部用户发送通知。'
- en: '**Email service**: A cloud-based middleware that delivers email content to
    given addresses.'
  id: totrans-360
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电子邮件服务**：一个基于云的中间件，将电子邮件内容发送到指定的地址。'
- en: '**IdP**: A cloud-based middleware that verifies a user’s identity using MFA
    from the mobile application and confirms if a bearer token is valid. Used by the
    household service and contract service.'
  id: totrans-361
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**IdP**：一个基于云的中间件，使用来自移动应用程序的多因素认证（MFA）验证用户的身份，并确认携带令牌是否有效。由家庭服务和合同服务使用。'
- en: '**Database**: A cloud-based database to allow applications to read data from
    and write data to. Used by the household service and contract service.'
  id: totrans-362
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据库**：一个基于云的数据库，允许应用程序从中读取数据并向其写入数据。由家庭服务和合同服务使用。'
- en: '**Messaging broker**: A cloud-based middleware that receives household updates,
    contract updates, and notification requests. It allows interested services to
    consume the messages for further processing. For instance, the notification service
    consumes notification messages and converts them to email requests to the email
    service.'
  id: totrans-363
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**消息代理**：一个基于云的中间件，接收家庭更新、合同更新和通知请求。它允许感兴趣的服务消费消息以进行进一步处理。例如，通知服务消费通知消息并将它们转换为电子邮件请求发送给电子邮件服务。'
- en: From the architecture diagram, we have identified the entry points in the system.
    Requests come in from the mobile application, they pass through the WAF, and then
    they are routed to the corresponding services.
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 从架构图中，我们确定了系统中的入口点。请求从移动应用程序进入，通过WAF，然后被路由到相应的服务。
- en: 'We have also identified two exit points in the system:'
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还在系统中确定了两个出口点：
- en: Backend services request the IdP to verify an access token
  id: totrans-366
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 后端服务请求IdP验证访问令牌
- en: The notification service requests the email service to send an email
  id: totrans-367
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通知服务请求电子邮件服务发送电子邮件
- en: 'In addition, we have identified the following assets:'
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我们还确定了以下资产：
- en: '**Household data**: Contain PIIs such as addresses and names'
  id: totrans-369
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**家庭数据**：包含地址和姓名等PIIs'
- en: '**Contract data**: Private information only available between two involved
    households'
  id: totrans-370
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**合同数据**：仅限于两个相关家庭之间的私人信息'
- en: '**Notification request**: Contain email content and email addresses (PIIs)'
  id: totrans-371
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**通知请求**：包含电子邮件内容和电子邮件地址（PIIs）'
- en: '**Application code**: Source code of all backend services and the mobile application'
  id: totrans-372
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用程序代码**：所有后端服务和移动应用程序的源代码'
- en: '**Infrastructure**: Servers, databases, network components, infrastructure
    configurations as code'
  id: totrans-373
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基础设施**：服务器、数据库、网络组件、基础设施配置代码'
- en: With the architecture diagrams, entry points, exit points, and identified assets,
    the team can now examine the information and discover threats and vulnerabilities
    in the system.
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: 在架构图、入口点、出口点和已识别的资产的基础上，团队现在可以检查信息并发现系统中的威胁和漏洞。
- en: Step 2 – identify threats
  id: totrans-375
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第2步 – 识别威胁
- en: 'The team applies the **STRIDE** framework to categorize potential threats based
    on the identified assets. STRIDE is a combination of the first letters of the
    following six aspects:'
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 团队应用**STRIDE**框架根据已识别的资产对潜在威胁进行分类。STRIDE是以下六个方面的首字母缩写组合：
- en: '**Spoofing**: Unauthorized users may impersonate legitimate users'
  id: totrans-377
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**欺骗**：未经授权的用户可能冒充合法用户'
- en: '**Tampering**: Malicious modification of household or contract data in transit'
  id: totrans-378
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**篡改**：在传输过程中恶意修改家庭或合同数据'
- en: '**Repudiation**: Household users may deny agreeing to a contract with another
    household'
  id: totrans-379
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**否认**：家庭用户可能否认与另一家庭签订合同'
- en: '**Information disclosure**: PII, such as names, addresses, and email addresses,
    are exposed through vulnerabilities'
  id: totrans-380
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**信息泄露**：PII（个人身份信息），如姓名、地址和电子邮件地址，通过漏洞暴露'
- en: '**Denial of service**: Attackers may overwhelm and exhaust the system with
    traffic'
  id: totrans-381
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**拒绝服务**：攻击者可能通过流量使系统过载和耗尽'
- en: '**Elevation of privilege**: Users gaining access to unauthorized functions'
  id: totrans-382
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**特权提升**：用户访问未经授权的功能'
- en: After threats are identified, the team needs to assess the risks and determine
    how to respond to them.
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 在确定威胁后，团队需要评估风险并确定如何应对它们。
- en: Step 3 – assess risks and determine responses
  id: totrans-384
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第3步 – 评估风险并确定反应
- en: 'Risks can be assessed by two factors: likelihood and impact. These two factors
    are multiplied to derive the risk level and thus the priority of the responses.'
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 风险可以通过两个因素进行评估：可能性和影响。这两个因素相乘得到风险等级，从而确定反应的优先级。
- en: 'A simple approach is to have three levels for each factor, and each level is
    associated with an integer. The multiplication of the integers is the risk level.
    An organization can customize the levels and integers as it sees fit. In this
    example, the integers are assigned to each level as follows:'
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: 一种简单的方法是为每个因素设置三个级别，每个级别都与一个整数相关联。整数的乘积是风险等级。组织可以根据需要自定义级别和整数。在这个例子中，整数分配给每个级别如下：
- en: '**Likelihood**: 1 – Unlikely, 2 – Possibly, 3 – Likely'
  id: totrans-387
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可能性**：1 – 不太可能，2 – 可能，3 – 很可能'
- en: '**Impact**: 1 – Low, 2 – Medium, 3 – High'
  id: totrans-388
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**影响**：1 – 低，2 – 中等，3 – 高'
- en: 'The numeric values of these two factors constitute the risk assessment table,
    as shown in *Table 14.1*:'
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: 这两个因素的数值构成了风险评估表，如*表14.1*所示：
- en: '| **Threat** | **Likelihood** | **Impact** | **Risk level** |'
  id: totrans-390
  prefs: []
  type: TYPE_TB
  zh: '| **威胁** | **可能性** | **影响** | **风险等级** |'
- en: '| **Spoofing**: User impersonation | 2 | 3 | 6 |'
  id: totrans-391
  prefs: []
  type: TYPE_TB
  zh: '| **欺骗**：用户冒充 | 2 | 3 | 6 |'
- en: '| **Tampering**: Malicious data modifications | 2 | 3 | 6 |'
  id: totrans-392
  prefs: []
  type: TYPE_TB
  zh: '| **篡改**：恶意数据修改 | 2 | 3 | 6 |'
- en: '| **Repudiation**: Household denying actions | 1 | 2 | 2 |'
  id: totrans-393
  prefs: []
  type: TYPE_TB
  zh: '| **否认**：家庭否认行为 | 1 | 2 | 2 |'
- en: '| **Information**: PII disclosure | 2 | 3 | 6 |'
  id: totrans-394
  prefs: []
  type: TYPE_TB
  zh: '| **信息**：PII泄露 | 2 | 3 | 6 |'
- en: '| Denial of service | 2 | 2 | 4 |'
  id: totrans-395
  prefs: []
  type: TYPE_TB
  zh: '| 拒绝服务 | 2 | 2 | 4 |'
- en: '| **Elevation of privilege**: Unauthorized user actions | 1 | 3 | 3 |'
  id: totrans-396
  prefs: []
  type: TYPE_TB
  zh: '| **特权提升**：未经授权的用户行为 | 1 | 3 | 3 |'
- en: Table 14.1 – Example of risk assessment table
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: 表14.1 – 风险评估表示例
- en: The risk levels are effectively the priority of security threats that the team
    needs to respond to and address, with the highest number being the highest priority,
    and the lowest number the lowest priority.
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: 风险等级实际上是团队需要响应和解决的安全威胁的优先级，最高数字代表最高优先级，最低数字代表最低优先级。
- en: 'There are four general responses to a risk, and the team must choose one response
    for each security risk:'
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: 面对风险有四种一般性反应，团队必须为每个安全风险选择一种反应：
- en: '**Mitigation**: Reduce the negative impact of the threat'
  id: totrans-400
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**缓解**：减少威胁的负面影响'
- en: '**Transfer**: Shift the risk to another party, typically by using third-party
    software'
  id: totrans-401
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**转移**：将风险转移到另一方，通常是通过使用第三方软件'
- en: '**Avoidance**: Eliminate the risk by developing a new strategy or solution'
  id: totrans-402
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**规避**：通过开发新的策略或解决方案消除风险'
- en: '**Acceptance**: Accept and acknowledge the risk, but no further actions'
  id: totrans-403
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**接受**：接受并承认风险，但不再采取进一步行动'
- en: 'For each threat identified by the STRIDE framework, a response should be outlined,
    as follows:'
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: 根据STRIDE框架确定的每个威胁，应概述以下反应：
- en: '**Spoofing – transfer**: Use the cloud-based IdP to implement MFA and to secure
    passwords'
  id: totrans-405
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**欺骗 – 转移**：使用基于云的IdP实现多因素认证并保护密码'
- en: '**Tampering – avoidance**: Use HTTPS over TLS'
  id: totrans-406
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**篡改 – 避免措施**：使用TLS之上的HTTPS'
- en: '**Repudiation – mitigation**: Ensure sufficient audit trails and logging of
    all user actions related to household and contract records'
  id: totrans-407
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**否认 – 缓解**：确保有足够的审计跟踪和记录所有与家庭和合同记录相关的用户操作'
- en: '**Information disclosure – avoidance**: Use encrypted databases, encrypt sensitive
    data in messaging payload, integrate code vulnerability scanning in CI/CD pipelines,
    and conduct regular security audits'
  id: totrans-408
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**信息泄露 – 避免措施**：使用加密数据库，在消息有效负载中加密敏感数据，将代码漏洞扫描集成到CI/CD管道中，并定期进行安全审计'
- en: '**Denial of service – transfer**: Configure WAF to protect the network from
    DDoS attacks'
  id: totrans-409
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**拒绝服务 – 转移**：配置WAF以保护网络免受DDoS攻击'
- en: '**Elevation of privilege – mitigation**: Periodically review access control
    settings and conduct security training with internal users'
  id: totrans-410
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**提升权限 – 缓解**：定期审查访问控制设置，并与内部用户进行安全培训'
- en: At this point, the architecture has been discussed from a security perspective.
    Threats are identified and their risk levels are determined. Each risk has been
    responded to. There are only a few steps to complete one round of threat modeling,
    which are covered in the next step.
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经从安全的角度讨论了架构。已经确定了威胁及其风险等级。每个风险都已得到响应。完成一轮威胁建模只需要几个步骤，这些步骤将在下一步介绍。
- en: Step 4 – document, review, and update
  id: totrans-412
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第4步 – 记录、审查和更新
- en: After conducting all the activities in the previous steps, it is paramount to
    have them all documented, preferably as a single page with rough dates when the
    threat was modeled. The documentation serves as a record of learning as a team
    and as a checklist of follow-up actions.
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 在完成前一步的所有活动后，所有活动都应得到记录，最好是作为单页文档，并标注威胁建模的大致日期。该文档作为团队学习记录和后续行动清单。
- en: The security team should review the documentation and advise if there are any
    additional topics to discuss. Otherwise, the security team should sign off on
    the threat modeling document as a reviewer.
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: 安全团队应审查文档，并建议是否有任何其他主题需要讨论。否则，安全团队应作为审阅者签署威胁建模文档。
- en: The team should convert the risk responses into work items in the backlog to
    ensure that the decided actions are executed.
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
  zh: 团队应将风险响应转换为待办事项中的工作项，以确保决定采取的行动得到执行。
- en: The team should also periodically review this document and decide whether there
    should be another round of threat modeling. Alternatively, if there is an important
    feature change or an architecture change, then the team should consider whether
    there is a need to update the threat model.
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
  zh: 团队还应定期审查此文档，并决定是否需要进行另一轮威胁建模。或者，如果发生重要功能变更或架构变更，则团队应考虑是否需要更新威胁模型。
- en: Threat modeling is a tool and process used to help the team deliver secure software
    at the beginning of development. It benefits engineers, security team, product
    managers, and customers by having secure software products that are developed
    efficiently by addressing security issues early.
  id: totrans-417
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁建模是一种工具和流程，用于帮助团队在开发初期交付安全的软件。它通过早期解决安全问题，使工程师、安全团队、产品经理和客户受益，开发出高效的软件产品。
- en: Summary
  id: totrans-418
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: We discussed the importance of security in software architecture, and how sensitive
    information is categorized. Afterward, we covered the CIA triad for the security
    principles of confidentiality, integrity, and availability.
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 我们讨论了在软件架构中安全的重要性以及敏感信息的分类。之后，我们介绍了保密性、完整性和可用性的安全原则——CIA三要素。
- en: We covered authentication with the spotlight on how TLS works and how it prevents
    cyberattacks such as MitM eavesdropping. We delved into the details of how MFA
    works and its implications for software architecture.
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 我们讨论了身份验证，重点关注TLS的工作原理及其如何防止中间人监听等网络攻击。我们深入探讨了多因素认证的工作原理及其对软件架构的影响。
- en: Then, we moved on to the topic of authorization, and we covered the four major
    access control methods (role-based, policy-based, attribute-based, and ACLs).
    We discussed how authorization has impacted software architecture.
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们转向授权主题，并介绍了四种主要的访问控制方法（基于角色的、基于策略的、基于属性的以及ACLs）。我们讨论了授权如何影响软件架构。
- en: We mentioned the basic practices in handling sensitive data, including data
    classification, and protecting data in transit and in rest. A few approaches are
    highlighted on how Kotlin engineers can avoid accidentally logging sensitive data.
    A couple of strategies for anonymizing data are included in this chapter.
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: 我们提到了处理敏感数据的基本实践，包括数据分类，以及在传输和静止状态下保护数据。本章突出了一些 Kotlin 工程师可以避免意外记录敏感数据的方法。还包括了一些匿名化数据的策略。
- en: We briefly mentioned the principles of DevSecOps and its benefits to the software
    development cycle by having security integrated into the development process.
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: 我们简要介绍了 DevSecOps 的原则及其通过将安全集成到开发过程中对软件开发周期的益处。
- en: Finally, we ran through a threat modeling exercise with the real-life example
    system. We visited the details of each step, emphasized how to conclude a cycle,
    and when the threat model should be re-visited.
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们使用实际示例系统进行了威胁建模练习。我们详细探讨了每个步骤的细节，强调了如何结束一个循环，以及何时应该重新审视威胁模型。
- en: There are still some aspects of engineering that go beyond just architecture.
    We will cover a few miscellaneous topics that are specific to Kotlin engineers
    in the next and last chapters. We hope you will find them useful in supporting
    better software architecture.
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: 仍然有一些工程方面的内容超出了仅仅架构的范畴。在下一章和最后一章中，我们将讨论一些特定于 Kotlin 工程师的相关杂项主题。我们希望您会发现它们在支持更好的软件架构方面很有用。
