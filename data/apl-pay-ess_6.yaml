- en: Chapter 6. Apple Pay API Summary
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 6 章。Apple Pay API 概述
- en: 'You process Apple Pay transactions in three phases:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 您在三个阶段处理 Apple Pay 交易：
- en: '**Preparation**: Create a payment request and populate it with payment information
    and details about the product the user is purchasing.'
  id: totrans-2
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**准备**：创建一个支付请求，并用支付信息和用户购买的产品详情填充它。'
- en: '**Payment sheet interaction**: Respond to user interactions with the payment
    sheet (such as changes to the shipping address or the desired shipping method)
    through the methods of the `PKPaymentAuthorizationViewControllerDelegate` protocol.'
  id: totrans-3
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**支付表单交互**：通过 `PKPaymentAuthorizationViewControllerDelegate` 协议的方法响应用户与支付表单的交互（例如更改送货地址或所需的运输方式）。'
- en: '**Payment processing**: Process the Apple Pay transaction on the user''s device
    and your own servers through the API provided by your payment gateway and HTTP
    requests to your order processing web app.'
  id: totrans-4
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**支付处理**：通过您的支付网关提供的 API 和对您的订单处理 Web 应用的 HTTP 请求，在用户的设备和您的服务器上处理 Apple Pay
    交易。'
- en: Earlier chapters showed the workflows you use to interact with the major actors
    in Apple Pay transactions. This chapter provides helpful information on the classes,
    methods, and properties of the Apple Pay API that you must become familiar with
    to use it effectively. However, when you need even more detailed information,
    you should consult the Apple developer documentation.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 早期章节展示了您用于与 Apple Pay 交易中的主要参与者交互的工作流程。本章提供了有关 Apple Pay API 的类、方法和属性的有用信息，这些信息是您为了有效使用它而必须熟悉的。然而，当您需要更详细的信息时，您应该查阅
    Apple 开发者文档。
- en: In this chapter, you will learn about the major Apple Pay classes involved in
    payment transactions, such as the `PKPaymentReqest` and `PKPaymentSummaryItem`
    classes. You will also learn how to respond to payment sheet events through the
    `PKPaymentAuthorizationViewControllerDelegate` protocol. Finally, the chapter
    will describe the additional classes that the Apple Pay API uses to work with
    addresses, such as the `PKContact` class.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您将了解涉及支付交易的 Apple Pay 主要类，例如 `PKPaymentReqest` 和 `PKPaymentSummaryItem`
    类。您还将了解如何通过 `PKPaymentAuthorizationViewControllerDelegate` 协议响应用支付表单事件。最后，本章将描述
    Apple Pay API 用于处理地址的附加类，例如 `PKContact` 类。
- en: 'This chapter covers the following topics:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖了以下主题：
- en: Major Apple Pay classes involved in payment transactions, such as the `PKPaymentReqest`
    and `PKPaymentSummaryItem` classes
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 涉及支付交易的 Apple Pay 主要类，例如 `PKPaymentReqest` 和 `PKPaymentSummaryItem` 类
- en: Responses to payment sheet events through the `PKPaymentAuthorizationViewControllerDelegate`
    protocol
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过 `PKPaymentAuthorizationViewControllerDelegate` 协议对支付表单事件进行响应
- en: Additional classes that the Apple Pay API uses to work
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Apple Pay API 使用的其他类来工作
- en: Main classes
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 主要类
- en: 'This section describes the major Apple Pay classes you use to process Apple
    Pay transactions. These classes include:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 本节描述了您用于处理 Apple Pay 交易的 Apple Pay 主要类。这些类包括：
- en: '`PKPaymentButton`: You use this class to display a **Pay** button, which the
    user uses to begin an Apple Pay transaction.'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentButton`: 您使用这个类来显示一个**支付**按钮，用户通过这个按钮开始 Apple Pay 交易。'
- en: '`PKPaymentRequest`: This class represents a payment request, which the user
    authorizes or cancels in the payment sheet.'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentRequest`: 这个类代表一个支付请求，用户在支付表单中授权或取消该请求。'
- en: '`PKPaymentSummaryItem`: Instances of this class represent summary items (such
    as subtotal, shipping costs, and total) in the payment sheet.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentSummaryItem`: 这个类的实例代表支付表单中的摘要项（例如小计、运费和总计）。'
- en: '`PKPaymentMethod`: This class provides access to information about the payment
    card used in Apple Pay transaction.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentMethod`: 这个类提供了访问 Apple Pay 交易中使用的支付卡信息的方式。'
- en: '`PKShippingMethod`: Instances of this class represent the shipment methods
    you support.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKShippingMethod`: 这个类的实例代表您支持的运输方式。'
- en: '`PKPaymentAuthorizationViewController`: This class determines whether the user
    can use Apple Pay on the device. It is also used to present the payment sheet
    on the screen.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentAuthorizationViewController`: 这个类用于确定用户是否可以在设备上使用 Apple Pay。它还用于在屏幕上显示支付表单。'
- en: '`PKPayment`: Instances of this class store payment information for Apple Pay
    transactions.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPayment`: 这个类的实例存储 Apple Pay 交易的支付信息。'
- en: '`PKPaymentToken`: Instances of this class contain encrypted payment information
    ready to be submitted to a payment processor to charge the user''s payment card.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentToken`: 这个类的实例包含加密的支付信息，准备提交给支付处理器以对用户的支付卡进行收费。'
- en: The PKPaymentButton class
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PKPaymentButton 类
- en: The `PKPaymentButton` class provides users with a button they tap to start an
    Apple Pay transaction. You should use Apple Pay buttons to start only Apple Pay
    transactions.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '`PKPaymentButton` 类为用户提供了一个点击以启动 Apple Pay 交易的按钮。您应该仅使用 Apple Pay 按钮来启动 Apple
    Pay 交易。'
- en: Before displaying the **Apple** **Pay** button, you must ensure that the device
    supports Apple Pay by calling the `canMakePayments` method of the `PKPaymentAuthorizationViewController`
    class. You should also call either `canMakePaymentsUsingNetworks:` or `canMakePaymentsUsingNetworks:capabilities:`
    of the same class to ensure that the user's payment cards support the payment
    networks and payment processor capabilities you require. Refer to *The PKPaymentAuthorizationViewController
    class* later in this section for details.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在显示 **Apple** **Pay** 按钮之前，您必须通过调用 `PKPaymentAuthorizationViewController` 类的
    `canMakePayments` 方法来确保设备支持 Apple Pay。您还应该调用同一类的 `canMakePaymentsUsingNetworks:`
    或 `canMakePaymentsUsingNetworks:capabilities:` 来确保用户的支付卡支持您所需的支付网络和支付处理器功能。有关详细信息，请参阅本节后面的
    *`PKPaymentAuthorizationViewController` 类*。
- en: If the device does not support Apple Pay, or the payment cards that the user
    has added to the device are not compatible with the payment networks and payment
    processor capabilities you require, use a standard button with a title such as
    **Buy** to start standard payment transactions.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 如果设备不支持 Apple Pay，或者用户添加到设备上的支付卡与您所需的支付网络和支付处理器功能不兼容，请使用带有标题如 **Buy** 的标准按钮来启动标准支付交易。
- en: Creating the button
  id: totrans-25
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建按钮
- en: Use this method to create a **Apple** **Pay** button. Use Apple Pay buttons
    only for Apple Pay transactions.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 使用此方法创建一个 **Apple** **Pay** 按钮。仅使用 Apple Pay 按钮进行 Apple Pay 交易。
- en: +buttonWithType:style
  id: totrans-27
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: +buttonWithType:style
- en: This method provides an **Apple** **Pay** button.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 此方法提供了一个 **Apple** **Pay** 按钮。
- en: 'Here are the arguments:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是参数：
- en: '`type` (`PKPaymentButtonType`): This specifies the button''s title. The options
    are plain (**Pay**), buy (**Buy with Pay**), and set up (**Set up Pay**). To learn
    more about using the last option, refer to *Apple Pay Programming Guide* in the
    Apple Developer library.'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`type` (`PKPaymentButtonType`): 这指定了按钮的标题。选项有普通（**Pay**）、购买（**Buy with Pay**）和设置（**Set
    up Pay**）。要了解更多关于使用最后一个选项的信息，请参阅 Apple 开发者库中的 *`Apple Pay Programming Guide`*。'
- en: '`style` (`PKPaymentButtonStyle`): This specifies the button''s appearance.
    Use it to ensure that the button stands out from the background. The options are
    white, white outline, and black.'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`style` (`PKPaymentButtonStyle`): 这指定了按钮的外观。使用它来确保按钮从背景中突出。选项有白色、白色轮廓和黑色。'
- en: The PKPaymentRequest class
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`PKPaymentRequest` 类'
- en: The `PKPaymentRequest` class represents a request for payment for particular
    goods. This is the main class you use in Apple Pay transactions. You can use one
    instance of this class per Apple Pay transaction. A payment request contains information
    about the merchant requesting the payment, the country where the payment is to
    be processed, the currency to use, the price of the items for which the payment
    is requested (including shipping cost, tax, and so on), and the supported payment
    networks (such as Amex, Discover, and Visa).
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: '`PKPaymentRequest` 类代表对特定商品的支付请求。这是您在 Apple Pay 交易中使用的主体类。您可以在每个 Apple Pay
    交易中使用此类的单个实例。支付请求包含有关请求支付的商业信息、支付处理的国家、使用的货币、请求支付的项目的价格（包括运费、税费等），以及支持的支付网络（如
    Amex、Discover 和 Visa）。'
- en: When the user authorizes a payment request in the payment sheet, you will get
    a `PKPayment` object, which you need to submit to your payment gateway to obtain
    a `PKPaymentToken` object (or a substitute), which, in turn, you can use in your
    order processing system to charge the user's payment card.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户在支付表中授权支付请求时，您将获得一个 `PKPayment` 对象，您需要将其提交给您的支付网关以获取一个 `PKPaymentToken` 对象（或替代品），然后您可以使用它来在您的订单处理系统中对用户的支付卡进行收费。
- en: Payment processing information
  id: totrans-35
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 支付处理信息
- en: These required properties specify information that your payment gateway uses
    to process the payment. These should be the first things you set on a payment
    request.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 这些必需的属性指定了您的支付网关用于处理支付的信息。这些应该是您在支付请求上设置的第一件事。
- en: countryCode (NSString*)
  id: totrans-37
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: countryCode (NSString*)
- en: This is a two-letter code (ISO 3166) for the country in which the payment is
    to be processed, for example `"US"`.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个表示支付处理国家（ISO 3166）的两个字母代码，例如 `"US"`。
- en: 'This code sets the `countryCode` property of a payment request to `US`, as
    follows:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 此代码将支付请求的 `countryCode` 属性设置为 `US`，如下所示：
- en: '[PRE0]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: currencyCode (NSString*)
  id: totrans-41
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: currencyCode (NSString*)
- en: This is a three-letter code (ISO 4217) for the currency to be used to process
    the payment, for example `"USD".`
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 这是用于处理支付的货币的三位代码（ISO 4217），例如 `"USD"`。
- en: merchantCapabilities (PKMerchantCapability)
  id: totrans-43
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: merchantCapabilities (PKMerchantCapability)
- en: These are the payment processing protocols your payment gateway supports. The
    3-D Secure protocol is required. Other protocols available are EMV (Europay, MasterCard,
    Visa), credit card, and debit card.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是您的支付网关支持的支付处理协议。3-D Secure 协议是必需的。其他可用的协议包括 EMV（欧联、万事达卡、维萨卡）、信用卡和借记卡。
- en: 'These constants identify the following payment processing capabilities that
    Apple Pay supports:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 这些常量标识了苹果支付支持的以下支付处理能力：
- en: '`PKMerchantCapability3DS`'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKMerchantCapability3DS`'
- en: '`PKMerchantCapabilityEMV`'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKMerchantCapabilityEMV`'
- en: '`PKMerchantCapabilityCredit`'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKMerchantCapabilityCredit`'
- en: '`PKMerchantCapabilityDebit`'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKMerchantCapabilityDebit`'
- en: 'The following code sets the `merchantCapabilities` property of a payment request
    to 3D Secure and EMV:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码将支付请求的 `merchantCapabilities` 属性设置为 3D Secure 和 EMV：
- en: '[PRE1]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: merchantIdentifier (NSString*)
  id: totrans-52
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: merchantIdentifier (NSString*)
- en: This is a merchant identifier stored in your project's `Entitlements` file.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个存储在您项目 `Entitlements` 文件中的商户标识符。
- en: supportedNetworks (NSArray<NSString*>*)
  id: totrans-54
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: supportedNetworks (NSArray<NSString*>*)
- en: This includes the payment networks (or associations) you support. The options
    available are Discover, MasterCard, Visa, and private label (store card).
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 这包括您支持的支付网络（或关联）。可用的选项有发现卡、万事达卡、维萨卡和私人标签（商店卡）。
- en: 'These constants identify the following payment networks that Apple Pay supports:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 这些常量标识了苹果支付支持的以下支付网络：
- en: '`PKPaymentNetworkAmex`'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkAmex`'
- en: '`PKPaymentNetworkDiscover`'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkDiscover`'
- en: '`PKPaymentNetworkMasterCard`'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkMasterCard`'
- en: '`PKPaymentNetworkPrivateLabel`'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkPrivateLabel`'
- en: '`PKPaymentNetworkVisa`'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkVisa`'
- en: 'For example, this code sets the `supportedNetworks` property of a payment request
    to Amex and MasterCard:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，此代码将支付请求的 `supportedNetworks` 属性设置为美国运通和万事达卡：
- en: '[PRE2]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Payment summary items
  id: totrans-64
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 支付摘要项目
- en: Summary items identify and price the product that the customer is purchasing
    (the subtotal) and related items, such as the tax, shipping cost, and total.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 摘要项目标识并定价客户购买的产品（小计）和相关项目，如税费、运费和总计。
- en: paymentSummaryItems (NSArray<PKPaymentSummaryItem*>*)
  id: totrans-66
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: paymentSummaryItems (NSArray<PKPaymentSummaryItem*>*)
- en: This is an array of summary items, which specify a label and price for each
    item. Additionally, you can identify an item as *pending* (the price is not yet
    set, but it will be determined after the service is complete, such as for a taxi
    ride) or *final*. Refer to the *The PKSummaryItem class* section for details.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个摘要项目数组，指定每个项目的标签和价格。此外，您可以将项目标识为 *待定*（价格尚未设置，但在服务完成后将确定，例如出租车行程）或 *最终*。有关详细信息，请参阅
    *PKSummaryItem 类* 部分。
- en: The required address fields
  id: totrans-68
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 必要的地址字段
- en: These properties specify which fields of the billing and shipping address you
    require to be entered in the payment sheet so that they are available in the `PKPayment`
    object provided by the payment sheet when the user authorizes the payment request.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 这些属性指定了您需要在支付表中输入的账单和发货地址的字段，以便它们在用户授权支付请求时在支付表提供的 `PKPayment` 对象中可用。
- en: requiredBillingAddressFields (PKAddressField), requiredShippingAddressFields
    (PKAddressField)
  id: totrans-70
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: requiredBillingAddressFields (PKAddressField), requiredShippingAddressFields
    (PKAddressField)
- en: 'If you require a name, e-mail, and postal address in the shipping information,
    you can use code similar to this:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您需要在发货信息中包含姓名、电子邮件和邮政地址，可以使用类似以下代码：
- en: '[PRE3]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'These are the address field specifier constants:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是地址字段指定常量：
- en: '`PKAddressFieldNone` (no field is required)'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKAddressFieldNone`（不需要任何字段）'
- en: '`PKAddressFieldPostalAddress`'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKAddressFieldPostalAddress`'
- en: '`PKAddressFieldPhone`'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKAddressFieldPhone`'
- en: '`PKAddressFieldEmail`'
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKAddressFieldEmail`'
- en: '`PKAddressFieldName`'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKAddressFieldName`'
- en: '`PKAddressFieldAll`'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKAddressFieldAll`'
- en: Billing and shipping contacts
  id: totrans-80
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 账单和发货联系人
- en: These properties specify the billing and shipping contact information. You can
    set them before displaying the payment sheet (however, this is not recommended
    because the user is most likely to have up-to-date contact information). The user
    can also change them by picking or specifying a different contact on the payment
    sheet.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 这些属性指定了账单和发货联系信息。您可以在显示支付表之前设置它们（然而，这并不推荐，因为用户最有可能拥有最新的联系信息）。用户也可以通过在支付表中选择或指定不同的联系人来更改它们。
- en: billingContact (PKContact*), shippingContact (PKContact*)
  id: totrans-82
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: billingContact (PKContact*), shippingContact (PKContact*)
- en: 'These are the components of a `PKContact` object:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是 `PKContact` 对象的组成部分：
- en: '`emailAddress (NSString*)`'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`emailAddress (NSString*)`'
- en: '`name (NSPersonNameComponents*)`'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`name (NSPersonNameComponents*)`'
- en: '`phoneNumber (CNPhoneNumber*)`'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`phoneNumber (CNPhoneNumber*)`'
- en: '`postalAddress (CNPostalAddress*)`'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`postalAddress (CNPostalAddress*)`'
- en: Shipping methods
  id: totrans-88
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 运输方式
- en: Shipping methods are the shipping options (carriers or speed) that you support.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 运输方式是你支持的运输选项（承运人或速度）。
- en: shippingMethods (NSArray<PKShippingMethod*>*)
  id: totrans-90
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: shippingMethods (NSArray<PKShippingMethod*>*)
- en: This property contains the set of shipping methods available to the customer.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 此属性包含客户可用的运输方式集合。
- en: 'Each `PKShippingMethod` object has these properties:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 每个`PKShippingMethod`对象都有以下属性：
- en: '`detail (NSString*)`: This describes the shipping method to the user, for example
    `"Delivers in four days"`.'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`detail (NSString*)`: 这向用户描述了运输方式，例如 `"四天内送达"`。'
- en: '`identifier (NSString*)`: This identifies the shipping method within the app.
    When the user selects a shipping method, use this property to identify the method
    chosen.'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`identifier (NSString*)`: 这在应用中标识运输方式。当用户选择一种运输方式时，使用此属性来识别所选择的方法。'
- en: Shipping type
  id: totrans-95
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 运输类型
- en: This specifies the way in which the product is transported, for example whether
    it is shipped by the merchant, or picked up by the customer from the merchant's
    store.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 这指定了产品运输的方式，例如是否由商家发货，或者由客户从商家的店铺取货。
- en: shippingType (PKShippingType)
  id: totrans-97
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: shippingType (PKShippingType)
- en: 'These are the shipping types available:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是可用的运输类型：
- en: '`PKShippingTypeShipping` (default): The merchant ships the product to the customer
    using the shipping method that the customer selects.'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKShippingTypeShipping` (默认): 商家使用客户选择的运输方式将产品运送给客户。'
- en: '`PKShippingTypeDelivery`: The merchant delivers (using a vehicle) the product
    to the customer. This is used for food, groceries, furniture, or specialty items
    that cannot be shipped.'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKShippingTypeDelivery`: 商家（使用车辆）将产品运送给客户。这用于食品、杂货、家具或不能运输的特殊商品。'
- en: '`PKShippingTypeStorePickup`: The customer picks up the product from the merchant''s
    store. In this case, set `shippingContact` to your store''s address or hide it
    from the payment sheet by setting `requiredShippingAddressFields` to `PKAddressFieldNone`.
    Remember to confirm the pickup location with the customer in a reliable way.'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKShippingTypeStorePickup`: 客户从商家的店铺取货。在这种情况下，将`shippingContact`设置为你的店铺地址或通过将`requiredShippingAddressFields`设置为`PKAddressFieldNone`来隐藏它从支付单中。请记住，以可靠的方式与客户确认取货地点。'
- en: '`PKShippingTypeServicePickup`: The merchant picks up an object from the address
    specified in `shippingContact` (for example, when the customer is paying to have
    something delivered).'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKShippingTypeServicePickup`: 商家从`shippingContact`中指定的地址取货（例如，当客户支付要求送货时）。'
- en: Application data
  id: totrans-103
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 应用数据
- en: This property stores the hash of an `NSData` object.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 此属性存储了一个`NSData`对象的哈希值。
- en: applicationData (NSData*)
  id: totrans-105
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: applicationData (NSData*)
- en: When set, this property contains a hash of the data specified (it does not,
    however, contain the value of the data). If your payment gateway supports it,
    the `paymentData` property of the `PKPaymentToken` object you get from the payment
    gateway API is set to the same hash value generated when you set `applicationData`.
    You can send this hash as part of sending payment information to your order-processing
    server. Separately, you can send the actual data to your server. You can then
    compute the hash on your server and compare the two hashes to ensure that the
    data was not changed in transit.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 当设置时，此属性包含指定数据的哈希值（然而，它不包含数据的值）。如果你的支付网关支持它，从支付网关API获取的`PKPaymentToken`对象的`paymentData`属性设置为当你设置`applicationData`时生成的相同哈希值。你可以将此哈希值作为发送支付信息到你的订单处理服务器的一部分发送。另外，你可以将实际数据发送到你的服务器。然后你可以在服务器上计算哈希值，并将两个哈希值进行比较，以确保数据在传输过程中未被更改。
- en: The PKPaymentSummaryItem class
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PKPaymentSummaryItem类
- en: The `PKPaymentSummaryItem` class represents an item for which the customer is
    paying, such as the subtotal representing the product price, tax, shipping cost,
    and so on. You can identify one or more items as "pending" (the price cannot be
    determined until some time in the future) or "final". The payment sheet does not
    show the price of "pending" items; therefore, you should set the price of such
    items to zero. You can compute the actual price when the service (such as a taxi
    ride) is completed and report it to the customer when the transaction is complete.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '`PKPaymentSummaryItem` 类代表客户支付的项，例如代表产品价格、税费、运费等的总计。你可以将一个或多个项标识为“挂起”（价格必须在未来的某个时间才能确定）或“最终”。支付单不会显示“挂起”项的价格；因此，你应该将这些项的价格设置为零。当服务（如出租车行程）完成时，你可以计算实际价格并在交易完成后向客户报告。'
- en: Creating a summary item
  id: totrans-109
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建摘要项
- en: These methods create summary items.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 这些方法创建摘要项。
- en: '+summaryItemWithLabel:amount:'
  id: totrans-111
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '+summaryItemWithLabel:amount:'
- en: This creates a "final" summary item with a label and amount.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 这创建了一个带有标签和金额的“最终”摘要项。
- en: '+summaryItemWithLabel:amount:type:'
  id: totrans-113
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '+summaryItemWithLabel:amount:type:'
- en: This creates a "pending" or "final" summary item with a label and amount.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 这创建了一个带有标签和金额的“挂起”或“最终”摘要项。
- en: 'The following code creates a "pending" summary item:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码创建了一个“挂起”摘要项：
- en: '[PRE4]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Summary item components
  id: totrans-117
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 摘要项组件
- en: These properties access the components of a summary item.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 这些属性访问摘要项的组件。
- en: label (NSString*)
  id: totrans-119
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 标签（NSString*）
- en: This is the label of the summary item.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 这是摘要项的标签。
- en: amount (NSDecimalNumber*)
  id: totrans-121
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 金额（NSDecimalNumber*）
- en: This is the price of the summary item (it is shown in the payment sheet if the
    item is "final").
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 这是摘要项的价格（如果项目是“最终”，则显示在支付单上）。
- en: Pending or final
  id: totrans-123
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 挂起或最终
- en: This property determines the type of the summary item.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 这个属性决定了摘要项的类型。
- en: type (PKPaymentSummaryItemType)
  id: totrans-125
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 类型（PKPaymentSummaryItemType）
- en: This specifies whether the item is "pending" or "final."
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 这指定了项目是“挂起”还是“最终”。
- en: 'These are the possible values of the `type` property:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 这是 `type` 属性的可能值：
- en: '`PKPaymentSummaryItemTypeFinal`'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentSummaryItemTypeFinal`'
- en: '`PKPaymentSummaryItemTypePending`'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentSummaryItemTypePending`'
- en: The PKPaymentMethod class
  id: totrans-130
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`PKPaymentMethod` 类'
- en: The `PKPaymentMethod` class provides access to information about the payment
    card used in an Apple Pay transaction. When the user selects a payment card in
    the payment sheet, the payment sheet calls the `paymentAuthorizationViewController:didSelectPaymentMethod:completion:`
    method of its delegate.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '`PKPaymentMethod` 类提供了访问在苹果支付交易中使用的支付卡信息的权限。当用户在支付单中选择支付卡时，支付单会调用其代理的 `paymentAuthorizationViewController:didSelectPaymentMethod:completion:`
    方法。'
- en: Card tame
  id: totrans-132
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 卡名称
- en: This property identifies the payment card for the `payment` method.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 这个属性标识了 `payment` 方法的支付卡。
- en: displayName (NSString*)
  id: totrans-134
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: displayName（NSString*）
- en: This identifies the payment card to the user.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 这标识了支付卡给用户。
- en: Card type
  id: totrans-136
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 卡类型
- en: This property identifies the type of the payment card.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 这个属性标识了支付卡的类型。
- en: type (PKPaymentMethodType)
  id: totrans-138
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 类型（PKPaymentMethodType）
- en: This identifies the type of payment card used (Amex, Visa, and so on). Old cards
    may not have this information; in this case, the value of this property is `PKPaymentMethodTypeUnknown`.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 这标识了使用的支付卡类型（Amex、Visa 等）。旧卡可能没有这项信息；在这种情况下，此属性的值为 `PKPaymentMethodTypeUnknown`。
- en: 'These constants identify the types of cards that Apple Pay supports:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 这些常量标识了苹果支付支持的卡片类型：
- en: '`PKPaymentMethodTypeUnknown`'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentMethodTypeUnknown`'
- en: '`PKPaymentMethodTypeDebit`'
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentMethodTypeDebit`'
- en: '`PKPaymentMethodTypeCredit`'
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentMethodTypeCredit`'
- en: '`PKPaymentMethodTypePrepaid`'
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentMethodTypePrepaid`'
- en: '`PKPaymentMethodTypeStore`'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentMethodTypeStore`'
- en: Payment network
  id: totrans-146
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 支付网络
- en: This property identifies the payment network.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 这个属性标识了支付网络。
- en: network (NSString*)
  id: totrans-148
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 网络（NSString*）
- en: This identifies the card's payment network (or association).
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 这标识了卡的支付网络（或协会）。
- en: 'These constants identify the payment networks that Apple Pay supports:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 这些常量标识了苹果支付支持的支付网络：
- en: '`PKPaymentNetworkAmex`'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkAmex`'
- en: '`PKPaymentNetworkDiscover`'
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkDiscover`'
- en: '`PKPaymentNetworkMasterCard`'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkMasterCard`'
- en: '`PKPaymentNetworkPrivateLabel` (this is for store cards)'
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkPrivateLabel`（这是为商店卡）'
- en: '`PKPaymentNetworkVisa`'
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkVisa`'
- en: Payment pass
  id: totrans-156
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 支付密码
- en: This property is used with a payment pass.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 这个属性与支付密码一起使用。
- en: paymentPass (PKPaymentPass*)
  id: totrans-158
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: paymentPass（PKPaymentPass*）
- en: You can use this, for example, to support custom branded payment cards. Take
    a look at Apple's documentation for more details.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以用这个，例如，来支持定制的品牌支付卡。查看苹果的文档以获取更多详细信息。
- en: The PKShippingMethod class
  id: totrans-160
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`PKShippingMethod` 类'
- en: The `PKShippingMethod` class represents a shipping method you support for the
    delivery of goods to a customer.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '`PKShippingMethod`类代表您为向客户交付商品所支持的配送方式。'
- en: User-friendly description
  id: totrans-162
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用户友好的描述
- en: This property provides the user with information about the shipping method.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 此属性向用户提供有关配送方式的信息。
- en: detail (NSString*)
  id: totrans-164
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 详细信息（NSString*）
- en: 'This describes the shipping method to the user, for example: *"Delivers in
    four days"*.'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 这向用户描述配送方式，例如：“四天内送达”。
- en: App-level identifier
  id: totrans-166
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 应用级标识符
- en: This property identifies the shipping method within the app.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 此属性标识了应用内的配送方式。
- en: identifier (NSString*)
  id: totrans-168
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 标识符（NSString*）
- en: When the user changes the shipping method, use this property to identify the
    shipping method chosen.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户更改配送方式时，使用此属性来识别所选的配送方式。
- en: The PKPaymentAuthorizationViewController class
  id: totrans-170
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`PKPaymentAuthorizationViewController`类'
- en: 'The `PKPaymentAuthorizationViewController` class has two functions:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: '`PKPaymentAuthorizationViewController`类有两个功能：'
- en: To determine whether the user can make payments with Apple Pay
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定用户是否可以使用Apple Pay进行支付
- en: To present the payment sheet to the user
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 向用户展示付款单
- en: This class communicates with its delegate (which you implement) using the methods
    of the `PKPaymentAuthorizationViewControllerDelegate` protocol.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 此类通过`PKPaymentAuthorizationViewControllerDelegate`协议的方法与其代理（您实现）进行通信。
- en: Determining Apple Pay support
  id: totrans-175
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 确定Apple Pay支持
- en: The following methods determine whether the device supports Apple Pay and whether
    the payment cards that the user has added support particular payment networks
    and payment processing capabilities.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 以下方法确定设备是否支持Apple Pay，以及用户添加的支付卡是否支持特定的支付网络和支付处理功能。
- en: +canMakePayments
  id: totrans-177
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: +canMakePayments
- en: This indicates whether the device supports Apple Pay.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 这表示设备是否支持Apple Pay。
- en: 'For example, to determine whether the device supports Apple Pay, you can use
    code similar to this:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，要确定设备是否支持Apple Pay，可以使用类似以下代码：
- en: '[PRE5]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '+canMakePaymentsUsingNetworks:'
  id: totrans-181
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '+canMakePaymentsUsingNetworks:'
- en: This indicates whether the user can use Apple Pay through the networks you support.
    If the user has not added a payment card to the device, the method returns `NO`.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 这表示用户是否可以通过您支持的网路使用Apple Pay。如果用户尚未将支付卡添加到设备，则此方法返回`NO`。
- en: You can call this method after calling `canMakePayments`.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 在调用`canMakePayments`之后，您可以调用此方法。
- en: 'For example, to accept only payment cards from Visa or Amex, use code similar
    to this:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，要仅接受Visa或Amex的支付卡，可以使用类似以下代码：
- en: '[PRE6]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'These constants identify the payment networks that Apple Pay supports:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 这些常量标识了Apple Pay支持的支付网络：
- en: '`PKPaymentNetworkAmex`'
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkAmex`'
- en: '`PKPaymentNetworkDiscover`'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkDiscover`'
- en: '`PKPaymentNetworkMasterCard`'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkMasterCard`'
- en: '`PKPaymentNetworkPrivateLabel` (this is for store cards)'
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkPrivateLabel`（这是为商店卡）'
- en: '`PKPaymentNetworkVisa`'
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentNetworkVisa`'
- en: '+canMakePaymentsUsingNetworks:capabilities:'
  id: totrans-192
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '+canMakePaymentsUsingNetworks:capabilities:'
- en: This indicates whether the user can use Apple Pay on the device through the
    payment networks and payment processing capabilities you support (such as 3D Secure
    and EMV). If the user has not added a compatible payment card to the device, the
    method returns `NO`.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 这表示用户是否可以通过您支持的支付网络和支付处理能力（如3D Secure和EMV）在设备上使用Apple Pay。如果用户尚未将兼容的支付卡添加到设备，则此方法返回`NO`。
- en: You can call this method after calling `canMakePayments`.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 在调用`canMakePayments`之后，您可以调用此方法。
- en: 'For example, to accept only payment cards from Visa or Amex that support the
    3D Secure and EMV protocols, you can use this code:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，要仅接受支持3D Secure和EMV协议的Visa或Amex支付卡，可以使用此代码：
- en: '[PRE7]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'These constants identify the payment processing capabilities that Apple Pay
    supports:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 这些常量标识了Apple Pay支持的支付处理功能：
- en: '`PKMerchantCapability3DS`'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKMerchantCapability3DS`'
- en: '`PKMerchantCapabilityEMV`'
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKMerchantCapabilityEMV`'
- en: '`PKMerchantCapabilityCredit`'
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKMerchantCapabilityCredit`'
- en: '`PKMerchantCapabilityDebit`'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKMerchantCapabilityDebit`'
- en: Initializing and presenting
  id: totrans-202
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 初始化和展示
- en: The following methods prepare and present a payment sheet.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 以下方法准备并展示付款单。
- en: '-initWithPaymentRequest:'
  id: totrans-204
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '-initWithPaymentRequest:'
- en: This initializes an allocated `PKPaymentAuthorizationViewController` object
    with a payment request.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 此方法使用支付请求初始化一个分配的`PKPaymentAuthorizationViewController`对象。
- en: '-initWithPaymentRequest:'
  id: totrans-206
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '-initWithPaymentRequest:'
- en: If the user can use Apple Pay, this method initializes a payment authorization
    view controller (payment sheet) with the provided `PKPaymentRequest` object.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 如果用户可以使用Apple Pay，则此方法使用提供的`PKPaymentRequest`对象初始化一个支付授权视图控制器（付款单）。
- en: You can call this method after you configure a payment request.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在配置好支付请求后调用这个方法。
- en: Payment sheet delegate
  id: totrans-209
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 支付表单代理
- en: 'This property identifies the object to which the payment sheet reports changes
    to the payment request:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 这个属性标识了支付表单报告支付请求更改的对象：
- en: delegate id <PKPaymentAuthorizationViewControllerDelegate>
  id: totrans-211
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 代理 id <PKPaymentAuthorizationViewControllerDelegate>
- en: This is the object that adopts the `PKPaymentAuthorizationViewControllerDelegate`
    protocol to respond to payment sheet user events.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 这是采用`PKPaymentAuthorizationViewControllerDelegate`协议以响应支付表单用户事件的对象。
- en: The PKPayment class
  id: totrans-213
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`PKPayment`类'
- en: The `PKPayment` class represents a user-authorized payment. You will get a `PKPayment`
    object when the user authorizes a payment request in the payment sheet (through
    the `paymentAuthorizationViewController:didAuthorizePayment:completion:` method
    of the `PKPaymentAuthorizationViewControllerDelegate` protocol). A `PKPayment`
    object has the payment information required by your payment gateway and the issuing
    and acquiring banks to process the payment, charge the user's card, and deposit
    the funds in your account. This is also for your order processing web app to initiate
    the service or ship the purchased goods to the customer after the issuing bank
    authorizes the transaction.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: '`PKPayment`类表示用户授权的支付。当用户在支付表单中授权支付请求时（通过`PKPaymentAuthorizationViewControllerDelegate`协议中的`paymentAuthorizationViewController:didAuthorizePayment:completion:`方法），你会得到一个`PKPayment`对象。`PKPayment`对象包含了支付网关和发行和收购银行处理支付、向用户收费并将资金存入你账户所需的支付信息。这同样是为了你的订单处理Web应用程序在发行银行授权交易后启动服务或向客户发货。'
- en: Payment information
  id: totrans-215
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 支付信息
- en: 'This property contains information about the payment, which identifies the
    payment card used, the banks involved in the transaction, and other details:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 这个属性包含了关于支付的信息，它标识了使用的支付卡、参与交易的银行以及其他细节：
- en: token (PKPaymentToken*)
  id: totrans-217
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: token (PKPaymentToken*)
- en: This is the encrypted payment information used by the payment gateway, the issuing
    bank, and the acquiring bank.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 这是支付网关、发行银行和收购银行使用的加密支付信息。
- en: Billing and shipping contacts
  id: totrans-219
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 账单和发货联系人
- en: 'This property contains the billing and shipping information marked as “required”
    in the payment request used to initialize the payment sheet:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 这个属性包含了在初始化支付表单时标记为“必需”的账单和发货信息：
- en: billingContact (PKContact*)
  id: totrans-221
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: billingContact (PKContact*)
- en: This contains the billing contact information for the transaction. Only the
    fields identified in the `requiredBillingAddressFields` property of the payment
    request are populated. If no fields are requested, this property will be `nil`.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 这包含了交易中的账单联系信息。只有支付请求中`requiredBillingAddressFields`属性中标识的字段会被填充。如果没有请求任何字段，这个属性将是`nil`。
- en: shippingContact (PKContact*)
  id: totrans-223
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: shippingContact (PKContact*)
- en: This is the shipping contact information for the transaction. Only the fields
    identified in the `requiredShippingAddressFields` property of the payment request
    are populated. If no fields are requested, this property will be `nil`.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 这是交易中的发货联系人信息。只有支付请求中`requiredShippingAddressFields`属性中标识的字段会被填充。如果没有请求任何字段，这个属性将是`nil`。
- en: shippingMethod
  id: totrans-225
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: shippingMethod
- en: This identifies the shipping method chosen by the user from the list of shipping
    methods in the `shippingMethods` property of the payment request.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 这标识了用户从支付请求中`shippingMethods`属性列出的发货方式中选择的方法。
- en: The PKPaymentToken class
  id: totrans-227
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`PKPayment`类'
- en: A `PKPaymentToken` object contains the encrypted payment information used by
    the payment gateway and banks, the type of payment card used to fund the payment
    (debit, credit, or private label), and an identifier for the transaction.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 一个`PKPaymentToken`对象包含了支付网关和银行使用的加密支付信息，用于资助支付所使用的支付卡类型（借记卡、信用卡或私人标签），以及交易的标识符。
- en: Note that some payment gateway APIs do not use this class in their workflow.
    Instead, they provide their own payment token class. The example project, which
    uses Stripe, uses the `STPToken` class. Take a look at the `process_ApplePay_payment_with_Stripe:completion:`
    method of the `ProductCard` class (`ProductCard.m`) for details.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，一些支付网关API在其工作流程中不使用这个类。相反，它们提供自己的支付令牌类。使用Stripe的示例项目使用`STPToken`类。查看`ProductCard`类中的`process_ApplePay_payment_with_Stripe:completion:`方法（`ProductCard.m`）以获取详细信息。
- en: Encrypted payment information
  id: totrans-230
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 加密支付信息
- en: This property is decrypted only by the entities authorized to do so, such as
    your payment gateway.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 这个属性仅由授权的实体解密，例如你的支付网关。
- en: paymentData (NSData*)
  id: totrans-232
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: paymentData (NSData*)
- en: This is the encrypted payment information for the transaction.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 这是交易的加密支付信息。
- en: Payment method and transaction identifier
  id: totrans-234
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 支付方法和交易标识符
- en: These properties provide information about the payment token.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 这些属性提供了有关支付令牌的信息。
- en: paymentMethod (PKPaymentMethod*)
  id: totrans-236
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: paymentMethod (PKPaymentMethod*)
- en: This is the payment method to use for the transaction.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 这是用于交易的支付方法。
- en: transactionIdentifier (NSString*)
  id: totrans-238
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: transactionIdentifier (NSString*)
- en: This is the identifier for the transaction that is assigned by your payment
    gateway.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 这是您的支付网关分配的交易标识符。
- en: Payment sheet user event protocol
  id: totrans-240
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 支付表单用户事件协议
- en: This section describes the protocol used by the payment sheet to communicate
    with its delegate.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 本节描述了支付表单用于与其代理通信的协议。
- en: The PKPaymentAuthorizationViewControllerDelegate protocol
  id: totrans-242
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`PKPaymentAuthorizationViewControllerDelegate` 协议'
- en: The `PKPaymentAuthorizationViewControllerDelegate` protocol specifies the set
    of methods that the payment sheet uses to communicate events to its delegate (which
    you can implement to respond to calls to these methods). The following sections
    identify the actions that the user can perform in the payment sheet and the delegate
    methods called when the user performs them.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: '`PKPaymentAuthorizationViewControllerDelegate` 协议指定了支付表单用于将其事件传达给其代理（您可以实现以响应这些方法的调用）的方法集。以下各节确定了用户可以在支付表单中执行的操作，以及当用户执行这些操作时调用的代理方法。'
- en: The user chooses a payment card
  id: totrans-244
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用户选择支付卡
- en: The user can switch payment cards in the payment sheet (that is, if the user
    added more than one payment card to Apple Pay on the device).
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 用户可以在支付表中切换支付卡（即，如果用户在设备上的Apple Pay中添加了多个支付卡）。
- en: '-paymentAuthorizationViewController:didSelectPaymentMethod: completion:'
  id: totrans-246
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '-paymentAuthorizationViewController:didSelectPaymentMethod: completion:'
- en: This is called when the user chooses a payment card. If the payment card affects
    the payment request's summary items (for example, if you provide a discount to
    use a store card), you must compute the summary items (which are an array of `PKPaymentSummaryItem`
    objects) for the payment request. In any event, you must provide the summary items
    array as the argument to this method's completion handler.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户选择支付卡时，会调用此方法。如果支付卡会影响支付请求的摘要项（例如，如果您提供使用商店卡的折扣），则必须计算支付请求的摘要项（这些是`PKPaymentSummaryItem`对象数组）。在任何情况下，您都必须将摘要项数组作为此方法完成处理程序的参数提供。
- en: The user selects a shipping address
  id: totrans-248
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用户选择收货地址
- en: The user can select a shipping address from a list of previously entered addresses
    or enter a new one in the payment sheet.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 用户可以从之前输入的地址列表中选择一个收货地址，或者在支付表单中输入一个新的地址。
- en: '-paymentAuthorizationViewController:didSelectShippingContact: completion:'
  id: totrans-250
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '-paymentAuthorizationViewController:didSelectShippingContact: completion:'
- en: This is called after the user specifies a shipping address. The payment sheet
    provides the shipping address in the `PKContact* contact` parameter. This shipping
    address is anonymized (that is, it excludes personal information). In the U.S.,
    this information includes only city, state, and zip code.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 用户指定收货地址后，会调用此方法。支付表单在`PKContact* contact`参数中提供收货地址。此收货地址已匿名化（即，不包括个人信息）。在美国，这些信息仅包括城市、州和邮政编码。
- en: If your shipping methods vary depending on the shipping address, in this method,
    you should create an array of the shipping methods that are available for the
    new shipping address. You should also recompute the summary item array for the
    payment request using the first shipping method in the recomputed shipping method
    array to compute shipping costs (the payment sheet selects the first shipping
    method in the shipping method array).
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您的运输方法根据运输地址而变化，在此方法中，您应创建一个包含适用于新运输地址的运输方法的数组。您还应该使用重新计算的运输方法数组中的第一个运输方法重新计算支付请求的摘要项数组以计算运输费用（支付表单选择运输方法数组中的第一个运输方法）。
- en: 'The completion block for this method takes three arguments: `status`, `shippingMethods`,
    and `summaryItems`:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 此方法的完成块接受三个参数：`status`、`shippingMethods`和`summaryItems`：
- en: '`status`: This indicates whether the shipping address is valid. If the shipping
    address the user specified is correct, set this argument to `PKPaymentAuthorizationStatusSuccess`.
    Otherwise, set its value to `PKPaymentAuthorizationStatusInvalidShippingPostalAddress`.'
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`status`：这表示收货地址是否有效。如果用户指定的收货地址正确，则将此参数设置为`PKPaymentAuthorizationStatusSuccess`。否则，将其值设置为`PKPaymentAuthorizationStatusInvalidShippingPostalAddress`。'
- en: '`shippingMethods`: This is the recomputed shipping method array.'
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`shippingMethods`：这是重新计算的运输方法数组。'
- en: '`summaryItems`: This is the recomputed summary item array.'
  id: totrans-256
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`summaryItems`：这是重新计算的摘要项数组。'
- en: The user selects a shipping method
  id: totrans-257
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用户选择一个配送方式
- en: The user can select a shipping method from the list of shipping methods you
    support (this is stored in the `shippingMethods` property of the payment request).
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 用户可以从您支持的配送方式列表中选择配送方式（这存储在支付请求的`shippingMethods`属性中）。
- en: '-paymentAuthorizationViewController:didSelectShippingMethod: completion:'
  id: totrans-259
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '-paymentAuthorizationViewController:didSelectShippingMethod: completion:'
- en: This is called when the user selects a shipment method. If the shipment method
    that the user chooses affects the payment request's summary items (for example,
    if the shipment methods have different prices), you must recompute the summary
    items (an array of `PKPaymentSummaryItem` objects) for the payment request.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户选择配送方式时，会调用此方法。如果用户选择的配送方式会影响支付请求的摘要项（例如，如果配送方式有不同的价格），则必须重新计算支付请求的摘要项（`PKPaymentSummaryItem`对象数组）。
- en: 'The completion block for this method takes two arguments: `status`, and `summaryItems`.'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 此方法的完成块接受两个参数：`status`和`summaryItems`。
- en: '`status`: This indicates whether the shipping method and shipping address (specified
    in the call to the `paymentAuthorizationViewController:didSelectShippingContact:completion:`
    delegate method) are valid. If the shipping address the user specified is correct,
    set this argument to `PKPaymentAuthorizationStatusSuccess`. Otherwise, set its
    value to `PKPaymentAuthorizationStatusInvalidShippingPostalAddress`.'
  id: totrans-262
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`status`：这表示配送方式和配送地址（在调用`paymentAuthorizationViewController:didSelectShippingContact:completion:`代理方法时指定）是否有效。如果用户指定的配送地址正确，则将此参数设置为`PKPaymentAuthorizationStatusSuccess`。否则，将其值设置为`PKPaymentAuthorizationStatusInvalidShippingPostalAddress`。'
- en: '`summaryItems`: This is the recomputed summary item array.'
  id: totrans-263
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`summaryItems`：这是重新计算的摘要项数组。'
- en: The user authorizes the payment request
  id: totrans-264
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用户授权支付请求
- en: After the user confirms or changes the information in the payment sheet, the
    user can authorize the payment request to proceed with the Apple Pay transaction.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 用户在支付单中确认或更改信息后，用户可以授权支付请求以进行Apple Pay交易。
- en: '-paymentAuthorizationViewControllerWillAuthorizePayment:'
  id: totrans-266
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '-paymentAuthorizationViewControllerWillAuthorizePayment:'
- en: This is called after the user authenticates the payment sheet but before `paymentAuthorizationViewController:didAuthorizePayment:completion:`
    is called. Use this method to prepare for authorization.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 在用户验证支付单之后但在调用`paymentAuthorizationViewController:didAuthorizePayment:completion:`之前调用此方法。使用此方法进行授权准备。
- en: '-paymentAuthorizationViewController:didAuthorizePayment: completion:'
  id: totrans-268
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '-paymentAuthorizationViewController:didAuthorizePayment: completion:'
- en: This is called after the user authorizes the payment request. This is where
    you process the payment with your payment gateway. When done, you must call the
    completion handler block (`(void (^)(PKPaymentAuthorizationStatus status)) completion`)
    with the appropriate value for the status argument.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 在用户授权支付请求之后调用此方法。这是您使用支付网关处理支付的地方。完成后，您必须使用状态参数的适当值调用完成处理程序块（`(void (^)(PKPaymentAuthorizationStatus
    status)) completion`）。
- en: 'These are the possible values for the `status` argument of the completion handler:'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 这是完成处理程序`status`参数的可能值：
- en: '`PKPaymentAuthorizationStatusSuccess`: This indicates successful payment authorization
    by the payment card''s issuing bank'
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentAuthorizationStatusSuccess`：这表示支付卡的发行银行成功授权支付'
- en: '`PKPaymentAuthorizationStatusFailure`: This indicates failure due to a failed
    authorization by the payment card''s issuing bank'
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentAuthorizationStatusFailure`：这表示由于支付卡的发行银行授权失败而失败'
- en: '`PKPaymentAuthorizationStatusInvalidBillingPostalAddress`: This indicates failure
    due to an invalid billing address'
  id: totrans-273
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentAuthorizationStatusInvalidBillingPostalAddress`：这表示由于无效的账单地址而失败'
- en: '`PKPaymentAuthorizationStatusInvalidShippingPostalAddress`: This indicates
    failure due to an invalid shipping address'
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentAuthorizationStatusInvalidShippingPostalAddress`：这表示由于无效的配送地址而失败'
- en: '`PKPaymentAuthorizationStatusInvalidShippingContact`: This indicates failure
    due to an invalid shipping contact'
  id: totrans-275
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKPaymentAuthorizationStatusInvalidShippingContact`：这表示由于无效的配送联系人而失败'
- en: The payment sheet is done
  id: totrans-276
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 支付单完成
- en: The payment sheet is done after the user authorizes the payment request and
    the app processes the Apple Pay transaction, or the user cancels the payment sheet.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 用户授权支付请求并在应用处理Apple Pay交易后，或者用户取消支付单时，支付单完成。
- en: '-paymentAuthorizationViewControllerDidFinish:'
  id: totrans-278
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '-paymentAuthorizationViewControllerDidFinish:'
- en: This is called when the transaction is done or the user cancels the payment
    sheet. You must dismiss the payment sheet and perform any other necessary updates.
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 当交易完成或用户取消支付表单时调用。您必须关闭支付表单并执行任何其他必要的更新。
- en: Auxiliary classes
  id: totrans-280
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 辅助类
- en: 'This section describes some additional classes you must use to work with the
    Apple Pay API. The classes are:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 本节描述了您必须使用的一些附加类，以使用Apple Pay API。这些类包括：
- en: '`PKContact`: This is used to represent contact information (name, phone number,
    and e-mail) and addresses'
  id: totrans-282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PKContact`: 这用于表示联系信息（姓名、电话号码和电子邮件）和地址'
- en: '`CNPhoneNumber`: This is used to represent a phone number'
  id: totrans-283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`CNPhoneNumber`: 这用于表示电话号码'
- en: '`CNPostalAddress`: This is used to represent addresses'
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`CNPostalAddress`: 这用于表示地址'
- en: The PKContact class
  id: totrans-285
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PKContact类
- en: 'The `PKContact` class contains properties that represent the components of
    a billing or shipping address. The payment sheet provides instances of this class
    to its delegate when the user selects a shipping address (`paymentAuthorizationViewController:
    didSelectShippingContact:completion:`), and in the `PKPayment` object it provides
    when the user authorizes the payment request (`paymentAuthorizationViewController:didAuthorizePayment:completion:`).'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: '`PKContact`类包含表示账单或配送地址组成部分的属性。支付表单在用户选择配送地址时（`paymentAuthorizationViewController:
    didSelectShippingContact:completion:`）向其代理提供此类的实例，并在用户授权支付请求时（`paymentAuthorizationViewController:didAuthorizePayment:completion:`）在`PKPayment`对象中提供。'
- en: Contact address components
  id: totrans-287
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 联系地址组成部分
- en: These properties contain the information requested in the `requiredBillingAddressFields`
    or `requiredShippingAddressFields` properties of the `PKPaymentRequest` object.
    The value of properties corresponding to the unrequested address fields is `nil`.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 这些属性包含了`PKPaymentRequest`对象中`requiredBillingAddressFields`或`requiredShippingAddressFields`属性请求的信息。对应未请求地址字段的属性值为`nil`。
- en: emailAddress (NSString*)
  id: totrans-289
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: emailAddress (NSString*)
- en: This is the contact's e-mail address.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 这是联系人的电子邮件地址。
- en: name (NSPersonNameComponents*)
  id: totrans-291
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: name (NSPersonNameComponents*)
- en: This is the contact's name.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 这是联系人的名字。
- en: phoneNumber (CNPhoneNumber*)
  id: totrans-293
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: phoneNumber (CNPhoneNumber*)
- en: This is the contact's phone number.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 这是联系人的电话号码。
- en: postalAddress (CNPostalAddress*)
  id: totrans-295
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: postalAddress (CNPostalAddress*)
- en: This is the contact's postal address.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 这是联系人的邮政地址。
- en: The NSPersonNameComponents class
  id: totrans-297
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: NSPersonNameComponents类
- en: The `NSPersonNameComponents` class contains properties that represent the components
    of a person's name.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: '`NSPersonNameComponents`类包含表示个人姓名组成部分的属性。'
- en: Person name components
  id: totrans-299
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 个人姓名组成部分
- en: These properties represent the components of a person's name.
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 这些属性表示个人姓名的组成部分。
- en: namePrefix (NSString*)
  id: totrans-301
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: namePrefix (NSString*)
- en: This is a prefix (or title) used in front of a person's name, for example `"Dr."`,
    `"Ms."`, or `"Mr."`.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 这是在人的名字前使用的称呼（或头衔），例如 `"Dr."`，`"Ms."` 或 `"Mr."`。
- en: givenName (NSString*)
  id: totrans-303
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: givenName (NSString*)
- en: This is the given name (or first name) of the person.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 这是人的给定名（或名）。
- en: middleName (NSString*)
  id: totrans-305
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: middleName (NSString*)
- en: This is the second name of the person.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 这是人的第二个名字。
- en: familyName (NSString*)
  id: totrans-307
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: familyName (NSString*)
- en: This is the family name of the person (generally shared with siblings).
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 这是人的姓氏（通常与兄弟姐妹共享）。
- en: nameSuffix (NSString*)
  id: totrans-309
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: nameSuffix (NSString*)
- en: These are the letters added to a person's full name that provide additional
    information about the person, for example `"Jr."` or `"Ph.D."`.
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是添加到个人全名中的字母，用于提供有关个人的额外信息，例如 `"Jr."` 或 `"Ph.D."`。
- en: nickname (NSString)
  id: totrans-311
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: nickname (NSString)
- en: This is the familiar or humorous name used for the person.
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 这是用于人的熟悉或幽默的名字。
- en: phoneticRepresentation (NSPersonNameComponents*)
  id: totrans-313
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: phoneticRepresentation (NSPersonNameComponents*)
- en: If specified, this is the phonetic representation of each of the other properties
    in this class, except `phoneticRepresentation`.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 如果指定了，这是本类中除`phoneticRepresentation`之外其他每个属性的音标表示。
- en: The CNPhoneNumber class
  id: totrans-315
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CNPhoneNumber类
- en: The `CNPhoneNumber` class represents the phone number component of a `PKContact`
    object.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: '`CNPhoneNumber`类代表`PKContact`对象的电话号码组件。'
- en: Creating a phone number
  id: totrans-317
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建电话号码
- en: When creating a `PKContact` object, to set its `phoneNumber` property, use this
    method to create the `CNPhoneNumber` value to store in the property.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 当创建`PKContact`对象时，要设置其`phoneNumber`属性，请使用此方法创建存储在属性中的`CNPhoneNumber`值。
- en: 'For example, this code sets the phone number of a contact:'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，此代码设置联系人的电话号码：
- en: '[PRE8]'
  id: totrans-320
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '+phoneNumberWithStringValue:'
  id: totrans-321
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '+phoneNumberWithStringValue:'
- en: This creates a phone number component with the text provided.
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 这会创建一个带有提供文本的电话号码组件。
- en: Phone number string
  id: totrans-323
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 电话号码字符串
- en: This property contains a string representing the contact's phone number.
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 此属性包含表示联系人电话号码的字符串。
- en: stringValue (NSString*)
  id: totrans-325
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: stringValue (NSString*)
- en: This is the text representing the phone number.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 这是表示电话号码的文本。
- en: The CNPostalAddress class
  id: totrans-327
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CNPostalAddress 类
- en: The `CNPostalAddress` class represents the postal address component of a `PKContact`
    object.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: '`CNPostalAddress` 类表示 `PKContact` 对象的邮政地址组件。'
- en: Postal address components
  id: totrans-329
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 邮政地址组件
- en: These properties represent the components of an address.
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 这些属性表示地址的组成部分。
- en: street (NSString*)
  id: totrans-331
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: street (NSString*)
- en: This is the street address for the contact.
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 这是联系人的街道地址。
- en: city (NSString*)
  id: totrans-333
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: city (NSString*)
- en: This is the city where the contact is located.
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 这是联系人所在的城市。
- en: state (NSString*)
  id: totrans-335
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: state (NSString*)
- en: This is the state where the contact is located.
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 这是联系人所在的状态。
- en: postalCode (NSString*)
  id: totrans-337
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: postalCode (NSString*)
- en: This is the postal (or zip) code on which the contact is located.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 这是联系人所在地的邮政（或邮政编码）代码。
- en: country (NSString*)
  id: totrans-339
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: country (NSString*)
- en: This is the country where the contact is located.
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 这是联系人所在的国家。
- en: ISOCountryCode (NSString*)
  id: totrans-341
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: ISOCountryCode (NSString*)
- en: This is the ISO 3166 country code for the country property.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 这是国家属性的 ISO 3166 国家代码。
- en: Summary
  id: totrans-343
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: This chapter described most of the classes you have to work with to process
    Apple Pay payments. It also described the protocol used by the payment sheet to
    communicate user actions to its delegate so that you can respond appropriately.
    Finally, the chapter listed a few additional classes that you must work with to
    access address components, such as a person's name, phone number, and postal address.
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 本章描述了您必须使用以处理 Apple Pay 支付的大多数类。它还描述了支付表单用于将用户操作传达给其代理的协议，以便您可以适当地做出响应。最后，本章列出了几个您必须与之合作的附加类，例如访问地址组件，如人的姓名、电话号码和邮政地址。
- en: This is the end of *Apple Pay Essentials*, conceived to help you add Apple Pay
    support to your apps. This book introduced the world of online payments, describing
    how payment associations, payment gateways, and banks work together to transfer
    funds from a customer's payment card to a merchant's account. Apple Pay improves
    on this model by adding convenience, privacy, and security to the process.
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 这标志着 *Apple Pay Essentials* 的结束，旨在帮助你向应用程序添加 Apple Pay 支持。本书介绍了在线支付的世界，描述了支付协会、支付网关和银行如何共同工作，将客户的支付卡资金转移到商家的账户。Apple
    Pay 通过增加便利性、隐私性和安全性来改进这一模型。
- en: You learned about using the REST API in your client app to communicate with
    server web apps that provide the information that the app needs (such as details
    about the products you have for sale and the shipping methods you support), and
    to process payments and orders from the app.
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: 你学习了如何在客户端应用程序中使用 REST API 与提供所需信息的服务器网络应用程序（例如销售产品的详细信息和支持的运输方式）进行通信，以及处理来自应用程序的支付和订单。
- en: The book provided an example workflow for displaying product information to
    your customers and displaying an **Apple** **Pay** button when appropriate. You
    learned how to create a payment request and add payment and order information
    to it, and to present the main Apple Pay user interface and the payment sheet.
    The book showed how to respond to the changes that the user makes in the payment
    sheet, such as selecting a different payment card, shipping address, or shipping
    method.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 本书提供了一个示例工作流程，用于向客户显示产品信息，并在适当的时候显示 **Apple** **Pay** 按钮。你学习了如何创建支付请求并将其添加到支付和订单信息中，以及展示主要的
    Apple Pay 用户界面和支付表单。本书展示了如何响应用户在支付表单中做出的更改，例如选择不同的支付卡、运输地址或运输方式。
- en: You learned how to process payment and order information in your app and backend
    servers after the user authorizes the payment request. The book also showed how
    to dispose of the payment sheet when the transaction is complete.
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 你学习了如何在用户授权支付请求后处理应用程序和后端服务器中的支付和订单信息。本书还展示了如何在交易完成后处理支付表单。
- en: Finally, the book described the major elements and processes of an order management
    system, using `Node.js` to process orders and payments and the Mongoose module
    to interact with a document-based database.
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，本书描述了订单管理系统的关键元素和流程，使用 `Node.js` 处理订单和支付，以及 Mongoose 模块与基于文档的数据库进行交互。
- en: With this knowledge, you are now able to provide the users of your apps with
    the convenience and security of Apple Pay-based payments.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这些知识，你现在能够为你的应用程序用户提供基于 Apple Pay 的支付便利性和安全性。
