- en: '21'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '21'
- en: Getting Started with Search
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 开始使用搜索
- en: In the previous chapter, you added a way for the user to get a photo from the
    camera or photo library, which can be added to a new journal entry.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，你为用户添加了一种从相机或照片库获取照片的方法，可以将照片添加到新的期刊条目中。
- en: In this chapter, you will implement a **search bar** for the Journal List screen.
    You’ll start by modifying the `JournalListViewController` class to conform to
    the `UISearchResultsUpdating` protocol and display a search bar on the Journal
    List screen. Next, you’ll modify the data source methods to display the correct
    journal entries when the user types in a search term. After that, you’ll modify
    the `prepare(for:sender:)` method to ensure that the correct journal entry details
    are displayed on the Journal Entry Detail screen. Finally, you’ll modify the method
    used to delete a journal entry.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你将为期刊列表屏幕实现一个 **搜索栏**。你将从修改 `JournalListViewController` 类，使其符合 `UISearchResultsUpdating`
    协议并在期刊列表屏幕上显示搜索栏开始。接下来，你将修改数据源方法，以便在用户输入搜索词时显示正确的期刊条目。然后，你将修改 `prepare(for:sender:)`
    方法，以确保在期刊条目详情屏幕上显示正确的期刊条目详情。最后，你将修改用于删除期刊条目的方法。
- en: By the end of this chapter, you’ll have learned how to implement a search bar
    for your own apps. To name one example, if you were creating a contacts app, you
    could use a search bar to search for a particular contact.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，你将学会如何为你的应用实现搜索栏。以一个例子来说，如果你正在创建一个联系人应用，你可以使用搜索栏来搜索特定的联系人。
- en: 'The following topics will be covered in this chapter:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Implementing a search bar on the Journal List screen
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在期刊列表屏幕上实现搜索栏
- en: Modifying table view data source methods
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 修改表格视图数据源方法
- en: Modifying the `prepare(for:sender:)` method
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 修改 `prepare(for:sender:)` 方法
- en: Modifying the method to remove journal entries
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 修改删除期刊条目的方法
- en: Technical requirements
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: You will continue working on the `JRNL` project that you modified in the previous
    chapter.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 你将继续在上一章中修改的 `JRNL` 项目上工作。
- en: 'The resource files and completed Xcode project for this chapter are in the
    `Chapter21` folder of the code bundle for this book, which can be downloaded here:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的资源文件和完成的 Xcode 项目位于本书代码包的 `Chapter21` 文件夹中，可以通过以下链接下载：
- en: '[https://github.com/PacktPublishing/iOS-18-Programming-for-Beginners-Ninth-Edition](https://github.com/PacktPublishing/iOS-18-Programming-for-Beginners-Ninth-Edition%0D)'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://github.com/PacktPublishing/iOS-18-Programming-for-Beginners-Ninth-Edition](https://github.com/PacktPublishing/iOS-18-Programming-for-Beginners-Ninth-Edition%0D)'
- en: 'Check out the following video to see the code in action:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 观看以下视频，查看代码的实际效果：
- en: '[https://youtu.be/hPwG2gfv448](https://youtu.be/hPwG2gfv448%0D)'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://youtu.be/hPwG2gfv448](https://youtu.be/hPwG2gfv448%0D)'
- en: Let’s start by modifying the `JournalListViewController` class to conform to
    the `UISearchResultsUpdating` protocol and to display a search bar on the Journal
    List screen.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从修改 `JournalListViewController` 类开始，使其符合 `UISearchResultsUpdating` 协议，并在期刊列表屏幕上显示搜索栏。
- en: Implementing a search bar for the Journal List screen
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实现期刊列表屏幕的搜索栏
- en: At present, you only have a few entries on the Journal List screen. But the
    longer you use the app, the more entries you’ll have, and it’s going to be hard
    to find a specific entry. To make it easier to look for a journal entry, you’ll
    implement a search bar in the navigation bar of the Journal List screen. You will
    use Apple’s `UISearchController` class to do this. This class incorporates a `UISearchBar`
    class that you can install in your user interface. To perform the search, you
    will adopt the `UISearchResultsUpdating` protocol and implement the `updateSearchResults(for:)`
    method required for this protocol.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，你在期刊列表屏幕上只有几个条目。但随着你使用该应用的时长增加，条目会越来越多，找到特定的条目将会变得困难。为了使查找期刊条目更加方便，你将在期刊列表屏幕的导航栏中实现一个搜索栏。你将使用
    Apple 的 `UISearchController` 类来完成这项工作。这个类包含一个 `UISearchBar` 类，你可以将其安装到你的用户界面中。为了执行搜索，你需要采用
    `UISearchResultsUpdating` 协议并实现该协议所需的 `updateSearchResults(for:)` 方法。
- en: To learn more about the `UISearchController` class, see [https://developer.apple.com/documentation/uikit/uisearchcontroller](https://developer.apple.com/documentation/uikit/uisearchcontroller).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于 `UISearchController` 类的信息，请参阅 [https://developer.apple.com/documentation/uikit/uisearchcontroller](https://developer.apple.com/documentation/uikit/uisearchcontroller)。
- en: 'You will now add an instance of the `UISearchController` class to the `JournalListViewController`
    class, adopt the `UISearchResultsUpdating` protocol, and implement the `updateSearchResults(for:)`
    method. Follow these steps:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你将在`JournalListViewController`类中添加`UISearchController`类的实例，采用`UISearchResultsUpdating`协议，并实现`updateSearchResults(for:)`方法。按照以下步骤操作：
- en: 'In the Project navigator, click the **JournalListViewController** file. Add
    a new extension after all other code in this file to make the `JournalListViewController`
    class conform to the `UISearchResultsUpdating` protocol:'
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在项目导航器中，单击**JournalListViewController**文件。在此文件的所有其他代码之后添加一个新扩展，使`JournalListViewController`类符合`UISearchResultsUpdating`协议：
- en: '[PRE0]'
  id: totrans-22
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'You’ll see an error because the method required to conform to the `UISearchResultsUpdating`
    protocol has not been implemented. Add the following code to the newly added extension
    to implement it:'
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你会看到一个错误，因为尚未实现符合`UISearchResultsUpdating`协议所需的方法。将以下代码添加到新添加的扩展中来实现它：
- en: '[PRE1]'
  id: totrans-24
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Any text you type into the search bar will be printed to the Debug area.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 你输入到搜索栏中的任何文本都将打印到调试区域。
- en: 'Declare the following properties in the `JournalListViewController` class after
    the `tableView` property:'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`JournalListViewController`类中`tableView`属性之后声明以下属性：
- en: '[PRE2]'
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The `search` property will store an instance of the `UISearchController` class.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '`search`属性将存储`UISearchController`类的实例。'
- en: The `filteredTableData` property will store an array of `JournalEntry` instances
    that match the search text entered by the user.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '`filteredTableData`属性将存储一个与用户输入的搜索文本匹配的`JournalEntry`实例数组。'
- en: 'Modify the `viewDidLoad()` method in the `JournalListViewController` class
    as shown:'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改`JournalListViewController`类中的`viewDidLoad()`方法，如下所示：
- en: '[PRE3]'
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Let’s break this down:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们分解一下：
- en: '[PRE4]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: This statement sets the `JournalListViewController` instance as the object responsible
    for updating the search results.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 此语句将`JournalListViewController`实例设置为负责更新搜索结果的对象。
- en: '[PRE5]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: This statement obscures the view controller containing the search content when
    the user interacts with the search bar. Since you’re using the table view on the
    Journal List screen to display the search results, this value is set to `false`,
    otherwise, you will obscure the search results.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户与搜索栏交互时，此语句会遮挡包含搜索内容的视图控制器。由于你在期刊列表屏幕上使用表格视图来显示搜索结果，因此此值设置为`false`，否则你将遮挡搜索结果。
- en: '[PRE6]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: This statement sets the placeholder text for the search bar.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 此语句设置了搜索栏的占位文本。
- en: '[PRE7]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: This statement adds the search bar to the navigation bar on the screen.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 此语句将搜索栏添加到屏幕上的导航栏。
- en: 'Build and run your app, and you’ll see a search bar on the Journal List screen.
    Type some text into the search bar:'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建并运行你的应用，你将在期刊列表屏幕上看到一个搜索栏。在搜索栏中输入一些文本：
- en: '![](img/B31371_21_01.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B31371_21_01.png)'
- en: 'Figure 21.1: Simulator showing a search bar on the Journal List screen'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 图21.1：模拟器显示期刊列表屏幕上的搜索栏
- en: 'Note that the text you type into the search bar appears in the Debug area:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 注意，你输入到搜索栏中的文本将显示在调试区域：
- en: '![](img/B31371_21_02.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B31371_21_02.png)'
- en: 'Figure 21.2: Debug area showing the search text'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 图21.2：调试区域显示搜索文本
- en: You’ve added a search bar to the Journal List screen. Great! In the next section,
    you’ll modify the `JournalListViewController` file to display journal entries
    whose titles match the search text typed into the search bar.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经在期刊列表屏幕上添加了一个搜索栏。太好了！在下一节中，你将修改`JournalListViewController`文件，以显示与搜索栏中输入的搜索文本匹配的期刊条目。
- en: Modifying table view data source methods
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 修改表格视图数据源方法
- en: As you learned in *Chapter 14*, *Getting Started with MVC and Table Views*,
    you can use `UITableViewDataSource` methods to determine how many table view rows
    to display, and what to put in each row.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 如你在*第14章*中学习的，*MVC和表格视图入门*，你可以使用`UITableViewDataSource`方法来确定要显示多少表格视图行，以及每行要放置什么内容。
- en: 'In the previous section, you added a new property, `filteredTableData`, to
    hold an array of `JournalEntry` instances that match the search text. You’ll modify
    the `updateSearchResults(for:)` method to populate `filteredTableData` with `JournalEntry`
    instances that match the search text, and you’ll modify the `UITableViewDataSource`
    methods to display the contents of `filteredTableData` on the Journal List screen
    while the search bar is active. Follow these steps:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一节中，你添加了一个新的属性`filteredTableData`，用于存储与搜索文本匹配的`JournalEntry`实例数组。你将修改`updateSearchResults(for:)`方法，用与搜索文本匹配的`JournalEntry`实例填充`filteredTableData`，并修改`UITableViewDataSource`方法，在搜索栏活动时在期刊列表屏幕上显示`filteredTableData`的内容。按照以下步骤操作：
- en: 'In the Project navigator, click the **JournalListViewController** file. Modify
    the `updateSearchResults(for:)` method in the `UISearchResultsUpdating` extension
    as shown:'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在项目导航器中，点击**JournalListViewController**文件。修改`UISearchResultsUpdating`扩展中的`updateSearchResults(for:)`方法，如图所示：
- en: '[PRE8]'
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: This method gets a copy of the `journalEntries` array and then adds only those
    `JournalEntry` instances matching the search text to the `filteredTableData` array.
    When done, the table view is reloaded.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 此方法获取`journalEntries`数组的副本，然后将匹配搜索文本的`JournalEntry`实例添加到`filteredTableData`数组中。完成后，表格视图将被重新加载。
- en: 'Modify the `tableView(_:numberOfRowsInSection:)` method to get the number of
    `JournalEntry` instances from the `filteredTableData` array when the search bar
    is in use:'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改`tableView(_:numberOfRowsInSection:)`方法，当搜索栏处于使用状态时，从`filteredTableData`数组中获取`JournalEntry`实例的数量：
- en: '[PRE9]'
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Modify the `tableView(_:cellForRowAt:)` method to get the `JournalEntry` instance
    for the specified row from the `filteredTableData` array when the search bar is
    in use:'
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改`tableView(_:cellForRowAt:)`方法，当搜索栏处于使用状态时，从`filteredTableData`数组中获取指定行的`JournalEntry`实例：
- en: '[PRE10]'
  id: totrans-57
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Build and run your app, and type some text that matches the title of one of
    your journal entries into the search bar. The journal entries with titles that
    match the search text will be displayed:'
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建并运行你的应用，并在搜索栏中输入与你的日志条目标题匹配的文本。将显示与搜索文本匹配的日志条目：
- en: '![](img/B31371_21_03.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B31371_21_03.png)'
- en: 'Figure 21.3: Simulator showing journal entries with titles that match the search
    text'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 图21.3：模拟器显示与搜索文本匹配的日志条目
- en: You can now display journal entries with titles that match the search text,
    but when you tap on them, the Journal Entry Detail screen may or may not display
    the details for the tapped journal entry. You will fix this issue in the next
    section.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 你现在可以显示与搜索文本匹配的日志条目，但当你点击它们时，日志条目详情屏幕可能或可能不会显示被点击日志条目的详细信息。你将在下一节中修复此问题。
- en: Modifying the prepare(for:sender:) method
  id: totrans-62
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 修改`prepare(for:sender:)`方法
- en: 'When you enter text in the search bar, the journal entries with titles matching
    the search text will appear in the table view on the Journal List screen. But
    if you were to tap one of them, the Journal Entry Detail screen may or may not
    display the details for the tapped journal entry. This is because the `prepare(for:sender:)`
    method will reference the `journalEntries` array in the `SharedData.shared` instance
    instead of the `filteredTableData` array. To fix this, follow these steps:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 当你在搜索栏中输入文本时，与搜索文本匹配的日志条目将出现在日志列表屏幕的表格视图中。但如果你点击其中一个，日志条目详情屏幕可能或可能不会显示被点击日志条目的详细信息。这是因为`prepare(for:sender:)`方法将引用`SharedData.shared`实例中的`journalEntries`数组，而不是`filteredTableData`数组。要修复此问题，请按照以下步骤操作：
- en: 'Modify the `prepare(for:sender:)` method in the `JournalListViewController`
    class as shown to assign the appropriate `JournalEntry` instance from the `filteredTableData`
    array to the `journalEntry` property for the destination view controller when
    the search bar is active:'
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改`JournalListViewController`类中的`prepare(for:sender:)`方法，如图所示，当搜索栏处于活动状态时，将`filteredTableData`数组中适当的`JournalEntry`实例分配给目标视图控制器的`journalEntry`属性：
- en: '[PRE11]'
  id: totrans-65
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Build and run your app, and type some text that matches the title of one of
    your journal entries into the search bar. The journal entries with titles that
    match the search text will be displayed:'
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建并运行你的应用，并在搜索栏中输入与你的日志条目标题匹配的文本。将显示与搜索文本匹配的日志条目：
- en: '![](img/B31371_21_04.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B31371_21_04.png)'
- en: 'Figure 21.4: Simulator showing journal entries with titles that match the search
    text'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图21.4：模拟器显示与搜索文本匹配的日志条目
- en: 'Tap one of the journal entries and the details displayed on the Journal Entry
    Detail screen now match the journal entry that was tapped:'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击其中一个日志条目，现在在日志条目详情屏幕上显示的详细信息与被点击的日志条目相匹配：
- en: '![](img/B31371_21_05.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B31371_21_05.png)'
- en: 'Figure 21.5: Simulator showing details of the tapped journal entry on the Journal
    Entry Detail screen'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 图21.5：模拟器显示在日志条目详情屏幕上被点击日志条目的详细信息
- en: Your app now correctly displays the details of a tapped journal entry in the
    Journal Entry Detail screen. Cool! In the next section, you’ll modify the methods
    used to remove a journal entry in the `JournalListViewController` class.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 你的应用现在可以在日志条目详情屏幕中正确显示被点击日志条目的详细信息。酷！在下一节中，你将修改`JournalListViewController`类中用于删除日志条目的方法。
- en: Modifying the method to remove journal entries
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 修改删除日志条目的方法
- en: 'Up to this point, the method used to remove `JournalEntry` instances from the
    `journalEntries` array in the `SharedData` instance uses the table view row to
    identify the index of the `JournalEntry` instance to be removed. However, when
    the search bar is active, the table view row may not match the index of the `JournalEntry`
    instance to be removed. You will add a property to the `JournalEntry` class to
    store a value that will identify a `JournalEntry` instance, and modify methods
    in the `SharedData` and `JournalListViewController` classes to use this property
    to determine the `JournalEntry` instance to be removed. Follow these steps:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，用于从`SharedData`实例中的`journalEntries`数组中删除`JournalEntry`实例的方法使用表格视图行来识别要删除的`JournalEntry`实例的索引。然而，当搜索栏处于活动状态时，表格视图行可能不会匹配要删除的`JournalEntry`实例的索引。你将为`JournalEntry`类添加一个属性以存储一个将识别`JournalEntry`实例的值，并修改`SharedData`和`JournalListViewController`类中的方法以使用此属性来确定要删除的`JournalEntry`实例。按照以下步骤操作：
- en: 'In the Project navigator, click the **JournalEntry** file. Add a new property
    to the `JournalEntry` class to store what’s known as a **UUID** string:'
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在项目导航器中，点击**JournalEntry**文件。向`JournalEntry`类中添加一个新的属性以存储所谓的**UUID**字符串：
- en: '[PRE12]'
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: When a new `JournalEntry` instance is created, the `key` property is assigned
    a string, which is generated by the `UUID` class, and is guaranteed to be unique.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 当创建一个新的`JournalEntry`实例时，`key`属性被分配一个由`UUID`类生成的字符串，该字符串保证是唯一的。
- en: To learn more about the `UUID` class, see [https://developer.apple.com/documentation/foundation/uuid](https://developer.apple.com/documentation/foundation/uuid).
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于`UUID`类的信息，请参阅[https://developer.apple.com/documentation/foundation/uuid](https://developer.apple.com/documentation/foundation/uuid)。
- en: 'Click the **SharedData** file in the Project navigator. Add a method to the
    `SharedData` class after the `removeJournalEntry(at:)` method to remove a `JournalEntry`
    instance with the `UUID` string that matches the `UUID` string of the `JournalEntry`
    instance passed into it:'
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在项目导航器中点击**SharedData**文件。在`removeJournalEntry(at:)`方法之后添加一个方法到`SharedData`类中，用于删除与传入的`JournalEntry`实例的`UUID`字符串匹配的`JournalEntry`实例：
- en: '[PRE13]'
  id: totrans-80
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Click the **JournalListViewController** file in the Project navigator. Modify
    the `tableView(_:commit:forRowAt:)` method in the `JournalListViewController`
    class as shown:'
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在项目导航器中点击**JournalListViewController**文件。按照如下所示修改`JournalListViewController`类中的`tableView(_:commit:forRowAt:)`方法：
- en: '[PRE14]'
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: This method now checks to see if the search bar is active. If it is, the `JournalEntry`
    instance in the `filteredTableData` array corresponding to the row that was tapped
    is assigned to `selectedJournalEntry`. This instance is then removed from the
    `filteredTableData` array and passed as an argument to the `removeSelectedJournalEntry(_:)`
    method. The `journalEntry` instance with the same `UUID` string as the one passed
    into the `removeSelectedJournalEntry(_:)` method is removed from the `journalEntries`
    array in the `SharedData` instance.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 此方法现在会检查搜索栏是否处于活动状态。如果是，则将对应于被点击行的`filteredTableData`数组中的`JournalEntry`实例分配给`selectedJournalEntry`。然后，从这个`filteredTableData`数组中删除此实例，并将其作为参数传递给`removeSelectedJournalEntry(_:)`方法。具有与传递给`removeSelectedJournalEntry(_:)`方法相同的`UUID`字符串的`journalEntry`实例将从`SharedData`实例中的`journalEntries`数组中删除。
- en: 'Build and run your app. Since you made changes to the `JournalEntry` class,
    the previously saved journal entries stored in the JSON file will not load, so
    you will need to create new sample journal entries:'
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建并运行你的应用。由于你对`JournalEntry`类进行了修改，之前保存在JSON文件中的已保存日记条目将无法加载，因此你需要创建新的示例日记条目：
- en: '![](img/B31371_21_06.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/B31371_21_06.png)'
- en: 'Figure 21.6: Simulator showing journal entries on the Journal List screen'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 图21.6：模拟器显示日记列表屏幕上的日记条目
- en: 'Type some text that matches the title of one of the journal entries into the
    search bar. Journal entries with titles that match the search text will be displayed.
    Swipe left on a row and click **Cancel** to exit the search:'
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在搜索栏中输入一些与日记条目标题匹配的文本。与搜索文本匹配的日记条目将被显示。在行上向左滑动并点击**取消**以退出搜索：
- en: '![](img/B31371_21_07.png)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/B31371_21_07.png)'
- en: 'Figure 21.7: Simulator showing a row about to be deleted'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 图21.7：模拟器显示即将被删除的行
- en: Swiping left on a table view row when the search bar is active will delete it
    from the table view and delete the corresponding journal entry from the `journalEntries`
    array in the `SharedData` instance.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 当搜索栏处于活动状态时，在表格视图行上向左滑动将删除它从表格视图中，并从`SharedData`实例中的`journalEntries`数组中删除相应的日记条目。
- en: 'Verify that the deleted journal entry no longer appears on the Journal List
    screen:'
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 验证已删除的期刊条目不再出现在期刊列表屏幕上：
- en: '![](img/B31371_21_08.png)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B31371_21_08.png)'
- en: 'Figure 21.8: Simulator showing remaining journal entries on the Journal List
    screen'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 图21.8：模拟器显示期刊列表屏幕上剩余的期刊条目
- en: You have successfully modified the method to delete journal entries, and the
    implementation of a search bar on the Journal List screen is now complete. Excellent!
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 你已成功修改了删除期刊条目的方法，现在在期刊列表屏幕上实现搜索栏的工作已经完成。太棒了！
- en: Summary
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, you implemented a search bar for the Journal List screen. First,
    you modified the `JournalListViewController` class to conform to the `UISearchResultsUpdating`
    protocol and display a search bar on the Journal List screen. Next, you modified
    the data source methods to display the correct journal entries when the user types
    in a search term. After that, you modified the `prepare(for:sender:)` method to
    ensure that the correct journal entry details are displayed on the Journal Entry
    Detail screen. Finally, you modified the method used to remove journal entries.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你为期刊列表屏幕实现了搜索栏。首先，你修改了`JournalListViewController`类以符合`UISearchResultsUpdating`协议并在期刊列表屏幕上显示搜索栏。接下来，你修改了数据源方法，以便在用户输入搜索词时显示正确的期刊条目。然后，你修改了`prepare(for:sender:)`方法以确保在期刊条目详情屏幕上显示正确的期刊条目详情。最后，你修改了用于删除期刊条目的方法。
- en: You have now learned how to implement a search bar for your own apps, and you
    have also completed the *JRNL* app. Fantastic job!
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 你现在已经学会了如何在你的应用中实现搜索栏，并且你也完成了*JRNL*应用。做得太棒了！
- en: In the next chapter, you’ll learn how to get your app ready for iPads and Macs.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，你将学习如何让你的应用为iPad和Mac做准备。
- en: Join us on Discord!
  id: totrans-99
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 加入我们的Discord频道！
- en: Read this book alongside other users, experts, and the author himself. Ask questions,
    provide solutions to other readers, chat with the author via Ask Me Anything sessions,
    and much more. Scan the QR code or visit the link to join the community.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 与其他用户、专家以及作者本人一起阅读这本书。提问、为其他读者提供解决方案、通过“问我任何问题”的环节与作者聊天，以及更多。扫描二维码或访问链接加入社区。
- en: '[https://packt.link/ios-Swift](https://packt.link/ios-Swift%0D)'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://packt.link/ios-Swift](https://packt.link/ios-Swift%0D)'
- en: '[![](img/QR_Code2370024260177612484.png)](https://packt.link/ios-Swift%0D)'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '[![](img/QR_Code2370024260177612484.png)](https://packt.link/ios-Swift%0D)'
