# ç¬¬äºŒç« . æ ‡å‡†åº“å’Œé›†åˆ

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä»¥ä¸‹é£Ÿè°±ï¼š

+   æ‰‹åŠ¨åˆ›å»º HTML

+   æ‰“å°ä½ çš„å¯¹è±¡æè¿°

+   å¯¹ç”¨æˆ·è¿›è¡Œæµ‹éªŒ

+   å¯»æ‰¾å®Œç¾æ•°

+   å¯¹äº§å“æ•°ç»„è¿›è¡Œæ’åº

+   å¯»æ‰¾å‡ºè·¯

+   åˆ›å»ºä½ è‡ªå·±çš„é›†åˆ

+   ç»„ç»‡é¤å…

# ç®€ä»‹

äº†è§£é›†åˆå’Œæ ‡å‡†åº“çš„ä½¿ç”¨å¾ˆé‡è¦ï¼Œå°¤å…¶æ˜¯å¯¹äºæ¥è‡ª Objective-C çš„äººï¼Œå› ä¸ºè¿™é‡Œæœ‰ä¸€äº›å·®å¼‚ã€‚

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€äº›åº”ç”¨ç¨‹åºæ¥ä½¿ç”¨è¿™äº›åŠŸèƒ½ã€‚åœ¨è¿™äº›é£Ÿè°±ä¹‹åï¼Œä½ åº”è¯¥å¯¹ Swift ç¼–ç¨‹è¯­è¨€æœ‰ä¸€ä¸ªå¾ˆå¥½çš„ç†è§£ã€‚

å¦‚å‰ä¸€ç« æ‰€è¿°ï¼Œæˆ‘ä»¬çš„å¤§éƒ¨åˆ†é£Ÿè°±å°†åœ¨ iOS ä¸Šåˆ›å»ºï¼Œä½†å¦‚æœä½ æ„¿æ„ï¼Œä¹Ÿå¯ä»¥åœ¨ Mac OS X ä¸Šå¼€å‘å®ƒä»¬ã€‚

# æ‰‹åŠ¨åˆ›å»º HTML

HTML æœ€åˆæ˜¯ä¸€ç§ç®€å•çš„ç½‘é¡µå’Œé“¾æ¥æ˜¾ç¤ºæ ¼å¼ã€‚å¦‚ä»Šï¼Œè¿™ç§æ ¼å¼å·²ç»å˜å¾—éå¸¸æ™®éï¼Œå¹¶ä¸”è¢«å¹¿æ³›ä½¿ç”¨ã€‚ç”šè‡³æœ‰åƒ PhoneGap è¿™æ ·çš„æ¡†æ¶ï¼Œå¯ä»¥åˆ›å»ºä½¿ç”¨æ­¤æ–‡ä»¶ç±»å‹çš„åº”ç”¨ç¨‹åºã€‚

åœ¨è¿™ä¸ªé£Ÿè°±ä¸­ï¼Œæˆ‘ä»¬å°†ä»…ä½¿ç”¨å­—ç¬¦ä¸²åˆ›å»º HTMLï¼›ä¸»è¦æ€æƒ³æ˜¯äº†è§£å­—ç¬¦ä¸²æ“ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†åˆ›å»ºåç‰‡ HTML ä»£ç ã€‚

## å‡†å¤‡å·¥ä½œ

æ‰“å¼€ä½ çš„ Xcodeï¼Œåˆ›å»ºä¸€ä¸ªåä¸º`Chapter2 HTML`çš„å•è§†å›¾é¡¹ç›®ã€‚

## å¦‚ä½•æ“ä½œâ€¦

è®©æˆ‘ä»¬æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ‰‹åŠ¨åˆ›å»º HTMLï¼š

1.  ç‚¹å‡»æ•…äº‹æ¿å¹¶æ·»åŠ ä»¥ä¸‹å¸ƒå±€ï¼š![å¦‚ä½•æ“ä½œâ€¦](img/00024.jpeg)

1.  ç„¶åï¼Œå°†æ–‡æœ¬æ¡†ä¸è§†å›¾æ§åˆ¶å™¨ä¸Šçš„ä»¥ä¸‹å±æ€§è¿æ¥ï¼š

    ```swift
    @IBOutlet weak var nameTextField: UITextField!
    @IBOutlet weak var addressTextField: UITextField!
    @IBOutlet weak var postCodeTextField: UITextField!
    @IBOutlet weak var phoneTextField: UITextField!
    ```

1.  å°†è¿™äº›å±æ€§ä¸è§†å›¾ä¸Šçš„ç›¸åº”æ–‡æœ¬æ¡†ç›¸å…³è”ï¼Œåœ¨åˆ›å»ºåŠ¨ä½œæŒ‰é’®ä¹‹å‰ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹ä»£ç åˆ›å»ºä¸€ä¸ª`Card`ç±»ï¼š

    ```swift
    class Card {
        private let TEMPLATE = "<div class=\"personalcard\">" + "<p class=\"name\">#name#</p>" + "<p class=\"address\">#address#</p>" + "<p class=\"postcode\">#postcode#</p>" + "<p class=\"phone\">#phone#</p>" + "</div"

        var name:String?
        var address:String?
        var postCode:String?
        var phone:String?

        init(){}
    }
    ```

    å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªä¸æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå…·æœ‰ç›¸åŒä¿¡æ¯çš„ç±»ã€‚ä¸»è¦åŒºåˆ«æ˜¯æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º`TEMPLATE`çš„å¸¸é‡ï¼Œå®ƒå…·æœ‰æˆ‘ä»¬çš„ HTML æ¨¡å‹ã€‚

    ### æ³¨æ„

    æ³¨æ„ï¼Œè¿™ä¸ªå¸¸é‡æ˜¯ç§æœ‰çš„ï¼Œå› ä¸ºè¿™æ˜¯æˆ‘ä»¬ä¸åº”è¯¥çœ‹åˆ°çš„ä¸œè¥¿ï¼ˆä¾‹å¦‚ï¼Œä»è§†å›¾æ§åˆ¶å™¨ä¸­ï¼‰ã€‚æ­¤å¤–ï¼Œè¯·æ³¨æ„ï¼Œåœ¨éœ€è¦ç»§ç»­åˆ°ä¸‹ä¸€è¡Œçš„æ¯ä¸€è¡Œæœ«å°¾éƒ½æœ‰ä¸€ä¸ªåŠ å·ã€‚åŸå› æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½åƒåœ¨ Objective-C ä¸­ä½¿ç”¨æ“ä½œç¬¦é‚£æ ·ä¸ä½¿ç”¨æ“ä½œç¬¦æ¥è¿æ¥å­—ç¬¦ä¸²ã€‚

    Swift åœ¨æŒ‡ä»¤æœ«å°¾ä¸éœ€è¦åˆ†å·ã€‚ç„¶è€Œï¼Œå¦‚æœä½ æœ‰ä¸€è¡Œéå¸¸é•¿çš„ä»£ç ï¼Œä½ å¿…é¡»å‘Šè¯‰ç¼–è¯‘å™¨è¿™ä¸€è¡Œå°†è¦ç»§ç»­ï¼Œä¾‹å¦‚ï¼Œä½¿ç”¨åŠ å·ï¼Œæˆ–è€…åœ¨ä¸‹ä¸€æ¡çº¿ä¸Šä½¿ç”¨ç‚¹æ“ä½œç¬¦æ¥è¡¨ç¤ºå®ƒä»ä¸Šä¸€è¡Œç»§ç»­ã€‚

    å¦‚æœä½ æ›¾ç»ä½¿ç”¨ Objective-C æˆ– C++è¿›è¡Œç¼–ç¨‹ï¼Œä½ å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç©ºçš„åˆå§‹åŒ–å™¨ã€‚åŸå› æ˜¯ï¼šå®ƒä¸æ˜¯å¿…éœ€çš„ï¼›ç†è®ºä¸Šï¼Œå› ä¸ºæˆ‘ä»¬åªæœ‰å¸¸é‡å’Œå¯é€‰å€¼ã€‚ç„¶è€Œï¼ŒæŸäº› Swift ç‰ˆæœ¬ï¼Œå‡ºäºä»»ä½•åŸå› ï¼Œæ— æ³•æ£€æµ‹åˆ°å®ƒï¼Œå¹¶å¼ºåˆ¶ä½ åˆ›å»ºä¸€ä¸ªç©ºçš„åˆå§‹åŒ–å™¨ã€‚

    å±æ€§çš„åˆå§‹å€¼æ˜¯ä»€ä¹ˆï¼Ÿç­”æ¡ˆæ˜¯*nil*ã€‚çœ‹çœ‹æ˜¯å¦æ‰€æœ‰è¿™äº›å±æ€§éƒ½æ˜¯å¯é€‰çš„ï¼›å¦‚æœä¸æ˜¯ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸å°†å®ƒä»¬çš„å€¼è®¾ç½®ä¸ºæŸäº›å†…å®¹ã€‚

    ### å°è´´å£«

    é¿å…ä½¿ç”¨ç©ºå€¼ï¼Œä¾‹å¦‚ç©ºå­—ç¬¦ä¸²æ¥åˆå§‹åŒ–å±æ€§ï¼›æœ€å¥½ä½¿ç”¨å¯é€‰å±æ€§ã€‚

1.  åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æœ‰äº†åŸºæœ¬ç»“æ„ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦åˆ›å»ºæŒ‰é’®äº‹ä»¶ï¼Œæ‰€ä»¥å°†è§†å›¾æ§åˆ¶å™¨ä¸Šçš„è§¦æ‘¸äº‹ä»¶ä¸ä»¥ä¸‹åŠ¨ä½œé“¾æ¥ï¼š

    ```swift
    @IBAction func showHTML(sender: AnyObject) {
      var card = Card()

      card.name = nameTextField.text
      card.address = addressTextField.text
      card.postCode = postCodeTextField.text
      card.phone = phoneTextField.text

      let alert = UIAlertController(title: "HTML", message: card.toHtml(), preferredStyle:.Alert)
      self.presentViewController(alert, animated: true, completion: nil)
    }
    ```

1.  ç°åœ¨æˆ‘ä»¬å°†çœ‹çœ‹è¿™ä¸ªåŠ¨ä½œæ˜¯å¦éå¸¸æ¸…æ™°ã€‚æˆ‘ä»¬å°†å¼€å§‹åˆ›å»ºä¸€ä¸ª`card`å¯¹è±¡ï¼Œç„¶åä»æˆ‘ä»¬çš„è§†å›¾ä¸­è·å–æ‰€éœ€çš„ä¿¡æ¯ï¼Œæœ€åæ˜¾ç¤ºå®ƒã€‚

    ### å°è´´å£«

    é¿å…é¢æ¡ä»£ç ï¼›ä¸è¦åˆ›å»ºä¸€ä¸ªå·¨å¤§çš„åŠ¨ä½œï¼Œå¹¶å°è¯•å°†å…¶åˆ†è§£ä¸ºç±»å’Œæ–¹æ³•ã€‚çœ‹çœ‹ç»´åŸºç™¾ç§‘ä¸Šçš„æ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨æ¨¡å¼ã€‚

1.  é™¤äº†ä¸€ä¸ªç»†èŠ‚å¤–ï¼Œä¸€åˆ‡éƒ½å¾ˆæ­£å¸¸ï¼š`Card`ç±»æ²¡æœ‰åä¸º`toHtml`çš„æ–¹æ³•ã€‚æ²¡é—®é¢˜ï¼Œè®©æˆ‘ä»¬å®ç°å®ƒã€‚å›åˆ°æˆ‘ä»¬çš„`Card`ç±»ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼š

    ```swift
    func toHtml() -> String{
      var html = TEMPLATE.stringByReplacingOccurrencesOfString("#name#", withString: self.name!)
      .stringByReplacingOccurrencesOfString("#address#", withString: self.address!)
      .stringByReplacingOccurrencesOfString("#postcode#", withString: self.postCode!)
      .stringByReplacingOccurrencesOfString("#phone#", withString: self.phone!)
      return html;
    }
    ```

1.  ç°åœ¨æ˜¯æ—¶å€™æµ‹è¯•å®ƒäº†ï¼›åªéœ€åœ¨ Xcode IDE ä¸­æŒ‰æ’­æ”¾ï¼Œå¡«å†™å­—æ®µå¹¶æŒ‰æŒ‰é’®ï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ°ä¸€ä¸ªåƒè¿™é‡Œæ˜¾ç¤ºçš„æ¶ˆæ¯ï¼š![å¦‚ä½•åšâ€¦](img/00025.jpeg)

## å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„â€¦

å­—ç¬¦ä¸²æœ‰å¾ˆå¤šæ–¹æ³•ï¼›å…¶ä¸­ä¸€äº›ç”¨äºä¿®æ”¹å½“å‰å­—ç¬¦ä¸²ï¼Œè€Œå¦ä¸€äº›ä»…è¿”å›å€¼ï¼Œè¿˜æœ‰ä¸€äº›åŸºäºåŸå§‹å­—ç¬¦ä¸²åˆ›å»ºæ–°çš„å­—ç¬¦ä¸²ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†`stringByReplacingOccurrencesOfString`ï¼Œé€šè¿‡æ›¿æ¢æˆ‘ä»¬çš„æ ‡è®°`(#something#`)æ¥ç”Ÿæˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œå¯¹åº”äºç›¸åº”çš„å±æ€§ã€‚

æˆ‘ä»¬å¯ä»¥å°†æ¯ä¸ªæ›¿æ¢çš„ç»“æœé“¾å¼è°ƒç”¨ï¼Œä»¥è¿›è¡Œä¸‹ä¸€ä¸ªæ›¿æ¢ï¼Œé˜²æ­¢æ¯è¡Œé‡æ–°èµ‹å€¼ã€‚

### å°è´´å£«

ç°åœ¨ï¼ŒiPhone å’Œ iPad æ‹¥æœ‰ 1GB æˆ–æ›´å¤šçš„ RAMï¼Œè¿™å¯¹äºå¤§å¤šæ•°ä¼ ç»Ÿçš„ HTML æ¨¡æ¿æ¥è¯´åº”è¯¥è¶³å¤Ÿäº†ã€‚ç„¶è€Œï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªéå¸¸å¤§çš„æ¨¡æ¿ï¼Œæœ‰å¾ˆå¤šæ›¿æ¢ï¼Œä½ å¯èƒ½éœ€è¦å¯»æ‰¾æ›´ä¼˜åŒ–çš„æ–¹æ³•ã€‚åœ¨å¤§å‹å­—ç¬¦ä¸²å˜é‡ä¸Šæ›¿æ¢å­—ç¬¦ä¸²ä¼šåˆ†é…å¤§é‡å†…å­˜ï¼Œä½ å¯èƒ½ä¼šå¾—åˆ°è¾ƒå·®çš„æ€§èƒ½ã€‚

## è¿˜æœ‰æ›´å¤š...

å¦‚æœä½ æŸ¥çœ‹è¿™ä¸ªæ–¹æ³•æ–‡æ¡£ï¼Œä½ ä¼šçœ‹åˆ°æœ‰ä¸¤ä¸ªé¢å¤–çš„å‚æ•°ï¼Œä¸€ä¸ªå«åš`options`ï¼Œå¦ä¸€ä¸ªå«åš`range`ã€‚å®ƒä»¬ç”¨äºæŒ‡å®šä¸€ä¸ªç‰¹æ®Šçš„æ¯”è¾ƒå™¨æ¥æœç´¢æˆ‘ä»¬çš„å­—ç¬¦ä¸²æ ‡è®°ï¼Œå¦ä¸€ä¸ªåˆ™åªä½¿ç”¨æˆ‘ä»¬å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚ç”±äºæˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨å®ƒä»¬ï¼Œå®ƒä»¬æ˜¯å¯é€‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªæ˜¯çœç•¥äº†å®ƒä»¬ï¼›æ²¡æœ‰å¿…è¦ç”¨ nil å€¼å¡«å……ï¼Œå°±åƒæˆ‘ä»¬ä»¥å‰åœ¨ Objective-C ä¸­åšçš„é‚£æ ·ã€‚

### å°è´´å£«

å¦‚æœä½ çš„é¡¹ç›®ä¸­æœ‰éœ€è¦åˆ›å»º HTMLã€XML æˆ– JSON ä»£ç çš„å¯¹è±¡ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªå…·æœ‰ç‰¹å®šäºç›¸åº”ç±»å‹è½¬æ¢çš„æ–¹æ³•çš„åŸºç¡€å¯¹è±¡ï¼Œä»¥å®ç°æ ‡å‡†åŒ–ã€‚

# æ‰“å°ä½ çš„å¯¹è±¡æè¿°

è¿™ä¸ªèœè°±çš„ç›®çš„æ˜¯çœ‹çœ‹ä½¿ç”¨å˜é‡å€¼åˆ›å»ºå­—ç¬¦ä¸²çš„ Swift æ–¹æ³•ã€‚åœ¨ Objective-C ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º`stringWithFormat`çš„ç±»æ–¹æ³•ï¼Œä½†åœ¨ Swift ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•ä¸åƒåœ¨ Objective-C ä¸­é‚£æ ·é¢‘ç¹ä½¿ç”¨ï¼Œå› ä¸ºç°åœ¨æˆ‘ä»¬æœ‰æ’å€¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå®ƒå°†å‘ç”¨æˆ·å±•ç¤ºä¸‰ç§å¯èƒ½çš„äº§å“ã€‚å½“ç”¨æˆ·é€‰æ‹©å…¶ä¸­ä¹‹ä¸€æ—¶ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»æ˜¾ç¤ºè¯¥äº§å“çš„ä¿¡æ¯ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œè¿˜è¦æ˜¾ç¤ºå…¶ä»·æ ¼ã€‚

## å¦‚ä½•åš...

1.  åˆ›å»ºä¸€ä¸ªåä¸º`Chapter2 Product Value`çš„æ–°å•è§†å›¾é¡¹ç›®ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç‚¹å‡»æ•…äº‹æ¿å¹¶æ·»åŠ ä¸‰ä¸ªæŒ‰é’®ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š![å¦‚ä½•æ“ä½œâ€¦](img/00026.jpeg)

1.  å®Œæˆæ­¤æ“ä½œåï¼Œä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªåä¸º`Product`çš„æ–° swift æ–‡ä»¶ã€‚ç°åœ¨æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåŒ…å«äº§å“åç§°ã€å…¶ä»·æ ¼å’Œåˆ¶é€ å•†åç§°çš„ç±»ã€‚

    åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå”¯ä¸€å¯ä»¥çœç•¥çš„ä¿¡æ¯æ˜¯äº§å“ä»·æ ¼ï¼›å…¶ä»–å±æ€§æ˜¯å¿…éœ€çš„ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåˆå§‹åŒ–å™¨ï¼Œè‡³å°‘åŒ…å«äº§å“åç§°å’Œåˆ¶é€ å•†åç§°ã€‚

1.  ç”±äºæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨æ’å€¼åŠŸèƒ½æ¥ä½¿ç”¨æˆ‘ä»¬çš„äº§å“ï¼Œæˆ‘ä»¬éœ€è¦å®ç°`CustomStringConvertable`åè®®ï¼Œè¿™è¿«ä½¿æˆ‘ä»¬å®ç°ä¸€ä¸ªåä¸º`description`çš„å±æ€§ã€‚ä¸€æ—¦æˆ‘ä»¬æœ‰äº†è¿™äº›ä¿¡æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç å®ç°æˆ‘ä»¬çš„ç±»ï¼š

    ```swift
    class Product: CustomStringConvertible{
      var price:Double?
      var name: String
      var manufacturer: String

      init(name: String, manufacturer: String){
        self.name = name
        self.manufacturer = manufacturer
      }

      var description:String {
        return "\(self.name) (\(self.manufacturer))"
      }
    }
    ```

1.  ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥è½¬åˆ°è§†å›¾æ§åˆ¶å™¨å¹¶åˆ›å»ºä¸‰ä¸ªäº§å“ä½œä¸ºå±æ€§ï¼›æŒ‰ç…§æˆ‘ä»¬çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å°†åˆ›å»º`television`ã€`gabion`å’Œ`locker`ã€‚æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬æ·»åŠ ä»¥ä¸‹å±æ€§ï¼š

    ```swift
      private let television = Product(name: "Television", manufacturer: "Telefunken")
      private let gabion = Product(name: "Gabion", manufacturer: "Maccaferri")
      private let locker = Product(name: "Locker", manufacturer: "Danalockers")
    ```

1.  ä¸‹ä¸€æ­¥æ˜¯åˆ›å»ºä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†æŠŠåŒç²¾åº¦æµ®ç‚¹æ•°è½¬æ¢ä¸ºå…·æœ‰ä¸¤ä½ç²¾åº¦çš„å­—ç¬¦ä¸²ã€‚æˆ‘å°†åœ¨è§†å›¾æ§åˆ¶å™¨æ–‡ä»¶ä¸­åˆ›å»ºæ­¤å‡½æ•°ï¼Œä½†ä¸åœ¨å…¶ç±»å†…éƒ¨ã€‚å¦‚æœåœ¨é¡¹ç›®ä¸­ä½ æ‰“ç®—åœ¨å¤šä¸ªæ–‡ä»¶ä¸­ä½¿ç”¨æ­¤å‡½æ•°ï¼Œæˆ‘å»ºè®®ä½ ä½¿ç”¨ä»¥ä¸‹ä»£ç åˆ›å»ºå¦ä¸€ä¸ªæ–‡ä»¶ï¼š

    ```swift
    func doubleFormatter(value: Double) -> String{
      return String(format: "%.2f", value)
    ```

    ### å°è´´å£«

    å°†ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ä¸“é—¨ç”¨äºè¾…åŠ©å‡½æ•°å’Œç±»æ‰©å±•æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚è¿™å°†ä½¿ä½ çš„ä»£ç ç»´æŠ¤æ›´å®¹æ˜“ã€‚

1.  æˆ‘ä»¬éœ€è¦åšçš„æœ€åä¸€ä»¶äº‹æ˜¯åˆ›å»ºæŒ‰é’®åŠ¨ä½œã€‚æ­£å¦‚ä½ æ‰€çŸ¥ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªæŒ‰é’®ï¼Œå®ƒä»¬éƒ½å°†æ‰§è¡Œç›¸åŒçš„åŠŸèƒ½ï¼›å”¯ä¸€çš„åŒºåˆ«æ˜¯æ˜¾ç¤ºçš„äº§å“ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œå¹¶æ ¹æ®å‘é€è€…åŒºåˆ†äº§å“ã€‚

    ### å°è´´å£«

    é¿å…é‡å¤ä»£ç ï¼Œå³ä½¿å®ƒä»¬ç›¸é‚»æˆ–å¾ˆå°ã€‚è¿™æ˜¯å› ä¸ºå½“é¡¹ç›®å¼€å§‹æ¥æ”¶æ›´æ”¹æ—¶ï¼Œå®ƒå°†ç”Ÿæˆæ–°çš„é”™è¯¯ã€‚

1.  æˆ‘æƒ³æåˆ°çš„å¦ä¸€ä¸ªç»†èŠ‚æ˜¯ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘å°†åœ¨æ·»åŠ å¢å€¼ç¨ï¼ˆ20%ï¼‰åæ˜¾ç¤ºäº§å“ä»·æ ¼ã€‚è¿™æ˜¯ä¸ºäº†è®©ä½ äº†è§£ Swift å­—ç¬¦ä¸²æ’å€¼çš„å¼ºå¤§åŠŸèƒ½ï¼š

    ```swift
    @IBAction func showDescription(sender: UIButton) {
      var message:String
      var product: Product

      if sender.titleLabel?.text == "Television"{
        product = television
      }else if sender.titleLabel?.text == "Gabion" {
        product = gabion
      }else if sender.titleLabel?.text == "Locker"{
        product = locker
      }else{
        return
      }
      message = "You've chosen \(product)"

      if let price = product.price {
        message += " which costs \(doubleFormatter(price * 1.20)))"
      }

        let alert = UIAlertController(title: "Product information", message: message, preferredStyle:.Alert)
                   self.presentViewController(alert, animated: true, completion: nil)
    ```

    ### æ³¨æ„

    åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æŒ‰é’®çš„æ ‡é¢˜æ¥çŸ¥é“é€‰æ‹©çš„äº§å“ï¼Œä½†è¿™æ˜¯ä¸€ç§ä¸å¥½çš„åšæ³•ã€‚è¿™æ ·åšåªæ˜¯ä¸ºäº†åˆ›å»ºä¸€ä¸ªä¸“æ³¨äºå­—ç¬¦ä¸²æ’å€¼çš„å°ç¤ºä¾‹ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ éœ€è¦å°†ä½ çš„ç¨‹åºç¿»è¯‘æˆå…¶ä»–è¯­è¨€ï¼Œæˆ–è€…å¦‚æœä½ éœ€è¦å‘è¿™ä¸ªæ ‡ç­¾æ·»åŠ å°‘é‡ä¿¡æ¯ï¼Œè¿™å°†ä½¿ä½ ä¿®å¤å¤§é‡çš„ä»£ç ã€‚

1.  ç°åœ¨æˆ‘ä»¬çš„åº”ç”¨å·²ç»å®Œæˆï¼›å°è¯•æŒ‰ä¸‹æ’­æ”¾æŒ‰é’®ï¼Œç„¶åç‚¹å‡»åº”ç”¨æŒ‰é’®ã€‚ä½ åº”è¯¥çœ‹åˆ°ä¸€ä¸ªç±»ä¼¼äºè¿™æ ·çš„è­¦å‘Šè§†å›¾ï¼š![å¦‚ä½•æ“ä½œâ€¦](img/00027.jpeg)

## å·¥ä½œåŸç†...

Swift æœ€ä¼Ÿå¤§çš„åŠŸèƒ½ä¹‹ä¸€æ˜¯å­—ç¬¦ä¸²æ’å€¼ï¼›å®ƒå…è®¸ä½ æ‹¥æœ‰æˆ‘ä»¬åœ¨è®¡ç®—åŒ…å«å¢å€¼ç¨çš„ä»·æ ¼æ—¶æ‰€åšçš„è¡¨è¾¾å¼ã€‚è¿™ä¹Ÿå…è®¸ä½ è°ƒç”¨åƒ`doubleFormatter`è¿™æ ·çš„å‡½æ•°ï¼Œä½¿æˆ‘ä»¬çš„æ•°å­—ä»¥ä¸¤ä½æ•°æ˜¾ç¤ºã€‚è¿™ä¹Ÿå…è®¸æˆ‘ä»¬æ‰“å°ä¸€ä¸ªå¯¹è±¡ã€‚

å¦‚æœæˆ‘ä»¬æ„¿æ„ï¼Œç”šè‡³å¯ä»¥è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•æˆ–å±æ€§ï¼Œä¾‹å¦‚ã€‚æˆ‘ä»¬å¯ä»¥å°†åˆ¶é€ å•†åç§°æ˜¾ç¤ºä¸ºå¤§å†™ï¼Œå°†æˆ‘ä»¬çš„æè¿°æ›´æ”¹ä¸º`\(self.name) \(self.manufacturer.uppercaseString))`ã€‚

è®°ä½ï¼Œå¦‚æœä½ æƒ³æ‰“å°è‡ªå·±çš„å¯¹è±¡ï¼Œå®ƒå¿…é¡»éµå¾ª`CustomStringConvertable`åè®®å¹¶å®ç°åä¸º`description`çš„å±æ€§ã€‚ä¸€äº›è¯­è¨€ï¼Œä¾‹å¦‚ Javaï¼Œåœ¨åŸºç±»ä¸­æœ‰ä¸€ä¸ªç­‰æ•ˆçš„æ–¹æ³•ï¼ˆJava ä¸­çš„`toString`ï¼‰ï¼Œä½ åªéœ€è¦é‡å†™å®ƒã€‚ç„¶è€Œï¼ŒSwift å¦‚æœæ²¡æœ‰æŒ‡å®šåŸºç±»ï¼Œå°±æ²¡æœ‰åŸºç±»ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ å¿…é¡»åœ¨æŒ‡å®šäº†`CustomStringConvertable`åè®®çš„ä½¿ç”¨åæ‰èƒ½è¦†ç›–`description`å±æ€§ã€‚

è¦ä½¿ç”¨å­—ç¬¦ä¸²æ’å€¼ï¼Œåªéœ€åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå½“ä½ éœ€è¦å¤–éƒ¨å€¼æ—¶ï¼Œåªéœ€å°†å…¶ç”¨`\(`ï¼ˆåæ–œæ å’Œå·¦æ‹¬å·ï¼‰å’Œ`)`ï¼ˆå³æ‹¬å·ï¼‰åŒ…è£¹èµ·æ¥ï¼Œä¾‹å¦‚ï¼Œ`\(variable)`ã€‚

### å°è´´å£«

å¦‚æœè¡¨è¾¾å¼å˜å¾—è¿‡äºå¤æ‚ï¼Œä»¥è‡³äºéš¾ä»¥ä½¿ç”¨ï¼Œåªéœ€åœ¨å­—ç¬¦ä¸²å†…éƒ¨åˆ›å»ºä¸€ä¸ªæ–°çš„å˜é‡å¹¶è®¾ç½®å…¶å€¼ã€‚è¿™åœ¨è½¯ä»¶ç»´æŠ¤æ–¹é¢ä¹Ÿæ˜¯ä¸€ç§è‰¯å¥½çš„å®è·µã€‚Objective-C æ²¡æœ‰è¿™ä¸ªåŠŸèƒ½ï¼›ä½ å¿…é¡»ä½¿ç”¨åä¸º`stringWithFormat`çš„ç±»æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ã€‚æˆ‘ä»¬ä½¿ç”¨äº† Swift çš„ç­‰æ•ˆæ–¹æ³•ï¼Œç°åœ¨æ˜¯ä¸€ä¸ªåˆå§‹åŒ–å™¨ã€‚

æˆ‘è¿˜æƒ³æŒ‡å‡ºï¼Œæˆ‘ä»¬åœ¨`if`è¯­å¥ä¸­åˆ›å»ºäº†ä¸€ä¸ªå¸¸é‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸æ˜¯éªŒè¯ä»·æ ¼æ˜¯å¦ä¸ºçœŸæˆ–æ˜¯å¦å¤§äºé›¶ï¼Œæˆ‘ä»¬åªæ˜¯æ£€æŸ¥å®ƒæ²¡æœ‰ nil å€¼ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä»·æ ¼ä¸º 0 çš„äº§å“ï¼Œå®ƒä¹Ÿä¼šè¯„ä¼°ä¸ºçœŸã€‚

æœ€åä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œæˆ‘ä»¬çš„`message`å˜é‡ä¸æ˜¯å¯é€‰çš„ï¼Œä½†å®ƒå¹¶æ²¡æœ‰åœ¨å£°æ˜çš„åœ°æ–¹åˆå§‹åŒ–ã€‚åŸå› æ˜¯ç¼–è¯‘å™¨ä¼šåœ¨è¯»å–å’Œè®¾ç½®å®ƒä¹‹å‰æ£€æŸ¥å®ƒï¼Œå¹¶ä¸”æ²¡æœ‰æœªåˆå§‹åŒ–çš„å¯èƒ½æ€§ã€‚

è¿™ä¸ªå˜é‡çš„åˆå§‹å€¼å–å†³äºäº§å“å€¼ï¼Œå®ƒä¸èƒ½ä¸º nilï¼›è¿™å°±æ˜¯æˆ‘ä»¬è¢«è¿«æ·»åŠ `else`è¯­å¥å’Œä»æˆ‘ä»¬çš„å‡½æ•°ä¸­é€€å‡ºçš„åŸå› ã€‚å¦åˆ™ï¼Œç¼–è¯‘å™¨ä¼šæ‰¾åˆ°ä¸€ä¸ªå¯èƒ½çš„æ–¹æ³•å°†äº§å“è®¾ç½®ä¸º nilï¼Œå¹¶ä¸”ç”±äºæˆ‘ä»¬çš„æ’å€¼ï¼Œå®ƒå°†å¤±è´¥ã€‚

## è¿˜æœ‰æ›´å¤š...

æˆ‘ä»¬ä¸º`doubleFormatter`å‡½æ•°æä¾›çš„å¦ä¸€ä¸ªè‰¯å¥½è§£å†³æ–¹æ¡ˆæ˜¯åˆ›å»ºä¸€ä¸ªæ‰©å±•ã€‚ä¸ºæ­¤ï¼Œåªéœ€å°†æˆ‘ä»¬çš„æ ¼å¼åŒ–ä»£ç æ›´æ”¹ä¸ºä»¥ä¸‹ä»£ç ï¼š

```swift
extension Double {
    func precision(numDigits: Int) -> String {
        return NSString(format: "%.\(numDigits)f", self)
    }
}
```

è¿™æ„å‘³ç€æˆ‘ä»¬ç°åœ¨ä¸ºåŒç²¾åº¦ç±»å‹æ·»åŠ äº†ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥éšæ—¶è°ƒç”¨å®ƒã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¾—æ”¹å˜ä½¿ç”¨æˆ‘ä»¬çš„åŒç²¾åº¦å€¼çš„æ’å€¼ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç±»æ‰©å±•ï¼Œç”¨ä»¥ä¸‹ä¸€è¡Œæ›¿æ¢ç›¸åº”çš„è¡Œï¼š

```swift
message += " which costs \((price * 1.20).precision(2)))"Adding different characters
```

# å¯¹ç”¨æˆ·è¿›è¡Œæµ‹éªŒ

æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­æ·»åŠ ä¸€äº›å›¾æ ‡ï¼Œä½†æ ¹æ®æ‚¨æƒ³è¦çš„å›¾æ ‡ï¼Œä¸ä¸€å®šéœ€è¦æ·»åŠ å›¾ç‰‡ï¼›æ‚¨å¯ä»¥ä½¿ç”¨ Unicode å­—ç¬¦ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªä»…ä½¿ç”¨å­—ç¬¦ä¸²çš„æµ‹éªŒåº”ç”¨ã€‚

è¿™ä¸ªåº”ç”¨çš„æƒ³æ³•æ˜¯åˆ›å»ºä¸€ä¸ªåº”ç”¨ï¼Œç”¨æˆ·éœ€è¦åœ¨ 12 ç§’å†…å›ç­”ä¸€ä¸ªé—®é¢˜ã€‚åœ¨æµ‹éªŒç»“æŸåï¼Œåº”ç”¨å°†æ˜¾ç¤ºç”¨æˆ·çš„å¾—åˆ†ï¼Œä¾‹å¦‚æ­£ç¡®å’Œé”™è¯¯é—®é¢˜çš„æ•°é‡ã€‚

## å‡†å¤‡ä¸­

ä¸€æ—¦æˆ‘ä»¬äº†è§£äº†è¿™ä¸ªç¨‹åºçš„æ¦‚å¿µï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œå¹¶å°†å…¶å‘½åä¸º `ç¬¬äºŒç«  Unicode`ã€‚

## å¦‚ä½•æ“ä½œ...

è¦åˆ›å»ºä¸€ä¸ªæµ‹éªŒåº”ç”¨ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

1.  é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º `Quiz` çš„æ–°æ–‡ä»¶ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ ä¸€ä¸ªå¸¦æœ‰é—®é¢˜ã€ä¸‰ä¸ªå¯èƒ½ç­”æ¡ˆå’Œæ­£ç¡®ç­”æ¡ˆçš„ç±»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

    ```swift
    class Quiz {
        var question:String
        // First possible answer
        var â‘ :String
        // second possible answer
        var â‘¡:String
        // third possible answer
        var â‘¢:String
        // Right answer
        var ğŸ‘Œ:Int

        init(question:String, â‘ :String, â‘¡:String, â‘¢:String, ğŸ‘Œ:Int){
            self.question = question
            self.â‘  = â‘ 
            self.â‘¡ = â‘¡
            self.â‘¢ = â‘¢
            self.ğŸ‘Œ = ğŸ‘Œ
        }
    }
    ```

    ### å°è´´å£«

    è¦å°† Unicode å­—ç¬¦æ·»åŠ åˆ°æ‚¨çš„ä»£ç ä¸­ï¼Œæ‚¨å¯ä»¥ä»ç½‘ç«™å¤åˆ¶æˆ–è½¬åˆ° **ç¼–è¾‘** | **ç‰¹æ®Šå­—ç¬¦**ã€‚

1.  ç°åœ¨æˆ‘ä»¬å·²ç»æ‹¥æœ‰äº†è¿™ä¸ªæ„‰å¿«çš„ç±»ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºå¦ä¸€ä¸ªç±»æ¥å­˜å‚¨æˆ‘ä»¬çš„æµ‹éªŒå¹¶ç®¡ç†ç”¨æˆ·çš„ç­”æ¡ˆï¼š

    ```swift
    class QuizManager {
        private var quizzes:[Quiz] = []
        private var currentQuestion = 0
        // Total right answers
        private var ğŸ‘ = 0
        // Total wrong answers
        private var ğŸ‘ = 0

        func addQuiz(quiz:Quiz) {
            self.quizzes.append(quiz)
        }

        func getCurrentQuestion() -> Quiz? {
            if currentQuestion < quizzes.count {
                return self.quizzes[currentQuestion]
            }
            return nil
        }

        // Answer to the current question.
        // Returns true if it was the right answer
        func answer(questionNumber:Int) -> Bool{
            var rightAnswer:Bool
            if getCurrentQuestion()!.ğŸ‘Œ == questionNumber {
                rightAnswer = true
                ğŸ‘++
            }else {
                rightAnswer = false
                ğŸ‘++
            }
            return rightAnswer
        }

        func getğŸ‘() -> Int {
            return ğŸ‘
        }

        func getğŸ‘() -> Int {
            return ğŸ‘
        }
    }
    ```

1.  ä¸‹ä¸€æ­¥æ˜¯æ·»åŠ ä¸€ä¸ªç”¨äºé—®é¢˜çš„æ ‡ç­¾ã€ä¸‰ä¸ªç”¨äºå¯èƒ½ç­”æ¡ˆçš„æŒ‰é’®å’Œä¸€ä¸ªç”¨äºæ˜¾ç¤ºè®¡æ—¶å™¨çš„æ ‡ç­¾ã€‚å¦‚æœæ‚¨ä¸æƒ³æ˜¾ç¤ºå¯¼èˆªæ ï¼Œåˆ«å¿˜äº†å°†å…¶éšè—ã€‚æ‚¨çš„å±å¹•åº”è¯¥çœ‹èµ·æ¥ç±»ä¼¼äºè¿™ä¸ªï¼š![å¦‚ä½•æ“ä½œ...](img/00028.jpeg)

1.  ç°åœ¨æ˜¯æ—¶å€™åœ¨æˆ‘ä»¬çš„è§†å›¾æ§åˆ¶å™¨ä¸Šåˆ›å»ºç›¸åº”çš„å±æ€§å¹¶å°†å®ƒä»¬é“¾æ¥èµ·æ¥ã€‚é™¤äº†è¿™äº›ç»„ä»¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªè®¡æ—¶å™¨å’Œå¦ä¸€ä¸ªå˜é‡æ¥çŸ¥é“å·²ç»è¿‡å»äº†å¤šå°‘æ—¶é—´ã€‚å°†è¿™äº›å±æ€§å‘½åä¸ºå¦‚ä¸‹æ‰€ç¤ºï¼š

    ```swift
        @IBOutlet var questionLabel: UILabel!
        @IBOutlet var timerLabel: UILabel!
        @IBOutlet var answerâ‘ Button: UIButton!
        @IBOutlet var answerâ‘¡Button: UIButton!
        @IBOutlet var answerâ‘¢Button: UIButton!
        var quizTimer: NSTimer?
        var elapsedTime:Int
        var quizManager:QuizManager
    ```

1.  å¥½çš„ï¼Œç°åœ¨æ˜¯æˆ‘ä»¬åˆå§‹åŒ–è¿™äº›ç»„ä»¶çš„æ—¶å€™äº†ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦åˆ›å»ºä¸€ä¸ªåˆå§‹åŒ–å™¨çš„åŸå› ã€‚åœ¨ Objective-C ä¸­ï¼Œæˆ‘ä»¬æ›¾ç»è®¾ç½® `viewDidLoad` æ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨æ§åˆ¶å™¨çš„è§†å›¾è¢«åŠ è½½åˆ°å†…å­˜åè°ƒç”¨çš„ï¼Œä½†ç°åœ¨åœ¨ Swift ä¸­ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½å¿…é¡»åˆå§‹åŒ–æ¯ä¸ªéå¯é€‰å±æ€§ã€‚è¿™å°±æ˜¯æˆ‘ä»¬è¦é‡å†™ `init` æ–¹æ³•çš„åŸå› ã€‚ä¸è¦æ‹…å¿ƒæ¯è¡Œä»£ç çš„å«ä¹‰ï¼›å¾ˆå¿«å°±ä¼šè§£é‡Šï¼š

    ```swift
        required init(coder: NSCoder) {
            self.elapsedTime = 0
            quizManager = QuizManager()
            super.init(coder: coder)
            setupQuizManager()

        }
    private func setupQuizManager(){
            quizManager.addQuiz(Quiz(question: "What's the capital of Australia?", â‘ : "Sidney", â‘¡: "Melbourne", â‘¢: "Canberra", ğŸ‘Œ: 3))
            quizManager.addQuiz(Quiz(question: "What is the smallest planet in the solar system?", â‘ : "The moon", â‘¡: "Mercury", â‘¢: "The sun", ğŸ‘Œ: 2))
            quizManager.addQuiz(Quiz(question: "In which year was Harley Davison founded?", â‘ : "1903", â‘¡: "2013", â‘¢: "80BC", ğŸ‘Œ: 1))
        }
    ```

    æ‚¨å¯èƒ½é¦–å…ˆä¼šé—®ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬ä½¿ç”¨ `required` è€Œä¸æ˜¯ `override`ï¼Ÿè¿™æ˜¯å› ä¸ºåˆå§‹åŒ–å™¨åœ¨åŸºç±»ï¼ˆ`UIViewController`ï¼‰ä¸­è¢«å®šä¹‰ä¸º `required`ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¿…é¡»é‡æ–°å®ç°è¿™ä¸ªæ–¹æ³•ã€‚

1.  ä¸‹ä¸€æ­¥æ˜¯è®¾ç½® `elapsedTime`ã€‚æˆ‘ä»¬ç°åœ¨ä¸ä¼šä½¿ç”¨å®ƒï¼Œä½†ç”±äºå®ƒä¸æ˜¯å¯é€‰çš„ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨è¿™é‡Œè®¾ç½®å®ƒã€‚è¯·æ³¨æ„ï¼Œ`elapsedTime` å’Œ `quizManager` éƒ½åœ¨è¶…ç±»ä¹‹å‰åˆå§‹åŒ–ã€‚åœ¨åˆå§‹åŒ–è¶…ç±»ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å°†é—®é¢˜æ·»åŠ åˆ°æµ‹éªŒç®¡ç†å™¨ä¸­ï¼›è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æœ‰ `setupQuizManager` çš„è°ƒç”¨ã€‚

1.  å¥½çš„ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥å°†ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¾ç¤ºåœ¨å±å¹•ä¸Šäº†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦è‘—åçš„ `viewDidLoad` å‡½æ•°ã€‚æˆ‘ä»¬æ— æ³•åœ¨åˆå§‹åŒ–å™¨ä¸­åšè¿™ä»¶äº‹ï¼Œå› ä¸ºæ ‡ç­¾å’ŒæŒ‰é’®è¿˜æ²¡æœ‰è¢«å®ä¾‹åŒ–ã€‚æ‚¨è¿˜å¯ä»¥çœ‹åˆ° `prepareNextQuestion` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•éªŒè¯æ˜¯å¦æœ‰æ›´å¤šçš„é—®é¢˜ã€‚å¦‚æœæœ‰ï¼Œåˆ™æ˜¾ç¤ºä¸‹ä¸€ä¸ªé—®é¢˜ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™æ˜¾ç¤ºæ‚¨çš„å¾—åˆ†ï¼š

    ```swift
        override func viewDidLoad() {
            super.viewDidLoad()
            prepareNextQuestion()
        }
        private func prepareNextQuestion(){
            if quizTimer != nil {
                quizTimer!.invalidate()
            }
            guard let quiz = quizManager.getCurrentQuestion() else {
                   let message = "Total \u{1F44D} \(quizManager.getğŸ‘())\nTotal \u{1F44E} \(quizManager.getğŸ‘())"
                    let alert = UIAlertController(title: "Product information", message: message, preferredStyle:.Alert)
                    self.presentViewController(alert, animated: true, completion: nil)
                    return
                }

                elapsedTime = 0
                questionLabel.text = quiz.question
                answer1Button.setTitle(quiz.1, forState:.Normal)
                answer2Button.setTitle(quiz.2, forState:.Normal)
                answer3Button.setTitle(quiz.3, forState:.Normal)
        }
    ```

    ä½ ä¼šæ³¨æ„åˆ°æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ Swift 2.0 ä¸­å¼•å…¥çš„æ–°`guard`å…³é”®å­—ã€‚ä½¿ç”¨`guard`å°†å…è®¸ä½ åœ¨ç‰¹å®šæ¡ä»¶æœªæ»¡è¶³æ—¶å®šä¹‰ä¸€ä¸ªé€€å‡ºç­–ç•¥ã€‚è¿™ç¡®å®åœ¨è§£åŒ…å¯é€‰å€¼æ—¶éå¸¸æœ‰ç”¨ï¼›`guard`æ¡ä»¶ä¹‹åçš„ä»£ç å°†åŒ…å«æœªåŒ…è£¹çš„å€¼ï¼ˆæ— ç¼©è¿›å’Œä½œç”¨åŸŸé—®é¢˜ï¼‰ã€‚

1.  è¿˜æœ‰ä¸€äº›ä¸œè¥¿æ˜¯ç¼ºå¤±çš„ï¼Œé‚£å°±æ˜¯è®¡æ—¶å™¨å›è°ƒã€‚è®°ä½ï¼Œæˆ‘ä»¬å¸Œæœ›å‘ç”¨æˆ·æ˜¾ç¤ºä»–è¿˜æœ‰å¤šå°‘æ—¶é—´æ¥å›ç­”é—®é¢˜ï¼Œç„¶åæˆ‘ä»¬å¿…é¡»è·³åˆ°ä¸‹ä¸€ä¸ªé—®é¢˜ã€‚æ­£å¦‚ä½ åœ¨å‰é¢çš„æ–¹æ³•ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œæˆ‘ä»¬è°ƒç”¨äº†ä¸€ä¸ªåä¸º`tick`çš„æ–¹æ³•ï¼›è¿™æ„å‘³ç€æ¯è¿‡ä¸€ç§’ï¼Œæˆ‘ä»¬å¿…é¡»å¢åŠ `elapsedTime`çš„å€¼ï¼Œå½“è®¡æ—¶å™¨ç»“æŸæ—¶ï¼Œæˆ‘ä»¬å°†è®¤ä¸ºé—®é¢˜è¢«é”™è¯¯åœ°å›ç­”äº†ï¼š

    ```swift
        func tick(){
            guard elapsedTime < 12 else {
                    quizManager.answer(0)
                    prepareNextQuestion()
            return
                }

               let baseCharCode = 0x1F550
               timerLabel.text = String(Character(UnicodeScalar(baseCharCode + elapsedTime)))
               elapsedTime++
        }
    ```

1.  å¦‚æœä½ ç°åœ¨æŒ‰æ’­æ”¾ï¼Œä½ å¯ä»¥çœ‹åˆ°åº”ç”¨ç¨‹åºæ­£åœ¨è¿è¡Œï¼Œé™¤äº†ä¸€ä¸ªå°ç»†èŠ‚ã€‚ç”¨æˆ·ä¸èƒ½å›ç­”ï¼æ³¨æ„ï¼Œæ²¡æœ‰æŒ‰é’®åŠ¨ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ·»åŠ å®ƒï¼Œå¹¶ä¸”è®°ä½ä¸€æ—¦ç”¨æˆ·æŒ‰ä¸‹æŒ‰é’®ï¼Œå®ƒå°†è·³åˆ°ä¸‹ä¸€ä¸ªé—®é¢˜ï¼š

    ```swift
        @IBAction func answer(sender: UIButton) {
            var userAnswer:Int
            switch(sender){
            case answerâ‘ Button:
                userAnswer = 1
            case answerâ‘¡Button:
                userAnswer=2
            case answerâ‘¢Button:
                userAnswer=3
            default:
                userAnswer = 0
            }
            quizManager.answer(userAnswer)
            prepareNextQuestion()   
        }
    ```

å¤ªæ£’äº†ï¼Œç°åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ­£åœ¨è¿è¡Œï¼

## å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„â€¦

åœ¨è¿™ä¸ªèœè°±ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ä¸€äº›ä½¿ç”¨ Unicode è¡¨æƒ…å­—ç¬¦çš„æ–¹æ³•ã€‚ç°åœ¨ä½ å¯ä»¥åˆ›å»ºä½ è‡ªå·±çš„ WhatsApp-like ç¨‹åºã€‚æˆ‘ä»¬çœ‹åˆ°äº†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¸¦æœ‰ Unicode å­—ç¬¦çš„å˜é‡åï¼›å¦‚æœä½ æƒ³ï¼Œä½ å¯ä»¥ç”¨æ—¥è¯­ç»™ä½ çš„å˜é‡å‘½åï¼ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨`String(Character(UnicodeScalar(UNICODE_VALUE)))`åˆ›å»ºå¸¦æœ‰ Unicode å€¼çš„å­—ç¬¦ä¸²ï¼Œæˆ–è€…ä½ ä¹Ÿå¯ä»¥ç”¨å®ƒè¿›è¡Œæ’å€¼ï¼Œå¦‚`Total \u{1F44D}`ã€‚

### å°è´´å£«

ä½¿ç”¨ Unicode å­—ç¬¦æ—¶è¦å°å¿ƒï¼›ä½ å¯èƒ½ä¼šè®©å…¶ä»–å›¢é˜Ÿæˆå‘˜çš„ç”Ÿæ´»å˜å¾—å¤æ‚ã€‚è®°ä½ï¼Œå¹¶ä¸æ˜¯æ¯ä¸ªäººéƒ½è®²æ—¥è¯­æˆ–ä¸­æ–‡ï¼Œæœ‰æ—¶ç¬¦å·å¯èƒ½ä¸å…¶ä»–ç¬¦å·ç›¸ä¼¼ã€‚

æˆ‘ä»¬è¿˜äº†è§£åˆ°ï¼Œå¯ä»¥ä»¥åå…­è¿›åˆ¶å½¢å¼ç¼–å†™æ•´æ•°ï¼›åªéœ€è¦æ·»åŠ å‰ç¼€`0x`ã€‚

## è¿˜æœ‰æ›´å¤šâ€¦

å¦‚æœä½ æƒ³çœ‹åˆ°æ›´å¤šçš„ Unicode ç¬¦å·ï¼Œæœ‰ä¸€äº›é¡µé¢å¯ä»¥å¸®åŠ©æˆ‘ä»¬ã€‚æˆ‘æ¨è[`unicode-table.com`](http://unicode-table.com)å’Œ[`www.alanwood.net/demos/wingdings.html`](http://www.alanwood.net/demos/wingdings.html)ã€‚

# æœç´¢å®Œç¾æ•°

ä¿¡ä¸ä¿¡ç”±ä½ ï¼Œè®¡ç®—æœºæœ€åˆæ˜¯ä½œä¸ºå¤§å‹è®¡ç®—å™¨å‡ºç°çš„ï¼Œç›´åˆ°ç°åœ¨ï¼Œå®ƒä»¬çš„ä¸»è¦åŠŸèƒ½æ˜¯è¿›è¡Œå¼ºå¤§çš„è®¡ç®—ã€‚è®©æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„ Swift é¡¹ç›®ä¸­æ·»åŠ ä¸€ç‚¹æ•°å­¦çŸ¥è¯†ï¼Œåˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºæ¥å¯»æ‰¾ç¬¬ä¸€ä¸ªå®Œç¾æ•°å¹¶å°†å…¶æ˜¾ç¤ºç»™ç”¨æˆ·ã€‚

ä½ ç°åœ¨å¯èƒ½æœ‰çš„ä¸»è¦é—®é¢˜æ˜¯ï¼šä»€ä¹ˆæ˜¯å®Œç¾æ•°ï¼Ÿå®Œç¾æ•°æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œå®ƒç­‰äºå…¶å› æ•°çš„å’Œã€‚ä¾‹å¦‚ï¼Œ6 æ˜¯ä¸€ä¸ªå®Œç¾æ•°ï¼Œå› ä¸ºå¦‚æœä½ å°†å…¶å› æ•°ç›¸åŠ ï¼ˆ1 + 2 + 3ï¼‰ï¼Œå…¶ç»“æœæ˜¯ 6ã€‚

åœ¨è¿™ä¸ªèœè°±ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨èŒƒå›´è¿ç®—ç¬¦ã€‚

## å‡†å¤‡å·¥ä½œ

è®©æˆ‘ä»¬ä»åˆ›å»ºä¸€ä¸ªåä¸º`Chapter2 Perfect Number`çš„æ–° Swift é¡¹ç›®å¼€å§‹ã€‚

## å¦‚ä½•æ“ä½œâ€¦

æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æœç´¢å®Œç¾æ•°ï¼š

1.  ç‚¹å‡»æ•…äº‹æ¿å¹¶åˆ›å»ºä¸€ä¸ªç±»ä¼¼äºè¿™é‡Œæ˜¾ç¤ºçš„å¸ƒå±€ï¼š![å¦‚ä½•æ“ä½œâ€¦](img/00029.jpeg)

1.  ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†æ–‡æœ¬å­—æ®µä¸ä»¥ä¸‹å±æ€§é“¾æ¥ï¼š

    ```swift
        @IBOutlet var startText: UITextField!
        @IBOutlet var endText: UITextField!
    ```

1.  å¥½çš„ï¼Œåœ¨æˆ‘ä»¬åˆ›å»ºæŒ‰é’®åŠ¨ä½œä¹‹å‰ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåä¸º`isPerfect`çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†æ£€æŸ¥ä½œä¸ºå‚æ•°ä¼ é€’çš„æ•°å­—æ˜¯å¦ä¸ºå®Œç¾æ•°ã€‚ä¹‹åï¼Œæˆ‘ä»¬å°†åˆ›å»ºæŒ‰é’®åŠ¨ä½œï¼š

    ```swift
        func isPerfect(number:Int) -> Bool {
            var sum = 0
                  (1..<number).forEach { (i) -> () in
              if number % i == 0 {
                  sum += i
              }
           return sum == number
        }

        @IBAction func search(sender: UIButton) {
            var rangeStart:Int = startText.text.toInt()!
            var rangeEnd:Int = endText.text.toInt()!
            for i in rangeStart ... rangeEnd {
                if isPerfect(i){
                  let alert = UIAlertController(title: "Found", message: "\(i) is a perfect number"), preferredStyle:.Alert)
     self.presentViewController(alert, animated: true, completion: nil)

                  return
                }
            }

            let message = "No perfect  number found between \(rangeStart) and \(rangeEnd)"
     let alert = UIAlertController(title: "HTML", message: message, preferredStyle:.Alert)
     self.presentViewController(alert, animated: true, completion: nil)
        }
    ```

## å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„...

å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸¤æ¬¡`for`å¾ªç¯ã€‚ç¬¬ä¸€æ¬¡æˆ‘ä»¬ä½¿ç”¨äº†é—­åŒºé—´è¿ç®—ç¬¦(`â€¦`)ï¼Œå®ƒç”¨äºåŒ…å«æœ€åä¸€ä¸ªæ•°å­—(`rangeEnd`)ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³æ£€æŸ¥ç”¨æˆ·è¾“å…¥çš„æœ€åä¸€ä¸ªæ•°å­—ã€‚

ç¬¬äºŒæ¬¡æˆ‘ä»¬ä½¿ç”¨äº†åŠå¼€åŒºé—´è¿ç®—ç¬¦(`..<`)æ¥æ’é™¤æœ€åä¸€ä¸ªæ•°å­—ï¼Œå› ä¸ºæˆ‘ä»¬ä¸æƒ³å°†æœ€åä¸€ä¸ªæ•°å­—åŒ…å«åœ¨æ€»å’Œå†…ã€‚

### æ³¨æ„

Swift çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¸­ï¼ŒåŠå¼€åŒºé—´è¿ç®—ç¬¦ä»…ç”±ä¸¤ä¸ªç‚¹(`..`)ç»„æˆã€‚ç»è¿‡ä¸€äº›æµ‹è¯•ç‰ˆæœ¬åï¼Œå®ƒè¢«é‡å‘½åä¸º`..<`ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥åœ¨äº’è”ç½‘ä¸Šæ‰¾åˆ°ä¸€äº›ä¸å†å·¥ä½œçš„ä»£ç ã€‚

æ‚¨è¿˜å¯ä»¥åœ¨`switch`è¯­å¥ä¸­ä½¿ç”¨è¿™äº›è¿ç®—ç¬¦ï¼›æœ‰æ—¶å®ƒä»¬éå¸¸æ–¹ä¾¿ï¼Œå°¤å…¶æ˜¯åœ¨æ‚¨ä¸æƒ³ç¼–å†™å…¸å‹çš„ C è¯­è¨€`for`å¾ªç¯æ—¶ã€‚

# æ’åºäº§å“æ•°ç»„

åœ¨è¿™ä¸ªèœè°±ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åœ¨ Swift ä¸­ç®¡ç†æ•°ç»„ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªäº§å“æ•°ç»„ï¼ˆéå¸¸å…¸å‹ï¼‰ï¼Œå‘å…¶ä¸­æ·»åŠ äº§å“ï¼Œåˆ é™¤ä¸å¯ç”¨çš„äº§å“ï¼Œå¹¶æŒ‰ä»·æ ¼æ’åºæ•°ç»„ã€‚

## å‡†å¤‡å·¥ä½œ

åˆ›å»ºä¸€ä¸ªåä¸º`Chapter 2 SortingProduct`çš„æ–° Swift å•è§†å›¾é¡¹ç›®ã€‚

## å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹...

è®©æˆ‘ä»¬æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤åˆ›å»ºå’Œæ’åºäº§å“æ•°ç»„ï¼š

1.  åœ¨æˆ‘ä»¬å¼€å§‹è§†å›¾éƒ¨åˆ†ä¹‹å‰ï¼Œè®©æˆ‘ä»¬åˆ›å»ºåº”ç”¨ç¨‹åºçš„æ¨¡å‹éƒ¨åˆ†ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»º`Product`ç±»ã€‚å› æ­¤ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º`Product.swift`çš„æ–°æ–‡ä»¶ï¼Œå¹¶è¾“å…¥ä»¥ä¸‹ä»£ç ï¼š

    ```swift
    class Product: CustomStringConvertable {
        var name:String
        var price:Double
        var available:Bool

        init(name:String, price:Double, available:Bool){
            self.name = name
            self.price = price
            self.available = available
        }

        var description: String {
            return "\(self.name): \(self.price)Â£ available: \(self.available)"
        }
    }
    ```

1.  å¦‚æ‚¨æ‰€è§ï¼Œè¿™ä¸ªç±»çš„æƒ³æ³•æ˜¯åˆ›å»ºå…·æœ‰å…¶åç§°ã€ä»·æ ¼å’Œå¯ç”¨æ€§çš„å¯¹è±¡ã€‚æˆ‘ä»¬è¿˜ä»`CustomStringConvertable`ç»§æ‰¿ï¼Œä»¥åˆ©ç”¨å…¶`description`å±æ€§ã€‚

1.  ç°åœ¨ï¼Œæ‚¨å¯ä»¥åœ¨æ•…äº‹æ¿ä¸­ç‚¹å‡»å¹¶æ·»åŠ ä¸¤ä¸ªæ ‡ç­¾ï¼Œä¸€ä¸ªç”¨äºå®Œæ•´ç›®å½•ï¼Œè¿™æ„å‘³ç€å®ƒå°†æŒ‰åŸå§‹é¡ºåºæ˜¾ç¤ºæ¯ä¸ªäº§å“ï¼Œæ— è®ºå…¶ä»·æ ¼å¦‚ä½•æˆ–æ˜¯å¦å¯ç”¨ã€‚

1.  å¦ä¸€ä¸ªæ ‡ç­¾å°†æ˜¾ç¤ºç›¸åŒçš„äº§å“ï¼Œä½†æ ¹æ®å¯ç”¨æ€§è¿›è¡Œè¿‡æ»¤å¹¶æŒ‰ä»·æ ¼æ’åºã€‚å› æ­¤ï¼Œç°åœ¨å°†æ‚¨çš„æ ‡ç­¾ä¸ä»¥ä¸‹å±æ€§é“¾æ¥ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªäº§å“æ•°ç»„å±æ€§ï¼š

    ```swift
        var products:[Product] = [] // this is our catalog
        @IBOutlet var catalogLabel: UILabel!
        @IBOutlet var availableLabel: UILabel!
    ```

1.  å¦‚æœæ‚¨æƒ³äº†è§£å®ƒä»¬çš„å«ä¹‰ï¼Œå¯ä»¥åˆ›å»ºé¢å¤–çš„æ ‡ç­¾ã€‚æˆ‘åˆ›å»ºäº†ä¸€ä¸ªæ ‡é¢˜ä¸º`Catalog`çš„æ ‡ç­¾ï¼Œå¦ä¸€ä¸ªæ ‡é¢˜ä¸º`Available Products`çš„æ ‡ç­¾ã€‚åœ¨`catalogLabel`å’Œ`availableLabel`ä¸Šè®¾ç½®æ–°çš„è¡Œæ•°ä¹Ÿå¾ˆé‡è¦ï¼›å¦åˆ™ï¼Œå®ƒå°†åªæ˜¾ç¤ºç¬¬ä¸€ä¸ªäº§å“ã€‚

1.  ä¸‹ä¸€æ­¥æ˜¯åˆ›å»ºåˆå§‹åŒ–ï¼›åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åªéœ€è¦å‘æˆ‘ä»¬çš„æ•°ç»„ä¸­æ·»åŠ ä¸€äº›äº§å“ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œäº§å“å°†æ˜¯ç¡¬ç¼–ç çš„ï¼Œä½†åœ¨å®é™…åº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬åº”è¯¥ä»æ•°æ®åº“æˆ–äº’è”ç½‘ä¸Šæ£€ç´¢å®ƒä»¬ï¼š

    ```swift
    required init(coder aDecoder: NSCoder) {
        super.init(coder: aDecoder)
        products.append(Product(name: "Shirt", price: 19, available: true))
        products.append(Product(name: "Socks", price: 1.99, available: true))
        products.append(Product(name: "Trousers", price: 22.50, available: false))
        products.append(Product(name: "T-Shirt", price: 10, available: true))
        products.append(Product(name: "Shoes", price: 32.20, available: false))
        products.append(Product(name: "Women shoes", price: 54, available: true))
        products.append(Product(name: "Men underwear", price: 9.99, available: true))
        products.append(Product(name: "Bra", price: 12.5, available: true))
        products.append(Product(name: "Panty", price: 4.45, available: true))
        products.append(Product(name: "Tennis shoes", price: 27, available: false))
    }
    ```

1.  åœ¨æ­¤ä¹‹åï¼Œå½“è§†å›¾åŠ è½½å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾ç¤ºæˆ‘ä»¬çš„ç›®å½•ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ä½¿ç”¨æˆ‘ä»¬çš„`catalog`æ ‡ç­¾ï¼š

    ```swift
        override func viewDidLoad() {
            super.viewDidLoad()
      let descriptions = products.map{$0.description}
      let labelText = descriptions.joinWithSeperator("")
            catalogLabel.text = labelText
        }
    ```

1.  å¥½çš„ï¼Œç°åœ¨æ˜¯æˆ‘ä»¬æ·»åŠ æŒ‰é’®å¹¶åˆ›å»ºå…¶åŠ¨ä½œçš„æ—¶å€™äº†ï¼š

    ```swift
        @IBAction func showAvailableProducts(sender: UIButton) {
            var availableProducts = products.filter { (product:Product) -> Bool in
                return product.available
            }
            availableProducts.sort(<) 
      let descriptions = availableProducts.map{$).description}
      let labelText = descriptions.joinWithSeperator(" ") 

            availableLabel.text = labelText
        }
    ```

åº”ç”¨ç¨‹åºå·²å®Œæˆï¼›ä¸€æ—¦ä½ ç‚¹å‡»æŒ‰é’®ï¼Œä½ å°†çœ‹åˆ°ç±»ä¼¼äºè¿™é‡Œæ‰€ç¤ºçš„ç»“æœï¼š

![å¦‚ä½•åšâ€¦](img/00030.jpeg)

## å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„â€¦

Swift ä¸­çš„æ•°ç»„ä¸ Objective-C ä¸­çš„å¯å˜æ•°ç»„éå¸¸ç›¸ä¼¼ï¼›å®ƒä»¬å¯ä»¥æ·»åŠ å¯¹è±¡ã€åˆ é™¤å¯¹è±¡ç­‰ç­‰ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›åŒºåˆ«ã€‚åœ¨ Swift ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œä½ å¿…é¡»æŒ‡å®šæ•°ç»„åŒ…å«çš„å¯¹è±¡ç±»å‹ï¼Œå°±åƒæˆ‘ä»¬åœ¨æ‹¬å·ä¸­å†™ç±»å‹æ—¶åšçš„é‚£æ ·ã€‚

### å°è´´å£«

ä½ å¯ä»¥åˆ›å»ºä»»ä½•ç±»å‹çš„å¯¹è±¡æ•°ç»„ï¼Œå°±åƒæˆ‘ä»¬ä»¥å‰åœ¨ Objective-C ä¸­åšçš„é‚£æ ·ï¼Œé€šè¿‡å£°æ˜ä¸€ä¸ªå˜é‡ä¸º`[AnyObject]`ã€‚ç„¶è€Œï¼Œå¦‚æœè¿™ä¸æ˜¯å¿…è¦çš„ï¼Œåº”è¯¥é¿å…è¿™æ ·åšã€‚è¿˜æœ‰ä½¿ç”¨`NSArray`è€Œä¸æ˜¯`Array`çš„å¯èƒ½æ€§ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†æ‹¥æœ‰ä¸ Objective-C ç›¸åŒçš„å‡½æ•°ã€‚

ä½ ä¹Ÿå¯ä»¥åœ¨`viewDidLoad`æ–¹æ³•ä¸­çœ‹åˆ°ä¸€äº›æ–°çš„å†…å®¹ï¼›æˆ‘ä»¬è°ƒç”¨äº†ä¸€ä¸ªåä¸º`map`çš„é—­åŒ…ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æˆ‘ä»¬ç›®å½•ä¸­æ¯ä¸ªäº§å“çš„å¤§å­—ç¬¦ä¸²ï¼Œæ¯ä¸ªäº§å“ç”±ä¸€ä¸ªæ¢è¡Œç¬¦ï¼ˆ`\n`ï¼‰åˆ†éš”ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¿…é¡»å°†æˆ‘ä»¬çš„`Product`æ•°ç»„è½¬æ¢ä¸º`String`æ•°ç»„ã€‚`map`å‡½æ•°å¸®åŠ©æˆ‘ä»¬åšåˆ°è¿™ä¸€ç‚¹ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œè¯¥å‡½æ•°å°†æ¯ä¸ªå…ƒç´ è½¬æ¢ä¸ºæ‰€éœ€çš„æ–°ç±»å‹ã€‚

å¦ä¸€ä¸ªæ–°å‡½æ•°æ˜¯`filter`å‡½æ•°ï¼›è¿™ä¸ªå‡½æ•°æ¥æ”¶å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚å¦‚æœè¿”å›çš„å€¼æ˜¯ trueï¼Œè¿™æ„å‘³ç€å½“å‰å…ƒç´ æ˜¯æœ‰æ•ˆçš„ï¼Œä¸åº”è¯¥è¢«è¿‡æ»¤ï¼›å¦‚æœè¿”å›çš„å€¼æ˜¯ falseï¼Œå½“ç„¶æ–°çš„æ•°ç»„å°†ä¸åŒ…å«è¿™ä¸ªå…ƒç´ ã€‚

æœ€åä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬æœ‰`sort`å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¸ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼›å®ƒä¿®æ”¹å½“å‰çš„æ•°ç»„ã€‚è€ƒè™‘è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„ç±»æ•°ç»„ï¼Œè¿™æ˜¯ç¼–è¯‘å™¨ä¸çŸ¥é“å¦‚ä½•æ’åºçš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¿…é¡»å‘Šè¯‰è¿™ä¸ªå‡½æ•°ä½•æ—¶ä¸¤ä¸ªå¯¹è±¡æ˜¯æœ‰åºçš„ï¼Œä½•æ—¶ä¸æ˜¯ã€‚

### å°è´´å£«

ä½¿ç”¨ä¿®æ”¹æ•°ç»„çš„å‡½æ•°æ—¶è¦å°å¿ƒï¼›ä¸€æ—¦å®Œæˆï¼Œå°±æ— æ³•å›æ»šã€‚

## è¿˜æœ‰æ›´å¤š...

å£°æ˜æ•°ç»„æœ‰ä¸¤ç§æ–¹å¼ï¼Œå…¶ä¸­ä¸€ç§æ˜¯æˆ‘ä»¬ä½¿ç”¨æ‹¬å·çš„æ–¹å¼ï¼Œå¦ä¸€ç§å£°æ˜æ•°ç»„çš„æ–¹å¼æ˜¯ä½¿ç”¨`Array<Product>`ã€‚å®ƒä»¬æ²¡æœ‰åŒºåˆ«ï¼›å®ƒä»¬åˆ›å»ºç›¸åŒç±»å‹çš„å¯¹è±¡ã€‚åœ¨ä¸¤ç§æƒ…å†µä¸‹ï¼Œä½ éƒ½ä¸èƒ½ä»è¿™ä¸ªç±»å‹ç»§æ‰¿ã€‚

### å°è´´å£«

Swift ä¸­æ•°ç»„çš„å£°æ˜æœ€åˆæ˜¯`Type[]`ï¼Œç„¶åè¢«æ›¿æ¢ä¸º`[Type]`ã€‚

æœ‰æ›´å¤šæ•°ç»„å‡½æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ“ä½œæ•°ç»„ï¼Œä¾‹å¦‚`reduce`ã€`reverse`æˆ–`removeRange`ã€‚å¦‚æœä½ ä¸ NoSQL æ•°æ®åº“åˆä½œè¿‡ï¼Œä½ å¯èƒ½å·²ç»ä¹ æƒ¯äº†è¿™ç±»å‡½æ•°ã€‚ä½ è¿˜å¯ä»¥åˆ›å»ºä¸€ä¸ªæ•°ç»„æ‰©å±•ï¼Œä»¥ä½ è‡ªå·±çš„æ–¹å¼æ“ä½œæ•°ç»„ã€‚

# å¯»æ‰¾å‡ºè·¯çš„æ–¹æ³•

åœ¨è¿™ä¸ªèœè°±ä¸­ï¼Œä½ å°†äº†è§£å…ƒç»„ã€‚è¿™ç§æ–°ç±»å‹åœ¨ Objective-C ä¸­ä¸å­˜åœ¨ï¼Œåœ¨ Swift ä¸­éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦è¿”å›å¤šä¸ªå€¼æ—¶ã€‚ä¾‹å¦‚ï¼Œæœ‰å¾ˆå¤šå‡½æ•°éœ€è¦è¿”å›ä¸€ä¸ªå€¼å’Œä¸€ä¸ªé”™è¯¯ä»£ç ã€‚åœ¨å…¶ä»–è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸è¿”å›å€¼ï¼Œè€Œé”™è¯¯å€¼ä½œä¸ºå‚æ•°è¿”å›ã€‚

ä½ è¿˜å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨äºŒç»´æ•°ç»„ï¼Œåœ¨ Objective-C ä¸­è¿™è¦å¤æ‚å¾—å¤šã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æšä¸¾ç±»å‹çš„æ•°ç»„ã€‚

å› æ­¤ï¼Œè¿™æ¬¡æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå®ƒå°†æ‰¾åˆ°è¿·å®«çš„å‡ºå£ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¸ä¼šæµªè´¹æ—¶é—´è®¾è®¡è¿·å®«ï¼›æˆ‘ä»¬å°†ç»“æœå±•ç¤ºåœ¨æ–‡æœ¬è§†å›¾ä¸­ã€‚

## å‡†å¤‡å·¥ä½œ

åˆ›å»ºä¸€ä¸ªæ–°çš„ Swift å•è§†å›¾é¡¹ç›®ï¼Œå‘½åä¸º `Chapter 2 Maze`ã€‚

## å¦‚ä½•æ“ä½œ...

1.  é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºè¿™ä¸ªè¿·å®«çš„æ¨¡å‹éƒ¨åˆ†ã€‚å¯¹æˆ‘ä»¬æ¥è¯´ï¼Œè¿·å®«æ˜¯ä¸€ä¸ªæœ‰å››ç§ä¸åŒå¯èƒ½æ€§çš„æ•°ç»„ï¼šæˆ‘ä»¬ä¸èƒ½ç©¿è¿‡çš„å¢™å£ï¼Œæˆ‘ä»¬å¯ä»¥ç©¿è¿‡çš„é€šé“ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å‡ºå£ï¼Œä»¥åŠå·²ä½¿ç”¨ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å·²ç»ä½¿ç”¨è¿‡è¿™æ¡è·¯å¾„ï¼Œæ‰€ä»¥ä¸åº”è¯¥å†æ¬¡ä½¿ç”¨å®ƒï¼›è¿™å°†é˜²æ­¢æˆ‘ä»¬ç»•åœˆå­èµ°ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬é¦–å…ˆè¦åšçš„æ˜¯åˆ›å»ºä¸€ä¸ªåä¸º `Maze` çš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

    ```swift
    enum BlockType{
        case AISLE,
             WALL,
             USED,
             WAYOUT
    }
    ```

1.  åœ¨æˆ‘ä»¬å¼€å§‹å®ç° `maze` ç±»ä¹‹å‰ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç±»å‹æ¥å­˜å‚¨è¿·å®«çš„ä¸€ä¸ªåæ ‡ï¼Œå¦ä¸€ä¸ªç±»å‹æ¥çŸ¥é“è·¯å¾„æ˜¯å¦æ‰¾åˆ°ï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œæˆ‘ä»¬åº”è¯¥æœ‰æ‰¾åˆ°çš„è·¯å¾„ï¼š

    ```swift
    typealias Position = (x: Int, y:Int)
    typealias Way = (found: Bool, way: [Position])
    ```

1.  å¥½çš„ï¼Œç°åœ¨æ˜¯æˆ‘ä»¬åˆ›å»ºæˆ‘ä»¬çš„ç±»çš„æ—¶å€™äº†ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªäºŒç»´æ•°ç»„æ¥è¡¨ç¤ºè¿·å®«ï¼Œå¦ä¸€ä¸ªæ•°ç»„å°†åŒ…å«é€šå¾€å‡ºå£çš„è·¯å¾„ï¼Œä»¥åŠä¸¤ä¸ªå±æ€§æ¥çŸ¥é“è¿·å®«çš„å®½åº¦å’Œé«˜åº¦ï¼š

    ```swift
    class Maze{
        private var maze:[[BlockType]] = []
        private lazy var stack:[Position] = []
        private var width: Int
        private var height: Int
    ```

1.  æˆ‘ä»¬å°†è¦åˆ›å»ºçš„ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯åˆå§‹åŒ–å™¨ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæŒ‡å®šå…¶å¤§å°çš„è¿·å®«ã€‚å½“æˆ‘ä»¬åˆ›å»ºäºŒç»´æ•°ç»„æ—¶ï¼Œæˆ‘ä»¬å°†ç”¨ `AISLE` å¡«å……å®ƒï¼›ä¸ºäº†åˆ›å»ºå¢™å£ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç¨ååˆ›å»ºçš„å¦ä¸€ä¸ªæ–¹æ³•ï¼š

    ```swift
        init(width: Int, height: Int){
            self.width = width
            self.height = height
            for _ in 1...height{
                var row:[BlockType] = []
                for _ in 1...width{
                    row.append(.AISLE)
                }
                maze.append(row)
            }
        }
    ```

1.  ç°åœ¨æˆ‘ä»¬éœ€è¦åˆ›å»ºåˆ›å»ºå¢™å£å’Œå‡ºå£çš„æ–¹æ³•ã€‚åœ¨æ›´å®Œæ•´çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥æ£€æŸ¥ä½ç½®æ˜¯å¦æœ‰æ•ˆï¼Œä½†åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šçº ç»“äºæ¯ä¸€ä¸ªç»†èŠ‚ã€‚æ‰€ä»¥ï¼Œè¿™é‡Œæœ‰ä¸€äº›æ–¹æ³•ï¼š

    ```swift
        func addWall(position: Position) {
            maze[position.y][position.x] = .WALL
        }

        func setWayout(position: Position){
            maze[position.y][position.x] = .WAYOUT
        }
    ```

1.  ä¸‹ä¸€ä¸ªæ“ä½œæ˜¯åˆ›å»ºä¸»æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†å°è¯•æ‰¾å‡ºä¸€ç§ä»è¿·å®«ä¸­é€€å‡ºçš„æ–¹æ³•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¨‹åºå‘˜ä¸åº”è¯¥ç»™å‡ºèµ·ç‚¹ï¼Œå› æ­¤è¿™ä¸ªæ–¹æ³•å°†æ²¡æœ‰å‚æ•°ï¼Œä½†æˆ‘ä»¬éœ€è¦åœ¨è¿·å®«ä¸­è¡Œèµ°ã€‚ç„¶è€Œï¼Œæƒ³æ³•æ˜¯åˆ›å»ºä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†æ¥æ”¶ä¸€ä¸ªæ–°çš„ä½ç½®å¹¶å¯»æ‰¾ä¸‹ä¸€ä¸ªä½ç½®ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆç¬¬äºŒä¸ªå‡½æ•°æ˜¯ç§æœ‰çš„ï¼š

    ```swift
        func findWayOut() -> Way{
            self.initStack()
            return self.next((0,0))
        }

        private func next(position: Position) -> Way {

            stack.append(position)
            if self.maze[position.y][position.x] == .WAYOUT {
                return (true, self.stack)
            }

            maze[position.y][position.x] = .USED

            // UP
            if position.y > 0 && (maze[position.y-1][position.x] == .AISLE || maze[position.y-1][position.x] == .WAYOUT)
            {
                let result = next((position.x, position.y-1))
                if result.found {
                    maze[position.y][position.x] = .AISLE
                    return result
                }
            }

            // LEFT
            if position.x > 0 && (maze[position.y][position.x-1] == .AISLE || maze[position.y][position.x-1] == .WAYOUT)
            {
                let result = next((position.x-1, position.y))
                if result.found {
                    maze[position.y][position.x] = .AISLE
                    return result
                }
            }

            // DOWN
            if position.y+1 < self.height && (maze[position.y+1][position.x] == .AISLE || maze[position.y+1][position.x] == .WAYOUT)
            {
                let result = next((position.x, position.y+1))
                if result.found {
                    maze[position.y][position.x] = .AISLE
                    return result
                }
            }

            // RIGHT
            if position.x+1 < self.width && (maze[position.y][position.x+1] == .AISLE || maze[position.y][position.x+1] == .WAYOUT)
            {
                let result = next((position.x+1, position.y))
                if result.found {
                    maze[position.y][position.x] = .AISLE
                    return result
                }
            }

            maze[position.y][position.x] = .AISLE
            stack.removeLast()

            return (false, [])
        }

        private func initStack(){
            stack = []
        }
    }
    ```

    ### æ³¨æ„

    ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼ŒSwift æœ‰æ‡’åŠ è½½ã€‚è¿™æ˜¯ä¸€ä»¶å¥½äº‹ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¿…åœ¨æ£€æŸ¥ä½ç½®æ˜¯å¦åœ¨æ•°ç»„è¾¹ç•Œå†…æ—¶åˆ›å»ºåµŒå¥—çš„ `if` å‡½æ•°ã€‚

1.  ç°åœ¨æ˜¯æ—¶å€™å®Œæˆæˆ‘ä»¬çš„ç¤ºä¾‹äº†ã€‚è½¬åˆ°æ•…äº‹æ¿ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ ä¸€ä¸ªæ–‡æœ¬è§†å›¾å’Œä¸€ä¸ªæŒ‰é’®ã€‚å°†æ–‡æœ¬è§†å›¾ä¸ä½ çš„ä»£ç é“¾æ¥ï¼Œå‘½åä¸º `textView`ã€‚ç„¶åï¼Œä¸ºä½ çš„æŒ‰é’®åˆ›å»ºä¸€ä¸ªåŠ¨ä½œï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

    ```swift
        @IBAction func findWayOut(sender: UIButton) {
            var resultString = ""
            var maze = Maze(width: 8, height: 5)
            maze.setWayout((7,4))
            maze.addWall((1,0))
            maze.addWall((1,1))
            maze.addWall((1,2))
            maze.addWall((1,4))
            maze.addWall((3,0))
            maze.addWall((3,1))
            maze.addWall((3,3))
            maze.addWall((4,3))
            maze.addWall((5,1))
            maze.addWall((5,3))
            maze.addWall((6,1))
            maze.addWall((6,3))
            maze.addWall((6,4))
            maze.addWall((7,1))
            let (found:Bool, way:[Position]) = maze.findWayOut()
            if found {
                for position in way {
                    resultString+= "(\(position.x),\(position.y)) \n"
                }
            }else{
                resultString+="No path found"
            }
            textView.text = resultString
        }
    ```

## å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„â€¦

è®¸å¤šä»£ç éœ€è¦ä¸€äº›è§£é‡Šã€‚è®©æˆ‘ä»¬ä»å¼€å§‹è®²èµ·ã€‚æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«å››ä¸ªå¯èƒ½å€¼çš„æšä¸¾ã€‚ä½¿ç”¨æšä¸¾æ¯”ä½¿ç”¨æ•´æ•°æˆ–å­—ç¬¦ä¸²æ›´å¥½ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥é˜²æ­¢ä½¿ç”¨ä¸å­˜åœ¨çš„å€¼ã€‚

åœ¨æ­¤ä¹‹åï¼Œæˆ‘ä»¬å£°æ˜äº†ä¸¤ä¸ªç±»å‹åˆ«åï¼›è¿™ä¸ªæŒ‡ä»¤çš„æƒ³æ³•æ˜¯å°†ç±»å‹é‡å‘½åï¼Œå°±åƒæˆ‘ä»¬ä¹‹å‰å¯¹ `Position` å’Œ `Way` åšçš„é‚£æ ·ã€‚è¿™ä¸ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å‹ï¼Œä½†æœ‰åŠ©äºæˆ‘ä»¬åœ¨è½¯ä»¶ç»´æŠ¤æ–¹é¢ï¼›ä¾‹å¦‚ï¼Œå¦‚æœä½ ä½¿ç”¨ä¸€ä¸ªå¯èƒ½è¢«æ›´æ”¹ä¸ºåŒç²¾åº¦æµ®ç‚¹æ•°æ•°ç»„çš„æ•´æ•°æ•°ç»„ï¼Œä½¿ç”¨ `typealias` æ¯”æ›¿æ¢æ¯ä¸ªå£°æ˜ä¸º `[Double]` æ›´å¥½ã€‚è¿™ä¸ªç‰¹æ€§ä¸ C ç¼–ç¨‹è¯­è¨€ä¸­çš„ `typedef` ç›¸å½“ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬è°ˆè°ˆå±æ€§ã€‚ç¬¬ä¸€ä¸ªå±æ€§ä¸æ˜¯å¯é€‰çš„ï¼Œå®ƒä½äºåŒæ‹¬å·å†…ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ã€‚é€šå¸¸ï¼Œæ ¹æ®äººç±»çš„å®šä¹‰ï¼Œæˆ‘ä»¬è¯´æ•°ç»„çš„ç¬¬ä¸€ä¸ªç»´åº¦æ˜¯è¡Œï¼Œç¬¬äºŒä¸ªæ˜¯åˆ—ã€‚

å½“æˆ‘ä»¬è°ˆè®ºä½ç½®æ—¶ï¼Œä¾‹å¦‚ï¼Œåœ¨ç¬›å¡å°”å¹³é¢ä¸Šï¼Œæˆ‘ä»¬å°† `x` ç§°ä¸ºåˆ—ï¼Œå°† `y` ç§°ä¸ºè¡Œï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä½ ä¼šçœ‹åˆ° `y` åæ ‡åœ¨ `x` å‰é¢çš„åŸå› ï¼Œä¾‹å¦‚ `maze[position.y][position.x+1] == .AISLE`ã€‚

æ ˆä¹Ÿæ˜¯ä¸€ä¸ªéå¯é€‰å±æ€§ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦ nil å€¼ï¼Œä½†è¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»ç”¨æŸäº›ä¸œè¥¿æ¥åˆå§‹åŒ–å®ƒã€‚ç”±äºæˆ‘ä»¬æ¯æ¬¡è°ƒç”¨ `findWayOut` æ—¶éƒ½ä¼šåˆå§‹åŒ–å®ƒï¼Œç¬¬ä¸€æ¬¡åˆå§‹åŒ–å°†ä¼šä¸¤æ¬¡ï¼šä¸€æ¬¡åœ¨åˆå§‹åŒ–å™¨ä¸­ï¼Œå¦ä¸€æ¬¡åœ¨å‡½æ•°å†…éƒ¨ã€‚ä¸ºäº†é˜²æ­¢è¿™ç§åŒé‡åˆå§‹åŒ–ï¼Œæˆ‘ä»¬å°†æ·»åŠ  `lazy` ä¿®é¥°ç¬¦ï¼Œè¿™æ„å‘³ç€å®ƒåªåº”è¯¥åœ¨å˜é‡ç¬¬ä¸€æ¬¡è¢«è¯»å–ä¸”ä¹‹å‰æœªåˆå§‹åŒ–æ—¶ï¼Œä½¿ç”¨å£°æ˜ä¸­ç›¸åŒçš„å€¼è¿›è¡Œåˆå§‹åŒ–ã€‚

### æ³¨æ„

åœ¨ Swift çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¸­ï¼Œå®ƒæ›¾ç»æ˜¯ `@lazy` è€Œä¸æ˜¯ä»…ä»… `lazy`ã€‚

è®©æˆ‘ä»¬è°ˆè°ˆåˆå§‹åŒ–å™¨ï¼›è¦åˆ›å»ºä¸€ä¸ªè¿·å®«ï¼Œå¿…é¡»æ¥æ”¶å®½åº¦å’Œé«˜åº¦ä½œä¸ºå‚æ•°ã€‚ç”±äºå‚æ•°ä¸å±æ€§å…·æœ‰ç›¸åŒçš„åç§°ï¼Œå› æ­¤æœ‰å¿…è¦åŒºåˆ†å®ƒä»¬ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå±æ€§è¢«ç§°ä¸º `self.width` å’Œ `self.height`ï¼Œè€Œå‚æ•°è¢«ç§°ä¸º `width` å’Œ `height`ã€‚

ä¸‹ä¸€æ­¥æ˜¯é€šé…ç¬¦è¡¨è¾¾å¼ï¼Œè¿™æ„å‘³ç€ `for` å¾ªç¯çš„å½“å‰å€¼æ²¡æœ‰è¢«ä½¿ç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸æ˜¯å°†å…¶åˆ†é…ç»™ä¸€ä¸ªå˜é‡ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚è¯·æ³¨æ„ï¼Œä¸‹åˆ’çº¿åœ¨ä¸¤ä¸ªå¾ªç¯ä¸­éƒ½ä½¿ç”¨ï¼Œå¹¶ä¸”å†…å¾ªç¯ä¸ä¼šå½±å“å¤–å¾ªç¯ï¼Œåä¹‹äº¦ç„¶ã€‚

åˆ›å»ºæ•°ç»„è¿˜æœ‰å¦ä¸€ç§åªåœ¨ä¸€è¡Œä¸­å®Œæˆçš„æ–¹æ³•ï¼›è¿™åº”è¯¥æ›´åŠ é«˜æ•ˆï¼Œå› ä¸ºå½“ä½ åˆ›å»ºå…·æœ‰å®¹é‡çš„æ•°ç»„æ—¶ï¼Œå®ƒä¸é€ä¸ªæ·»åŠ æ¯ä¸ªå…ƒç´ æ˜¯ä¸åŒçš„ã€‚å°è¯•ç”¨è¿™è¡Œä»£ç æ›¿æ¢ä¸¤ä¸ª `for` å¾ªç¯ï¼š

```swift
maze = [[BlockType]](count: height, repeatedValue: BlockType)
```

æ¥ä¸‹æ¥çš„ä¸¤ä¸ªæ–¹æ³•éå¸¸ç›¸ä¼¼ï¼Œä½†ä¸€ä¸ªæœ‰å‰ç¼€ `add`ï¼Œå¦ä¸€ä¸ªæœ‰å‰ç¼€ `set`ã€‚è¿™åªæ˜¯ä¸ºäº†è½¯ä»¶ç»´æŠ¤ï¼›æˆ‘ä»¬å¯ä»¥æœ‰å¾ˆå¤šå¢™å£ï¼Œä½†åªæœ‰ä¸€ä¸ªå‡ºå£ã€‚åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰æ£€æŸ¥å®ƒï¼Œä½†å°†æ¥åº”è¯¥è¿›è¡Œæ£€æŸ¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸æ˜¯ä½¿ç”¨è®¾ç½®å™¨ï¼Œè€Œæ˜¯å¯ä»¥ä½¿ç”¨å±æ€§ã€‚

è¿˜æœ‰ä¸€ç‚¹è¦è¡¥å……çš„æ˜¯ï¼Œå½“å±æ€§è¢«åˆ†é…æ—¶ï¼Œæ²¡æœ‰å¿…è¦æŒ‡å®šæšä¸¾ç±»å‹ï¼Œä¾‹å¦‚ `BlockType.WALL`ï¼Œåªéœ€æŒ‡å®šå…¶å€¼ï¼Œä¾‹å¦‚ï¼Œ`.WALL`ã€‚åŸå› æ˜¯ Swift çŸ¥é“åˆ†é…çš„ç±»å‹ï¼Œå¹¶ä¸”å¯ä»¥çœç•¥ã€‚

ç„¶åï¼Œæˆ‘ä»¬æœ‰å°†ç”¨äºæ‰¾åˆ°å‡ºå£çš„æ–¹æ³•ã€‚å®ƒåªåˆå§‹åŒ–æ ˆä»¥ç¡®ä¿å®ƒæ˜¯ä¸€ä¸ªç©ºæ•°ç»„ï¼Œç„¶åè°ƒç”¨ `next` å‡½æ•°ã€‚è¯·æ³¨æ„ï¼Œè¿™çœ‹èµ·æ¥åƒæˆ‘ä»¬æœ‰ä¸€ä¸ªåŒåœ†æ‹¬å·å‡½æ•°ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ï¼Œæˆ‘ä»¬æ­£åœ¨å°†ä¸€ä¸ªå…ƒç»„ä½œä¸ºå‚æ•°ä¼ é€’ã€‚

å…ƒç»„ç±»ä¼¼äºå›ºå®šå¤§å°çš„æ•°ç»„ã€‚åˆ›å»ºå®ƒæ—¶ï¼Œä½¿ç”¨åœ†æ‹¬å·è€Œä¸æ˜¯æ–¹æ‹¬å·ã€‚Swift ä¸­å…ƒç»„çš„ä¸€ä¸ªæœ‰è¶£ç‰¹æ€§æ˜¯ä½ å¯ä»¥åƒå­—å…¸æˆ–å¯¹è±¡ä¸€æ ·å‘½åå€¼ã€‚å› æ­¤ï¼Œä½ å¯ä»¥é€‰æ‹©å°†å…ƒç»„åˆ›å»ºä¸º `(0,0)` æˆ– `(x:0, y:0)`ã€‚åœ¨åƒ `Way` ç±»å‹è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œå…¶ä¸­å…ƒç´ æœ‰ä¸åŒçš„å«ä¹‰ï¼Œæˆ‘å»ºè®®ä½ å‘½åè¿™äº›å€¼ï¼›å¦åˆ™ï¼Œå¦‚æœæœ‰ä¸€ä¸ªé€šå¾€å‡ºå£çš„è·¯å¾„ï¼Œæˆ–è€…ç¬¬äºŒä¸ªå…ƒç´ ä»£è¡¨è·¯å¾„æœ¬èº«ï¼Œé‚£ä¹ˆå¾ˆéš¾è®°ä½ç¬¬ä¸€ä¸ªä½ç½®ä¸Šçš„å…ƒç´ ä»£è¡¨ä»€ä¹ˆã€‚

è¿˜è¦æ³¨æ„ï¼Œå½“ `findWayOut` æ–¹æ³•è¿”å›å…¶å€¼æ—¶ï¼ŒæŸ¥çœ‹è§†å›¾æ§åˆ¶å™¨ã€‚è¿™çœ‹èµ·æ¥åƒå®ƒä»¬è¢«åˆ†é…ç»™ä¸€ä¸ªå…ƒç»„ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ï¼Œå®ƒä»¬è¢«åˆ†é…ç»™ä¸¤ä¸ªå˜é‡ï¼›è¿™æ˜¯æˆ‘ä»¬åœ¨ C æˆ– Objective-C ä¸Šæ²¡æœ‰çš„ç‰¹æ€§ã€‚è¿™æ„å‘³ç€å¦‚æœä½ æƒ³è¦äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼ï¼Œä½ åªéœ€ä½¿ç”¨ä¸€ä¸ªè¯­å¥ï¼Œä¾‹å¦‚ `(var1, var2) = (var2, var1)`ï¼Œè€Œä¸éœ€è¦åˆ›å»ºä»»ä½•è¾…åŠ©å˜é‡ï¼Œå°±åƒæˆ‘ä»¬åœ¨ Objective-C ä¸Šæ‰€åšçš„é‚£æ ·ã€‚

åœ¨è¿™ä¸ªèœè°±ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•°ç»„ä½œä¸ºæ ˆæ¥å­˜å‚¨æˆ‘ä»¬å·²ç»èµ°è¿‡çš„è·¯å¾„ï¼Œå¹¶ä½¿ç”¨ `removeLast` æ–¹æ³•è¿”å›ä¸€æ­¥ï¼Œå°±åƒæˆ‘ä»¬æœ‰ä¸€äº›é¢åŒ…å±‘ä¸€æ ·ï¼Œè¿™æ˜¯æ‰¾åˆ°å‡ºå£çš„ç§˜å¯†ã€‚æˆ‘ä»¬åªéœ€è¦éµå¾ªä¸€æ¡è·¯å¾„ï¼Œå¦‚æœæˆ‘ä»¬è¿·è·¯äº†ï¼Œæˆ‘ä»¬åªéœ€è¦æ”¶é›†é¢åŒ…å±‘å¹¶å°è¯•å¦ä¸€æ¡ã€‚

åœ¨æ‰¾åˆ°ç›®æ ‡åï¼Œç”¨æˆ·å°†çœ‹åˆ°å¦‚ä¸‹æˆªå›¾æ‰€ç¤ºçš„è·¯å¾„ï¼š

![å¦‚ä½•å·¥ä½œâ€¦](img/00031.jpeg)

## è¿˜æœ‰æ›´å¤š...

Swift ä¸­çš„å…ƒç»„å¯ä»¥ç”¨ä¸åŒçš„æ–¹å¼ä½¿ç”¨ï¼›å®ƒä»¬åœ¨æŸäº› `switch` æƒ…å†µä¸‹ä¹Ÿéå¸¸æœ‰ç”¨ï¼›ç„¶è€Œï¼Œä¸è¦å°è¯•ç”¨å…ƒç»„æ›¿æ¢å­—å…¸æˆ–æ•°ç»„ï¼Œæ¯ç§ç±»å‹éƒ½æœ‰è‡ªå·±çš„åŠŸèƒ½ã€‚

### æ³¨æ„

Swift 1.2 å¼•å…¥äº†ä¸€ç§ç§°ä¸º `Set` çš„æœ¬åœ°ç±»å‹ï¼Œå®ƒæ‰§è¡Œè¿™ä¸ªèœè°±æ‰€åšçš„å·¥ä½œã€‚

# åˆ›å»ºè‡ªå·±çš„é›†åˆ

æœ‰æ—¶ Swift ä¸­åŒ…å«çš„é›†åˆç±»å‹ä¸è¶³ä»¥è§£å†³æˆ‘ä»¬çš„é—®é¢˜ï¼Œå› æ­¤åœ¨è¿™ä¸ªèœè°±ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºè‡ªå·±çš„é›†åˆã€‚è¿™ä¸ªèœè°±çš„ç›®æ ‡ä¸ä»…æ˜¯å±•ç¤ºå¦‚ä½•åˆ›å»ºè‡ªå·±çš„é›†åˆï¼Œè¿˜åŒ…æ‹¬å¦‚ä½•é‡è½½è¿ç®—ç¬¦ã€‚

å¯¹äºè¿™ä¸ªèœè°±ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç®€å•çš„è´­ç‰©åˆ—è¡¨ç¨‹åºï¼Œç”¨æˆ·å¯ä»¥å†™ä¸‹ä»–éœ€è¦è´­ä¹°çš„äº§å“åŠå…¶æ•°é‡ã€‚å¦‚æœä»–å°è¯•æ·»åŠ ä¸¤æ¬¡ï¼Œäº§å“ä¸ä¼šå‡ºç°ä¸¤æ¬¡ï¼Œè€Œæ˜¯å°†æ•°é‡åŠ åˆ°ç°æœ‰äº§å“ä¸Šã€‚

å°†ä¼šæœ‰ä¸€ä¸ªå¼€å…³æŒ‰é’®ï¼Œå½“å®ƒè¢«ç¦ç”¨æ—¶ï¼Œæ„å‘³ç€å¦‚æœäº§å“å·²ç»å­˜åœ¨äºè´­ç‰©åˆ—è¡¨ä¸­ï¼Œç”¨æˆ·å°†æ— æ³•å°†å…¶æ·»åŠ åˆ°è´­ç‰©åˆ—è¡¨ä¸­ï¼Œå½“ç„¶ï¼Œä¹Ÿä¼šæœ‰ä¸€ä¸ªæŒ‰é’®æ¥æ˜¾ç¤ºæˆ‘ä»¬çš„åˆ—è¡¨ã€‚

## å‡†å¤‡å·¥ä½œ

å¦‚åŒå¾€å¸¸ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º `Chapter2 ShoppingList` çš„æ–°é¡¹ç›®ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªåä¸º `ShoppingList` çš„ Swift æ–‡ä»¶ã€‚è¿™é‡Œçš„æƒ³æ³•æ˜¯åˆ›å»ºæˆ‘ä»¬çš„å®¹å™¨ä»¥åŠå®ƒå°†å­˜å‚¨çš„ç±»å‹ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯ `Product` ç±»ã€‚

## å¦‚ä½•åšâ€¦

äº§å“æ˜¯ä¸æˆ‘ä»¬çš„å®¹å™¨ç›¸å…³çš„ä¸œè¥¿ï¼›æˆ‘ä»¬ç”šè‡³å¯ä»¥è¯´è¿™æ˜¯å®ƒçš„ä¸€éƒ¨åˆ†ã€‚å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªåµŒå¥—ç±»æ¥ä¸ä¹‹ä¸€èµ·å·¥ä½œã€‚åœ¨è¿™ä¸ªç±»ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸¤ä¸ªå±æ€§ï¼šå®ƒçš„åç§°å’Œå®ƒçš„æ•°é‡ã€‚æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤åˆ›å»ºè‡ªå·±çš„é›†åˆï¼š

1.  åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†åˆ›å»ºå…¶æè¿°ï¼Œå¹¶å®ç° `Comparable` åè®®ã€‚æˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªåè®®æ¥ç¡®å®šä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ä»£è¡¨ç›¸åŒçš„äº§å“ã€‚è®©æˆ‘ä»¬å¼€å§‹ç¼–ç ï¼š

    ```swift
    class ShoppingList: CustomStringConvertable {
        class Product: Comparable, CustomStringConvertable {
            var name:String
            lazy var quantity:Int = 1

            init(_ name:String){
                self.name = name
            }

            var description: String {
                return "\(name): \(quantity)"
            }
        }
    ```

1.  ç°åœ¨æˆ‘ä»¬éœ€è¦åˆ›å»ºè´­ç‰©åˆ—è¡¨çš„å±æ€§ã€‚æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨æˆ‘ä»¬çš„äº§å“ï¼š

    ```swift
    private var set:[Product] = []
    ```

1.  ç”±äºè´­ç‰©åˆ—è¡¨æ˜¯ä¸€ä¸ªé›†åˆï¼Œæˆ‘ä»¬åº”è¯¥å®ç°åŸºæœ¬çš„æ–¹æ³•ã€‚ä¸€ä¸ªæ–¹æ³•ç”¨äºæ·»åŠ äº§å“ï¼Œå¦ä¸€ä¸ªæ–¹æ³•ç”¨äºçŸ¥é“è´­ç‰©åˆ—è¡¨æ˜¯å¦å·²ç»åŒ…å«è¯¥äº§å“ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜ä¼šæ·»åŠ  `description` å±æ€§ï¼š

    ```swift
        func contains(product: Product)-> Bool{
            for currentProduct in set {
                if currentProduct == product {
                    return true
                }
            }
            return false
        }

        func add(product:Product){
            for currentProduct in set {
                if currentProduct == product {
                    currentProduct += product.quantity
                    return
                }
            }
            set.append(product)
        }

        var description: String {
      let descriptions = set.map{$0.description}
      return descriptions.joinWithString(" ")
        }
    }
    ```

    ### æ³¨æ„

    æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨åŒç­‰å·è¿ç®—ç¬¦ï¼ˆ`==`ï¼‰æ¯”è¾ƒäº†ä¸€ä¸ªäº§å“ä¸å¦ä¸€ä¸ªã€‚ä¸»è¦é—®é¢˜æ˜¯ç¼–è¯‘å™¨æ˜¯å¦‚ä½•è¿›è¡Œæ¯”è¾ƒçš„ï¼Ÿå®é™…ä¸Šï¼Œæ²¡æœ‰ç¨‹åºå‘˜çš„å¸®åŠ©ï¼Œç¼–è¯‘å™¨æ— æ³•è¿›è¡Œè¿™ç§æ¯”è¾ƒã€‚é¦–å…ˆï¼Œæ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬åœ¨ç¨‹åºä¸­ä½¿ç”¨äº† `Comparable` åè®®ã€‚è¿™å¹¶ä¸æ˜¯å¿…éœ€çš„ï¼Œä½†å¦‚æœæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨äº§å“ä¸å…¶ä»–å®¹å™¨ä¸€èµ·ä½¿ç”¨ï¼Œå®ç°è¿™ä¸ªåè®®æ˜¯å¥½çš„ã€‚

1.  å³ä½¿å®ƒæ˜¯ä¸€ä¸ªæ¯”è¾ƒï¼Œæˆ‘ä»¬ä¹Ÿå¿…é¡»å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†å‘Šè¯‰è¿è¡Œæ—¶ä¸¤ä¸ªäº§å“æ˜¯å¦ç›¸ç­‰ã€‚è¿™ä¸ªå‡½æ•°å¿…é¡»å‘½åä¸º `==`ï¼ˆæ˜¯çš„ï¼ŒåŒç­‰å·ï¼‰ï¼Œå¹¶ä¸”å¿…é¡»åœ¨å…¨å±€èŒƒå›´å†…å£°æ˜ï¼šåœ¨ç±»å’Œå‡½æ•°ä¹‹å¤–ã€‚å› æ­¤ï¼Œè¿™é‡Œæˆ‘ä»¬æœ‰ç›¸åº”çš„ä»£ç ï¼š

    ```swift
    func ==(leftProduct: ShoppingList.Product, rightProduct: ShoppingList.Product) -> Bool{
      return leftProduct.name.lowercaseString == rightProduct.name.lowercaseString
    }
    ```

1.  å¦‚æœæˆ‘ä»¬åªå®ç° `Equatable` åè®®ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦å®ç°ä»»ä½•å…¶ä»–æ–¹æ³•ï¼›ç„¶è€Œï¼Œç”±äºæˆ‘ä»¬æ­£åœ¨å®ç° `Comparable`ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®ç°è¿ç®—ç¬¦ `<`ã€`<=`ã€`>` å’Œ `>=`ï¼š

    ```swift
    func <=(leftProduct: ShoppingList.Product, rightProduct: ShoppingList.Product) -> Bool{
        return leftProduct.name <= rightProduct.name
    }
    func >=(leftProduct: ShoppingList.Product, rightProduct: ShoppingList.Product) -> Bool{
        return leftProduct.name >= rightProduct.name
    }
    func >(leftProduct: ShoppingList.Product, rightProduct: ShoppingList.Product) -> Bool{
        return leftProduct.name > rightProduct.name
    }
    func <(leftProduct: ShoppingList.Product, rightProduct: ShoppingList.Product) -> Bool{
        return leftProduct.name < rightProduct.name
    }
    ```

1.  ç”±äºæˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€äº›è¿ç®—ç¬¦ï¼Œè®©æˆ‘ä»¬ç»§ç»­ã€‚è®©æˆ‘ä»¬é‡è½½ `+=` è¿ç®—ç¬¦ä¸¤æ¬¡ï¼Œä¸€æ¬¡ç”¨äºå‘äº§å“æ·»åŠ æ›´å¤šå•ä½ï¼Œå¦ä¸€æ¬¡ç”¨äºå°†äº§å“æ·»åŠ åˆ°è´­ç‰©åˆ—è¡¨ä¸­ï¼š

    ```swift
    func +=(shoppingList: ShoppingList, product: ShoppingList.Product) -> ShoppingList{
        shoppingList.add(product)
        return shoppingList
    }

    func +=(product: ShoppingList.Product, quantity: Int) -> ShoppingList.Product{
        product.quantity += quantity
        return product
    }
    ```

    ### æ³¨æ„

    æ³¨æ„ï¼Œé‡è½½è¿™ä¸ªæ“ä½œç¬¦ä¸éœ€è¦å®ç°ä»»ä½•åè®®ï¼Œç”šè‡³ä¹‹å‰çš„æ“ä½œç¬¦ä¹Ÿä¸éœ€è¦ï¼Œä½†å®ç°`Comparable`åè®®ä»¥ä¸å…¶ä»–å‡½æ•°æˆ–ç®—æ³•ä¸€èµ·ä½¿ç”¨æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚

    ### æç¤º

    å½“ä½ å¯ä»¥ä½¿ç”¨å®ƒä¸å…¶ä»–æ³›å‹å¯¹è±¡ä¸€èµ·æ—¶ï¼Œå®ç°`Comparable`æˆ–`Equatable`åè®®ï¼Œä¾‹å¦‚ï¼Œå½“ä½ è®¤ä¸ºå¯¹è±¡å¯ä»¥è¢«æ’åºæ—¶ã€‚

1.  Swift çš„ä¸€ä¸ªå¥½ç‰¹æ€§æ˜¯ï¼Œä½ ä¸éœ€è¦ä»…é‡è½½ç°æœ‰æ“ä½œç¬¦ï¼›ä½ è¿˜å¯ä»¥åˆ›å»ºæ–°çš„æ“ä½œç¬¦ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ªæ–°çš„æ“ä½œç¬¦ï¼š`=>`ï¼Œå®ƒå°†å‘Šè¯‰æˆ‘ä»¬ä¸€ä¸ªäº§å“æ˜¯å¦åœ¨æˆ‘ä»¬çš„è´­ç‰©æ¸…å•ä¸­ï¼Œä»¥åŠ`!=>`ï¼Œè¿™æ˜¯ç›¸åçš„æ“ä½œç¬¦ã€‚æˆ‘å°†åœ¨ç¨åè¯¦ç»†è§£é‡Šã€‚åœ¨ä»¥ä¸‹ä»£ç ä¸­ä½¿ç”¨è¿™äº›æ“ä½œç¬¦ï¼š

    ```swift
    infix operator => { associativity left precedence 140 }
    infix operator !=> { associativity left precedence 140 }

    func =>(product:ShoppingList.Product, shoppingList:ShoppingList)->Bool {
        return shoppingList.contains(product)
    }

    func !=>(product:ShoppingList.Product, shoppingList:ShoppingList)->Bool {
        return !shoppingList.contains(product)
    }
    ```

1.  ç°åœ¨æ¨¡å‹å·²ç»å®Œæˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºè§†å›¾ã€‚è¾“å…¥ä¸¤ä¸ªæ–‡æœ¬å­—æ®µï¼šä¸€ä¸ªç”¨äºäº§å“åç§°ï¼Œå¦ä¸€ä¸ªç”¨äºæ•°é‡ï¼›ä¸€ä¸ªå¼€å…³ï¼Œå…è®¸æ·»åŠ äº§å“æˆ–ä¸æ·»åŠ ï¼›ä¸¤ä¸ªæŒ‰é’®ï¼Œä¸€ä¸ªç”¨äºå°†äº§å“æ·»åŠ åˆ°åˆ—è¡¨ä¸­ï¼Œå¦ä¸€ä¸ªç”¨äºæ˜¾ç¤ºåˆ—è¡¨ï¼›ä»¥åŠä¸€ä¸ªæ–‡æœ¬è§†å›¾ã€‚è®©æˆ‘ä»¬å°†å®ƒä»¬è¿æ¥èµ·æ¥ï¼Œé™¤äº†æŒ‰é’®å…·æœ‰ä»¥ä¸‹å±æ€§ï¼š

    ```swift
        @IBOutlet var fieldQuantity: UITextField!
        @IBOutlet var fieldProduct: UITextField!
        @IBOutlet var appendSwitch: UISwitch!
        @IBOutlet var textResult: UITextView!
    ```

1.  æ·»åŠ ä¸€ä¸ªè¡¨ç¤ºåº”ç”¨ç¨‹åºè´­ç‰©æ¸…å•çš„å±æ€§ï¼š

    ```swift
    var shoppingList: ShoppingList = ShoppingList()
    ```

1.  ç°åœ¨æˆ‘ä»¬éœ€è¦æ·»åŠ æŒ‰é’®åŠ¨ä½œã€‚è®©æˆ‘ä»¬ä»æœ€å®¹æ˜“çš„äº‹æƒ…å¼€å§‹ï¼šæ˜¾ç¤ºæŒ‰é’®ï¼Œå®ƒå°†è´­ç‰©æ¸…å•çš„æè¿°æ˜¾ç¤ºåˆ°æ–‡æœ¬è§†å›¾ä¸­ï¼š

    ```swift
        @IBAction func showList(sender: UIButton) {
            textResult.text = shoppingList.description
        }
    ```

1.  ç°åœ¨æˆ‘ä»¬å¿…é¡»åˆ›å»ºæ·»åŠ æŒ‰é’®çš„åŠ¨ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†éœ€è¦æ£€æŸ¥ç”¨æˆ·æ˜¯å¦åœ¨æ•°é‡æ–‡æœ¬å­—æ®µä¸­è¾“å…¥äº†æ•°å­—ï¼Œä»¥åŠæ˜¯å¦å¯èƒ½å°†äº§å“æ·»åŠ åˆ°è´­ç‰©æ¸…å•ä¸­ï¼š

    ```swift
        @IBAction func addToList(sender: UIButton) {
            var product = ShoppingList.Product(fieldProduct.text)
            if  let quantity = Int(fieldQuantity.text) {
                product.quantity = quantity
                if appendSwitch.on || product !=> shoppingList{
                    shoppingList += product
                }else {
                  let alert = UIAlertController(title: "Wrong Product", message: "This product is already on your list"), preferredStyle:.Alert)
                  self.presentViewController(alert, animated: true, completion: nil)
                }
              }else {

                let alert = UIAlertController(title: "Wrong Value", message: "Oops! I need a number on the quantity field"), preferredStyle:.Alert)
                self.presentViewController(alert, animated: true, completion: nil)

                fieldQuantity.text = ""
            }
            clear()
        }
    ```

    `clear`å‡½æ•°åªæ˜¯ä¸€ä¸ªè¾…åŠ©æ–¹æ³•ï¼Œæ¯æ¬¡æˆ‘ä»¬æŒ‰ä¸‹æ·»åŠ æŒ‰é’®æ—¶éƒ½ä¼šæ¸…ç©ºæ–‡æœ¬å­—æ®µï¼š

    ```swift
        private func clear(){
            fieldQuantity.text = ""
            fieldProduct.text = ""
            fieldQuantity.becomeFirstResponder()
        }
    ```

1.  ç°åœ¨ä½ å¯ä»¥ç‚¹å‡»æ’­æ”¾å¹¶æ·»åŠ ä¸€äº›äº§å“ï¼Œé‡å¤ä¸€äº›äº§å“ï¼Œå¹¶æ˜¾ç¤ºå®ƒä»¬ã€‚ä½ åº”è¯¥å¾—åˆ°ä¸€ä¸ªåƒè¿™é‡Œæ˜¾ç¤ºçš„ç»“æœï¼š![å¦‚ä½•æ“ä½œâ€¦](img/00032.jpeg)

## å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„â€¦

åœ¨ Swift ä¸­ï¼Œé‡è½½æ“ä½œç¬¦æ˜¯éå¸¸å¸¸è§çš„ï¼›ä½ å¯ä»¥é‡è½½ç°æœ‰æ“ä½œç¬¦ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºä½ è‡ªå·±çš„æ“ä½œç¬¦ã€‚å¦‚æœä½ æƒ³åˆ›å»ºè‡ªå·±çš„æ“ä½œç¬¦ï¼Œä½ å¿…é¡»é¦–å…ˆæŠ¥å‘Šä¸€äº›å…³äºä½ çš„æ“ä½œç¬¦çš„å±æ€§ã€‚é¦–å…ˆï¼Œä½ å¿…é¡»é€‰æ‹©ä½ æƒ³è¦çš„ä½¿ç”¨ç±»å‹ï¼š

+   **ä¸­ç¼€**ï¼šè¿™æ„å‘³ç€æ“ä½œç¬¦ç”¨äºä¸¤ä¸ªå¯¹è±¡ä¹‹é—´ï¼›ä¾‹å¦‚ï¼Œåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†`!=>`æ“ä½œç¬¦ï¼Œç”¨äºåœ¨äº§å“å’Œé›†åˆä¹‹é—´ä½¿ç”¨ã€‚

+   **å‰ç¼€**ï¼šè¿™æ„å‘³ç€æ“ä½œç¬¦å°†åªä¸å®ƒå³è¾¹çš„å¯¹è±¡ä¸€èµ·æ“ä½œã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬æƒ³è±¡æˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ª`!!!`æ“ä½œç¬¦ï¼Œè¿™å¯èƒ½æ„å‘³ç€æˆ‘ä»¬æƒ³è¦æ¸…ç©ºè´­ç‰©æ¸…å•ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥å°†å…¶ç”¨ä½œ`!!!shoppingList`ã€‚

+   **åç¼€**ï¼šè¿™ä¸ªæ“ä½œç¬¦å°†åªä¸å®ƒå·¦è¾¹çš„å¯¹è±¡ä¸€èµ·æ“ä½œï¼Œä¾‹å¦‚`shoppingList!!!`ã€‚

ä¸‹ä¸€æ­¥æ˜¯å†™ä¸‹`operator`å’Œä¸ºå…¶é€‰æ‹©çš„åå­—ã€‚ä¹‹åï¼Œä½ å¿…é¡»åœ¨è¿™ä¸ªæ“ä½œç¬¦çš„å±æ€§ä¹‹é—´æ·»åŠ æ‹¬å·ã€‚ç»“åˆå€¼æ˜¯å·¦ç»“åˆã€å³ç»“åˆå’Œæ— ç»“åˆã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š

+   **å·¦å…³è”æ€§**ï¼šè¿™æ„å‘³ç€å½“æœ‰å¤šä¸ªå…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„è¿ç®—ç¬¦æ—¶ï¼Œæœ€å·¦è¾¹çš„ä¸€ä¸ªå°†è¢«é¦–å…ˆè¯„ä¼°

+   **å³å…³è”æ€§**ï¼šæ­£å¦‚æ‚¨æ‰€æƒ³è±¡çš„é‚£æ ·ï¼Œè¿™æ˜¯å·¦å…³è”æ€§çš„ç›¸å

+   **éå…³è”æ€§**ï¼šè¿™æ„å‘³ç€ä¸å…è®¸æœ‰å¤šä¸ªå…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„è¿ç®—ç¬¦

ä¼˜å…ˆçº§å°±åƒä¼˜å…ˆçº§ã€‚ä¼˜å…ˆçº§é«˜çš„å…ˆè¢«è¯„ä¼°ã€‚

## è¿˜æœ‰æ›´å¤š...

Swift å…è®¸æ”¹å˜ç°æœ‰è¿ç®—ç¬¦çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å£°æ˜ä»¥ä¸‹å‡½æ•°ï¼š

```swift
func  + (i:Int, j:Int) -> Int {
    return 10
}
```

è¿™å°†ä½¿æ¯ä¸ªæ•´æ•°æ±‚å’Œè¿ç®—ç¬¦è¿”å›`10`ã€‚è¿™å¾ˆæœ‰è¶£ï¼Œä½†åœ¨æ­£å¸¸æƒ…å†µä¸‹æˆ‘ä¸ä¼šè¿™æ ·åšã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¦‚æœä½ åˆ›å»ºé€’å½’è°ƒç”¨ï¼Œå°±åƒè¿™æ ·ï¼š

```swift
func  + (i:Int, j:Int) -> Int {
    if i == 1 && j == 1 {
    return 10
    }else {
        return i + j
    }
}
```

# ç»„ç»‡å®´ä¼šå…

åœ¨è¿™ä¸ªèœè°±ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Swift ç¼–ç¨‹è¯­è¨€çš„å…¶ä»–åŠŸèƒ½ã€‚æˆ‘ä»¬å°†ä»æ•°ç»„ä¸­å¤åˆ¶å…ƒç´ çš„èŒƒå›´ï¼Œä½¿ç”¨å­—å…¸ï¼Œä¸‹æ ‡ï¼Œswitchï¼Œå¹¶å‘½åå¾ªç¯ã€‚

å¯¹äºè¿™ä¸ªåº”ç”¨ï¼Œæˆ‘ä»¬å°†ä¸ºä¸€å®¶å…¬å¸ä¸¾åŠä¸€åœºæ™šå®´ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå©šç¤¼é¤æ¡Œï¼Œå¤«å¦»å¿…é¡»ååœ¨ä¸€èµ·ï¼Œè€Œæ˜¯æˆ‘ä»¬åªéœ€è¦åŒä¸€ç»„çš„äººååœ¨åŒä¸€å¼ æ¡Œå­ä¸Šï¼Œå¯èƒ½æ˜¯å› ä¸ºä»–ä»¬æ¥è‡ªåŒä¸€ä¸ªå›¢é˜Ÿæˆ–ç±»ä¼¼çš„åŸå› ã€‚

æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªè¡¨ç¤ºæˆ¿é—´çš„ç±»ã€‚è¦å°†æ–°å®¢äººæ·»åŠ åˆ°è¿™ä¸ªæˆ¿é—´ï¼Œæˆ‘ä»¬éœ€è¦æŒ‡å®šå±äºè¿™ä¸ªç»„çš„äººçš„åå­—ï¼Œè¿™ä¸ªäººå·²ç»åœ¨æˆ¿é—´é‡Œäº†ã€‚å¦‚æœæˆ‘ä»¬æƒ³æ·»åŠ åˆ°è¿™ä¸ªæˆ¿é—´çš„äººæ˜¯ç¬¬ä¸€ä¸ªï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ nil å€¼ä½œä¸ºå±äºè¿™ä¸ªç»„çš„äººçš„åå­—ã€‚

å¦‚æœè¦å‘å·²æ»¡çš„æ¡Œå­æ·»åŠ æŸäººï¼Œåˆ™å¿…é¡»å°†æ­¤æ¡Œä¸Šçš„ä¸€ä¸ªäººé‡æ–°åˆ†é…åˆ°å¦ä¸€å¼ æ¡Œå­ä¸Šã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¸ä¼šä½¿ç”¨æœ€ä¼˜åŒ–ç®—æ³•ï¼Œå› ä¸ºè¿™ä¸æ˜¯æˆ‘ä»¬çš„ä¸»è¦ç›®æ ‡ã€‚

## å‡†å¤‡å·¥ä½œ

åˆ›å»ºä¸€ä¸ªæ–°çš„ Swift å•è§†å›¾é¡¹ç›®ï¼Œå‘½åä¸º`Chapter2 DinnerRoom`ã€‚

## å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹...

å¦‚åŒå¾€å¸¸ï¼Œæˆ‘ä»¬éœ€è¦ä»æ¨¡å‹éƒ¨åˆ†çš„æ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨å¼€å§‹ã€‚å¯¹äºè¿™æ®µä»£ç ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªè¡¨ç¤ºæˆ¿é—´çš„ç±»ï¼Œå¦ä¸€ä¸ªè¡¨ç¤ºå­˜å‚¨ååœ¨é‚£é‡Œçš„äººçš„åº§ä½å’Œæ¡Œå­ï¼Œä¸€ä¸ªç»„ï¼Œè¿™æ˜¯å±äºåŒä¸€å›¢é˜Ÿçš„æ¡Œå­çš„äººçš„èŒƒå›´ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªè¡¨ç¤ºä¸ªäººçš„ç±»ã€‚

1.  è®©æˆ‘ä»¬ä»`person`ç±»å¼€å§‹ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦å­˜å‚¨ä»–çš„åå­—å’Œä»–æ‰€å±çš„ç»„ã€‚ç”±äºæœ‰ä¸€ä¸ªäººå¯ä»¥æ²¡æœ‰ä»»ä½•ç»„çš„æ—¶é—´æ®µï¼Œè¿™ä¸ªå±æ€§åº”è¯¥æ˜¯å¯é€‰çš„ã€‚å› æ­¤ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Swift æ–‡ä»¶ï¼Œå‘½åä¸º`person.swift`ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

    ```swift
    class Person: Equatable {
        var name: String
        var group:Group?
        init(_ name: String){
            self.name = name
        }
    }
    ```

1.  å¦‚æ‚¨æ‰€è§ï¼Œè¿™ä¸ªç±»ç»§æ‰¿è‡ª`Equatable`åè®®ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»å®ç°`==`è¿ç®—ç¬¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

    ```swift
    func ==(person1:Person, person2:Person)->Bool{
        return person1.name == person2.name
    }
    ```

1.  å¥½çš„ï¼Œç°åœ¨è®©æˆ‘ä»¬åˆ›å»º`Group`ç±»ã€‚è®°ä½ï¼Œä¸€ä¸ªç»„æ²¡æœ‰åå­—ï¼›å®ƒåªæ˜¯ååœ¨ä¸€èµ·çš„äººçš„èŒƒå›´ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å­˜å‚¨èŒƒå›´å¼€å§‹çš„åœ°æ–¹ï¼Œç»“æŸçš„åœ°æ–¹ï¼Œä»¥åŠå®ƒçš„æ¡Œå­ã€‚æ­£å¦‚æ‚¨æ‰€æƒ³è±¡çš„é‚£æ ·ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªåä¸º`group.swift`çš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

    ```swift
    class Group {
        unowned var table:Table
        var rangeStart: Int
        var rangeEnd:Int
        var size:Int {
            return rangeEnd - rangeStart + 1
        }

        init (table:Table, entryPoint:Int){
            self.table = table
            rangeStart = entryPoint
            rangeEnd = entryPoint
        }

        func shift(){
            rangeStart++
            rangeEnd++
        }

        func increase(){
            rangeEnd++
        }
    }
    ```

    ### æ³¨æ„

    æ³¨æ„ï¼Œ`size`å±æ€§æ²¡æœ‰ setterï¼Œåªæœ‰ getterï¼Œå¹¶ä¸”å®ƒä¸æ–°å±æ€§æ— å…³ï¼›è¿™å°±æ˜¯æ‰€è°“çš„`computed`å±æ€§ã€‚æ­¤å¤–ï¼Œæ³¨æ„æˆ‘ä»¬ä¸å¾—ä¸ç»™`table`å±æ€§æ·»åŠ ä¸€ä¸ª`unowned`ä¿®é¥°ç¬¦ï¼›è¿™æ˜¯å› ä¸ºå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ª UML ç±»å›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ¿é—´åŒ…å«æ¡Œå­ï¼Œæ¡Œå­ä¸Šæœ‰å±äºä¸€ä¸ªçŸ¥é“å…¶æ¡Œå­çš„å°ç»„æˆå‘˜ã€‚æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¾ªç¯ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šé˜»æ­¢å¼•ç”¨è®¡æ•°å™¨è¾¾åˆ°é›¶ï¼Œå› æ­¤ä¼šåˆ›å»ºå†…å­˜æ³„æ¼ã€‚æ·»åŠ `unowned`å°†å¸®åŠ©æˆ‘ä»¬é¿å…è¿™ä¸ªé—®é¢˜ã€‚

1.  ä¸‹ä¸€ä¸ªç±»æ˜¯`Room`ã€‚è¿™ä¸ªç±»éœ€è¦å­˜å‚¨å…¶æ¡Œå­å’Œå·²ç»è¿›å…¥æˆ¿é—´çš„å®¢äººã€‚ç¬¬äºŒä¸ªå±æ€§ä¸æ˜¯å¼ºåˆ¶çš„ï¼Œä½†è®¡ç®—æœºåœ¨å­—å…¸ä¸­æŸ¥æ‰¾å®ƒæ¯”æœç´¢å®ƒè¦å¿«ï¼Œå¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼Œè¿™ä¹Ÿæ›´å¿«ï¼Œå› ä¸ºä»–å°†ç¼–å†™æ›´å°‘çš„ä»£ç ã€‚å°†`room.swift`æ·»åŠ åˆ°ä½ çš„é¡¹ç›®ä¸­ï¼Œå¹¶å¼€å§‹æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

    ```swift
    class Room: CustomStringConvertable {
        let STANDARD_TABLE_SIZE = 3
        var guests:[String: Person] = [String: Person] ()
        var tables = [Table]()

        func add(table:Table){
            tables.append(table)
        }

        func add(person:Person){
            guests[person.name] = person
        }

        var description:String {
      let descriptions = tables.map{$0.description}
      return descriptions.joinWithSeperator("Table: ")
        }
    ```

1.  ç°åœ¨ï¼Œçœ‹çœ‹`guests`å±æ€§ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰ä¸¤ä¸ªç±»å‹åœ¨æ‹¬å·å†…ï¼Œå¹¶ç”¨å†’å·åˆ†éš”ï¼›è¿™æ„å‘³ç€å®ƒä¸æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œæ˜¯ä¸€ä¸ªå­—å…¸ã€‚æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥å†™æˆ`Dictionary<String,Person>`è€Œä¸æ˜¯`[String: Person]`ã€‚ä¸ Objective-C åˆ° Swift çš„å­—å…¸ç›¸æ¯”ï¼Œæœ‰ä¸€ä¸ªåŒºåˆ«æ˜¯ä½ å¿…é¡»æŒ‡å®šé”®å’Œå€¼ç±»å‹ã€‚

    ### æ³¨æ„

    å½“å¯èƒ½æ—¶ï¼Œå°½é‡ä½¿ç”¨å­—å…¸è€Œä¸æ˜¯æœç´¢å…ƒç´ ï¼Œå› ä¸ºè¿™æ ·ä¼šæœ‰æ›´å¥½çš„æ€§èƒ½ã€‚

    å¦‚æœä½ æ˜¯ä¸€ä¸ªå¥½çš„è§‚å¯Ÿè€…ï¼Œä½ ä¼šçœ‹åˆ°æˆ‘ä»¬é‡å¤äº†`add`å‡½æ•°ã€‚åŒºåˆ«åœ¨äºå‚æ•°ç±»å‹ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨ Swift ä¸­é‡è½½æ–¹æ³•å’Œå‡½æ•°ã€‚

1.  ç°åœ¨ï¼Œä¸ºäº†æ£€æŸ¥æŸäººæ˜¯å¦å·²ç»åœ¨è¿™ä¸ªæˆ¿é—´é‡Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ–¹æ‹¬å·æ“ä½œç¬¦ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç¼–å†™ç±»ä¼¼`if room["Harry Potter"] == true {...}`çš„ä»£ç ã€‚ä¸ºäº†åœ¨ Swift ä¸­å¯ç”¨å®ƒï¼Œæˆ‘ä»¬å¿…é¡»ç¼–å†™ä¸€ç§ç‰¹æ®Šå‡½æ•°ï¼Œç§°ä¸º subscriptã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªåªè¯»çš„`subscript`ï¼š

    ```swift
        subscript(name:String)->Bool{
            get{
                if let guest = guests[name] {
                    return true
                }
                return false
            }
            // No setter
        }
    ```

1.  ç°åœ¨æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•æ¥æ·»åŠ ä¸€ä¸ªäººåˆ°æˆ¿é—´ä¸­ï¼›è®°ä½ï¼Œæˆ‘ä»¬å¿…é¡»æŒ‡å®šæ¥è‡ªåŒä¸€ç»„çš„äººçš„åå­—æˆ–å½“æ˜¯ç¬¬ä¸€ä¸ªäººæ—¶ä¸º nilã€‚æŒ‰ç…§è¿™ä¸ªæƒ³æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç±»ä¼¼`room["Harry Potter"] = Person("David Copperfield")`çš„ä»£ç æ·»åŠ ä¸€ä¸ªäººåˆ°æˆ¿é—´ä¸­ï¼š

    ```swift
        subscript(name:String?)->Person{
            get{
                assertionFailure("Sorry, no subscript getter")
            }

            set(newValue){
                guests[newValue.name] = newValue
                // if the key is nil we will have to look for
                // the first table that is not null. If we
                // are not able to find it we have to create a new table
                if let personName = name {
                    if let guest = guests[personName]{
                        // now we need to find its table
                        var guestGroup = guest.group!
                        newValue.group = guestGroup
                        // now we have to check the group table is full
                        if guestGroup.table.full {
                        // the table is full, if we have only 1 group it is not possible to add
                        // any one to this table, otherwise the last group should move to another table
                          if guestGroup.table.size == guestGroup.size {
                            // The group is bigger than the supported size
                            assertionFailure("Group too big")
                            }else{
                              // the last table group should go to a new table

                              var lastGroup = guestGroup.table.getLastGroup()!
                              tables.append( guestGroup.table.transferGroup(lastGroup))
                              // now the guestGroup table has free space
                            }
                        }
                        guestGroup.table.add(newValue)
                        guestGroup.increase()
                    }else
                    {
                        assertionFailure("This guest should exists")
                    }

                }else {
                    // this person belongs to a new group
                    var table = freeTable()
                    var index = table.add(newValue)
                    var group = Group(table: table, entryPoint: index)
                    newValue.group = group
                }
            }
        }

        private func freeTable() -> Table {
            for table in tables {
                if !table.full {
                    return table
                }
            }
            var newTable = Table(STANDARD_TABLE_SIZE)
            tables.append(newTable)
            return newTable
        }
    ```

    æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬åœ¨ subscript çš„ getter æ–¹æ³•ä¸­æ·»åŠ äº†ä¸€ä¸ªæ–­è¨€ï¼›åŸå› æ˜¯ subscripts å¯ä»¥æ˜¯åªè¯»çš„æˆ–è¯»å†™ï¼Œä½†ä¸èƒ½æ˜¯åªå†™çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·æ±‚è¿”å›å€¼æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å”¯ä¸€èƒ½åšçš„å°±æ˜¯åˆ›å»ºä¸€ä¸ªæ–­è¨€æ¥é˜²æ­¢é—®é¢˜ã€‚

    ### å°è´´å£«

    ä¸è¦ç»å¸¸ä½¿ç”¨`assertionFailure`ï¼›å°½é‡åˆ›å»ºå¯ä»¥æ£€æµ‹é”™è¯¯å¹¶ç»§ç»­å·¥ä½œçš„ä»£ç ã€‚

1.  åˆ›å»ºä¸€ä¸ªåä¸º`table.swift`çš„æ–°æ–‡ä»¶ã€‚åœ¨æˆ‘ä»¬å¼€å§‹ç¼–å†™`Table`ç±»ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸€ä¸ªæ¡Œå­å°†æœ‰ä¸€ä¸ªåº§ä½æ•°ç»„ã€‚æˆ‘ä»¬å¯ä»¥æœ‰ä¸€ä¸ªç©ºåº§ä½æˆ–è¢«å ç”¨çš„åº§ä½ã€‚å¦‚æœå®ƒè¢«å ç”¨ï¼Œé‚£ä¹ˆå®ƒæ˜¯ç”±æŸäººå ç”¨çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦çŸ¥é“è°å ç”¨äº†è¿™ä¸ªåº§ä½ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼ŒSwift å…è®¸æˆ‘ä»¬ä½¿ç”¨æšä¸¾ï¼š

    ```swift
    enum TableSeat {
        case FREE,
        OCCUPIED(Person)
    }
    ```

    æšä¸¾çš„å”¯ä¸€é—®é¢˜æ˜¯æˆ‘ä»¬éœ€è¦å¤šæ¬¡ä½¿ç”¨`switch`åˆ†æ”¯ï¼Œæ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“æˆ‘ä»¬æƒ³çŸ¥é“ä¸€ä¸ªåº§ä½æ˜¯å¦ç©ºé—²æˆ–è¢«æŸäººå ç”¨æ—¶ï¼Œé‡è½½è¿ç®—ç¬¦`==`å’Œ`!=`æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼š

    ```swift
    func == (seat1:TableSeat, seat2:TableSeat) -> Bool {
        switch(seat1,seat2){
        case (.FREE,.FREE):
            return true
        case (.OCCUPIED(let person1),.OCCUPIED(let person2)):
            return person1 == person2
        default:
            return false
        }
    }

    func != (seat1:TableSeat, seat2:TableSeat) -> Bool {
        return !(seat1 == seat2)
    }
    ```

1.  ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹ç¼–å†™`Table`ç±»äº†ã€‚åŸºæœ¬ä¸Šï¼Œæˆ‘ä»¬éœ€è¦å­˜å‚¨ä¸€ä¸ªåº§ä½æ•°ç»„ï¼Œä½†æˆ‘ä»¬å¯ä»¥æœ‰ä¸€äº›è¾…åŠ©çš„åªè¯»è®¡ç®—å±æ€§å’Œæ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

    ```swift
        private var seats:[TableSeat]

        init (_ size: Int){
            seats = TableSeat
        }

        var full:Bool {
            return seats.last! !=  .FREE
        }

        var freeSeats:Int {
            var total = 0
                for i in seats.reverse() {
                    if i == TableSeat.FREE {
                        ++total
                    }else{
                        break
                    }
                }
                return total
        }

        var nextFreeSeat:Int {
            return seats.count - self.freeSeats
        }

        var description:String {
            let takenSeats = seats.filter({ (seat) -> Bool in
            switch seat {
                case .FREE:
                    return false
                case .OCCUPIED:
                    return true
                }
            }).map({(seat) -> String in
                switch seat {
                    case .FREE:
                        assertionFailure("???")
                    case .OCCUPIED(let person):
                        return person.name
                }
            })

        return takenSeats.joinWithString(", ")

        private func shift(group:Group){
            seats[(group.rangeStart+1)...(group.rangeEnd+1)] = seats[group.rangeStart...group.rangeEnd]
            seats[group.rangeStart] = .FREE
            group.shift()
        }

        var size:Int {
            return seats.count
        }

        func getLastGroup() -> Group? {
            for seat in seats.reverse() {
                switch seat {
                case .OCCUPIED(let bySomeone):
                    return bySomeone.group
                case .FREE:
                    continue
                }
            }
            // no group
            return nil
        }

        func  transferGroup(group: Group)->Table{
            var newTable = Table(seats.count) // creating a new table with the same size
            newTable.seats[0..<(group.size)] = seats[group.rangeStart...group.rangeEnd]
            seats[group.rangeStart...group.rangeEnd] = TableSeat[0...(group.size-1)]
            group.table = newTable
            return newTable
        }

    func add(person:Person)->Int {
            var lastAllocatedSeat = self.nextFreeSeat-1
            // return -1 if it wasn't possible
            if self.full {
                return -1
            }
            var index = lastAllocatedSeat + 1
            if let group = person.group {
              // who we have to shift the groups until we find
                // the new person's group and them we keep
                // him (or her) on the array
                searching:
                    while lastAllocatedSeat>=0 {
                      // in this case the seat should be always occupied
                        // but as the compiler doesn't know we have to retrieve
                        // its value
                        switch seats[lastAllocatedSeat] {
                        case .FREE:
                            assertionFailure("shouldn't be any free seat here")
                        case .OCCUPIED(let groupPerson):
                            if groupPerson.group !== person.group {
                                // different groups, let's move the group to the right
                                lastAllocatedSeat = groupPerson.group!.rangeStart-1
                                shift(groupPerson.group!)

                            }else{
                                break searching
                            }
                        }
                }
                index = lastAllocatedSeat + 1

            }else{
                // if the person group is null means that it's a new group so
                // can add him on the first available seat
            }
            self.seats[index] = .OCCUPIED(person)
            return index
        }
    }
    ```

1.  åœ¨è¿›è¡Œè¿‡å¤šè§£é‡Šä¹‹å‰ï¼Œæˆ‘ä»¬å°†é€šè¿‡å°†`textView`æ·»åŠ åˆ°æˆ‘ä»¬çš„è§†å›¾æ§åˆ¶å™¨ä»¥åŠä¸€äº›äººå‘˜æ·»åŠ åˆ°`room.swift`ä¸­æ¥æµ‹è¯•ä¹‹å‰çš„ä»£ç ï¼š

    ```swift
        @IBOutlet var textView: UITextView!
        var room:Room = Room()

        override func viewDidLoad() {
            super.viewDidLoad()

            room[nil] = Person("Mr Peter File")
            room[nil] = Person("Ms Mary Simpson")
            room["Mr Peter File"] = Person("Mr Taro Mashimoto")
            room[nil] = Person("Mr Stuart Johnson")
            room["Ms Mary Simpson"] = Person("Mr Scott Chesterford")

            self.textView.text = room.description
        }
    ```

## å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„...

å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨äº†ä¸€äº›æ–°çš„ç‰¹æ€§ã€‚æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨`â€¦`è¿ç®—ç¬¦å¤åˆ¶ä¸€ç³»åˆ—åº§ä½ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„åŠŸèƒ½ï¼Œå¯ä»¥èŠ‚çœæˆ‘ä»¬ç¼–å†™å¤§é‡æ‰§è¡Œç›¸åŒæ“ä½œçš„å¾ªç¯ã€‚

### æ³¨æ„

æ³¨æ„ï¼Œè¿™ä¸ªåˆ‡ç‰‡è¿ç®—ç¬¦ï¼ˆ`â€¦`ï¼‰ï¼Œå½“ä¸æ•°ç»„çš„ä¸€éƒ¨åˆ†ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œç¼–è¯‘å™¨å¯ä»¥ä¸ºæ›´å¥½çš„æ€§èƒ½åˆ›å»ºä¸€ä¸ªè‰¯å¥½çš„ä¼˜åŒ–ã€‚

å¦ä¸€ä¸ªå¾ˆå¥½çš„ç‰¹æ€§æ˜¯èƒ½å¤Ÿä¸å€¼ç»„åˆä½¿ç”¨çš„`switch`è¯­å¥ã€‚çœ‹çœ‹`==`è¿ç®—ç¬¦ï¼Œä½ ä¼šå‘ç°æˆ‘ä»¬ä¸éœ€è¦ä¸ºæ¯ä¸ªæƒ…å†µåˆ›å»ºå†…éƒ¨çš„ switch åˆ†æ”¯ã€‚è°ˆåˆ°ç­‰å¼è¿ç®—ç¬¦ï¼Œçœ‹çœ‹æˆ‘ä»¬ä½¿ç”¨çš„`add`æ–¹æ³•ï¼šä½¿ç”¨`!==`è€Œä¸æ˜¯`!=`ã€‚åŸå› æ˜¯å½“æˆ‘ä»¬éœ€è¦æ£€æŸ¥ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦å…·æœ‰ç›¸åŒçš„å®ä¾‹æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨è¿ç®—ç¬¦`===`æˆ–`!==`æ¥æ£€æŸ¥å®ƒä»¬æ˜¯å¦ä¸å…±äº«ç›¸åŒçš„å®ä¾‹ã€‚

æˆ‘ä»¬è¿˜ä½¿ç”¨äº†ä¸€ä¸ªæ ‡ç­¾æ¥å‘½åä¸€ä¸ªå¾ªç¯ï¼ˆæœç´¢ï¼‰ï¼Œè¿™æ ·åšçš„åŸå› æ˜¯ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œ`break`è¯­å¥å°†é€€å‡º`switch`ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬çš„å¾ªç¯ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›å¸ƒå°”å˜é‡æ¥æ§åˆ¶è¿™ç§æƒ…å†µï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡`break searching`æ¥é¿å…å®ƒä¸­æ–­ã€‚

å¦ä¸€ä¸ªå¾ˆå¥½çš„æŠ€å·§æ˜¯åœ¨æˆ‘ä»¬çš„æ•°ç»„ä¸­ä»¥ç›¸åçš„é¡ºåºéå†ã€‚æˆ‘ä»¬ä½¿ç”¨`reverse`æ–¹æ³•åšåˆ°äº†è¿™ä¸€ç‚¹ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬æœ‰ä¸€ä¸ªå°æ•°ç»„ï¼›æˆ‘æ— æ³•æƒ³è±¡ä¸€ä¸ªæœ‰ä¸€ç™¾ä¸‡äººçš„è¡¨æ ¼ã€‚ä½¿ç”¨`reverse`å¤„ç†å¤§æ•°ç»„ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸ºå†…éƒ¨ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚

## è¿˜æœ‰æ›´å¤š...

ä½ ä»ç„¶å¯ä»¥ä½¿ç”¨æ—§çš„`NSDictionary`ç±»ï¼Œä½†æˆ‘ä¼šéµå¾ªæˆ‘ä»¬åœ¨`NSArray`ä¸­çœ‹åˆ°çš„ç›¸åŒè§„åˆ™ã€‚Swift å­—å…¸æ›´å®‰å…¨ï¼Œå¦‚æœä½ éœ€è¦ä¸€ä¸ªå­—å…¸ï¼Œå­˜å‚¨å®Œå…¨ä¸åŒçš„å¯¹è±¡ç±»å‹ã€‚æœ€å¥½å®¡æŸ¥ä½ çš„ä»£ç ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šéå¸¸ç—›è‹¦åœ°ç»´æŠ¤ã€‚

ä½ åˆšåˆšå¼€å§‹å­¦ä¹ æ–­è¨€ï¼Œä½†åœ¨æœ¬ä¹¦çš„åé¢éƒ¨åˆ†ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•å¤„ç†æ–­è¨€ã€‚

å½“ä½ éœ€è¦å¤„ç†æ²¡æœ‰æŒ‡å®šè¾“å…¥æˆ–è¾“å‡ºç±»å‹çš„å‡½æ•°æ—¶ï¼ŒSwift ä¸ºä½ æä¾›äº†æ³›å‹çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç« ä¸­äº†è§£æ›´å¤šå…³äºè¿™ä¸ªå†…å®¹ã€‚
