# 前言

在 Objective-C 中，管理内存是我们面临的最棘手的问题之一。这本书将为您提供有关您应用程序中有效内存管理的最重要信息。

实践元素也将确保程序员能够以更吸引人的方式积极学习内存管理的关键方法和概念，而不仅仅是简单地阅读书籍。在这本书的整个过程中，我将给出代码示例。

这些示例代码将展示编程和内存管理的根本原理，以及涵盖 iOS 开发的一些方面，如 Core Data。所有这些 Xcode 项目都可以直接运行，您不需要进行任何额外的设置即可运行代码。只需确保您拥有最新的 Xcode 版本，目前是版本 6。

因此，这本书将帮助你了解内存管理以及如何正确有效地实现它，同时让你意识到其带来的好处。这本基于教程的书籍将积极展示内存管理实现的技术，展示其对性能和有效实施的影响。

我必须提到，在这本书中，我将讨论 Objective-C 的最新标准和 Objective-C 2.0。苹果公司建议 Objective-C 作为他们平台的主要开发工具，并致力于持续改进产品。

我必须说，苹果公司尝试改进 Objective-C 的努力并非全部成功。垃圾回收就是一个无效的内存管理例子。自 OS X 版本 10.8 以来，它已被弃用，转而使用自动引用计数（ARC），并计划在未来的 OS X 版本中移除。

我已经使用 Objective-C 多年，C++则更久。因此，内存管理对我来说不是一个陌生的概念，因为我已经在 Azukisoft Pte Ltd 的工作中调试和追踪内存泄漏多年。

在 Azukisoft Pte Ltd 的工作中，我主要使用 Objective-C，偶尔也会用到 C++。这是一个非常有趣的组合，这本书也会对此进行重点介绍。

# 本书涵盖内容

第一章，*Objective-C 内存管理简介*，将向您介绍引用计数、手动保留释放（MRR）、对象所有权、沙盒生命周期和内存泄漏。

第二章，*自动引用计数*，将向您介绍 ARC 及其工作原理，其优势，以及如何设置项目以使用 ARC，Objective-C 中的内存模型，以及与 ARC 的 UIKit。

第三章，*使用自动释放池*，将向您介绍自动释放池，自动释放池的机制，Apple 自动释放类的概述，ARC 和自动释放，以及块和线程。

第四章, *对象创建和存储*，将涵盖创建对象的多种方式；不同内存管理选项的比较：ARC、MRC、自动释放池、垃圾回收、内存模型；以及@property 如何使您的生活更轻松。

第五章, *管理您的应用程序数据*，将涵盖磁盘缓存、UI 技术部分数据显示、序列化和归档对象、编码和解码对象的方法、需要 SQLite 的情况，以及 SQLite 与 Core Data 的比较。

第六章, *使用 Core Data 进行持久化*，解释了 Core Data 是什么以及为什么应该使用它，NSManagedObject 及其在您应用程序中的使用，使用 Core Data 时的内存管理，以及常见错误。

第七章, *键值编程方法*，解释了键值编码或 KVC 是什么，NSKeyValueCoding 协议，NSKeyValueCoding 行为的手动子集，关联对象，选择器作为键，最大灵活性，以及处理键/值。

第八章, *Swift 简介*，突出了 OS X 中的 Cocoa 绑定、自动与手动键值观察之间的差异，以及键值观察的实现方式。

第九章, *内存管理和调试*，涵盖了内存过度使用、收集应用程序数据、如何在 Xcode 中使用工具、使用 LLVM/Clang 静态分析器、使用 NSZombie 帮助查找过度释放的对象，以及处理泄漏。

第十章, *内存管理技巧和窍门*，解释了访问器方法的使用、使用属性声明访问器、性能指南，以及何时应避免 KVC 和 KVO。

第十一章, *Xcode 6 的功能*, 介绍了新的工具，如视图层次结构调试器、预览编辑器，以及新增的功能，如允许故事板和 NIBs 作为应用程序的启动图像，而不是仅仅使用静态图像。

# 本书所需条件

对于本书，您需要一个基于 Apple 的 Intel Macbook、iMac 或 Mac mini，2010 型号或更高版本，并已安装 Xcode，版本 4.3 或更高（可在 Mac Apple Store 获取）。

# 本书面向对象

本书特别为具有最少 Objective-C 或另一种面向对象编程语言经验的开发者以及具有最少编程逻辑、面向对象编程和 Apple OS X 环境知识的科技学生设计。

# 习惯用法

在本书中，您将找到多种文本样式，用于区分不同类型的信息。以下是一些这些样式的示例及其含义的解释。

文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称将如下所示："当你执行`new`、`malloc`或`alloc`时，操作系统所做的就是给你的程序在堆上分配一块内存。"

代码块设置如下：

```swift
int main(int argc, char *argv[]) {

  SomeObject *myOwnObject;
  // myOwnObject is created in main
   myOwnObject = [[SomeObject alloc] init];

    // myOwnObject can be used by other objects
  [anotherObject using:myOwnObject];
```

**新术语**和**重要词汇**将以粗体显示。您在屏幕上看到的单词，例如在菜单或对话框中，在文本中将以如下方式显示："在 Xcode 中，转到目标**构建阶段**选项卡，打开**编译源**组，你将能够看到源文件列表。"

### 注意

警告或重要提示将以这样的框中显示。

### 小贴士

小技巧和窍门将如下所示。

# 读者反馈

我们始终欢迎读者的反馈。请告诉我们您对这本书的看法——您喜欢或不喜欢的地方。读者反馈对我们来说很重要，因为它帮助我们开发出您真正能从中获得最大价值的标题。

要发送给我们一般性的反馈，只需发送电子邮件至`<feedback@packtpub.com>`，并在邮件主题中提及书籍的标题。

如果您在某个主题上具有专业知识，并且您对撰写或为书籍做出贡献感兴趣，请参阅我们的作者指南[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在您已经是 Packt 书籍的骄傲拥有者，我们有一些事情可以帮助您从您的购买中获得最大价值。

## 下载示例代码

您可以从您在[`www.packtpub.com`](http://www.packtpub.com)的账户下载示例代码文件，适用于您购买的所有 Packt 出版社的书籍。如果您在其他地方购买了这本书，您可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)，并注册以将文件直接通过电子邮件发送给您。

## 错误更正

尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在我们的某本书中发现了错误——可能是文本或代码中的错误——如果您能向我们报告这一点，我们将不胜感激。通过这样做，您可以节省其他读者的挫败感，并帮助我们改进本书的后续版本。如果您发现任何错误更正，请通过访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择您的书籍，点击**错误更正提交表单**链接，并输入您的错误更正详情。一旦您的错误更正得到验证，您的提交将被接受，错误更正将被上传到我们的网站或添加到该标题的错误更正部分下的现有错误更正列表中。

要查看之前提交的勘误表，请访问[`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)，并在搜索字段中输入书籍名称。所需信息将显示在**勘误**部分。

## 盗版

互联网上对版权材料的盗版是一个跨所有媒体的持续问题。在 Packt，我们非常重视我们版权和许可证的保护。如果您在互联网上发现我们作品的任何非法副本，请立即提供位置地址或网站名称，以便我们可以寻求补救措施。

请通过`<copyright@packtpub.com>`与我们联系，并提供涉嫌盗版材料的链接。

我们感谢您在保护我们作者和我们为您提供有价值内容的能力方面的帮助。

## 问题

如果您在这本书的任何方面遇到问题，您可以通过`<questions@packtpub.com>`联系我们，我们将尽力解决问题。
