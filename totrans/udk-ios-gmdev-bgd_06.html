<html><head></head><body><div class="chapter" title="Chapter&#xA0;6.&#xA0;Bringing it All Together"><div class="titlepage"><div><div><h1 class="title"><a id="ch06"/>Chapter 6. Bringing it All Together</h1></div></div></div><div class="blockquote"><blockquote class="blockquote"><p>In the previous chapter we created a series of sequences and prefabs giving us a solid background for creating different types of assets in our level and giving us some more in depth knowledge of using Kismet as well as an introduction to Prefabs to help us.</p><p>In this chapter we are going to expand on the items learned in the previous chapters and "bring it all together" to create our game, Urban Warrior.</p></blockquote></div><p>In this chapter we will cover the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Setting up our room, learning about adjusting materials to fit your level's needs</li><li class="listitem" style="list-style-type: disc">Learn the best way to rapidly prototype levels using reference and placeholder brushes to stand in for art</li><li class="listitem" style="list-style-type: disc">Discuss a possible workflow for creating levels using<span class="strong"><strong> Geometry Mode</strong></span></li><li class="listitem" style="list-style-type: disc">Build our level using pieces we've already built, duplicating work we've already done to make building quicker and more streamlined</li><li class="listitem" style="list-style-type: disc">Construct different combat scenarios</li></ul></div><p>So with that, let's get started!</p><div class="section" title="Starting a workflow"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec01"/>Starting a workflow</h1></div></div></div><p>When I first started using Unreal it took me a lot time to create any type of new level. I would keep placing static meshes to hide areas of geometry that I missed, or adding in blocking volumes in order to make it actually possible to go through some places. One of the key reasons I had problems was that I didn't realize how to create a good workflow, and the key to mapping things in CSG super easily is<span class="strong"><strong> Geometry Mode</strong></span>. Before we take care of that, let's first get our current level ready.<a class="indexterm" id="id345"/>
</p></div></div>
<div class="section" title="Time for action&#x2014;starting our level"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec02"/>Time for action—starting our level</h1></div></div></div><p>We are now building our level from scratch using the pieces that we have built in previous chapters. As we already have a basis to draw from let's start our game off. We can start our level as follows:<a class="indexterm" id="id346"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In the Editor, select our<span class="strong"><strong> PlayerStart</strong></span> actor. Move it to the left-hand side of the first door in our level by using Translation Mode.</li><li class="listitem">Move the spawn point for our first enemy to be in front of the door using<span class="strong"><strong> Translation Mode</strong></span>. There is a small light blue colored arrow on the actor. The arrow represents the direction in which the actor is facing. With that in mind, rotate the enemy's position in Rotation mode so it is facing away from the hero.</li><li class="listitem">Move the<span class="strong"><strong> PathNode</strong></span> such that the second enemy is spawned right in front of the door through which it comes (the second door to the right).</li><li class="listitem">Left-click on your current floor of the level and move it down by 32 units, using the grid snap by pressing the<span class="emphasis"><em> [</em></span> and<span class="emphasis"><em> ]</em></span> keys will decrease and increase the grid snap points until you get there.</li><li class="listitem">Change the<span class="strong"><strong> World Properties</strong></span> by selecting<span class="strong"><strong> View</strong></span> |<span class="strong"><strong> World Properties</strong></span> and set the<span class="strong"><strong> Kill Z</strong></span> to<span class="strong"><strong> -64</strong></span> so we won't die when we hit the floor.</li><li class="listitem">Create three walls to encase our hero at his starting point as well as a ceiling above him and floor below him all with a width of<span class="strong"><strong> 32</strong></span>. Create the first wall, then by holding<span class="emphasis"><em> Alt</em></span> and dragging the wall in the top viewport, duplicate the original wall to the other side.</li><li class="listitem">In front of our door make a duplicate of our floor by moving it 64 units in front, along the axis. Go into<span class="strong"><strong> Geometry</strong></span> mode and hold the<span class="emphasis"><em> Ctrl</em></span> +<span class="emphasis"><em> Alt</em></span> keys and drag until you select both the vertices on the left-hand side in the top viewport. Drag the floor until it faces the door. Select the two vertices at the top and drag it down until it is in front of the door, and do the same for the bottom. At this point you should have a box in front of your door.</li><li class="listitem">Right-click on the side viewport and select<span class="strong"><strong> Viewport Type</strong></span> |<span class="strong"><strong> Front</strong></span> to place the view into the front mode. Our screen should look like the following screenshot by now.<div class="mediaobject"><img alt="Time for action—starting our level" height="156" src="graphics/image_1901_06_01.jpg"/></div></li><li class="listitem">At that point in<span class="strong"><strong> Geometry</strong></span> mode select our box and only click on the top right vertex. From there use the translation tool to move it to the left by 64 degrees coming to the same point as the other vertices at the top, as shown in the following image:<a class="indexterm" id="id347"/><div class="mediaobject"><img alt="Time for action—starting our level" src="graphics/image_1901_06_02.jpg" width="243"/></div></li><li class="listitem">Build the map by selecting<span class="strong"><strong> Build</strong></span> |<span class="strong"><strong> Build All</strong></span>. You should see a ramp going into your room that we created.<a class="indexterm" id="id348"/></li><li class="listitem">Return the viewport back to its previous position by right-clicking and selecting<span class="strong"><strong> Viewport Type</strong></span> |<span class="strong"><strong> Side</strong></span>.</li><li class="listitem">Press<span class="emphasis"><em> L</em></span> in the center of the room to create a light. Selecting the light, put it in the direct center of the room in the X, Y, and Z axes. Open the<span class="strong"><strong> PointLight actor</strong></span> properties, change its radius to<code class="literal"> 512</code>, and its<span class="strong"><strong> Falloff Exponent</strong></span> to<code class="literal"> 16</code>. Inside the<span class="strong"><strong> Light Component</strong></span> set the light color to a light blue and change the brightness to<code class="literal"> 0.6</code>. Press<span class="emphasis"><em> Alt</em></span> +<span class="emphasis"><em> 3</em></span> to go into Unlit mode until you are ready to see the game's lighting, but you will have to build every time you change something to see it correctly.<a class="indexterm" id="id349"/><p>Having a good reference can be key when creating new areas or gameplay. Characters in Unreal are defaulted to 96 units tall and while we can create a box of that size or right-click to get the measuring tape out to adjust, we can just place a mesh in our level to give us an idea of human proportions. Note that this is the character size of Epic Games' characters, but UDK does not limit the size of your characters. If you wish to create your own custom characters you may do so, but it is important that no matter what you remain consistent.
</p></li><li class="listitem">Go into the<span class="strong"><strong> Content Browser</strong></span> and scroll your<span class="strong"><strong> Packages</strong></span> column until you can click on<span class="strong"><strong> UDK Game</strong></span>. With that selected type<code class="literal"> Iron</code> in the search bar while checking the<span class="strong"><strong> Skeletal Mesh</strong></span> option in the<span class="strong"><strong> Object Type</strong></span> field. Left-click on the<span class="strong"><strong> IronGuard Skeletal Mesh</strong></span>. Right-click in our level and place the object on top of the ground in our level. Note that you may have to move the mesh and adjust your grid spacing to get it just right. The following screenshot shows this process.<div class="mediaobject"><img alt="Time for action—starting our level" src="graphics/image_1901_06_03.jpg" width="227"/></div><p>Having a reference is a great thing, especially if you are trying to recreate a real life building, however note that often at times in games you will have to compensate for different aspects of the world due to the differences in both gameplay and camera work. For example, hallways in games are usually two to three times larger than they would really be especially in games that can be multiplayer, such as <span class="emphasis"><em>Left 4 Dead</em></span>.
<a class="indexterm" id="id350"/>
</p></li><li class="listitem">Left-click on our new actor and open up its properties by clicking<span class="emphasis"><em> F4</em></span>. Type<code class="literal"> Hidden</code> in the search bar and check the<span class="strong"><strong> Hidden Game</strong></span> property.<a class="indexterm" id="id351"/><p>Since we are in the games ourselves we don't need to see our reference, however if you'd like to keep our new actor in until you're ready then by all means go for it.
</p></li><li class="listitem">Select the walls inside of our room by left-clicking on them in the perspective viewport.</li><li class="listitem">Select the other walls in the room, taking care to remember that the door has two parts and a top. You can do this by holding<span class="emphasis"><em> Ctrl</em></span> and clicking on each of the elements or right-clicking and selecting<span class="strong"><strong> Select Adjacent Walls</strong></span>, but this option may also select the walls outside of the building as well. Also select the inside of the door, pressing<span class="emphasis"><em> Alt</em></span> +<span class="emphasis"><em> W</em></span> to hide static meshes to select them, remembering to press<span class="emphasis"><em> Alt</em></span> +<span class="emphasis"><em> W</em></span> again when finished.<a class="indexterm" id="id352"/></li><li class="listitem">Go to the<span class="strong"><strong> Content Browser</strong></span> and pick out a wall material to use. I personally used<code class="literal"> M_LT_Walls_BSP_Recycle06b</code> which is located in the<span class="strong"><strong> LT_Walls</strong></span> package. Once you have left-clicked on the material you wanted to use, right-click on a selected wall in the perspective viewport and select<span class="strong"><strong> Add Material : M_LT_Walls_BSP_Recycle06b</strong></span>. The following image shows the material that has been added to the walls:<div class="mediaobject"><img alt="Time for action—starting our level" src="graphics/image_1901_06_04.jpg" width="227"/></div><p>Now you may notice that the material may look a bit off in terms of placement and how it doesn't match up; that's okay because that is what we're going to fix next.
</p></li><li class="listitem">Press<span class="emphasis"><em> F5</em></span> to enter the<span class="strong"><strong> Surface</strong></span> properties menu. The first and easiest step is to change our alignment so that the brushes will work together so we have a seamless transition between brushes. To do this, find the<span class="strong"><strong> Alignment</strong></span> property, click on the<span class="strong"><strong> Box</strong></span> selection and click on<span class="strong"><strong> Apply</strong></span>. Since our object is in fact shaped similarly to a box, it makes sense that the material can be applied this way, as shown in the following screenshot:<a class="indexterm" id="id353"/><div class="mediaobject"><img alt="Time for action—starting our level" src="graphics/image_1901_06_05.jpg" width="76"/></div><p>However, I think that the texture is too small for the room I created; this is a simple fix as well. Above the <span class="strong"><strong>Alignment</strong></span> box there is another area of the properties called <span class="strong"><strong>Scaling</strong></span>. Under the <span class="strong"><strong>Simple</strong></span> Option select <code class="literal">2.0</code> and click on the <span class="strong"><strong>Apply</strong></span> button. Now our texture is twice as big as it was before. The <span class="strong"><strong>Scaling</strong></span> box is shown in the following screenshot:
<a class="indexterm" id="id354"/>
</p><div class="mediaobject"><img alt="Time for action—starting our level" height="58" src="graphics/image_1901_06_06.jpg"/></div></li><li class="listitem">Now, we're on the right track, but I want to move the image down and over until I get to just the right place I want the texture to be. Panning the material will do just that. Adjust the<span class="strong"><strong> U</strong></span> and<span class="strong"><strong> V</strong></span> position of the texture by clicking on the buttons until you get the position you want for the material. I personally took the silvery part and made it a baseboard of sorts for my room. This is shown in the following screenshot:<div class="mediaobject"><img alt="Time for action—starting our level" height="63" src="graphics/image_1901_06_07.jpg"/></div></li><li class="listitem">Choose a ceiling and floor material for your room. I personally used<span class="strong"><strong> Material'LT_Floors.BSP.Materials.M_LT_Floors_BSP_Grate_Pipes'</strong></span> for the ceiling and<span class="strong"><strong> Material'LT_Floors.BSP.Materials.M_LT_Floors_BSP_Organic05b_TileBreak'</strong></span> for the floor.</li><li class="listitem">Now that we have our new base room completed, click on the door that we created on the right and delete it, saying<span class="strong"><strong> Yes</strong></span> to the warning generated.<a class="indexterm" id="id355"/></li><li class="listitem">Inside the top viewport hold the<span class="emphasis"><em> Ctrl</em></span> +<span class="emphasis"><em> Alt</em></span> keys and drag until you have the entire room we created selected. Go to<span class="strong"><strong> Geometry</strong></span> mode and right-click on the top right vertices to change the position of our translate tool. Hold<span class="emphasis"><em> Alt</em></span> and drag the item to the right-hand side so that it would be where the previous door would have been. Right-click and select<span class="strong"><strong> Transform</strong></span> |<span class="strong"><strong> Mirror Y Axis</strong></span> and move the room until it creates a room in front of the one that we previously created. Delete any extra<span class="strong"><strong> PathNodes</strong></span> or<span class="strong"><strong> PlayerStart</strong></span> actors you may have created.</li><li class="listitem">Build our game by selecting<span class="strong"><strong> Build</strong></span> |<span class="strong"><strong> Build All</strong></span> and click on<span class="strong"><strong> Close</strong></span> when finished.</li><li class="listitem">Save your project and start your game by clicking on the<span class="strong"><strong> Start Mobile Previewer</strong></span> button on the main toolbar, saying<span class="strong"><strong> yes</strong></span> when it asks you to save the package. The following screenshot shows how our screen would look:<div class="mediaobject"><img alt="Time for action—starting our level" src="graphics/image_1901_06_08.jpg" width="263"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec01"/>What just happened?</h2></div></div></div><p>Taking the advice of our former selves our very short scenario is a lot more guided and our world making the game little closer to building our real game. Taking this into consideration we will be able to create a larger environment and complete our sample level.<a class="indexterm" id="id356"/>
</p></div></div>
<div class="section" title="Geometry mode"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec03"/>Geometry mode</h1></div></div></div><p>We talked about building a simple room earlier in the book, and when we created our doorway in <a class="link" href="ch04.html" title="Chapter 4. Using Kismet and Matinee">Chapter 4</a>,<span class="emphasis"><em> Using Kismet and Matinee</em></span>, we began to explore<span class="strong"><strong> Geometry Mode</strong></span> and how we can use it. In much the same way we can use it to create gameplay areas quickly and effectively.<a class="indexterm" id="id357"/>
</p><div class="section" title="Setting up the workflow"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec02"/>Setting up the workflow</h2></div></div></div><p>You may have noticed a grid of sorts in all the viewports other than the perspective one. We will be using the grid as a guideline in the creation of our levels in much the same way that you could use paper to draw things out, which is something some level designers I know do to get the general feel of an area. In order to build a general area you need to have this planned ahead of time—things such as having a general idea of how you want to place buildings, as well as an idea of how you want to guide the traversal of the player.<a class="indexterm" id="id358"/>
</p><p>As mentioned before, pressing the<span class="emphasis"><em> [</em></span> and<span class="emphasis"><em> ]</em></span> keys in the editor will decrease and increase the grid snap points making the level more or less detailed in your brush placement. For the purposes of this book, unless I say differently, I have my grid spacing set to 32. Some people will want to use a smaller area, but I argue that when blocking something out we really only care about the big picture and getting the overall feel of the area. In case your brush is not aligned to the grid you can right-click on the vertices, and it will automatically snap it to the grid. If you notice the brush changing to have an<span class="strong"><strong> X</strong></span> on it, which is alright, but it is advisable to go to the<span class="strong"><strong> Brush Properties</strong></span> and reapply collision to it. This can be extremely useful, especially when working on the things discussed in previous chapters to get it to fit in line with the grid you are now using. Working with the grid is a fundamental way of making sure that you are not getting any holes and/or overlays of your brushes when creating a level. This is another way to make sure that your subtractive brushes will work as you intend them to; however I never use subtractive brushes if I can at all help it.<a class="indexterm" id="id359"/>
</p><p>One thing to note when using<span class="strong"><strong> Geometry</strong></span> mode: you will not see any changes that we make when editing in<span class="strong"><strong> Geometry</strong></span> mode until we build our BSP brushes again.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;" title="Note"><h3 class="title"><a id="tip05"/>Tip</h3><p>In all of the Unreal Tournament games (and<span class="strong"><strong> UTDeathmatch</strong></span> games like we're using), 1 Unreal Unit is equal to 2 centimeters. That means that the 96 Unit character is in fact 6 feet tall! That being said, building things to scale can often seem much smaller than they really are because of the players field of view(FOV)" but it's a nice thing to use as a basis when building from real life.</p></div></div><div class="section" title="Some keyboard tips"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec03"/>Some keyboard tips</h2></div></div></div><p>Holding<span class="emphasis"><em> Ctrl</em></span> +<span class="emphasis"><em> Alt</em></span> at the same time and dragging will allow you to select all objects that are contained within it. If you are in<span class="strong"><strong> Geometry</strong></span> mode it will allow you to select individual/overlapping vertices, allowing you to increase or decrease the size of your brushes very easily, which we will be using to create our buildings in the next section.<a class="indexterm" id="id360"/>
</p><p>Another useful tip is if you hold<span class="emphasis"><em> Ctrl</em></span> and drag the left mouse button anywhere in a viewport it will move the brush, actor, and/or vertices that you have selected from any position. This is a good way to move objects that may not be far away or when you don't have to move the screen and don't want to use the widget that is usually used by the object.</p><p>If you just left-click on a brush in the perspective viewport it will select the face of the object. While this is fine for putting a material on the brush, on the other viewports it will select the brush for editing. If you hold<span class="emphasis"><em> Ctrl</em></span> +<span class="emphasis"><em> Shift</em></span> and left-click on your map you will notice that you will now select the brush that you clicked on. However, it can sometimes not pick the brush that you think you're selecting, which is why I primarily use the top and/or side viewport.</p></div><div class="section" title="Seeing double"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec04"/>Seeing double</h2></div></div></div><p>Duplicating things that we have already created such as walls or buildings is an effective way of blocking out an environment very quickly. We did this in our previous example by duplicating the room that we created. What we care about most here is creating the best gameplay possible, so we pay less attention to fine details and basically want to just block out an area so we can iterate as quickly as possible. After all, you'd be a lot more willing to get rid of a huge box than a ridiculously detailed office building.</p><p>With the brushes we create we can then give the level to your team's environmental artist (or you if you are gifted with 3D modeling knowledge), who will in turn change the BSP brushes into meshes to place in our level to give it the visual flair that we are looking for.</p><p>After placing a single brush in our level, you don't really need the builder brush again. Unless you are creating something other than a box you can just duplicate brushes and mould them using the<span class="strong"><strong> Geometry</strong></span> tool to quickly shape out areas, which usually makes it much quicker to build. If you too feel as if you can live without the builder brush, you can press the<span class="emphasis"><em> B</em></span> key to toggle the building brush on and off.<a class="indexterm" id="id361"/>
</p></div></div>
<div class="section" title="Building our level"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec04"/>Building our level</h1></div></div></div><p>With knowledge of how to start a workflow, we can now apply that knowledge by building the rest of our level!</p></div>
<div class="section" title="Time for action&#x2014;building our level"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec05"/>Time for action—building our level</h1></div></div></div><p>Now that the beginning of our level is completed, let's add simple buildings and shapes that we can fill with the scripting we created earlier! This is done as follows:<a class="indexterm" id="id362"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">From the top viewport duplicate one of the walls from the rooms that we made previously by left-clicking on it, holding<span class="emphasis"><em> Alt</em></span> and dragging it down, placing the top end so that the wall covers up the gap between the two doors. In<span class="strong"><strong> Geometry</strong></span> mode grab the two bottom vertices and drag them down to create a square like shape and then in the side viewport drag the vertices up in order to create a building. This is how our screen would look.<div class="mediaobject"><img alt="Time for action—building our level" height="137" src="graphics/image_1901_06_09.jpg"/></div></li><li class="listitem">With that first building created we can build others quite easily. Duplicate it by dragging and create three buildings of different sizes to create a blocking path leading the player towards the left. The following screenshot shows this.<a class="indexterm" id="id363"/><div class="mediaobject"><img alt="Time for action—building our level" height="173" src="graphics/image_1901_06_10.jpg"/></div></li><li class="listitem">Not only can we extend and modify brushes, we can also modify volumes! Extend our current<span class="strong"><strong> Lightmass Importance Volume</strong></span> and floor by selecting both of the objects and dragging them out.<a class="indexterm" id="id364"/><div class="mediaobject"><img alt="Time for action—building our level" height="86" src="graphics/image_1901_06_11.jpg"/></div></li><li class="listitem">Left-click on one of the prefab doors that we have created and create another door, a little distance after the player turns left, making sure to lower the door down so it fits nicely with the ground. We do not want the door to go as far out as the previous version that we created, so select the top six points and drag the door over, adjusting the two at the top afterwards, to create an even door. However, the KActor of the door itself will not change, so right-click on the prefab and select<span class="strong"><strong> Convert PrefabInstance into Normal Actors</strong></span>. From there, you can move the door into its proper spot using the top and side viewports as your guide, building when necessary to help you visualize what the level looks like.</li><li class="listitem">Duplicate buildings changing the heights, placing one to the north of the new door that we added and another north of it to open up a little area for the player to explore. This can be seen in the following top viewport screenshot.<div class="mediaobject"><img alt="Time for action—building our level" src="graphics/image_1901_06_12.jpg" width="205"/></div><div class="mediaobject"><img alt="Time for action—building our level" height="177" src="graphics/image_1901_06_13.jpg"/></div><p>Note that I purposefully made the building in front of the door's holder to show the player that there is a path that can be taken giving the player a sense of choice in the level.
<a class="indexterm" id="id365"/>
</p><p>At this point, the player can choose one of two paths, which we will converge into a large area. Create buildings of different sizes and shapes to fill a center courtyard, taking care to make the buildings on the furthest north side the lowest of the bunch as that is where we are going to lead the player.
<a class="indexterm" id="id366"/>
</p><div class="mediaobject"><img alt="Time for action—building our level" src="graphics/image_1901_06_14.jpg" width="265"/></div></li><li class="listitem">In the center of our courtyard place an elevated pedestal by first creating a box around 32 units high. Build the map then left-click on the face of the brush in the perspective viewport. Change to Scaling mode and shrink the top face. If you build the game you will notice that now the brush has slants. Play the game to make sure that you can walk up and down on the pedestal before moving forward.<p>Elevated ground will draw the player to this position, plus we will place enemies there later so it's a good way to draw attention to the area.
</p></li><li class="listitem">Create ramps leading to the top of the furthest building in much the same way we created ramps for our first room. I personally created a ramp forward, then a straight part and then another ramp for a left turn. This could be done as a fire escape, but we basically want to communicate to the player to go here, as shown in the following screenshot:<div class="mediaobject"><img alt="Time for action—building our level" src="graphics/image_1901_06_15.jpg" width="183"/></div></li><li class="listitem">Expand both your floor and<span class="strong"><strong> lightmass Importance Volume</strong></span> in both the north and east directions by selecting the two vertices at the top and dragging north, then selecting the two vertices on the right-hand side and dragging them east.<a class="indexterm" id="id367"/></li><li class="listitem">Create buildings in order to create an enclosed area leading towards a final location which you will leave open and will be four grid squares wide at a grid snap of 128.<div class="mediaobject"><img alt="Time for action—building our level" src="graphics/image_1901_06_16.jpg" width="280"/></div></li><li class="listitem">At the center of the open space that you have created place the<code class="literal"> StaticMesh'ASC_Floor2.SM.Mesh.S_ASC_Floor2_SM_Stairs_Simple_01'</code>. To each of its sides create a ramp shape to cover up its sides.</li><li class="listitem">Above the two ramps that you have created create two vertically large pillars. On the top of the pillar place another brush that is slanted.</li><li class="listitem">Create a ceiling and a floor to the entrance we've created.<a class="indexterm" id="id368"/></li><li class="listitem">Take the two long pillars that we created and duplicate them within the temple.</li><li class="listitem">Past the second pillar create a secondary flight of stairs and a floor ahead for its elevated path.</li><li class="listitem">In front of the floor place a single wall behind it and walls on the sides of the temple.</li><li class="listitem">In front of the second flight of stairs place a<code class="literal"> StaticMesh'NR_Deco.SM.Mesh.S_NR_Deco_SM_FountainTop03'</code> and above it<code class="literal"> ParticleSystem'Castle_Assets.FX.P_FX_Fire_SubUV_01'</code> and above that a spot light (by pressing<span class="emphasis"><em> L</em></span> and clicking inside the viewport where you want it to be placed) with a radius of<code class="literal"> 1024</code>, a<code class="literal"> .3</code> brightness, and a dark red color. Inside the<span class="strong"><strong> lightmass</strong></span> settings change the light source to<code class="literal"> 32</code> and duplicate the items to the other side of the stairs as well.<a class="indexterm" id="id369"/><div class="mediaobject"><img alt="Time for action—building our level" height="130" src="graphics/image_1901_06_17.jpg"/></div></li><li class="listitem">Now do a quick texture pass by using<code class="literal"> Material'LT_Floors.BSP.Materials.M_LT_Floors_BSP_Dark_TileBreak_02'for</code> the walls and<code class="literal"> Material'LT_Floors.BSP.Materials.M_LT_Floors_BSP_Organic05b_TileBreak'</code> for the floor and ceiling of our temple. Select all of the materials and give it a simple scaling of<code class="literal"> 4.0</code>.</li><li class="listitem">Select the<span class="strong"><strong> Dominant Directional Light</strong></span> actor and change its light color to dark blue.</li><li class="listitem">Outside the player's path but in their view, place some<code class="literal"> StaticMesh'LT_Mech.SM.Mesh.S_LT_Mech_SM_CityNoRing01'</code> actors to create scenery for our level. Note that this mesh was created for the PC multiplayer title Unreal Tournament 3 and has in no way been optimized for a mobile game. That being said, don't place more than four in the level or else the game will really start to slow down when we test it. The following screenshot is what the finished level will look like:<div class="mediaobject"><img alt="Time for action—building our level" height="174" src="graphics/image_1901_06_18.jpg"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec05"/>What just happened?</h2></div></div></div><p>Our level now has a clear beginning, middle, and end. The goals for the player to go to as well as some backdrop and lighting effects are visible. Now all we need to do is add our interactive elements and we will have our game completed!<a class="indexterm" id="id370"/>
</p></div><div class="section" title="Have a go hero—powerups and weapon pickups"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec06"/>Have a go hero—powerups and weapon pickups</h2></div></div></div><p>One of the tools that level designers have is the ability to reward players for traveling certain ways. Promoting exploration and giving players reason to go out will make your level much more interesting. Inside the<span class="strong"><strong> Actor</strong></span> classes tab there is a class called<span class="strong"><strong> UTPickupFactory</strong></span> with both<span class="strong"><strong> Health</strong></span> and<span class="strong"><strong> Weapon</strong></span> pickups. Try to place some goodies in your newly created level. I personally put a rocket launcher in the area leading up to the temple.</p></div></div>
<div class="section" title="Combat scenarios"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec06"/>Combat scenarios</h1></div></div></div><p>As we are in fact making a third person shooter, it makes sense that we would want to have different combat scenarios in our game. After completing our level's layout we will now add the things that will make our level come alive! We went over the creation of enemies as well as advice on combat scenarios in the previous chapter, so now we will be acting upon these lessons to create our own game.<a class="indexterm" id="id371"/>
</p></div>
<div class="section" title="Time for action&#x2014;first combat scenario"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec07"/>Time for action—first combat scenario</h1></div></div></div><p>We will be using trigger volumes to spawn enemies and have them interact in your environment. This can be done as follows:<a class="indexterm" id="id372"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In the Editor, duplicate the top part of the door that goes into the second area and move it so that its front is joined with the building we created with the split. Right-click on the actor and select<span class="strong"><strong> Convert</strong></span> |<span class="strong"><strong> Convert to Volume</strong></span> |<span class="strong"><strong> Trigger Volume</strong></span>. After this go to the side viewport and adjust the bottom vertices so they hit the floor. Hint: Pressing<span class="emphasis"><em> Alt</em></span> +<span class="emphasis"><em> W</em></span> will make the static meshes that we've placed previously disappear. The following screenshot shows this:<a class="indexterm" id="id373"/><div class="mediaobject"><img alt="Time for action—first combat scenario" src="graphics/image_1901_06_19.jpg" width="396"/></div></li><li class="listitem">Duplicate the trigger volume that we have just created and place it directly above where this one is. This way, no matter which way the player chooses to go something will happen.<a class="indexterm" id="id374"/></li><li class="listitem">We will place two path nodes behind each of the two routes we have created as well as two path nodes in the middle. What we are going to do is spawn two enemies when the player hits one of these triggers, and the two enemies will travel along the path the player first chose, as shown in the following screenshot:<div class="mediaobject"><img alt="Time for action—first combat scenario" src="graphics/image_1901_06_20.jpg" width="356"/></div><p>Left-click on the trigger volume at the top that we created and open Kismet. Create a <span class="strong"><strong>TriggerVolume Touch</strong></span> event by choosing <span class="strong"><strong>New Event using TriggerVolume_5</strong></span> | <span class="strong"><strong>Touch</strong></span> from the menu that pops up.
</p></li><li class="listitem">Left-click on the trigger volume that we created at the bottom and open Kismet. Create a<span class="strong"><strong> TriggerVolume Touch</strong></span> event beneath the one that we just created by choosing<span class="strong"><strong> New Event using TriggerVolume_6</strong></span> |<span class="strong"><strong> Touch</strong></span> from the menu that pops up.</li><li class="listitem">Create a<span class="strong"><strong> Toggle</strong></span> action by right-clicking and selecting<span class="strong"><strong> New Action</strong></span> |<span class="strong"><strong> Toggle</strong></span> |<span class="strong"><strong> Toggle</strong></span>. Connect the<span class="strong"><strong> Event</strong></span> link to the top of the<span class="strong"><strong> TriggerVolume_5 Touch</strong></span> action. Connect the<span class="strong"><strong> Out</strong></span> output of the<span class="strong"><strong> TriggerVolume_6 Touch</strong></span> action to the<span class="strong"><strong> Turn Off</strong></span> input of this Toggle action.<a class="indexterm" id="id375"/></li><li class="listitem">Create another toggle action to turn the other action off if this one is called. The following screenshot shows what we've done so far:<div class="mediaobject"><img alt="Time for action—first combat scenario" src="graphics/image_1901_06_21.jpg" width="206"/></div></li><li class="listitem">For each of the two paths, create two set<span class="strong"><strong> Object</strong></span> actions by selecting<span class="strong"><strong> New Action</strong></span> |<span class="strong"><strong> Set Variable</strong></span> |<span class="strong"><strong> Object</strong></span>. Under the<span class="strong"><strong> Value</strong></span> variable link place the two top path nodes we created to the top trigger and the bottom two to the other. Don't worry about the target yet, we will come to that in a later step.</li><li class="listitem">Copy and paste two copies of the<span class="strong"><strong> EnemyAI</strong></span> subsequence that we created earlier right next to each other. Connect the<span class="strong"><strong> Out</strong></span> of both the second<span class="strong"><strong> Set Object</strong></span> variable outputs to the<span class="strong"><strong> In</strong></span> of the first<span class="strong"><strong> EnemyAI</strong></span> object and the<span class="strong"><strong> Spawned</strong></span> output of the first connects to the<span class="strong"><strong> In</strong></span> of the second. Create an Object variable underneath the<span class="strong"><strong> Spawned</strong></span> link for each node and make the two path nodes we placed out of player sight as the spawn points for both objects.<a class="indexterm" id="id376"/></li><li class="listitem">Create a<span class="strong"><strong> Move To Actor</strong></span> action by right-clicking and selecting<span class="strong"><strong> New Action</strong></span> |<span class="strong"><strong> AI</strong></span> |<span class="strong"><strong> Move To Actor</strong></span>. Underneath the<span class="strong"><strong> Target</strong></span> variable link connect the first spawned object that we created. Under<span class="strong"><strong> Destination</strong></span> create an<span class="strong"><strong> Object</strong></span> variable and connect it. Connect the<span class="strong"><strong> Spawned</strong></span> output from the<span class="strong"><strong> EnemyAI</strong></span> action to the<span class="strong"><strong> In</strong></span> input on the<span class="strong"><strong> Move To Actor</strong></span> action. Also, in the<span class="strong"><strong> Set variable</strong></span> actions that we discussed in Step 5 connect the<span class="strong"><strong> Target</strong></span> variable link for the first object in each row to this object.</li><li class="listitem">Now create a second<span class="strong"><strong> Move to Actor</strong></span> action using the<span class="strong"><strong> Spawned</strong></span> variable link of the second<span class="strong"><strong> EnemyAI</strong></span> as the<span class="strong"><strong> Target</strong></span> and create a new<span class="strong"><strong> Object</strong></span> variable under the<span class="strong"><strong> Destination</strong></span> link, which you will set as the<span class="strong"><strong> Target</strong></span> of the second<span class="strong"><strong> Set Object</strong></span> in each path.<div class="mediaobject"><img alt="Time for action—first combat scenario" height="105" src="graphics/image_1901_06_22.jpg"/></div><p>At some point during this tutorial you may see a problem and/or an error in your project saying something along the lines of <span class="strong"><strong>SeqAct_ActorFactory_0 has no spawn points!</strong></span> In that case, go into Kismet where that problem node is, double click on it to select it in the editor and double-click on the <span class="strong"><strong>Enemy_AI Sequence</strong></span> it contains. At the <span class="strong"><strong>Actor Factory</strong></span> action click on the plus icon to add a new item to the spawn point list and if it isn't filled already click on the arrow pointing left in order to fill the value with the object we have selected. Exit the subsequence and hook up the items again that were attached to it. When you run your game next it should start working again.
</p></li><li class="listitem">Build our game by selecting<span class="strong"><strong> Build</strong></span> |<span class="strong"><strong> Build All</strong></span> and click<span class="strong"><strong> Close</strong></span> when finished.</li><li class="listitem">Save your project and start your game by clicking on the<span class="strong"><strong> Start Mobile Previewer</strong></span> button on the main toolbar. The game's preview should look like the following screenshot:<a class="indexterm" id="id377"/><div class="mediaobject"><img alt="Time for action—first combat scenario" src="graphics/image_1901_06_23.jpg" width="202"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec07"/>What just happened?</h2></div></div></div><p>With only a little bit of effort we have easily created a second combat encounter in the game that adjusts itself based on player actions.</p></div><div class="section" title="Have a go hero—creating your own combat encounter"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec08"/>Have a go hero—creating your own combat encounter</h2></div></div></div><p>The next section I am going to leave as a blank area for you to create some kind of combat encounter of your own. You can place pieces of cover, or alternate weapons. Try to think of something that will really make someone say, "Wow!" when they see it.<a class="indexterm" id="id378"/>
</p></div></div>
<div class="section" title="Time for action&#x2014;end of level"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec08"/>Time for action—end of level</h1></div></div></div><p>We will be using trigger volumes to spawn enemies and have them interact in your environment.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Place a trigger volume in front of the temple that we created earlier. At the back of the temple as well as behind the second pillar place path nodes on both sides, away from the player's line of sight. This is shown by the top viewport screenshot:<a class="indexterm" id="id379"/><div class="mediaobject"><img alt="Time for action—end of level" src="graphics/image_1901_06_24.jpg" width="178"/></div><p>This is how it will look in the game.</p><div class="mediaobject"><img alt="Time for action—end of level" src="graphics/image_1901_06_25.jpg" width="193"/></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;" title="Note"><h3 class="title"><a id="note19"/>Note</h3><p>Press the<span class="emphasis"><em> P</em></span> button to see the paths that have been created by your path nodes. If you do not see any lines in-between the two sets of nodes you may have to place one or two extra nodes to make sure the enemies' paths are laid out correctly.</p></div></li><li class="listitem">Left-click on our trigger volume and create a<span class="strong"><strong> Trigger Volume Touch</strong></span> event in Kismet.<a class="indexterm" id="id380"/></li><li class="listitem">Copy and paste the two<span class="strong"><strong> EnemyAI</strong></span> and<span class="strong"><strong> Move to Actor</strong></span> actions from the previous example and hook it up to the<span class="strong"><strong> Trigger Volume Event.</strong></span><a class="indexterm" id="id381"/></li><li class="listitem">Delete the spawn point links and replace them with the two nodes at the top of the temple. Delete the<span class="strong"><strong> Destination</strong></span> links in the<span class="strong"><strong> Move to Actor</strong></span> events and have them travel to the path nodes in the front.</li><li class="listitem">Duplicate your trigger volume and put it at the top of the temple's hill. Create a Touch event with a<span class="strong"><strong> Console Command</strong></span> event with<span class="strong"><strong> quit</strong></span> at the prompt.<a class="indexterm" id="id382"/></li><li class="listitem">Build our game by selecting<span class="strong"><strong> Build</strong></span> |<span class="strong"><strong> Build All</strong></span> and click on<span class="strong"><strong> Close</strong></span> when finished.</li><li class="listitem">Save your project and start your game by clicking on the<span class="strong"><strong> Start Mobile Previewer</strong></span> button on the main toolbar.</li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec09"/>What just happened?</h2></div></div></div><p>We created a new combat scenario in which the enemies run into cover leaving themselves vulnerable while letting the player know that they're there. We also created an end point to the level which allows us to complete the game. The following screenshot show this:<a class="indexterm" id="id383"/>
</p><div class="mediaobject"><img alt="What just happened?" src="graphics/image_1901_06_26.jpg" width="262"/></div></div><div class="section" title="Pop quiz"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec10"/>Pop quiz</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">What are some of the problems with creating a level without using grid snaps?<p>a. Holes in our geometry.</p><p>b. Overlapping brushes.</p><p>c. Ensuring subtractive brushes work correctly.</p><p>d. All of the above.</p></li><li class="listitem">What keys do you use in order to increase or decrease grid snaps?<p>a. + and .</p><p>b. Left and right arrow keys.</p><p>c. [ and ].</p><p>d. ( and ).</p></li><li class="listitem">Is it possible to have an event with a Max Trigger Count of 0 (Can be triggered as many times as you'd like) to no longer be triggered? If possible, how would I do that?<p>a. False, we can't toggle an Event on and off.</p><p>b. False, the Max Trigger Count has to be positive.</p><p>c. True, we can toggle an Event on and off.</p><p>d. True, it's done automatically.</p></li></ol></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec09"/>Summary</h1></div></div></div><p>We have now reached the end of our game development section of the book. There is plenty of room now for you to make your project your own, add new levels, and explore the different aspects of the Unreal Engine; we have built the foundation of a truly awesome game.</p><p>In this short period of time we've managed to cover quite a lot of things. We've specifically learned:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">How to set up our room learning about adjusting materials to fit your level's needs</li><li class="listitem" style="list-style-type: disc">The best way to rapidly prototype out levels using reference and placeholder brushes to stand in for art</li><li class="listitem" style="list-style-type: disc">A possible workflow for creating levels using<span class="strong"><strong> Geometry</strong></span> mode</li><li class="listitem" style="list-style-type: disc">How to build our level using pieces we've already built duplicating work we've already done to make building quicker and more streamlined</li><li class="listitem" style="list-style-type: disc">The implementation of different combat scenarios</li></ul></div><p>Now that we've learned how to build the level and created all of the gameplay sections, in the next chapter I will be showing you how to add a main menu as well as play sounds, integrate custom content into your game, discuss optimizing, and debug your iOS game project to polish it as much as we can before we put it up on the App Store!</p></div></body></html>