<html><head></head><body>
		<div id="_idContainer337">
			<h1 id="_idParaDest-196"><em class="italic"><a id="_idTextAnchor201"/>Chapter 14</em>: Getting Data into Collection Views</h1>
			<p>In the previous chapter, you learned about the Model-View-Controller (MVC) design pattern and about collection views. You've also revisited the <strong class="bold">Explore</strong> and <strong class="bold">Restaurant List </strong>screens, and you have seen how the collection views in both screens work. At this point, though, both screens just display cells that do not contain any data. As shown in the app tour in <a href="B17469_09_Final_VK_ePub.xhtml#_idTextAnchor133"><em class="italic">Chapter 9</em></a><em class="italic">, Setting Up the User Interface</em>, the <strong class="bold">Explore</strong> screen should display a list of cuisines, and the <strong class="bold">Restaurant List</strong> screen should display a list of restaurants.</p>
			<p>In this chapter, you're going to implement the model objects for the <strong class="bold">Explore</strong> screen to make it display a list of cuisines. You'll start by learning about model objects that you will use. Next, you'll learn about property lists, and see how they are used to store cuisine data, and you'll create a Swift structure that can store cuisine instances. After that, you'll create a data manager class that reads data from the property list and populates an array of structures. This array of structures will then be used as the data source for the collection view in the <strong class="bold">Explore</strong> screen.</p>
			<p>By the end of this chapter, you'll have learned how property lists are used to store data, how to create model objects, how to create a data manager class that can load data from a property list into an array of model objects, how to configure view controllers to provide model objects to collection view, and how to configure collection views to display data on screen.</p>
			<p>The following topics will be covered:</p>
			<ul>
				<li>Understanding model objects</li>
				<li>Understanding <strong class="source-inline">.plist</strong> files</li>
				<li>Creating a structure to represent a cuisine</li>
				<li>Implementing a data manager class to read data from a <strong class="source-inline">.plist</strong> file</li>
				<li>Displaying data in a collection view</li>
			</ul>
			<h1 id="_idParaDest-197"><a id="_idTextAnchor202"/>Technical requirements</h1>
			<p>You will continue working on the <strong class="source-inline">LetsEat</strong> project that you modified in <a href="B17469_12_Final_VK_ePub.xhtml#_idTextAnchor182"><em class="italic">Chapter 12</em></a><em class="italic">, Modifying and Configuring Cells</em>.</p>
			<p>The resource files and completed Xcode project for this chapter are in the <strong class="source-inline">Chapter14 </strong>folder of the code bundle for this book, which can be downloaded here:</p>
			<p><a href="https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition">https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition</a></p>
			<p>Check out the following video to see the code in action: </p>
			<p><a href="https://bit.ly/3mWQ8sJ">https://bit.ly/3mWQ8sJ</a></p>
			<p>Let's start by looking at the different model objects that are required to hold the initial data, load the data into the app, and store the data within the app.</p>
			<h1 id="_idParaDest-198"><a id="_idTextAnchor203"/>Understanding model objects</h1>
			<p>As you<a id="_idIndexMarker659"/> learned in <a href="B17469_13_Final_VK_ePub.xhtml#_idTextAnchor194"><em class="italic">Chapter 13</em></a><em class="italic">, Getting Started with MVC and Collection Views</em>, a common design pattern for iOS apps is Model-View-Controller, or MVC. To recap, MVC divides an app into three different parts:</p>
			<ul>
				<li><strong class="bold">Model</strong>: This handles data storage, representation, and data processing tasks.</li>
				<li><strong class="bold">View</strong>: This is anything on the screen that the user can interact with. </li>
				<li><strong class="bold">Controller</strong>: This manages the flow of information between model and view.</li>
			</ul>
			<p>Let's revisit the design of the <strong class="bold">Explore</strong> screen that you saw during the app tour, which looks like this:</p>
			<div>
				<div id="_idContainer319" class="IMG---Figure">
					<img src="image/Figure_14.01_B17469.jpg" alt="Figure 14.1: iOS Simulator showing the Explore screen from the app tour&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.1: iOS Simulator showing the Explore screen from the app tour</p>
			<p>Build and run <a id="_idIndexMarker660"/>your app, and the <strong class="bold">Explore</strong> screen will look like this:</p>
			<div>
				<div id="_idContainer320" class="IMG---Figure">
					<img src="image/Figure_14.02_B17469.jpg" alt="Figure 14.2: iOS Simulator showing the Explore screen from your app&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.2: iOS Simulator showing the Explore screen from your app</p>
			<p>As you can <a id="_idIndexMarker661"/>see, all of the cells are currently empty. Based on the MVC design pattern, you have completed the implementation of the views (collection view section header and collection view) and the controller (the <strong class="source-inline">ExploreViewController</strong> class). Now, you will add model objects that will provide the data to be displayed.</p>
			<p>First, you'll add a property list, <strong class="source-inline">ExploreData.plist</strong>, to your project, which contains the name and the image filename for each cuisine. The cuisine images themselves are already present in your <strong class="source-inline">Assets.xcassets</strong> folder. Next, you'll create a model object, <strong class="source-inline">ExploreItem</strong>, which will be a structure with two properties. One property will be used to store cuisine names, and the other will be used to store image filenames. After that, you will create a data manager class, <strong class="source-inline">ExploreDataManager</strong>, which will load the data from <strong class="source-inline">ExploreData.plist</strong>, put it into an array of <strong class="source-inline">ExploreItem</strong> instances and provide the array to the <strong class="source-inline">ExploreViewController</strong> instance. Finally, you will modify the <strong class="source-inline">ExploreViewController</strong> class so it can provide data for the collection view to display.</p>
			<p>To learn more<a id="_idIndexMarker662"/> about property list files, let's add <strong class="source-inline">ExploreData.plist</strong> to your project now and see how it stores cuisine data.</p>
			<h1 id="_idParaDest-199"><a id="_idTextAnchor204"/>Understanding .plist files</h1>
			<p>Apple developed <a id="_idIndexMarker663"/>property lists to store data structures or object states for later reconstitution and transmission. They are commonly used to store preferences for applications. Property list files use the <strong class="source-inline">.plist</strong> filename extension, and hence are often referred to as <strong class="source-inline">.plist</strong> files. You will be using a <strong class="source-inline">.plist</strong> file containing cuisine data, <strong class="source-inline">ExploreData.plist</strong>, in your project.</p>
			<p>You will need to download the code bundle for this book to get the <strong class="source-inline">ExploreData.plist</strong> file. After that, you can use Xcode to view its contents. Follow these steps:</p>
			<ol>
				<li>If you have not yet done so, download the resource files and completed Xcode project for this from this link: <a href="https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition">https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition</a>.</li>
				<li>Open the <strong class="source-inline">Chapter14</strong> folder and look inside the <strong class="source-inline">resources</strong> folder to find <strong class="source-inline">ExploreData.plist</strong>. This file stores cuisine names and image filenames.</li>
				<li>Open the <strong class="source-inline">LetsEat</strong> project, right-click on the <strong class="source-inline">Explore</strong> folder in the Project navigator, and choose <strong class="bold">New Group</strong>.</li>
				<li>Rename the new group that you just added <strong class="source-inline">Model</strong>.</li>
				<li>Drag <strong class="source-inline">ExploreData.plist</strong> into this group.</li>
				<li>Make sure <strong class="bold">Copy items if needed</strong> is ticked and click <strong class="bold">Finish</strong>.</li>
			</ol>
			<p>When you click on <strong class="source-inline">ExploreData.plist</strong> in the Project navigator, you'll see an array that contains dictionaries, as shown:</p>
			<div>
				<div id="_idContainer321" class="IMG---Figure">
					<img src="image/Figure_14.03_B17469.jpg" alt="Figure 14.3: Editor area showing contents of ExploreData.plist&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.3: Editor area showing contents of ExploreData.plist</p>
			<p>Each dictionary has two elements. The first element has a key, <strong class="source-inline">name</strong>, and a value describing a type of cuisine. The second element has a key, <strong class="source-inline">image</strong>, and a value containing the filename of a cuisine image. All of the cuisine images are stored in the <strong class="source-inline">Assets.xcassets</strong> file in your project.</p>
			<p>To use the data contained in <strong class="source-inline">ExploreData.plist</strong>, you'll need to create a structure to hold it in the<a id="_idIndexMarker664"/> app so it can be accessed later by the <strong class="source-inline">ExploreViewController</strong> instance. You will create it in the next section.</p>
			<h1 id="_idParaDest-200"><a id="_idTextAnchor205"/>Creating a structure to represent a cuisine</h1>
			<p>To create a<a id="_idIndexMarker665"/> model object that can represent a <a id="_idIndexMarker666"/>cuisine in your app, you will add a new file to your project, <strong class="source-inline">ExploreItem</strong>, and declare an <strong class="source-inline">ExploreItem</strong> structure that has properties for a cuisine's name and image. Follow these steps:</p>
			<ol>
				<li value="1">Right-click on the <strong class="source-inline">Model</strong> folder and select <strong class="bold">New File</strong>.</li>
				<li><strong class="bold">iOS</strong> should already be selected. Choose <strong class="bold">Swift File</strong>, then click <strong class="bold">Next</strong>.</li>
				<li>Name the file <strong class="source-inline">ExploreItem</strong> and then click <strong class="bold">Create</strong>. It will appear in the Project navigator and its contents will appear in the Editor area. The only line in this file is an <strong class="source-inline">import</strong> statement.<p class="callout-heading">Important Information</p><p class="callout">The <strong class="source-inline">import</strong> statement allows you to import other code libraries into your project, giving you the ability to use classes, properties, and methods from them. <strong class="source-inline">Foundation</strong> is one of Apple's core frameworks, and you can learn more about it here: <a href="https://developer.apple.com/documentation/foundation">https://developer.apple.com/documentation/foundation</a>.</p></li>
				<li>Add the following code to the file to declare a structure named <strong class="source-inline">ExploreItem</strong>:<p class="source-code">struct ExploreItem {</p><p class="source-code">}</p></li>
				<li>Add the following code before the last curly brace to add two optional <strong class="source-inline">String</strong> properties<a id="_idIndexMarker667"/> to <a id="_idIndexMarker668"/>the <strong class="source-inline">ExploreItem</strong> structure:<p class="source-code">Struct ExploreItem {</p><p class="source-code"><strong class="bold">   let name: String? </strong></p><p class="source-code"><strong class="bold">   let image: String?</strong></p><p class="source-code">}</p><p>The <strong class="source-inline">name</strong> property will store the cuisine name, and the <strong class="source-inline">image</strong> property will store the filename of an image from the <strong class="source-inline">Assets.xcassets</strong> file.</p><p class="callout-heading">Important Information</p><p class="callout">Structures are covered in <a href="B17469_07_Final_VK_ePub.xhtml#_idTextAnchor108"><em class="italic">Chapter 7</em></a>, <em class="italic">Classes, Structures, and Enumerations.</em></p></li>
			</ol>
			<p>Structures automatically get a default initializer. You can create an instance of <strong class="source-inline">ExploreItem</strong> by using the following statement:</p>
			<p class="source-code">let myExploreItem = ExploreItem(name:"name", </p>
			<p class="source-code">image:"image")</p>
			<p>However, the name and image filename in <strong class="source-inline">ExploreData.plist</strong> are stored as dictionary elements, as shown in the following example:</p>
			<p><strong class="source-inline">["name": "All", "image": "all.png"]</strong></p>
			<p class="callout-heading">Important Information</p>
			<p class="callout">Dictionaries are covered in <a href="B17469_05_Final_VK_ePub.xhtml#_idTextAnchor066"><em class="italic">Chapter 5</em></a>, <em class="italic">Collection Types</em>.</p>
			<p>You'll create a custom initializer that takes a dictionary as a parameter and assigns the values obtained from the dictionary elements to the properties in an <strong class="source-inline">ExploreItem </strong>instance. You'll <a id="_idIndexMarker669"/>use an extension to add this custom<a id="_idIndexMarker670"/> initializer to the <strong class="source-inline">ExploreItem</strong> structure.</p>
			<p class="callout-heading">Important Information</p>
			<p class="callout">Extensions are covered in <a href="B17469_08_Final_VK_ePub.xhtml#_idTextAnchor123"><em class="italic">Chapter 8</em></a>, <em class="italic">Protocols, Extensions, and Error Handling</em>.</p>
			<p>Follow these steps:</p>
			<ol>
				<li value="1">Type the following after the <strong class="source-inline">ExploreItem</strong> structure declaration to add an extension:<p class="source-code">extension ExploreItem {</p><p class="source-code"> </p><p class="source-code">}</p><p>You'll use this extension to add the initializer method to the <strong class="source-inline">ExploreItem </strong>structure.</p></li>
				<li>Add the following between the curly braces of the extension to declare a custom initializer method:<p class="source-code">init(dict: [String: String]) {</p><p class="source-code"> </p><p class="source-code">}</p><p>Ignore the error that appears, as you will fix it shortly. This initializer takes a dictionary as an argument. Note that both key and value are strings.</p></li>
				<li>Add the following between the curly braces of the initializer:<p class="source-code">self.name = dict["name"]</p><p class="source-code">self.image = dict["image"]</p><p>This assigns the value of the dictionary item with the key <strong class="source-inline">"name"</strong> to the <strong class="source-inline">name</strong> property, and the value of the dictionary item with the key <strong class="source-inline">"image"</strong> to the <strong class="source-inline">image</strong> property. </p><p>The completed extension should look as follows:</p><p class="source-code">extension ExploreItem {</p><p class="source-code">   init(dict: [String: String]) {</p><p class="source-code">      self.name = dict["name"]</p><p class="source-code">      self.image = dict["image"]</p><p class="source-code">   }</p><p class="source-code">}</p><p>At<a id="_idIndexMarker671"/> this <a id="_idIndexMarker672"/>point, you have a structure, <strong class="source-inline">ExploreItem</strong>, with two <strong class="source-inline">String</strong> properties, <strong class="source-inline">name</strong> and <strong class="source-inline">image</strong>. When you create an instance of this structure, you will pass in a dictionary containing elements with keys and values of type <strong class="source-inline">String</strong>. The value for the <strong class="source-inline">name</strong> key will be assigned to the <strong class="source-inline">name</strong> property, and the value of the <strong class="source-inline">image</strong> key will be assigned to the <strong class="source-inline">image</strong> property.</p></li>
			</ol>
			<p>In the next section, you'll implement a data manager class. This will read the array of dictionaries from the <strong class="source-inline">ExploreData.plist</strong> file and assign the values of the dictionary elements to <strong class="source-inline">ExploreItem</strong> instances.</p>
			<h1 id="_idParaDest-201"><a id="_idTextAnchor206"/>Implementing a data manager class to read data from a .plist file</h1>
			<p>You <a id="_idIndexMarker673"/>have <a id="_idIndexMarker674"/>added a <strong class="source-inline">.plist</strong> file, <strong class="source-inline">ExploreData.plist</strong>, to your project containing the cuisine data, and you have created a structure, <strong class="source-inline">ExploreItem</strong>, that can store details of each cuisine. Now, you need to create a new class, <strong class="source-inline">ExploreDataManager</strong>, that can read the data in the <strong class="source-inline">.plist</strong> file and store it in an array of <strong class="source-inline">ExploreItem</strong> instances. You'll refer to this class as a data manager class. Follow these steps:</p>
			<ol>
				<li value="1">Right-click on the <strong class="bold">Model</strong> folder and select <strong class="bold">New File</strong>.</li>
				<li><strong class="bold">iOS</strong> should already be selected. Choose <strong class="bold">Swift File</strong>, then click <strong class="bold">Next</strong>.</li>
				<li>Name the file <strong class="source-inline">ExploreDataManager</strong> and then click <strong class="bold">Create</strong> to display its contents in the Editor area.</li>
				<li>Type the following code in the file to declare the <strong class="source-inline">ExploreDataManager</strong> class:<p class="source-code">class ExploreDataManager {</p><p class="source-code"> </p><p class="source-code">}</p></li>
				<li>Type in the following code between the curly braces. This implements a method, <strong class="source-inline">loadData()</strong>, which will read the contents of the <strong class="source-inline">ExploreData.plist</strong> file and return an array of dictionaries:<p class="source-code">private func loadData() -&gt; [[String: String]] {</p><p class="source-code">   let decoder = PropertyListDecoder()</p><p class="source-code">   if let path = Bundle.main.path(forResource:</p><p class="source-code">   "ExploreData", ofType: "plist"), </p><p class="source-code">   let exploreData = FileManager.default.contents(</p><p class="source-code">   atPath: path), </p><p class="source-code">   let exploreItems = try? decoder.decode([[String: </p><p class="source-code">   String]].self, from: exploreData) {</p><p class="source-code">      return exploreItems</p><p class="source-code">   }</p><p class="source-code">   return [[:]]</p><p class="source-code">}</p><p>Let's break this method down:</p><p class="source-code">private</p><p>The <strong class="source-inline">private</strong> keyword means that the method may only be used within this class.</p><p class="source-code">func loadData() -&gt; [[String: String]]</p><p>The <strong class="source-inline">loadData()</strong> method <a id="_idIndexMarker675"/>declaration<a id="_idIndexMarker676"/> has no arguments and returns an array of dictionaries, and each dictionary contains elements with keys and values of type <strong class="source-inline">String</strong>.</p><p class="source-code">let decoder = PropertyListDecoder()</p><p>This statement creates an instance of a property list decoder that will be used to decode the data in the <strong class="source-inline">ExploreData.plist</strong> file. </p><p class="source-code">if let path = Bundle.main.path(forResource:</p><p class="source-code">"ExploreData", ofType: "plist"),</p><p>When you build your app, the result is a folder with all of the app resources inside it, called the application bundle. <strong class="source-inline">ExploreData.plist</strong> is inside this bundle. This statement attempts to get the path to the <strong class="source-inline">ExploreData.plist</strong> file and assign it to a constant, <strong class="source-inline">path</strong>.</p><p class="source-code">let exploreData = FileManager.default.contents(</p><p class="source-code">atPath: path),</p><p>This statement attempts to get the <strong class="source-inline">ExploreData.plist</strong> file stored at <strong class="source-inline">path</strong> and assign it to a constant, <strong class="source-inline">exploreData</strong>.</p><p class="source-code">let exploreItems = try? decoder.decode([[String: </p><p class="source-code">String]].self, from: exploreData) {</p><p>If you click <strong class="source-inline">ExploreData.plist</strong> in your project, note that the root level object is<a id="_idIndexMarker677"/> an <a id="_idIndexMarker678"/>array, and each item in the array is a dictionary, as shown:</p></li>
			</ol>
			<div>
				<div id="_idContainer322" class="IMG---Figure">
					<img src="image/Figure_14.04_B17469.jpg" alt="Figure 14.4: Editor area showing arrays and dictionaries in ExploreData.plist&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.4: Editor area showing arrays and dictionaries in ExploreData.plist</p>
			<p>This statement attempts to create an array from the contents of the <strong class="source-inline">ExploreData.plist</strong> file and assign it to a constant, <strong class="source-inline">exploreItems</strong>:</p>
			<p class="source-code">   return exploreItems</p>
			<p class="source-code">}</p>
			<p>If the optional binding is successful, this statement returns <strong class="source-inline">exploreItems</strong> as an array of dictionaries, and each dictionary is of the <strong class="source-inline">[String: String]</strong> type:</p>
			<p class="source-code">   return [[:]]</p>
			<p class="source-code">}</p>
			<p>If the optional binding is unsuccessful, an empty array of dictionaries is returned.</p>
			<p>At this point, you have a data manager class, <strong class="source-inline">ExploreDataManager</strong>, containing a method that loads data from the <strong class="source-inline">ExploreData.plist</strong> file and assigns it to an array, <strong class="source-inline">exploreItems</strong>. In the next section, you will look at how to use the dictionaries inside this array <a id="_idIndexMarker679"/>to <a id="_idIndexMarker680"/>initialize <strong class="source-inline">ExploreItem</strong> instances, which will eventually be passed to the <strong class="source-inline">ExploreViewController</strong> instance managing the <strong class="bold">Explore</strong> screen.</p>
			<h2 id="_idParaDest-202"><a id="_idTextAnchor207"/>Using the data manager to initialize ExploreItem instances</h2>
			<p>At <a id="_idIndexMarker681"/>present, you<a id="_idIndexMarker682"/> have a data manager class, <strong class="source-inline">ExploreDataManager</strong>. This class contains a method, <strong class="source-inline">loadData()</strong>, which reads data from <strong class="source-inline">ExploreData.plist</strong> and returns an array of dictionaries. You'll add a method that creates and initializes <strong class="source-inline">ExploreItem</strong> instances with the dictionaries in that array. Follow these steps:</p>
			<ol>
				<li value="1">In the <strong class="source-inline">ExploreDataManager</strong> class definition, add the following code before the <strong class="source-inline">loadData()</strong> method to implement a <strong class="source-inline">fetch()</strong> method:<p class="source-code">func fetch() {</p><p class="source-code">   for data in loadData() {</p><p class="source-code">      print(data)</p><p class="source-code">   }</p><p class="source-code">}</p><p>This method will call <strong class="source-inline">loadData()</strong>, which returns an array of dictionaries. The <strong class="source-inline">for</strong> loop is then used to print the contents of each dictionary in the array to the Debug area to ensure that the <strong class="source-inline">ExploreData.plist</strong> file has been read successfully.</p></li>
				<li>Click the <strong class="source-inline">ExploreViewController</strong> file in the Project navigator. Add the following code to the <strong class="source-inline">viewDidLoad()</strong> method. This creates an <strong class="source-inline">ExploreDataManager</strong> instance and calls its <strong class="source-inline">fetch()</strong> method when the <strong class="source-inline">ExploreViewController</strong> instance loads its view:<p class="source-code">override func viewDidLoad() {</p><p class="source-code">   super.viewDidLoad()</p><p class="source-code"><strong class="bold">   let manager = ExploreDataManager()</strong></p><p class="source-code"><strong class="bold">   manager.fetch()</strong></p><p class="source-code">} </p><p>Build and run your app. The contents of the <strong class="source-inline">ExploreData.plist</strong> file are read and printed in the Debug area, as shown:</p><div id="_idContainer323" class="IMG---Figure"><img src="image/Figure_14.05_B17469.jpg" alt="Figure 14.5: Debug area displaying contents of ExploreData.plist&#13;&#10;"/></div><p class="figure-caption">Figure 14.5: Debug area displaying contents of ExploreData.plist</p><p>Now, you'll <a id="_idIndexMarker683"/>assign <a id="_idIndexMarker684"/>the <strong class="source-inline">name</strong> and <strong class="source-inline">image</strong> strings from each dictionary in the array to an <strong class="source-inline">ExploreItem</strong> instance.</p></li>
				<li>Click on the <strong class="source-inline">ExploreDataManager</strong> file. Add a property declaration to store an array of <strong class="source-inline">ExploreItem</strong> instances just before the <strong class="source-inline">fetch()</strong> method:<p class="source-code">private var exploreItems: [ExploreItem] = []</p><p>This adds a property, <strong class="source-inline">exploreItems</strong>, to the <strong class="source-inline">ExploreDataManager</strong> class and assigns an empty array to it.</p></li>
				<li>Inside the <strong class="source-inline">fetch()</strong> method, replace the <strong class="source-inline">print()</strong> statement with the following statement that initializes <strong class="source-inline">ExploreItem</strong> instances and appends them to the <strong class="source-inline">exploreItems</strong> array:<p class="source-code">exploreItems.append(ExploreItem(dict: data))</p><p>The custom initializer in the <strong class="source-inline">ExploreItem</strong> class assigns the <strong class="source-inline">name</strong> and <strong class="source-inline">image </strong>strings in each dictionary read from <strong class="source-inline">ExploreData.plist</strong> to the <strong class="source-inline">name</strong> and <strong class="source-inline">image</strong> properties of an <strong class="source-inline">ExploreData</strong> instance.</p></li>
				<li>Verify<a id="_idIndexMarker685"/> that<a id="_idIndexMarker686"/> the <strong class="source-inline">ExploreDataManager</strong> file's contents looks like this: <p class="source-code">import Foundation</p><p class="source-code">class ExploreDataManager {</p><p class="source-code">   <strong class="bold">private var exploreItems: [ExploreItem] = []</strong></p><p class="source-code">   func fetch() {</p><p class="source-code">      for data in loadData() {</p><p class="source-code">         <strong class="bold">exploreItems.append(ExploreItem(dict: </strong></p><p class="source-code"><strong class="bold">         data))</strong></p><p class="source-code">      }</p><p class="source-code">   }</p><p class="source-code">   private func loadData() -&gt; [[String: String]] {</p><p class="source-code">      let decoder = PropertyListDecoder()</p><p class="source-code">      if let path = Bundle.main.path(forResource:</p><p class="source-code">      "ExploreData", ofType: "plist"), </p><p class="source-code">      let exploreData = </p><p class="source-code">      FileManager.default.contents(atPath: path), </p><p class="source-code">      let exploreItems = try? </p><p class="source-code">      decoder.decode([[String: String]].self, </p><p class="source-code">      from: exploreData) {</p><p class="source-code">         return exploreItems</p><p class="source-code">      }</p><p class="source-code">      return [[:]]</p><p class="source-code">   }</p><p class="source-code">}</p></li>
			</ol>
			<p>At this point, you have an <strong class="source-inline">ExploreDataManager</strong> class that reads data from <strong class="source-inline">ExploreData.plist</strong> and stores it in <strong class="source-inline">exploreItems</strong>, an array of <strong class="source-inline">ExploreItem</strong> instances. This array will be the data source for the collection view managed by the  <strong class="source-inline">ExploreViewController</strong> instance. The cuisine information it contains will eventually be <a id="_idIndexMarker687"/>displayed<a id="_idIndexMarker688"/> in the <strong class="bold">Explore</strong> screen.</p>
			<h1 id="_idParaDest-203"><a id="_idTextAnchor208"/>Displaying data in a collection view</h1>
			<p>You've<a id="_idIndexMarker689"/> implemented a data manager class, <strong class="source-inline">ExploreDataManager</strong>, that reads cuisine data from the <strong class="source-inline">ExploreData.plist</strong> file and stores it in an array of <strong class="source-inline">ExploreItem</strong> instances. Now, you will modify the <strong class="source-inline">ExploreViewController</strong> class to use that array as the data source for the collection view in the <strong class="bold">Explore</strong> screen.</p>
			<p>At present, the collection view in the <strong class="bold">Explore</strong> screen displays 20 collection view cells, with each cell containing an empty image view and a label. You need a way to set the values for the image view and the label in the cells, so you will create a new class, <strong class="source-inline">ExploreCell</strong>, for this purpose. You can then configure the view controller for the collection view, <strong class="source-inline">ExploreViewController</strong>, to get cuisine details from the <strong class="source-inline">ExploreDataManager</strong> instance and provide it to the collection view for display. To create <strong class="source-inline">ExploreCell</strong>, follow these steps:</p>
			<ol>
				<li value="1">Right-click on the <strong class="source-inline">Explore</strong> folder in the Project navigator and choose <strong class="bold">New Group</strong>.</li>
				<li>Rename the new group <strong class="source-inline">View</strong>.</li>
				<li>Right-click on the <strong class="source-inline">View</strong> folder and select <strong class="bold">New File</strong>.</li>
				<li><strong class="bold">iOS</strong> should already be selected. Choose <strong class="bold">Cocoa Touch Class</strong>, then click <strong class="bold">Next</strong>.</li>
				<li>Configure the class as shown here:<p><strong class="bold">Class</strong>: <strong class="source-inline">ExploreCell</strong></p><p><strong class="bold">Subclass</strong>: <strong class="source-inline">UICollectionViewCell</strong> </p><p><strong class="bold">Also create XIB</strong>: <strong class="source-inline">Unchecked</strong> </p><p><strong class="bold">Language</strong>: <strong class="source-inline">Swift</strong></p><p>Click <strong class="bold">Next</strong>.</p></li>
				<li>Click <strong class="bold">Create</strong>.</li>
				<li>A new<a id="_idIndexMarker690"/> file, <strong class="source-inline">ExploreCell</strong>, will be added to your project. Inside it you will see the following:<p class="source-code">import UIKit</p><p class="source-code">class ExploreCell: UICollectionViewCell {</p><p class="source-code">}</p><p class="callout-heading">Important Information</p><p class="callout"><strong class="source-inline">UIKit</strong> provides the infrastructure required for iOS apps. You can read more about it here: <a href="https://developer.apple.com/documentation/uikit">https://developer.apple.com/documentation/uikit</a>.</p></li>
				<li>You'll now assign the <strong class="source-inline">ExploreCell</strong> class as the identity of the <strong class="source-inline">exploreCell</strong> collection view cell. Click the <strong class="source-inline">Main</strong> storyboard file in the Project navigator and click <strong class="source-inline">exploreCell</strong> inside the <strong class="bold">Explore View Controller Scene</strong> in the document outline. Click the Identity inspector button:<div id="_idContainer324" class="IMG---Figure"><img src="image/Figure_14.06_B17469.jpg" alt="Figure 14.6: Identity inspector selected&#13;&#10;"/></div><p class="figure-caption">Figure 14.6: Identity inspector selected</p></li>
				<li>Under<a id="_idIndexMarker691"/> the <strong class="bold">Custom Class</strong> section, set <strong class="bold">Class</strong> to <strong class="source-inline">ExploreCell</strong>. This sets an <strong class="source-inline">ExploreCell</strong> instance as the manager for <strong class="source-inline">exploreCell</strong>. Press <em class="italic">Return</em> when done:</li>
			</ol>
			<div>
				<div id="_idContainer325" class="IMG---Figure">
					<img src="image/Figure_14.07_B17469.jpg" alt="Figure 14.7: Identity inspector showing Class settings for exploreCell&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.7: Identity inspector showing Class settings for exploreCell</p>
			<p>You've just declared and defined the <strong class="source-inline">ExploreCell</strong> class, and assigned it as the manager for the <strong class="source-inline">exploreCell</strong> collection view cell. Now, you'll create outlets in this class that will be connected to the image view and the label in the <strong class="source-inline">exploreCell</strong> collection view cell, so you can control what they display.</p>
			<h2 id="_idParaDest-204"><a id="_idTextAnchor209"/>Connecting the outlets in exploreCell</h2>
			<p>To manage what<a id="_idIndexMarker692"/> is being displayed by the collection view cells in the <strong class="bold">Explore</strong> screen, you'll connect the image view and label in the <strong class="source-inline">exploreCell</strong> collection view cell to outlets in the <strong class="source-inline">ExploreCell</strong> class. You"ll use the assistant editor for this. Follow these steps:</p>
			<ol>
				<li value="1">Click the Navigator and Inspector buttons to hide the Navigator and Inspector areas. This will give you more room to work:<div id="_idContainer326" class="IMG---Figure"><img src="image/Figure_14.08_B17469.jpg" alt="Figure 14.8: Toolbar showing Navigator and Inspector buttons&#13;&#10;"/></div><p class="figure-caption">Figure 14.8: Toolbar showing Navigator and Inspector buttons</p></li>
				<li>Click the Adjust Editor Options button to display a menu:<div id="_idContainer327" class="IMG---Figure"><img src="image/Figure_14.09_B17469.jpg" alt="Figure 14.9: Adjust Editor Options button&#13;&#10;"/></div><p class="figure-caption">Figure 14.9: Adjust Editor Options button</p></li>
				<li>Choose <strong class="bold">Assistant</strong> from the menu to display the assistant editor:<div id="_idContainer328" class="IMG---Figure"><img src="image/Figure_14.10_B17469.jpg" alt="Figure 14.10: Adjust Editor Options menu with Assistant selected&#13;&#10;"/></div><p class="figure-caption">Figure 14.10: Adjust Editor Options menu with Assistant selected</p></li>
				<li>To create the outlets for the <strong class="source-inline">ExploreCell</strong> class, the assistant editor path should be set to <strong class="source-inline">Automatic | ExploreCell.swift</strong>. If you don't see <strong class="source-inline">ExploreCell.swift</strong> in the path, select the <strong class="source-inline">exploreCell</strong> collection view cell's <strong class="bold">Label</strong> in the document outline and select <strong class="source-inline">ExploreCell.swift</strong> from the assistant editor's path drop-down menu:<div id="_idContainer329" class="IMG---Figure"><img src="image/Figure_14.11_B17469.jpg" alt="Figure 14.11: Assistant editor bar showing ExploreCell.swift&#13;&#10;"/></div><p class="figure-caption">Figure 14.11: Assistant editor bar showing ExploreCell.swift</p></li>
				<li><em class="italic">Ctrl + Drag</em> from<a id="_idIndexMarker693"/> the <strong class="bold">Label</strong> element in the collection view cell to the space between the curly braces as shown. This creates an outlet for it:<div id="_idContainer330" class="IMG---Figure"><img src="image/Figure_14.12_B17469.jpg" alt="Figure 14.12: Editor area showing ExploreCell.swift&#13;&#10;"/></div><p class="figure-caption">Figure 14.12: Editor area showing ExploreCell.swift</p></li>
				<li>In the pop-up dialog, enter <strong class="source-inline">exploreNameLabel</strong> in the <strong class="bold">Name</strong> field to set the outlet's name:<div id="_idContainer331" class="IMG---Figure"><img src="image/Figure_14.13_B17469.jpg" alt="Figure 14.13: Pop-up dialog box for exploreNameLabel outlet creation&#13;&#10;"/></div><p class="figure-caption">Figure 14.13: Pop-up dialog box for exploreNameLabel outlet creation</p></li>
				<li><em class="italic">Ctrl + Drag</em> from <a id="_idIndexMarker694"/>the <strong class="bold">UIImageView</strong> element in the collection view cell to the space just after the <strong class="source-inline">exploreNameLabel</strong> property. This creates an outlet for it:<div id="_idContainer332" class="IMG---Figure"><img src="image/Figure_14.14_B17469.jpg" alt="Figure 14.14: Editor area showing ExploreCell.swift&#13;&#10;"/></div><p class="figure-caption">Figure 14.14: Editor area showing ExploreCell.swift</p></li>
				<li>In the pop-up dialog, enter <strong class="source-inline">exploreImageView</strong> in the <strong class="bold">Name</strong> field to set the outlet's name:<div id="_idContainer333" class="IMG---Figure"><img src="image/Figure_14.15_B17469.jpg" alt="Figure 14.15: Pop-up dialog box for exploreImageView outlet creation&#13;&#10;"/></div><p class="figure-caption">Figure 14.15: Pop-up dialog box for exploreImageView outlet creation</p></li>
				<li>The <strong class="source-inline">exploreNameLabel</strong> and <strong class="source-inline">exploreImageView</strong> outlets have been added <a id="_idIndexMarker695"/>to the <strong class="source-inline">ExploreCell</strong> class and connected to the <strong class="source-inline">exploreCell</strong> collection view cell's image view and label elements, as shown:<div id="_idContainer334" class="IMG---Figure"><img src="image/Figure_14.16_B17469.jpg" alt="Figure 14.16: Editor area showing exploreNameLabel and exploreImageView outlets&#13;&#10;"/></div><p class="figure-caption">Figure 14.16: Editor area showing exploreNameLabel and exploreImageView outlets</p></li>
				<li>Click the <strong class="bold">x</strong> button to close the assistant editor:</li>
			</ol>
			<div>
				<div id="_idContainer335" class="IMG---Figure">
					<img src="image/Figure_14.17_B17469.jpg" alt="Figure 14.17: Assistant editor close button&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.17: Assistant editor close button</p>
			<p>The <strong class="source-inline">exploreCell</strong> collection view cell in the <strong class="source-inline">Main</strong> storyboard file has now been set up with a class, <strong class="source-inline">ExploreCell</strong>. The outlets for the collection view cell's image view and label have also been created and assigned. Now, you can set the <strong class="source-inline">exploreNameLabel</strong> and <strong class="source-inline">exploreImageView</strong> outlets in the <strong class="source-inline">ExploreCell</strong> instance to display a cuisine image and name in each cell when the app is run.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">You can check whether the outlets are connected properly in the Connections inspector.</p>
			<p>In the next <a id="_idIndexMarker696"/>section, you will add code to <strong class="source-inline">ExploreDataManager</strong> to provide the number of cells to be displayed by <strong class="source-inline">collectionView</strong>, and provide an <strong class="source-inline">ExploreItem</strong> instance whose properties will be used to determine what image and label the cell will display.</p>
			<h2 id="_idParaDest-205"><a id="_idTextAnchor210"/>Implementing additional data manager methods</h2>
			<p>As you<a id="_idIndexMarker697"/> learned in <a href="B17469_13_Final_VK_ePub.xhtml#_idTextAnchor194"><em class="italic">Chapter 13</em></a><em class="italic">, Getting Started with MVC and Collection Views</em>, a collection view needs to know how many cells to display and what to put in each cell. You will add two methods to the <strong class="source-inline">ExploreDataManager</strong> class that will provide the number of <strong class="source-inline">ExploreItem</strong> instances in the <strong class="source-inline">exploreItems</strong> array and return an <strong class="source-inline">ExploreItem</strong> instance at a specified array index. Click the <strong class="source-inline">ExploreDataManager</strong> file in the Project navigator and add these two methods after the <strong class="source-inline">loadData()</strong> method:</p>
			<p class="source-code">func numberOfExploreItems() -&gt; Int {</p>
			<p class="source-code">   exploreItems.count</p>
			<p class="source-code">}</p>
			<p class="source-code">func exploreItem(at index: Int) -&gt; ExploreItem {</p>
			<p class="source-code">   exploreItems[index]</p>
			<p class="source-code">}</p>
			<p>The first method, <strong class="source-inline">numberOfExploreItems()</strong>, will determine the number of cells to be displayed by the collection view.</p>
			<p>The second method, <strong class="source-inline">exploreItem(at:)</strong>, will return an <strong class="source-inline">ExploreItem</strong> instance that corresponds to a cell's position in the collection view.</p>
			<p>In the next section, you'll update the collection view data source methods in the <strong class="source-inline">ExploreViewController</strong> class to provide the number of cells to be displayed in the collection <a id="_idIndexMarker698"/>view, and to provide the cuisine name and image for each cell.</p>
			<h2 id="_idParaDest-206"><a id="_idTextAnchor211"/>Updating the data source methods in ExploreViewController</h2>
			<p>The data <a id="_idIndexMarker699"/>source methods<a id="_idIndexMarker700"/> in the <strong class="source-inline">ExploreViewController</strong> class are currently set to display 20 cells, each cell containing an empty image view and label. You'll update them to get the number of cells to display, and the data to put in each cell, from the <strong class="source-inline">ExploreDataManager</strong> instance. Follow these steps:</p>
			<ol>
				<li value="1">Click the <strong class="source-inline">ExploreViewController</strong> file and find the <strong class="source-inline">viewDidLoad()</strong> method. It should look like this:<p class="source-code">override func viewDidLoad() {</p><p class="source-code">   super.viewDidLoad()</p><p class="source-code">   let manager = ExploreDataManager()</p><p class="source-code">   manager.fetch()</p><p class="source-code">}</p><p>This means the <strong class="source-inline">ExploreDataManager</strong> instance is only accessible within the <strong class="source-inline">viewDidLoad()</strong> method. You need to make it available to the entire class.</p></li>
				<li>Move the <strong class="source-inline">let manager = ExploreDataManager()</strong> line to just after the <strong class="source-inline">collectionView</strong> property declaration to make the <strong class="source-inline">ExploreDataManager</strong> instance available to all methods within the <strong class="source-inline">ExploreViewController</strong> class, as shown:<p class="source-code">@IBOutlet var collectionView: UICollectionView!</p><p class="source-code"><strong class="bold">let manager = ExploreDataManager()</strong></p></li>
				<li>Update <strong class="source-inline">collectionView(_:numberOfItemsInSection:)</strong> as shown. This will make<a id="_idIndexMarker701"/> the<a id="_idIndexMarker702"/> collection view display a cell for each element in the <strong class="source-inline">items</strong> array:<p class="source-code">func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -&gt; Int {</p><p class="source-code">   <strong class="bold">manager.numberOfExploreItems()</strong></p><p class="source-code">}</p></li>
				<li>Update <strong class="source-inline">collectionView(_:cellForItemAt:)</strong> as shown to set the image view and label for each cell using data from the corresponding element in the <strong class="source-inline">items</strong> array:<p class="source-code">func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -&gt; UICollectionViewCell {</p><p class="source-code">   let cell = collectionView.dequeueReusableCell(</p><p class="source-code">   withReuseIdentifier: "exploreCell", for: </p><p class="source-code">   indexPath) <strong class="bold">as! ExploreCell</strong></p><p class="source-code"><strong class="bold">   let exploreItem = manager.exploreItem(at: </strong></p><p class="source-code"><strong class="bold">   indexPath.row)</strong></p><p class="source-code"><strong class="bold">   cell.exploreNameLabel.text = exploreItem.name</strong></p><p class="source-code"><strong class="bold">   cell.exploreImageView.image = UIImage(named: </strong></p><p class="source-code"><strong class="bold">   exploreItem.image!)</strong></p><p class="source-code">   return cell</p><p class="source-code">}</p><p>Let's break this down:</p><p class="source-code">let cell = collectionView.dequeueReusableCell(</p><p class="source-code">withReuseIdentifier:"exploreCell", for: indexPath) </p><p class="source-code">as! ExploreCell</p><p>Specifies the cell that is dequeued is an instance of <strong class="source-inline">ExploreCell</strong>.</p><p class="source-code">let exploreItem = manager.exploreItem(at: </p><p class="source-code">indexPath.row)</p><p>Gets <a id="_idIndexMarker703"/>the <strong class="source-inline">ExploreItem</strong> instance <a id="_idIndexMarker704"/>that corresponds to the current cell in the collection view. In other words, the first cell in the collection view corresponds to the first <strong class="source-inline">ExploreItem</strong> instance in the <strong class="source-inline">exploreItems</strong> array, the second cell corresponds to the second <strong class="source-inline">ExploreItem</strong> instance, and so on.</p><p class="source-code">cell.exploreNameLabel.text = exploreItem.name</p><p>Sets the <strong class="source-inline">text</strong> property of the cell's <strong class="source-inline">nameLabel</strong> to the name of the <strong class="source-inline">ExploreItem </strong>instance.</p><p class="source-code">cell.exploreImageView.image = UIImage(named: </p><p class="source-code">exploreItem.image!)</p><p>Gets the <strong class="source-inline">image</strong> string from the <strong class="source-inline">ExploreItem</strong> instance, gets the corresponding image from the <strong class="source-inline">Assets.xcassets</strong> file, and assigns it to the <strong class="source-inline">image</strong> of the cell's <strong class="source-inline">imgExplore</strong> property.</p></li>
			</ol>
			<p>Build and run the app. You'll see the collection view in the <strong class="bold">Explore</strong> screen display images and text of different cuisines. Tapping a collection view cell will display the <strong class="bold">Restaurant List </strong>screen:</p>
			<div>
				<div id="_idContainer336" class="IMG---Figure">
					<img src="image/Figure_14.18_B17469.jpg" alt="Figure 14.18: iOS Simulator showing Explore and Restaurant List screens&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.18: iOS Simulator showing Explore and Restaurant List screens</p>
			<p>At this <a id="_idIndexMarker705"/>point, the <strong class="bold">Explore</strong> screen<a id="_idIndexMarker706"/> displays images and text of different cuisines based on the data obtained from the <strong class="source-inline">ExploreData.plist</strong> file. In <a href="B17469_17_Final_VK_ePub.xhtml#_idTextAnchor248"><em class="italic">Chapter 17</em></a>, <em class="italic">Getting Started with JSON Files</em>, you will modify the <strong class="source-inline">RestaurantListViewController</strong> class to make the <strong class="bold">Restaurant List</strong> screen display a list of restaurants offering the selected cuisine. But before you can do that, you'll need to set a location in the <strong class="bold">Locations</strong> screen, which will provide a list of all available restaurants at that location. This will be covered in the next chapter.</p>
			<h1 id="_idParaDest-207"><a id="_idTextAnchor212"/>Summary</h1>
			<p>In this chapter, you added a property list file, <strong class="source-inline">ExploreData.plist</strong>, to your project. You implemented the <strong class="source-inline">ExploreItem</strong> structure, the model objects for the <strong class="bold">Explore</strong> screen. You created a data manager class, <strong class="source-inline">ExploreDataManager</strong>, to read data from <strong class="source-inline">ExploreData.plist</strong>, put the data into an array of <strong class="source-inline">ExploreItem</strong> instances, and provide it to <strong class="source-inline">ExploreViewController</strong>. You created a class for the <strong class="source-inline">exploreCell</strong> collection view cell. Finally, you configured the data source methods in the <strong class="source-inline">ExploreViewController</strong> class to use data from the array of <strong class="source-inline">ExploreItem </strong>instances to populate the collection view, and the <strong class="bold">Explore</strong> screen now displays a list of cuisines. Great job!</p>
			<p>You now know how to provide data to an app using <strong class="source-inline">.plist</strong> files, create model objects, create data manager classes that load <strong class="source-inline">.plist</strong> files into model objects, configure collection views to display data that has been loaded, and configure view controllers for collection views. This will be useful should you wish to create your own apps that use collection views.</p>
			<p>In the next chapter, you will look at table views, which are similar in some ways to collection views, and configure the <strong class="bold">Locations</strong> screen to display a list of locations in a table view when you tap the <strong class="bold">LOCATION</strong> button in the <strong class="bold">Explore</strong> screen.</p>
		</div>
	</body></html>