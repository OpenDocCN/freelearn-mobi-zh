<html><head></head><body>
        

            
                <h1 class="header-title">GameScene and SceneFlow</h1>
            

            
                
<p>Up to this point, we have only worked with the startScene but in this chapter we will see how to add other scenes to the game, and we'll need a MainMenu scene from where we can go to other scenes, like the options or the achievements scenes.</p>
<p>Each of these scenes will have specific game objects and buttons which will enable us to either change settings or buttons that can take us back to the MainMenu Scene.</p>
<p>The MainMenu scene also needs to have a play button which should link to the startScene which in turn is responsible for starting the game.</p>
<p>Obviously, we can add more scenes and menus according to the needs of the game.</p>
<p>Let us first see how to add buttons to the startScene, so that at the end of the game we can restart the game.</p>
<p>This chapter includes the following topics:</p>
<ul>
<li>Introduction to buttons</li>
<li>Organizing the project folder structure</li>
<li>Adding a game restart button to the startScene</li>
<li>Adding a pause button to the startScene</li>
<li>Adding a MainMenu button to the startScene</li>
<li>Creating a MainMenu scene</li>
<li>Adding an Options scene</li>
<li>Adding an Achievements scene</li>
</ul>


            

            <footer style="margin-top: 5em;">
                
            </footer>

        
    

        

            
                <h1 class="header-title">Adding buttons to the startScene</h1>
            

            
                
<p>In the last chapter, we saw how to add text to the scene. However, we can also add buttons to the scene. The button creation process is the same as for creating a text UI. Go to GameObjects | UI | Button:</p>
<div><img class=" image-border" height="189" src="img/image_06_001.png" width="335"/></div>
<p>A button will be created in the scene, as shown in the following screenshot:</p>
<div><img class=" image-border" height="335" src="img/image_06_002.png" width="493"/></div>
<p>A button will have a Canvas, a Button, and a Text component. If you are creating a button in a scene where a Canvas component already exists, it will just use the current Canvas and create the button beneath it.</p>
<p>We have the Canvas component from the previous chapter. Click on the button in the Hierarchy window.</p>
<p>The button has Rect Transform, Canvas Renderer, Image (Script), and Button (Script) components. We have already come across the Rect Transform and Canvas Renderer:</p>
<div><img class=" image-border" height="481" src="img/image_06_003.png" width="213"/></div>
<p>You can specify the image of the button in the Image (Script) component. To set the image, you will import an image and convert it to Sprite types. You can only assign it to the source image after you have assigned the image to a Sprite type.</p>
<ul>
<li>Color: You can specify the button color; otherwise, you can set the default color as white.</li>
<li>Material: If you would like to assign a specific texture it can be done here.</li>
<li>Raycast Target: This allows the target to clickable.</li>
<li>Image Type: You can use the image as it is or you can change it to tiled.</li>
</ul>
<p>Next in the Button (Script) section, we can specify what the button should do once it is clicked. By clicking on Interactable option, we specify that the button will change to something else once it is highlighted, pressed, or disabled.</p>
<p>The rate at which the button is changed once it has been clicked on is specified by the Fade Duration parameter.</p>
<p>The Text (Script) specifies whether any text need to be shown. If text is appropriate, you can specify the text in the text box. Otherwise you can leave it blank. It is generally better to have buttons that are standard and self-explanatory:</p>
<div><img class=" image-border" height="273" src="img/image_06_004.png" width="215"/></div>


            

            <footer style="margin-top: 5em;">
                
            </footer>

        
    

        

            
                <h1 class="header-title">Organizing the folder structure</h1>
            

            
                
<p>In the <kbd>resources</kbd> folder for this chapter, you will see a bunch of images for buttons. Drag and drop the buttons into a folder called <kbd>buttons</kbd>.</p>
<p>It is also a good time to start organizing your folders a bit. For the sake of convenience and personal sanity, it is better to put assets into folders:</p>
<div><img class=" image-border" height="250" src="img/image_06_005.png" width="667"/></div>
<p>I have created folders structure with the following folders:</p>
<ul>
<li>3dAssets: Contains player FBX, You can also add other 3D objects, like a 3D environment, and 3D meshes.</li>
<li>animController: I have placed Animation Controllers here. When you have lot of enemies, you will probably have separate Animation Controllers for each, so it is better to also have a separate controller for each.</li>
<li>buttons: Sprites for buttons can go in here.</li>
<li>Fonts: Although Arial is a beautiful font, you might want to choose a font that it is more suitable to your game. So, create a folder to put these here.</li>
<li>Materials: Once again, more objects mean more materials, so get organized!</li>
<li>prefabs: Put all prefabs in a separate folder so that they are easier to access.</li>
<li>Scenes: Scenes are the most accessed files when creating a game, so keep them in a separate folders for easy access.</li>
<li>Scripts: Overtime, you might use a lot of scripts for different things so create separate folders for these as well.</li>
</ul>
<p>When you open the buttons folder, it looks like the following screenshot:</p>
<div><img class=" image-border" height="153" src="img/image_06_006.png" width="589"/></div>
<p>The button images all have a small arrow on their right-hand edge. That is because they have already been converted to Sprite types. To convert an image to sprite, select the image and in the Inspector pane, and change the Texture Type field to Sprite (2D and UI) option:</p>
<div><img class=" image-border" height="406" src="img/image_06_007.png" width="174"/></div>
<p>Do the same for all the buttons in the buttons folder.</p>


            

            <footer style="margin-top: 5em;">
                
            </footer>

        
    

        

            
                <h1 class="header-title">Adding a game restart button in the startScene</h1>
            

            
                
<p>Now create a new button in the startScene and rename the button to resetBtn as shown in the following screenshot:</p>
<div><img class=" image-border" height="115" src="img/image_06_008.png" width="161"/></div>
<p>In the Inspector pane, under the Source Image field, select the resetBtn2 Sprite type:</p>
<div><img class=" image-border" height="319" src="img/image_06_009.png" width="225"/></div>
<p>Leave the rest of the parameters as they are. You will also see a preview of the reset button in the Inspector pane along with its dimensions:</p>
<div><img class=" image-border" height="235" src="img/image_06_010.png" width="219"/></div>
<p>Position the button so that it is just under and to the right of the GAMEOVER!!! text. By this we will make it accessible to the player's thumb:</p>
<div><img class=" image-border" height="184" src="img/image_06_011.png" width="204"/></div>
<p>Once positioned, it should look like the following in the game:</p>
<div><img class=" image-border" height="402" src="img/image_06_012.png" width="599"/></div>
<p>Now we have to create a small script so that, when the button is clicked, the startScene is called. To do this, create a new script, call it buttonClick, and save it in the <kbd>Scripts</kbd> folder. Inside the script add the following lines:</p>
<pre>
    using System.Collections; <br/>    using System.Collections.Generic; <br/>    using UnityEngine; <br/>    using UnityEngine.SceneManagement; <br/><br/>    public class buttonClick : MonoBehaviour { <br/>        public void onButtonClick(string level) { <br/>            SceneManager.LoadScene(level); <br/>        } <br/>    } 
</pre>
<p>The <kbd>SceneManager.LoadScene</kbd> function is responsible for loading the scene in Unity.</p>
<p>When the button is clicked, we will select the <kbd>OnButtonClick</kbd> function, then pass in a name of the scene to be loaded, and this string will be passed into the <kbd>LoadScene</kbd> function, which will load the scene itself.</p>
<p>Now create an empty game object by going to GameObject| CreateEmpty. Name it buttonClickGo. It doesn't matter where this game object is located in the scene. Now add the <kbd>buttonClick</kbd> script to this game object, as shown in the following screenshot:</p>
<div><img class=" image-border" height="166" src="img/image_06_013.png" width="210"/></div>
<p>Select the <kbd>resetBtn</kbd> in the Hierarchy. In the Inspector pane for the button, you will see an On Click () section below the Button (Script) section:</p>
<div><img class=" image-border" height="291" src="img/image_06_014.png" width="208"/></div>
<p>In the first dropdown menu, select Editor and Runtime option, so the function can be called inside the editor during runtime.</p>
<p>Next, select the buttonClickGO game object from the dropdown list, as shown in the following screenshot:</p>
<div><img class=" image-border" height="314" src="img/image_06_015.png" width="240"/></div>
<p>Then, select the <kbd>buttonClick.onButtonClick</kbd> function from the dropdown. This is under ButtonClick | onButtonClick (string):</p>
<div><img class=" image-border" height="305" src="img/image_06_016.png" width="304"/></div>
<p>Now, enter the string as the name of the scene that will gets called--in this case we want to call the startScene:</p>
<div><img class=" image-border" height="70" src="img/image_06_017.png" width="201"/></div>
<p>We still need to hide the reset button till the game is over. So, in the <kbd>gameScript</kbd>, create a public <kbd>Button</kbd> type, and call it <kbd>resetButton</kbd>, shown as following:</p>
<pre>
    public Text enemyTextInstance; <br/>    public Text playerTextInstance; <br/>    public Text gameOverText; <br/><strong>    public Button resetButton;</strong>
</pre>
<p>Next, in the <kbd>Start</kbd> function we set the active property to <kbd>false</kbd>:</p>
<pre>
    void Start () {  <br/>        GameObject player = GameObject.Find("theDude"); <br/>        pScript = player.GetComponent&lt;playerScript&gt;(); <br/><br/>        GameObject enemy = GameObject.Find("Enemy"); <br/>        eScript = enemy.GetComponent&lt;enemyScript&gt;(); <br/>        gameOverText.enabled = false; <br/><br/>        resetButton.gameObject.SetActive(false); <br/>    } 
</pre>
<p>This will ensure that the reset button won't be visible initially. Finally, once the game is over, update the <kbd>SetActive</kbd> function to <kbd>true</kbd> again:</p>
<pre>
    if (playerHealth &lt;= 0 || enemyHealth &lt;= 0) { <br/>        bGameover = true; <br/>        gameOverText.enabled = true; <br/><strong>        resetButton.gameObject.SetActive(true);</strong> <br/><br/>        Instantiate(particlePrefab); <br/>    }  
</pre>
<p>For Unity to get the scene you want it to load, you need to add it to the Scenes In Build list in Build Settings option. So, go to File | Build Settings and click the Add Open Scenes button at the bottom, as shown in the following screenshot:</p>
<div><img class=" image-border" height="263" src="img/image_06_018.png" width="466"/></div>
<p>Once the scene has been added, close the window. Now run the game and, once the game is over, you can press the reset button and the game will start again.</p>


            

            <footer style="margin-top: 5em;">
                
            </footer>

        
    

        

            
                <h1 class="header-title">Adding a pause button to the startScene</h1>
            

            
                
<p>Since we are in startScene, let's add one more type of button, called a <em>toggle</em> button, to pause or unpause the game.</p>
<p>Go to GameObject | UI and create a new toggle button. Once created, position it at the top right of the game screen. Rename the button to pauseBtn.</p>
<p>Like other buttons and UI elements, it has a Rect Transform section which can be used to position the button:</p>
<div><img class=" image-border" height="414" src="img/image_06_019.png" width="225"/></div>
<p>It also has a Toggle (Script) which can be set to the default values. Select the Background tab, to choose the background image to be used for the button.</p>
<p>In the Image (Script) under Background, select the pauseBtnOff Sprite type as the background image:</p>
<div><img class=" image-border" height="347" src="img/image_06_020.png" width="218"/></div>
<p>There is also a label tab for any text script, which you can leave blank as we will only be using the image.</p>
<p>Whenever you click the button, it will create a tick mark over the pause image to specify that the button is toggled. If you click on it again it will revert to the usual image.</p>
<p>Now, in the <kbd>gameScript</kbd> file, we create a public variable toggle type, called <kbd>pauseButton</kbd>, and also create a <kbd>public</kbd> Boolean variable, called <kbd>bIsGamePaused</kbd>, and initialize it to <kbd>false</kbd>. We will use this newly created Boolean variable to go through the player and AI update loop.</p>
<p>So, in the <kbd>gameScript</kbd>, add the following code:</p>
<pre>
    public Text gameOverText; <br/>    public Button resetButton; <br/><strong>    public Toggle pauseButton;</strong><strong>   <br/>    public bool bIsGamePaused = false;</strong>
</pre>
<p>Next, in the <kbd>Update</kbd> function, set the value of <kbd>bIsGamePaused</kbd> to <kbd>pauseButtons.isOn</kbd> variable. This will set the value to <kbd>true</kbd> or <kbd>false</kbd> based on whether you clicked on the pause button.</p>
<p>The <kbd>Update</kbd> function will look like the following:</p>
<pre>
    void Update () {     <br/>        if (!bGameover) { <br/><strong>            bIsGamePaused = pauseButton.isOn;</strong> <br/><br/>            Debug.Log("isGamePaused: " + bIsGamePaused);        <br/><br/>            int playerHealth = pScript.health; <br/>            int enemyHealth = eScript.health; <br/><br/>            // other code <br/>        } <br/>    } 
</pre>
<p>Next, in the <kbd>enemyScript</kbd>, enclose the <kbd>Update</kbd> function and check whether the <kbd>bIsGamePaused</kbd> is <kbd>false</kbd>, in a similar way to how we check if the game is over or not:</p>
<pre>
    void Update () {    <br/>        gameScript gScript = mainCamera.GetComponent&lt;gameScript&gt;(); <br/><br/>        if (gScript.bGameover == false) <br/>        { <br/>            if (gScript.bIsGamePaused == false) <br/>            {<br/>                punchTick--; <br/>                myTick++; <br/>                currentTick = myTick; <br/><br/>                GameObject player = GameObject.Find("theDude"); <br/>                Animator pAnim = player.GetComponent&lt;Animator&gt;(); <br/>                playerScript pScript = player.GetComponent &lt;playerScript&gt;(); <br/><br/>                // Other game code <br/>            } <br/>        } <br/>    } 
</pre>
<p>Do the same in <kbd>playerScript</kbd>:</p>
<pre>
    void Update () { <br/>        gameScript gScript = mainCamera.GetComponent&lt;gameScript&gt;(); <br/><br/>        if (gScript.bGameover == false) <br/>        { <br/>            if (gScript.bIsGamePaused == false) <br/>            { <br/>                totalTime += Time.deltaTime; <br/><br/>                GameObject enemy = GameObject.Find("Enemy"); <br/>                Animator eAnim = enemy.GetComponent&lt;Animator&gt;(); <br/>                enemyScript eScript = enemy.GetComponent<br/>                                      &lt;enemyScript&gt;(); <br/><br/>                // other game code <br/>            } <br/>        } <br/>    } 
</pre>
<p>Now, when you run the game, you can pause the game by tapping on the pause button.</p>
<p>In <kbd>mainCamera</kbd> do not forget to assign the <kbd>toggleBtn</kbd> to the <kbd>gameScript</kbd> script as it is expecting it to be similar to how you attached <kbd>resetBtn</kbd>:</p>
<div><img class=" image-border" height="373" src="img/image_06_021.png" width="593"/></div>


            

            <footer style="margin-top: 5em;">
                
            </footer>

        
    

        

            
                <h1 class="header-title">Adding a main menu button to the startScene</h1>
            

            
                
<p>We will create a main menu button, so that we can press it to go to the MainMenu scene when we select it. To do this, we will create a new button and name it mainMenuBtn. Position the mainMenuBtn so that it is to the left of the middle of the screen.</p>
<p>Also select the homeBtn2 option as the Source Image in the Image (Script) section; and leave the rest of the values set to their defaults:</p>
<div><img class=" image-border" height="492" src="img/image_06_022.png" width="210"/></div>
<p>Like the reset button, we can only show the main menu button once the game is over. So, in <kbd>gameScript</kbd>, create a new public variable called <kbd>mainMenuButton</kbd>, shown as following:</p>
<pre>
    public Button resetButton; <br/><strong>    public Button mainMenuButton;</strong> <br/>    public Toggle pauseButton; 
</pre>
<p>Set the active status of the <kbd>mainMenuButton</kbd> to <kbd>false</kbd> in the <kbd>Start</kbd> function:</p>
<pre>
    // Use this for initialization<br/>    void Start () { <br/><br/>        GameObject player = GameObject.Find("theDude"); <br/>        pScript = player.GetComponent&lt;playerScript&gt;(); <br/><br/>        GameObject enemy = GameObject.Find("Enemy"); <br/>        eScript = enemy.GetComponent&lt;enemyScript&gt;(); <br/>        gameOverText.enabled = false; <br/><br/>        resetButton.gameObject.SetActive(false); <br/><strong>        mainMenuButton.gameObject.SetActive(false);</strong> <br/>    } 
</pre>
<p>When the game is over, set the active state to true.</p>
<pre>
    if (playerHealth &lt;= 0 || enemyHealth &lt;= 0) { <br/>        bGameover = true; <br/><br/>        gameOverText.enabled = true; <br/>        resetButton.gameObject.SetActive(true); <br/><strong>        mainMenuButton.gameObject.SetActive(true);</strong> <br/><br/>        Instantiate(particlePrefab); <br/>        Debug.Log(" +++++ GAMEOVER +++++"); <br/>    } 
</pre>
<p>Next, in the <kbd>mainMenu</kbd> button object, go to the Button (Script) tab and, in the On Click () tab, set it so that it calls mainMenuScene when the button is clicked:</p>
<div><img class=" image-border" height="282" src="img/image_06_023.png" width="199"/></div>
<p>Now, mainMenuScene has not been created yet, so we will create a mainMenuScene next.</p>


            

            <footer style="margin-top: 5em;">
                
            </footer>

        
    

        

            
                <h1 class="header-title">Creating MainMenu scene</h1>
            

            
                
<p>Go to the Scenes folder in the Project tab, right-click and create a new scene:</p>
<div><img class=" image-border" height="159" src="img/image_06_024.png" width="389"/></div>
<p>Name the scene mainMenuScene. Now you will have two scenes in the project's Scenes folder:</p>
<div><img class=" image-border" height="239" src="img/image_06_025.png" width="350"/></div>
<p>Double-click on the mainMenuScene scene and open it. This is a new empty scene, so we will start populating this scene now.</p>
<p>First, we'll add a background image. Go to GameObject-&gt; UI and create an Image. It will create a new canvas and an image. Leave the canvas values set to their defaults.</p>
<p>Next, rename the image to <kbd>bgImage</kbd>. Select the <kbd>scenary-ipad</kbd> file as the background image, and click on Set Native Size option so that the image gets resized.</p>
<p>Next, in the titleText, we can add a name for the game, which we will call PunchyPunch. In the text box, rename the text to PunchyPunch. It is also a good idea to change the font from Ariel. In the <kbd>Resources</kbd> folder for this chapter, you will find a duncecapbb font. Copy and paste the font into the <kbd>Assets/fonts</kbd> folder. Under the Character section, in the Font option, select the duncecapbb_re as the font.</p>
<p>Finally, change the color so that it is a lighter shade of blue:</p>
<div><img class=" image-border" height="477" src="img/image_06_026.png" width="206"/></div>
<p>After these additions, the MainMenu scene should be starting to take shape and look like the following:</p>
<div><img class=" image-border" height="437" src="img/image_06_027.png" width="800"/></div>
<p>Save this scene.</p>
<p>Next, to make sure mainMenuScene gets called when we click on the mainMenuBtn button in startScene, we have to add the scene to the Build Settings, so open up Build Settings menu by going into the file and clicking Add Open Scenes:</p>
<div><img class=" image-border" height="256" src="img/image_06_028.png" width="457"/></div>
<p>Now, open the startScene and click the play button. Once the game is over the mainMenuBtn button will appear. Click on it, and the MainMenu scene should load.</p>
<p>Now let us add a play button to mainScene that will call startScene. So, open up mainMenuScene again.</p>
<p>Go to GameObjects | UI to create a button. Call this button <kbd>playBtn</kbd>. It will be created under the current canvas.</p>
<p>Position the play button so that it is at the center of the screen. In Image (Script), for the Source Image field, select playBtn_normal option. In Button (Script) section, select the Sprite Swap option Transition type field. We will swap the image to show that the button was pressed.</p>
<p>Select platBtn (Image) in the Target Graphic field; playBtn_normal in the Highlighted Sprite field; playBtn_pressed in the Pressed Sprite field; and playBtn_normal in the Disabled Sprite field (or you could leave it blank as we will never disable this button):</p>
<div><img class=" image-border" height="398" src="img/image_06_029.png" width="180"/></div>
<p>After adding the play button, the main menu scene should look like the following image:</p>
<div><img class=" image-border" src="img/image_06_030.png"/></div>
<p>To make the button interactive, we have to create an empty object and attach the <kbd>buttonClick</kbd> script to it. So, create an empty object, call it <kbd>buttonClickGO</kbd>, and attach the <kbd>buttonClick</kbd> script to it.</p>
<p>Now, on the <kbd>playBtn</kbd> game object in the On Click () section, select the buttonClickGO, call the <kbd>onButtonClick</kbd> function, and pass in the startScene variable to it:</p>
<div><img class=" image-border" height="187" src="img/image_06_031.png" width="184"/></div>
<p>Now, when you click the play button, it will load game by loading startScene.</p>
<p>I have also created one more scene, for <em>options</em>. The <strong>Options</strong> scene will contain the functionality to mute or reduce the sound in the game.</p>
<p>To do this, one more button need to be added to the MainMenu scene, as these scenes will only be accessible from the MainMenu scene. Additionally, we will add one more button which will open the achievements window. The button images are provided in the resources folder and you can use these images and place then anywhere in the MainMenu scene as shown in the following screenshot:</p>
<div><img class=" image-border" height="415" src="img/image_06_032.png" width="757"/></div>
<p>The same <kbd>buttonClickGO</kbd> was used so that when either button is clicked, it will take you to their respective scenes.</p>
<p>Obviously, one scene was created, called optionsScene. Now the <kbd>Scenes</kbd> project folder should look like the following:</p>
<div><img class="aligncenter size-full wp-image-1006 image-border" height="116" src="img/scenes-image.png" width="236"/></div>
<p>Here is the options scene. There is nothing much here at the moment, but in the next chapter, when we add audio, we will also create a mute button here:</p>
<div><img class=" image-border" height="422" src="img/image_06_035.png" width="770"/></div>


            

            <footer style="margin-top: 5em;">
                
            </footer>

        
    

        

            
                <h1 class="header-title">Summary</h1>
            

            
                
<p>In this chapter, we saw how to create new scenes and transition between scenes at the click of a button... literally! We added buttons to start the game and travel between the scenes.</p>
<p>We will be using the buttons a lot in the next chapter, when we will see how to add achievements, in app purchases, and add integration. Almost all of these will include the addition of a button. We will also see how to add some different types of buttons.</p>


            

            <footer style="margin-top: 5em;">
                
            </footer>

        
    </body></html>