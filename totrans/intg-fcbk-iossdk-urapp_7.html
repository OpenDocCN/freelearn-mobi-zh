<html><head></head><body><h1 id="e-j0jA">Chapter 7. Distributing Your Social Application</h1>
<p id="e-ePI9">In this chapter we are going to review useful strategies to distribute and make our social application go viral.</p>
<p id="e-Vs5Z">We are going to promote our application on social channels; for example App Center. An important tool to keep in mind is the ability to send invitations to our friends on mobile devices through the Facebook iOS SDK.</p>
<h1 id="e-UZ4F">Social channels</h1>
<p id="e-jpaW">Several channels are available to developers to distribute and promote their social application. We can use different strategies based on the type of application we are building. In this section we will focus on how to improve the visibility of our app through Facebook tools.</p>
<p id="e-jiJd">Feed and Timeline are two in-built tools our social application can use. In the previous chapter, we implemented features to publish status updates and new stories on a user's timeline.</p>
<p id="e-LRkO">In this chapter we are going to describe how to use the App Center to increase the visibility of our application. An important feature we can utilize is the ability to invite Facebook friends to our application.</p>
<h2 id="e-uzcr">App Center</h2>
<p id="e-fGmN">We already introduced the App Center in Chapter 1, <em>Introduction to the Facebook Platform</em>. In this section we are going to use it to expand our social application visibility.</p>
<p id="e-Wey3">The App Center is the main shop window for your application. As developers, we must take advantage of this important tool. Once our social application is available on the App Center, our audience has the potential to be over one billion users.</p>
<p id="e-Bqn7">In order to have our application listed on the Facebook App Center, we will need to create the application page detail. This page detail will provide information on features that will make our application unique and appealing to the end user. Facebook reviews every page detail before the application is approved and listed in the App Center.</p>
<p id="e-C0bM">Let's start creating our application page detail from the Facebook App Dashboard.</p>
<p id="e-T282">For more details on this visit <a href="https://developers.facebook.com/apps">https://developers.facebook.com/apps</a>.</p>
<p id="e-cohd">On the left side bar, select the application we are currently working on and click on the <strong>Edit App</strong> button.</p>
<img data-width="497" data-height="104" src="img/OxpNqWuI.jpg"/><p id="e-dnhG">App Dashboard Edit App</p>
<p id="e-MDGg">Select <strong>App Details</strong> on the left bar and you should be able to see something that resembles the following screenshot:</p>
<img data-width="700" data-height="477" src="img/PfcA2EDc.jpg"/><p id="e-ng6L">App details</p>
<p id="e-F9Ym">When entering your application info, consider the following guidelines:</p>
<ul id="e-YBPs">
<li id="e-xsL5">
<strong>Description</strong>: This is unique across the App Center</li>
<li id="e-avGk">
<strong>Detailed Description</strong>: This content should be more verbose than Description</li>
<li id="e-U8w2">
<strong>Tagline</strong>: This shouldn't contain the <strong>Display Name</strong>
</li>
<li id="e-cX6z">
<strong>Privacy Policy URL</strong>, <strong>Terms of Service URL</strong>, and <strong>User Support Email/URL</strong>: These are mandatory fields that need to be defined</li>
</ul>
<p id="e-AI5L">Through the App Details Dashboard you can customize the way your App Page Detail will look.</p>
<p id="e-QHOQ">We need to be sure that the <strong>Facebook Login</strong> feature is enabled in order to see our social application on Facebook App Center. We will also enable <strong>Deep Linking</strong>, which will later be explained in the <em>Inviting friends</em> section in this chapter. In order to edit the application settings, we can click on the  <strong>Settings</strong> link on the left side bar.</p>
<img data-width="368" data-height="502" src="img/A1IYTMl9.jpg"/><p id="e-xiEN">App Dashboard left side bar</p>
<p id="e-g4Jp">Select <strong>Native iOS App</strong> as shown in the following screenshot:</p>
<img data-width="700" data-height="222" src="img/KrkT0hZB.jpg"/><p id="e-SRSD">iOS App Settings</p>
<p id="e-dzUs">When you enable iOS integration (<strong>Facebook Login</strong>/<strong>Deep Linking</strong>), you also need to define either iPhone App Store ID or iPad App Store ID.</p>
<p id="e-P2LM">Now that we have all the settings ready to go, we can go back to the App Detail Page Dashboard to take a look at the web preview. When we find the web preview acceptable, we can finally submit our Detail Page for review.</p>
<img data-width="700" data-height="100" src="img/XJjzD6jD.jpg"/><p id="e-lVfh">Submit App Detail Page</p>
<p id="e-j0iy">We need to wait until our App Detail Page is approved before seeing it in the App Center.</p>
<h2 id="e-lGMo">Send to Mobile</h2>
<p id="e-U1Qc">The Send to Mobile feature was introduced to give users the ability to install mobile applications on their device while they are exploring Facebook Web Portal.</p>
<p id="e-Osa3">Send to Mobile is a new feature introduced by Facebook to facilitate the mobile application install flow. When users are browsing the App Center they are able to click on the <strong>Send to Mobile</strong> button. Once users click on that button they are logged in to Facebook Mobile through their mobile device, and Facebook will send an invitation to their device. By clicking on the notification, users will be redirected to the App Store or Google Play. This is possible through the <strong>Deep Linking</strong> setting.</p>
<img data-width="498" data-height="90" src="img/cSEDS7w8.jpg"/><p id="e-nwYQ">Send to Mobile</p>
<h2 id="e-z3Ky">Inviting friends</h2>
<p id="e-jiS5">In this section we will describe a new application flow to invite our Facebook friends to use our new social application. In Chapter 3, <em>Connecting to a Facebook User Account</em>, we built <code>FBFriendPickerViewController</code> so that we could select multiple friends. In this section we are going to take advantage of that feature and build a Native and a Web Dialog to share a message with our friends.</p>
<p id="e-JZbu">In order to send App Invites, our Facebook Application needs to define the App on Facebook settings. Visit the Facebook App Dashboard and select our current application. Locate the App on Facebook section, as shown in the following screenshot:</p>
<img data-width="700" data-height="39" src="img/BdAukWVe.jpg"/><p id="e-BU59">App on Facebook Section</p>
<p id="e-u3oA">Open the section and populate the necessary fields as shown in the following screenshot:</p>
<img data-width="700" data-height="180" src="img/CtiYJlAX.jpg"/><p id="e-ZpqG">App on Facebook</p>
<p id="e-d6Ox">If you don't have a Canvas URL, please check out the following link in order to create one:</p>
<p id="e-odE2"><a href="https://developers.facebook.com/docs/appsonfacebook/tutorial/">https://developers.facebook.com/docs/appsonfacebook/tutorial/</a></p>
<p id="e-GpSV">The Canvas URL is necessary to send invites from our iOS application to our Facebook friends.</p>
<p id="e-NmHO">Now we can focus on coding the Invite feature in our social application.</p>
<p id="e-Xi8D">Open Storyboard and select the Facebook Scene.</p>
<img data-width="267" data-height="500" src="img/fBTESFOo.jpg"/><p id="e-okMx">Facebook Scene</p>
<p id="e-tQUX">Create a new button underneath the Friends button, as shown in the following screenshot:</p>
<img data-width="269" data-height="500" src="img/iGkgEgNk.jpg"/><p id="e-RVBL">Facebook Scene with the Invite Friends button</p>
<p id="e-XugA">Using <strong>Utilities | Show Attribute Inspector</strong> change the default button state to disabled by unchecking the <strong>Enabled</strong> checkbox. The following screenshot shows the Attribute Inspector Control Panel:</p>
<img data-width="500" data-height="400" src="img/IbIEf4x5.jpg"/><p id="e-TUAo">Control Panel—Enabled checkbox unchecked</p>
<p id="e-DUew">Change the background color for <strong>State Config</strong> within the Button section under the Attribute section, as shown in the next screenshot:</p>
<img data-width="500" data-height="446" src="img/hqlSRZme.jpg"/><p id="e-rXaW">Changing the background color</p>
<p id="e-vPll">The following screenshot shows the final result of tuning the button settings:</p>
<img data-width="263" data-height="500" src="img/CLyBhhRu.jpg"/><p id="e-YfVR">Facebook Scene with disabled Invite Friends button</p>
<p id="e-ydhg">Open the Assistant Editor and verify the <code>LBFacebookViewController.m</code> file is open to your right.</p>
<img data-width="800" data-height="270" src="img/myd3JBEm.jpg"/><p id="e-UuME">Assistant Editor—LBFacebookViewController.m</p>
<p id="e-ctSe">Select the <strong>Invite Friends</strong> button and create a new action within <code>LBFacebookViewController</code>. This can be done by holding Control on your keyboard and dragging-and-dropping the blue arrow within the <code>.m</code> file. Name the new method <code>onInviteFriendsClick</code>.</p>
<img data-width="500" data-height="237" src="img/VYJQQwAv.jpg"/><p id="e-EmvX">onInviteFriendsClick</p>
<p id="e-fU3A">The following snippet shows the code for the <code>onInviteFriends</code> method:</p>
<pre id="e-zt22">- (IBAction)onInviteFriendsClick:(id)sender {
    [self sendAppInvite];
}</pre>
<p id="e-QtkD">The preceding method invokes <code>sendAppInvite</code>. The <code>sendAppInvite</code> method will create the Web Dialog component that will allow users to select which friends to send the invite to.</p>
<pre id="e-dcY4">- (void)sendAppInvite
{
    [FBWebDialogs presentRequestsDialogModallyWithSession:nil
                                                  message:@"iLikeBook"
                                                    title:@"Try iLikeBook. It's really fun!"
                                               parameters:nil
                                                  handler:^(FBWebDialogResult result, NSURL *resultURL, NSError *error) {
                                                      NSLog(@"Result URL: %@", resultURL);
                                                     if (!error) {
                                                         if (result == FBWebDialogResultDialogNotCompleted) {
                                                             NSLog(@"User canceled request.");
                                                         } else {                
                                                             NSDictionary *urlParams = [self parseURLParams:[resultURL query]];
                                                             if (![urlParams valueForKey:@"request"]) {
                                                                 NSLog(@"User canceled request.");
                                                             } else {
                                                                 NSString *requestID = [urlParams valueForKey:@"request"];
                                                                 NSLog(@"Request ID: %@", requestID);
                                                             }
                                                         }
                                                     } else {
                                                         NSLog(@"Error sending request.");
                                                     } 
     }];
}</pre>
<p id="e-LgPo">The preceding code snippet shows the implementation for the <code>sendAppInvite</code> method. This method will instantiate a new web dialog component using the <code>FBWebDialogs</code> class. We used <code>FBWebDialogs</code> to post a new story on the user's Timeline in Chapter 5, <em>Posting on Walls</em>.</p>
<p id="e-LuLv">The <code>presentRequestDialogModallyWithSession</code> class method will create a request dialog with the message and title information passed as parameters. Using the handler we can check whether the Web Dialog was completed or cancelled by the user. It can also check if the Facebook request succeeded or failed.</p>
<p id="e-H3JA">An important variable for the handler is <code>resultURL</code>. This provides information on the outcome of our request. Once we receive the response back from the Platform, we can parse the <code>resultURL</code> information using the <code>parseURLParams</code> helper to extract the new invite request ID.</p>
<pre id="e-fohc">// Provided by Facebook SDK Samples
- (NSDictionary*)parseURLParams:(NSString *)query {
    NSArray *pairs = [query componentsSeparatedByString:@"&amp;amp;"];
    NSMutableDictionary *params = [[NSMutableDictionary alloc] init];
    for (NSString *pair in pairs) {
        NSArray *kv = [pair componentsSeparatedByString:@"="];
        NSString *val =
        [[kv objectAtIndex:1]
         stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
        
        [params setObject:val forKey:[kv objectAtIndex:0]];
    }
    return params;
}</pre>
<p id="e-ff8j">When we run the application, clicking on the Invite Friends button will create the new dialog as shown in the following screenshot:</p>
<img data-width="565" data-height="800" src="img/VH8cTeso.jpg"/><p id="e-K9Mj">FBWebDialogs for sending invitations</p>
<p id="e-Xbvy">The new dialog allows users to select friends from our Facebook list and use a search query to filter out the friends list displayed.</p>
<p id="e-lPEe">Once the users click on the <strong>Send</strong> button, the application will send a new request to the Facebook Platform to forward invites to selected friends. Facebook Platform will only show the invites to our friends if our Facebook Application has a Canvas URL value set.</p>
<p id="e-UTd5">After we send invites, our friends can open the invite on either the Facebook web or mobile app. We are interested in redirecting users to the App Store once they click on the Facebook Notification on their iOS devices.</p>
<img data-width="362" data-height="642" src="img/cd3VmSm3.jpg"/><p id="e-J6ut">Facebook Notification</p>
<p id="e-oDH6">Once the user clicks on the Facebook notification, they will be redirected to the App Store to install our new social application.</p>

<h1 id="e-L7fp">Summary</h1>
<p id="e-fjJx">In this chapter we learned a few ways to distribute our social application using the Facebook channels.</p>
<p id="e-mE2D">The main channel to distribute our social app is Facebook App Center. People will be able to discover our app based on categories or through the search functionalities.</p>
<p id="e-tmLH">The App Center also offers the ability to send a link to our mobile devices in order to install the application. So if we are surfing the App Center on the Facebook desktop version, we can send a text to our mobile number with the application link and directly install it.</p>
<p id="e-wuWn">Let's not forget about the most important resource we have on Facebook, our friends. We can easily create invites for them in order to share our social application.</p>
<p id="e-DhYi">These are just examples of how to promote our social application. We may use our own website, Twitter account, and any other tool that can give us more visibility.</p>
</body></html>