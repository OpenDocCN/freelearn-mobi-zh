<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:pls="http://www.w3.org/2005/01/pronunciation-lexicon" xmlns:ssml="http://www.w3.org/2001/10/synthesis">
<head>
  <meta charset="UTF-8"/>
  <title>Building an Android Application – Tetris</title>
  <link type="text/css" rel="stylesheet" media="all" href="style.css"/>
  <link type="text/css" rel="stylesheet" media="all" href="core.css"/>
</head>
<body>
  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Building an Android Application – Tetris</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">In the previous chapter, we took a concise look at crucial topics pertaining to the core Kotlin language. These topics took us through the fundamentals of Kotlin as well as the powerful object-oriented programming approach to software development it puts at our disposal. In this chapter, we will put the knowledge we gained from the previous chapter to good use by developing an Android application.</span></p>
<p>In this chapter, you will learn about&#160;the following topics:</p>
<ul>
<li>Android application components</li>
<li>Views</li>
<li>View groups</li>
<li>Layout constraints</li>
<li>Implementing layouts with XML</li>
<li>String and dimension resources</li>
<li>Handling input events</li>
</ul>
<p class="p1"><span class="s1">We will learn these topics through a hands-on approach by implementing the layouts and components of a classic game, Tetris, in the form of an Android application. As we are developing the game in the form of an Android application, before proceeding further, it is imperative that we do a brief overview of the Android operating system.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Android – an overview</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">Android is a Linux-based mobile operating system developed and maintained by Google and created primarily to power smart mobile devices such as mobile phones and tablets. The primary interface to interact with the Android operating system is <strong>Graphic User Interface</strong>&#160;(<strong>GUI</strong>)-based. Users of devices powered by Android manipulate and interact with the operating system environment primarily via a visual touch-based interface by performing gestures such as taps and swipes on the display.</span></p>
<p class="p1"><span class="s1">Software can be installed on the Android OS in the form of apps. An app is an application that runs within an environment and performs one or more tasks for the achievement of a goal or a collection of goals. The ability to install applications on mobile devices presented a huge opportunity to both users and application developers. Users take advantage of the features provided by apps to achieve day-to-day goals and developers take advantage of the demand for software applications by developing apps that meet user needs and perhaps make a profit.</span></p>
<p class="p1"><span class="s1">To developers, Android provides a vast array of tools and utilities for the development of high-performance applications. These applications can target different markets such as recreation, enterprise, and e-commerce. Applications can also come in the form of games.</span></p>
<p class="p1"><span class="s1">Over the course of this chapter, we will explore a number of these tools and utilities, which are provided by the Android application framework, in more detail.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Application components</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">The Android application framework provides us with a number of components we can utilize to build a user interface for the <em>Tetris</em> application. A component in Android is a reusable program template or object that can be used to define aspects of an application. Some important components provided by the Android application framework are:</span></p>
<ul class="ol1">
<li class="li1"><span class="s1">Activities</span></li>
<li class="li1"><span class="s1">Intents</span></li>
<li class="li1"><span class="s1">Intent filters</span></li>
<li class="li1"><span class="s1">Fragments</span></li>
<li class="li1"><span class="s1">Services</span></li>
<li class="li1"><span class="s1">Loaders</span></li>
<li class="li1"><span class="s1">Content providers</span></li>
</ul>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Activities</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">An activity is an Android component that is central to the implementation of application flow and component-to-component interaction. Activities are implemented in the form of classes. An instance of an activity is used by the Android system for code initiation.</span></p>
<p class="p1"><span class="s1">An activity is important in the creation of applications' user interfaces. It provides a window upon which user interface elements can be drawn. Simply put, application screens are created with the use of activities in mind.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Intents</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">An intent facilitates inter-activity communication. Intents can be considered messengers within an Android application. They are messaging objects that are used to request actions from application components. Intents can be used for actions, such as requesting the start of an activity and delivering broadcasts, within the Android system environment.</span></p>
<p class="p1"><span class="s1">There are two types of intents. These are:</span></p>
<ul class="ol1">
<li class="li1"><span class="s1">Implicit intents</span></li>
<li class="li1"><span class="s1">Explicit intents</span></li>
</ul>
<p class="p1"><span class="s1"><strong>Implicit intents</strong>: These are messenger objects that do not specifically identify an application component to perform an action, but specify an action to be performed and allow a component that may exist in another application to perform the action. The components that can handle an action requested implicitly are identified by the Android system.</span></p>
<p class="p1"><span class="s1"><strong>Explicit intents</strong>: These intents specify explicitly the application component that should perform an action. These can be used to perform actions, such as starting an activity, within your application:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="images/6f0e21b8-c0d5-40f4-967a-dbb1591fcf97.jpg" style="width:39.17em;height:6.75em;"/></div>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Intent filters</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">An intent filter is a declaration in the application manifest file that specifies the type of intent that a component would like to receive. This is useful in a number of cases, such as a scenario in which you want an activity in your application to handle a specific action requested by components in another application. For this case, an intent filter can be declared in the application manifest for the activity you want to handle the external request. If you do not want an activity to handle implicit intents, you simply do not declare an intent filter for it.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Fragments</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">A fragment is an application component that represents a part of a user interface that exists within an activity. Similar to an activity, a fragment possesses a layout that can be modified and is drawn on the activity window.&#160;</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Services</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">Unlike most other components, a service does not provide a user interface. Services are used to perform background processes in an application. A service does not need the application that created it to be in the foreground to run.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Loaders</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">A loader is a component that enables the loading of data from a data source, such as a content provider, for later display in an activity or fragment.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Content providers</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">These components help an application control access to data resources stored either within the application or within another app. In addition, a content provider facilitates the sharing of data with another application via an exposed application programming interface:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="images/c0d35c91-ba13-4e6f-bb8e-258a71de14b5.jpg" style="width:23.42em;height:18.00em;"/></div>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Understanding Tetris</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">Before attempting to develop the <em>Tetris</em> game as an Android application, we need to understand the game, its rules, and its constraints.</span></p>
<p class="p1"><span class="s1">Tetris is a matching puzzle video game that makes use of tiles. The name <em>Tetris</em>&#160;is derived from the words tetra – the Greek numerical prefix for four – and tennis. The tiles in Tetris combine to make up tetrominoes which are geometric shapes composed of four squares connected orthogonally:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="images/ab15a72f-e060-49d0-b916-5c009ee66f94.jpg" style="width:19.42em;height:14.42em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Tetris tetrominoes</div>
<div>
<p class="p1"><span class="s1">In Tetris, a random sequence of tetrominoes fall down upon a playing field. These tetrominoes can be manipulated by the player. A number of motions can be performed on each tetromino piece. Pieces can be moved to the left, to the right, and rotated. In addition, the speed of descent of each piece can be sped up. The objective of the game is to create an uninterrupted horizontal line of ten cells with the descending pieces. When such a line is created, the line is cleared.&#160;</span></p>
<p class="p1"><span class="s1">Now that we have an understanding of how Tetris works, let's get into the specifics in order to build the user interface of the application.</span></p>
</div>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Creating the user interface</h1>
                </header>
            
            <article>
                
<p>As previously mentioned, the user interface is the means by which the user of an application interacts with the app. It cannot be overstated how important the user interface of an application is. Before embarking on the process of actually coding a user interface, it may be helpful to make a graphical representation of the UI to be implemented. This can be done with different tools, such as Photoshop, but for this case, a simple sketch is sufficient:</p>
<div class="CDPAlignCenter CDPAlign"><img src="images/616a3515-92ed-4bb0-9961-2dcf96290bed.png" style="width:30.58em;height:22.67em;"/></div>
<p class="p1"><span class="s1">From the preceding sketch, we can see that we will need two distinct screens in this application: the landing screen and the game screen where the actual gameplay will happen. These two screens will require two separate activities. We'll call these two activities <kbd>MainActivity</kbd> and <kbd>GameActivity</kbd>.</span></p>
<p class="p1"><span class="s1"><kbd>MainActivity</kbd> will serve as the entry point of our application. It will contain the user interface and all logic pertaining to our landing screen. As we can observe in our sketch, the UI of the landing screen contains the application title, a view that shows the user their current high score, and three buttons performing different actions. The <strong>NEW GAME</strong> button, as the name implies, will lead the user to the activity in which the gaming takes place. <strong>RESET SCORE</strong> will reset the score of the user to zero and <strong>EXIT</strong> will close the application.</span></p>
<p class="p1"><span class="s1"><kbd>GameActivity</kbd> will be the programmatic template of the game screen. In this activity, we will create the views and logical interactions between the user and the game. The UI of this activity contains an action bar with the title of the application displayed on it, two text views that display the current score of the user and their high score, and a layout element in which the Tetris gameplay will happen.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Implementing the layouts</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">Now that we know the activities that are needed in this application and have a rough idea of how we want our user interface to look when viewed by the user, we can get into the actual implementation of the user interface.</span></p>
<p class="p1"><span class="s1">Create a new Android project in Android Studio and give it the name <kbd>Tetris no activity</kbd>. Once the IDE window opens, you will notice that the project structure is similar to the one in <a href="kt-prog-ex_ch01.html">Chapter 1</a>, <em>The Fundamentals</em>.</span></p>
<p class="p1"><span class="s1">The first thing we need to do is add <kbd>MainActivity</kbd> to our project. We want <kbd>MainActivity</kbd> to be an empty activity. We can add <kbd>MainActivity</kbd> to our project by right-clicking on our source package and selecting <span class="packt_screen">New</span> | <span class="packt_screen">Activity</span> | <span class="packt_screen">Empty Activity</span></span>:</p>
<div class="CDPAlignCenter CDPAlign"><img src="images/660f01bc-7f6d-41b1-92f6-ed430a78bdab.png"/></div>
<p class="p1"><span class="s1">Name the activity <kbd>MainActivity</kbd>, and ensure the <span class="packt_screen">Generate Layout File</span>, <span class="packt_screen">Launcher Activity</span>, and <span class="packt_screen">Backwards Compatibility (AppCompat)</span> checkboxes are ticked.</span></p>
<p class="p1"><span class="s1">Upon the addition of the activity to your project, navigate to its layout resource file. It should look similar to the following code:</span></p>
<pre class="p1"><span class="s1">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="s1">&lt;android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>xmlns:app="http://schemas.android.com/apk/res-auto"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>xmlns:tools="http://schemas.android.com/tools"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>android:layout_height="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>tools:context="com.mydomain.tetris.MainActivity"&gt;<br/></span><span class="s1">&lt;/android.support.constraint.ConstraintLayout&gt;</span></pre>
<p class="p1"><span class="s1">Line one of the resource file specifies the XML version utilized in the file as well as the character encoding used. <kbd>utf-8</kbd> is used for character encoding in this file. <strong>UTF</strong> stands for <strong>Unicode Transformation Format</strong>. It is an encoding format that can be as compact as&#160;<strong>American Standard Code for Information Interchange</strong> (<strong>ASCII</strong>)—the most common character format for text files—and can contain any Unicode character. The next eight lines define a <kbd>ConstraintLayout</kbd> to be rendered in the UI of <kbd>MainActivity</kbd>.</span></p>
<p class="p1"><span class="s1">Let's consider the <kbd>ConstraintLayout</kbd> in a bit more detail before moving forward.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">ConstraintLayout</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">A <kbd>ConstraintLayout</kbd> is a type of&#160;view group that allows the flexible positioning and resizing of application widgets. Various types of constraints can be used on a <kbd>ConstraintLayout</kbd>. Some examples are.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Margins</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">A margin is a space that exists between two layout elements. When a side margin is set on an element, it is applied to its corresponding layout constraints, if one is available, by adding the margin as a space between the target side and the source side (the side of the element adding the margin):</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="images/327b1c36-3ba4-442c-94ad-e1636cf52590.jpg" style="width:18.67em;height:8.08em;"/></div>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Chains</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">Chains are constraints that provide group-like behavior in a single axis. The axis may be either horizontal or vertical:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="images/9b6ac711-a5da-410c-8181-940451fe853e.jpg" style="width:20.83em;height:9.33em;"/></div>
<p class="p1"><span class="s1">A collection of elements is a chain if they are all connected bidirectionally.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Dimension constraints</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">These constraints concern the sizes of widgets placed in a layout. Dimension constraints can be set on widgets, and using a <kbd>ConstraintLayout</kbd>:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="images/afb8e12b-2dee-4c96-9ad3-b8a9eba807e9.jpg" style="width:13.92em;height:12.00em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">&#160; &#160; &#160; A dimension constraint</div>
<div>
<p class="p1"><span class="s1">The dimensions of a widget can be specified by the use of <kbd>android:layout_width</kbd> and <kbd>android:layout_height</kbd>:</span></p>
<pre class="p1"><span class="s1">&lt;TextView<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:layout_height="16dp"<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:layout_width="32dp"/&gt;</span></pre>
<p class="p1"><span class="s1">In a number of cases, you may want a widget to have the same dimension as its parent view group. This can be done by assigning the <kbd>match_parent</kbd> value to the dimension attribute:</span></p>
<pre class="p1"><span class="s1">&lt;LinearLayout<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:layout_width="120dp"<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:layout_height="100dp"&gt;<br/></span><span class="s1"><span class="Apple-tab-span"> </span>&lt;TextView<br/></span><span class="s1"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span>android:layout_height="match_parent"/&gt;<br/></span><span class="s1">&lt;/LinearLayout&gt;</span></pre>
<p class="p1"><span class="s1">Alternatively, if you want a widget's dimensions not to be fixed but rather to wrap the elements contained within it, the <kbd>wrap_content</kbd> value should be assigned to the dimension attribute:</span></p>
<pre class="p1"><span class="s1">&lt;TextView<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:text="I wrap around the content within me"<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:textSize="15sp"/&gt;</span></pre>
<p class="p1"><span class="s1">Now that we have a better understanding of the <kbd>ConstraintLayout</kbd>, as well as widget constraints, let's take another look at our <kbd>activity_main.xml</kbd> file:</span></p>
<pre class="p1"><span class="s1">&lt;android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>xmlns:app="http://schemas.android.com/apk/res-auto"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>xmlns:tools="http://schemas.android.com/tools"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>android:layout_height="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>tools:context="com.mydomain.tetris.MainActivity"&gt;<br/></span><span class="s1">&lt;/android.support.constraint.ConstraintLayout&gt;</span></pre>
<p class="p1"><span class="s1">Looking at the <kbd>ConstraintLayout</kbd> element, we can immediately notice that its width and height dimensions have been set to <kbd>match_parent</kbd>. This means that the <kbd>ConstraintLayout</kbd> dimensions are set to match those of the current window. The attributes that have the <kbd>xmlns: prefix</kbd> are used to define XML namespaces. Values set for all XML namespace attributes are namespace URIs. <strong>URI</strong> is short for <strong>Uniform Resource Identifier</strong>&#160;and, as the name suggests, it identifies a resource required by the namespace.</span></p>
<p class="p1"><span class="s1">The <kbd>tools:context</kbd> attribute is typically set to the root element in an XML layout file and specifies the activity that the layout is associated with—in this case, <kbd>MainActivity</kbd>.</span></p>
</div>
<p class="p1"><span class="s1">Now that we understand what's going on in the <kbd>activity_main.xml</kbd> layout, let's add some layout elements to it. From our sketch, we can see that all layout elements are placed in a vertical arrangement. We can do this with the use of a <kbd>LinearLayout</kbd>:</span></p>
<pre class="p1"><span class="s1">&lt;android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>xmlns:app="http://schemas.android.com/apk/res-auto"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>xmlns:tools="http://schemas.android.com/tools"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>android:layout_height="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>tools:context="com.mydomain.tetris.MainActivity"&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;LinearLayout<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_height="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintBottom_toBottomOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintLeft_toLeftOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintRight_toRightOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintTop_toTopOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_marginVertical="16dp"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:orientation="vertical"</span><span class="s1">&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;/LinearLayout&gt;<br/></span><span class="s1">&lt;/android.support.constraint.ConstraintLayout&gt;</span></pre>
<p class="p1"><span class="s1">As we want the <kbd>LinearLayout</kbd> to have the same dimensions as its parent, we set both <kbd>android:layout_width</kbd> and <kbd>android:layout_height</kbd> to <kbd>match_parent</kbd>. Next, we specify the edge constraints of the <kbd>LinearLayout</kbd> using the <kbd>app:layout_constraintBottom_toBottomOf</kbd>, <kbd>app:layout_constraintLeft_toLeftOf</kbd>, <kbd>app:layout_constraintRight_toRightOff</kbd>, and <kbd>app:layout_constraintTop_toTopOf</kbd> attributes.</span></p>
<ul>
<li class="li1"><span class="s1"><kbd>app:layout_constraintBottom_toBottomOf</kbd>: Aligns the bottom edge of the element to the bottom of another</span></li>
<li class="li1"><span class="s1"><kbd>app:layout_constraintLeft_toLeftOf</kbd>: Aligns the left edge of an element to the left of another</span></li>
<li class="li1"><span class="s1"><kbd>app:layout_constraintRight_toRightOf</kbd>: Aligns the right edge of an element to the right of another</span></li>
<li class="li1"><span class="s1"><kbd>app:layout_constraintTop_toTopOf</kbd>: Aligns the top of an element to the top of another.</span></li>
</ul>
<p class="p1"><span class="s1">In this case, all edges of the <kbd>LinearLayout</kbd> are aligned to the edge of its parent—the <kbd>ConstraintLayout</kbd>. <kbd>android:layout_marginVertical</kbd> adds a margin of <kbd>16dp</kbd> to the top and bottom of the element.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Defining dimension resources</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">Typically in a layout file, we can have numerous elements that specify the same constraint values to attributes. Such values should be added to a dimensions resource file. Let's go ahead and create a dimensions resource file now. In your application project view, navigate to <span class="packt_screen">res</span> | <span class="packt_screen">values</span> and create a new value resource file in the directory with the name <kbd>dimens</kbd>:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="images/d00b3027-dcc5-4e87-b5dc-7ed1e81add26.png" style="width:55.83em;height:34.92em;"/></div>
<p class="p1"><span class="s1">Leave all other file attributes at their default values:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="images/d65e90ef-cba6-421f-b705-80e468e39fb0.png" style="width:55.17em;height:34.50em;"/></div>
<p class="p1"><span class="s1">Open the file upon its creation. Its content should be similar to the following code:</span></p>
<pre class="p1"><span class="s1">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/></span><span class="s1">&lt;resources&gt;&lt;/resources&gt;</span></pre>
<p class="p1"><span class="s1">The first line of <kbd>dimens.xml</kbd> declares the XML version and character encoding used within the file. The second line contains a&#160;<kbd>&lt;resources&gt;</kbd>&#160;resources tag. Our dimensions will be declared within this tag. Add a few dimension values, as demonstrated in the following code:</span></p>
<pre class="p1"><span class="s1">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/></span><span class="s1">&lt;resources&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;dimen name="layout_margin_top"&gt;16dp&lt;/dimen&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;dimen name="layout_margin_bottom"&gt;16dp&lt;/dimen&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;dimen name="layout_margin_start"&gt;16dp&lt;/dimen&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;dimen name="layout_margin_end"&gt;16dp&lt;/dimen&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;dimen name="layout_margin_vertical"&gt;16dp&lt;/dimen&gt;<br/></span><span class="s1">&lt;/resources&gt;</span></pre>
<p class="p1"><span class="s1">New dimensions are declared using the <kbd>&lt;dimen&gt;</kbd> tag. Dimension names should typically be written in snake case. The value for a dimension is added within the opening <kbd>&lt;dimen&gt;</kbd> and closing <kbd>&lt;/dimens&gt;</kbd> tags.</span></p>
<p class="p1"><span class="s1">Now that we have added a few dimensions, we can use them in our linear layout:</span></p>
<pre class="p1"><span class="s1">&lt;android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>xmlns:app="http://schemas.android.com/apk/res-auto"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>xmlns:tools="http://schemas.android.com/tools"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>android:layout_height="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>tools:context="com.mydomain.tetris.MainActivity"&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;LinearLayout<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_height="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintBottom_toBottomOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintLeft_toLeftOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintRight_toRightOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintTop_toTopOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_marginTop="@dimen/layout_margin_top" <br/>&lt;!— layout_margin_top dimension reference —&gt;<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_marginBottom="@dimen/layout_margin_bottom" <br/>&lt;!— layout_margin_top dimension reference —&gt;<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:orientation="vertical"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:gravity="center_horizontal"&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;/LinearLayout&gt;<br/></span><span class="s1">&lt;/android.support.constraint.ConstraintLayout&gt;</span></pre>
<p class="p1"><span class="s1">We've gotten our <kbd>LinearLayout</kbd>&#160;view group set up and now we need to add the required layout views to it. Before we do that, we need to understand the concepts of views and view groups.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Views</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">A view is a layout element that occupies a set area of the screen and is responsible for drawing and event handling. View is the base class for UI elements or widgets such as text fields, input fields, and buttons. All views extend the View class.</span></p>
<p class="p1"><span class="s1">Views can be created within an XML layout in a source file. Consider the following code:</span></p>
<pre class="p1"><span class="s1">&lt;TextView<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:text="Roll the dice!"/&gt;</span></pre>
<p class="p1"><span class="s1">Besides creating views directly in a layout file, they can also be created programmatically within program files. For example, a text view can be made by creating an instance of the <kbd>TextView</kbd> class and passing a <kbd>context</kbd> to its constructor. This is demonstrated in the following code snippet:</span></p>
<pre class="p1"><span class="s1">class MainActivity : AppCompatActivity() {<br/></span><span class="s1"><span class="Apple-converted-space">  </span>override fun onCreate(savedInstanceState: Bundle?) {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>super.onCreate(savedInstanceState)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>setContentView(R.layout.activity_main)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>val textView: TextView = TextView(this)<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/></span><span class="s1">}</span></pre>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">View groups</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">A&#160;view group is a special kind of view that is capable of containing views. A view group that contains one or more views is commonly referred to as a parent view and the views contained as its children views.&#160;A view group is the parent class of several other view containers. Some examples of view groups are <kbd>LinearLayout</kbd>, <kbd>CoordinatorLayout</kbd>, <kbd>ConstriantLayout</kbd>, <kbd>RelativeLayout</kbd>, <kbd>AbsoluteLayout</kbd>, <kbd>GridLayout</kbd>, and <kbd>FrameLayout</kbd>.</span></p>
<p class="p1"><span class="s1">View groups can be created within an XML layout in a source file:</span></p>
<pre class="p1"><span class="s1">&lt;LinearLayout<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:layout_marginTop="16dp"<br/></span><span class="s1"><span class="Apple-tab-span"> </span>android:layout_marginBottom="16dp"/&gt;</span></pre>
<p class="p1"><span class="s1">Similar to views, view groups can be created programmatically within component classes. In the following code snippet, a linear layout is made by creating an instance of the <kbd>LinearLayout</kbd> class and passing the <kbd>context</kbd> of <kbd>MainActivity</kbd> to its constructor:</span></p>
<pre class="p1"><span class="s1">class MainActivity : AppCompatActivity() {<br/></span><span class="s1"><span class="Apple-converted-space">  </span>override fun onCreate(savedInstanceState: Bundle?) {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>super.onCreate(savedInstanceState)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>setContentView(R.layout.activity_main)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>val linearLayout: LinearLayout = LinearLayout(this)<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/></span><span class="s1">}</span></pre>
<p class="p1"><span class="s1">Having understood the concepts of views and view groups, we can add a few more views to our layout. Text views are added to a layout with the <kbd>&lt;TextView&gt;</kbd> element and buttons are added with the <kbd>&lt;Button&gt;</kbd> element:</span></p>
<pre class="p1"><span class="s1">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/></span><span class="s1">&lt;android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>xmlns:app="http://schemas.android.com/apk/res-auto"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>xmlns:tools="http://schemas.android.com/tools"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>android:layout_height="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>tools:context="com.mydomain.tetris.MainActivity"&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;LinearLayout<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_height="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintBottom_toBottomOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintLeft_toLeftOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintRight_toRightOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintTop_toTopOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_marginTop="@dimen/layout_margin_top"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_marginBottom="@dimen/layout_margin_bottom"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:orientation="vertical"&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;TextView<br/></span><span class="s1"><span class="Apple-converted-space">            </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">            </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">            </span>android:text="TETRIS"<br/></span><span class="s1"><span class="Apple-converted-space">            </span>android:textSize="80sp"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;TextView<br/></span><span class="s1"><span class="Apple-converted-space">            </span>android:id="@+id/tv_high_score"<br/></span><span class="s1"><span class="Apple-converted-space">            </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">            </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">            </span>android:text="High score: 0"<br/></span><span class="s1"><span class="Apple-converted-space">            </span>android:textSize="20sp"<br/></span><span class="s1"><span class="Apple-converted-space">            </span>android:layout_marginTop="@dimen/layout_margin_top"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;LinearLayout<br/></span><span class="s1"><span class="Apple-converted-space">            </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">            </span>android:layout_height="0dp"<br/></span><span class="s1"><span class="Apple-converted-space">            </span>android:layout_weight="1"<br/></span><span class="s1"><span class="Apple-converted-space">            </span>android:orientation="vertical"&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;Button<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:id="@+id/btn_new_game"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           a</span>ndroid:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:text="New game"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;Button<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:id="@+id/btn_reset_score"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:text="Reset score"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;Button<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:id="@+id/btn_exit"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:text="exit"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;/LinearLayout&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;/LinearLayout&gt;<br/><span>&lt;/android.support.constraint.ConstraintLayout&gt;</span></span></pre>
<p class="p1"><span class="s1">As our sketch outlines, we have added two text views to hold the application title and the high score, as well as three buttons to execute the required actions. We have made use of two new attributes. These attributes are <kbd>android:id</kbd> and <kbd>android:layout_weight</kbd>. The <kbd>android:id</kbd> attribute is used to set a unique identifier for an element in a layout. No two elements in the same layout can have the same ID. The <kbd>android:layout_weight</kbd> attribute is used to specify a precedence value for how much space a view should take in its parent container:</span></p>
<pre>&lt;<span>LinearLayout<br/></span><span>    </span><span>android</span><span>:layout_width=</span><span>"match_parent"<br/></span><span>    </span><span>android</span><span>:layout_height=</span><span>"match_parent"<br/></span><span>    </span><span>android</span><span>:orientation=</span><span>"vertical"</span>&gt;<br/>  &lt;<span>Button<br/></span><span>       </span><span>android</span><span>:layout_width=</span><span>"70dp"<br/></span><span>       </span><span>android</span><span>:layout_height=</span><span>"40dp"<br/></span><span>       </span><span>android</span><span>:text=</span><span>"Click me"</span>/&gt;<br/>  &lt;<span>View<br/></span><span>       </span><span>android</span><span>:layout_width=</span><span>"70dp"<br/></span><span>       </span><span>android</span><span>:layout_height=</span><span>"0dp"<br/></span><span>       </span><span>android</span><span>:layout_weight=</span><span>"1"</span>/&gt;<br/>&lt;/<span>LinearLayout</span>&gt;</pre>
<p class="p1"><span class="s1">In the preceding code snippet, two child views are contained by a linear layout. The button explicitly sets both its dimensional constraints to <kbd>70dp</kbd> and <kbd>40dp</kbd>. The view, on the other hand, has its width explicitly set to <kbd>70dp</kbd> and has its height set to <kbd>0dp</kbd>. As a result of the presence of an&#160;<kbd>android:layout_weight</kbd> attribute set to <kbd>1</kbd>, &#160;the view's height is set to cover all remaining space in the parent view.</span></p>
<p class="p1"><span class="s1">Now that we understand fully what is going on in our layout, we can take a look at the layout design preview:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="images/057ee4c5-fa77-4f91-b564-96a0ef0fa8cd.jpg" style="width:31.83em;height:25.83em;"/></div>
<p class="p1"><span class="s1">We can see that something seems off. Unlike our sketch, our layout items are not centered but aligned to the right. We can solve this by using the <kbd>android:gravity</kbd> attribute in our linear layout view groups. In the following code snippet, we make use of the <kbd>android:gravity</kbd> attribute to center layout widgets within both linear layouts:</span></p>
<pre class="p1"><span class="s1">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/></span><span class="s1">&lt;android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>xmlns:app="http://schemas.android.com/apk/res-auto"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>xmlns:tools="http://schemas.android.com/tools"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>android:layout_height="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>tools:context="com.mydomain.tetris.MainActivity"&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;LinearLayout<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_height="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintBottom_toBottomOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintLeft_toLeftOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintRight_toRightOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>app:layout_constraintTop_toTopOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_marginTop="@dimen/layout_margin_top"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:layout_marginBottom="@dimen/layout_margin_bottom"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:orientation="vertical"<br/></span><span class="s1"><span class="Apple-converted-space">        </span>android:gravity="center"&gt; <br/>    &lt;!-- Aligns child elements to the centre of view group<span class="Apple-converted-space">  </span>--&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;TextView<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:text="TETRIS"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:textSize="80sp"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;TextView<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:id="@+id/tv_high_score"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:text="High score: 0"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:textSize="20sp"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:layout_marginTop="@dimen/layout_margin_top"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;LinearLayout<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_height="0dp"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_weight="1"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:orientation="vertical"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:gravity="center"&gt; <br/>      &lt;!-- Aligns child elements to the centre of view group<span class="Apple-converted-space">  </span>--&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;Button<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:id="@+id/btn_new_game"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:text="New game"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;Button<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:id="@+id/btn_reset_score"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:text="Reset score"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;Button<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:id="@+id/btn_exit"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:text="exit"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;/LinearLayout&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;/LinearLayout&gt;<br/></span><span class="s1">&lt;/android.support.constraint.ConstraintLayout&gt;</span></pre>
<p class="p1"><span class="s1">As a result of <kbd>android:gravity</kbd> being set to <kbd>center</kbd>, widgets are properly aligned as we would like. The effects of applying the <kbd>android:gravity</kbd> view groups to our layout view groups can be seen in the following screenshot:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="images/de72ca44-34bf-4185-9b8a-9e977acb4fa4.jpg" style="width:33.83em;height:27.58em;"/></div>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Defining string resources</h1>
                </header>
            
            <article>
                
<p class="p3"><span class="s1">Up till now, we have been passing hardcoded strings as values to element attributes that require text to be set. This is not best practice and generally should be avoided. Instead, string values should be added in a string resource file.</span></p>
<p class="p3"><span class="s1">The default file for string resources is <kbd>strings.xml</kbd> and this can be found in the <kbd>res</kbd> | <kbd>values</kbd> directory:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="images/3e6592a2-1b40-4883-ad52-ff6e9dd2e3c5.png" style="width:54.83em;height:34.25em;"/></div>
<p class="p1"><span class="s1">String values are added as string resources using the <kbd>&lt;string&gt;</kbd> XML tag. We need to add string resources for all string values we have used thus far. Add the following code to your string resource file:</span></p>
<pre class="p1"><span class="s1">&lt;resources&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;string name="app_name"&gt;Tetris&lt;/string&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;string name="high_score_default"&gt;High score: 0&lt;/string&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;string name="new_game"&gt;New game&lt;/string&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;string name="reset_score"&gt;Reset score&lt;/string&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;string name="exit"&gt;exit&lt;/string&gt;<br/></span><span class="s1">&lt;/resources&gt;</span></pre>
<p class="p1"><span class="s1">Now it is necessary to edit our <kbd>MainActivity</kbd> layout file to exploit these created resources. A string resource can be referenced with <kbd>@strings/</kbd> prefixing the string resource name. Consider the following code:</span></p>
<pre class="p1"><span class="s1">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/></span><span class="s1">&lt;android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>xmlns:app="http://schemas.android.com/apk/res-auto"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>xmlns:tools="http://schemas.android.com/tools"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>android:layout_height="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>tools:context="com.mydomain.tetris.MainActivity"&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;LinearLayout<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:layout_height="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>app:layout_constraintBottom_toBottomOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>app:layout_constraintLeft_toLeftOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>app:layout_constraintRight_toRightOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>app:layout_constraintTop_toTopOf="parent"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:layout_marginTop="@dimen/layout_margin_top"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:layout_marginBottom="@dimen/layout_margin_bottom"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:orientation="vertical"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:gravity="center"&gt; <br/>    &lt;!-- Aligns child elements to the centre of view group<span class="Apple-converted-space">  </span>--&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;TextView<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:text="@string/app_name"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:textAllCaps="true"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:textSize="80sp"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;TextView<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:id="@+id/tv_high_score"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:text="@string/high_score_default"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:textSize="20sp"<br/></span><span class="s1"><span class="Apple-converted-space">         </span>android:layout_marginTop="@dimen/layout_margin_top"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;LinearLayout<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_width="match_parent"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_height="0dp"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_weight="1"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:orientation="vertical"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:gravity="center"&gt; <br/>      &lt;!-- Aligns child elements to the centre of view group<span class="Apple-converted-space">  </span>--&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;Button<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:id="@+id/btn_new_game"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:text="@string/new_game"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;Button<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:id="@+id/btn_reset_score"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:text="@string/reset_score"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;Button<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:id="@+id/btn_exit"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_width="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:layout_height="wrap_content"<br/></span><span class="s1"><span class="Apple-converted-space">           </span>android:text="@string/exit"/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;/LinearLayout&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;/LinearLayout&gt;<br/></span><span class="s1">&lt;/android.support.constraint.ConstraintLayout&gt;</span></pre>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Handling input events</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">In the cycle of a user's interaction with an application, a means by which the user can provide some form of input for the execution of a process is by interacting with a widget. These inputs can be captured with events. In Android applications, events are captured from the specific view object that the user interacts with. The required structures and procedures necessary for input event handling are provided by the View class.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Event listeners</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">An event listener is a procedure in an application program that waits for a UI event to occur. There are many types of events that can be emitted within an application. Some common events are click events, touch events, long click events, and text change events.</span></p>
<p class="p1"><span class="s1">In order to capture a widget event and perform an action upon its occurrence, a listener for the event must be set to the view. This can be achieved by invoking a view's set. <kbd>Listener()</kbd> method and passing either a lambda or a reference to a function to the method invocation.</span></p>
<p class="p1"><span class="s1">The following example demonstrates the capturing of a click event done on a button. A lambda is passed to the <kbd>setOnClickListener</kbd> method of the view class:</span></p>
<pre class="p1"><span class="s1">val button: Button = findViewById&lt;Button&gt;(R.id.btn_send)<br/></span><span class="s1">button.setOnClickListener { <br/></span><span class="s1"><span class="Apple-tab-span">  </span>// actions to perform on click event<br/></span><span class="s1">}</span></pre>
<p class="p1"><span class="s1">A reference to a function can be passed in place of a lambda:</span></p>
<pre class="p1"><span class="s1">class MainActivity : AppCompatActivity() {<br/></span><span class="s1"><span class="Apple-converted-space">  </span>override fun onCreate(savedInstanceState: Bundle?) {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>super.onCreate(savedInstanceState)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>setContentView(R.layout.activity_main)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>val btnExit: Button = findViewById&lt;Button&gt;(R.id.btn_exit)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>btnExit.setOnClickListener(this::handleExitEvent)<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/></span><span class="s1"><span class="Apple-converted-space">  </span>fun handleExitEvent(view: View) {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>finish()<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/></span><span class="s1">}</span></pre>
<p class="p1"><span class="s1">Many listener setter methods are available in the view class. Some examples are:</span></p>
<ul>
<li class="li1"><span class="s1"><kbd>setOnClickListener()</kbd>: Sets a function to be invoked upon the click of a view</span></li>
<li class="li1"><span class="s1"><kbd>setOnContextClickListener()</kbd>: Sets a function to be invoked upon the context click of a view</span></li>
<li class="li1"><span class="s1"><kbd>setOnCreateContextMenuListener()</kbd>: Sets a function to be invoked upon the creation of a view's context menu</span></li>
<li class="li1"><span class="s1"><kbd>setOnDragListener()</kbd>: Sets a function to be invoked on the occurrence of a drag event on a view</span></li>
<li class="li1"><span class="s1"><kbd>setOnFocusChangeListener()</kbd>: Sets a function to be called on the focus change of a view</span></li>
<li class="li1"><span class="s1"><kbd>setOnHoverChangeListener()</kbd>: Sets a function to be called when a hover event occurs on a view</span></li>
<li class="li1"><span class="s1"><kbd>setOnLongClickListener()</kbd>: Sets a function to be invoked on the occurrence of a long click event on a view</span></li>
<li class="li1"><span class="s1"><kbd>setOnScrollChangeListener()</kbd>: Sets a function to be invoked when the scroll positions (X or Y) of a view change</span></li>
</ul>
<div class="packt_infobox"><span>An event listener is a procedure in an application program that waits for a UI event to occur.</span></div>
<div>
<p class="p1"><span class="s1">As we now have a good understanding of how to handle input events, we can go on to implement some logic in our <kbd>MainActivity</kbd>.</span></p>
<p class="p1"><span class="s1">The main activity screen contains an app bar. We need to hide this layout element as our view does not require it:</span></p>
</div>
<div class="CDPAlignCenter CDPAlign"><img src="images/2ed808ff-d61d-46e1-92b6-a53c7eb037cf.jpg" style="width:20.50em;height:5.92em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Appbar</div>
<p><span>An app bar is also referred to as an action bar. Action bars are instances of the <kbd>ActionBar</kbd> class.&#160;The instance of the action bar widget in a layout can be retrieved via the <kbd>supportActionBar</kbd> accessor variable. The following code retrieves the action bar, and hides it if a null reference is not returned:</span></p>
<div>
<pre class="p1"><span class="s1">package com.mydomain.tetris<br/></span><span class="s1">import android.support.v7.app.AppCompatActivity<br/></span><span class="s1">import android.os.Bundle<br/></span><span class="s1">import android.support.v7.app.ActionBar<br/></span><span class="s1">import android.view.View<br/></span><span class="s1">import android.widget.Button<br/><br/></span><span class="s1">class MainActivity : AppCompatActivity() {<br/></span><span class="s1"><span class="Apple-converted-space">  </span>override fun onCreate(savedInstanceState: Bundle?) {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>super.onCreate(savedInstanceState)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>setContentView(R.layout.activity_main)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>val appBar: ActionBar? = supportActionBar<br/><br/></span><span class="s1"><span class="Apple-converted-space">    </span>if (appBar != null) {<br/></span><span class="s1"><span class="Apple-converted-space">      </span>appBar.hide()<br/></span><span class="s1"><span class="Apple-converted-space">    </span>}<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/></span><span class="s1">}</span></pre>
<p class="p1"><span class="s1">Though the preceding code performs what is necessary, its length can be reduced considerably by exploiting Kotlin's type-safe system, which is as follows:</span></p>
<pre class="p1"><span class="s1">package com.mydomain.tetris<br/></span><span class="s1">import android.support.v7.app.AppCompatActivity<br/></span><span class="s1">import android.os.Bundle<br/></span><span class="s1">import android.view.View<br/></span><span class="s1">import android.widget.Button<br/><br/></span><span class="s1">class MainActivity : AppCompatActivity() {<br/></span><span class="s1"><span class="Apple-converted-space">  </span>override fun onCreate(savedInstanceState: Bundle?) {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>super.onCreate(savedInstanceState)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>setContentView(R.layout.activity_main)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>supportActionBar?.hide()<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/></span><span class="s1">}</span></pre>
<p class="p1"><span class="s1">If <kbd>supportActionBar</kbd> is not a null object reference, the <kbd>hide()</kbd> method will be invoked if nothing else happens. This will prevent the raising of a null pointer exception.</span></p>
</div>
<p class="p1"><span class="s1">We need to create object references for the widgets that exist in our layouts. This is necessary for many reasons, such as listener registration. Object references of a view can be retrieved by passing the resource ID of the view to <kbd>findViewById()</kbd>. We add object references to <kbd>MainActivity</kbd>&#160;(existing in the <kbd>MainActivity.kt</kbd> file) in the following code snippet:</span></p>
<pre class="p1"><span class="s1">package com.mydomain.tetris<br/></span><span class="s1">import android.support.v7.app.AppCompatActivity<br/></span><span class="s1">import android.os.Bundle<br/></span><span class="s1">import android.view.View<br/></span><span class="s1">import android.widget.Button<br/></span><span class="s1">import android.widget.TextView<br/><br/></span><span class="s1">class MainActivity : AppCompatActivity() {<br/><br/>  var tvHighScore: TextView? = null<br/><br/></span><span class="s1"><span class="Apple-converted-space">  </span>override fun onCreate(savedInstanceState: Bundle?) {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>super.onCreate(savedInstanceState)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>setContentView(R.layout.activity_main)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>supportActionBar?.hide()<br/><br/></span><span class="s1"><span class="Apple-converted-space">    </span>val btnNewGame = findViewById&lt;Button&gt;(R.id.btn_new_game)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>val btnResetScore = findViewById&lt;Button&gt;(R.id.btn_reset_score)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>val btnExit = findViewById&lt;Button&gt;(R.id.btn_exit)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>tvHighScore = findViewById&lt;TextView&gt;(R.id.tv_high_score)<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/></span><span class="s1">}</span></pre>
<p class="p1"><span class="s1">Now that we have object references to our user interface elements in place, we need to handle some of their events. We must set click listeners for all buttons in the layout (there's no point having a button that does nothing when clicked, after all).</span></p>
<p class="p1"><span class="s1">As we stated earlier on, the <span><span class="packt_screen">New Game</span></span>&#160;button has the sole task of navigating the user to the game activity (where game play takes place). In order to do this, we will need to utilize an explicit intent. Add a private function containing the logic to be executed on the click of the <span class="packt_screen">New Game</span> button to <kbd>MainActivity</kbd>&#160;(in the <kbd>MainActivity.kt</kbd> file) and set a reference to the function via&#160;<kbd>setOnClickListener()</kbd> invocation:</span></p>
<pre class="p1"><span class="s1">package com.mydomain.tetris<br/></span><span class="s1">import android.support.v7.app.AppCompatActivity<br/></span><span class="s1">import android.os.Bundle<br/></span><span class="s1">import android.view.View<br/></span><span class="s1">import android.widget.Button<br/></span><span class="s1">import android.widget.TextView<br/><br/></span><span class="s1">class MainActivity : AppCompatActivity() {<br/><br/>  var tvHighScore: TextView? = null<br/><br/></span><span class="s1"><span class="Apple-converted-space">  </span>override fun onCreate(savedInstanceState: Bundle?) {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>super.onCreate(savedInstanceState)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>setContentView(R.layout.activity_main)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>supportActionBar?.hide()<br/></span><span class="s1"><span class="Apple-converted-space">    </span>val btnNewGame = findViewById&lt;Button&gt;(R.id.btn_new_game)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>val btnResetScore = findViewById&lt;Button&gt;(R.id.btn_reset_score)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>val btnExit = findViewById&lt;Button&gt;(R.id.btn_exit)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>tvHighScore = findViewById&lt;TextView&gt;(R.id.tv_high_score)<br/><br/></span><span class="s1"><span class="Apple-converted-space">    </span>btnNewGame.setOnClickListener(this::onBtnNewGameClick)<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/><br/></span><span class="s1"><span class="Apple-converted-space">  </span>private fun onBtnNewGameClick(view: View) {</span><span class="s1"><span class="Apple-converted-space">    </span>}<br/></span><span class="s1">}</span></pre>
<p class="p1"><span class="s1">Create a new empty activity and name it <kbd>GameActivity</kbd>. Once the activity is created, we can utilize an intent to launch the activity on the click of the <span><span class="packt_screen">New Game</span></span> button, as shown in the following code:</span></p>
<pre class="p1"><span class="s1">private fun onBtnNewGameClick(view: View) {<br/></span><span class="s1"><span class="Apple-converted-space">  </span>val intent = Intent(this, GameActivity::class.java)<br/></span><span class="s1"><span class="Apple-converted-space">  </span>startActivity(intent)<br/></span><span class="s1">}</span></pre>
<p class="p1"><span class="s1">The first line of the function body creates a new instance of the Intent class and passes the current context and the required activity class to the constructor. Notice we passed <kbd>this</kbd>&#160;as the first argument to the constructor. The <kbd>this</kbd> keyword is used to refer to the current instance in which <kbd>this</kbd>&#160;is called. Hence, we are actually passing the current activity (<kbd>MainActivity</kbd>) as the first argument to the constructor.<span class="Apple-converted-space">&#160;</span>&#160;At this point, you might be asking why we are passing an activity as the first argument of the <kbd>Intent</kbd> constructor when it requires a context as its first argument. This is because all activities are extensions of the&#160;<kbd>Context</kbd>&#160;abstract class. Hence, all activities are in their own rights contexts.</span></p>
<p class="p1"><span class="s1">The <kbd>startActivity()</kbd> method is called to launch an activity from which no result is expected. When an intent is passed as its only argument, it starts an activity from which it expects no result. Go ahead and run the application to observe the effect of the button click.</span></p>
<div class="packt_infobox"><kbd>Context</kbd> is an abstract class in the Android application framework. The implementation of a context is provided by the Android system.&#160;<kbd>Context</kbd>&#160;allows access to application-specific resources. <kbd>Context</kbd> also allows access to calls for application-level operations such as launching activities, sending broadcasts, and receiving intents.</div>
<p class="p1"><span class="s1">Now let's implement the following functions for the clicks of the <span class="packt_screen">EXIT</span> and <span class="packt_screen">RESET SCORE</span> buttons:</span></p>
<pre class="p1"><span class="s1">package com.mydomain.tetris<br/></span><span class="s1">import android.content.Intent<br/></span><span class="s1">import android.support.v7.app.AppCompatActivity<br/></span><span class="s1">import android.os.Bundle<br/></span><span class="s1">import android.view.View<br/></span><span class="s1">import android.widget.Button<br/></span><span class="s1">import android.widget.TextView<br/><br/></span><span class="s1">class MainActivity : AppCompatActivity() {<br/><br/>  var tvHighScore: TextView? = null<br/><br/></span><span class="s1"><span class="Apple-converted-space">  </span>override fun onCreate(savedInstanceState: Bundle?) {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>super.onCreate(savedInstanceState)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>setContentView(R.layout.activity_main)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>supportActionBar?.hide()<br/></span><span class="s1"><span class="Apple-converted-space"><br/>    </span>val btnNewGame = findViewById&lt;Button&gt;(R.id.btn_new_game)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>val btnResetScore = findViewById&lt;Button&gt;(R.id.btn_reset_score)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>val btnExit = findViewById&lt;Button&gt;(R.id.btn_exit)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>tvHighScore = findViewById&lt;TextView&gt;(R.id.tv_high_score)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>btnNewGame.setOnClickListener(this::onBtnNewGameClick)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>btnResetScore.setOnClickListener(this::onBtnResetScoreClick)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>btnExit.setOnClickListener(this::onBtnExitClick)<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/><br/></span><span class="s1"><span class="Apple-converted-space">  </span>private fun onBtnNewGameClick(view: View) {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>val intent = Intent(this, GameActivity::class.java)<br/></span><span class="s1"><span class="Apple-converted-space">    </span>startActivity(intent)<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/><br/></span><span class="s1"><span class="Apple-converted-space">  </span>private fun onBtnResetScoreClick(view: View) {}<br/><br/></span><span class="s1"><span class="Apple-converted-space">  </span>private fun onBtnExitClick(view: View) {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>System.exit(0)<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/></span><span class="s1">}</span></pre>
<p class="p1"><span class="s1">The call to <kbd>System.exit()</kbd> in the <kbd>onBtnExitClick</kbd> function stops further execution of the program and exits it when the&#160;<kbd>0</kbd> integer is passed as its argument. The last thing we need to do concerning handling click events is to implement the logic to perform the reset of high scores. To do this, we need to implement some logic for data storage first to store the high score. We will do this using <kbd>SharedPreferences</kbd>.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Working with SharedPreferences</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1"><kbd>SharedPreferences</kbd> is an interface for storing, accessing, and modifying data. The <kbd>SharedPreferences</kbd> APIs enable data storage in sets of key-value pairs.</span></p>
<p class="p1"><span class="s1">We will set up a simple utility to handle our data storage needs for this app utilizing the <kbd>SharedPreferences</kbd> interface. Create a package in the project's source directory with the name <kbd>storage</kbd> (right-click the source directory and select <span class="packt_screen">New</span> | <span class="packt_screen">Package</span>):</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="images/d2132e50-d9a0-46cf-b802-4643842164c7.png" style="width:53.83em;height:33.67em;"/></div>
<p class="p1"><span class="s1">Next, create a new Kotlin class named <kbd>AppPreferences</kbd> within the <kbd>storage</kbd> package. Type the following code into the class file:</span></p>
<pre class="p1"><span class="s1">package com.mydomain.tetris.storage<br/></span><span class="s1">import android.content.Context<br/></span><span class="s1">import android.content.SharedPreferences<br/><br/></span><span class="s1">class AppPreferences(ctx: Context) {<br/><br/></span><span class="s1"><span class="Apple-converted-space">  </span>var data: SharedPreferences = ctx.getSharedPreferences<br/>                                ("APP_PREFERENCES", Context.MODE_PRIVATE)<br/><br/></span><span class="s1"><span class="Apple-converted-space">  </span>fun saveHighScore(highScore: Int) {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>data.edit().putInt("HIGH_SCORE", highScore).apply()<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/><br/></span><span class="s1"><span class="Apple-converted-space">  </span>fun getHighScore(): Int {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>return data.getInt("HIGH_SCORE", 0)<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/><br/></span><span class="s1"><span class="Apple-converted-space">  </span>fun clearHighScore() {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>data.edit().putInt("HIGH_SCORE", 0).apply()<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/></span><span class="s1">}</span></pre>
<p class="p1"><span class="s1">In the preceding code snippet, a <kbd>Context</kbd> is required to be passed to the class' constructor upon creation of an instance of the class. Context provides access to the <kbd>getSharedPreferences()</kbd> method, which retrieves a specified preference file. The preference file is identified by the name in the string passed as the <kbd>getSharedPreferences()</kbd> method's first argument.</span></p>
<p class="p1"><span class="s1">The <kbd>saveHighScore()</kbd> function takes an integer – the high score to be saved – as its only argument. <kbd>data.edit()</kbd> returns an <kbd>Editor</kbd> object that permits the modification of a preference file. The editor's <kbd>putInt()</kbd> method is called in order to store an integer within the preference file. The first argument passed to <kbd>putInt()</kbd> is a string representing the key that will be used to access the stored value. The second argument to the method is the integer to be stored – in this case, the high score.</span></p>
<p class="p1"><span class="s1"><kbd>getHighScore()</kbd> returns the high score by calling <kbd>data.getInt()</kbd>. <kbd>getInt()</kbd> is a function implemented by <kbd>SharedPreferences</kbd> that provides read access to a stored integer value. <kbd>HIGH_SCORE</kbd> is the unique identifier of the value to be retrieved. The <kbd>0</kbd> passed to the function's second argument specifies a default value to be returned in the scenario that no value corresponding to the specified key exists.</span></p>
<p class="p1"><span class="s1"><kbd>clearHighScore()</kbd> resets the high score to zero by simply overwriting the value corresponding to the <kbd>HIGH_SCORE</kbd> key with <kbd>0</kbd>.</span></p>
<p class="p1"><span class="s1">Now that we have our <kbd>AppPreferences</kbd> utility class in place, we can finish up the <kbd>onBtnResetScoreClick()</kbd> function in <kbd>MainActivity</kbd>:</span></p>
<pre class="p1"><span class="s1">private fun onBtnResetScoreClick(view: View) {<br/></span><span class="s1"><span class="Apple-converted-space">  </span>val preferences = AppPreferences(this)<br/></span><span class="s1"><span class="Apple-converted-space">  </span>preferences.clearHighScore()<br/></span><span class="s1">}</span></pre>
<p class="p1"><span class="s1">Now when the high score reset button is clicked, the high score is reset to zero. You'll want to give the user some sort of feedback when such actions occur. We can utilize a <kbd>Snackbar</kbd> to provide this user feedback.</span></p>
<p class="p1"><span class="s1">In order to use the <kbd>Snackbar</kbd> class within an Android application, the Android design support library dependency must be added to the module-level Gradle build script. Do this by adding the following line of code under the dependencies closure of <kbd>build.gradle</kbd>:</span></p>
<pre class="p1"><span class="s1">implementation 'com.android.support:design:26.1.0'</span></pre>
<p class="p1"><span class="s1">After you have added the line, your module-level <kbd>build.gradle</kbd> script should look similar to the following:</span></p>
<pre class="p1"><span class="s1">apply plugin: 'com.android.application'<br/></span><span class="s1">apply plugin: 'kotlin-android'<br/></span><span class="s1">apply plugin: 'kotlin-android-extensions'<br/><br/></span><span class="s1">android {<br/></span><span class="s1"><span class="Apple-converted-space">  </span>compileSdkVersion 26<br/></span><span class="s1"><span class="Apple-converted-space">  </span>buildToolsVersion "26.0.1"<br/></span><span class="s1"><span class="Apple-converted-space">  </span>defaultConfig {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>applicationId "com.mydomain.tetris"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>minSdkVersion 15<br/></span><span class="s1"><span class="Apple-converted-space">    </span>targetSdkVersion 26<br/></span><span class="s1"><span class="Apple-converted-space">    </span>versionCode 1<br/></span><span class="s1"><span class="Apple-converted-space">    </span>versionName "1.0"<br/></span><span class="s1"><span class="Apple-converted-space">    </span>testInstrumentationRunner "android.support.test.runner<br/>                               .AndroidJUnitRunner"<br/></span><span class="s1">  }<br/></span><span class="s1"> <span class="Apple-converted-space"> </span>buildTypes {<br/></span><span class="s1"><span class="Apple-converted-space">    </span>release {<br/></span><span class="s1"><span class="Apple-converted-space">      </span>minifyEnabled false<br/></span><span class="s1"><span class="Apple-converted-space">      </span>proguardFiles getDefaultProguardFile('proguard-android.txt'),<br/>                    'proguard-rules.pro'<br/></span><span class="s1"><span class="Apple-converted-space">    </span>}<br/></span><span class="s1"><span class="Apple-converted-space">  </span>}<br/></span><span class="s1">}<br/><br/></span><span class="s1">dependencies {<br/></span><span class="s1"><span class="Apple-converted-space">  </span>implementation fileTree(dir: 'libs', include: ['*.jar'])<br/></span><span class="s1"><span class="Apple-converted-space">  </span>implementation "org.jetbrains.kotlin:<br/>                  kotlin-stdlib-jre7:$kotlin_version"<br/></span><span class="s1"><span class="Apple-converted-space">  </span>implementation 'com.android.support:appcompat-v7:26.1.0'<br/></span><span class="s1"><span class="Apple-converted-space">  </span>implementation 'com.android.support.constraint:<br/>                  constraint-layout:1.0.2'<br/></span><span class="s1"><span class="Apple-converted-space">  </span>testImplementation 'junit:junit:4.12'<br/></span><span class="s1"><span class="Apple-converted-space">  </span>androidTestImplementation 'com.android.support.test:runner:1.0.1'<br/></span><span class="s1"><span class="Apple-converted-space">  </span>androidTestImplementation 'com.android.support.test.espresso:espresso-core:3.0.1'<br/></span><span class="s1"><span class="Apple-converted-space">  </span>implementation 'com.android.support:design:26.1.0' <br/>  // adding android design support library<br/></span><span class="s1">}</span></pre>
<p class="p1"><span class="s1">After making the alterations, sync your project by clicking <span class="packt_screen">Sync Now</span> on the flash message that appears within the editor window, as shown in the following screenshot:</span></p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="images/bb1ca54d-53b2-4534-9973-b61efe103f00.jpg"/></div>
<p>Without further ado, let's modify our <kbd>onBtnResetClick()</kbd> to provide user feedback in the form of a&#160;<kbd><span>Snackbar</span></kbd>&#160;after a score reset has been performed by using the following code:</p>
<pre><span>private fun </span>onBtnResetScoreClick(view: View) {<br/>  <span>val </span>preferences = AppPreferences(<span>this</span>)<br/>  preferences.clearHighScore()<br/>  Snackbar.make(view, <span>"Score successfully reset"</span>,<br/>                Snackbar.<span>LENGTH_SHORT</span>).show()<br/>}</pre>
<p>Clicking on <span class="packt_screen">RESET SCORE</span> successfully resets the high score of the player as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="images/879f5463-2612-4e88-a174-5204c5e9092e.jpg" style="width:14.42em;height:25.92em;"/></div>
<p class="p1"><span class="s1">Before moving further, you'll want to update the text displayed in the high score text view of the&#160;<kbd>MainActivity</kbd> layout to reflect the reset score. This can be done by changing the text contained in the text view as follows:</span></p>
<pre><span>private fun </span>onBtnResetScoreClick(view: View) {<br/>  <span>val </span>preferences = AppPreferences(<span>this</span>)<br/>  preferences.clearHighScore()<br/>  Snackbar.make(view, <span>"Score successfully reset"</span>,<br/>                Snackbar.<span>LENGTH_SHORT</span>).show()<br/>  <span>tvHighScore</span>?.<span>text </span>= <span>"High score: </span><span>${</span>preferences.getHighScore()<span>}</span><span>"<br/></span>}</pre>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Implementing the game activity layout</h1>
                </header>
            
            <article>
                
<p>So far, we have successfully created the layout for main activity. Before we conclude this chapter, it is imperative we create the layout for <kbd>GameActivity</kbd> as well. Go ahead and open <kbd>activity_game.xml</kbd> and add the following code to it:</p>
<pre><span>&lt;?</span><span>xml version=</span><span>"1.0" </span><span>encoding=</span><span>"utf-8"</span><span>?&gt;<br/></span>&lt;<span>android.support.constraint.ConstraintLayout </span><span>xmlns:</span><span>android</span><span>=</span><span>"http://schemas.android.com/apk/res/android"<br/></span><span>    </span><span>xmlns:</span><span>app</span><span>=</span><span>"http://schemas.android.com/apk/res-auto"<br/></span><span>    </span><span>xmlns:</span><span>tools</span><span>=</span><span>"http://schemas.android.com/tools"<br/></span><span>    </span><span>android</span><span>:layout_width=</span><span>"match_parent"<br/></span><span>    </span><span>android</span><span>:layout_height=</span><span>"match_parent"<br/></span><span>    </span><span>tools</span><span>:context=</span><span>"com.mydomain.tetris.GameActivity"</span>&gt;<br/>  &lt;<span>LinearLayout<br/></span><span>         </span><span>android</span><span>:layout_width=</span><span>"match_parent"<br/></span><span>         </span><span>android</span><span>:layout_height=</span><span>"match_parent"<br/></span><span>         </span><span>android</span><span>:orientation=</span><span>"horizontal"<br/></span><span>         </span><span>android</span><span>:weightSum=</span><span>"10"<br/></span><span>         </span><span>android</span><span>:background=</span><span>"#e8e8e8"</span>&gt;<br/>    &lt;<span>LinearLayout<br/></span><span>           </span><span>android</span><span>:layout_width=</span><span>"wrap_content"<br/></span><span>           </span><span>android</span><span>:layout_height=</span><span>"match_parent"<br/></span><span>           </span><span>android</span><span>:orientation=</span><span>"vertical"<br/></span><span>           </span><span>android</span><span>:gravity=</span><span>"center"<br/></span><span>           </span><span>android</span><span>:paddingTop=</span><span>"32dp"<br/></span><span>           </span><span>android</span><span>:paddingBottom=</span><span>"32dp"<br/></span><span>           </span><span>android</span><span>:layout_weight=</span><span>"1"</span>&gt;<br/>      &lt;<span>LinearLayout<br/></span><span>             </span><span>android</span><span>:layout_width=</span><span>"wrap_content"<br/></span><span>             </span><span>android</span><span>:layout_height=</span><span>"0dp"<br/></span><span>             </span><span>android</span><span>:layout_weight=</span><span>"1"<br/></span><span>             </span><span>android</span><span>:orientation=</span><span>"vertical"<br/></span><span>             </span><span>android</span><span>:gravity=</span><span>"center"</span>&gt;<br/>        &lt;<span>TextView<br/></span><span>             </span><span>android</span><span>:layout_width=</span><span>"wrap_content"<br/></span><span>             </span><span>android</span><span>:layout_height=</span><span>"wrap_content"<br/></span><span>             </span><span>android</span><span>:text=</span><span>"@string/current_score"<br/></span><span>             </span><span>android</span><span>:textAllCaps=</span><span>"true"<br/></span><span>             </span><span>android</span><span>:textStyle=</span><span>"bold"<br/></span><span>             </span><span>android</span><span>:textSize=</span><span>"14sp"</span>/&gt;<br/>        &lt;<span>TextView<br/></span><span>             </span><span>android</span><span>:id=</span><span>"@+id/tv_current_score"<br/></span><span>             </span><span>android</span><span>:layout_width=</span><span>"wrap_content"<br/></span><span>             </span><span>android</span><span>:layout_height=</span><span>"wrap_content"<br/></span><span>             </span><span>android</span><span>:textSize=</span><span>"18sp"</span>/&gt;<br/>        &lt;<span>TextView<br/></span><span>             </span><span>android</span><span>:layout_width=</span><span>"wrap_content"<br/></span><span>             </span><span>android</span><span>:layout_height=</span><span>"wrap_content"<br/></span><span>             </span><span>android</span><span>:layout_marginTop=</span><span>"@dimen/layout_margin_top"<br/></span><span>             </span><span>android</span><span>:text=</span><span>"@string/high_score"<br/></span><span>             </span><span>android</span><span>:textAllCaps=</span><span>"true"<br/></span><span>             </span><span>android</span><span>:textStyle=</span><span>"bold"<br/></span><span>             </span><span>android</span><span>:textSize=</span><span>"14sp"</span>/&gt;<br/>        &lt;<span>TextView<br/></span><span>             </span><span>android</span><span>:id=</span><span>"@+id/tv_high_score"<br/></span><span>             </span><span>android</span><span>:layout_width=</span><span>"wrap_content"<br/></span><span>             </span><span>android</span><span>:layout_height=</span><span>"wrap_content"<br/></span><span>             </span><span>android</span><span>:textSize=</span><span>"18sp"</span>/&gt;<br/>      &lt;/<span>LinearLayout</span>&gt;<br/>      &lt;<span>Button<br/></span><span>             </span><span>android</span><span>:id=</span><span>"@+id/btn_restart"<br/></span><span>             </span><span>android</span><span>:layout_width=</span><span>"wrap_content"<br/></span><span>             </span><span>android</span><span>:layout_height=</span><span>"wrap_content"<br/></span><span>             </span><span>android</span><span>:text=</span><span>"@string/btn_restart"</span>/&gt;<br/>    &lt;/<span>LinearLayout</span>&gt;<br/>    &lt;<span>View<br/></span><span>          </span><span>android</span><span>:layout_width=</span><span>"1dp"<br/></span><span>          </span><span>android</span><span>:layout_height=</span><span>"match_parent"<br/></span><span>          </span><span>android</span><span>:background=</span><span>"#000"</span>/&gt;<br/>    &lt;<span>LinearLayout<br/></span><span>           </span><span>android</span><span>:layout_width=</span><span>"0dp"<br/></span><span>           </span><span>android</span><span>:layout_height=</span><span>"match_parent"<br/></span><span>           </span><span>android</span><span>:layout_weight=</span><span>"9"</span>&gt;<br/><br/>    &lt;/<span>LinearLayout</span>&gt;<br/>  &lt;/<span>LinearLayout</span>&gt;<br/>&lt;/<span>android.support.constraint.ConstraintLayout</span>&gt;</pre>
<p>Most view attributes used in this layout have already previously been used and as such do not need further explanation. The only exceptions are the <kbd>android:background</kbd> and <kbd>android:layout_weightSum</kbd> attributes.</p>
<p>The&#160;<kbd>android:background</kbd>&#160;attribute is used to set the background color of a view or view group. <kbd>#e8e8e8</kbd> and <kbd>#000</kbd> were passed as values in the two instances where&#160;<kbd>android:background</kbd> is used in the layout. <kbd>#e8e8e8</kbd> is the hex color code for gray and <kbd>#000</kbd> the hex code for black.&#160;</p>
<p><kbd>android:layout_weightSum</kbd>&#160;defines the maximum weight sum in a view group and is calculated as the sum of the <kbd>layout_weight</kbd> values of all child views in a view group. The first linear layout in <kbd>activity_game.xml</kbd> declares the weight sum of all child views to be <kbd>10</kbd>. As such, the immediate children of the linear layout have layout weights of <kbd>1</kbd> and <kbd>9</kbd>, respectively.</p>
<p>We&#160;made use of three string resources&#160;that we have not previously added to our string resources file. Go ahead and add the following string resources to <kbd>strings.xml</kbd>:</p>
<pre>&lt;<span>string </span><span>name=</span><span>"high_score"</span>&gt;High score&lt;/<span>string</span>&gt;<br/>&lt;<span>string </span><span>name=</span><span>"current_score"</span>&gt;Current score&lt;/<span>string</span>&gt;<br/>&lt;<span>string </span><span>name=</span><span>"btn_restart"</span>&gt;Restart&lt;/<span>string</span>&gt;</pre>
<p>Finally, we have to add some simple logic to game activity for the population of the high score and current score text views, as follows:</p>
<pre><span>package </span>com.mydomain.tetris<br/><br/><span>import </span>android.os.Bundle<br/><span>import </span>android.support.v7.app.AppCompatActivity<br/><span>import </span>android.widget.Button<br/><span>import </span>android.widget.TextView<br/><span>import </span>com.mydomain.tetris.storage.AppPreferences<br/><br/><span>class </span>GameActivity: AppCompatActivity() {<br/><br/>  <span>var </span><span>tvHighScore</span>: TextView? = <span>null<br/></span><span>  var </span><span>tvCurrentScore</span>: TextView? = <span>null<br/></span><span>  var </span><span>appPreferences</span>: AppPreferences? = <span>null<br/></span><span><br/></span><span>  public override fun </span>onCreate(savedInstanceState: Bundle?) {<br/>    <span>super</span>.onCreate(savedInstanceState)<br/>    setContentView(R.layout.<span>activity_game</span>)<br/>    <span>appPreferences </span>= AppPreferences(<span>this</span>)<br/><br/>    <span>val </span>btnRestart = findViewById&lt;Button&gt;(R.id.<span>btn_restart</span>)<br/>    <span>tvHighScore </span>= findViewById&lt;TextView&gt;(R.id.<span>tv_high_score</span>)<br/>    <span>tvCurrentScore </span>= findViewById&lt;TextView&gt;(R.id.<span>tv_current_score</span>)<br/><br/>    updateHighScore()<br/>    updateCurrentScore()<br/>  }<br/><br/>  <span>private fun </span>updateHighScore() {<br/>    <span>tvHighScore</span>?.<span>text </span>= <span>"</span><span>${</span><span>appPreferences</span>?.getHighScore()<span>}</span><span>"<br/></span><span>  </span>}<br/><br/>  <span>private fun </span>updateCurrentScore() {<br/>    <span>tvCurrentScore</span>?.<span>text </span>= <span>"0"<br/></span><span>  </span>}<br/>}</pre>
<p>In the preceding code snippet, object references to layout view elements are created. In addition, we declare the <kbd>updateHighScore()</kbd> and <kbd>updateCurrentScore()</kbd> functions. These two functions are invoked on the creation of the view. They set the default scores displayed in the current score and high score text views declared in the layout file.</p>
<p>Save the changes made to the project and build and run the application. Click on the <span class="packt_screen">New Game</span>&#160;button once the application starts to view the layout we just created:</p>
<div class="CDPAlignCenter CDPAlign"><img src="images/7e0507ef-a29d-4ca8-b038-8f7bf5e0280e.jpg" style="width:14.00em;height:25.17em;"/></div>
<p>The right-hand side of the layout that contains no content is the area in which the Tetris game play will happen. We will implement this in chapter 3: Implementing Tetris Logic and Functionality. <span class="s1">The final thing we must understand before moving to the next chapter is the app manifest.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">The app manifest</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">The app manifest is an XML file that is present in every Android application. It is located in the manifests of an application's root folder. The <kbd>manifest</kbd> file holds crucial information pertaining to an application on the Android operating system. The information contained in an application's <kbd>androidManifest.xml</kbd> must be read by the Android system before an application can be run. Some of the information that must be registered in the app manifest are:</span></p>
<ul>
<li class="li1"><span class="s1">The Java package name for the application</span></li>
<li class="li1"><span class="s1">The activities present in the application</span></li>
<li class="li1"><span class="s1">Services that are used in the application</span></li>
<li class="li1"><span class="s1">Intent filters that direct implicit intents to an activity</span></li>
<li class="li1"><span class="s1">Descriptions of the broadcast receivers used in the application</span></li>
<li class="li1"><span class="s1">Data pertaining to content providers present in the application</span></li>
<li class="li1"><span class="s1">The classes that implement the various application components</span></li>
<li class="li1"><span class="s1">The permissions that are required by an application</span></li>
</ul>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Structure of the app manifest file</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">The general structure of the <kbd>androidManifest.xml</kbd> file is shown in the following code snippet. The snippet contains all possible elements and declarations that can exist in the <kbd>manifest</kbd> file:</span></p>
<pre class="p1"><span class="s1">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/></span><span class="s1">&lt;manifest&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;uses-permission /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;permission /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;permission-tree /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;permission-group /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;instrumentation /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;uses-sdk /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;uses-configuration /&gt; <br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;uses-feature /&gt; <br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;supports-screens /&gt; <br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;compatible-screens /&gt; <br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;supports-gl-texture /&gt; <br/><br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;application&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;activity&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;intent-filter&gt;<br/></span><span class="s1"><span class="Apple-converted-space">        </span>&lt;action /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">        </span>&lt;category /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">        </span>&lt;data /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;/intent-filter&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;meta-data /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;/activity&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;activity-alias&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;intent-filter&gt; <br/></span><span class="s1"><span class="Apple-converted-space">        </span>. . . <br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;/intent-filter&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;meta-data /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;/activity-alias&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;service&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;intent-filter&gt; <br/></span><span class="s1"><span class="Apple-converted-space">        </span>. . .<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;/intent-filter&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;meta-data/&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;/service&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;receiver&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;intent-filter&gt; . . . &lt;/intent-filter&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;meta-data /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;/receiver&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;provider&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;grant-uri-permission /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;meta-data /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;path-permission /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;/provider&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;uses-library /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;/application&gt;<br/></span><span class="s1">&lt;/manifest&gt;</span></pre>
<p>As can be seen from the preceding code snippet, a vast array of elements can appear in the <kbd>manifest</kbd> file. Many of these elements will be covered in this book. As a matter of fact, a number of these manifest elements have already been used in our Tetris application. Go ahead and open the <kbd>androidManifest.xml</kbd> file of Tetris. The contents of the file should be similar to what is contained in the following code snippet:</p>
<pre><span>&lt;?</span><span>xml version=</span><span>"1.0" </span><span>encoding=</span><span>"utf-8"</span><span>?&gt;<br/></span>&lt;<span>manifest </span><span>xmlns:</span><span>android</span><span>=</span><span>"http://schemas.android.com/apk/res/android"<br/></span><span>    </span><span>package=</span><span>"com.mydomain.tetris"</span>&gt;<br/><br/>  &lt;<span>application<br/></span><span>      </span><span>android</span><span>:allowBackup=</span><span>"true"<br/></span><span>      </span><span>android</span><span>:icon=</span><span>"@mipmap/ic_launcher"<br/></span><span>      </span><span>android</span><span>:label=</span><span>"@string/app_name"<br/></span><span>      </span><span>android</span><span>:roundIcon=</span><span>"@mipmap/ic_launcher_round"<br/></span><span>      </span><span>android</span><span>:supportsRtl=</span><span>"true"<br/></span><span>      </span><span>android</span><span>:theme=</span><span>"@style/AppTheme"</span>&gt;<br/>    &lt;<span>activity </span><span>android</span><span>:name=</span><span>".MainActivity"</span>&gt;<br/>      &lt;<span>intent-filter</span>&gt;<br/>        &lt;<span>action </span><span>android</span><span>:name=</span><span>"android.intent.action.MAIN" </span>/&gt;<br/>        &lt;<span>category </span><span>android</span><span>:name=</span><span>"android.intent.category.LAUNCHER" </span>/&gt;<br/>      &lt;/<span>intent-filter</span>&gt;<br/>    &lt;/<span>activity</span>&gt;<br/>    &lt;<span>activity </span><span>android</span><span>:name=</span><span>".GameActivity" </span>/&gt;<br/>  &lt;/<span>application</span>&gt;<br/><br/>&lt;/<span>manifest</span>&gt;</pre>
<p>The elements used in the preceding <kbd>manifest</kbd> file – in alphabetical order – are as follows:</p>
<ul>
<li><kbd>&lt;action&gt;</kbd></li>
<li><kbd>&lt;activity&gt;</kbd></li>
<li><kbd>&lt;application&gt;</kbd></li>
<li><kbd>&lt;category&gt;</kbd></li>
<li><kbd>&lt;intent-filter&gt;</kbd></li>
<li><kbd>&lt;manifest&gt;</kbd></li>
</ul>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">&lt;action&gt;</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">This is used to add an action to an intent filter. The <kbd>&lt;action&gt;</kbd> element is always a child element to an <kbd>&lt;intent-filter&gt;</kbd> element. An intent filter should contain one or more of these elements. If no action element is declared for an intent filter, the filter accepts no <kbd>Intent</kbd> objects. Its syntax is as follows:</span></p>
<pre class="p1"><span class="s1">&lt;action name=""/&gt;</span></pre>
<p class="p1"><span class="s1">The preceding&#160;<kbd>name</kbd>&#160;attribute is an attribute that specifies the name of the action being handled.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">&lt;activity&gt;</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">This element declares an activity existing in an application. All activities must be declared in the app manifest in order to be seen by the Android system. <kbd>&lt;activity&gt;</kbd> is always placed within a parent <kbd>&lt;application&gt;</kbd> element. The following code snippet shows the declaration of an activity within a manifest file using the <kbd>&lt;activity&gt;</kbd> element:</span></p>
<pre class="p1"><span class="s1">&lt;activity android:name=".GameActivity" /&gt;</span></pre>
<p class="p1"><span class="s1">The <kbd>name</kbd>&#160;attribute in the preceding code snippet is an attribute that specifies the name of the class that implements the activity being declared.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">&lt;application&gt;</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">This element is the declaration of the application. It contains subelements that declare the components existing in the application. The following code demonstrates the use of <kbd>&lt;application&gt;</kbd>:</span></p>
<pre class="p1"><span class="s1">&lt;application<br/></span><span class="s1"><span class="Apple-converted-space">      </span>android:allowBackup="true"<br/></span><span class="s1"><span class="Apple-converted-space">      </span>android:icon="@mipmap/ic_launcher"<br/></span><span class="s1"><span class="Apple-converted-space">      </span>android:label="@string/app_name"<br/></span><span class="s1"><span class="Apple-converted-space">      </span>android:roundIcon="@mipmap/ic_launcher_round"<br/></span><span class="s1"><span class="Apple-converted-space">      </span>android:supportsRtl="true"<br/></span><span class="s1"><span class="Apple-converted-space">      </span>android:theme="@style/AppTheme"&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;activity android:name=".MainActivity"&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;intent-filter&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;action android:name="android.intent.action.MAIN" /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">      </span>&lt;category android:name="android.intent.category.LAUNCHER" /&gt;<br/></span><span class="s1"><span class="Apple-converted-space">    </span>&lt;/intent-filter&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;/activity&gt;<br/></span><span class="s1"><span class="Apple-converted-space">  </span>&lt;activity android:name=".GameActivity" /&gt;<br/></span><span class="s1">&lt;/application&gt;</span></pre>
<p class="p1"><span class="s1">The <kbd>&lt;application&gt;</kbd> element in the preceding snippet makes use of four attributes. These attributes are:</span></p>
<ul>
<li class="p1"><span class="s1"><kbd>android:allowBackup</kbd>: It is used to specify whether the application is allowed to take part in the backup and restore infrastructure. When set to <kbd>true</kbd>, the application can be backed up by the Android system. Otherwise, if this attribute is set to <kbd>false</kbd>, no backup of the application will ever be created by the Android system.</span></li>
<li class="p1"><kbd>android:icon</kbd><span>: It specifies the icon resource for the application. It can also be used to specify icon resources for application components.</span></li>
<li class="p1"><kbd>android:label</kbd>: It specifies a default label for the application as a whole. It can also be used to specify default labels for application components.</li>
<li class="p1"><kbd>android:roundIcon</kbd><span>: It specifies an icon resource to be used when a circular icon resource is required. When an app icon is requested by a launcher, the Android framework returns either <kbd>android:icon</kbd> or <kbd>android:roundIcon</kbd>; which is returned depends on the device build configuration. As either can be returned, it is important to specify a resource for both attributes.</span></li>
<li class="p1"><kbd>android:supportsRtl</kbd><span>: It specifies whether an application is willing to support <strong>right-to-left</strong> (<strong>RTL</strong>) layouts. The application is set to support it when this attribute is set to <kbd>true</kbd>. Otherwise, the application does not support RTL layouts.</span></li>
<li class="p1"><kbd>android:theme</kbd><span>: It specifies a style resource defining a default theme for all activities in the application.</span></li>
</ul>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">&lt;category&gt;</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">This element is a child element to <kbd>&lt;intent-filter&gt;</kbd>. It is used to specify a category name to its parent intent filter component.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">&lt;intent-filter&gt;</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">Specifies the type of intent that activity, service, and broadcast receiver components can respond to. An intent filter is always declared within a parent component with the <kbd>&lt;intent-filter&gt;</kbd> element.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">&lt;manifest&gt;</h1>
                </header>
            
            <article>
                
<p class="p1"><span class="s1">This is the root element of the app manifest file. It contains a single <kbd>&lt;application&gt;</kbd> element and specifies the&#160;<kbd>xmlns:android</kbd> and <kbd>package</kbd> attributes.</span></p>


            </article>

            
        </section>
    </div>


  <div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we took a closer look at the Android application framework. In the process, we learned about several things, such as the seven fundamental Android app components: activities, intents, intent filters, fragments, services, loaders, and content providers.</p>
<p>In addition, we took a close look at the process of creating a layout, the constraint layout, types of layout constraints that exist, string, dimension resources, views, view groups, and working with <kbd>SharedPreferences</kbd>. In the next chapter, we will delve further into the world of Tetris and implement the gameplay as well as critical application logic.</p>
<p class="mce-root"></p>


            </article>

            
        </section>
    </div>
</body>
</html>