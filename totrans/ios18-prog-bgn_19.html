<html><head></head><body><div id="book-content"><div id="sbo-rt-content"><div id="_idContainer400" class="Basic-Text-Frame">
    <h1 class="chapterNumber">16</h1>
    <h1 id="_idParaDest-217" class="chapterTitle">Passing Data between View Controllers</h1>
    <p class="normal">In the previous chapter, you configured the <code class="inlineCode">JournalListViewController</code> class, the view controller for the Journal List screen, to display journal entries from a structure containing sample data in a table view.</p>
    <p class="normal">In this chapter, you’ll learn how to pass data from one view controller to another. You’ll start by implementing a view controller for the Add New Journal Entry screen, then add code to pass data from the Add New Journal Entry screen to the Journal List screen. Next, you’ll learn <a id="_idIndexMarker682"/>how to remove journal entries while you’re on <a id="_idIndexMarker683"/>the Journal List screen. After that, you’ll learn about <strong class="keyWord">text field</strong> and<strong class="keyWord"> text view delegate</strong> methods, and finally, you’ll pass data from the Journal List screen to the Journal Entry Detail screen.</p>
    <p class="normal">By the end of this chapter, you’ll have learned how to pass data between view controllers and how to use text field and text view delegate methods. This will enable you to easily pass data between view controllers in your own apps.</p>
    <p class="normal">The following topics will be covered in this chapter:</p>
    <ul>
      <li class="bulletList">Passing data from the Add New Journal Entry screen to the Journal List screen</li>
      <li class="bulletList">Removing rows from a table view</li>
      <li class="bulletList">Exploring text field and text view delegate methods</li>
      <li class="bulletList">Passing data from the Journal List screen to the Journal Entry Detail screen</li>
    </ul>
    <h1 id="_idParaDest-218" class="heading-1">Technical requirements</h1>
    <p class="normal">You will continue working on the <code class="inlineCode">JRNL</code> project that you modified in the previous chapter.</p>
    <p class="normal">The playground and completed Xcode project for this chapter are in the <code class="inlineCode">Chapter16</code> folder of the code bundle for this book, which can be downloaded here:</p>
    <p class="normal"><a href="https://github.com/PacktPublishing/iOS-18-Programming-for-Beginners-Ninth-Edition%0D"><span class="url">https://github.com/PacktPublishing/iOS-18-Programming-for-Beginners-Ninth-Edition</span></a></p>
    <p class="normal">Check out the following video to see the code in action:</p>
    <p class="normal"><a href="https://youtu.be/92O7NgVoT2Q%0D"><span class="url">https://youtu.be/92O7NgVoT2Q</span></a></p>
    <p class="normal">Let’s begin by learning how data is passed between the Add New Journal Entry screen and the Journal List screen in the next section.</p>
    <h1 id="_idParaDest-219" class="heading-1">Passing data from the Add New Journal Entry screen to the Journal List screen</h1>
    <p class="normal">As shown in the app tour in <em class="chapterRef">Chapter 10</em>, <em class="italic">Setting Up the User Interface</em>, the Add New Journal <a id="_idIndexMarker684"/>Entry screen allows the user to enter data to create a new journal entry. To do so, the user <a id="_idIndexMarker685"/>will click the <strong class="screenText">+</strong> button in the top-right corner of the Journal List screen to display the Add New Journal Entry screen. The user will then enter the details for the new journal entry. Clicking the <strong class="screenText">Save</strong> button will dismiss the Add New Journal Entry screen and a new row containing a table view cell is added to the table view on the Journal List screen. The table view cell will display the photo, date, and title of the newly added journal entry.</p>
    <p class="normal">For this to work, you’ll implement the <code class="inlineCode">prepare(for:sender:)</code> method for the view controller managing the Add New Journal Entry screen. This method is triggered when you go from one view controller to another. With this method, you’ll create a new journal entry using the information the user entered and assign it to a variable. You’ll implement an unwind method in the <code class="inlineCode">JournalListViewController</code> class so you will be able to access this variable when you’re on the Journal List screen. Then, you will add the new journal entry obtained from this variable to the <code class="inlineCode">journalEntries</code> array and then redraw the table view.</p>
    <div class="note">
      <p class="normal">To learn more about the <code class="inlineCode">prepare(for:sender:)</code> method, see: <a href="https://developer.apple.com/documentation/uikit/uiviewcontroller/1621490-prepare"><span class="url">https://developer.apple.com/documentation/uikit/uiviewcontroller/1621490-prepare</span></a>.</p>
    </div>
    <p class="normal">In the <a id="_idIndexMarker686"/>next section, you’ll create a new view controller instance to manage the Add New Journal Entry screen.</p>
    <h2 id="_idParaDest-220" class="heading-2">Creating the AddJournalEntryViewController class</h2>
    <p class="normal">At present, the Add New Journal Entry screen does not have a view controller. You’ll add a <a id="_idIndexMarker687"/>new file to your project and implement the <code class="inlineCode">AddJournalEntryViewController</code> class, assign it to the <strong class="screenText">New Entry Scene</strong>, and connect the outlets. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">Open your <code class="inlineCode">JRNL</code> project from the previous chapter. In the Project navigator, create a new group by right-clicking the <strong class="screenText">JRNL</strong> group and choosing <strong class="screenText">New Group</strong>.</li>
      <li class="numberedList">Name this group <code class="inlineCode">Add New Journal Entry Screen</code> and move it so it is below the <strong class="screenText">Journal List Screen</strong> group.</li>
      <li class="numberedList">Right-click on the <strong class="screenText">Add New Journal Entry Screen</strong> group and select <strong class="screenText">New File from Template...</strong>.</li>
      <li class="numberedList"><strong class="screenText">iOS</strong> should already be selected. Choose <strong class="screenText">Cocoa Touch Class</strong> and click <strong class="screenText">Next</strong>.</li>
      <li class="numberedList">Configure the class with the following details:<ul>
          <li class="bulletList level-2"><strong class="screenText">Class</strong>: <code class="inlineCode">AddJournalEntryViewController</code></li>
          <li class="bulletList level-2"><strong class="screenText">Subclass of</strong>: <code class="inlineCode">UIViewController</code></li>
          <li class="bulletList level-2"><strong class="screenText">Also create XIB</strong>: Unchecked</li>
          <li class="bulletList level-2"><strong class="screenText">Language</strong>: <strong class="screenText">Swift</strong></li>
        </ul>
      </li>
    </ol>
    <p class="normal-one">Click <strong class="screenText">Next</strong> when you’re done.</p>
    <ol>
      <li class="numberedList" value="6">Click <strong class="screenText">Create</strong> and the <code class="inlineCode">AddJournalEntryViewController</code> file will appear in the Project navigator.</li>
    </ol>
    <p class="normal">The <code class="inlineCode">AddJournalEntryViewController</code> file has now been created, with the <code class="inlineCode">AddJournalEntryViewController</code> class declaration inside it. You’ll set this class as the custom class of the view controller scene that’s presented when you tap the <strong class="screenText">+</strong> button in the Journal List screen. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">Click the <strong class="screenText">Main</strong> storyboard file in the Project navigator and click <strong class="screenText">New Entry Scene</strong> in the document outline:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_01.png" alt="" width="812" height="262"/></figure>
    <p class="packt_figref">Figure 16.1: Editor area showing New Entry Scene</p>
    <ol>
      <li class="numberedList" value="2">Click <a id="_idIndexMarker688"/>the Identity inspector button and, under <strong class="screenText">Custom Class</strong>, set <strong class="screenText">Class</strong> to <code class="inlineCode">AddJournalEntryViewController</code>:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_02.png" alt="" width="467" height="284"/></figure>
    <p class="packt_figref">Figure 16.2: Identity inspector settings for New Entry Scene</p>
    <p class="normal">Great! In the next section, let’s connect the user interface elements in the <strong class="screenText">New Entry</strong> <strong class="screenText">Scene</strong> to outlets in the <code class="inlineCode">AddJournalEntryViewController</code> class. By doing this, the <code class="inlineCode">AddJournalEntryViewController</code> instance will be able to access the data the user enters on the Add New Journal Entry screen.</p>
    <h2 id="_idParaDest-221" class="heading-2">Connecting the UI elements to the AddJournalEntryViewController class</h2>
    <p class="normal">Currently, the <code class="inlineCode">AddJournalEntryViewController</code> instance for the Add New Journal Entry screen <a id="_idIndexMarker689"/>has no way of communicating with the UI elements in it. You’ll add outlets in the <code class="inlineCode">AddJournalEntryViewController</code> class and assign the corresponding UI elements in the <strong class="screenText">New Entry</strong> <strong class="screenText">Scene</strong> to each outlet. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">In the Project navigator, click the <strong class="screenText">AddJournalEntryViewController</strong> file and add the following properties to the <code class="inlineCode">AddJournalEntryViewController</code> class after the opening curly brace:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-comment">// MARK: - Properties</span>
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">titleTextField</span>: <span class="hljs-type">UITextField</span>!
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span><span class="hljs-template-variable"> bodyTextView</span>: <span class="hljs-type">UITextView</span>!
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">photoImageView</span>: <span class="hljs-type">UIImageView</span>!
</code></pre>
      </li>
      <li class="numberedList">Click the <strong class="screenText">Main</strong> storyboard file and click <strong class="screenText">New Entry Scene</strong> in the document outline.</li>
      <li class="numberedList">Click the Connections inspector to display all the outlets for <strong class="screenText">New Entry Scene</strong>. Drag from the <strong class="screenText">titleTextField</strong> outlet to the text field in <strong class="screenText">New Entry Scene</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_03.png" alt="" width="812" height="313"/></figure>
    <p class="packt_figref">Figure 16.3: Connections inspector showing the titleTextField outlet</p>
    <ol>
      <li class="numberedList" value="4">Drag from the <strong class="screenText">bodyTextView</strong> outlet to the text view in <strong class="screenText">New Entry Scene</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_04.png" alt="" width="812" height="312"/></figure>
    <p class="packt_figref">Figure 16.4: Connections inspector showing the bodyTextView outlet</p>
    <ol>
      <li class="numberedList" value="5">Drag <a id="_idIndexMarker690"/>from the<strong class="screenText"> photoImageView</strong> outlet to the image view in <strong class="screenText">New Entry Scene</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_05.png" alt="" width="812" height="400"/></figure>
    <p class="packt_figref">Figure 16.5: Connections inspector showing the photoImageView outlet</p>
    <div class="packt_tip">
      <p class="normal">Remember that if you make a mistake, you can click the <strong class="screenText">x</strong> to break the connection and drag from the outlet to the UI element once more.</p>
    </div>
    <p class="normal">With <a id="_idIndexMarker691"/>that, you’ve connected the UI elements in the <strong class="screenText">New Entry</strong> <strong class="screenText">Scene</strong> to the outlets in the <code class="inlineCode">AddJournalEntryViewController</code> class. In the next section, you’ll implement the code to create a <code class="inlineCode">JournalEntry</code> instance when the user clicks the <strong class="screenText">Save</strong> button.</p>
    <h2 id="_idParaDest-222" class="heading-2">Creating a JournalEntry instance from user input</h2>
    <p class="normal">You have implemented the <code class="inlineCode">AddJournalEntryViewController</code> class and connected the outlets <a id="_idIndexMarker692"/>in this class to the text field, text view, and image view in the <strong class="screenText">New Entry</strong> <strong class="screenText">Scene</strong>. When the user enters data into the text field and text view, you can use this information to create a new journal entry.</p>
    <p class="normal">When a view controller is about to transition to another view controller, the view controller’s <code class="inlineCode">prepare(for:sender:)</code> method is called. You’ll implement this method to create a new <code class="inlineCode">JournalEntry</code> instance, which can then be passed to the view controller for the Journal List screen. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">In the Project navigator, click the <strong class="screenText">AddJournalEntryViewController</strong> file and add a <code class="inlineCode">newJournalEntry</code> property to the <code class="inlineCode">AddJournalEntryViewController</code> class after the outlet declarations:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-comment">//MARK: - Properties</span>
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">titleTextField</span>: <span class="hljs-type">UITextField</span>!
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">bodyTextView</span>: <span class="hljs-type">UITextView</span>!
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">photoImageView</span>: <span class="hljs-type">UIImageView</span>!
<span class="code-highlight"><strong class="hljs-keyword-slc">var</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">newJournalEntry</strong><strong class="hljs-slc">: </strong><strong class="hljs-con-class-slc">JournalEntry</strong><strong class="hljs-slc">?</strong></span>
</code></pre>
      </li>
    </ol>
    <p class="normal-one">The <code class="inlineCode">JournalEntry</code> instance created using the data entered by the user will be assigned to this property.</p>
    <ol>
      <li class="numberedList" value="2">Uncomment the <code class="inlineCode">prepare(for:sender:)</code> method in this class. It should look like the following:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_06.png" alt="" width="812" height="292"/></figure>
    <p class="packt_figref">Figure 16.6: Editor area showing the prepare(for:sender:) method</p>
    <ol>
      <li class="numberedList" value="3">Add <a id="_idIndexMarker693"/>the following code between the curly braces of this method:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">let</span> title <span class="hljs-operator">=</span> <span class="hljs-variable">titleTextField</span>.<span class="hljs-con-attribute">text</span> <span class="hljs-operator">??</span> <span class="hljs-string">""</span>
<span class="hljs-keyword">let</span> body <span class="hljs-operator">=</span> <span class="hljs-variable">bodyTextView</span>.<span class="hljs-con-attribute">text</span> <span class="hljs-operator">??</span> <span class="hljs-string">""</span>
<span class="hljs-keyword">let</span> photo <span class="hljs-operator">=</span> <span class="hljs-variable">photoImageView</span>.<span class="hljs-con-attribute">image</span>
<span class="hljs-keyword">let</span> rating <span class="hljs-operator">=</span> <span class="hljs-number">3</span>
<span class="hljs-variable">newJournalEntry</span> <span class="hljs-operator">=</span> <span class="hljs-con-class">JournalEntry</span>(<span class="hljs-variable">rating</span>: rating, <span class="hljs-variable">title</span>: title, <span class="hljs-variable">body</span>: body, <span class="hljs-variable">photo</span>: photo)
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This will assign the strings from the text field and text view and the image from the image view to <code class="inlineCode">title</code>, <code class="inlineCode">body</code>, and <code class="inlineCode">photo</code>, respectively. Since the custom rating control shown in the app tour has not been implemented yet, a placeholder value is assigned to <code class="inlineCode">rating</code>. A new <code class="inlineCode">JournalEntry</code> instance is then created using these constants and assigned to the <code class="inlineCode">newJournalEntry</code> property.</p>
    <p class="normal">You’ve now added code that will create a <code class="inlineCode">JournalEntry</code> instance before the Add New Journal Entry screen transitions to the Journal List screen. In the next section, you’ll modify the <code class="inlineCode">JournalListViewController</code> class to get the new <code class="inlineCode">JournalEntry</code> instance and add it to the <code class="inlineCode">journalEntries</code> array.</p>
    <h2 id="_idParaDest-223" class="heading-2">Updating the table view with a new journal entry</h2>
    <p class="normal">On the Journal List screen, journal entries are displayed in a table view. The table view gets <a id="_idIndexMarker694"/>its data from the <code class="inlineCode">journalEntries</code> array contained in the <code class="inlineCode">sampleJournalEntryData</code> structure. You will add code to the <code class="inlineCode">JournalListViewController</code> class to get the <code class="inlineCode">JournalEntry</code> instance assigned to the <code class="inlineCode">newJournalEntry</code> property. After that, you will insert this instance to the <code class="inlineCode">journalEntries</code> array. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">In the Project navigator, click the <strong class="screenText">JournalListViewController</strong> file and add the following code before the closing curly brace:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">@IBAction</span> <span class="hljs-keyword">func</span> <span class="hljs-template-variable">unwindNewEntrySave</span>(<span class="hljs-template-variable">segue</span>: <span class="hljs-type">UIStoryboardSegue</span>) {
  <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> sourceViewController <span class="hljs-operator">=</span> segue.<span class="hljs-con-attribute">source</span> <span class="hljs-keyword">as</span>?
  <span class="hljs-con-class">AddJournalEntryViewController</span>, <span class="hljs-keyword">let</span> newJournalEntry <span class="hljs-operator">=</span>
  sourceViewController.<span class="hljs-variable">newJournalEntry</span> {
    <span class="hljs-variable">journalEntries</span>.<span class="hljs-con-attribute">insert</span>(newJournalEntry, <span class="hljs-con-attribute">at</span>: <span class="hljs-number">0</span>)
    <span class="hljs-variable">tableView</span>.<span class="hljs-con-attribute">reloadData</span>()
  }
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This method checks to see if the source view controller is an instance of the <code class="inlineCode">AddJournalEntryViewController</code> class, and if it is, gets the <code class="inlineCode">JournalEntry</code> instance from the <code class="inlineCode">newJournalEntry</code> property. This instance is then inserted as the first item in the <code class="inlineCode">journalEntries</code> array. After that, the <code class="inlineCode">tableView.reloadData()</code> statement will redraw the table view.</p>
    <ol>
      <li class="numberedList" value="2">Click the <strong class="screenText">Main</strong> storyboard file and expand the <strong class="screenText">New Entry Scene</strong> in the document outline. <em class="keystroke">Ctrl</em> + <em class="keystroke">Drag</em> from the <strong class="screenText">Save</strong> button in the document outline to the scene exit and choose <strong class="screenText">unwindNewEntrySaveWithSegue:</strong> from the pop-up menu.</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_07.png" alt="" width="484" height="333"/></figure>
    <p class="packt_figref">Figure 16.7: Pop-up menu showing unwindNewEntrySaveWithSegue: selected</p>
    <p class="normal-one">When <a id="_idIndexMarker695"/>you run your project, tapping the <strong class="screenText">Save</strong> button will transition from the Add New Entry screen to the Journal List screen, and execute the <code class="inlineCode">unwindNewEntrySave(segue:)</code> method.</p>
    <ol>
      <li class="numberedList" value="3">Build and run your project and click the <strong class="screenText">+</strong> button. Enter some sample text in the text field and text view. Click <strong class="screenText">Save</strong>.</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_08.png" alt="" width="461" height="496"/></figure>
    <p class="packt_figref">Figure 16.8: Simulator with the Save button highlighted</p>
    <ol>
      <li class="numberedList" value="4">The <a id="_idIndexMarker696"/>new journal entry will appear in the table view when the Journal List screen reappears.</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_09.png" alt="" width="405" height="467"/></figure>
    <p class="packt_figref">Figure 16.9: Simulator with new table view cell highlighted</p>
    <p class="normal">Excellent! You have successfully implemented a view controller for the Add New Journal Entry <a id="_idIndexMarker697"/>screen and can now add new journal entries, which will appear on the Journal List screen. In the next section, you’ll implement the code that will let you remove journal entries from the table view on the Journal List screen.</p>
    <h1 id="_idParaDest-224" class="heading-1">Removing rows from a table view</h1>
    <p class="normal">As you <a id="_idIndexMarker698"/>have learned in <em class="chapterRef">Chapter 14</em>, <em class="italic">Getting Started with MVC and Table Views</em>, table view row deletion is handled by the <code class="inlineCode">tableView(_:commit:forRowAt:)</code> method, which is one of the methods declared in the <code class="inlineCode">UITableViewDataSource</code> protocol.</p>
    <p class="normal">You’ll implement this method in the <code class="inlineCode">JournalListViewController</code> class. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">In the Project navigator, click the <strong class="screenText">JournalListViewController</strong> file and add the following <a id="_idIndexMarker699"/>code to the <code class="inlineCode">JournalListViewController</code> class after the existing table view data source methods:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">func</span> <span class="hljs-template-variable">tableView</span>(<span class="hljs-template-variable">_</span> <span class="hljs-params">tableView</span>: <span class="hljs-type">UITableView</span>, <span class="hljs-template-variable">commit</span> <span class="hljs-params">editingStyle</span>: <span class="hljs-type">UITableViewCell</span>.<span class="hljs-type">EditingStyle</span>, <span class="hljs-template-variable">forRowAt</span> <span class="hljs-params">indexPath</span>: <span class="hljs-type">IndexPath</span>) {
  <span class="hljs-keyword">if</span> editingStyle <span class="hljs-operator">==</span> .<span class="hljs-con-attribute">delete</span> {
    <span class="hljs-variable">journalEntries</span>.<span class="hljs-con-attribute">remove</span>(<span class="hljs-con-attribute">at</span>: indexPath.<span class="hljs-con-attribute">row</span>)
    tableView.<span class="hljs-con-attribute">reloadData</span>()
  }
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This will allow you to swipe left to display a <strong class="screenText">Delete</strong> button, and when you tap the <strong class="screenText">Delete</strong> button, the corresponding <code class="inlineCode">JournalEntry</code> instance will be removed from the <code class="inlineCode">journalEntries</code> array, and the table view will be redrawn.</p>
    <ol>
      <li class="numberedList" value="2">Build and run your project. Swipe left on any row to reveal a <strong class="screenText">Delete</strong> button:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_10.png" alt="" width="431" height="391"/></figure>
    <p class="packt_figref">Figure 16.10: Simulator showing the Delete button on the Journal List screen</p>
    <ol>
      <li class="numberedList" value="3">Tap <a id="_idIndexMarker700"/>the <strong class="screenText">Delete</strong> button and the row will be removed from the table view:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_11.png" alt="" width="431" height="285"/></figure>
    <p class="packt_figref">Figure 16.11: Simulator showing the redrawn table view</p>
    <p class="normal">With that, you have <a id="_idIndexMarker701"/>successfully implemented a way to remove rows from a table view! Awesome! In the next section, you’ll learn more about text field and text view delegate methods, which will be useful when you’re entering data in the Add New Journal Entry screen.</p>
    <h1 id="_idParaDest-225" class="heading-1">Exploring text field and text view delegate methods</h1>
    <p class="normal">Currently, there are a couple of issues with the Add New Journal Entry screen. The first issue is <a id="_idIndexMarker702"/>that it’s not possible to dismiss the software <a id="_idIndexMarker703"/>keyboard once it has appeared on the screen. The second issue is that you can click the <strong class="screenText">Save</strong> button even when the text field and text view are empty.</p>
    <p class="normal">To make it easier to work with text fields, Apple has implemented <code class="inlineCode">UITextFieldDelegate</code>, a protocol declaring a set of optional methods to manage the editing and validation of text in a text field object. Apple has also implemented <code class="inlineCode">UITextViewDelegate</code>, a protocol declaring methods for receiving editing-related messages for text view objects.</p>
    <div class="note">
      <p class="normal">You can <a id="_idIndexMarker704"/>learn more about the <code class="inlineCode">UITextFieldDelegate</code> protocol at this link: <a href="https://developer.apple.com/documentation/uikit/uitextfielddelegate"><span class="url">https://developer.apple.com/documentation/uikit/uitextfielddelegate</span></a>.</p>
      <p class="normal">You <a id="_idIndexMarker705"/>can learn more about the <code class="inlineCode">UITextViewDelegate</code> protocol at this link: <a href="https://developer.apple.com/documentation/uikit/uitextviewdelegate"><span class="url">https://developer.apple.com/documentation/uikit/uitextviewdelegate</span></a>.</p>
    </div>
    <p class="normal">You’ll <a id="_idIndexMarker706"/>implement methods from the <code class="inlineCode">UITextFieldDelegate</code> and <code class="inlineCode">UITextViewDelegate</code> protocols to the <code class="inlineCode">AddJournalEntryViewController</code> class so that the user can dismiss the software keyboard <a id="_idIndexMarker707"/>once data entry is complete. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">In the Project navigator, click the <strong class="screenText">AddJournalEntryViewController</strong> file. Add an extension after the closing curly brace of the <code class="inlineCode">AddJournalEntryViewController</code> class declaration to make it conform to the <code class="inlineCode">UITextFieldDelegate</code> and <code class="inlineCode">UITextViewDelegate</code> protocols:
        <pre class="programlisting code-one"><code class="hljs-code">extension <span class="hljs-title">AddJournalEntryViewController</span>: UITextFieldDelegate, <span class="hljs-type">UITextViewDelegate</span> {
}
</code></pre>
      </li>
      <li class="numberedList">Modify the <code class="inlineCode">viewDidLoad()</code> method as follows to set the <code class="inlineCode">AddJournalEntryViewController</code> instance as the delegate for the text field and text view:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-template-variable">viewDidLoad</span>() {
  <span class="hljs-keyword">super</span>.<span class="hljs-con-attribute">viewDidLoad</span>()
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-variable-slc">titleTextField</strong><strong class="hljs-slc">.</strong><strong class="hljs-con-attribute-slc">delegate</strong><strong class="hljs-slc"> </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">self</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-variable-slc">bodyTextView</strong><strong class="hljs-slc">.</strong><strong class="hljs-con-attribute-slc">delegate</strong><strong class="hljs-slc"> </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">self</strong></span>
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This means that the implementation of the text field and text view delegate methods are in the <code class="inlineCode">AddJournalEntryViewController</code> class.</p>
    <ol>
      <li class="numberedList" value="3">Add the following code after the opening curly brace of the extension to dismiss the software keyboard when the <em class="keystroke">return</em> key is tapped after you have finished entering text in the text field:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">extension</span> <span class="hljs-title">AddJournalEntryViewController</span>: <span class="hljs-type">UITextFieldDelegate</span>, <span class="hljs-type">UITextViewDelegate</span> {
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-comment-slc">// MARK: - UITextFieldDelegate</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">func</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">textFieldShouldReturn</strong><strong class="hljs-slc">(</strong><strong class="hljs-template-variable-slc">_</strong><strong class="hljs-slc"> </strong><strong class="hljs-params-slc">textField</strong><strong class="hljs-slc">: </strong><strong class="hljs-type-slc">UITextField</strong><strong class="hljs-slc">) -&gt;</strong><strong class="hljs-slc">  </strong><strong class="hljs-type-slc">Bool</strong><strong class="hljs-slc"> {</strong></span> 
<span class="code-highlight"><strong class="hljs-slc">    textField.</strong><strong class="hljs-con-attribute-slc">resignFirstResponder</strong><strong class="hljs-slc">()</strong></span>
<span class="code-highlight"><strong class="hljs-slc">    </strong><strong class="hljs-keyword-slc">return</strong><strong class="hljs-slc"> </strong><strong class="hljs-literal-slc">true</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  }</strong></span>
}
</code></pre>
      </li>
      <li class="numberedList">Add the <a id="_idIndexMarker708"/>following code after the <code class="inlineCode">textFieldShouldReturn(_:)</code> method to dismiss the software keyboard when <a id="_idIndexMarker709"/>the <em class="keystroke">return</em> key is tapped after you have finished entering text in the text view:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-comment">//MARK: - UITextViewDelegate</span>
<span class="hljs-keyword">func</span> <span class="hljs-template-variable">textView</span>(<span class="hljs-template-variable">_</span> <span class="hljs-params">textView</span>: <span class="hljs-type">UITextView</span>, <span class="hljs-template-variable">shouldChangeTextIn</span> <span class="hljs-params">range</span>: <span class="hljs-type">NSRange</span>, <span class="hljs-template-variable">replacementText</span> <span class="hljs-params">text</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">Bool</span> {
  <span class="hljs-keyword">if </span>(text <span class="hljs-operator">==</span> <span class="hljs-string">"</span><span class="hljs-subst">\n</span><span class="hljs-string">"</span>) {
    textView.<span class="hljs-con-attribute">resignFirstResponder</span>()   
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">When you tap a text field or text view on the screen, it gains first responder status, and a software keyboard pops up from the bottom of the screen. Anything you type on the keyboard will go to whichever object has first responder status. After implementing the preceding methods, tapping <em class="keystroke">return</em> on the software keyboard while in a text field or text view will tell it to resign the first responder status, which will automatically make the keyboard disappear.</p>
    <ol>
      <li class="numberedList" value="5">Build and run your app and tap the text field. If the software keyboard does not appear, choose <strong class="screenText">Keyboard</strong> | <strong class="screenText">Toggle Software Keyboard</strong> from Simulator’s <strong class="screenText">I/O</strong> menu:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_12.png" alt="" width="812" height="311"/></figure>
    <p class="packt_figref">Figure 16.12: Simulator I/O menu with Keyboard | Toggle Software Keyboard selected</p>
    <ol>
      <li class="numberedList" value="6">Use the <a id="_idIndexMarker710"/>software keyboard to type some <a id="_idIndexMarker711"/>text into the text field or text view:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_13.png" alt="" width="466" height="825"/></figure>
    <p class="packt_figref">Figure 16.13: Simulator showing the software keyboard</p>
    <ol>
      <li class="numberedList" value="7">After typing <a id="_idIndexMarker712"/>some text in either the text <a id="_idIndexMarker713"/>field or the text view, tap <em class="keystroke">return</em> on the software keyboard, and it should automatically disappear.</li>
    </ol>
    <p class="normal">The first issue has been resolved, and the user is now able to dismiss the software keyboard. Great! Now you will modify your app so that the user can only tap <strong class="screenText">Save</strong> if there is text in the text field and text view. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">To enable or disable the <strong class="screenText">Save</strong> button, you will need to be able to set its state. Type in the following after the outlet declarations to create an outlet for the <strong class="screenText">Save</strong> button:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">titleTextField</span>: <span class="hljs-type">UITextField</span>!
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">bodyTextView</span>: <span class="hljs-type">UITextView</span>!
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">photoImageView</span>: <span class="hljs-type">UIImageView</span>!
<span class="code-highlight"><strong class="hljs-keyword-slc">@IBOutlet</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">var</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">saveButton</strong><strong class="hljs-slc">: </strong><strong class="hljs-type-slc">UIBarButtonItem</strong><strong class="hljs-slc">!</strong></span>
<span class="hljs-keyword">var</span> <span class="hljs-template-variable">newJournalEntry</span>: <span class="hljs-type">JournalEntry</span>?
</code></pre>
      </li>
      <li class="numberedList">In the <a id="_idIndexMarker714"/>Project navigator, click the <strong class="screenText">Main</strong> storyboard file and click <strong class="screenText">New Entry Scene</strong> in the document outline.</li>
      <li class="numberedList">Click the <a id="_idIndexMarker715"/>Connections inspector button and drag from the <strong class="screenText">saveButton</strong> outlet to the <strong class="screenText">Save</strong> button in the <strong class="screenText">New Entry</strong> scene:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_14.png" alt="" width="812" height="275"/></figure>
    <p class="packt_figref">Figure 16.14: Connections inspector showing the saveButton outlet</p>
    <ol>
      <li class="numberedList" value="4">In the Project navigator, click the <strong class="screenText">AddJournalEntryViewController</strong> file. Add the <code class="inlineCode">UITextFieldDelegate</code> method shown after the <code class="inlineCode">textFieldShouldReturn(_:)</code> method:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">func</span> <span class="hljs-template-variable">textFieldShouldReturn</span>(<span class="hljs-template-variable">_</span> <span class="hljs-params">textField</span>: <span class="hljs-type">UITextField</span>) -&gt; <span class="hljs-type">Bool</span> {
  textField.<span class="hljs-con-attribute">resignFirstResponder</span>()
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
}
<span class="code-highlight"><strong class="hljs-keyword-slc">func</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">textFieldDidBeginEditing</strong><strong class="hljs-slc">(</strong><strong class="hljs-template-variable-slc">_</strong><strong class="hljs-slc"> </strong><strong class="hljs-params-slc">textField</strong><strong class="hljs-slc">: </strong><strong class="hljs-type-slc">UITextField</strong><strong class="hljs-slc">) {</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-variable-slc">saveButton</strong><strong class="hljs-slc">.</strong><strong class="hljs-con-attribute-slc">isEnabled</strong><strong class="hljs-slc"> </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> </strong><strong class="hljs-literal-slc">false</strong></span>
<span class="code-highlight"><strong class="hljs-slc">}</strong></span>
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This method <a id="_idIndexMarker716"/>disables the <strong class="screenText">Save</strong> button <a id="_idIndexMarker717"/>when the user starts editing text in the text field.</p>
    <ol>
      <li class="numberedList" value="5">Add the <code class="inlineCode">UITextViewDelegate</code> method shown after the <code class="inlineCode">textView(_:shouldChangeTextIn range:replacementText:)</code> method:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">func</span> <span class="hljs-template-variable">textView</span>(<span class="hljs-template-variable">_</span> <span class="hljs-params">textView</span>: <span class="hljs-type">UITextView</span>, <span class="hljs-template-variable">shouldChangeTextIn</span> <span class="hljs-params">range</span>: <span class="hljs-type">NSRange</span>, <span class="hljs-template-variable">replacementText</span> <span class="hljs-params">text</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">Bool</span> {
  <span class="hljs-keyword">if</span>(text <span class="hljs-operator">==</span> <span class="hljs-string">"</span><span class="hljs-subst">\n</span><span class="hljs-string">"</span>) {
    textView.<span class="hljs-con-attribute">resignFirstResponder</span>()
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
}
<span class="code-highlight"><strong class="hljs-keyword-slc">func</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">textViewDidBeginEditing</strong><strong class="hljs-slc">(</strong><strong class="hljs-template-variable-slc">_</strong><strong class="hljs-slc"> </strong><strong class="hljs-params-slc">textView</strong><strong class="hljs-slc">: </strong><strong class="hljs-type-slc">UITextView</strong><strong class="hljs-slc">) {</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-variable-slc">saveButton</strong><strong class="hljs-slc">.</strong><strong class="hljs-con-attribute-slc">isEnabled</strong><strong class="hljs-slc"> </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> </strong><strong class="hljs-literal-slc">false</strong></span>
<span class="code-highlight"><strong class="hljs-slc">}</strong></span>
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This method disables the <strong class="screenText">Save</strong> button when the user starts editing text in the text view.</p>
    <ol>
      <li class="numberedList" value="6">Add a method to enable the <strong class="screenText">Save</strong> button if there is text in the text field or text view before the closing curly brace:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-comment">// MARK: - Private methods</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-template-variable">updateSaveButtonState</span>() {
  <span class="hljs-keyword">let</span> textFieldText <span class="hljs-operator">=</span> <span class="hljs-variable">titleTextField</span>.<span class="hljs-con-attribute">text</span> <span class="hljs-operator">??</span> <span class="hljs-string">""</span>
  <span class="hljs-keyword">let</span> textViewText <span class="hljs-operator">=</span> <span class="hljs-variable">bodyTextView</span>.<span class="hljs-con-attribute">text</span> <span class="hljs-operator">??</span> <span class="hljs-string">""</span>
  <span class="hljs-variable">saveButton</span>.<span class="hljs-con-attribute">isEnabled</span> <span class="hljs-operator">=</span> <span class="hljs-operator">!</span>textFieldText.<span class="hljs-con-attribute">isEmpty</span> <span class="hljs-operator">&amp;&amp;</span> 
<span class="hljs-operator">  !</span>textViewText.<span class="hljs-con-attribute">isEmpty</span>
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">The <code class="inlineCode">private</code> keyword means that this method is only accessible within this class.</p>
    <ol>
      <li class="numberedList" value="7">Add the <code class="inlineCode">UITextFieldDelegate</code> method shown after the <code class="inlineCode">textFieldDidBeginEditing(_:)</code> method:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">func</span> <span class="hljs-template-variable">textFieldDidBeginEditing</span>(<span class="hljs-template-variable">_</span> <span class="hljs-params">textField</span>: <span class="hljs-type">UITextField</span>) {
  <span class="hljs-variable">saveButton</span>.<span class="hljs-con-attribute">isEnabled</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>
}
<span class="code-highlight"><strong class="hljs-keyword-slc">func</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">textFieldDidEndEditing</strong><strong class="hljs-slc">(</strong><strong class="hljs-template-variable-slc">_</strong><strong class="hljs-slc"> </strong><strong class="hljs-params-slc">textField</strong><strong class="hljs-slc">: </strong><strong class="hljs-type-slc">UITextField</strong><strong class="hljs-slc">) {</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-variable-slc">updateSaveButtonState</strong><strong class="hljs-slc">()</strong></span>
<span class="code-highlight"><strong class="hljs-slc">}</strong></span>
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This method <a id="_idIndexMarker718"/>calls <code class="inlineCode">updateSaveButtonState()</code> after the text field resigns the first responder status.</p>
    <ol>
      <li class="numberedList" value="8">Add <a id="_idIndexMarker719"/>the <code class="inlineCode">UITextViewDelegate</code> methods <a id="_idIndexMarker720"/>shown after the <code class="inlineCode">textViewDidBeginEditing(_:)</code> method:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">func</span> <span class="hljs-template-variable">textViewDidBeginEditing</span>(<span class="hljs-template-variable">_</span> <span class="hljs-params">textView</span>: <span class="hljs-type">UITextView</span>) {
  <span class="hljs-variable">saveButton</span>.<span class="hljs-con-attribute">isEnabled</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>
}
<span class="code-highlight"><strong class="hljs-keyword-slc">func</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">textViewDidEndEditing</strong><strong class="hljs-slc">(</strong><strong class="hljs-template-variable-slc">_</strong><strong class="hljs-slc"> </strong><strong class="hljs-params-slc">textView</strong><strong class="hljs-slc">: </strong><strong class="hljs-type-slc">UITextView</strong><strong class="hljs-slc">) {</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-variable-slc">updateSaveButtonState</strong><strong class="hljs-slc">()</strong></span>
<span class="code-highlight"><strong class="hljs-slc">}</strong></span>
<span class="code-highlight"><strong class="hljs-slc">func </strong><strong class="hljs-template-variable-slc">textViewDidChange</strong><strong class="hljs-slc">(</strong><strong class="hljs-template-variable-slc">_</strong><strong class="hljs-slc"> textView: </strong><strong class="hljs-type-slc">UITextView</strong><strong class="hljs-slc">) {</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-variable-slc">updateSaveButtonState</strong><strong class="hljs-slc">()</strong></span>
<span class="code-highlight"><strong class="hljs-slc">}</strong></span>
</code></pre>
      </li>
    </ol>
    <p class="normal-one">These methods call <code class="inlineCode">updateSaveButtonState()</code> after the text view resigns the first responder status and when the contents of the text view change.</p>
    <ol>
      <li class="numberedList" value="9">In the <code class="inlineCode">viewDidLoad()</code> method, call <code class="inlineCode">updateSaveButtonState()</code> to disable the <strong class="screenText">Save</strong> button when the Add New Journal Entry screen first appears:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-template-variable">viewDidLoad</span>() {
  <span class="hljs-keyword">super</span>.<span class="hljs-con-attribute">viewDidLoad</span>()
  <span class="hljs-variable">titleTextField</span>.<span class="hljs-con-attribute">delegate</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span>
  <span class="hljs-variable">bodyTextView</span>.<span class="hljs-con-attribute">delegate</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span>
  <span class="code-highlight"><strong class="hljs-variable-slc">updateSaveButtonState</strong><strong class="hljs-slc">()</strong></span>
}
</code></pre>
      </li>
      <li class="numberedList">Build and run your project and tap the <strong class="screenText">+</strong> button to go to the Add Entry screen. The <strong class="screenText">Save</strong> button will be disabled:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_15.png" alt="" width="532" height="411"/></figure>
    <p class="packt_figref">Figure 16.15: Simulator showing the Save button disabled</p>
    <ol>
      <li class="numberedList" value="11">Enter some text in the text field and press the <em class="keystroke">return</em> key. As there is already placeholder text in the text view, the <strong class="screenText">Save</strong> button will be enabled.</li>
    </ol>
    <p class="normal">Both issues <a id="_idIndexMarker721"/>with the Add New Journal Entry screen <a id="_idIndexMarker722"/>have been resolved. Fantastic! In the next section, you’ll learn how to pass data from the Journal List screen to the Journal Entry Detail screen when you tap a table view row.</p>
    <h1 id="_idParaDest-226" class="heading-1">Passing data from the Journal List screen to the Journal Entry Detail screen</h1>
    <p class="normal">As <a id="_idIndexMarker723"/>shown in <a id="_idIndexMarker724"/>the app tour in <em class="chapterRef">Chapter 10</em>, <em class="italic">Setting Up the User Interface</em>, the Journal Entry Detail screen allows the user to view the details of a journal entry when a table view cell on the Journal List screen is tapped. For this to work, you’ll create a view controller subclass to manage the Journal Entry Detail screen. Next, you’ll implement the <code class="inlineCode">prepare(for:sender:)</code> method for the <code class="inlineCode">JournalListViewController</code> class to get the <code class="inlineCode">JournalEntry</code> instance corresponding to the row that was tapped. You will then pass this <a id="_idIndexMarker725"/>instance to the view controller instance managing the Journal Entry Detail screen.</p>
    <p class="normal">You’ll <a id="_idIndexMarker726"/>start by creating a new view controller instance to manage the Journal Entry Detail screen in the next section.</p>
    <h2 id="_idParaDest-227" class="heading-2">Creating the JournalEntryDetailViewController class</h2>
    <p class="normal">At present, the Journal Entry Detail screen does not have a view controller. You’ll add a new <a id="_idIndexMarker727"/>file to your project and implement the <code class="inlineCode">JournalEntryDetailViewController</code> class, assign it as the identity for the <strong class="screenText">Entry Detail</strong> <strong class="screenText">Scene</strong>, and connect the outlets. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">In the Project navigator, create a new group by right-clicking the <strong class="screenText">JRNL</strong> group and choosing <strong class="screenText">New Group</strong>. Name this group <strong class="screenText">Journal Entry Detail Screen</strong> and move it below the <strong class="screenText">Add New Journal Entry Screen</strong> group.</li>
      <li class="numberedList">Right-click on the <strong class="screenText">Journal Entry Detail Screen</strong> group and select <strong class="screenText">New File from Template...</strong>.</li>
      <li class="numberedList"><strong class="screenText">iOS</strong> should already be selected. Choose <strong class="screenText">Cocoa Touch Class</strong> and click <strong class="screenText">Next</strong>.</li>
      <li class="numberedList">Configure the class with the following details:<ul>
          <li class="bulletList level-2"><strong class="screenText">Class</strong>: <code class="inlineCode">JournalEntryDetailViewController</code></li>
          <li class="bulletList level-2"><strong class="screenText">Subclass</strong>: <code class="inlineCode">UITableViewController</code></li>
          <li class="bulletList level-2"><strong class="screenText">Also create XIB</strong>: Unchecked</li>
          <li class="bulletList level-2"><strong class="screenText">Language</strong>: <code class="inlineCode">Swift</code></li>
        </ul>
      </li>
    </ol>
    <p class="normal-one">Click <strong class="screenText">Next</strong>.</p>
    <ol>
      <li class="numberedList" value="5">Click <strong class="screenText">Create</strong> and the<strong class="screenText"> </strong><code class="inlineCode">JournalEntryDetailViewController</code> file will appear in the Project navigator.</li>
    </ol>
    <p class="normal">With that, the <code class="inlineCode">JournalEntryDetailViewController</code> file has been created, with the <code class="inlineCode">JournalEntryDetailViewController</code> class declaration inside it. Now you’ll set the identity of the view controller scene that’s presented when you tap a table view cell on the Journal List screen. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">Click the <strong class="screenText">Main</strong> storyboard file in the Project navigator and choose <strong class="screenText">Entry Detail Scene</strong> in the document outline.</li>
      <li class="numberedList">Click the Identity inspector button and, under <strong class="screenText">Custom Class</strong>, set <strong class="screenText">Class</strong> to <code class="inlineCode">JournalEntryDetailViewController</code>:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_16.png" alt="" width="812" height="258"/></figure>
    <p class="packt_figref">Figure 16.16: Identity inspector settings for Entry Detail Scene</p>
    <p class="normal">Cool! In <a id="_idIndexMarker728"/>the next section, you’ll connect the user interface elements in the <strong class="screenText">Entry Detail Scene</strong> to outlets in the <code class="inlineCode">JournalEntryDetailViewController</code> class. By doing this, the <code class="inlineCode">JournalEntryDetailViewController</code> instance will be able to display the details for the journal entry.</p>
    <h2 id="_idParaDest-228" class="heading-2">Connecting the UI elements to the JournalEntryDetailViewController class</h2>
    <p class="normal">Currently, the <code class="inlineCode">JournalEntryDetailViewController</code> instance for the Journal Entry Detail screen <a id="_idIndexMarker729"/>has no way of communicating with the UI elements in it. You’ll create outlets in the <code class="inlineCode">JournalEntryDetailViewController</code> class and assign the corresponding UI elements in the <strong class="screenText">Entry Detail Scene</strong> to each outlet. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">In the Project navigator, click the <strong class="screenText">JournalEntryDetailViewController </strong>file and remove all the code between the curly braces except for the <code class="inlineCode">viewDidLoad()</code> method.</li>
      <li class="numberedList">Add the following properties to the <code class="inlineCode">JournalEntryDetailViewController</code> class after the opening curly brace:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-comment">// MARK: - Properties</span>
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">dateLabel</span>: <span class="hljs-type">UILabel</span>!
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">titleLabel</span>: <span class="hljs-type">UILabel</span>!
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">bodyTextView</span>: <span class="hljs-type">UITextView</span>!
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">photoImageView</span>: <span class="hljs-type">UIImageView</span>!
</code></pre>
      </li>
      <li class="numberedList">Click the <strong class="screenText">Main</strong> storyboard file and select <strong class="screenText">Entry Detail Scene</strong> in the document outline.</li>
      <li class="numberedList">Click <a id="_idIndexMarker730"/>the Connections inspector button and drag from the <strong class="screenText">dateLabel</strong> outlet to the first label in <strong class="screenText">Entry Detail Scene</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_17.png" alt="" width="812" height="249"/></figure>
    <p class="packt_figref">Figure 16.17: Connections inspector showing the dateLabel outlet</p>
    <ol>
      <li class="numberedList" value="5">Drag from the <strong class="screenText">titleLabel</strong> outlet to the second label in <strong class="screenText">Entry Detail Scene</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_18.png" alt="" width="812" height="271"/></figure>
    <p class="packt_figref">Figure 16.18: Connections inspector showing the titleLabel outlet</p>
    <ol>
      <li class="numberedList" value="6">Drag from the <strong class="screenText">bodyTextView</strong> outlet to the text view in <strong class="screenText">Entry Detail Scene</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_19.png" alt="" width="812" height="303"/></figure>
    <p class="packt_figref">Figure 16.19: Connections inspector showing the bodyTextView outlet</p>
    <ol>
      <li class="numberedList" value="7">Drag <a id="_idIndexMarker731"/>from the <strong class="screenText">photoImageView</strong> outlet to the image view in <strong class="screenText">Entry Detail Scene</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_20.png" alt="" width="812" height="404"/></figure>
    <p class="packt_figref">Figure 16.20: Connections inspector showing the photoImageView outlet</p>
    <div class="packt_tip">
      <p class="normal">Remember that if you make a mistake, you can click the <strong class="screenText">x</strong> to break the connection and drag from the outlet to the UI element once more.</p>
    </div>
    <p class="normal">You’ve <a id="_idIndexMarker732"/>now successfully connected the UI elements in the <strong class="screenText">Entry Detail</strong> <strong class="screenText">Scene</strong> to the outlets in the <code class="inlineCode">JournalEntryDetailViewController</code> class. In the next section, you will implement the code to display the details of a <code class="inlineCode">JournalEntry</code> instance when the user taps a table view cell on the Journal List screen.</p>
    <h2 id="_idParaDest-229" class="heading-2">Displaying the details of a journal entry</h2>
    <p class="normal">Until this point, you have implemented the <code class="inlineCode">JournalEntryDetailViewController</code> class and <a id="_idIndexMarker733"/>connected the outlets in this class to the labels, text view, and image view in the <strong class="screenText">Entry Detail</strong> <strong class="screenText">Scene</strong>. When the user taps a table view cell on the Journal List screen, you’ll get the corresponding <code class="inlineCode">JournalEntry</code> instance from the data source and pass it to the <code class="inlineCode">JournalEntryDetailViewController</code> instance to display on the Journal Entry Detail screen. To do this, you will implement the <code class="inlineCode">prepare(for:sender:)</code> method in the <code class="inlineCode">JournalListViewController</code> class. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">In the Project navigator, click the <strong class="screenText">Main</strong> storyboard file and click the segue connecting <strong class="screenText">Journal Scene</strong> and <strong class="screenText">Entry Detail Scene</strong>. Click the Attributes inspector button and, under <strong class="screenText">Storyboard Segue</strong>, set <strong class="screenText">Identifier</strong> to <code class="inlineCode">entryDetail</code>:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_21.png" alt="" width="812" height="310"/></figure>
    <p class="packt_figref">Figure 16.21: Attributes inspector showing Identifier set to entryDetail</p>
    <p class="normal-one">You will use this identifier later to identify the segue used to go from the <strong class="screenText">Journal</strong> <strong class="screenText">Scene</strong> to the <strong class="screenText">Entry Detail</strong> <strong class="screenText">Scene</strong>.</p>
    <ol>
      <li class="numberedList" value="2">Click the <strong class="screenText">JournalEntryDetailViewController</strong> file in the Project navigator and add the following property to the <code class="inlineCode">JournalEntryDetailViewController</code> class after the outlet declarations:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-comment">//MARK: - Properties</span>
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">dateLabel</span>: <span class="hljs-type">UILabel</span>!
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">titleLabel</span>: <span class="hljs-type">UILabel</span>!
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">bodyTextView</span>: <span class="hljs-type">UITextView</span>!
<span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> <span class="hljs-template-variable">photoImageView</span>: <span class="hljs-type">UIImageView</span>!
<span class="code-highlight"><strong class="hljs-keyword-slc">var</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">selectedJournalEntry</strong><strong class="hljs-slc">: </strong><strong class="hljs-con-class-slc">JournalEntry</strong><strong class="hljs-slc">?</strong></span>
</code></pre>
      </li>
    </ol>
    <p class="normal-one">The <code class="inlineCode">JournalEntry</code> instance that you pass to the <code class="inlineCode">JournalEntryDetailViewController</code> instance will be assigned to the <code class="inlineCode">selectedJournalEntry</code> property.</p>
    <ol>
      <li class="numberedList" value="3">Click <a id="_idIndexMarker734"/>the <strong class="screenText">JournalListViewController</strong> file in the Project navigator and implement the <code class="inlineCode">prepare(for:sender:)</code> method in the <code class="inlineCode">JournalListViewController</code> class after the table view delegate methods, as shown:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-comment">// MARK: - Navigation</span>
<span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-template-variable">prepare</span>(<span class="hljs-template-variable">for</span> <span class="hljs-params">segue</span>: <span class="hljs-type">UIStoryboardSegue</span>, <span class="hljs-template-variable">sender</span>: <span class="hljs-keyword">Any</span><span class="hljs-operator">?</span>) {
  <span class="hljs-keyword">super</span>.<span class="hljs-con-attribute">prepare</span>(<span class="hljs-con-attribute">for</span>: segue, <span class="hljs-con-attribute">sender</span>: sender)
  <span class="hljs-keyword">guard</span> segue.<span class="hljs-con-attribute">identifier</span> <span class="hljs-operator">==</span> <span class="hljs-string">"entryDetail"</span> <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span>
  }
  <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> journalEntryDetailViewController <span class="hljs-operator">=</span> 
  segue.<span class="hljs-con-attribute">destination</span> <span class="hljs-keyword">as?</span> 
<span class="hljs-type">  </span><span class="hljs-con-class">JournalEntryDetailViewController</span>, 
<span class="hljs-keyword">  let</span> selectedJournalEntryCell <span class="hljs-operator">=</span> sender <span class="hljs-keyword">as?</span>
  <span class="hljs-con-class">JournalListTableViewCell</span>, 
<span class="hljs-keyword">  let</span> indexPath <span class="hljs-operator">=</span> <span class="hljs-variable">tableView</span>.<span class="hljs-con-attribute">indexPath</span>(<span class="hljs-con-attribute">for</span>:
  selectedJournalEntryCell) <span class="hljs-keyword">else</span> {
    <span class="hljs-con-attribute">fatalError</span>(<span class="hljs-string">"</span><span class="hljs-string">Could not get indexPath"</span>)
  }
  <span class="hljs-keyword">let</span> selectedJournalEntry <span class="hljs-operator">= </span><span class="hljs-variable">journalEntries</span>[indexPath.<span class="hljs-con-attribute">row</span>]
  journalEntryDetailViewController.<span class="hljs-variable">selectedJournalEntry</span> <span class="hljs-operator">=</span>
  selectedJournalEntry
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">Let’s break this down:</p>
    <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">guard</span> segue.<span class="hljs-con-attribute">identifier</span> <span class="hljs-operator">==</span> <span class="hljs-string">"entryDetail"</span> <span class="hljs-keyword">else</span> {
  <span class="hljs-keyword">return</span>
}
</code></pre>
    <p class="normal-one">This code checks to see if the correct segue is being used, if not, the method exits.</p>
    <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> journalEntryDetailViewController <span class="hljs-operator">=</span> segue.<span class="hljs-con-attribute">destination</span> <span class="hljs-keyword">as?</span> <span class="hljs-con-class">JournalEntryDetailViewController</span>, 
<span class="hljs-keyword">let</span> selectedJournalEntryCell <span class="hljs-operator">=</span> sender <span class="hljs-keyword">as?</span> <span class="hljs-con-class">JournalListTableViewCell</span>, 
<span class="hljs-keyword">let</span> indexPath <span class="hljs-operator">=</span> <span class="hljs-variable">tableView</span>.<span class="hljs-con-attribute">indexPath</span>(<span class="hljs-con-attribute">for</span>: selectedJournalEntryCell) <span class="hljs-keyword">else</span> {
  <span class="hljs-con-attribute">fatalError</span>(<span class="hljs-string">"Could not get indexpath"</span>)
}
</code></pre>
    <p class="normal-one">This code <a id="_idIndexMarker735"/>checks that the destination view controller is an instance of <code class="inlineCode">JournalEntryDetailViewController</code>, gets the table view cell the user tapped, and gets the index path of that cell.</p>
    <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">let</span> selectedJournalEntry <span class="hljs-operator">=</span> <span class="hljs-variable">journalEntries</span>[indexPath.<span class="hljs-con-attribute">row</span>]
</code></pre>
    <p class="normal-one">This statement gets the corresponding <code class="inlineCode">JournalEntry</code> instance from the <code class="inlineCode">journalEntries</code> array.</p>
    <pre class="programlisting code-one"><code class="hljs-code">journalEntryDetailViewController.<span class="hljs-variable">selectedJournalEntry</span> <span class="hljs-operator">=</span> selectedJournalEntry
</code></pre>
    <p class="normal-one">This statement assigns the <code class="inlineCode">JournalEntry</code> instance to the destination view controller’s <code class="inlineCode">selectedJournalEntry</code> property.</p>
    <p class="normal">You’ve now added code that will pass the journal entry corresponding to the table view cell tapped by the user to the <code class="inlineCode">JournalEntryDetailViewController</code> instance when transitioning from the Journal List screen to the Journal Entry Detail screen. In the next section, you’ll modify the <code class="inlineCode">JournalEntryDetailViewController</code> class to display the details of a journal entry.</p>
    <h2 id="_idParaDest-230" class="heading-2">Displaying the details of a selected journal entry</h2>
    <p class="normal">When transitioning to the Journal Entry Detail screen, the <code class="inlineCode">JournalEntry</code> instance corresponding to the table view cell that the user tapped will be assigned to the <code class="inlineCode">JournalEntryDetailViewController</code> instance’s <code class="inlineCode">selectedJournalEntry</code> property. You will <a id="_idIndexMarker736"/>add code to the <code class="inlineCode">JournalEntryDetailViewController</code> class to access this property and display the details for a journal entry. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">In the Project navigator, click the <strong class="screenText">JournalEntryDetailViewController</strong> file and modify the <code class="inlineCode">JournalEntryDetailViewController</code> class’s <code class="inlineCode">viewDidLoad()</code> method as shown to display the details of the journal entry:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-template-variable">viewDidLoad</span>() {
  <span class="hljs-keyword">super</span>.<span class="hljs-con-attribute">viewDidLoad</span>()
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-variable-slc">dateLabel</strong><strong class="hljs-slc">.</strong><strong class="hljs-con-attribute-slc">text</strong><strong class="hljs-slc"> </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> </strong><strong class="hljs-variable-slc">selectedJournalEntry</strong><strong class="hljs-operator-slc">?</strong><strong class="hljs-slc">.</strong><strong class="hljs-variable-slc">date</strong><strong class="hljs-slc">.</strong><strong class="hljs-con-attribute-slc">formatted</strong><strong class="hljs-slc">(</strong></span>
<span class="code-highlight"><strong class="hljs-slc">    .</strong><strong class="hljs-con-attribute-slc">dateTime</strong><strong class="hljs-slc">.</strong><strong class="hljs-con-attribute-slc">day</strong><strong class="hljs-slc">().</strong><strong class="hljs-con-attribute-slc">month</strong><strong class="hljs-slc">(.</strong><strong class="hljs-con-attribute-slc">wide</strong><strong class="hljs-slc">).</strong><strong class="hljs-con-attribute-slc">year</strong><strong class="hljs-slc">()</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  )</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-variable-slc">titleLabel</strong><strong class="hljs-slc">.</strong><strong class="hljs-con-attribute-slc">text</strong><strong class="hljs-slc"> </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> </strong><strong class="hljs-variable-slc">selectedJournalEntry</strong><strong class="hljs-operator-slc">?</strong><strong class="hljs-slc">.</strong><strong class="hljs-variable-slc">title</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-variable-slc">bodyTextView</strong><strong class="hljs-slc">.</strong><strong class="hljs-con-attribute-slc">text</strong><strong class="hljs-slc"> </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> </strong><strong class="hljs-variable-slc">selectedJournalEntry</strong><strong class="hljs-operator-slc">?</strong><strong class="hljs-slc">.</strong><strong class="hljs-variable-slc">body</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-variable-slc">photoImageView</strong><strong class="hljs-slc">.</strong><strong class="hljs-con-attribute-slc">image</strong><strong class="hljs-slc"> </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> </strong><strong class="hljs-variable-slc">selectedJournalEntry</strong><strong class="hljs-operator-slc">?</strong><strong class="hljs-slc">.</strong><strong class="hljs-variable-slc">photo</strong></span>
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">As you can see, the properties of the <code class="inlineCode">JournalEntry</code> instance that was passed to this view controller earlier are used to populate the user interface elements. Note that the <code class="inlineCode">date</code> property needs to be formatted into a string before it can be assigned to the <code class="inlineCode">dateLabel text</code> property.</p>
    <ol>
      <li class="numberedList" value="2">Build and run your project and tap a table view cell. The details of the journal entry corresponding to that table view cell will be displayed on the Journal Entry Detail screen:</li>
    </ol>
    <figure class="mediaobject"><img src="image/B31371_16_22.png" alt="" width="334" height="595"/></figure>
    <p class="packt_figref">Figure 16.22: Simulator displaying the Journal Entry Detail screen</p>
    <p class="normal">Congratulations! You <a id="_idIndexMarker737"/>have successfully implemented a view controller for the Journal Entry Detail screen. You will now be able to display journal entry details in it when the user taps a table view cell on the Journal List screen.</p>
    <h1 id="_idParaDest-231" class="heading-1">Summary</h1>
    <p class="normal">In this chapter, you learned how to pass data from one view controller to another. You implemented a view controller for the Add New Journal Entry screen, then you added code to pass data from the Add New Journal Entry screen to the Journal List screen. Next, you learned how to remove journal entries while you’re on the Journal List screen. After that, you learned about text field and text view delegate methods, and finally, you learned how to pass data from the Journal List screen to the Journal Entry Detail screen.</p>
    <p class="normal">You now know how to pass data between view controllers and how to use text field and text view delegate methods. This will enable you to easily pass data between view controllers in your own apps. Cool!</p>
    <p class="normal">In the next chapter, you will add a view controller to the Map screen and configure it to display journal entry locations using map annotations. You’ll also configure the map annotations to display the Journal Entry Detail screen when a button in the annotation callout is tapped.</p>
    <h1 id="_idParaDest-232" class="heading-1">Join us on Discord!</h1>
    <p class="normal">Read this book alongside other users, experts, and the author himself. Ask questions, provide solutions to other readers, chat with the author via Ask Me Anything sessions, and much more. Scan the QR code or visit the link to join the community.</p>
    <p class="normal"><a href="https://packt.link/ios-Swift%0D"><span class="url">https://packt.link/ios-Swift</span></a></p>
    <p class="normal"><a href="https://packt.link/ios-Swift%0D"><img src="image/QR_Code2370024260177612484.png" alt="" width="177" height="177"/></a></p>
  </div>
</div></div></body></html>