<html><head></head><body>
        <section>

            <header>
                <h1 class="header-title">Sound, Finishing Touches, and Publishing</h1>
            </header>

            <article>
                
<p>In this chapter, we will add sound and see how to make the same app run on different Android device resolutions. We will optimize the APK so that the file size is smaller. We will then prepare the app itself for publishing by adding icons. We will also prepare the app store itself by adding icons and screenshots and finally push the publish button so that the app is published.</p>
<p>This chapter includes the following topics:</p>
<ul>
<li>Adding sound</li>
<li>Handling multiple resolution</li>
<li>Optimizing the APK size</li>
<li>Preparing for publishing</li>
<li>Publishing the game</li>
</ul>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Adding sound</h1>
            </header>

            <article>
                
<p>For adding sounds, the files are included in the <kbd>Resources</kbd> folder for this chapter. There are three files in total, of which two are sounds effects and one is a music file. The sounds effects are to be used in the game.</p>
<p>The punch sound is to be played when whether the enemy or the player gets hit. The block sound is to be played when the player or the enemy blocks the attack. The <kbd>bgMusic</kbd> file is the background music file that is to be played when any scene loads. Drag the <kbd>Audio</kbd> folder into the project.</p>
<p>Now open the MainMenu scene. And drag the <kbd>bgMusic</kbd> file into the scene. Take a look at the <span class="packt_screen">Inspector</span> pane:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="365" src="assets/image_08_001.png" width="303"/></div>
<p>The position of the background music doesn't matter, but if you were using the sound for <span>ambience</span> then make sure that you set the location of the sound source.</p>
<p>The <span class="packt_screen">Play On Awake</span> option is checked by default, which is what we want. However, we also want the music to be looped, so make sure to check the <span class="packt_screen">Loop</span> checkbox as well.</p>
<p>If you play the scene, you will hear the sound playing automatically. Do the same for game and options scenes as well. Let's see how to add the punch and block sound effect.</p>
<p>Whenever we click a button, it is good to give an audio feedback to the player so that they know that the button was clicked.</p>
<p>For this, drag and drop the punch audio effect into the scene as well. Make sure that none of the options such as <span class="packt_screen">Play On Awake</span> are checked on the effect as it would start playing when the scene starts and we don't want that:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="404" src="assets/image_08_002.png" width="335"/></div>
<p>We will be playing the sound via the script. Open the <kbd>buttonClicks.cs</kbd> file. At the top of the class, create a public variable of type <kbd>AudioSource</kbd> called <kbd>punchSound</kbd>, as shown in the following code:</p>
<pre>
    public class buttonClick : MonoBehaviour {  <br/><strong>        public AudioSource punchSound;</strong> <br/>        public IAPManager iapManager; 
</pre>
<p>Go to <span class="packt_screen">GameObject</span> onto which the script is attached and attach the punch effect to the punch audio source:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="154" src="assets/image_08_003.png" width="329"/></div>
<p>Now, you can call the audio source to be played wherever you want. Suppose, we call the function in the <kbd>onButtonClick</kbd> class, which loads a new scene:</p>
<pre>
    punchSound.Play();
</pre>
<p>But, if you add it you will not hear when the scene changes as before the sound even plays, the game scene loads and you won't hear the punch sound effect. So we will make some changes to the function.</p>
<p>We will use a co-routine to wait for a while and then load the scene so that the sound effect plays:</p>
<pre>
    public void onButtonClick (string level){  <br/>        punchSound.Play();  <br/><strong>        StartCoroutine (onSceneLoad(level));        </strong> <br/>    } <br/><br/>    IEnumerator onSceneLoad (string sceneName) { <br/><strong>        yield return new WaitForSeconds(0.5f);</strong> <br/>        SceneManager.LoadScene(sceneName); <br/>    }  
</pre>
<p>So, in the <kbd>onButtonClick</kbd> function, we start a new co-routine and pass in the function we want to call. Then we create a function to be called, which needs to return an <kbd>IEnumerator</kbd>.</p>
<p>We then wait for half a second, call the <kbd>SceneManager.LoadScene</kbd> function, and then pass in the level name string to load the level.</p>
<p>This can be done to the other functions as well while pressing the Achievements, Facebook, and Twitter buttons. I shall leave that up to you guys as you'll gain exercise using it. This also needs to be done for other buttons on other scenes as well.</p>
<p>Now, let's see how to add the sound effect during gameplay. In the startScene, load both the sound effects into the scene and disable play on awake for both files. In the playerScript, add public variables for the punch and block sound effects:</p>
<pre>
    float totalTime = 0.0f; <br/>    float timeSinceLastHit = 0.0f; <br/>    float hitTimeInterval = 30.0f * .016f; <br/><br/>    float screenWidth = Screen.width; <br/><br/><strong>    public AudioSource punchSound;</strong><strong>    <br/>    public AudioSource blockSound; </strong>
</pre>
<p>On <span class="packt_screen">theDude</span> game object on which the playerScript is attached link the punch and block sounds:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="262" src="assets/image_08_004.png" width="337"/></div>
<p>Now, whenever the player gets hit we have to play the punch sound effect and if the player is blocking we play the block sound effect. So, open the playerScript and where we check if the enemy is punching we make the following changes to the code:</p>
<pre>
    if (eScript.isPunching == true) { <br/>        if (anim.GetBool("bIsDefending") == false) { <br/>            //Debug.Log("player got hit"); <br/>            anim.SetTrigger("tGotHit"); <br/>            health -= eScript.damage; <br/>            Debug.Log("Player Health: " + health); <br/><br/><strong>            punchSound.Play();</strong> <br/>        } else { <br/><strong>            blockSound.Play();</strong> <br/>        } <br/>    }  
</pre>
<p>effects playing as it should. Let's do the same for the enemy as well, as follows:</p>
<p>When you play the game you will find the sound effects playing as it should. Let's do the same for the enemy as well, as follows:</p>
<pre>
    if (pAnim.GetBool("tIsPunching")) {<br/>        if (anim.GetBool("bEnemyIsDefending") == false) {<br/>        // Debug.Log("enemy got hit");<br/>        anim.SetTrigger("tEnemyGotHit");<br/>        anim.SetBool("bEnemyIsDefending", true);         <br/>        health -= pScript.damage;<br/>        Debug.Log("Enemy Health: " + health);<br/>        punchSound.Play();         <br/>        } else {         <br/>            blockSound.Play();<br/>        }   <br/>    }
</pre>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Handling multiple resolutions</h1>
            </header>

            <article>
                
<p>Handling multiple resolutions is very easy in Unity. Open the MainMenu Scene. In the Hierarchy select the <span class="packt_screen">Canvas</span> component:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="143" src="assets/image_08_005.png" width="261"/></div>
<p>The <span class="packt_screen">Canvas Scaler</span> component is responsible for scaling the UI canvas depending upon the width and height of the screen. Set the <span class="packt_screen">UI Scale Mode</span> field to <span class="packt_screen">Scale With Screen Size</span>. This will scale the UI elements depending upon the width and height of the screen.</p>
<p>We also give a reference resolution based on which the UI will be scaled. Here it is 800x600. If it can fit the UI in that resolution, then it will definitely be able to fit in the 16:9 resolutions as well.</p>
<p>The next parameter is the <span class="packt_screen">Match</span> parameter. Here we set the width to match and then the height will be scaled accordingly. This would have to be declined for all the canvas in the other scenes. Once you do this the game should be able to scale the UI depending upon the screen resolution.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Optimizing the APK</h1>
            </header>

            <article>
                
<p>To get the individual file size, we make use of the console in Unity. Click on the small down arrow on the top-right of the console and select <span class="packt_screen">Open Editor Log</span>:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="166" src="assets/image_08_006.png" width="302"/></div>
<p>This will open a text file with the log information. Scroll down in the text file to where it shows the size of the individual files. As you can see, Unity already does a good job of removing assets that are not being used in the current game.</p>
<p>It also breaks down the assets and shows which of the assets are contributing to the size. Here we see that the <kbd>menuImage.jpg</kbd>, <kbd>ground.jpg</kbd>, and <kbd>wall.jpg</kbd> images are quite big in size:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="455" src="assets/image_08_007.png" width="626"/></div>
<p>One of the popular tools for reducing the size of a JPEG is <strong>Paint.NET</strong>; it is a free application to reduce the file size. You can download the tool from <a href="http://www.getpaint.net/index.html">http://www.getpaint.net/index.html</a>.</p>
<p>Similarly, for of PNG images, you can use the <strong>PNG Crush</strong> tool to reduce the size of the image. It can be downloaded from <a href="https://pmt.sourceforge.io/pngcrush">https://pmt.sourceforge.io/pngcrush</a>.</p>
<p>On the whole, it is recommended to use vector art as much as possible instead of raster images as the image quality will be crisp irrespective of the resolution and it will also save space for optimization purposes.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Preparing the build for publishing</h1>
            </header>

            <article>
                
<p>One thing that we still haven't done is to add the icon for the app. Once you have the app icon designed we set the icon for different Android devices.</p>
<p>For creating different size app icons from a single image, I use the <a href="http://makeappicon.com/" target="_blank">http://makeappicon.com/</a> website. All you have to do is drop the icon design in there and it will generate the icons of different sizes. Either browse to the file on the icon folder or drag and drop onto the link on the site and it will generate the icon and then it can be e-mailed to you:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="478" src="assets/image_08_008.png" width="391"/></div>
<p>Once you receive the files, download and extract them in a new folder called <kbd>Icons</kbd> in the <kbd>Project</kbd> folder.</p>
<p>Open <span class="packt_screen">PlayerSettings</span> in Unity. Under PlayerSettings, you can add the company logo. Make sure you add the details in the <span class="packt_screen">Company Name</span> and <span class="packt_screen">Product Name</span> fields. Under <span class="packt_screen">Resolution and Presentation</span> section, set <span class="packt_screen">Default Orientation*</span> field to <span class="packt_screen">Landscape Left</span>:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="418" src="assets/image_08_009.png" width="359"/></div>
<p>Next, under the <span class="packt_screen">Icon</span> component, check the <span class="packt_screen">Override for Android</span> option and select the icon with the correct resolution:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="485" src="assets/image_08_010.png" width="303"/></div>
<p>Next is the splash screen section. If you are a Unity pro user, then you will be able to select the splash screen of your choice. Otherwise, you can leave it empty. Next, in <span class="packt_screen">Other Settings</span> field make sure you have added the correct package name, version, and bundle version code.</p>
<p>For minimum API level, I have selected 4.0 as I want to target as many users as possible, but make sure the game works well on an actual device before setting the minimum API level. Keep the rest of the settings as they are.</p>
<p>Next in <span class="packt_screen">Publishing Settings</span>, select your <span class="packt_screen">Keystore</span> and type in the password. Select the alias for the key and type the password for it in the <span class="packt_screen">Keystore password</span>:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="205" src="assets/image_08_011.png" width="308"/></div>
<p>Next, open Services and select the ADS link and uncheck the<span class="packt_screen">Enable test mode</span> option to disable the testing:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="331" src="assets/image_08_012.png" width="288"/></div>
<p>Now open <span class="packt_screen">Build Settings</span> and build the APK to upload to the store.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Publishing the game</h1>
            </header>

            <article>
                
<p>Open the Android Developer Console, select <span class="packt_screen">All Applications</span>, and select the app that you would like to publish. Upload the new APK to the site.</p>
<p>Next, we have to make sure that all the sections are checked with a green tick mark as we publish the game only after this is done:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="199" src="assets/image_08_013.png" width="170"/></div>
<p>So select the <span class="packt_screen">Store listing</span> link and fill in the <span class="packt_screen">Title</span>, <span class="packt_screen">Short Description</span>, and <span class="packt_screen">Full Description</span> fields:</p>
<ul>
<li>The <span class="packt_screen">Title</span> field takes the name of the game that will be displayed on the app store, so make sure the name is unique, catchy, and easy to remember.</li>
<li>The <span class="packt_screen">Short Description</span> is shown on the store as well. The short description is more like a sneak peak into what the game/asp is about. Usually, you will specify the USP of the product telling the reader what makes your game appealing and different from other products. You will also specify the genre of the game here so that if the reader is into that genre then they can read further about it. Once the user clicks the link it will reveal the full description.</li>
<li>In the <span class="packt_screen">Full Description</span> field, you should tell what the game has to offer to the reader. This includes features and a short summary of the story and player motivation, and so on. I have provided a short example in the following screenshot:</li>
</ul>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="355" src="assets/image_08_014.png" width="711"/></div>
<p>Scrolling further down we have to provide icons, screenshots, and feature graphics. I really can't emphasize how important the icons and selection of screenshots are to the success of your game.</p>
<p>Icons need to be on top of our priority list as it is the first thing the user will see once they come across the app. It becomes even more important given the fact that there are tons of apps getting released on the app store on a daily basis. A lot of thought and effort needs to be put into selecting the right kind of icon that can summarize the gist of your game and at the same time is unique enough to differentiate itself from the millions of icons on the app store.</p>
<p>Once the user is interested in the icon and clicks on it, the next thing that will grab their attention is the screenshots. A minimum of three screenshots need to be uploaded. You can upload more than that. Pick and select the images for your screenshot that complement what you say in the full description. For each bullet point in the feature, provide a screenshot to tell the user what you are offering.</p>
<p>If you are targeting tablets, add screenshots specially taken on tablets. Also, if you are developing for Android TV and Google Daydream, add screenshots for that as well.</p>
<p>You can also link a promo video that you have on YouTube. Make sure the video is not more than 30 seconds:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="662" src="assets/image_08_015.png" width="720"/></div>
<p>Next fill out the details in the <span class="packt_screen">Categorization</span> section. Here you will specify if it is an application or a game and what genre. Provide your company website, e-mail address, and submit a privacy policy.</p>
<p>If you are not submitting a privacy policy, you can uncheck the box under the <span class="packt_screen">Privacy Policy</span> section to say that you are not:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="359" src="assets/image_08_016.png" width="673"/></div>
<p>Once all the information is filled correctly to your satisfaction, click the <span class="packt_screen">Save Draft</span> button on the top-right corner of the page. Next, let's move on to the content rating section.</p>
<p>Here you will make sure that the content doesn't include offensive material and the quality of the product is up to the <strong>International Age Rating Coalition</strong> (<strong>IARC</strong>) rating standards. IARC is a body that assigns ratings to a given app or mobile games. Click on the Continue button to proceed.</p>
<p>Fill out your e-mail address, so that if an issue is encountered in the game, IARC can get in touch with you for clarification. Next, select the app category and, in that, select <span class="packt_screen">Game</span>.</p>
<p>Under the <span class="packt_screen">Game</span> category, you have to mention that your game doesn't include material pertaining to violence, fear, sexuality, gambling, language, controlled substances, crude humor, and other miscellaneous things. Specify <span class="packt_screen">No</span> option for all the items up until Crude Humor, as shown in the following screenshot:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="382" src="assets/image_08_017.png" width="304"/></div>
<p>For the <span class="packt_screen">MISCELLANEOUS</span> category, we specify <span class="packt_screen">No</span> to all items except digital purchase:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="398" src="assets/image_08_018.png" width="573"/></div>
<p>Since we have in-app purchases, we have to specify <span class="packt_screen">Yes</span> for that. Once done, save it by clicking on the <span class="packt_screen">Save</span> <span class="packt_screen">Questionnaire</span> option. Next, click <span class="packt_screen">Calculate rating</span> tab, following screen will be displayed:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="695" src="assets/image_08_019.png" width="655"/></div>
<p>You will then get a summary and a rating for the game. The same will also be e-mailed to you at the address provided.</p>
<p>Next, click on <span class="packt_screen">Apply Rating</span>; you will see that your rating is set. Click on <span class="packt_screen">PRICING &amp; DISTRIBUTION</span> and you will see the following window:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="733" src="assets/image_08_020.png" width="722"/></div>
<p>Here, select if you want the app to be free or paid. If you choose for it to be paid, then specify the price that you want to sell the app at.</p>
<p>Click on all the countries that you want the game to sell in. Clicking the <span class="packt_screen">Available</span> option will select all countries from the list. You can deselect the countries that you don't want the app to be distributed in. Also, at the bottom select that the app contains ads in the <span class="packt_screen">CONTAINS ADS</span> field.</p>
<p>Check the <span class="packt_screen">CONSENT</span> check list, shown in the following screenshot, if you approve the app to be promoted outside the Google Play Store, and that the app complies with Android Content Guidelines and US Export laws:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="205" src="assets/image_08_021.png" width="686"/></div>
<p>Click the <span class="packt_screen">Save Draft</span> button on the top-right corner of the screen. We already have specified in-app products, services and APIs, so we don't have to do anything here. But we have to go to Game Services and publish the achievements. So go to <span class="packt_screen">Game Services</span> and select the app.</p>
<p>Provide the detail in <span class="packt_screen">Display Name</span> and <span class="packt_screen">Description</span> fields on the main page and upload the icon and feature graphics here as well:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="535" src="assets/image_08_022.png" width="668"/></div>
<p>Click the <span class="packt_screen">Save</span> button on the top-left corner of the window. Next, go to the <span class="packt_screen">ACHIEVEMENTS</span> tab, select each achievement, and add the icons:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="516" src="assets/image_08_023.png" width="701"/></div>
<p>Once you have added icons for all the achievements, you will have the option to publish the game at the top-right corner. Once published, your achievement page will look like the following:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="200" src="assets/image_08_024.png" width="787"/></div>
<p>Now we can publish the app itself. Go to <span class="packt_screen">All Applications</span> and select <span class="packt_screen">Manage releases</span>. It will show that you have an app that is ready for production:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="151" src="assets/image_08_025.png" width="778"/></div>
<p>Click on the <span class="packt_screen">Resume</span> button. Add the detail in the <span class="packt_screen">RELEASE NAME</span> section and add a description to show what's new in this release:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="302" src="assets/image_08_026.png" width="665"/></div>
<p>Click on the <span class="packt_screen">Review</span> button and then click on<span class="packt_screen">Start Rollout to Production</span>. You will be asked to confirm that the app will now be available on the app store:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="149" src="assets/image_08_027.png" width="407"/></div>
<p>Click on the <span class="packt_screen">Confirm</span> button and now it will show you that the app is now pending for publication:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" height="382" src="assets/image_08_028.png" width="699"/></div>
<p>It takes about an hour for the app to be published and about three to four hours to be properly visible on the app store. So, be patient. Once it is released, you can distribute the link on social media and tell your friends to download and rate it.</p>
<p>There is still one small thing to take care of on Facebook. We have to log in to our developer account and enable the PunchyPunch app on Facebook.</p>
<p>Go to the Facebook developer account and select the app. Now go to <span class="packt_screen">App Review</span> tab and under the option saying <span class="packt_screen">Make Punchypunch Public</span>, flip the switch to make it public.</p>
<p>Now the app is public and your friends can share your game:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" src="assets/image_08_029.png"/></div>
<p>Congratulations! You have successfully developed an Android app on Unity and published it on the Google Play Store.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Summary</h1>
            </header>

            <article>
                
<p>In this chapter, we added sound to the game, prepared the app for publishing, and made changes to the app store itself. We uploaded the final build and published the app itself on to the store.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    </body></html>