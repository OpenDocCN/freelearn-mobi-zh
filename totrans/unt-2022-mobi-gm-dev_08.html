<html><head></head><body>
		<div id="_idContainer258">
			<h1 id="_idParaDest-97" class="chapter-number"><a id="_idTextAnchor251"/>8</h1>
			<h1 id="_idParaDest-98"><a id="_idTextAnchor252"/>Integrating Social Media into Our Project</h1>
			<p>We now have all of the foundational things needed to get our game out into the world; it’s mechanically working and we’ve set up all of the monetization. Having all of the features that we have added to our project is great, but if no one is playing your game, there’s no reason to <span class="No-Break">have them.</span></p>
			<p>Word-of-mouth marketing is the most reliable way to get others to try your game. Providing people with opportunities to share the game helps others discover the project, and it’s something that we should really try to do because marketing and getting your game out there is one of the hardest things to do as an <span class="No-Break">indie developer.</span></p>
			<p>In this chapter, you will learn some of the different ways to integrate social media into your projects. We will start off by adding something to share – a score. Afterward, we will see how we can share the score on Twitter. Then, we will see how we can connect our game to Facebook and use content from Facebook within our <span class="No-Break">game itself.</span></p>
			<p>This chapter will be split into a number of topics. It will contain a simple step-by-step process from beginning to end. The following is the outline of <span class="No-Break">our tasks:</span></p>
			<ul>
				<li>Adding a <span class="No-Break">scoring system</span></li>
				<li>Sharing high scores <span class="No-Break">via Twitter</span></li>
				<li>Downloading and installing <span class="No-Break">Facebook’s SDK</span></li>
				<li>Logging in to our game <span class="No-Break">via Facebook</span></li>
				<li>Displaying a Facebook name and <span class="No-Break">profile picture</span></li>
			</ul>
			<h1 id="_idParaDest-99"><a id="_idTextAnchor253"/>Technical requirements</h1>
			<p>This book utilizes Unity 2022.1.0b16 and Unity Hub 3.3.1, but the steps should work with minimal changes in future versions of the editor. If you would like to download the exact version used in this book and there is a new version out, you can visit Unity’s download archive at <a href="https://unity3d.com/get-unity/download/archive">https://unity3d.com/get-unity/download/archive</a>. You can also find the system requirements for Unity at <a href="https://docs.unity3d.com/2022.1/Documentation/Manual/system-requirements.html">https://docs.unity3d.com/2022.1/Documentation/Manual/system-requirements.html</a> in the <strong class="bold">Unity Editor system requirements</strong> section. To deploy your project, you will need an Android or <span class="No-Break">iOS device.</span></p>
			<p>Unlike previous chapters, the use of the Facebook SDK requires both iOS and Android build support for your Unity version installed, so make sure that both are added before importing the package or you will <span class="No-Break">have errors.</span></p>
			<p>You can find the code files present in this chapter on GitHub <span class="No-Break">at </span><a href="https://github.com/PacktPublishing/Unity-2022-Mobile-Game-Development-3rd-Edition/tree/main/Chapter08"><span class="No-Break">https://github.com/PacktPublishing/Unity-2022-Mobile-Game-Development-3rd-Edition/tree/main/Chapter08</span></a><span class="No-Break">.</span></p>
			<h1 id="_idParaDest-100"><a id="_idTextAnchor254"/>Adding a scoring system</h1>
			<p>In order to provide an<a id="_idIndexMarker525"/> incentive for players to share our game with others, we need to provide a compelling reason to do so. Some people are very competitive and wish to be the best at playing a game, challenging others to do better than them. To help with that, we can allow our players to share a score value via social media. However, to do that, we’ll first need to have a scoring system. Thankfully, it’s not too difficult to do that, so let’s add that real quick using the <span class="No-Break">following steps:</span></p>
			<ol>
				<li>Start off by opening the <strong class="source-inline">Gameplay.scene</strong> file located in the <strong class="source-inline">Assets/Scenes</strong> folder of the project. To show our players what their score is, we’ll need to have some way to display it on the screen. In our case, the easiest way would be with a <span class="No-Break">text object.</span></li>
				<li>From the <strong class="bold">Hierarchy</strong> window, select the <strong class="bold">On Screen Controls</strong> object that is the child of the <strong class="bold">Canvas</strong> object. Afterward, right-click on the <strong class="bold">On Screen Controls</strong> object and select <strong class="bold">UI </strong>| <strong class="bold">Text – Text Mesh Pro</strong>, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer225" class="IMG---Figure">
					<img src="image/B18868_08_01.jpg" alt="Figure 8.1– Adding a text object to the screen"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.1– Adding a text object to the screen</p>
			<p>T<a id="_idTextAnchor255"/>his will make the <strong class="bold">Text</strong> object <a id="_idIndexMarker526"/>a child of the <strong class="bold">Panel</strong> object, which in turn will automatically resize itself to fit within a notch if there is one in <span class="No-Break">the devices.</span></p>
			<ol>
				<li value="3">Rename this object <strong class="source-inline">Score Text</strong> and use the <strong class="bold">Anchors Preset</strong> menu at the top, holding down <em class="italic">Shift + Alt</em> to set the pivot and position <span class="No-Break">as well.</span></li>
				<li>Afterward, let’s set the <strong class="bold">RectTransform</strong> component’s <strong class="bold">Height</strong> property on the object to <strong class="source-inline">60</strong> to ensure that we have space to hold the score when we increase <span class="No-Break">the size.</span></li>
				<li>Next, in <strong class="bold">TextMeshPro - Text </strong>component, change the <strong class="bold">Text</strong> property to <strong class="source-inline">0</strong> and set <strong class="bold">Alignment</strong> to centered both horizontally and vertically. Afterward, set <strong class="bold">Font Size</strong> to <strong class="source-inline">45</strong> so that it’s easy <span class="No-Break">to see.</span></li>
				<li>To improve its readability, change <strong class="bold">Material Preset</strong> to <strong class="bold">LiberationSans SDF – Outline</strong> and let’s change <strong class="bold">Vertex Color</strong> <span class="No-Break">to black.</span></li>
			</ol>
			<p>Afterward, scroll down to the text material section (<strong class="bold">LiberationSans SDF Material</strong>) and click on the check next to the <strong class="bold">Outline</strong> section. Change the <strong class="bold">Color</strong> to white and then increase the <strong class="bold">Thickness</strong> to <strong class="source-inline">1</strong>. Notice that it seems to fill both the inside and outside of the text. To fix this, in the <strong class="bold">Face</strong> section, change the <strong class="bold">Dilate</strong> value <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">1</strong></span><span class="No-Break">.</span></p>
			<div>
				<div id="_idContainer226" class="IMG---Figure">
					<img src="image/B18868_08_02.jpg" alt="﻿Figure 8.2: Adjusting the properties of the text outline"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><a id="_idTextAnchor256"/>Figure 8.2: Adjusting the properties of the text outline</p>
			<ol>
				<li value="7">Next, open up the <strong class="source-inline">PlayerBehaviour</strong> script <a id="_idIndexMarker527"/>and add the following line at the top of <span class="No-Break">the file:</span><pre class="source-code">
using TMPro; //TextMeshProUGUI</pre></li>
				<li>Next, add the following code inside <span class="No-Break">the class:</span><pre class="source-code">
[Header("Object References")]
public TextMeshProUGUI scoreText;
private float score = 0;
public float Score
{
    get
    {
        return score;
    }
    set
    {
        score = value;
        /* Check if scoreText has been assigned */
        if (scoreText == null)
        {
            Debug.LogError("Score Text is not set. " +
                "Please go to the Inspector and assign
                    it");
            /* If not assigned, don't try to update
               it. */
            return;
        }
        /* Update the text to display the whole number
           portion of the score */
        scoreText.text = string.Format("{0:0}",
            score);
    }
}</pre></li>
			</ol>
			<p>We first have a reference to the <strong class="source-inline">scoreText</strong> object, which we will need to set in the <strong class="bold">Inspector</strong>. This is of the <strong class="source-inline">TextMeshProUGUI</strong> class, which contains properties relating to the text displayed on <span class="No-Break">the object.</span></p>
			<p>This makes use of C#’s <strong class="source-inline">get</strong>/<strong class="source-inline">set</strong> functions, which are implicit getters and setters. Basically, any time we get or set the <strong class="source-inline">Score</strong> variable, we will execute whatever is located between <strong class="source-inline">{}</strong>. In our case, any time we set the <strong class="source-inline">Score</strong> variable, it will update our text <span class="No-Break">for us.</span></p>
			<p class="callout-heading">Tip</p>
			<p class="callout">For more info on TextMeshPro, check <span class="No-Break">out </span><a href="https://docs.unity3d.com/Packages/com.unity.textmeshpro@3.0/manual/index.html#support--api-documentation"><span class="No-Break">https://docs.unity3d.com/Packages/com.unity.textmeshpro@3.0/manual/index.html#support--api-documentation</span></a><span class="No-Break">.</span></p>
			<p>This has an advantage over what a number of my students do, which is to update the value of the text every frame, which <a id="_idIndexMarker528"/>doesn’t need to happen. We only need to update the text when the value changes, which makes it perfect for us to use in <span class="No-Break">this situation.</span></p>
			<p class="callout-heading">Note</p>
			<p class="callout">For more information on the <strong class="source-inline">get</strong>/<strong class="source-inline">set</strong> accessors, check <span class="No-Break">out </span><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/using-properties"><span class="No-Break">https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/using-properties</span></a><span class="No-Break">.</span></p>
			<ol>
				<li value="9">T<a id="_idTextAnchor257"/>hen, update the <strong class="source-inline">PlayerBehaviour</strong> class to have the following <span class="No-Break">highlighted changes:</span><pre class="source-code">
// Start is called before the first frame update
public void Start()
{
    // Get access to our Rigidbody component
    rb = GetComponent&lt;Rigidbody&gt;();
    minSwipeDistancePixels = minSwipeDistance *
        Screen.dpi;
    joystick =
        GameObject.FindObjectOfType&lt;MobileJoystick&gt;();
<strong class="bold">    Score = 0;</strong>
}
/// &lt;summary&gt;
/// FixedUpdate is a prime place to put physics calculations
/// happening over a period of time.
/// &lt;/summary&gt;
void FixedUpdate()
{
    /* If the game is paused, don't do anything */
    if (PauseScreenBehaviour.paused)
    {
        return;
    }
  <strong class="bold">  Score += Time.deltaTime;</strong>
// Rest of Update here...</pre></li>
			</ol>
			<p>What we are doing here is <a id="_idIndexMarker529"/>resetting our score whenever the player is created and increasing the value while the game <span class="No-Break">isn’t paused.</span></p>
			<ol>
				<li value="10">Save the script and dive back <span class="No-Break">into Unity.</span></li>
				<li>Select the <strong class="bold">Player</strong> object and drag and drop our <strong class="bold">Score Text</strong> object into the <strong class="bold">Score Text</strong> variable on the <strong class="bold">Player </strong><span class="No-Break"><strong class="bold">Behaviour</strong></span><span class="No-Break"> component:</span></li>
			</ol>
			<div>
				<div id="_idContainer227" class="IMG---Figure">
					<img src="image/B18868_08_03.jpg" alt="Figure 8.3: Assigning the Score Text property"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.3: Assigning the Score Text property</p>
			<ol>
				<li value="12">On<a id="_idTextAnchor258"/>ce the variable has been<a id="_idIndexMarker530"/> assigned, go ahead and play the game. The game’s interface is shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer228" class="IMG---Figure">
					<img src="image/B18868_08_04.jpg" alt="Figure 8.4: The score added to the game"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.4: The score added to the game</p>
			<p>Now, as you can see, we have a score for our game, which updates as we play. This will allow players to easily know what their competency with the game is and give them some information that they can share with others. Now that we <a id="_idIndexMarker531"/>have a scoring system, let’s take a look at how we can share a high score <span class="No-Break">using Twitter.</span></p>
			<h1 id="_idParaDest-101">Shar<a id="_idTextAnchor259"/><a id="_idTextAnchor260"/><a id="_idTextAnchor261"/>ing high scores via Twitter</h1>
			<p>Twitter is an online news and <a id="_idIndexMarker532"/>social networking service where users post and interact with each other through messages that they call <em class="italic">tweets</em>, which are limited to 280 characters. Many indie game developers use Twitter as a way to attract others to play <span class="No-Break">their games.</span></p>
			<p>Twitter is a great option to start off with because we can add it very easily to our project by simply opening a specific URL. Let’s look at the steps to do <span class="No-Break">just that:</span></p>
			<ol>
				<li>Open the <strong class="source-inline">PauseScreenBehaviour</strong> script. Once inside, we will add the following code inside the <span class="No-Break"><strong class="source-inline">PlayerScreenBehaviour</strong></span><span class="No-Break"> class:</span><pre class="source-code">
#region Share Score via Twitter
/// &lt;summary&gt;
/// Web address in order to create a tweet
/// &lt;/summary&gt;
private const string tweetTextAddress = "http://twitter.com/intent/tweet?text=";
/// &lt;summary&gt;
/// Where we want players to visit
/// &lt;/summary&gt;
private string appStoreLink = "http://johnpdoran.com/";
[Tooltip("Reference to the player for the score")]
public PlayerBehaviour player;
/// &lt;summary&gt;
/// Will open Twitter with a prebuilt tweet. When called on iOS
/// or Android will open up Twitter app if installed
/// &lt;/summary&gt;
public void TweetScore()
{
    /* Create contents of the tweet */
    string tweet = "I got " + string.Format("{0:0}",
        player.Score) + " points in Endless Roller!
            Can you do better?";
    /* Create the entire message */
    string message = tweet + "\n" + appStoreLink;
    /* Ensures string is URL friendly */
    string url =
        UnityEngine.Networking.UnityWebRequest
            .EscapeURL(message);
    /* Open the URL to create the tweet */
    Application.OpenURL(tweetTextAddress + url);
}
#endregion</pre></li>
			</ol>
			<p>First of all, we will use a number of new things. You’ll note that the preceding block of code starts and ends with <strong class="source-inline">#region</strong> and <strong class="source-inline">#endregion</strong>, respectively. What this does is allow us to expand and collapse this portion of code inside Visual Studio. When we introduce longer code files, it can be convenient to be able to collapse or hide certain parts of your script so that you can focus only on the part of the file you’re working on. Since this portion of code has nothing to do with the rest of the <a id="_idIndexMarker533"/>script, this is a good place for us to <span class="No-Break">use it.</span></p>
			<p>To open URLs inside Unity, we will need to make use of the <strong class="source-inline">Application.OpenURL</strong> function and the <span class="No-Break"><strong class="source-inline">UnityWebRequest</strong></span><span class="No-Break"> class.</span></p>
			<p class="callout-heading">Note</p>
			<p class="callout">For more information on Twitter’s Web Intents and the ways you can use them, check <span class="No-Break">out </span><a href="https://dev.twitter.com/web/intents"><span class="No-Break">https://dev.twitter.com/web/intents</span></a><span class="No-Break">.</span></p>
			<p>The <strong class="source-inline">UnityWebRequest</strong> class is typically used to load content at runtime, but it also has the <strong class="source-inline">EscapeURL</strong> function, which will convert a string into a format that web browsers are comfortable with. For instance, the newline character will not be displayed <span class="No-Break">by itself.</span></p>
			<p class="callout-heading">Note</p>
			<p class="callout">For more information on the <strong class="source-inline">EscapeURL</strong> function, check <span class="No-Break">out </span><a href="https://docs.unity3d.com/ScriptReference/Networking.UnityWebRequest.EscapeURL.html"><span class="No-Break">https://docs.unity3d.com/ScriptReference/Networking.UnityWebRequest.EscapeURL.html</span></a><span class="No-Break">.</span></p>
			<p>Save<a id="_idTextAnchor262"/> the script and dive back into Unity. From the <strong class="bold">Hierarchy</strong> window, select the<strong class="bold"> Pause Screen Handler</strong> object and then set the <strong class="bold">Player</strong> property in the <strong class="bold">Inspector</strong> tab to our <strong class="source-inline">Player</strong> object by dragging and dropping the <strong class="bold">Player </strong>game object from the <strong class="bold">Hierarchy</strong> window onto the <strong class="bold">Player</strong> property in the <span class="No-Break"><strong class="bold">Inspector</strong></span><span class="No-Break"> window:</span></p>
			<div>
				<div id="_idContainer229" class="IMG---Figure">
					<img src="image/B18868_08_05.jpg" alt="Figure 8.5: Assigning the Player property"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.5: Assigning the Player property</p>
			<ol>
				<li>Now, we need to have a button for our <strong class="bold">Game Over</strong> screen to allow us to share <span class="No-Break">our score.</span></li>
				<li>Open up the <strong class="bold">Canvas</strong> object and toggle the <strong class="bold">Game Over</strong> object to <strong class="bold">ON</strong> by clicking on the checkmark beside its name in the <span class="No-Break"><strong class="bold">Inspector</strong></span><span class="No-Break"> window.</span></li>
				<li>From there, expand the two <strong class="bold">Panel</strong> child objects and the <strong class="bold">Game Over Contents</strong> object. Select the <strong class="bold">Main Menu Button</strong> object and duplicate it by pressing <em class="italic">Ctrl + D</em>. Next, change the name to <strong class="source-inline">Tweet Score Button</strong> and also <a id="_idIndexMarker534"/>update the text in the child object to display <strong class="source-inline">Tweet Score</strong> <span class="No-Break">as well.</span></li>
				<li>Afte<a id="_idTextAnchor263"/>rward, select the <strong class="bold">Tweet Score</strong> button object and scroll down to the <strong class="bold">Button</strong> component. From there, change the function we are calling to the <strong class="bold">PauseScreenBehaviour</strong> | <span class="No-Break"><strong class="bold">TweetScore</strong></span><span class="No-Break"> function:</span></li>
			</ol>
			<div>
				<div id="_idContainer230" class="IMG---Figure">
					<img src="image/B18868_08_06.jpg" alt="Figure 8.6: Calling the TweetScore function"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.6: Calling the TweetScore function</p>
			<ol>
				<li value="5">Select the <strong class="bold">Game Over</strong> object in the <strong class="bold">Hierarchy</strong> and disable it again. Next, save your scene and start <span class="No-Break">the game.</span></li>
				<li>Now when we fail the game, we can click on the <strong class="bold">Tweet Score</strong> button and our browser will open on <span class="No-Break">our PC:</span></li>
			</ol>
			<div>
				<div id="_idContainer231" class="IMG---Figure">
					<img src="image/B18868_08_07.jpg" alt="Fi﻿gure 8.7: Result on PC"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Fi<a id="_idTextAnchor264"/>gure 8.7: Result on PC</p>
			<p>However, on our<a id="_idIndexMarker535"/> mobile devices, it will open up the Twitter app if it <span class="No-Break">is installed:</span></p>
			<div>
				<div id="_idContainer232" class="IMG---Figure">
					<img src="image/B18868_08_08.jpg" alt="Figure 8.8: Tweeting our score via the Twitter mobile app"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.8: Tweeting our score via the Twitter mobile app</p>
			<p>With that, you learned just how easy it is to share something <span class="No-Break">using Twitter.</span></p>
			<p class="callout-heading">Note</p>
			<p class="callout">For<a id="_idTextAnchor265"/> those who are interested in doing more than this with Twitter, it does have its own API for Unity, which will allow you to let users log in to your game using Twitter if you’d like to do that instead of Facebook, which we will do later on. If you’re interested in looking into this, you can find more information <span class="No-Break">at </span><a href="https://dev.twitter.com/twitterkit/unity/overview"><span class="No-Break">https://dev.twitter.com/twitterkit/unity/overview</span></a><span class="No-Break">.</span></p>
			<p>Of course, other social networks <a id="_idIndexMarker536"/>exist as well, some of which have their very own <strong class="bold">software development kit</strong> (<strong class="bold">SDK</strong>), which<a id="_idIndexMarker537"/> allows you to access the information that they ha<a id="_idTextAnchor266"/>ve. In the next section, we will explore how to <span class="No-Break">utilize this.</span></p>
			<h1 id="_idParaDest-102">Download<a id="_idTextAnchor267"/>ing and installing Facebook’s SDK</h1>
			<p>We couldn’t have a chapter on <a id="_idIndexMarker538"/>social networking without mentioning Facebook. Facebook has its own SDK that can be used with Unity. This can allow us to use the information that Facebook already has, including the user’s name and profile image, within our game experience. Let’s look at the steps to <span class="No-Break">incorporate them:</span></p>
			<ol>
				<li>Open up your web browser and <span class="No-Break">visit </span><a href="https://developers.facebook.com/docs/unity/"><span class="No-Break">https://developers.facebook.com/docs/unity/</span></a><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer233" class="IMG---Figure">
					<img src="image/B18868_08_09.jpg" alt="Figure 8.9: Facebook SDK for Unity page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.9: Facebook SDK for Unity page</p>
			<ol>
				<li value="2">Click on the <strong class="bold">Download the SDK </strong>button and wait for it to finish downloading. Once it is downloaded, unzip it and then open up the <strong class="source-inline">facebook-unity-sdk-15.1.0</strong> folder. Then, open up the <strong class="source-inline">FacebookSDK</strong> folder and you’ll see a single <span class="No-Break">file, </span><span class="No-Break"><strong class="source-inline">facebook-unity-sdk-15.1.0.unitypackage</strong></span><span class="No-Break">.</span></li>
			</ol>
			<p>Unlike previous chapters, the use of the Facebook SDK requires both iOS and Android build support for your Unity version installed, so make sure that both are added before importing the package or you will have errors. To do so, in Unity Hub, go to the <strong class="bold">Installs</strong> section and, from the gear icon, select <strong class="bold">Add Modules</strong> and add the relevant items that weren’t included before (if there <span class="No-Break">are any).</span></p>
			<ol>
				<li value="3">Double-click on the <strong class="source-inline">unitypackage</strong> file, and you <a id="_idIndexMarker539"/>should have a window pop up, as <span class="No-Break">shown here:</span></li>
			</ol>
			<div>
				<div id="_idContainer234" class="IMG---Figure">
					<img src="image/B18868_08_10.jpg" alt="Figure 8.10: Unity package import dialog"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.10: Unity package import dialog</p>
			<p>If this does not work, you can also go to <strong class="bold">Assets</strong> | <strong class="bold">Import Package</strong> | <strong class="bold">Custom Package</strong> and then find the folder that you unzipped the file to and open it <span class="No-Break">that way.</span></p>
			<ol>
				<li value="4">Click on the <strong class="bold">Import</strong> button and wait for it to finish loading. From here, you’ll get a popup noting the project may contain obsolete APIs. Go ahead and click on the <strong class="bold">I Made a Backup. Go Ahead!</strong> button and wait for it <span class="No-Break">to finish.</span></li>
				<li>Now, in order to use the Facebook API, we will first need to have a Facebook App ID, so let’s do <span class="No-Break">that next.</span></li>
				<li>Go back to your web browser and go to <a href="https://developers.facebook.com/">https://developers.facebook.com/</a> and click on the <strong class="bold">Log In</strong> button in the top-right corner of the screen. Once you log in to your Facebook account, you should see something similar to the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer235" class="IMG---Figure">
					<img src="image/B18868_08_11.jpg" alt="Figure 8.11: Meta for Developers menu"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.11: Meta for Developers menu</p>
			<ol>
				<li value="7">From the pr<a id="_idTextAnchor268"/>eceding page, click <a id="_idIndexMarker540"/>on the <strong class="bold">Get Started</strong> button in the top-right corner of the screen. From there, you’ll be brought to a screen where you need to click <strong class="bold">Next</strong>, and then you’ll be asked your role. Click on <strong class="bold">Developer</strong> and, on the next screen, click on the <strong class="bold">Create First </strong><span class="No-Break"><strong class="bold">App</strong></span><span class="No-Break"> button.</span></li>
				<li>Afterward, add a <strong class="bold">Display Name</strong> for your game (I used <strong class="source-inline">Endless Roller</strong>) and your <strong class="bold">Contact E-mail</strong>, and then select <strong class="bold">Create </strong><span class="No-Break"><strong class="bold">App</strong></span><span class="No-Break"> </span><span class="No-Break"><strong class="bold">ID</strong></span><span class="No-Break">.</span></li>
				<li>Once you’re brought to your app’s page, click on the <strong class="bold">Dashboard</strong> option to the left of the default info for your game. Note the <strong class="bold">App ID</strong> and copy it by clicking on it or by highlighting it and then pressing <em class="italic">Ctrl + </em><span class="No-Break"><em class="italic">C</em></span><span class="No-Break">.</span></li>
				<li>If you instead see a <strong class="bold">My Apps</strong> option, click on that and then click on the green <strong class="bold">Create App</strong> button on the right-hand side of the page. From the <strong class="bold">Select an app type</strong> menu, select <strong class="bold">Gaming</strong> and then select <strong class="bold">Next</strong>. In the <strong class="bold">Add an app name</strong> section, add a name (I used <strong class="source-inline">Endless Roller</strong>) and your contact e-mail, and then select <span class="No-Break"><strong class="bold">Create app</strong></span><span class="No-Break">.</span></li>
			</ol>
			<div>
				<div id="_idContainer236" class="IMG---Figure">
					<img src="image/B18868_08_12.jpg" alt="Figure 8.12: Getting the App ID"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.12: Getting the App ID</p>
			<ol>
				<li value="11">Return to Unity, and you may <a id="_idIndexMarker541"/>be asked to share some info with Google. Answer as you wish. Then, you’ll have the option to enable Android auto-resolution. I set <strong class="bold">Enable</strong> and had to wait for it to resolve <span class="No-Break">Android dependencies.</span></li>
				<li>Afterward, you will note a new Facebook option in the top bar. Select it and then select <strong class="bold">Edit Settings</strong>. Once you’re there, click on <strong class="bold">Inspector</strong> if you need to and you’ll see several options. Set <strong class="bold">Facebook App Id</strong> to our created app’s ID and then set the name to our <span class="No-Break">game’s name:</span></li>
			</ol>
			<div>
				<div id="_idContainer237" class="IMG---Figure">
					<img src="image/B18868_08_13.jpg" alt="Figure 8.13: Adding ﻿the App Id to Facebook Settings"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.13: Adding the App Id to Facebook Settings</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">There is <a id="_idTextAnchor269"/>a possibility that you may get an error the next time that you try to export your game to Android due to changing the SDK location. If this is the case, close your Unity project and then go to the project folder and delete the <strong class="source-inline">Temp</strong> folder. Upon restarting the project, the error should <span class="No-Break">go away.</span></p>
			<ol>
				<li value="13">Return to the Facebook Settings menu by going to <strong class="bold">Facebook</strong> | <span class="No-Break"><strong class="bold">Edit Settings...</strong></span><span class="No-Break">.</span></li>
			</ol>
			<p>Now, you’ll notice that under <strong class="bold">Android Build Facebook Settings</strong>, there is a new error stating that OpenSSL is <span class="No-Break">not found.</span></p>
			<ol>
				<li value="14">To fix this<a id="_idTextAnchor270"/>, we will first need to download OpenSSL by going to <a href="http://slproweb.com/products/Win32OpenSSL.html">http://slproweb.com/products/Win32OpenSSL.html</a>. From there, select the <strong class="bold">EXE</strong> link below the <strong class="bold">Win64 OpenSSL v1.1.1u</strong> option, as <span class="No-Break">shown here:</span></li>
			</ol>
			<p class="callout-heading">Important note</p>
			<p class="callout">For those on a Mac, you can follow<a id="_idIndexMarker542"/> the instructions given here in order to install OpenSSL and add it to your <span class="No-Break">path: </span><a href="https://developers.facebook.com/docs/facebook-login/android/advanced"><span class="No-Break">https://developers.facebook.com/docs/facebook-login/android/advanced</span></a><span class="No-Break">.</span></p>
			<div>
				<div id="_idContainer238" class="IMG---Figure">
					<img src="image/B18868_08_14.jpg" alt="Figure 8.14: OpenSSL download link"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.14: OpenSSL download link</p>
			<p>Once it’s downloaded, install the program with the default options, as shown in the <span class="No-Break">following screenshot:</span></p>
			<div>
				<div id="_idContainer239" class="IMG---Figure">
					<img src="image/B18868_08_15.jpg" alt="Figure 8.15﻿: Installing OpenSSL"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.15: Installing OpenSSL</p>
			<ol>
				<li>Once the installation is <a id="_idIndexMarker543"/>complete, you may uncheck the donation option and click on the <span class="No-Break"><strong class="bold">Finish</strong></span><span class="No-Break"> button.</span></li>
				<li>We then need to add the location of OpenSSL to the path. To do this, press the Windows key <span class="No-Break">on your</span></li>
				<li>keyboard and start typing in <strong class="source-inline">env</strong>, and then select the <strong class="bold">Edit the system </strong><span class="No-Break"><strong class="bold">environment variables</strong></span></li>
				<li>option, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer240" class="IMG---Figure">
					<img src="image/B18868_08_16.jpg" alt="Figure 8.16﻿: Se﻿lecting the ﻿Edit the system environment variables option"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.16: Se<a id="_idTextAnchor271"/>lecting the Edit the system environment variables option</p>
			<ol>
				<li value="5">In the window that pops<a id="_idIndexMarker544"/> up, click the <strong class="bold">Environment Variables...</strong> option at the bottom right. Double-click on the <strong class="bold">Path</strong> option in the <strong class="bold">System variables </strong>section and then, from that menu, click on <strong class="bold">New</strong>. From there, put in the location of OpenSSL. For me, it was <span class="No-Break"><strong class="source-inline">C:\Program Files\OpenSSL-Win64\bin</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer241" class="IMG---Figure">
					<img src="image/B18868_08_17.jpg" alt="Figure 8.17﻿: Editing the environmental variable for the path"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.17: Editing the environmental variable for the path</p>
			<ol>
				<li value="6">Then, click on <strong class="bold">New</strong> one <a id="_idIndexMarker545"/>more time and add the path to the JDK tools. In my case, it was  <span class="No-Break"><strong class="source-inline">C:\Program Files\Unity\Hub\Editor\2022.1.0b16\Editor\Data\PlaybackEngines\AndroidPlayer\OpenJDK\bin</strong></span><span class="No-Break">.</span></li>
				<li>Click on the <strong class="bold">OK</strong> button and then the <strong class="bold">OK</strong> button in the <strong class="bold">Environmental </strong><span class="No-Break"><strong class="bold">Variables</strong></span><span class="No-Break"> window.</span></li>
				<li>Once both options have been added, close your Unity project and restart your computer. Once Unity reopens, you may have to wait for the <strong class="bold">Resolving Android Dependencies</strong> menu to complete, but once it finishes, you should be able to see the <strong class="bold">Facebook Settings </strong>(<strong class="bold">Facebook | Edit Settings</strong>) menu working correctly and giving us a value under <strong class="bold">Debug Android Key </strong><span class="No-Break"><strong class="bold">Hash</strong></span><span class="No-Break"> </span><span class="No-Break"><strong class="bold">[?]</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer242" class="IMG---Figure">
					<img src="image/B18868_08_18.jpg" alt="Figure 8.18﻿: Debug Android Key Hash"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.18: Debug Android Key Hash</p>
			<ol>
				<li value="9">It is also required for calls to certain APIs to utilize a client token, so we will also get one of them. To do so, go back to your project’s dashboard by going to <strong class="bold">Facebook | </strong><span class="No-Break"><strong class="bold">Developers Page</strong></span><span class="No-Break">.</span></li>
				<li>Once the dashboard has loaded, go to <strong class="bold">Settings | Advanced | Security | Client Token</strong>. Copy the <strong class="bold">Client token</strong> value and then go back to the Unity Editor and paste it back into <strong class="bold">Facebook Settings</strong> <span class="No-Break">in </span><span class="No-Break"><strong class="bold">Inspector</strong></span><span class="No-Break">.</span></li>
			</ol>
			<p>This means that our setup of the Facebook SDK <span class="No-Break">is complete!</span></p>
			<ol>
				<li value="11">Depending on the <a id="_idIndexMarker546"/>platform you wish to deploy to, go to the following websites and complete the <span class="No-Break">tasks listed:</span><ul><li>For Android, check <span class="No-Break">out </span><a href="https://developers.facebook.com/docs/unity/getting-started/android"><span class="No-Break">https://developers.facebook.com/docs/unity/getting-started/android</span></a></li><li>For iOS, check <span class="No-Break">out </span><a href="https://developers.facebook.com/docs/unity/getting-started/ios"><span class="No-Break">https://developers.facebook.com/docs/unity/getting-started/ios</span></a></li></ul></li>
			</ol>
			<p>Now that we have set that up, we can start adding to it by first allowing our game to be logged in to <span class="No-Break">using Facebook.</span></p>
			<h1 id="_idParaDest-103">Logging in to ou<a id="_idTextAnchor272"/>r <a id="_idTextAnchor273"/><a id="_idTextAnchor274"/><a id="_idTextAnchor275"/>game via Facebook</h1>
			<p>One of the things we <a id="_idIndexMarker547"/>can do <a id="_idIndexMarker548"/>when using the Facebook API is to allow our users to log in to the game using their Facebook account. Then, we can use their name and image automatically within our project. The following steps show us how to <span class="No-Break">achieve this:</span></p>
			<ol>
				<li>Let’s first open up our <strong class="bold">Main Menu</strong> level by going to the <strong class="bold">Project</strong> window, opening the <strong class="source-inline">Assets/Scenes</strong> folder, and then double-clicking on the <span class="No-Break"><strong class="source-inline">MainMenu</strong></span><span class="No-Break"> file.</span></li>
				<li>From there, let’s click on the <strong class="bold">2D</strong> button to go into 2D mode if you haven’t done so previously. What we will do is replace the original menu and instead have a button for players to log in via Facebook, or play as a guest when the <span class="No-Break">game starts.</span></li>
				<li>Go to the <strong class="bold">Hierarchy</strong> window, select the <strong class="bold">Canvas - Scale Physical</strong> object, and expand it and the <strong class="bold">Safe Area Holder</strong> child. Select the <strong class="bold">Panel</strong> child and rename it <span class="No-Break"><strong class="source-inline">Menu Options</strong></span><span class="No-Break">.</span></li>
				<li>Then, select the <strong class="bold">Menu Options</strong> object in the <strong class="bold">Hierarchy</strong> window and duplicate it by pressing <em class="italic">Ctrl + D</em>. Then, rename the newly created <strong class="source-inline">Facebook Login</strong> object. Select the <strong class="bold">Menu Options</strong> game object again and then disable it by going to the <strong class="bold">Inspector</strong> tab and clicking on the checkmark beside <span class="No-Break">its name:</span></li>
			</ol>
			<div>
				<div id="_idContainer243" class="IMG---Figure">
					<img src="image/B18868_08_19.jpg" alt="Figure 8.19: Creating the Facebook Login menu"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.19: Creating the Facebook Login menu</p>
			<p>We will have the <strong class="bold">Facebook Login</strong> object turn the menu on <span class="No-Break">when needed.</span></p>
			<ol>
				<li value="5">Next, open the <strong class="bold">Facebook Login</strong> options and remove the <strong class="bold">Restore Button </strong>and <strong class="bold">Remove Ads Button</strong> objects. Click on the <strong class="bold">Play Button</strong>, under <strong class="bold">Rect Transform,</strong> change the <strong class="bold">Width</strong> to <strong class="source-inline">225</strong>, then right-click on the <strong class="bold">Button </strong>component, and then select the <strong class="bold">Reset</strong> option to remove its original <strong class="bold">On Click ()</strong> <span class="No-Break">functionality.</span></li>
				<li>Duplicate the <strong class="bold">Play <a id="_idTextAnchor276"/>Button</strong> object by pressing the <em class="italic">Ctrl + D</em> keys. Then, name those two buttons <strong class="source-inline">Facebook Login Button</strong> and <strong class="source-inline">Continue as Guest Button</strong>. Also, change the <strong class="bold">Text </strong>property of both of these buttons to <strong class="source-inline">Facebook Login</strong> and <strong class="source-inline">Continue </strong><span class="No-Break"><strong class="source-inline">as Guest</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer244" class="IMG---Figure">
					<img src="image/B18868_08_20.jpg" alt="Figure 8.20: Facebook Login Button setup"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.20: Facebook Login Button setup</p>
			<ol>
				<li value="7">Now that we have the buttons <a id="_idIndexMarker549"/>working <a id="_idIndexMarker550"/>correctly, we need to write the script that will allow us to log in. Go to the <strong class="source-inline">Scripts</strong> folder and open our <strong class="source-inline">MainMenuBehaviour</strong> script. We will use the <strong class="source-inline">List</strong> class to hold the permissions we want in order to access Facebook and the content of the <strong class="source-inline">FB</strong> class in the <span class="No-Break">Facebook SDK.</span></li>
				<li>So, to do that, we’ll first add the following to the top of the <span class="No-Break"><strong class="source-inline">MainMenuBehaviour</strong></span><span class="No-Break"> script:</span><pre class="source-code">
using UnityEngine;
using UnityEngine.SceneManagement; // LoadScene
using System.Collections.Generic; // List using Facebook.Unity; // FB</pre></li>
				<li>Then, add the following variables to the <span class="No-Break"><strong class="source-inline">MainMenuBehaviour</strong></span><span class="No-Break"> class:</span><pre class="source-code">
[Header("Object References")] 
public GameObject mainMenu; 
public GameObject facebookLogin;</pre></li>
				<li>Now, add the following code within the <span class="No-Break"><strong class="source-inline">MainMenuBehaviour</strong></span><span class="No-Break"> class:</span><pre class="source-code">
#region Facebook
#endregion</pre></li>
			</ol>
			<p>Inside this region, we are going to add several different methods, starting with some methods dealing with initializing the <span class="No-Break">Facebook APIs:</span></p>
			<pre class="source-code">
    public void Awake()
    {
        /* We only call FB Init once, so check if it
        /* has been called already */
        if (!FB.IsInitialized)
        {
            FB.Init(OnInitComplete, OnHideUnity);
        }
    }</pre>
			<p>In this case, the <strong class="source-inline">Awake</strong> method calls the <strong class="source-inline">FB.Init</strong> function, which takes in two parameters, both of which are <a id="_idIndexMarker551"/>delegates, or <a id="_idIndexMarker552"/>functions to call whenever the initialization is complete and whenever the app is hidden or no longer the currently focused one. The definition of both those functions is <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
/// &lt;summary&gt;
/// Once initialized, will inform if logged in on Facebook
/// &lt;/summary&gt;
private void OnInitComplete()
{
    if(FB.IsInitialized)
    {
        if (FB.IsLoggedIn)
        {
            print("Logged into Facebook");
            /* Close Login and open Main Menu */
            ShowMainMenu();
        }
    }
    else
    {
        print("Failed to init Facebook SDK; open as
            guest");
        ShowMainMenu();
    }
}
    /// &lt;summary&gt;
    /// Called whenever Unity loses focus
    /// &lt;/summary&gt;
    /// &lt;param name="active"&gt;If the game is currently
        active&lt;/param&gt;
    private void OnHideUnity(bool active)
    {
        /* Set TimeScale based on if the game is
           paused */
        Time.timeScale = (active) ? 1 : 0;
    }</pre>
			<p>In this case, we are going to print a message to the screen if we are logged in to Facebook and we will display the main menu. Likewise, if we ever lose focus of Unity, we are going to pause <span class="No-Break">the game.</span></p>
			<p>We have some other final functions that we <a id="_idIndexMarker553"/>need to<a id="_idIndexMarker554"/> add for our final implementation, which we will <span class="No-Break">add next:</span></p>
			<pre class="source-code">
/// &lt;summary&gt;
/// Attempts to log in on Facebook
/// &lt;/summary&gt;
public void FacebookLogin()
{
    List&lt;string&gt; permissions = new List&lt;string&gt;();
    /* Add permissions we want to have here */
    permissions.Add("public_profile");
    FB.LogInWithReadPermissions(permissions,
        FacebookCallback);
}
/// &lt;summary&gt;
/// Called once facebook has logged in, or not
/// &lt;/summary&gt;
/// &lt;param name="result"&gt;The result of our login request&lt;/param&gt;
private void FacebookCallback(IResult result)
{
    if (result.Error == null)
    {
        OnInitComplete();
    }
    else
    {
        print(result.Error);
    }
}
public void ShowMainMenu()
{
    if (facebookLogin != null &amp;&amp; mainMenu != null)
    {
        facebookLogin.SetActive(false);
        mainMenu.SetActive(true);
    }
}</pre>
			<p>In this case, we are accessing the player’s public profile, which contains information such as their name and their <span class="No-Break">profile picture.</span></p>
			<p class="callout-heading">Note</p>
			<p class="callout">For all of the <a id="_idTextAnchor277"/>properties that we can get access to, check <span class="No-Break">out </span><a href="https://developers.facebook.com/docs/facebook-login/permissions#reference-public_profile"><span class="No-Break">https://developers.facebook.com/docs/facebook-login/permissions#reference-public_profile</span></a><span class="No-Break">.</span></p>
			<ol>
				<li value="11">Save your script and<a id="_idIndexMarker555"/> go to <a id="_idIndexMarker556"/>the <strong class="bold">Facebook Login</strong> button and change the button’s <strong class="bold">OnClick()</strong> action to now call your function by clicking on the + button and then dragging and dropping the <strong class="bold">Main Menu</strong> object in and then selecting <strong class="bold">Main Menu Behaviour</strong> | <strong class="bold">Facebook </strong><span class="No-Break"><strong class="bold">Login</strong></span><span class="No-Break"> instead:</span></li>
			</ol>
			<div>
				<div id="_idContainer245" class="IMG---Figure">
					<img src="image/B18868_08_21.jpg" alt="Figure 8.21: Calling the FacebookLogin function"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.21: Calling the FacebookLogin function</p>
			<ol>
				<li value="12">Then, on the <strong class="bold">Continu<a id="_idTextAnchor278"/>e as Guest Button</strong> under the <strong class="bold">Button </strong>component, go to the <strong class="bold">On Click ()</strong> section and then click on the <strong class="bold">+</strong> button. Drag and drop the <strong class="bold">Main Menu</strong> object into the slot below the <strong class="bold">Runtime Only</strong> dropdown. Afterward, have the button call the <span class="No-Break"><strong class="source-inline">MainMenuBehaviour.ShowMainMenu</strong></span><span class="No-Break"> function.</span></li>
			</ol>
			<div>
				<div id="_idContainer246" class="IMG---Figure">
					<img src="image/B18868_08_22.jpg" alt="Figure 8.22: Setup for Continue ﻿as Guest Button"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.22: Setup for Continue as Guest Button</p>
			<ol>
				<li value="13">Finally, we will need to set the variables we have created. Select the <strong class="bold">Main Menu</strong> object in the <strong class="bold">Hierarchy</strong> window and then set the <strong class="bold">Main Menu</strong> and <strong class="bold">Facebook </strong><span class="No-Break"><strong class="bold">Login</strong></span><span class="No-Break"> properties:</span></li>
			</ol>
			<div>
				<div id="_idContainer247" class="IMG---Figure">
					<img src="image/B18868_08_23.jpg" alt="Figure 8.23: Settin﻿g the Main Menu Behaviour properties"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.23: Settin<a id="_idTextAnchor279"/>g the Main Menu Behaviour properties</p>
			<p>Ensure that <a id="_idIndexMarker557"/>the <strong class="bold">Facebook Login</strong> is set<a id="_idIndexMarker558"/> to the <strong class="bold">panel</strong> object holding <span class="No-Break">both buttons.</span></p>
			<ol>
				<li value="14">Save your scene, start the game, and then click on the <strong class="bold">Facebook </strong><span class="No-Break"><strong class="bold">Login</strong></span><span class="No-Break"> button:</span></li>
			</ol>
			<div>
				<div id="_idContainer248" class="IMG---Figure">
					<img src="image/B18868_08_24.jpg" alt="Figure 8.24: User Access Token Request Screen"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.24: User Access Token Request Screen</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">To see everything properly within the editor, it’s a good idea to maximize the <strong class="bold">Game </strong>tab, which you can do by right-clicking on the <strong class="bold">Game </strong>tab and selecting <strong class="bold">Maximize </strong>or by checking the <strong class="bold">Maximize On Play </strong>option on <span class="No-Break">the toolbar.</span></p>
			<p>Now, you should see<a id="_idIndexMarker559"/> a<a id="_idIndexMarker560"/> menu asking for a user access token, a value that every profile has and we can associate it with. We’ll need to go to Facebook to get that, so that’s what we’ll <span class="No-Break">do next.</span></p>
			<ol>
				<li>Click on the <strong class="bold">Find Access Token</strong> page, and a web browser will open with a <span class="No-Break">new page:</span></li>
			</ol>
			<div>
				<div id="_idContainer249" class="IMG---Figure">
					<img src="image/B18868_08_25.jpg" alt="Figure 8.25: Access Token Tool page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.25: Access Token Tool page</p>
			<ol>
				<li value="2">You’ll then need to<a id="_idIndexMarker561"/> click<a id="_idIndexMarker562"/> on the <strong class="bold">need to grant permissions</strong> link and then, on <strong class="bold">Generate Access Token</strong>, click <strong class="bold">Continue</strong> and you’ll see a string of characters under <strong class="bold">User Token</strong>. Copy the string, paste it into the <strong class="bold">User Access Token</strong> property in Unity, and then click on the <strong class="bold">Send </strong><span class="No-Break"><strong class="bold">Success</strong></span><span class="No-Break"> button<a id="_idTextAnchor280"/>.</span></li>
			</ol>
			<p class="callout-heading">Note</p>
			<p class="callout">If you get an error when granting permissions stating <strong class="bold">Future off- Facebook activity for this app is off</strong>, that means that your Facebook settings do not allow your Facebook profile to be used outside of Facebook. In order to use Facebook to log in, your account must have Off-Facebook tracking enabled. To do so, you can go to <a href="https://www.facebook.com/off_facebook_activity">https://www.facebook.com/off_facebook_activity</a> and ensure the <strong class="bold">Future off- Facebook Activity </strong>value is set to ON to be able to log in. We will be allowing users to log in as a guest if you’d prefer not to <span class="No-Break">be tracked.</span></p>
			<p>Now, you’ll note that <a id="_idIndexMarker563"/>the<a id="_idIndexMarker564"/> Console has printed that we’ve logged in to Facebook and that the menu closes when we’ve sent <span class="No-Break">the key:</span></p>
			<div>
				<div id="_idContainer250" class="IMG---Figure">
					<img src="image/B18868_08_26.jpg" alt="Figure 8.26: Logged in﻿ to Faceb﻿ook"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.26: Logged in to Faceb<a id="_idTextAnchor281"/>ook</p>
			<p class="callout-heading">Note</p>
			<p class="callout">For more information on user access tokens, check <span class="No-Break">out </span><a href="https://developers.facebook.com/docs/facebook-login/access-tokens/#usertokens"><span class="No-Break">https://developers.facebook.com/docs/facebook-login/access-tokens/#usertokens</span></a><span class="No-Break">.</span></p>
			<p>Now that we have <a id="_idIndexMarker565"/>the <a id="_idIndexMarker566"/>ability to log in to Facebook, we can now use the information t<a id="_idTextAnchor282"/>hat we get from Facebook in order to customize our game, which is what we will <span class="No-Break">do <a id="_idTextAnchor283"/>next.</span></p>
			<h1 id="_idParaDest-104"><a id="_idTextAnchor284"/>Displaying a Facebook name and profile picture</h1>
			<p>A good thing to do <a id="_idIndexMarker567"/>is to personalize our game to fit our players. So, with that, once the player logs in, we will welcome them and display their image on the screen by following <span class="No-Break">these steps:</span></p>
			<ol>
				<li>Go to the <strong class="source-inline">MainMenuBehaviour</strong> script once again. From there, we’ll need to add a new <strong class="source-inline">using</strong> statement to display an image and change the text we need in order to use Unity’s UI system <span class="No-Break">and TextMeshPro:</span><pre class="source-code">
using UnityEngine.UI; // Image
using TMPro; //TextMeshProUGUI</pre></li>
				<li>We will then need to add two <span class="No-Break">new variables:</span><pre class="source-code">
[Tooltip("Will display the user's Facebook profile pic")] 
public Image profilePic;
[Tooltip("The text object used to display the greeting")] 
public TextMeshProUGUI greeting;</pre></li>
			</ol>
			<p>These variables will hold the information that we wish to display once we get it <span class="No-Break">from Fac<a id="_idTextAnchor285"/>ebook.</span></p>
			<ol>
				<li value="3">Afterward, we will update the <strong class="source-inline">ShowMainMenu</strong> function and add some new functions <span class="No-Break">to </span><span class="No-Break"><a id="_idIndexMarker568"/></span><span class="No-Break">use:</span><pre class="source-code">
public void ShowMainMenu()
{
    if (facebookLogin != null &amp;&amp; mainMenu != null)
    {
        facebookLogin.SetActive(false);
        mainMenu.SetActive(true);
<strong class="bold">        if (FB.IsLoggedIn)</strong>
<strong class="bold">        {</strong>
<strong class="bold">            </strong><strong class="bold">/* Get information from Facebook profile</strong>
<strong class="bold">            */</strong>
<strong class="bold">            FB.API("/me?fields=name",</strong>
<strong class="bold">                    HttpMethod.GET,</strong>
<strong class="bold">                    SetName);</strong>
<strong class="bold">            FB.API("/me/picture?width=256&amp;height=256",</strong>
<strong class="bold">                    HttpMethod.GET,</strong>
<strong class="bold">                    SetProfilePic);</strong>
<strong class="bold">        }</strong>
    }
}</pre></li>
			</ol>
			<p>The <strong class="source-inline">FB.API</strong> function makes a call to Facebook’s Graph API to get data or take an action on the user’s behalf and allows us to get the information that we have permission to as defined earlier. In our case, we are looking for the name and the profile picture of the user and calling the <strong class="source-inline">SetName</strong> and <strong class="source-inline">SetProfilePic</strong> functions, respectively, once we have obtained <span class="No-Break">that data.</span></p>
			<p>However, we currently do not have <strong class="source-inline">SetName</strong> and <strong class="source-inline">SetProfilePic</strong> functions, so we will go ahead and add <span class="No-Break">them now.</span></p>
			<ol>
				<li value="4">Add the following <a id="_idIndexMarker569"/>additional code within the <strong class="source-inline">Facebook</strong> region of <span class="No-Break">the script:</span><pre class="source-code">
private void SetName(IResult result)
{
    if (result.Error != null)
    {
        print(result.Error); return;
    }
    string playerName =
        result.ResultDictionary["name"].ToString();
    if (greeting != null)
    {
        greeting.text = "Hello, " + playerName + "!";
        greeting.gameObject.SetActive(true);
    }
}
private void SetProfilePic(IGraphResult result)
{
    if (result.Error != null)
    {
        print(result.Error); return;
    }
    // Variable setup
    int texWidth = result.Texture.width;
    int texHeight = result.Texture.height;
    Rect rect = new Rect(0, 0, texWidth, texHeight);
    Vector2 pivot = Vector2.zero;
    Texture2D texture = result.Texture;
    // Create the profile pic
    Sprite fbImage = Sprite.Create(texture, rect,
        pivot);
    if (profilePic != null)
    {
        profilePic.sprite = fbImage;
        profilePic.gameObject.SetActive(true);
    }
}</pre></li>
			</ol>
			<p>After getting the <a id="_idIndexMarker570"/>data, we will modify the image or string to display the new data that <span class="No-Break">we retrieved.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">For more information on the <strong class="source-inline">FB.API</strong> function, check <span class="No-Break">out </span><a href="https://developers.facebook.com/docs/unity/reference/current/FB.API"><span class="No-Break">https://developers.facebook.com/docs/unity/reference/current/FB.API</span></a><span class="No-Break">.</span></p>
			<ol>
				<li value="5">Now, we will need to actually create the text and image we want to display. Open up the <strong class="bold">Canvas - Scale w/Screen</strong> object in the <strong class="bold">Hierarchy</strong> tab and then rename the <strong class="bold">Panel</strong> child object <strong class="source-inline">Safe Area Holder</strong>. Then, right-click on the <strong class="bold">Safe Area Holder</strong> child object and select <strong class="bold">UI</strong> | <strong class="bold">Panel</strong>. Rename this object <span class="No-Break"><strong class="source-inline">Welcome Profile</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer251" class="IMG---Figure">
					<img src="image/B18868_08_27.jpg" alt="Figure 8.27: Creating ﻿Welcome Profile"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.27: Creating Welcome Profile</p>
			<p>This will act as a <a id="_idIndexMarker571"/>container for all of our information for <span class="No-Break">the player.</span></p>
			<ol>
				<li value="6">With the <strong class="bold">Welcome Profile</strong> object still selected, add a <strong class="bold">Horizontal Layout Group</strong> with <strong class="bold">Padding</strong> and <strong class="bold">Spacing</strong> both set to <strong class="source-inline">10</strong>. From there, change <strong class="bold">Child Alignment</strong> to <strong class="bold">Lower Center</strong> and then check <strong class="bold">Width</strong> and <strong class="bold">Height</strong> under the <strong class="bold">Control Child Size</strong> property. Then, add a <strong class="bold">Content Size Fitter</strong> component and change the <strong class="bold">Horizontal Fit</strong> and <strong class="bold">Vertical Fit</strong> size to <strong class="bold">Preferred Size</strong>. Finally, in the <strong class="bold">Anchor Presets</strong> menu, hold down <em class="italic">Alt + Shift</em> and <span class="No-Break">select </span><span class="No-Break"><strong class="bold">Bottom-center</strong></span><span class="No-Break">.</span></li>
				<li>Now, select the <strong class="bold">Welcome Profile</strong> object in the <strong class="bold">Hierarchy</strong> tab, right-click on it, and select <strong class="bold">UI </strong>| <strong class="bold">Text - </strong><span class="No-Break"><strong class="bold">TextMeshPro</strong></span><span class="No-Break">.</span></li>
				<li>Rename the next <strong class="bold">Text</strong> <span class="No-Break">object </span><span class="No-Break"><strong class="source-inline">Greeting</strong></span><span class="No-Break">.</span></li>
				<li>Then, adjust <strong class="bold">Text</strong> to <strong class="source-inline">Welcome</strong> and the size to something larger, such as <strong class="source-inline">50</strong>, change the <strong class="bold">Vertex Color</strong> to black, and then adjust <strong class="bold">Alignment</strong> to be centered vertically <span class="No-Break">and horizontally:</span></li>
			</ol>
			<div>
				<div id="_idContainer252" class="IMG---Figure">
					<img src="image/B18868_08_28.jpg" alt="Figure 8.28: Greeting Text setup"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.28: Greeting Text setup</p>
			<ol>
				<li value="10">Likewise, let’s<a id="_idIndexMarker572"/> next right-click on <strong class="bold">Welcome Profile</strong> again, and this time select <strong class="bold">UI | Image</strong>. You may notice that, by default, we are unable to set the image size due to the parent object having a <strong class="bold">Horizontal Layout Group</strong>. To override this default, select the image object and add a <strong class="bold">Layout Element</strong> component to it. From there, set <strong class="bold">Min Width</strong> and <strong class="bold">Min Height</strong> to <strong class="source-inline">256</strong>. Afterward, check the <strong class="bold">Preferred Width</strong> and <strong class="bold">Preferred Height</strong> properties as well and set them to <strong class="source-inline">256</strong> as well, because Facebook may give us images larger than this, and this will keep the images smaller. The <strong class="bold">Layout Element (Script)</strong> component is great for allowing you to override things that <strong class="bold">LayoutGroups</strong> will do by default and can be useful if you’re not getting exactly what you want from the <span class="No-Break">default behavior.</span></li>
			</ol>
			<p class="callout-heading">Note</p>
			<p class="callout">For more information <a id="_idIndexMarker573"/>on the <strong class="bold">Layout Element (Script) </strong>compon<a href="https://developers.facebook.com/docs/unity/">ent, ch</a>eck <span class="No-Break">out </span><a href="https://docs.unity3d.com/Manual/script-LayoutElement.html"><span class="No-Break">https://docs.unity3d.com/Manual/script-LayoutElement.html</span></a><span class="No-Break">.</span></p>
			<ol>
				<li value="11">Next, change the name of the <strong class="bold">Image</strong> object to <strong class="source-inline">Profile Pic</strong> and then reorder it so it is above the <strong class="bold">Greeting</strong> object in <span class="No-Break">the </span><span class="No-Break"><strong class="bold">Hierarchy</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer253" class="IMG---Figure">
					<img src="image/B18868_08_29.jpg" alt="Figure 8.29: Profile Pic setup"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.29: Profile Pic setup</p>
			<p>Reordering objects<a id="_idIndexMarker574"/> with a <strong class="bold">Horizontal Layout Group</strong> modifies their <span class="No-Break">placement order.</span></p>
			<p>If you change the resolution to a much smaller size, the image is drawn on top of our menu. This is possible due to both canvases being told that they have the same priority in being drawn, similar to how Z-fighting works for 2D games. To fix potential problems<a id="_idIndexMarker575"/> in the future, we will instead put the scaling canvas as the <span class="No-Break">backgrou<a id="_idTextAnchor286"/>nd element.</span></p>
			<ol>
				<li value="12">To do this, we will select <strong class="bold">Canvas - Scale Physical</strong>, and under the <strong class="bold">Canvas </strong>component, change <strong class="bold">Sort Order</strong> <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">1</strong></span><span class="No-Break">.</span></li>
				<li>Now, dive back into the <strong class="bold">Main Menu</strong> object and set the <strong class="bold">Greeting</strong> and <strong class="bold">Profile Pic</strong> properties in the <span class="No-Break"><strong class="bold">MainMenuBehaviour</strong></span><span class="No-Break"> component.</span></li>
				<li>Finally, since we don’t want them visible when the game starts, let’s turn off<strong class="bold"> Greeting</strong> and our <strong class="bold">Profile Pic</strong> object <span class="No-Break">as well.</span></li>
				<li>Save our game, and <a id="_idIndexMarker576"/>then start it up again by going through the appropriate <span class="No-Break">login information:</span></li>
			</ol>
			<div>
				<div id="_idContainer254" class="IMG---Figure">
					<img src="image/B18868_08_30.jpg" alt="Figure 8.30: Logged into Facebook"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.30: Logged into Facebook</p>
			<p>As you can see, we are logged in and you can see my name, but I have a profile pic that isn’t quite my actual profile pic. This is because it is using my gaming profile. If we want to use my actual Facebook profile pic, we have to add another permission to <span class="No-Break">our app:</span></p>
			<ol>
				<li>Back in Graph API Explorer, go back to the <strong class="bold">Permissions</strong> section and, under <strong class="bold">Add a Permission</strong>, click on the dropdown and <span class="No-Break">select </span><span class="No-Break"><strong class="bold">gaming_user_picture</strong></span><span class="No-Break">.</span></li>
			</ol>
			<div>
				<div id="_idContainer255" class="IMG---Figure">
					<img src="image/B18868_08_31.jpg" alt="Figure 8.31: Adding the user picture option"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.31: Adding the user picture option</p>
			<ol>
				<li value="2">From there, click<a id="_idIndexMarker577"/> on <strong class="bold">Generate Access Token</strong> again and get a new access token that share your actual profile information. Note that the user will have to choose to share this info <span class="No-Break">with you.</span></li>
			</ol>
			<div>
				<div id="_idContainer256" class="IMG---Figure">
					<img src="image/B18868_08_32.jpg" alt="Figure 8.32: Choose how you log in to Facebook"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.32: Choose how you log in to Facebook</p>
			<p>Now use your new access token and try to run <span class="No-Break">the game.</span></p>
			<div>
				<div id="_idContainer257" class="IMG---Figure">
					<img src="image/B18868_08_33.jpg" alt="Figure 8.33: Logged in﻿ to actual Facebook account"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.33: Logged in to actual Facebook account</p>
			<p>As you can see in the preceding screenshot, I retrieved my actual Facebook info once I <span class="No-Break">logged in.</span></p>
			<p>Facebook is still an incredibly useful platform for game developers and can help personalize a user’s gameplay experience. This can be easily expanded to utilize several other pieces of data that Facebook has and share content with all of your <span class="No-Break">user’s friends.</span></p>
			<p>For those that are just looking for the ability to have the ability to sign in to your game to authenticate<a id="_idIndexMarker578"/> players for specific platforms, there are several other options available that you can use. For details on that, check <span class="No-Break">out </span><a href="https://docs.unity.com/authentication/SettingupExternalIdentityProviders.html"><span class="No-Break">https://docs.unity.com/authentication/SettingupExternalIdentityProvi<span id="_idTextAnchor287"/>ders.html</span></a><span class="No-Break">.</span></p>
			<h1 id="_idParaDest-105"><a id="_idTextAnchor288"/>Summary</h1>
			<p>In this chapter, we were introduced to some of the potential ways that we can share our game with others, as well as personalizing our game experiences and utilizing the functionality that social media provides us with. We started off by adding a simple score system and then allowed users to share their scores via Twitter. We then set up the Facebook SDK, making it so that we can log in to it to play our game and retrieve information about our users, which we can use to customize their <span class="No-Break">gameplay experience.</span></p>
			<p>Now that we have people playing our game, we want them to keep coming back and playing over time. One of the easiest ways to do this is through the use of notifications, which we will look at in the <span class="No-Break">next chapter.</span></p>
		</div>
	

		<div id="_idContainer259" class="Content">
			<h1 id="_idParaDest-106"><a id="_idTextAnchor289"/>Part 3: Game Feel/Polish</h1>
			<p>In this part of the book, we will focus on adding polish to your game to enhance the overall player experience. By the end of this part, you will have all the tools and knowledge necessary to take your game to the next level by polishing it and the <span class="No-Break">player experience.</span></p>
			<p>This part has the <span class="No-Break">following chapters:</span></p>
			<ul>
				<li><a href="B18868_09.xhtml#_idTextAnchor290"><em class="italic">Chapter 9</em></a>, <em class="italic">Keeping Players Involved with Notifications</em></li>
				<li><a href="B18868_10.xhtml#_idTextAnchor313"><em class="italic">Chapter 10</em></a>, <em class="italic">Using Unity Analytics</em></li>
				<li><a href="B18868_11.xhtml#_idTextAnchor339"><em class="italic">Chapter 11</em></a>, <em class="italic">Remote Config</em></li>
				<li><a href="B18868_12.xhtml#_idTextAnchor347"><em class="italic">Chapter 12</em></a>, <em class="italic">Improving Game Feel</em></li>
				<li><a href="B18868_13.xhtml#_idTextAnchor369"><em class="italic">Chapter 13</em></a>, <em class="italic">Building a Release Copy of Our Game</em></li>
				<li><a href="B18868_14.xhtml#_idTextAnchor410"><em class="italic">Chapter 14</em></a>, <em class="italic">Submitting Games to App Stores</em></li>
				<li><a href="B18868_15.xhtml#_idTextAnchor453"><em class="italic">Chapter 15</em></a>, <em class="italic">Augmented Reality</em></li>
			</ul>
		</div>
		<div>
			<div id="_idContainer260" class="Basic-Graphics-Frame">
			</div>
		</div>
		<div>
			<div id="_idContainer261">
			</div>
		</div>
	</body></html>