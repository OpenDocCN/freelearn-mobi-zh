<html><head></head><body>
<div id="_idContainer138">
<h1 class="chapter-number" id="_idParaDest-121"><a id="_idTextAnchor125"/><span class="koboSpan" id="kobo.1.1">9</span></h1>
<h1 id="_idParaDest-122"><a id="_idTextAnchor126"/><span class="koboSpan" id="kobo.2.1">Animating Strokes around Shapes</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In this project, we will take three images, create outlines around them, and then animate strokes along those outlines. </span><span class="koboSpan" id="kobo.3.2">A stroke is a line that follows the outline (or contours) of a shape, which we can give any color and thickness and animate to move around </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">the image.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">To do this, you’ll learn how to convert bitmap images into vector images using the Inkscape software, and then take those vectors and convert them into Swift code using Sketch and Kite. </span><span class="koboSpan" id="kobo.5.2">We will then insert this code back into Xcode so that we can start animating </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">our project.</span></span></p>
<p><span class="koboSpan" id="kobo.7.1">The following are the objectives for </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">this project:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.9.1">Converting images into </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">Swift code</span></span></li>
<li><span class="koboSpan" id="kobo.11.1">Animating images with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.12.1">stroke</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.13.1"> modifier</span></span></li>
</ul>
<h1 id="_idParaDest-123"><a id="_idTextAnchor127"/><span class="koboSpan" id="kobo.14.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.15.1">You can download the resources and finished project from the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.16.1">Chapter 9</span></strong></span><span class="koboSpan" id="kobo.17.1"> folder on </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">GitHub: </span></span><a href="https://github.com/PacktPublishing/Animating-SwiftUI-Applications"><span class="No-Break"><span class="koboSpan" id="kobo.19.1">https://github.com/PacktPublishing/Animating-SwiftUI-Applications</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.20.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.21.1">You will also need </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.23.1">The Remove Background software, which is a free online tool you can access </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">here: </span></span><a href="https://www.remove.bg/upload"><span class="No-Break"><span class="koboSpan" id="kobo.25.1">https://www.remove.bg/upload</span></span></a></li>
<li><span class="koboSpan" id="kobo.26.1">Inkscape, which is free and you can install </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">here: </span></span><a href="https://inkscape.org/release/inkscape-1.2.1/"><span class="No-Break"><span class="koboSpan" id="kobo.28.1">https://inkscape.org/release/inkscape-1.2.1/</span></span></a></li>
<li><span class="koboSpan" id="kobo.29.1">Sketch, which you can install </span><span class="No-Break"><span class="koboSpan" id="kobo.30.1">here: </span></span><a href="https://www.sketch.com/switch-to-sketch/"><span class="No-Break"><span class="koboSpan" id="kobo.31.1">https://www.sketch.com/switch-to-sketch/</span></span></a></li>
<li><span class="koboSpan" id="kobo.32.1">Kite, which you can install </span><span class="No-Break"><span class="koboSpan" id="kobo.33.1">here: </span></span><a href="https://kiteapp.co"><span class="No-Break"><span class="koboSpan" id="kobo.34.1">https://kiteapp.co</span></span></a></li>
</ul>
<h1 id="_idParaDest-124"><a id="_idTextAnchor128"/><span class="koboSpan" id="kobo.35.1">Converting images into Swift code</span></h1>
<p><span class="koboSpan" id="kobo.36.1">In order to create</span><a id="_idIndexMarker475"/><span class="koboSpan" id="kobo.37.1"> the three outlines</span><a id="_idIndexMarker476"/><span class="koboSpan" id="kobo.38.1"> that we need, we first have to convert images into vectors and then convert those vectors into Swift code. </span><span class="koboSpan" id="kobo.38.2">Why do we have to convert an image into Swift code? </span></p>
<p><span class="koboSpan" id="kobo.39.1">Well, in order to place an animating stroke around an image, we need a path for the animation to follow. </span><span class="koboSpan" id="kobo.39.2">When the image has been translated into code, it will then be easy to use Swift to follow the </span><span class="No-Break"><span class="koboSpan" id="kobo.40.1">image outline.</span></span></p>
<p><span class="koboSpan" id="kobo.41.1">However, there’s a problem: bitmaps. </span><span class="koboSpan" id="kobo.41.2">A </span><strong class="bold"><span class="koboSpan" id="kobo.42.1">bitmap</span></strong><span class="koboSpan" id="kobo.43.1">, also called a </span><strong class="bold"><span class="koboSpan" id="kobo.44.1">raster image</span></strong><span class="koboSpan" id="kobo.45.1">, is a graphic that</span><a id="_idIndexMarker477"/><span class="koboSpan" id="kobo.46.1"> is created from different</span><a id="_idIndexMarker478"/><span class="koboSpan" id="kobo.47.1"> colored pixels, which together form an image. </span><span class="koboSpan" id="kobo.47.2">Bitmaps can be very simple, just made up of two colors (those would be black and white), or they can have many thousands or millions of colors that produce photograph-quality images. </span><span class="koboSpan" id="kobo.47.3">Some examples of bitmap formats that you will see use the file extensions PNG, JPEG, and TIFF. </span><span class="koboSpan" id="kobo.47.4">With a bitmap image, there is no defined outline for any code to follow, and thus it cannot have an animating stroke </span><span class="No-Break"><span class="koboSpan" id="kobo.48.1">around it.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.49.1">Vector images</span></strong><span class="koboSpan" id="kobo.50.1">, on the other hand, are images</span><a id="_idIndexMarker479"/><span class="koboSpan" id="kobo.51.1"> created from code that have sharply defined edges and never get blurry like a bitmap when you zoom in on them. </span><span class="koboSpan" id="kobo.51.2">Since they are created with code, we can animate strokes around </span><span class="No-Break"><span class="koboSpan" id="kobo.52.1">those images.</span></span></p>
<p><span class="koboSpan" id="kobo.53.1">If you want to animate a stroke around a bitmap image, there are three main steps that you need </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">to undertake:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.55.1">Removing the background of the image you want </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">to use</span></span></li>
<li><span class="koboSpan" id="kobo.57.1">Vectorizing the image into an </span><span class="No-Break"><span class="koboSpan" id="kobo.58.1">SVG file</span></span></li>
<li><span class="koboSpan" id="kobo.59.1">Translating the SVG file into </span><span class="No-Break"><span class="koboSpan" id="kobo.60.1">Swift code</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.61.1">So, let’s go through those </span><span class="No-Break"><span class="koboSpan" id="kobo.62.1">steps now.</span></span></p>
<h2 id="_idParaDest-125"><a id="_idTextAnchor129"/><span class="koboSpan" id="kobo.63.1">Removing the image backgrounds</span></h2>
<p><span class="koboSpan" id="kobo.64.1">Many images have a white</span><a id="_idIndexMarker480"/><span class="koboSpan" id="kobo.65.1"> or colored background, and in many cases, the background is not needed. </span><span class="koboSpan" id="kobo.65.2">It’s easier to convert images into vectors if they are against a transparent background. </span></p>
<p><span class="koboSpan" id="kobo.66.1">In our project, the images that we will be using are an image of the word “WE,” an image of a heart, and an image of the SwiftUI logo. </span><span class="koboSpan" id="kobo.66.2">We will combine them in Swift so that they say, “We Love SwiftUI,” </span><span class="No-Break"><span class="koboSpan" id="kobo.67.1">like so:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer118">
<span class="koboSpan" id="kobo.68.1"><img alt="Figure 9.1: The images we will use in our project " src="image/B18674_09_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.69.1">Figure 9.1: The images we will use in our project</span></p>
<p><span class="koboSpan" id="kobo.70.1">You can download</span><a id="_idIndexMarker481"/><span class="koboSpan" id="kobo.71.1"> these from the GitHub repository, where you will notice that the backgrounds have already been removed. </span><span class="koboSpan" id="kobo.71.2">However, if you are going to use your own images, you will need to do </span><span class="No-Break"><span class="koboSpan" id="kobo.72.1">this yourself.</span></span></p>
<p><span class="koboSpan" id="kobo.73.1">We already explored how to remove backgrounds in </span><a href="B18674_06.xhtml#_idTextAnchor082"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.74.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.75.1"> when we animated the girl on the swing. </span><span class="koboSpan" id="kobo.75.2">You can refer back to that</span><a id="_idIndexMarker482"/><span class="koboSpan" id="kobo.76.1"> chapter; however, to recap, you can use an online</span><a id="_idIndexMarker483"/><span class="koboSpan" id="kobo.77.1"> tool called Remove Background: </span><a href="https://www.remove.bg/upload"><span class="koboSpan" id="kobo.78.1">https://www.remove.bg/upload</span></a><span class="koboSpan" id="kobo.79.1">. </span><span class="koboSpan" id="kobo.79.2">You just have to click </span><strong class="bold"><span class="koboSpan" id="kobo.80.1">Upload Image</span></strong><span class="koboSpan" id="kobo.81.1"> and choose the one you want to use. </span><span class="koboSpan" id="kobo.81.2">And that’s it – in about 20 seconds, the website’s algorithms will find the background and remove it, leaving only your subject. </span><span class="koboSpan" id="kobo.81.3">Then, all you have to do is download the new image file and you’re good </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">to go.</span></span></p>
<p><span class="koboSpan" id="kobo.83.1">Alternatively, you can use Mac’s Preview app to remove the background, or you can use paid software such as Affinity Designer. </span><span class="koboSpan" id="kobo.83.2">How you decide to remove the background is up to you; experiment and try to see what works best for the image you </span><span class="No-Break"><span class="koboSpan" id="kobo.84.1">are using.</span></span></p>
<p><span class="koboSpan" id="kobo.85.1">Also, although it’s not strictly</span><a id="_idIndexMarker484"/><span class="koboSpan" id="kobo.86.1"> necessary, it’s a good idea to crop your image, as we only want to work with the image and not any surrounding space. </span><span class="koboSpan" id="kobo.86.2">You can do this in pretty much any graphics editing program, including the </span><span class="No-Break"><span class="koboSpan" id="kobo.87.1">Preview app.</span></span></p>
<p><span class="koboSpan" id="kobo.88.1">Now you can proceed to the next step, which is vectorizing </span><span class="No-Break"><span class="koboSpan" id="kobo.89.1">the image.</span></span></p>
<h2 id="_idParaDest-126"><a id="_idTextAnchor130"/><span class="koboSpan" id="kobo.90.1">Vectorizing the images</span></h2>
<p><span class="koboSpan" id="kobo.91.1">The second step will be to create vectors</span><a id="_idIndexMarker485"/><span class="koboSpan" id="kobo.92.1"> from the bitmap image. </span><span class="koboSpan" id="kobo.92.2">To do this, we will need software with the proper algorithms to detect pixels, remove them, and replace them with code that will draw</span><a id="_idIndexMarker486"/><span class="koboSpan" id="kobo.93.1"> the shapes instead. </span><span class="koboSpan" id="kobo.93.2">The resulting code file will be a </span><strong class="bold"><span class="koboSpan" id="kobo.94.1">scalable vector graphics</span></strong><span class="koboSpan" id="kobo.95.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.96.1">.svg</span></strong><span class="koboSpan" id="kobo.97.1">) file. </span><span class="koboSpan" id="kobo.97.2">One of the best software options on the market is called Vector Magic. </span><span class="koboSpan" id="kobo.97.3">This software is easy to use</span><a id="_idIndexMarker487"/><span class="koboSpan" id="kobo.98.1"> and automates the vectorization process with a click of a button to start the process, but the downside is it costs </span><span class="No-Break"><span class="koboSpan" id="kobo.99.1">around $300.</span></span></p>
<p><span class="koboSpan" id="kobo.100.1">Alternatively, we can use Inkscape, which is free</span><a id="_idIndexMarker488"/><span class="koboSpan" id="kobo.101.1"> software that does a really good job of tracing out a bitmap image and converting all its parts into vectors. </span><span class="koboSpan" id="kobo.101.2">This is what we will use, and you can download the latest version (at the time of writing) from the following </span><span class="No-Break"><span class="koboSpan" id="kobo.102.1">link: </span></span><a href="https://inkscape.org/release/inkscape-1.2.1/"><span class="No-Break"><span class="koboSpan" id="kobo.103.1">https://inkscape.org/release/inkscape-1.2.1/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.104.1">.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.105.1">Tip</span></p>
<p class="callout"><span class="koboSpan" id="kobo.106.1">Even though Inkscape can work with color images, it’s usually better to have your images in black and white; the algorithms work better with these two colors. </span><span class="koboSpan" id="kobo.106.2">If you have color images, though, that’s not a problem – you can still convert</span><a id="_idIndexMarker489"/><span class="koboSpan" id="kobo.107.1"> them into black and white by using a graphics program such as </span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">Affinity Designer.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.109.1">If you look at the images we are using for this project, two of them are in color, but that’s okay because they have a limited number of colors and are simple shapes. </span><span class="koboSpan" id="kobo.109.2">If you have more complicated shapes, for instance, such as a portrait photograph with many colors in it, then it’s better to convert them into black and white first. </span></p>
<p><span class="koboSpan" id="kobo.110.1">Once you have Inkscape</span><a id="_idIndexMarker490"/><span class="koboSpan" id="kobo.111.1"> installed, you can get started. </span><span class="koboSpan" id="kobo.111.2">Grab one of your images (in my case, I am choosing the “WE” image), right-click on it, and open it in Inkscape. </span><span class="koboSpan" id="kobo.111.3">You will see this </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">pop-up window:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer119">
<span class="koboSpan" id="kobo.113.1"><img alt="Figure 9.2: Importing an image into Inkscape " src="image/B18674_09_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.114.1">Figure 9.2: Importing an image into Inkscape</span></p>
<p><span class="koboSpan" id="kobo.115.1">Set </span><strong class="bold"><span class="koboSpan" id="kobo.116.1">Image Import Type</span></strong><span class="koboSpan" id="kobo.117.1"> to </span><strong class="bold"><span class="koboSpan" id="kobo.118.1">Embed</span></strong><span class="koboSpan" id="kobo.119.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.120.1">Image DPI</span></strong><span class="koboSpan" id="kobo.121.1"> to </span><strong class="bold"><span class="koboSpan" id="kobo.122.1">Default import resolution</span></strong><span class="koboSpan" id="kobo.123.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.124.1">Image Rendering Mode</span></strong><span class="koboSpan" id="kobo.125.1"> to </span><strong class="bold"><span class="koboSpan" id="kobo.126.1">None (auto)</span></strong><span class="koboSpan" id="kobo.127.1">. </span><span class="koboSpan" id="kobo.127.2">Then, click </span><strong class="bold"><span class="koboSpan" id="kobo.128.1">OK</span></strong><span class="koboSpan" id="kobo.129.1">. </span><span class="koboSpan" id="kobo.129.2">You will then see </span><span class="No-Break"><span class="koboSpan" id="kobo.130.1">this screen:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer120">
<span class="koboSpan" id="kobo.131.1"><img alt="Figure 9.3: The Inkscape editor with our image " src="image/B18674_09_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.132.1">Figure 9.3: The Inkscape editor with our image</span></p>
<p><span class="koboSpan" id="kobo.133.1">Before continuing</span><a id="_idIndexMarker491"/><span class="koboSpan" id="kobo.134.1"> with the conversion, I want to show you how a bitmap looks close up. </span><span class="koboSpan" id="kobo.134.2">On your Mac trackpad, pinch and zoom in very close to the image; you will see pixelization and blurriness appear. </span><span class="koboSpan" id="kobo.134.3">This is one way you can tell whether the image is a bitmap and not a vector. </span><span class="koboSpan" id="kobo.134.4">(Of course, the file extension will also let you know whether it’s a bitmap or vector </span><span class="No-Break"><span class="koboSpan" id="kobo.135.1">as well!)</span></span></p>
<p><span class="koboSpan" id="kobo.136.1">Next, select your image on the Inkscape canvas (you will know it’s been selected if you see black arrows around it), then go to the </span><strong class="bold"><span class="koboSpan" id="kobo.137.1">Path</span></strong><span class="koboSpan" id="kobo.138.1"> menu at the top of the screen, and choose </span><strong class="bold"><span class="koboSpan" id="kobo.139.1">Trace Bitmap</span></strong><span class="koboSpan" id="kobo.140.1">. </span><span class="koboSpan" id="kobo.140.2">This will open up the </span><strong class="bold"><span class="koboSpan" id="kobo.141.1">Preview</span></strong><span class="koboSpan" id="kobo.142.1"> option on the right-hand side </span><span class="No-Break"><span class="koboSpan" id="kobo.143.1">of Inkscape:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer121">
<span class="koboSpan" id="kobo.144.1"><img alt="Figure 9.4: Inkscape Preview " src="image/B18674_09_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.145.1">Figure 9.4: Inkscape Preview</span></p>
<p><span class="koboSpan" id="kobo.146.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.147.1">Preview</span></strong><span class="koboSpan" id="kobo.148.1"> window, Inkscape</span><a id="_idIndexMarker492"/><span class="koboSpan" id="kobo.149.1"> shows us what the </span><strong class="bold"><span class="koboSpan" id="kobo.150.1">Trace Bitmap</span></strong><span class="koboSpan" id="kobo.151.1"> function will be able to trace, and what the image will look like as a vector graphic. </span><span class="koboSpan" id="kobo.151.2">Since the preview looks nearly identical to the “WE” image on the canvas, there will be a complete outline around the image. </span></p>
<p><span class="koboSpan" id="kobo.152.1">You can’t see the vector lines and points just yet in the preview, but you </span><span class="No-Break"><span class="koboSpan" id="kobo.153.1">will shortly.</span></span></p>
<p><span class="koboSpan" id="kobo.154.1">Since we are using a black and white image, Inscape has selected the </span><strong class="bold"><span class="koboSpan" id="kobo.155.1">Single scan</span></strong><span class="koboSpan" id="kobo.156.1"> option from the top of the </span><strong class="bold"><span class="koboSpan" id="kobo.157.1">Preview</span></strong><span class="koboSpan" id="kobo.158.1"> window (which you can see in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.159.1">Figure 9</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.160.1">.5</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">).</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer122">
<span class="koboSpan" id="kobo.162.1"><img alt="Figure 9.5: The Inkscape scan option " src="image/B18674_09_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.163.1">Figure 9.5: The Inkscape scan option</span></p>
<p><span class="koboSpan" id="kobo.164.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.165.1">Single scan</span></strong><span class="koboSpan" id="kobo.166.1"> option is used for black</span><a id="_idIndexMarker493"/><span class="koboSpan" id="kobo.167.1"> and white images, but if we use a multicolored image, then we need to select the </span><strong class="bold"><span class="koboSpan" id="kobo.168.1">Multicolor</span></strong><span class="koboSpan" id="kobo.169.1"> option. </span><span class="koboSpan" id="kobo.169.2">The </span><strong class="bold"><span class="koboSpan" id="kobo.170.1">Multicolor</span></strong><span class="koboSpan" id="kobo.171.1"> option will scan your image, looking at the many colors it contains, and do its best to trace an outline around each of those colors. </span><span class="koboSpan" id="kobo.171.2">This is why I said earlier that it’s usually better to have a black-and-white image, as there are fewer colors to scan and thus less chance of not getting a </span><span class="No-Break"><span class="koboSpan" id="kobo.172.1">good trace.</span></span></p>
<p><span class="koboSpan" id="kobo.173.1">As highlighted in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.174.1">Figure 9</span></em></span><em class="italic"><span class="koboSpan" id="kobo.175.1">.5</span></em><span class="koboSpan" id="kobo.176.1">, you can also adjust the </span><strong class="bold"><span class="koboSpan" id="kobo.177.1">Threshold</span></strong><span class="koboSpan" id="kobo.178.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.179.1">Details</span></strong><span class="koboSpan" id="kobo.180.1"> sliders to get the best possible image in the previews. </span><span class="koboSpan" id="kobo.180.2">These sliders are useful if Inkscape is having difficulty getting a good scan. </span><span class="koboSpan" id="kobo.180.3">By moving the sliders, you can fine-tune the parts of the image that Inkscape </span><span class="No-Break"><span class="koboSpan" id="kobo.181.1">can see.</span></span></p>
<p><span class="koboSpan" id="kobo.182.1">Let’s look at the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.183.1">Details</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.184.1"> sliders:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.185.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.186.1">Speckles</span></strong><span class="koboSpan" id="kobo.187.1"> slider will ignore the small spots in the vector – when set to maximum, it will ignore more speckles, and when set to minimum, it will ignore </span><span class="No-Break"><span class="koboSpan" id="kobo.188.1">fewer speckles.</span></span></li>
<li><span class="koboSpan" id="kobo.189.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.190.1">Smooth corners</span></strong><span class="koboSpan" id="kobo.191.1"> slider will smooth out any sharp corners that are in </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">the trace.</span></span></li>
<li><span class="koboSpan" id="kobo.193.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.194.1">Optimize</span></strong><span class="koboSpan" id="kobo.195.1"> slider will try to optimize paths by joining adjacent Bezier curve segments together; this means that the </span><strong class="bold"><span class="koboSpan" id="kobo.196.1">Optimize</span></strong><span class="koboSpan" id="kobo.197.1"> slider will try its best to remove as many vector nodes as it can. </span><span class="koboSpan" id="kobo.197.2">When you have fewer nodes in a vector image, there tends to be better tracing and fewer jagged edges. </span></li>
</ul>
<p><span class="koboSpan" id="kobo.198.1">We will see the </span><strong class="bold"><span class="koboSpan" id="kobo.199.1">Threshold</span></strong><span class="koboSpan" id="kobo.200.1"> slider later when creating a stroke around </span><span class="No-Break"><span class="koboSpan" id="kobo.201.1">the heart.</span></span></p>
<p><span class="koboSpan" id="kobo.202.1">What we want</span><a id="_idIndexMarker494"/><span class="koboSpan" id="kobo.203.1"> to see in the preview is an image that is as close to the one in the center canvas as possible. </span><span class="koboSpan" id="kobo.203.2">When we do see this, it means that Inkscape can trace all around the shape on the canvas correctly and capture all the vector lines. </span><span class="koboSpan" id="kobo.203.3">If you don’t see an image that’s close to the original, then try and adjust some of the sliders I just mentioned to fine-tune </span><span class="No-Break"><span class="koboSpan" id="kobo.204.1">the output.</span></span></p>
<p><span class="koboSpan" id="kobo.205.1">Once you have finished adjusting the image so it looks close to the original, click </span><strong class="bold"><span class="koboSpan" id="kobo.206.1">Update Preview</span></strong><span class="koboSpan" id="kobo.207.1">, and then </span><strong class="bold"><span class="koboSpan" id="kobo.208.1">Apply</span></strong><span class="koboSpan" id="kobo.209.1">. </span><span class="koboSpan" id="kobo.209.2">Inkscape places its newly created vectors directly over the original image. </span><span class="koboSpan" id="kobo.209.3">To see the result, click on the “WE” image in the editor and drag the new vectors to </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">the side:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer123">
<span class="koboSpan" id="kobo.211.1"><img alt="Figure 9.6: Creating the vectors " src="image/B18674_09_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.212.1">Figure 9.6: Creating the vectors</span></p>
<p><span class="koboSpan" id="kobo.213.1">You can now delete the original image, as it is no </span><span class="No-Break"><span class="koboSpan" id="kobo.214.1">longer needed.</span></span></p>
<p><span class="koboSpan" id="kobo.215.1">Let’s have a look</span><a id="_idIndexMarker495"/><span class="koboSpan" id="kobo.216.1"> at what Inkscape has done for us – it has traced the original image and created a new image that is now made of vector paths. </span><span class="koboSpan" id="kobo.216.2">To see the difference, pinch and zoom on your Mac trackpad on the new vector image as you did with the bitmap image. </span><span class="koboSpan" id="kobo.216.3">Do you see the difference? </span><span class="koboSpan" id="kobo.216.4">There is no pixelation or blurriness at all, as the image is created with code rather than pixels; the image can be blown up to any size and it will still remain sharp and crisp along its edges </span><span class="No-Break"><span class="koboSpan" id="kobo.217.1">and curves:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer124">
<span class="koboSpan" id="kobo.218.1"><img alt="Figure 9.7: Vector resolution " src="image/B18674_09_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.219.1">Figure 9.7: Vector resolution</span></p>
<p><span class="koboSpan" id="kobo.220.1">Now, remember that I mentioned</span><a id="_idIndexMarker496"/><span class="koboSpan" id="kobo.221.1"> that you will be able to see the vectors that Inkscape has created? </span><span class="koboSpan" id="kobo.221.2">Well, they are there, it’s just that we need to select the right editing tool to see them. </span><span class="koboSpan" id="kobo.221.3">Select the image in the center of the canvas, go to the left toolbar, and select the </span><strong class="bold"><span class="koboSpan" id="kobo.222.1">Node Editing</span></strong><span class="koboSpan" id="kobo.223.1"> tool. </span><span class="koboSpan" id="kobo.223.2">When you click on that tool, you will be able to see all the vector lines that </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">Inkscape created:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer125">
<span class="koboSpan" id="kobo.225.1"><img alt="Figure 9.8: The vectors " src="image/B18674_09_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.226.1">Figure 9.8: The vectors</span></p>
<p><span class="koboSpan" id="kobo.227.1">Each of those small squares</span><a id="_idIndexMarker497"/><span class="koboSpan" id="kobo.228.1"> is a point (or node) that links lines, curves, and corners to make this new shape – and these points can now be edited by clicking on them and dragging them to any location to reshape the </span><span class="No-Break"><span class="koboSpan" id="kobo.229.1">vector image.</span></span></p>
<p><span class="koboSpan" id="kobo.230.1">With the new vectors created, we can export them. </span><span class="koboSpan" id="kobo.230.2">To do this, open </span><strong class="bold"><span class="koboSpan" id="kobo.231.1">File</span></strong><span class="koboSpan" id="kobo.232.1"> at the top menu and choose </span><strong class="bold"><span class="koboSpan" id="kobo.233.1">Export</span></strong><span class="koboSpan" id="kobo.234.1">. </span><span class="koboSpan" id="kobo.234.2">Then, you can choose the export options at the bottom right of the software. </span><span class="koboSpan" id="kobo.234.3">Choose the file type that you want to export to – we want a </span><strong class="bold"><span class="koboSpan" id="kobo.235.1">Plain SVG (*.svg)</span></strong><span class="koboSpan" id="kobo.236.1"> file. </span><span class="koboSpan" id="kobo.236.2">Then, click on the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.237.1">Export</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.238.1"> button:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer126">
<span class="koboSpan" id="kobo.239.1"><img alt="Figure 9.9: Exporting to an SVG file " src="image/B18674_09_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.240.1">Figure 9.9: Exporting to an SVG file</span></p>
<p><span class="koboSpan" id="kobo.241.1">Now, we have an SVG file</span><a id="_idIndexMarker498"/><span class="koboSpan" id="kobo.242.1"> stored on our computer, ready to be translated into Swift code. </span><span class="koboSpan" id="kobo.242.2">Do the same process for any of the other images that you want to use in this project – whether you are using your own images or following along with the book’s project images – and then you can proceed to the </span><span class="No-Break"><span class="koboSpan" id="kobo.243.1">next step.</span></span></p>
<h2 id="_idParaDest-127"><a id="_idTextAnchor131"/><span class="koboSpan" id="kobo.244.1">Translating the SVG file into Swift code</span></h2>
<p><span class="koboSpan" id="kobo.245.1">Let’s continue. </span><span class="koboSpan" id="kobo.245.2">We have an SVG file</span><a id="_idIndexMarker499"/><span class="koboSpan" id="kobo.246.1"> ready</span><a id="_idIndexMarker500"/><span class="koboSpan" id="kobo.247.1"> for the next step. </span><span class="koboSpan" id="kobo.247.2">An </span><strong class="bold"><span class="koboSpan" id="kobo.248.1">SVG</span></strong><span class="koboSpan" id="kobo.249.1"> file is a file written in XML, and </span><strong class="bold"><span class="koboSpan" id="kobo.250.1">XML</span></strong><span class="koboSpan" id="kobo.251.1"> is a markup language used for storing</span><a id="_idIndexMarker501"/><span class="koboSpan" id="kobo.252.1"> and transferring digital information. </span><span class="koboSpan" id="kobo.252.2">The XML code in an SVG file creates all of the shapes, colors, and text that comprise the image. </span><span class="koboSpan" id="kobo.252.3">We will be turning that XML code into Swift code shortly, but first, we need to edit the images’ dimensions and we can do that </span><span class="No-Break"><span class="koboSpan" id="kobo.253.1">in Sketch.</span></span></p>
<p><span class="koboSpan" id="kobo.254.1">So, first, open the SVG “WE” image in Sketch. </span><span class="koboSpan" id="kobo.254.2">Then, in the </span><strong class="bold"><span class="koboSpan" id="kobo.255.1">Utilities</span></strong><span class="koboSpan" id="kobo.256.1"> area on the right, we can size the image however we like; in my case, I have set the width to </span><strong class="bold"><span class="koboSpan" id="kobo.257.1">250</span></strong><span class="koboSpan" id="kobo.258.1">. </span><span class="koboSpan" id="kobo.258.2">To set this, make sure that the little lock icon in between the width and height fields is selected so that it’s locked – this will keep the correct proportions for the image – and </span><span class="No-Break"><span class="koboSpan" id="kobo.259.1">hit </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.260.1">Enter</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.261.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer127">
<span class="koboSpan" id="kobo.262.1"><img alt="Figure 9.10: Sizing the image " src="image/B18674_09_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.263.1">Figure 9.10: Sizing the image</span></p>
<p><span class="koboSpan" id="kobo.264.1">And that’s all we need to do in Sketch. </span><span class="koboSpan" id="kobo.264.2">Now, minimize your Sketch document (but don’t </span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">close it!).</span></span></p>
<p><span class="koboSpan" id="kobo.266.1">Next, we need a program </span><a id="_idIndexMarker502"/><span class="koboSpan" id="kobo.267.1">that can turn XML </span><a id="_idIndexMarker503"/><span class="koboSpan" id="kobo.268.1">code into Swift code. </span><span class="koboSpan" id="kobo.268.2">One option is Paint Code – although it is a great program, it costs around $200 per year for a subscription. </span><span class="koboSpan" id="kobo.268.3">Instead, we will use Kite – although this is currently $99 to buy outright with no subscription, you can always use the free trial to follow along with </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">this project.</span></span></p>
<p><span class="koboSpan" id="kobo.270.1">So, open up Kite. </span><span class="koboSpan" id="kobo.270.2">Then, click on </span><strong class="bold"><span class="koboSpan" id="kobo.271.1">File</span></strong><span class="koboSpan" id="kobo.272.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.273.1">Import</span></strong><span class="koboSpan" id="kobo.274.1"> | </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.275.1">From Sketch…</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.276.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer128">
<span class="koboSpan" id="kobo.277.1"><img alt="Figure 9.11: Importing from Sketch into Kite " src="image/B18674_09_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.278.1">Figure 9.11: Importing from Sketch into Kite</span></p>
<p><span class="koboSpan" id="kobo.279.1">You will then see a pop-up window</span><a id="_idIndexMarker504"/><span class="koboSpan" id="kobo.280.1"> asking how you would</span><a id="_idIndexMarker505"/><span class="koboSpan" id="kobo.281.1"> like to import the layers. </span><span class="koboSpan" id="kobo.281.2">Leave the default settings as they are, but make sure that </span><strong class="bold"><span class="koboSpan" id="kobo.282.1">Import text layers as</span></strong><span class="koboSpan" id="kobo.283.1"> is set to </span><strong class="bold"><span class="koboSpan" id="kobo.284.1">Image Layers</span></strong><span class="koboSpan" id="kobo.285.1"> and that </span><strong class="bold"><span class="koboSpan" id="kobo.286.1">Import images at</span></strong><span class="koboSpan" id="kobo.287.1"> is set to a scale </span><span class="No-Break"><span class="koboSpan" id="kobo.288.1">of </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.289.1">1x</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.290.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer129">
<span class="koboSpan" id="kobo.291.1"><img alt="Figure 9.12: Import From Sketch settings " src="image/B18674_09_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.292.1">Figure 9.12: Import From Sketch settings</span></p>
<p><span class="koboSpan" id="kobo.293.1">Then, click on </span><strong class="bold"><span class="koboSpan" id="kobo.294.1">Import</span></strong><span class="koboSpan" id="kobo.295.1">. </span><span class="koboSpan" id="kobo.295.2">You now have your image</span><a id="_idIndexMarker506"/><span class="koboSpan" id="kobo.296.1"> in Kite and are ready to turn it into Swift code, and that process is as simple</span><a id="_idIndexMarker507"/><span class="koboSpan" id="kobo.297.1"> as clicking one button, the </span><strong class="bold"><span class="koboSpan" id="kobo.298.1">Code</span></strong><span class="koboSpan" id="kobo.299.1"> button, at the top of </span><span class="No-Break"><span class="koboSpan" id="kobo.300.1">the screen:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer130">
<span class="koboSpan" id="kobo.301.1"><img alt="Figure 9.13: Converting the file into Swift code " src="image/B18674_09_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.302.1">Figure 9.13: Converting the file into Swift code</span></p>
<p><span class="koboSpan" id="kobo.303.1">The Swift code that is generated shows up in the bottom console, which you can resize like the Xcode console by dragging it upwards. </span><span class="koboSpan" id="kobo.303.2">Here is what the code console looks like for the “WE” image, containing all the Swift code that makes up its length, thickness, colors, position, </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">and more:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer131">
<span class="koboSpan" id="kobo.305.1"><img alt="Figure 9.14: The generated Swift code in Kite " src="image/B18674_09_14.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.306.1">Figure 9.14: The generated Swift code in Kite</span></p>
<p><span class="koboSpan" id="kobo.307.1">That looks like a lot of code</span><a id="_idIndexMarker508"/><span class="koboSpan" id="kobo.308.1"> just to create</span><a id="_idIndexMarker509"/><span class="koboSpan" id="kobo.309.1"> an image with two letters, doesn’t it? </span><span class="koboSpan" id="kobo.309.2">Well, yes, but there are a lot of things the code is doing – it’s mapping out all the paths needed to create the lines and curves that form </span><span class="No-Break"><span class="koboSpan" id="kobo.310.1">the shape.</span></span></p>
<p><span class="koboSpan" id="kobo.311.1">Let’s now get this code into Xcode. </span><span class="koboSpan" id="kobo.311.2">First, create a new Xcode project if you haven’t done so already – I’ve called it </span><strong class="bold"><span class="koboSpan" id="kobo.312.1">Animating Strokes</span></strong><span class="koboSpan" id="kobo.313.1">. </span><span class="koboSpan" id="kobo.313.2">Then, all we have to do is copy a small segment of it from Kite. </span><span class="koboSpan" id="kobo.313.3">You should copy the code starting </span><span class="No-Break"><span class="koboSpan" id="kobo.314.1">from here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.315.1">
let pathPath = CGMutablePath()</span></pre>
<p><span class="koboSpan" id="kobo.316.1">And continue all the way down the file until you reach these </span><span class="No-Break"><span class="koboSpan" id="kobo.317.1">two lines:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.318.1">
 pathPath.closeSubpath()
 pathPath.move(to: CGPoint(x: 159, y: 104.854378))</span></pre>
<p><span class="koboSpan" id="kobo.319.1">So, we just want to copy all the code that starts with </span><strong class="source-inline"><span class="koboSpan" id="kobo.320.1">pathPath</span></strong><span class="koboSpan" id="kobo.321.1">; everything else we </span><span class="No-Break"><span class="koboSpan" id="kobo.322.1">don’t need.</span></span></p>
<p><span class="koboSpan" id="kobo.323.1">Now, before we enter Xcode, let’s summarize what we have done so far. </span><span class="koboSpan" id="kobo.323.2">We have taken a bitmap image, removed its background and cropped it, opened it with Inkscape and turned it into a vector</span><a id="_idIndexMarker510"/><span class="koboSpan" id="kobo.324.1"> image, and then finally</span><a id="_idIndexMarker511"/><span class="koboSpan" id="kobo.325.1"> imported that vector into Kite, where we turned it into Swift code. </span><span class="koboSpan" id="kobo.325.2">This process will get faster with </span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">more practice.</span></span></p>
<p><span class="koboSpan" id="kobo.327.1">Let’s now proceed to Xcode and start making all this </span><span class="No-Break"><span class="koboSpan" id="kobo.328.1">code work.</span></span></p>
<h1 id="_idParaDest-128"><a id="_idTextAnchor132"/><span class="koboSpan" id="kobo.329.1">Animating images with the stroke modifier</span></h1>
<p><span class="koboSpan" id="kobo.330.1">In the following sections, we will be working</span><a id="_idIndexMarker512"/><span class="koboSpan" id="kobo.331.1"> in Xcode and refactoring</span><a id="_idIndexMarker513"/><span class="koboSpan" id="kobo.332.1"> the “WE” code somewhat in order to make it work in our project. </span><span class="koboSpan" id="kobo.332.2">We will use the Shape protocol that lets us draw a 2D shape using its </span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">path()</span></strong><span class="koboSpan" id="kobo.334.1"> function, and then use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">stroke</span></strong><span class="koboSpan" id="kobo.336.1"> modifier to add a moving line around the path of our shapes. </span><span class="koboSpan" id="kobo.336.2">We will also get started on animating our heart and SwiftUI </span><span class="No-Break"><span class="koboSpan" id="kobo.337.1">logo images.</span></span></p>
<h2 id="_idParaDest-129"><a id="_idTextAnchor133"/><span class="koboSpan" id="kobo.338.1">Creating a stroke animation on the “WE” image</span></h2>
<p><span class="koboSpan" id="kobo.339.1">To start animating the “WE” image, we need</span><a id="_idIndexMarker514"/><span class="koboSpan" id="kobo.340.1"> to create a file inside the project. </span><span class="koboSpan" id="kobo.340.2">Press </span><em class="italic"><span class="koboSpan" id="kobo.341.1">Command + N</span></em><span class="koboSpan" id="kobo.342.1">, choose a </span><strong class="bold"><span class="koboSpan" id="kobo.343.1">SwiftUI View</span></strong><span class="koboSpan" id="kobo.344.1"> file type, and name it – I’m calling </span><span class="No-Break"><span class="koboSpan" id="kobo.345.1">it </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.346.1">WeView</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.347.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.348.1">Then, create a struct at the bottom of the file; this will be the struct that conforms to the shape protocol, allowing us to create 2D shapes by using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.349.1">path</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.350.1"> function:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.351.1">
struct WeTextShape: Shape {
    func path(in rect: CGRect) -&gt; Path {
    }
}</span></pre>
<p><span class="koboSpan" id="kobo.352.1">Now, we can paste in the code that we copied from the Kite program and place it right into that </span><strong class="source-inline"><span class="koboSpan" id="kobo.353.1">path</span></strong><span class="koboSpan" id="kobo.354.1"> function. </span><span class="koboSpan" id="kobo.354.2">This code is quite repetitive and long, as it is drawing a shape and must repeat itself for every</span><a id="_idIndexMarker515"/><span class="koboSpan" id="kobo.355.1"> line, curve, and corner. </span><span class="koboSpan" id="kobo.355.2">So, for the sake of brevity and to not take up too much space, I will just provide the beginning and end of the code (however, you can find the complete code in the </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">GitHub repo):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.357.1">
struct WeTextShape: Shape {
  func path(in rect: CGRect) -&gt; Path {
    let pathPath = CGMutablePath()
      pathPath.move(to: CGPoint(x: 33.544579, y: 
        105.919167))
      pathPath.addCurve(to: CGPoint(x: 20.994799, y: 
        60.169167), control1: CGPoint(x: 32.057159, y: 
        101.184097), control2: CGPoint(x: 29.932928, y: 
        93.440262))
      pathPath.addCurve(to: CGPoint(x: 3.45976, y: 
        7.26897), control1: CGPoint(x: 8.184458, y: 
        12.4843), control2: CGPoint(x: 7.749718, y: 
        11.17275))
      pathPath.addLine(to: CGPoint(x: 0, y: 0.16917))
      ........................................................
</span><span class="koboSpan" id="kobo.357.2">      pathPath.addCurve(to: CGPoint(x: 236.485107, y: 
        93.6082), control1: CGPoint(x: 237.051361, y: 
        79.890518), control2: CGPoint(x: 236.884613, y: 
        86.149673))
      pathPath.addLine(to: CGPoint(x: 235.758789, y: 
        107.169159))
      pathPath.addLine(to: CGPoint(x: 197.379395, y: 
        107.169159))
      pathPath.addLine(to: CGPoint(x: 159, y: 107.169159))
      pathPath.addLine(to: CGPoint(x: 159, y: 104.854378))
      pathPath.closeSubpath()
      pathPath.move(to: CGPoint(x: 159, y: 104.854378))
  }
}</span></pre>
<p><span class="koboSpan" id="kobo.358.1">When you paste the code into Xcode, you will get some errors – don’t worry about these, as the code needs to be reworked a little </span><span class="No-Break"><span class="koboSpan" id="kobo.359.1">bit anyway.</span></span></p>
<p><span class="koboSpan" id="kobo.360.1">Fixing these issues is also a good</span><a id="_idIndexMarker516"/><span class="koboSpan" id="kobo.361.1"> excuse for me to show you how to refactor code in SwiftUI. </span><span class="koboSpan" id="kobo.361.2">Refactoring is a helpful feature that allows us to rename code or remove and replace different parts of code throughout multiple files in your project without having to search through all your files looking for each instance that needs refactoring and manually </span><span class="No-Break"><span class="koboSpan" id="kobo.362.1">changing it.</span></span></p>
<p><span class="koboSpan" id="kobo.363.1">One thing we want to change is the name of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.364.1">pathPath</span></strong><span class="koboSpan" id="kobo.365.1"> constant, which is the first line of code inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.366.1">path</span></strong><span class="koboSpan" id="kobo.367.1"> function that was pasted in. </span><span class="koboSpan" id="kobo.367.2">This constant seems to have been named twice because it was exported from Inkscape. </span><span class="koboSpan" id="kobo.367.3">However, it should simply be </span><span class="No-Break"><span class="koboSpan" id="kobo.368.1">named </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.369.1">path</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.370.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.371.1">So, to refactor this, just </span><em class="italic"><span class="koboSpan" id="kobo.372.1">Command + click</span></em><span class="koboSpan" id="kobo.373.1"> on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.374.1">pathPath</span></strong><span class="koboSpan" id="kobo.375.1"> variable and select </span><strong class="bold"><span class="koboSpan" id="kobo.376.1">Rename</span></strong><span class="koboSpan" id="kobo.377.1">. </span><span class="koboSpan" id="kobo.377.2">You will see Xcode highlight every instance of </span><strong class="source-inline"><span class="koboSpan" id="kobo.378.1">pathPath</span></strong><span class="koboSpan" id="kobo.379.1"> in the file, and all you have to do is just type in the new name, </span><strong class="source-inline"><span class="koboSpan" id="kobo.380.1">path</span></strong><span class="koboSpan" id="kobo.381.1">, and </span><span class="No-Break"><span class="koboSpan" id="kobo.382.1">hit </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.383.1">Enter</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.384.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.385.1">That’s our first revision of the code that we copied over. </span><span class="koboSpan" id="kobo.385.2">The next revision is to change the class that’s being assigned to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.386.1">path</span></strong><span class="koboSpan" id="kobo.387.1"> constant. </span><span class="koboSpan" id="kobo.387.2">Currently, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.388.1">path</span></strong><span class="koboSpan" id="kobo.389.1"> constant is assigned as a </span><strong class="source-inline"><span class="koboSpan" id="kobo.390.1">CGMutablePath()</span></strong><span class="koboSpan" id="kobo.391.1"> instance, which is a core graphics class used for drawing shapes and lines. </span><span class="koboSpan" id="kobo.391.2">Working in SwiftUI though, nearly everything is built with structs, so we need to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.392.1">Path()</span></strong><span class="koboSpan" id="kobo.393.1"> struct instead. </span><span class="koboSpan" id="kobo.393.2">Also, change the </span><strong class="source-inline"><span class="koboSpan" id="kobo.394.1">let</span></strong><span class="koboSpan" id="kobo.395.1"> keyword to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.396.1">var</span></strong><span class="koboSpan" id="kobo.397.1"> keyword, because we need the </span><strong class="source-inline"><span class="koboSpan" id="kobo.398.1">path</span></strong><span class="koboSpan" id="kobo.399.1"> variable to be mutable, meaning its value can </span><span class="No-Break"><span class="koboSpan" id="kobo.400.1">be changed.</span></span></p>
<p><span class="koboSpan" id="kobo.401.1">With those modifications done, the first line of the code in your path function should look like </span><span class="No-Break"><span class="koboSpan" id="kobo.402.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.403.1">
var path = Path()</span></pre>
<p><span class="koboSpan" id="kobo.404.1">Now, let’s add one more line of code to this </span><strong class="source-inline"><span class="koboSpan" id="kobo.405.1">path</span></strong><span class="koboSpan" id="kobo.406.1"> function. </span><span class="koboSpan" id="kobo.406.2">At the very end of the function, we need to return the </span><strong class="source-inline"><span class="koboSpan" id="kobo.407.1">path</span></strong><span class="koboSpan" id="kobo.408.1"> variable, and to do so, we use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.409.1">return</span></strong><span class="koboSpan" id="kobo.410.1"> keyword, followed by the variable the function</span><a id="_idIndexMarker517"/><span class="koboSpan" id="kobo.411.1"> must return; so, add this line at the bottom of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.412.1">path</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.413.1"> function:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.414.1">
return path</span></pre>
<p><span class="koboSpan" id="kobo.415.1">The following are the changes we made to the start and end of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.416.1">path</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.417.1"> function:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.418.1">
func path(in rect: CGRect) -&gt; Path {
    var path = Path()
    path.move(to: CGPoint(x: 33.544579, y: 105.919167))
    path.addCurve(to: CGPoint(x: 3.45976, y: 7.26897), 
      control1: CGPoint(x: 8.184458, y: 12.4843), control2: 
      CGPoint(x: 7.749718, y: 11.17275))
       •••SHAPE CODE HERE•••
    return path
  }</span></pre>
<p><span class="koboSpan" id="kobo.419.1">When you press </span><em class="italic"><span class="koboSpan" id="kobo.420.1">Command + B</span></em><span class="koboSpan" id="kobo.421.1">, the code should </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">be error-free.</span></span></p>
<p><span class="koboSpan" id="kobo.423.1">Now let’s see what all of that Kite code is </span><span class="No-Break"><span class="koboSpan" id="kobo.424.1">actually doing.</span></span></p>
<p><span class="koboSpan" id="kobo.425.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.426.1">path()</span></strong><span class="koboSpan" id="kobo.427.1"> function will return a shape according to the points, lines, and curves that are drawn inside it. </span><span class="koboSpan" id="kobo.427.2">The first line of code inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.428.1">path()</span></strong><span class="koboSpan" id="kobo.429.1"> function is creating a path instance; this will draw the shape, and you can think of this variable as the pencil moving along </span><span class="No-Break"><span class="koboSpan" id="kobo.430.1">the canvas.</span></span></p>
<p><span class="koboSpan" id="kobo.431.1">The second line of code is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.432.1">move()</span></strong><span class="koboSpan" id="kobo.433.1"> function. </span><span class="koboSpan" id="kobo.433.2">This is what sets the starting location for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.434.1">path</span></strong><span class="koboSpan" id="kobo.435.1"> variable to move to. </span><span class="koboSpan" id="kobo.435.2">The locations are based on the Cartesian coordinate system and an X and Y location are used to position the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.436.1">path</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.437.1"> variable.</span></span></p>
<p><span class="koboSpan" id="kobo.438.1">In the third line of code, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.439.1">path</span></strong><span class="koboSpan" id="kobo.440.1"> variable calls the </span><strong class="source-inline"><span class="koboSpan" id="kobo.441.1">addCurve()</span></strong><span class="koboSpan" id="kobo.442.1"> function, and this does what it says – it adds a Bezier curve to the path using the specified points. </span><span class="koboSpan" id="kobo.442.2">Continuing down our code, we see</span><a id="_idIndexMarker518"/><span class="koboSpan" id="kobo.443.1"> that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.444.1">path</span></strong><span class="koboSpan" id="kobo.445.1"> variable also calls the </span><strong class="source-inline"><span class="koboSpan" id="kobo.446.1">addLine()</span></strong><span class="koboSpan" id="kobo.447.1"> function, and this will add a line to the path using the specified points. </span><span class="koboSpan" id="kobo.447.2">The code continues to call these two functions, </span><strong class="source-inline"><span class="koboSpan" id="kobo.448.1">addCurve()</span></strong><span class="koboSpan" id="kobo.449.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.450.1">addLine()</span></strong><span class="koboSpan" id="kobo.451.1">, quite a bit until the </span><strong class="source-inline"><span class="koboSpan" id="kobo.452.1">path</span></strong><span class="koboSpan" id="kobo.453.1"> variable needs to finish off a particular path in the drawing and close off the ends of that finished line before moving on to the next line in </span><span class="No-Break"><span class="koboSpan" id="kobo.454.1">the drawing.</span></span></p>
<p><span class="koboSpan" id="kobo.455.1">The finished line is closed off using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.456.1">closeSubpath()</span></strong><span class="koboSpan" id="kobo.457.1"> function and directly proceeded by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.458.1">moveTo()</span></strong><span class="koboSpan" id="kobo.459.1"> function to start a new line in the drawing. </span><span class="koboSpan" id="kobo.459.2">So, as you can see, there are several lines drawn in this code to make up the </span><span class="No-Break"><span class="koboSpan" id="kobo.460.1">finished shape.</span></span></p>
<p><span class="koboSpan" id="kobo.461.1">And finally, at the end of all this code, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.462.1">path()</span></strong><span class="koboSpan" id="kobo.463.1"> function returns the </span><strong class="source-inline"><span class="koboSpan" id="kobo.464.1">pat</span></strong><span class="koboSpan" id="kobo.465.1">h variable, which now contains a finished shape inside of it, ready to be displayed on the </span><span class="No-Break"><span class="koboSpan" id="kobo.466.1">iPhone screen.</span></span></p>
<p><span class="koboSpan" id="kobo.467.1">Next, continuing to work in the same file, we need to come into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.468.1">WEView</span></strong><span class="koboSpan" id="kobo.469.1"> struct and add the code to display </span><span class="No-Break"><span class="koboSpan" id="kobo.470.1">this shape.</span></span></p>
<p><span class="koboSpan" id="kobo.471.1">Starting at the top of the struct, add the </span><span class="No-Break"><span class="koboSpan" id="kobo.472.1">following variables:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.473.1">
//MARK: - VARIABLES
    @State var strokeReset: Bool = true
    @State var startStroke: CGFloat = 0.0
    @State var endStroke: CGFloat = 0.0</span></pre>
<p><span class="koboSpan" id="kobo.474.1">Next, inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.475.1">body</span></strong><span class="koboSpan" id="kobo.476.1"> property, add </span><span class="No-Break"><span class="koboSpan" id="kobo.477.1">a </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.478.1">ZStack</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.479.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.480.1">
var body: some View {
    ZStack {
    }
  }</span></pre>
<p><span class="koboSpan" id="kobo.481.1">Inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.482.1">ZStack</span></strong><span class="koboSpan" id="kobo.483.1">, let’s add a </span><strong class="source-inline"><span class="koboSpan" id="kobo.484.1">Group</span></strong><span class="koboSpan" id="kobo.485.1">, and then the following code to display the shape in </span><span class="No-Break"><span class="koboSpan" id="kobo.486.1">the preview:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.487.1">
 ZStack {
        Group {
            //SHAPE OUTLINE
            WeTextShape()
                .stroke(style: StrokeStyle(lineWidth: 0.5, 
                  lineCap: .round, lineJoin: .round))
                .foregroundColor(.gray)
        }
    }</span></pre>
<p><span class="koboSpan" id="kobo.488.1">Inside </span><strong class="source-inline"><span class="koboSpan" id="kobo.489.1">Group</span></strong><span class="koboSpan" id="kobo.490.1">, we call the </span><strong class="source-inline"><span class="koboSpan" id="kobo.491.1">WeTextShape</span></strong><span class="koboSpan" id="kobo.492.1"> struct and add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.493.1">stroke</span></strong><span class="koboSpan" id="kobo.494.1"> modifier directly to it. </span><span class="koboSpan" id="kobo.494.2">This modifier will create a new shape</span><a id="_idIndexMarker519"/><span class="koboSpan" id="kobo.495.1"> that has a stroke on it, which is styled according to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.496.1">StrokeStyle</span></strong><span class="koboSpan" id="kobo.497.1"> function. </span><span class="koboSpan" id="kobo.497.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.498.1">StrokeStyle</span></strong><span class="koboSpan" id="kobo.499.1"> function adds a </span><strong class="source-inline"><span class="koboSpan" id="kobo.500.1">lineWidth</span></strong><span class="koboSpan" id="kobo.501.1"> property of </span><strong class="source-inline"><span class="koboSpan" id="kobo.502.1">0.5</span></strong><span class="koboSpan" id="kobo.503.1">, and sets both </span><strong class="source-inline"><span class="koboSpan" id="kobo.504.1">lineCap</span></strong><span class="koboSpan" id="kobo.505.1"> (the ends of the stroke) and </span><strong class="source-inline"><span class="koboSpan" id="kobo.506.1">lineJoin</span></strong><span class="koboSpan" id="kobo.507.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.508.1">round</span></strong><span class="koboSpan" id="kobo.509.1">; this joins the ends of the stroke with a semi-circular arc. </span><span class="koboSpan" id="kobo.509.2">Finally, the color of the stroke shape is set </span><span class="No-Break"><span class="koboSpan" id="kobo.510.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.511.1">gray</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.512.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.513.1">This completes the shape – we won’t add any animation to it, as we just want it to be a stationary shape. </span><span class="koboSpan" id="kobo.513.2">Instead, we will add this shape again, directly over the first one, and that’s the one we will animate in color. </span><span class="koboSpan" id="kobo.513.3">Let’s add </span><span class="No-Break"><span class="koboSpan" id="kobo.514.1">that now.</span></span></p>
<p><span class="koboSpan" id="kobo.515.1">Continuing inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.516.1">Group</span></strong><span class="koboSpan" id="kobo.517.1"> view, and directly under the last line of code, add </span><span class="No-Break"><span class="koboSpan" id="kobo.518.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.519.1">
    Group {
        //SHAPE OUTLINE
        WeTextShape()
            .stroke(style: StrokeStyle(lineWidth: 0.5, 
              lineCap: .round, lineJoin: .round))
            .foregroundColor(.gray)
</span><strong class="bold"><span class="koboSpan" id="kobo.520.1">        //ANIMATING STROKE</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.521.1">        WeTextShape()</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.522.1">            .trim(from: startStroke, to: endStroke)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.523.1">            .stroke(style: StrokeStyle(lineWidth: 5, </span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.524.1">              lineCap: .round, lineJoin: .round))</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.525.1">            .foregroundColor(Color.red)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.526.1">    }.offset(x: 75, y: 50)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.527.1">  )</span></strong><span class="koboSpan" id="kobo.528.1">
   }</span></pre>
<p><span class="koboSpan" id="kobo.529.1">And that’s the code that will add a second shape, identical to the first one, directly </span><span class="No-Break"><span class="koboSpan" id="kobo.530.1">over it.</span></span></p>
<p><span class="koboSpan" id="kobo.531.1">As we did for the non-moving</span><a id="_idIndexMarker520"/><span class="koboSpan" id="kobo.532.1"> shape, we called the </span><strong class="source-inline"><span class="koboSpan" id="kobo.533.1">WeTextView</span></strong><span class="koboSpan" id="kobo.534.1"> struct to create the shape. </span><span class="koboSpan" id="kobo.534.2">Then, we used the </span><strong class="source-inline"><span class="koboSpan" id="kobo.535.1">trim</span></strong><span class="koboSpan" id="kobo.536.1"> modifier to trim the shape by a fractional amount based on the values that get passed into its parameters. </span><span class="koboSpan" id="kobo.536.2">By passing in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.537.1">startStroke</span></strong><span class="koboSpan" id="kobo.538.1"> variable as the location of the start of the stroke animation and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.539.1">endStroke</span></strong><span class="koboSpan" id="kobo.540.1"> variable to tell the </span><strong class="source-inline"><span class="koboSpan" id="kobo.541.1">trim</span></strong><span class="koboSpan" id="kobo.542.1"> modifier where to stop, a stroked line will be drawn along the shape’s path from start to end. </span><span class="koboSpan" id="kobo.542.2">The length of that stroke line will depend on the values inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.543.1">startStroke</span></strong><span class="koboSpan" id="kobo.544.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.545.1">endStroke</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.546.1"> variables.</span></span></p>
<p><span class="koboSpan" id="kobo.547.1">As we did with the first shape, we also used the </span><strong class="source-inline"><span class="koboSpan" id="kobo.548.1">strokeStyle</span></strong><span class="koboSpan" id="kobo.549.1"> modifier to style the stroke with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.550.1">width</span></strong><span class="koboSpan" id="kobo.551.1"> property of </span><strong class="source-inline"><span class="koboSpan" id="kobo.552.1">5</span></strong><span class="koboSpan" id="kobo.553.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.554.1">lineCap</span></strong><span class="koboSpan" id="kobo.555.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.556.1">lineJoin</span></strong><span class="koboSpan" id="kobo.557.1"> set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.558.1">round</span></strong><span class="koboSpan" id="kobo.559.1">. </span><span class="koboSpan" id="kobo.559.2">This time, we set the color to </span><strong class="source-inline"><span class="koboSpan" id="kobo.560.1">red</span></strong><span class="koboSpan" id="kobo.561.1"> so that the moving stroke will stand out as it travels along the gray shape </span><span class="No-Break"><span class="koboSpan" id="kobo.562.1">underneath it.</span></span></p>
<p><span class="koboSpan" id="kobo.563.1">Then, finally, we’re using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.564.1">offset</span></strong><span class="koboSpan" id="kobo.565.1"> modifier to center the shape inside the preview in the middle from left to right, and toward the top of </span><span class="No-Break"><span class="koboSpan" id="kobo.566.1">the iPhone.</span></span></p>
<p><span class="koboSpan" id="kobo.567.1">Now, the code for the outline and animating the stroke are complete. </span><span class="koboSpan" id="kobo.567.2">What’s needed next is to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.568.1">onAppear</span></strong><span class="koboSpan" id="kobo.569.1"> modifier to start the animation and set up some timers so that the stroke can proceed at a certain speed. </span><span class="koboSpan" id="kobo.569.2">Add the final bit of code right after the closing brace of </span><span class="No-Break"><span class="koboSpan" id="kobo.570.1">the </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.571.1">ZStack</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.572.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.573.1">
.onAppear() {
    Timer.scheduledTimer(withTimeInterval: 0.23, repeats: 
      true) { timer in
        if (endStroke &gt;= 1) {
            if (strokeReset) {
                Timer.scheduledTimer(withTimeInterval: 0.6, 
                  repeats: false) { _ in
                    endStroke = 0
                    startStroke = 0
                    strokeReset.toggle()
                }
                strokeReset = false
            }
        }
        withAnimation(Animation.easeOut) {
            endStroke += 0.12
            startStroke = endStroke - 0.4
        }
    }
  }</span></pre>
<p><span class="koboSpan" id="kobo.574.1">This code might look a little busy</span><a id="_idIndexMarker521"/><span class="koboSpan" id="kobo.575.1"> to grasp at first, but let’s break it down </span><span class="No-Break"><span class="koboSpan" id="kobo.576.1">for clarity.</span></span></p>
<p><span class="koboSpan" id="kobo.577.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.578.1">onAppear()</span></strong><span class="koboSpan" id="kobo.579.1"> method is called on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.580.1">ZStack</span></strong><span class="koboSpan" id="kobo.581.1"> container; this method is triggered when the view appears on the screen. </span><span class="koboSpan" id="kobo.581.2">Inside the method, a timer is scheduled using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.582.1">Timer.scheduledTimer</span></strong><span class="koboSpan" id="kobo.583.1"> method, which is set to repeat every </span><strong class="source-inline"><span class="koboSpan" id="kobo.584.1">0.23</span></strong><span class="koboSpan" id="kobo.585.1"> seconds. </span><span class="koboSpan" id="kobo.585.2">This is the amount of time it takes for the animation to draw each stroke segment. </span><span class="koboSpan" id="kobo.585.3">A stroke segment is how we draw out the shape, in segments, one at a time. </span><span class="koboSpan" id="kobo.585.4">You can experiment with this timer’s interval value – a larger number will draw the stroke segments slower, and a smaller number will draw the segments faster, creating a smooth animating line around </span><span class="No-Break"><span class="koboSpan" id="kobo.586.1">the shape.</span></span></p>
<p><span class="koboSpan" id="kobo.587.1">Next, we want the animation to repeat, so we set the </span><strong class="source-inline"><span class="koboSpan" id="kobo.588.1">repeats</span></strong><span class="koboSpan" id="kobo.589.1"> parameter to </span><strong class="source-inline"><span class="koboSpan" id="kobo.590.1">true</span></strong><span class="koboSpan" id="kobo.591.1">. </span><span class="koboSpan" id="kobo.591.2">Within the timer’s event handler, the code first checks whether the </span><strong class="source-inline"><span class="koboSpan" id="kobo.592.1">endStroke</span></strong><span class="koboSpan" id="kobo.593.1"> variable is greater than or equal to </span><strong class="source-inline"><span class="koboSpan" id="kobo.594.1">1</span></strong><span class="koboSpan" id="kobo.595.1">. </span><span class="koboSpan" id="kobo.595.2">If this is true, the code then checks whether the </span><strong class="source-inline"><span class="koboSpan" id="kobo.596.1">strokeReset</span></strong><span class="koboSpan" id="kobo.597.1"> variable is </span><strong class="source-inline"><span class="koboSpan" id="kobo.598.1">true</span></strong><span class="koboSpan" id="kobo.599.1">. </span><span class="koboSpan" id="kobo.599.2">If both of these conditions are met, another timer is scheduled using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.600.1">Timer.scheduledTimer</span></strong><span class="koboSpan" id="kobo.601.1"> method. </span><span class="koboSpan" id="kobo.601.2">This timer is set to run only once, after </span><strong class="source-inline"><span class="koboSpan" id="kobo.602.1">0.6</span></strong><span class="koboSpan" id="kobo.603.1"> seconds, and within this timer’s event handler, the values of </span><strong class="source-inline"><span class="koboSpan" id="kobo.604.1">endStroke</span></strong><span class="koboSpan" id="kobo.605.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.606.1">startStroke</span></strong><span class="koboSpan" id="kobo.607.1"> are reset to </span><strong class="source-inline"><span class="koboSpan" id="kobo.608.1">0</span></strong><span class="koboSpan" id="kobo.609.1">, so the stroke animation can once again start at the beginning, and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.610.1">strokeReset</span></strong><span class="koboSpan" id="kobo.611.1"> variable is toggled. </span><span class="koboSpan" id="kobo.611.2">After the inner timer is scheduled, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.612.1">strokeReset</span></strong><span class="koboSpan" id="kobo.613.1"> variable is set </span><span class="No-Break"><span class="koboSpan" id="kobo.614.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.615.1">false</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.616.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.617.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.618.1">withAnimation</span></strong><span class="koboSpan" id="kobo.619.1"> function is different</span><a id="_idIndexMarker522"/><span class="koboSpan" id="kobo.620.1"> from the animation modifier we have used in past projects. </span><span class="koboSpan" id="kobo.620.2">Remember in </span><a href="B18674_02.xhtml#_idTextAnchor034"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.621.1">Chapter 2</span></em></span></a><span class="koboSpan" id="kobo.622.1">, when we talked about the two types of animations, </span><em class="italic"><span class="koboSpan" id="kobo.623.1">implicit</span></em><span class="koboSpan" id="kobo.624.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.625.1">explicit</span></em><span class="koboSpan" id="kobo.626.1">? </span><span class="koboSpan" id="kobo.626.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.627.1">withAnimation</span></strong><span class="koboSpan" id="kobo.628.1"> function is an explicit type of animation and is used to animate changes to the view’s state. </span><span class="koboSpan" id="kobo.628.2">It is considered an explicit animation because it requires you to specify the animation that you want to use, as opposed to an implicit animation, which would automatically animate changes without the need for </span><span class="No-Break"><span class="koboSpan" id="kobo.629.1">additional code.</span></span></p>
<p><span class="koboSpan" id="kobo.630.1">So, in the body of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.631.1">withAnimation</span></strong><span class="koboSpan" id="kobo.632.1"> function, we set the </span><strong class="source-inline"><span class="koboSpan" id="kobo.633.1">endStroke</span></strong><span class="koboSpan" id="kobo.634.1"> variable to increase its value by </span><strong class="source-inline"><span class="koboSpan" id="kobo.635.1">0.12</span></strong><span class="koboSpan" id="kobo.636.1"> after every iteration of the animation. </span><span class="koboSpan" id="kobo.636.2">We also set </span><strong class="source-inline"><span class="koboSpan" id="kobo.637.1">startStroke</span></strong><span class="koboSpan" id="kobo.638.1"> to a value that is calculated by subtracting </span><strong class="source-inline"><span class="koboSpan" id="kobo.639.1">0.4</span></strong><span class="koboSpan" id="kobo.640.1"> from </span><strong class="source-inline"><span class="koboSpan" id="kobo.641.1">endStroke</span></strong><span class="koboSpan" id="kobo.642.1"> – this computation creates the length and speed of an animating stroke that I think looks pretty good for the “</span><span class="No-Break"><span class="koboSpan" id="kobo.643.1">We” shape.</span></span></p>
<p><span class="koboSpan" id="kobo.644.1">And with that, this animation is complete. </span><span class="koboSpan" id="kobo.644.2">So, to summarize the code in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.645.1">WeView</span></strong><span class="koboSpan" id="kobo.646.1"> struct, it creates a view that animates a shape, this shape is outlined twice, once with a gray color and a small stroke, and then again, with a red color and a bigger stroke. </span><span class="koboSpan" id="kobo.646.2">The animation is controlled by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.647.1">startStroke</span></strong><span class="koboSpan" id="kobo.648.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.649.1">endStroke</span></strong><span class="koboSpan" id="kobo.650.1"> variables, which are incremented over time. </span><span class="koboSpan" id="kobo.650.2">The animation will be repeated once the </span><strong class="source-inline"><span class="koboSpan" id="kobo.651.1">endStroke</span></strong><span class="koboSpan" id="kobo.652.1"> variable reaches </span><strong class="source-inline"><span class="koboSpan" id="kobo.653.1">1</span></strong><span class="koboSpan" id="kobo.654.1">, and there is a </span><strong class="source-inline"><span class="koboSpan" id="kobo.655.1">0.6</span></strong><span class="koboSpan" id="kobo.656.1">-second delay before the animation </span><span class="No-Break"><span class="koboSpan" id="kobo.657.1">starts again.</span></span></p>
<p><span class="koboSpan" id="kobo.658.1">Now that we have finished with the code, if you click on the </span><strong class="bold"><span class="koboSpan" id="kobo.659.1">Update Preview</span></strong><span class="koboSpan" id="kobo.660.1"> button, you will see that the outline is now a red, five-point line. </span><span class="koboSpan" id="kobo.660.2">Again, these two values are very customizable for different looks for this animation. </span><span class="koboSpan" id="kobo.660.3">By increasing the value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.661.1">endStroke</span></strong><span class="koboSpan" id="kobo.662.1"> in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.663.1">withAnimation</span></strong><span class="koboSpan" id="kobo.664.1"> function, you can leave more of the stroke line on the shape or less of it, depending on the look you want to go for. </span></p>
<p><span class="koboSpan" id="kobo.665.1">Play around with the values and experiment. </span><span class="koboSpan" id="kobo.665.2">You can create a flashing stroke by increasing the speed, or you can have a very slow-moving stroke. </span><span class="koboSpan" id="kobo.665.3">You can stroke the entire shape with a short line, or you can go with a very long line along the </span><span class="No-Break"><span class="koboSpan" id="kobo.666.1">whole shape.</span></span></p>
<p><span class="koboSpan" id="kobo.667.1">That completes</span><a id="_idIndexMarker523"/><span class="koboSpan" id="kobo.668.1"> our first animation, the “WE” image stroke. </span><span class="koboSpan" id="kobo.668.2">Even though that seems like a long process, the whole thing actually only takes a few minutes once you get familiar with the different programs and techniques used. </span><span class="koboSpan" id="kobo.668.3">We are going to move on to the heart image now and repeat the same process. </span><span class="koboSpan" id="kobo.668.4">After all, practice </span><span class="No-Break"><span class="koboSpan" id="kobo.669.1">makes perfect!</span></span></p>
<h2 id="_idParaDest-130"><a id="_idTextAnchor134"/><span class="koboSpan" id="kobo.670.1">Creating a stroke animation on the heart image</span></h2>
<p><span class="koboSpan" id="kobo.671.1">Okay, we have</span><a id="_idIndexMarker524"/><span class="koboSpan" id="kobo.672.1"> animated</span><a id="_idIndexMarker525"/><span class="koboSpan" id="kobo.673.1"> our first image, so we are going to follow the same process again for two more images. </span><span class="koboSpan" id="kobo.673.2">The next image will be a heart – for this one, we will animate a stroke around it as we did with the letters, but also we will add the heart image back into </span><span class="No-Break"><span class="koboSpan" id="kobo.674.1">the scene.</span></span></p>
<p><span class="koboSpan" id="kobo.675.1">If you are following along with the book’s project, you can find the heart image in the GitHub repository, where the background has already been removed. </span><span class="koboSpan" id="kobo.675.2">However, if you are using your own images, you will need to do </span><span class="No-Break"><span class="koboSpan" id="kobo.676.1">this yourself.</span></span></p>
<p><span class="koboSpan" id="kobo.677.1">After you have prepared your image, now open it with Inkscape so that you can vectorize it. </span><span class="koboSpan" id="kobo.677.2">With the image selected in the editor, go to the </span><strong class="bold"><span class="koboSpan" id="kobo.678.1">Path</span></strong><span class="koboSpan" id="kobo.679.1"> menu at the top and choose </span><strong class="bold"><span class="koboSpan" id="kobo.680.1">Trace Bitmap</span></strong><span class="koboSpan" id="kobo.681.1">; this will trace the image and prepare it for vectorization, </span><span class="No-Break"><span class="koboSpan" id="kobo.682.1">as before.</span></span></p>
<p><span class="koboSpan" id="kobo.683.1">With the image selected on the canvas, if you look at the </span><strong class="bold"><span class="koboSpan" id="kobo.684.1">Previews</span></strong><span class="koboSpan" id="kobo.685.1"> pane at the right, the image has been converted into black and white. </span><span class="koboSpan" id="kobo.685.2">That’s because, by default, Inkscape selects the </span><strong class="bold"><span class="koboSpan" id="kobo.686.1">Single Scan</span></strong><span class="koboSpan" id="kobo.687.1"> option, the option for black-and-white images. </span><span class="koboSpan" id="kobo.687.2">And even though this is a color image, because it’s such a simple shape with not many variations of red in it, we don’t need the </span><strong class="bold"><span class="koboSpan" id="kobo.688.1">Multicolor</span></strong><span class="koboSpan" id="kobo.689.1"> option; so, </span><strong class="bold"><span class="koboSpan" id="kobo.690.1">Single scan</span></strong><span class="koboSpan" id="kobo.691.1"> will work </span><span class="No-Break"><span class="koboSpan" id="kobo.692.1">fine here.</span></span></p>
<p><span class="koboSpan" id="kobo.693.1">This is also a good opportunity to use the </span><strong class="bold"><span class="koboSpan" id="kobo.694.1">Smooth Corners</span></strong><span class="koboSpan" id="kobo.695.1"> option as well because this shape has (for the most part) smooth corners, and this selection will </span><span class="No-Break"><span class="koboSpan" id="kobo.696.1">preserve them.</span></span></p>
<p><span class="koboSpan" id="kobo.697.1">This is what it should look like </span><span class="No-Break"><span class="koboSpan" id="kobo.698.1">so far:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer132">
<span class="koboSpan" id="kobo.699.1"><img alt="Figure 9.15: The heart image in Inkscape " src="image/B18674_09_15.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.700.1">Figure 9.15: The heart image in Inkscape</span></p>
<p><span class="koboSpan" id="kobo.701.1">Also, do you notice that the</span><a id="_idIndexMarker526"/><span class="koboSpan" id="kobo.702.1"> heart image shown in </span><strong class="bold"><span class="koboSpan" id="kobo.703.1">Preview</span></strong><span class="koboSpan" id="kobo.704.1"> has two white</span><a id="_idIndexMarker527"/><span class="koboSpan" id="kobo.705.1"> areas inside it? </span><span class="koboSpan" id="kobo.705.2">That’s the Inkscape algorithm trying to capture the shiny parts of the red heart image on the canvas. </span><span class="koboSpan" id="kobo.705.3">We only want to trace the outside perimeter of the heart, which is the area that will be outlined later in the code – we don’t want those white areas. </span><span class="koboSpan" id="kobo.705.4">To remove those white areas in the preview, slide the </span><strong class="bold"><span class="koboSpan" id="kobo.706.1">Threshold</span></strong><span class="koboSpan" id="kobo.707.1"> slider to the right, just enough so the heart fills up </span><span class="No-Break"><span class="koboSpan" id="kobo.708.1">like this:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer133">
<span class="koboSpan" id="kobo.709.1"><img alt="Figure 9.16: Setting the options in Inkscape for the heart image " src="image/B18674_09_16.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.710.1">Figure 9.16: Setting the options in Inkscape for the heart image</span></p>
<p><span class="koboSpan" id="kobo.711.1">Now that the heart shape</span><a id="_idIndexMarker528"/><span class="koboSpan" id="kobo.712.1"> is ready to be vectorized, click the </span><strong class="bold"><span class="koboSpan" id="kobo.713.1">Apply</span></strong><span class="koboSpan" id="kobo.714.1"> button to complete</span><a id="_idIndexMarker529"/><span class="koboSpan" id="kobo.715.1"> the process, and a new vectorized black heart is placed directly over the red heart image on the canvas. </span><span class="koboSpan" id="kobo.715.2">Drag the black heart off to the side, in order to see the red heart under it, then delete the </span><span class="No-Break"><span class="koboSpan" id="kobo.716.1">red heart.</span></span></p>
<p><span class="koboSpan" id="kobo.717.1">Next, position the black heart back over the white canvas and export it like the “WE” image, making sure to choose the </span><strong class="bold"><span class="koboSpan" id="kobo.718.1">Plain SVG (*.svg)</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.719.1">file type.</span></span></p>
<p><span class="koboSpan" id="kobo.720.1">Moving away from Inkscape and into the Sketch program, open the new vector image we just exported from Inkscape into Sketch by right-clicking on the image and selecting </span><strong class="bold"><span class="koboSpan" id="kobo.721.1">Open with Sketch</span></strong><span class="koboSpan" id="kobo.722.1">. </span><span class="koboSpan" id="kobo.722.2">We will resize the image again to a width of </span><strong class="bold"><span class="koboSpan" id="kobo.723.1">250</span></strong><span class="koboSpan" id="kobo.724.1"> (again, making sure to click on the lock icon to fix </span><span class="No-Break"><span class="koboSpan" id="kobo.725.1">the proportions):</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer134">
<span class="koboSpan" id="kobo.726.1"><img alt="Figure 9.17: Setting the size for the heart image in Sketch " src="image/B18674_09_17.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.727.1">Figure 9.17: Setting the size for the heart image in Sketch</span></p>
<p><span class="koboSpan" id="kobo.728.1">Next minimize the Sketch</span><a id="_idIndexMarker530"/><span class="koboSpan" id="kobo.729.1"> window, as we only need it running</span><a id="_idIndexMarker531"/><span class="koboSpan" id="kobo.730.1"> in the background so that Kite can access it, and open the Kite program. </span><span class="koboSpan" id="kobo.730.2">In Kite, click on </span><strong class="bold"><span class="koboSpan" id="kobo.731.1">File</span></strong><span class="koboSpan" id="kobo.732.1">, then </span><strong class="bold"><span class="koboSpan" id="kobo.733.1">Import</span></strong><span class="koboSpan" id="kobo.734.1">, and then </span><strong class="bold"><span class="koboSpan" id="kobo.735.1">From Sketch</span></strong><span class="koboSpan" id="kobo.736.1">. </span><span class="koboSpan" id="kobo.736.2">You will see the same window as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.737.1">Figure 9</span></em></span><em class="italic"><span class="koboSpan" id="kobo.738.1">.12</span></em><span class="koboSpan" id="kobo.739.1">, and you can keep the default settings. </span><span class="koboSpan" id="kobo.739.2">Then, </span><span class="No-Break"><span class="koboSpan" id="kobo.740.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.741.1">Import</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.742.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.743.1">Once the image has been imported, select the image on the canvas, and then click the </span><strong class="bold"><span class="koboSpan" id="kobo.744.1">Code</span></strong><span class="koboSpan" id="kobo.745.1"> button at the top to generate the Swift code </span><span class="No-Break"><span class="koboSpan" id="kobo.746.1">we need:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer135">
<span class="koboSpan" id="kobo.747.1"><img alt="Figure 9.18: Generating the heart’s Swift code in Kite " src="image/B18674_09_18.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.748.1">Figure 9.18: Generating the heart’s Swift code in Kite</span></p>
<p><span class="koboSpan" id="kobo.749.1">Like we did with the “WE” image</span><a id="_idIndexMarker532"/><span class="koboSpan" id="kobo.750.1"> code, we just want to copy the code</span><a id="_idIndexMarker533"/><span class="koboSpan" id="kobo.751.1"> that starts with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.752.1">pathtPath</span></strong><span class="koboSpan" id="kobo.753.1"> name. </span><span class="koboSpan" id="kobo.753.2">In the example here, the code we need starts at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.754.1">let pathPath = CGMutablePath()</span></strong><span class="koboSpan" id="kobo.755.1"> line and ends </span><span class="No-Break"><span class="koboSpan" id="kobo.756.1">with </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.757.1">pathPath.move(to)</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.758.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.759.1">Now back to Xcode – create a new SwiftUI View file, which I will name </span><strong class="source-inline"><span class="koboSpan" id="kobo.760.1">HeartView</span></strong><span class="koboSpan" id="kobo.761.1">. </span><span class="koboSpan" id="kobo.761.2">Inside the file, we will create a struct to put the code in, call it </span><strong class="source-inline"><span class="koboSpan" id="kobo.762.1">HeartShape</span></strong><span class="koboSpan" id="kobo.763.1">, and make it conform to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.764.1">shape</span></strong><span class="koboSpan" id="kobo.765.1"> protocol, </span><span class="No-Break"><span class="koboSpan" id="kobo.766.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.767.1">
struct HeartShape: Shape {
    func path(in rect: CGRect) -&gt; Path {
    }
 }</span></pre>
<p><span class="koboSpan" id="kobo.768.1">Remember when making the “WE” shape, we used the shape protocol? </span><span class="koboSpan" id="kobo.768.2">As before, it requires us to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.769.1">path()</span></strong><span class="koboSpan" id="kobo.770.1"> method, which I have added here. </span></p>
<p><span class="koboSpan" id="kobo.771.1">Now, we can paste the Kite-generated</span><a id="_idIndexMarker534"/><span class="koboSpan" id="kobo.772.1"> Swift code inside this method (again, I will only include the first few lines</span><a id="_idIndexMarker535"/><span class="koboSpan" id="kobo.773.1"> and the last few lines so as not to take up too much space here; as before, the complete code file and project are available in the </span><span class="No-Break"><span class="koboSpan" id="kobo.774.1">GitHub repo):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.775.1">
struct HeartShape: Shape {
  func path(in rect: CGRect) -&gt; Path {
    let pathPath = CGMutablePath()
       pathPath.move(to: CGPoint(x: 245.632095, y: 
         460.368713))
       pathPath.addCurve(to: CGPoint(x: 221.824585, y: 
         420.429504), control1: CGPoint(x: 240.765762, y: 
         449.02652), control2: CGPoint(x: 231.057922, y: 
         432.740723))
........................................................
</span><span class="koboSpan" id="kobo.775.2">      pathPath.closeSubpath()
       pathPath.move(to: CGPoint(x: 245.632095, y: 
         460.368713))
    }
 }</span></pre>
<p><span class="koboSpan" id="kobo.776.1">Next, let’s refactor the code as we did before. </span><em class="italic"><span class="koboSpan" id="kobo.777.1">Command + click</span></em><span class="koboSpan" id="kobo.778.1"> on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.779.1">pathPath</span></strong><span class="koboSpan" id="kobo.780.1"> instance and choose </span><strong class="bold"><span class="koboSpan" id="kobo.781.1">Rename</span></strong><span class="koboSpan" id="kobo.782.1">, then simply name it </span><strong class="source-inline"><span class="koboSpan" id="kobo.783.1">path</span></strong><span class="koboSpan" id="kobo.784.1">. </span><span class="koboSpan" id="kobo.784.2">Also, change the mutability of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.785.1">path</span></strong><span class="koboSpan" id="kobo.786.1"> constant to a variable by replacing </span><strong class="source-inline"><span class="koboSpan" id="kobo.787.1">let</span></strong><span class="koboSpan" id="kobo.788.1"> with </span><strong class="source-inline"><span class="koboSpan" id="kobo.789.1">var</span></strong><span class="koboSpan" id="kobo.790.1">, and change </span><strong class="source-inline"><span class="koboSpan" id="kobo.791.1">CGMutablePath()</span></strong><span class="koboSpan" id="kobo.792.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.793.1">Path()</span></strong><span class="koboSpan" id="kobo.794.1">. </span><span class="koboSpan" id="kobo.794.2">These changes should look </span><span class="No-Break"><span class="koboSpan" id="kobo.795.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.796.1">
var path = Path()</span></pre>
<p><span class="koboSpan" id="kobo.797.1">The last change to make is at the bottom of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.798.1">HeartShape</span></strong><span class="koboSpan" id="kobo.799.1"> struct; after the very last line of code, we need to return the path we created, so add the following line of code to the end of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.800.1">path</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.801.1"> function:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.802.1">
return path</span></pre>
<p><span class="koboSpan" id="kobo.803.1">The code should now build</span><a id="_idIndexMarker536"/><span class="koboSpan" id="kobo.804.1"> cleanly, and we can move on to animating</span><a id="_idIndexMarker537"/><span class="koboSpan" id="kobo.805.1"> the outline around the heart. </span><span class="koboSpan" id="kobo.805.2">This is similar code to that in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.806.1">WEView</span></strong><span class="koboSpan" id="kobo.807.1"> file. </span><span class="koboSpan" id="kobo.807.2">At the top of the struct, let’s add the </span><span class="No-Break"><span class="koboSpan" id="kobo.808.1">following variables:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.809.1">
//MARK: - VARIABLES
    @State var strokeReset: Bool = true
    @State var startStroke: CGFloat = 0.0
    @State var endStroke: CGFloat = 0.0</span></pre>
<p><span class="koboSpan" id="kobo.810.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.811.1">strokeReset</span></strong><span class="koboSpan" id="kobo.812.1"> variable will keep track of the animation, </span><strong class="source-inline"><span class="koboSpan" id="kobo.813.1">startStroke</span></strong><span class="koboSpan" id="kobo.814.1"> will hold a value that sets the </span><strong class="source-inline"><span class="koboSpan" id="kobo.815.1">length</span></strong><span class="koboSpan" id="kobo.816.1"> property of the stroke at the beginning, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.817.1">endStroke</span></strong><span class="koboSpan" id="kobo.818.1"> will hold a value that sets the </span><strong class="source-inline"><span class="koboSpan" id="kobo.819.1">length</span></strong><span class="koboSpan" id="kobo.820.1"> property of the stroke at </span><span class="No-Break"><span class="koboSpan" id="kobo.821.1">the end.</span></span></p>
<p><span class="koboSpan" id="kobo.822.1">Moving into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.823.1">body</span></strong><span class="koboSpan" id="kobo.824.1"> property of the struct, let’s add the views needed to display and animate our </span><span class="No-Break"><span class="koboSpan" id="kobo.825.1">heart outline:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.826.1">
var body: some View {
  ZStack {
    Group {
      //SHAPE OUTLINE
      HeartShape()
          .stroke(style: StrokeStyle(lineWidth: 0.5, 
            lineCap: .round, lineJoin: .round))
          .foregroundColor(.gray)
      //ANIMATING STROKE
      HeartShape()
          .trim(from: startStroke, to: endStroke)
          .stroke(style: StrokeStyle(lineWidth: 5, lineCap: 
            .round, lineJoin: .round))
          .foregroundColor(Color.white)
  }.offset (x: 75, y: -30)
  }.onAppear() {
    Timer.scheduledTimer(withTimeInterval: 0.23, repeats: 
      true) { timer in
        if (endStroke &gt;= 1) {
          if (strokeReset) {
              Timer.scheduledTimer(withTimeInterval: 0.6, 
                repeats: false) { _ in
                  endStroke = 0
                  startStroke = 0
                  strokeReset.toggle()
              }
              strokeReset = false
          }
      }
      withAnimation(Animation.easeOut) {
          endStroke += 0.12
          startStroke = endStroke - 0.4 
      }
    }
  }
}</span></pre>
<p><span class="koboSpan" id="kobo.827.1">The code here is almost identical to the code in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.828.1">WEView</span></strong><span class="koboSpan" id="kobo.829.1"> file – what’s different is the color of the stroke. </span><span class="koboSpan" id="kobo.829.2">Here, it is white and we are offsetting the heart to be lower on </span><span class="No-Break"><span class="koboSpan" id="kobo.830.1">the screen.</span></span></p>
<p><span class="koboSpan" id="kobo.831.1">Run the code and you’ll see that there is a smoothly animating stroke going around the </span><span class="No-Break"><span class="koboSpan" id="kobo.832.1">heart shape.</span></span></p>
<p><span class="koboSpan" id="kobo.833.1">Again, all the values</span><a id="_idIndexMarker538"/><span class="koboSpan" id="kobo.834.1"> are for you to explore and experiment</span><a id="_idIndexMarker539"/><span class="koboSpan" id="kobo.835.1"> with to create the look </span><span class="No-Break"><span class="koboSpan" id="kobo.836.1">you want.</span></span></p>
<p><span class="koboSpan" id="kobo.837.1">But let’s do something a bit different for this shape – let’s add the actual heart bitmap image right inside the animating heart shape. </span><span class="koboSpan" id="kobo.837.2">To do this, add the following code at the bottom of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.838.1">Group</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.839.1"> view:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.840.1">
Group {
      //SHAPE OUTLINE
      HeartShape()
          .stroke(style: StrokeStyle(lineWidth: 0.5, 
            lineCap: .round, lineJoin: .round))
          .foregroundColor(.gray)
      //ANIMATING STROKE
      HeartShape()
          .trim(from: startStroke, to: endStroke)
          .stroke(style: StrokeStyle(lineWidth: 5, lineCap: 
            .round, lineJoin: .round))
          .foregroundColor(Color.blue)
     </span><strong class="bold"><span class="koboSpan" id="kobo.841.1"> ///HEART BITMAP IMAGE</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.842.1">      Image("heart").resizable().aspectRatio(contentMode: </span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.843.1">        .fit)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.844.1">          .frame(width: 246, alignment: .center)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.845.1">          .position(x: 125, y:117.5)</span></strong><span class="koboSpan" id="kobo.846.1">
     }</span></pre>
<p><span class="koboSpan" id="kobo.847.1">Run the code again and you’ll see</span><a id="_idIndexMarker540"/><span class="koboSpan" id="kobo.848.1"> that it performs as before, only now</span><a id="_idIndexMarker541"/><span class="koboSpan" id="kobo.849.1"> we’ve positioned the heart bitmap image inside the stationary stroke, so the animated stroke is tracing the heart image for an </span><span class="No-Break"><span class="koboSpan" id="kobo.850.1">interesting look:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer136">
<span class="koboSpan" id="kobo.851.1"><img alt="Figure 9.19: The stroke around the heart image " src="image/B18674_09_19.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.852.1">Figure 9.19: The stroke around the heart image</span></p>
<p><span class="koboSpan" id="kobo.853.1">We have completed two shapes now, the “WE” letters and the heart. </span><span class="koboSpan" id="kobo.853.2">Let’s continue and add the final image to the project, the </span><span class="No-Break"><span class="koboSpan" id="kobo.854.1">SwiftUI logo.</span></span></p>
<h2 id="_idParaDest-131"><a id="_idTextAnchor135"/><span class="koboSpan" id="kobo.855.1">Creating a stroke animation on the SwiftUI logo image</span></h2>
<p><span class="koboSpan" id="kobo.856.1">Now that we have reached</span><a id="_idIndexMarker542"/><span class="koboSpan" id="kobo.857.1"> the final image, I would like to challenge</span><a id="_idIndexMarker543"/><span class="koboSpan" id="kobo.858.1"> you by letting you take this one on by yourself. </span><span class="koboSpan" id="kobo.858.2">Use the steps we have outlined in the previous two shapes – including removing backgrounds, vectorizing your image, and converting the image into Swift Code – and copy the code into a new SwiftUI View file </span><span class="No-Break"><span class="koboSpan" id="kobo.859.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.860.1">SwiftUILogoView</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.861.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.862.1">Okay, give it a try, and come back here when </span><span class="No-Break"><span class="koboSpan" id="kobo.863.1">you’re ready…</span></span></p>
<p><span class="koboSpan" id="kobo.864.1">How did </span><span class="No-Break"><span class="koboSpan" id="kobo.865.1">you do?</span></span></p>
<p><span class="koboSpan" id="kobo.866.1">After you vectorize a few shapes and gather the code, the process will become very familiar and much quicker. </span><span class="koboSpan" id="kobo.866.2">If you have used images other than the ones I supplied for this project, that’s perfectly fine; just know that the SwiftUI code for those images will be different from the code I will show here for the SwiftUI logo, but the animating code will be </span><span class="No-Break"><span class="koboSpan" id="kobo.867.1">the same.</span></span></p>
<p><span class="koboSpan" id="kobo.868.1">Here is the SwiftUI code that I got back from Kite for the SwiftUI logo image (and as before, the full code file is available in the </span><span class="No-Break"><span class="koboSpan" id="kobo.869.1">GitHub repo):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.870.1">
struct SwiftUILogoShape: Shape {
  func path(in rect: CGRect) -&gt; Path {
    var path = Path()
    path.move(to: CGPoint(x: 201.374207, y: 235.109955))
    path.addCurve(to: CGPoint(x: 231.023102, y: 
      220.544876), control1: CGPoint(x: 212.656006, y: 
      233.244553), control2: CGPoint(x: 222.89035, y: 
      228.216904))
   ........................................................
</span><span class="koboSpan" id="kobo.870.2">     path.addCurve(to: CGPoint(x: 207.854324, y: 
       191.140839), control1: CGPoint(x: 209.692215, y: 
       193.796051), control2: CGPoint(x: 208.764877, y: 
       192.663177))
     path.addLine(to: CGPoint(x: 207.854324, y: 
       191.140839))
     path.closeSubpath()
     path.move(to: CGPoint(x: 207.854324, y: 191.140839))
        return path
    }
}</span></pre>
<p><span class="koboSpan" id="kobo.871.1">I have previously explained</span><a id="_idIndexMarker544"/><span class="koboSpan" id="kobo.872.1"> how this code creates a shape</span><a id="_idIndexMarker545"/><span class="koboSpan" id="kobo.873.1"> object in the </span><em class="italic"><span class="koboSpan" id="kobo.874.1">Creating a stroke animation on the “WE” image</span></em><span class="koboSpan" id="kobo.875.1"> section; if you would like a refresher on understanding how this works, go back to that section for the details on </span><span class="No-Break"><span class="koboSpan" id="kobo.876.1">this code.</span></span></p>
<p><span class="koboSpan" id="kobo.877.1">We can now move to the top of the file, inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.878.1">SwiftUILogo</span></strong><span class="koboSpan" id="kobo.879.1"> struct, and start adding the animation code. </span><span class="koboSpan" id="kobo.879.2">I will add the complete code for this </span><span class="No-Break"><span class="koboSpan" id="kobo.880.1">final shape:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.881.1">
struct SwiftUILogoView: View {
    //MARK: - VARIABLES
    @State var strokeReset: Bool = true
    @State var startStroke: CGFloat = 0.0
    @State var endStroke: CGFloat = 0.0
    var body: some View {
      ZStack {
        Group {
          //SHAPE OUTLINE
              SwiftUILogoShape()
          .stroke(style: StrokeStyle(lineWidth: 0.5, 
            lineCap: .round, lineJoin: .round))
          .foregroundColor(.gray)
      //ANIMATING STROKE
      SwiftUILogoShape()
          .trim(from: startStroke, to: endStroke)
          .stroke(style: StrokeStyle(lineWidth: 5, lineCap: 
            .round, lineJoin: .round))
          .foregroundColor(Color.blue)
  }.offset(x: UIScreen.main.bounds.size.width / 5.5)
    }.onAppear() {
  Timer.scheduledTimer(withTimeInterval: 0.23, repeats: 
    true) { timer in
      if (endStroke &gt;= 1) {
          if (strokeReset) {
              Timer.scheduledTimer(withTimeInterval: 0.6, 
                repeats: false) { _ in
                  endStroke = 0
                  startStroke = 0
                  strokeReset.toggle()
              }
              strokeReset = false
          }
      }
      withAnimation(Animation.easeOut) {
          endStroke += 0.12
          startStroke = endStroke - 0.4 
        }
      }
   }
  }
}</span></pre>
<p><span class="koboSpan" id="kobo.882.1">This animating code is the same code that we have been adding all along, and if you would like an explanation of how it works, go back to the “WE” shape code for all the details. </span><span class="koboSpan" id="kobo.882.2">The minor differences here are that the line is blue, and we are offsetting it lower on </span><span class="No-Break"><span class="koboSpan" id="kobo.883.1">the screen.</span></span></p>
<p><span class="koboSpan" id="kobo.884.1">Give this a run and check</span><a id="_idIndexMarker546"/><span class="koboSpan" id="kobo.885.1"> out the stroke</span><a id="_idIndexMarker547"/><span class="koboSpan" id="kobo.886.1"> around </span><span class="No-Break"><span class="koboSpan" id="kobo.887.1">the logo.</span></span></p>
<p><span class="koboSpan" id="kobo.888.1">The final part of the project is to combine all three of the shape structs onto the screen together. </span><span class="koboSpan" id="kobo.888.2">Let’s do </span><span class="No-Break"><span class="koboSpan" id="kobo.889.1">that next.</span></span></p>
<h2 id="_idParaDest-132"><a id="_idTextAnchor136"/><span class="koboSpan" id="kobo.890.1">Combining the animated strokes</span></h2>
<p><span class="koboSpan" id="kobo.891.1">There is very little code needed</span><a id="_idIndexMarker548"/><span class="koboSpan" id="kobo.892.1"> for this, as we are just calling the three shape structs in one place. </span><span class="koboSpan" id="kobo.892.2">All you need to do is add the following code to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.893.1">ContentView</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.894.1"> struct:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.895.1">
struct ContentView: View {
    var body: some View {
        VStack  {
            WeView()
            HeartView()
            SwiftUILogoView()
        }.background(Color.black)
    }
}</span></pre>
<p><span class="koboSpan" id="kobo.896.1">What we have done here is called all three structs inside </span><strong class="source-inline"><span class="koboSpan" id="kobo.897.1">ContentView</span></strong><span class="koboSpan" id="kobo.898.1">, used a </span><strong class="source-inline"><span class="koboSpan" id="kobo.899.1">VStack</span></strong><span class="koboSpan" id="kobo.900.1"> to line up the views vertically, and then added a black background at the end. </span><span class="koboSpan" id="kobo.900.2">When you run the code, you will see the </span><span class="No-Break"><span class="koboSpan" id="kobo.901.1">following result:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer137">
<span class="koboSpan" id="kobo.902.1"><img alt="Figure 9.20: The finished project " src="image/B18674_09_20.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.903.1">Figure 9.20: The finished project</span></p>
<p><span class="koboSpan" id="kobo.904.1">Now, all three</span><a id="_idIndexMarker549"/><span class="koboSpan" id="kobo.905.1"> views are animated as being outlined with </span><span class="No-Break"><span class="koboSpan" id="kobo.906.1">different colors.</span></span></p>
<h1 id="_idParaDest-133"><a id="_idTextAnchor137"/><span class="koboSpan" id="kobo.907.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.908.1">Nice job finishing this project! </span><span class="koboSpan" id="kobo.908.2">To create the finished animation, we learned how to turn bitmap images into vector files, and then how to turn those vector files into code that we can work with using SwiftUI. </span><span class="koboSpan" id="kobo.908.3">Also, we learned how to create and animate a moving outline around almost any shape using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.909.1">stroke</span></strong><span class="koboSpan" id="kobo.910.1"> modifier and timers, and used animation in </span><span class="No-Break"><span class="koboSpan" id="kobo.911.1">this project.</span></span></p>
<p><span class="koboSpan" id="kobo.912.1">Using this project, you can play around with the values. </span><span class="koboSpan" id="kobo.912.2">You can make the stroke thicker or thinner, make it move faster or slower, and make it any color of the rainbow. </span></p>
<p><span class="koboSpan" id="kobo.913.1">There are many applications for animating strokes in your apps, too. </span><span class="koboSpan" id="kobo.913.2">It can be used for logos, text, and brands, so that they stand out and get noticed; it can be used in game apps to bring the users’ attention to different areas of the screen or can be used anywhere you want to make an app come alive. </span><span class="koboSpan" id="kobo.913.3">The uses are only limited by </span><span class="No-Break"><span class="koboSpan" id="kobo.914.1">your imagination.</span></span></p>
<p><span class="koboSpan" id="kobo.915.1">In the next chapter, we will learn how to animate lines in a different way to create waves, and then put them together to make an ocean with an animating buoy, complete with </span><span class="No-Break"><span class="koboSpan" id="kobo.916.1">sound effects.</span></span></p>
</div>
<div>
<div class="Content" id="_idContainer139">
</div>
</div>
</body></html>