<html><head></head><body>
		<div><h1 id="_idParaDest-47"><em class="italic"><a id="_idTextAnchor046"/>Chapter 2</em>: Working with Dark Mode</h1>
			<p>We all love it…well most of us do anyway, and those who do have been asking for it for a while now too. Apple first took the plunge into Dark Mode with macOS Mojave back in 2018, not only changing the way users interacted with the OS but also paving the way for developers to build native dark-themed apps for the first time.</p>
			<p>Dark mode for iPhone wasn't announced until WWDC 2019, but we all knew it was coming, and with everything that AppKit had offered, we knew we were in for a treat with what UIKit would have to offer.</p>
			<p>In this chapter, we'll cover everything you need to know to get up and running with dark mode in iOS and iPadOS; everything from taking an existing app and making the necessary adjustments to support dark mode, to all the little hidden extras that we can add in when building our app to ensure we give the user the best possible experience. We'll also touch on best practices too – taking note of the little things we can do that allow Dark Mode in UIKit to make our lives so much easier from the start.</p>
			<p>The following topics will be covered in this chapter:</p>
			<ul>
				<li>What is Dark Mode?</li>
				<li>Working with views in Dark Mode</li>
				<li>Working with assets</li>
				<li>Further exploring Dark Mode</li>
			</ul>
			<h1 id="_idParaDest-48"><a id="_idTextAnchor047"/>Technical requirements </h1>
			<p>For this chapter, you'll need to download Xcode version 11.4 or above from Apple's App Store. </p>
			<p>You'll also need to be running the latest version of macOS (Catalina or above). Simply search for Xcode in the App Store and select and download the latest version. Launch Xcode and follow any additional installation instructions that your system may prompt you with. Once Xcode has fully launched, you're ready to go.</p>
			<p>Download the sample code from the following GitHub link: <a href="https://github.com/PacktPublishing/Mastering-iOS-14-Programming-4th-Edition">https://github.com/PacktPublishing/Mastering-iOS-14-Programming-4th-Edition</a>.</p>
			<h1 id="_idParaDest-49"><a id="_idTextAnchor048"/>What is Dark Mode?</h1>
			<p>In this section, we'll <a id="_idIndexMarker056"/>start by taking a look at what exactly Dark Mode is, how we can use it, and what it can do not only for the end user but also for developers. We'll cover everything from enabling it on our devices to using environment overrides in Xcode and developer options in the simulator.</p>
			<h2 id="_idParaDest-50"><a id="_idTextAnchor049"/>Understanding why we would need Dark Mode </h2>
			<p>As I covered in the <a id="_idIndexMarker057"/>introduction of this chapter, most of us have been craving dark mode in iOS for a very long time now. Us developers got our Xcode fix back in 2018 – but one of the burning questions I've been asked many times (especially in the past 12 months) is…why?</p>
			<p>It could be down to something as simple as the time of the day. Satellite navigation systems have been doing it in our cars for years – as soon as the sun goes down, our system switches, and a more relaxing, subtle version of our road home pops up on our screen – so why not do that for our apps?</p>
			<p>Well, it turns out that some apps have already been doing that for a while (to a degree), while not necessarily offering an automatic nocturnal mode. The Twitter app for iOS offered a "dark mode" option long before the WWDC 19 announcement. </p>
			<p>Let's stop for a moment and think about the logic behind such a control, along with everything you'd need to change to achieve this. I'm sure a company as big as Twitter has written their own internal <a id="_idIndexMarker058"/>framework to handle this, but under the hood, it's basically going look a lot like the following:</p>
			<pre>var isDarkMode = false
var profileLabel: UILabel? {
    didSet {
        profileLabel?.textColor = isDarkMode ? .white : .black
    }
}
var profileBackground: UILabel? {
    didSet {
        profileBackground?.textColor = isDarkMode ? .black : .white
    }
}</pre>
			<p>Everything will have to be taken into consideration, from the text color to the drop shadows that you might have decorating your UIButton or UIViews.</p>
			<p>The background is a massive change to consider too. One common pattern that a lot of iOS developers follow is to quite simply develop a brand-new app on top of a white canvas; from here, we don't need to worry about controlling the background color or keeping track of it with an IBOutlet – it's simply the tablecloth for the rest of our app to sit on.</p>
			<p>With implementing a dark mode feature, everything needs to be changed – even asset images that sit proudly on one style of background could be lost in another. Let's take a look at some of the developer features that come bundled with Xcode when implementing Dark Mode.</p>
			<h2 id="_idParaDest-51"><a id="_idTextAnchor050"/>Core developer concepts of Dark Mode</h2>
			<p>Let's start by taking a <a id="_idIndexMarker059"/>look at how we go about developing with Dark Mode by switching to it on our device. If you've not already done this, you can simply toggle it by going to <strong class="bold">Settings</strong> | <strong class="bold">Display &amp; Brightness</strong>, and you should be presented with the following screen:</p>
			<div><div><img src="img/Figure_2.01_B14717.jpg" alt="Figure 2.1 – Display and brightness&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.1 – Display and brightness</p>
			<p>You'll also notice the <strong class="bold">Automatic</strong> toggle option too, giving us the ability to use either <strong class="bold">Sunset to Sunrise</strong> or a custom schedule, which will automatically switch between light and dark appearance (just like our sat nav).</p>
			<p>Now that we've got that covered, let's take a look at some options given to developers in the iOS simulator. Let's start by taking the following steps:</p>
			<ol>
				<li>Open up Xcode.</li>
				<li>Launch the simulator (<strong class="bold">Xcode | Open Developer Tool | Simulator</strong>).<p>In a slightly different location than the end user's version of iOS, you'll find the dark toggle under the developer settings (<strong class="bold">Settings | Developer | Dark Appearance</strong>):</p></li>
			</ol>
			<div><div><img src="img/Figure_2.02_B14717.jpg" alt="Figure 2.2 – Dark mode developer settings&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.2 – Dark mode developer settings</p>
			<p>Rather than a fancy <a id="_idIndexMarker060"/>interface like we saw earlier, we're presented with just the standard toggle. Let's take a look now at what we can do as developers with Dark Mode.</p>
			<h2 id="_idParaDest-52"><a id="_idTextAnchor051"/>Dark mode from inside Xcode</h2>
			<p>Now that we've taken <a id="_idIndexMarker061"/>a look at how<a id="_idIndexMarker062"/> iOS handles switching to dark mode, let's have a look at how we, the developer, can do the same in Xcode.</p>
			<p>Out of the box, all new projects building against the iOS 13 SDK will automatically support dark mode; however, building against any earlier SDKs won't.</p>
			<p>This helps out a little as your existing app may not have all the necessary tweaks to support dark mode yet and you don't want to release an update to find you have broken your app for those now running dark mode.</p>
			<p>However, if you update your project to the iOS 13 SDK, then you could potentially run into this problem, but don't worry, we'll cover getting your existing app ready for dark mode later, in the <em class="italic">Migrating existing apps to Dark Mode</em> section in this chapter.</p>
			<p>Let's start by having a look at storyboards – we all love them (or hate them) but the one thing they have done over the years is present themselves on a whiter-than-white canvas.</p>
			<p>Let's get started:</p>
			<ol>
				<li value="1">Launch Xcode and create a new <strong class="bold">Single View - Storyboard</strong> project. </li>
				<li>Call this anything you want (I'll call mine <code>Chapter 2 - Dark Mode</code>).<p>You can either follow along throughout this chapter or download the sample code from GitHub.</p></li>
			</ol>
			<p>Once created, click on <strong class="bold">Main.Storyboard</strong> and you should be presented with the following:</p>
			<div><div><img src="img/Figure_2.03_B14717.jpg" alt="Figure 2.3 – Xcode interface style&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.3 – Xcode interface style</p>
			<p>I've highlighted in the preceding screenshot our area of interest – here, we have a preview toggle for both light<a id="_idIndexMarker063"/> and dark <a id="_idIndexMarker064"/>appearances from within the storyboard, so at a quick glance, we can see what the objects we've added to our canvas look like without the need to launch the simulator.</p>
			<p>Now, this won't always help us as some of our UILabels or UIButtons could be decorated programmatically. However, it's a great start and will most definitely come in useful during the development cycle of any app.</p>
			<p>Let's take a look at our labels in action. Here, we've added a UILabel straight out of the box. <strong class="bold">Light Appearance</strong> is selected, and the label looks just how we are used to seeing things at this stage:</p>
			<div><div><img src="img/Figure_2.04_B14717.jpg" alt="Figure 2.4 – Main storyboard&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.4 – Main storyboard</p>
			<p>Now, let's <a id="_idIndexMarker065"/>switch the <a id="_idIndexMarker066"/>toggle to <strong class="bold">Dark Appearance</strong> and see what happens:</p>
			<div><div><img src="img/Figure_2.05_B14717.jpg" alt="Figure 2.5 – Main storyboard – dark mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.5 – Main storyboard – dark mode</p>
			<p>As if by magic, our canvas enters dark mode, and the color of our UILabel is automatically adjusted. We can see straight away, without the need to compile or run the app on a device or in the simulator, how it will look with each interface style.</p>
			<p>I guess the million-dollar question is <em class="italic">how did iOS know to switch the color of the UILabel's font?</em> Good question, and we'll cover that in more detail in the <em class="italic">Working with views and Dark Mode</em> section later in this chapter.</p>
			<p>However, as I mentioned earlier, there are going to be occasions where you'll need to test your app in the simulator. Labels and views will not always be static and could be generated dynamically – this is where environment overrides come in. </p>
			<p>We'll start by <a id="_idIndexMarker067"/>launching <a id="_idIndexMarker068"/>our app in the simulator. Once successfully launched, you should see the following highlighted option available in Xcode:</p>
			<div><div><img src="img/Figure_2.06_B14717.jpg" alt="Figure 2.6 – Environment Overrides&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.6 – Environment Overrides</p>
			<p>Click on this icon and you'll be presented with the <strong class="bold">Environment Overrides</strong> popup. Here, you'll have the option to toggle the <strong class="bold">Interface Style</strong> overrides, which in turn will allow you to choose between light and dark appearance.</p>
			<p>If you flick the toggle and switch between each option, you'll see your app in the simulator automatically update without the need to close your app, change the settings, and re-launch. Very nice indeed – thanks, Xcode!</p>
			<p>One last little thing to point out before we move on: we mentioned previously that existing apps built with previous iOS SDKs won't be affected by dark mode, but should you choose to update your app to the iOS 13 SDK, you may run into a couple of issues. </p>
			<p>Tight deadlines and urgent bug fixes might not necessarily give you the chance to adopt dark mode in your app, so Xcode gives you the option to force light appearance regardless of the user's preference.</p>
			<p>In <code>Info.plist</code> (or the <code>Light</code>:</p>
			<pre>UIUserInterfaceStyle</pre>
			<div><div><img src="img/Figure_2.07_B14717.jpg" alt="Figure 2.7 – Info.plist – User Interface Style&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.7 – Info.plist – User Interface Style</p>
			<p>You'll now see that even with the environment overrides, you won't be able to switch to dark mode.</p>
			<p>In this section, we got up and running with Dark Mode in iOS and, more importantly, Xcode, and learned about the little things that Xcode does to get us ready for developing our apps in both light and dark appearance. In the next section, we'll begin to look at how Xcode handles views and introduce ourselves to semantic "dynamic" colors.</p>
			<h1 id="_idParaDest-53"><a id="_idTextAnchor052"/>Working with views in Dark Mode</h1>
			<p>So far in this<a id="_idIndexMarker071"/> chapter, we've covered not only what dark mode is but also what it has to offer from a development perspective.</p>
			<p>In this chapter, we're going to deep dive further into dark mode by looking at how Xcode dynamically handles our UIViews (and objects that are sub-classed from UIViews). </p>
			<p>We'll start by understanding the core concept behind adaptive and semantic colors, and by following a simple pattern, Xcode can do so much of the heavy lifting for us.</p>
			<p>We'll then dive further and take a look at the various levels of semantic colors available to us, including primary, secondary, and tertiary options, but more importantly, when we would be expected to use them.</p>
			<h2 id="_idParaDest-54"><a id="_idTextAnchor053"/>What are adaptive colors?</h2>
			<p>For me, this was a <a id="_idIndexMarker072"/>major step<a id="_idIndexMarker073"/> in getting developers on board with designing and developing their apps for dark mode and, of course, it was well within Apple's interest to make it as seamless as possible for the developer.</p>
			<p>Adaptive colors are a way of defining a single color type or style for a particular appearance. Let's start by diving straight into Xcode and seeing this for ourselves:</p>
			<ol>
				<li value="1">Head back on over to the project you previously created and highlight the UILabel we added in.</li>
				<li>Now, take a look at the <strong class="bold">Color</strong> property in the <strong class="bold">Attributes Inspector</strong> window:</li>
			</ol>
			<div><div><img src="img/Figure_2.08_B14717.jpg" alt="Figure 2.8 – Label properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.8 – Label properties</p>
			<p>You'll notice that the color selected is <strong class="bold">Default (Label Color)</strong> – <strong class="bold">Label Color</strong> is our adaptive color.</p>
			<p>But what does that mean? Actually, it's very simple: it means that for one interface style it's one color, and for the other, it's a different color.</p>
			<p>In the case of our previous example, our UILabel was black in light mode and white in dark mode – makes sense, right? </p>
			<p>Well, to a degree is does, but surely it depends on what type of background our UILabel sits on – let's take a look.</p>
			<p>Back in our storyboard, highlight the background of our view and again head over to the <strong class="bold">Attributes Inspector</strong> window:</p>
			<div><div><img src="img/Figure_2.09_B14717.jpg" alt="Figure 2.9 – Background color properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.9 – Background color properties</p>
			<p>Again, here we have our adaptive color, <strong class="bold">System Background Color</strong>. Xcode is doing all the work for us when we need to switch appearances.</p>
			<p>The preceding parts in the section are a great example of contrasting between two primary colors (black and white used in our labels), which itself is the stereotypical understanding between what colors should be in light and dark appearance – but we're not always going to be using black or white, are we?</p>
			<p>So, Apple has <a id="_idIndexMarker074"/>updated all their available system colors to be adaptive. Let's take a look.</p>
			<p>Head back over to Xcode and highlight our UILabel, and change <strong class="bold">Color</strong> to <strong class="bold">System Indigo Color</strong>:</p>
			<div><div><img src="img/Figure_2.10_B14717.jpg" alt="Figure 2.10 – Font color properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.10 – Font color properties</p>
			<p>Now, let's switch <a id="_idIndexMarker075"/>between light and dark mode using the toggle in Xcode's storyboard. What do we see? The color indigo, just as we expected:</p>
			<div><div><img src="img/Figure_2.11_B14717.jpg" alt="Figure 2.11 – Light mode with Indigo text color&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.11 – Light mode with Indigo text color</p>
			<p>The following screenshot shows the screen with dark mode:</p>
			<div><div><img src="img/Figure_2.12_B14717.jpg" alt="Figure 2.12 – Dark mode with indigo text color&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.12 – Dark mode with indigo text color</p>
			<p>However, each <a id="_idIndexMarker076"/>system color has been <a id="_idIndexMarker077"/>specifically adapted to each appearance. Let's take a look at the RGB values for each appearance:</p>
			<ul>
				<li><code>R 94: G 92: B 230</code></li>
				<li><code>R 88: G 86: B 214</code></li>
			</ul>
			<p>Although there is a subtle difference in each RGB value, it has a massive effect in terms of appearance and allowing it to stand out against other adapted colors defined by Apple (such as our system background color).</p>
			<p>Now that we've learned all about adaptive colors, let's take a look at semantic colors and how Apple helps us pre-define not only the colors we want to use but also where a type of color should be used.</p>
			<h2 id="_idParaDest-55"><a id="_idTextAnchor054"/>What are semantic colors?</h2>
			<p>To answer the <a id="_idIndexMarker078"/>questions of this<a id="_idIndexMarker079"/> section requires us to take a quick look back at what we already covered in the <em class="italic">What are adaptive colors?</em> section, because we've already touched on semantic colors.</p>
			<p>Remember <strong class="bold">Label Color</strong> from our UILabel and <strong class="bold">System Background Color</strong>? These are all semantic colors – not so much by physical color, but more by their definition and intended purpose.</p>
			<p>With semantic colors, Apple has created a whole pre-defined range of adaptive colors that are designed specifically for objects such as labels, backgrounds, and grouped content such as table views. Each of these has additional primary, secondary, and tertiary variants.</p>
			<p>Let's put this into practice and update our current Xcode project:</p>
			<div><div><img src="img/Figure_2.13_B14717.jpg" alt="Figure 2.13 – UILabel with semantic variants&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.13 – UILabel with semantic variants</p>
			<p>I've added a couple more UILabels here and just done a little bit of re-arranging (nothing special), but what I have done is set the semantic variant for each <strong class="bold">Label</strong> with a <a id="_idIndexMarker080"/>corresponding <a id="_idIndexMarker081"/>variant – let's take a look:</p>
			<div><div><img src="img/Figure_2.14_B14717.jpg" alt="Figure 2.14 – Color options&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.14 – Color options</p>
			<p>If we expand the color options for our UILabel, we can see a list of all the pre-defined adaptive/semantic and system and variant colors available to us. I've highlighted the colors I've chosen for<a id="_idIndexMarker082"/> each of <a id="_idIndexMarker083"/>the new labels.</p>
			<p>Now, let's switch the appearance to dark and see how it looks:</p>
			<div><div><img src="img/Figure_2.15_B14717.jpg" alt="Figure 2.15 – Semantic labels in Dark Mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.15 – Semantic labels in Dark Mode</p>
			<p>Let's go a step further and add some more adaptive content in there. Here, I've dropped in a UIView<a id="_idIndexMarker084"/> to act as <a id="_idIndexMarker085"/>a separator between content, a UIButton, which will be a URL link, and a UITableView:</p>
			<div><div><img src="img/Figure_2.16_B14717.jpg" alt="Figure 2.16 – Separators and other background colors&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.16 – Separators and other background colors</p>
			<p>I've assigned the following semantic colors to each of my new views:</p>
			<ul>
				<li><strong class="bold">Separator</strong>: <strong class="bold">Separator Color</strong></li>
				<li><strong class="bold">Button</strong>: <strong class="bold">Link Color</strong></li>
				<li><strong class="bold">Table View</strong>: <strong class="bold">Group Table View Background Color</strong></li>
			</ul>
			<p>Let's fire this up in the iOS simulator and see side by side how it looks. You'll notice something interesting:</p>
			<div><div><img src="img/Figure_2.17_B14717.jpg" alt="Figure 2.17 – Table view in light and Dark Mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.17 – Table view in light and Dark Mode</p>
			<p>In the light <a id="_idIndexMarker086"/>appearance, you can <a id="_idIndexMarker087"/>clearly see the table view's group background color against the system background color; yet if we take a look at this in the dark appearance, you don't see it as much. That's because with a much darker primary background color, the separation isn't needed as much; the black on black doesn't get lost and looks more natural, whereas white on white does.</p>
			<p>This all looks great built into Interface Builder, but now let's take a look at how we would do this programmatically.</p>
			<h2 id="_idParaDest-56"><a id="_idTextAnchor055"/>Using the programmatic approach</h2>
			<p>Let's start by<a id="_idIndexMarker088"/> creating IBOutlets for each of our objects. If you're unfamiliar with creating an outlet, simply, in <code>ViewController</code>, we do the following:</p>
			<ol>
				<li value="1">Declare all our outlet properties first.</li>
				<li>Then, from the <code>IBOutlet</code> connector (just to the left of your property), press <em class="italic">Command</em> + <em class="italic">Primary Cursor Click</em>.</li>
				<li>Hold and drag this to the UIView or object you want to connect to. <p>Opening both Interface Builder and <code>ViewController</code> in separate windows will really help this process too:</p><div><img src="img/Figure_2.18_B14717.jpg" alt="Figure 2.18 – Creating an outlet&#13;&#10;"/></div><p class="figure-caption">Figure 2.18 – Creating an outlet</p></li>
				<li>We'll need to create these in our <code>ViewController.swift</code> file just inside the class declaration. Copy the following highlighted code into your class:<pre>class ViewController: UIViewController {
   <strong class="bold"> @IBOutlet weak var headerImageView: UIImageView!</strong>
    <strong class="bold">@IBOutlet weak var primaryLabel: UILabel!</strong>
<strong class="bold">    @IBOutlet weak var secondaryLabel: UILabel!</strong>
<strong class="bold">    @IBOutlet weak var tertiaryLabel: UILabel!</strong>
<strong class="bold">    </strong>
<strong class="bold">    @IBOutlet weak var linkButton: UIButton!</strong>
<strong class="bold">    </strong>
<strong class="bold">    @IBOutlet weak var separatorView: UIView!</strong>
<strong class="bold">    </strong>
<strong class="bold">    @IBOutlet weak var tableView: UITableView!</strong>
    
    
    override func viewDidLoad() {
        super.viewDidLoad()
    }
}</pre></li>
				<li>Now, we can <a id="_idIndexMarker089"/>programmatically assign our colors. Inside the <code>viewDidLoad()</code> function, add the following highlighted code:<pre>override func viewDidLoad() {
    super.viewDidLoad()
        
    <strong class="bold">primaryLabel.textColor = UIColor.label</strong>
<strong class="bold">    secondaryLabel.textColor = UIColor.secondaryLabel</strong>
<strong class="bold">    tertiaryLabel.textColor = UIColor.tertiaryLabel</strong>
<strong class="bold">        </strong>
<strong class="bold">    linkButton.titleLabel?.textColor = UIColor.link</strong>
<strong class="bold">        </strong>
<strong class="bold">    separatorView.backgroundColor = UIColor.separator</strong>
<strong class="bold">        </strong>
<strong class="bold">    tableView.backgroundColor = UIColor.systemGroupedBackground</strong>
        
}</pre></li>
			</ol>
			<p>If you launch the app in the simulator, you'll see that everything should stay the same. If we really want to test our logic, head back on over to Interface Builder and set one of our UILabels to <strong class="bold">System Green Color</strong>. Re-run the app and watch the programmatic code take precedence and override Interface Builder.</p>
			<p>In this section, we've looked at how working with views for Dark Mode either in Interface Builder or <a id="_idIndexMarker090"/>programmatically is possible with the use of adaptive and semantic colors. We also looked at and understood the value behind using color variations and saw the effect they both have in both light and dark appearance. In the next section, we'll take a look at the asset catalog and how we can create custom adaptive colors and images for use in our app.</p>
			<h1 id="_idParaDest-57"><a id="_idTextAnchor056"/>Working with the asset catalog for Dark Mode</h1>
			<p>Since the ability to add <a id="_idIndexMarker091"/>colors to the asset catalog became available back in Xcode 9, there is now even more reason to take full advantage of one of Xcode's prized assets.</p>
			<p>In this section, we'll look at how we can use the asset catalog not only to create our custom colors but also to create our own adaptive colors and images, allowing us to harness the power of Xcode when developing dynamic appearance applications.</p>
			<h2 id="_idParaDest-58"><a id="_idTextAnchor057"/>Using custom adaptive colors</h2>
			<p>Sticking with our <a id="_idIndexMarker092"/>current project, head on over to the file inspector, and highlight the <code>Assets.xcassets</code> folder. With the following layout visible, click on the <strong class="bold">+</strong> button highlighted in the following screenshot and select <strong class="bold">New Color Set</strong> from the list of options:</p>
			<div><div><img src="img/Figure_2.19_B14717.jpg" alt="Figure 2.19 – Creating a color set&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.19 – Creating a color set</p>
			<p>Add in another three color sets and name them the following:</p>
			<ul>
				<li><code>brandLabel</code></li>
				<li><code>brandSecondaryLabel</code></li>
				<li><code>brandTertiaryLabel</code></li>
			</ul>
			<p>Highlight <code>brandLabel</code>, and then highlight the option in the central asset preview window. Notice the<a id="_idIndexMarker093"/> list of attribute options now made available to us in the <strong class="bold">Attributes Inspector</strong> pane:</p>
			<div><div><img src="img/Figure_2.20_B14717.jpg" alt="Figure 2.20 – Adding a color set&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.20 – Adding a color set</p>
			<p>As you can see, we can now define the <code>brandLabel</code> color that we want to use. But first, let's make it adaptive. In the <strong class="bold">Attributes Inspector</strong> pane, change <strong class="bold">Appearance</strong> from <strong class="bold">None</strong> to <strong class="bold">Any, Light, Dark</strong>.</p>
			<p>You'll have noticed on the dropdown that there was another option of <strong class="bold">Any, Dark</strong>, so let's go through what this means:</p>
			<ul>
				<li><strong class="bold">None</strong>: This is a default color and won't be adaptive to your selected appearance.</li>
				<li><strong class="bold">Any, Dark</strong>: In this scenario, <strong class="bold">Any</strong> will support legacy versions of your app, along with any other variations that aren't dark (so light, basically). <strong class="bold">Dark</strong> will be dark…</li>
				<li><strong class="bold">Any, Light, Dark</strong>: Same as the preceding but will allow you to specifically select a value for legacy and light (along with dark).</li>
			</ul>
			<p>So, with that<a id="_idIndexMarker094"/> covered, let's add some colors. Now, as mentioned before, this is where you can be really specific with your color choices, either by personal preference or brand guidelines you have to follow. For me, I'm just going to click <strong class="bold">Show Color Picker</strong> and pick my favorite colors:</p>
			<ul>
				<li>Tangerine for <strong class="bold">Any (Legacy)</strong> and light</li>
				<li>A more subtle <strong class="bold">Cantaloupe</strong> for dark:</li>
			</ul>
			<div><div><img src="img/Figure_2.21_B14717.jpg" alt="Figure 2.21 – Choosing a color&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.21 – Choosing a color</p>
			<p>Do the same for <code>brandSecondaryLabel</code> and <code>brandTertiaryLabel</code>, remembering to slightly alter the colors based on the semantic purpose you intend to use them for.</p>
			<p>Once you've done that, head back on over to Interface Builder and highlight <code>primaryLabel</code>, then bring open the options of colors from <strong class="bold">Attributes Inspector</strong>. You should see the<a id="_idIndexMarker095"/> following:</p>
			<div><div><img src="img/Figure_2.22_B14717.jpg" alt="Figure 2.22 – Default label color&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.22 – Default label color</p>
			<p>All the color sets you created in the asset catalog are available to use right there in Interface Builder. Go ahead and add them in for each label and see how they look by switching appearance in Interface Builder:</p>
			<div><div><img src="img/Figure_2.23_B14717.jpg" alt="Figure 2.23 – Color set, light mode versus dark mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.23 – Color set, light mode versus dark mode</p>
			<p>With that done, you've created your very own adaptive, semantic and dynamic colors for your app – all within the power of Xcode. </p>
			<p>If you wanted to use the colors programmatically, you can do that by simply referring to the asset name in a couple of different ways.</p>
			<p>First is a direct reference to the name of the assets:</p>
			<pre>primaryLabel.textColor = UIColor(named: "brandLabel")</pre>
			<p>Alternatively, you can select the asset directly from the media library by pressing <em class="italic">Shift</em> + <em class="italic">CMD</em> + <em class="italic">M</em> and selecting <strong class="bold">show color palette</strong> from the icon options and selecting the color you want.</p>
			<p>This will insert the<a id="_idIndexMarker096"/> color from the assets catalog as a swatch, directly inside your code:</p>
			<div><div><img src="img/Figure_2.24_B14717.jpg" alt="Figure 2.24 – Assigning a color set programmatically&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.24 – Assigning a color set programmatically</p>
			<p>Or another option, if you really wanted to keep your code clean, would be to create an extension of UIColor allowing you to define your own property:</p>
			<pre>extension UIColor {
    static var brandLabel: UIColor {
        return UIColor(named: "brandLabel") ?? UIColor.label
    }
}</pre>
			<p>This can now be used just like this:</p>
			<pre>primaryLabel.textColor = UIColor.brandLabel</pre>
			<p>This is a nice, clean, and manageable way to look after your custom color sets programmatically, but this really is a personal preference, and each to their own. If you're working with a large alternative color guideline, making the change to a primary color in one extension will roll the<a id="_idIndexMarker097"/> change out to your entire app without the worry of missing a label or two.</p>
			<p>Next, let's take a look at the same approach but for images.</p>
			<h2 id="_idParaDest-59"><a id="_idTextAnchor058"/>Using custom adaptive images</h2>
			<p>We've learned a lot about how the asset catalog works with adaptive images from the previous section, <em class="italic">Custom adaptive colors</em>, and luckily, we can take full advantage of that in creating adaptive images for our project.</p>
			<p>In the same way that we created a new color set, let's follow these steps:</p>
			<ol>
				<li value="1">Head on back over to <strong class="bold">Assets.xcassets</strong>.</li>
				<li>Create a new image set:<div><img src="img/Figure_2.25_B14717.jpg" alt="Figure 2.25 – New image set&#13;&#10;"/></div><p class="figure-caption">Figure 2.25 – New image set</p></li>
				<li>Name your new image <strong class="bold">header</strong>, highlight it, and change the appearance in the <strong class="bold">Attributes Inspector</strong> window to <strong class="bold">Any, Dark</strong>. You should now see the following:</li>
			</ol>
			<div><div><img src="img/Figure_2.26_B14717.jpg" alt="Figure 2.26 – Add new image set&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.26 – Add new image set</p>
			<p>When adding an image to the image catalog, you'll be given the option for adding <strong class="bold">1x</strong>, <strong class="bold">2x</strong>, or <strong class="bold">3x</strong> images – these are different image scales you can set for various screen sizes. For further information, see the following from Apple's documentation. </p>
			<p>For this example, we are going to add in two different images to the <strong class="bold">2x</strong> option: one for <strong class="bold">Any</strong> and the other for <strong class="bold">Dark</strong>. You can grab the images I've used from the sample project found in GitHub or choose your own – it's up to you. From the Finder, simply drag and drop the images into the <strong class="bold">2x</strong> placeholder inside Xcode. You should see the following once done:</p>
			<div><div><img src="img/Figure_2.27_B14717.jpg" alt="Figure 2.27 – New image set variants&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.27 – New image set variants</p>
			<p>Now, head back on over to your storyboard and add in a UIImageView to your project. Add this to the top of <code>ViewController</code> to act as a header.</p>
			<p>Once in place, head on over to the <strong class="bold">Attributes Inspector</strong> pane and select the dropdown for the <strong class="bold">Image</strong> option – there, you should see your newly created asset, <strong class="bold">header</strong>:</p>
			<div><div><img src="img/Figure_2.28_B14717.jpg" alt="Figure 2.28 – Setting header from the image set&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.28 – Setting header from the image set</p>
			<p>Select this and take a look (depending on the size of the image you chose, you may need to set <strong class="bold">Content Mode</strong> to <strong class="bold">Aspect Fill</strong> – these options can also be found in <strong class="bold">Attributes Inspector</strong>).</p>
			<p>Run the simulator and have a look at everything you've achieved so far in this chapter, remembering to switch from light to dark appearance by using the environment override in Xcode… looks pretty good, right?</p>
			<div><div><img src="img/Figure_2.29_B14717.jpg" alt="Figure 2.29 – Header light mode versus dark mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.29 – Header light mode versus dark mode</p>
			<p>Just like we did with color sets, we can of course handle this programmatically, should we wish. Let's add another extension to our app to handle this for us:</p>
			<pre>extension UIImage {
    static var header: UIImage {
        return UIImage(named: "header") ?? UIImage()
    }
}</pre>
			<p>We can again use this in just the same way as before:</p>
			<pre>headerImageView.image = UIImage.header</pre>
			<p>We do this by assigning our header image directly onto our UIImageView.</p>
			<p>In this section, we harnessed the power of the asset catalog to allow us to create custom adaptive and dynamic colors and images for our app. In the next section, we'll take a look at how best to update a legacy app to support dark mode with everything we've learned so far, and <a id="_idIndexMarker098"/>also how best to identify the little things we can do to futureproof our apps for various appearances.</p>
			<h1 id="_idParaDest-60"><a id="_idTextAnchor059"/>Further exploring Dark Mode</h1>
			<p>In the previous <a id="_idIndexMarker099"/>sections, we gave you a lot to think about when either creating or migrating existing apps to Dark Mode under specific circumstances. In this section, we'll take a look at a couple of little "nice to knows" that should always be in the back of your mind when approaching Dark Mode.</p>
			<h2 id="_idParaDest-61"><a id="_idTextAnchor060"/>Using Dark Mode with SwiftUI </h2>
			<p>With the<a id="_idIndexMarker100"/> announcement of SwiftUI back in June 2019, a massive<a id="_idIndexMarker101"/> shift in focus on UI-based development took place. Released at the same time as Dark Mode, and as expected, SwiftUI takes full advantage of switching appearances. </p>
			<p>Let's start by taking a look at how we could detect dark mode programmatically in SwiftUI:</p>
			<ol>
				<li value="1">First, we'll create an environment variable that allows us to access the current state of the appearance of the device: <pre><strong class="bold">@Environment(\.colorScheme) var appearance</strong></pre></li>
				<li>Next, let's use a simple ternary operator to display some text based on the current appearance:<pre>Text(appearance == .dark ? "Dark Appearance" : "Light Appearance")</pre></li>
			</ol>
			<p>It really is that simple. </p>
			<p>Now, let's have a look at the options available to us in the automatic preview window. SwiftUI uses <code>PreviewProvider</code>, which allows us to display dynamically what we are designing/developing.</p>
			<p>To enable Dark <a id="_idIndexMarker102"/>Mode in <code>PreviewProvider</code>, simply add the following <a id="_idIndexMarker103"/>highlighted code and hot refresh:</p>
			<pre>struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
<strong class="bold">            .environment(\.colorScheme, .dark)</strong>
    }
}</pre>
			<p>Here, we've added a modifier to set the <code>.colorScheme</code> environment variable to <code>.dark</code>. If we want to preview both <code>.light</code> and <code>.dark</code> side by side, we can simply do the following:</p>
			<pre>struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        Group {
            ContentView().environment(\.colorScheme, .light)
             ContentView().environment(\.colorScheme, .dark)
        }
    }
}</pre>
			<p class="callout-heading">Tip</p>
			<p class="callout">To learn <a id="_idIndexMarker104"/>more about SwiftUI, take a look at <em class="italic">Learn SwiftUI</em>, available<a id="_idIndexMarker105"/> from Packt Publishing: <a href="https://www.packtpub.com/business-other/learn-swiftui">https://www.packtpub.com/business-other/learn-swiftui</a>.</p>
			<h2 id="_idParaDest-62"><a id="_idTextAnchor061"/>Programatically handling changes with trait collection </h2>
			<p>During the<a id="_idIndexMarker106"/> development of your new app, there could be a couple of occasions where you might need to handle a specific scenario based on the current appearance. However, we'll need to take a slightly different approach to this than what we did with the SwiftUI example previously.</p>
			<p>The interface style is part of the <code>UITraitCollection</code> class (which, in turn, is part of UIKit). We can do a conditional check against a value using the following anywhere in our <code>ViewController</code>:</p>
			<pre>traitCollection.userInterfaceStyle == .dark</pre>
			<p>Unlike SwiftUI, we can't just use a simple ternary operator as there are more than two values for <code>userInterfaceStyle</code>:</p>
			<pre>public enum UIUserInterfaceStyle : Int {
    case unspecified
    case light
    case dark
}</pre>
			<p><strong class="bold">Unspecified</strong> is an option too (think <strong class="bold">Any</strong>, back in our asset catalog), so it's best to use another approach when detecting changes to our interface style.</p>
			<p>Let's start by heading back into our <code>ViewController.swift</code> file and adding in the following <code>override</code> function:</p>
			<pre>override func traitCollectionDidChange(_ previousTraitCollection: UITraitCollection?) {
    super.traitCollectionDidChange(previousTraitCollection)
    // Logic here    
}</pre>
			<p>This override is called whenever a change is made to a trait (such as appearance). From this, we now action any changes we would like to make, but the problem we have is traits are used for more than just appearances, and this override could be called for a variety of reasons.</p>
			<p>So, if we are looking particularly for changes in our appearance, we can use the <code>previousTrait</code> property passed into our delegate function and compare against the current <a id="_idIndexMarker107"/>system trait – if there is a difference, we know the appearance has changed. Let's take a look at how we'd do this:</p>
			<pre>override func traitCollectionDidChange(_ previousTraitCollection: UITraitCollection?) {
    super.traitCollectionDidChange(previousTraitCollection)
    let interfaceAppearanceChanged = previousTraitCollection?.hasDifferentColorAppearance(comparedTo: traitCollection)
}</pre>
			<p>By using the <code>hasDifferentColorAppearance</code> method, we can now easily compare the previous trains against the current one to see whether there have been any changes – the resulting method returns a Boolean, so we can use this at our convenience.</p>
			<h2 id="_idParaDest-63"><a id="_idTextAnchor062"/>Specifying an appearance for views, ViewControllers, and windows</h2>
			<p>You may, in <a id="_idIndexMarker108"/>some circumstances, wish to specify<a id="_idIndexMarker109"/> an appearance <a id="_idIndexMarker110"/>based on a particular area of your app or if you are migrating to dark mode (but need a little more time for a certain feature). Simply drop in the following appropriate code to meet your desire.</p>
			<h3>Views</h3>
			<p>Here, we'll<a id="_idIndexMarker111"/> create and instantiate a basic <a id="_idIndexMarker112"/>UIView:</p>
			<pre>let view = UIView()
view.overrideUserInterfaceStyle = .dark // .light</pre>
			<p>We assign either a light or dark value.</p>
			<h3>ViewController</h3>
			<p>If we wanted to <a id="_idIndexMarker113"/>do this in a UIViewController, we <a id="_idIndexMarker114"/>would simply just do the following:</p>
			<pre>overrideUserInterfaceStyle = .dark</pre>
			<p>Again, we assign either a light or dark value (usually within <code>viewDidLoad()</code>).</p>
			<h3>Window</h3>
			<p>If we need to <a id="_idIndexMarker115"/>access the current window, we could <a id="_idIndexMarker116"/>do so as follows:</p>
			<pre>for window in UIApplication.shared.windows {
    window.overrideUserInterfaceStyle = .dark
}</pre>
			<p>(This is not a recommended approach and you would be hard-pressed to find any real reason to want to do this…)</p>
			<h2 id="_idParaDest-64"><a id="_idTextAnchor063"/>Accessibility in Dark Mode</h2>
			<p>Ask around and someone <a id="_idIndexMarker117"/>will joke about how <strong class="bold">Dark Mode</strong> has existed in iOS for years, either as the <strong class="bold">Classic Invert</strong> or <strong class="bold">Smart Invert</strong> accessibility feature. I even had it on one of my slides at a conference about 2 months prior to Dark Mode being officially announced.</p>
			<p>But with this in mind, a lot of things started to be said about accessibility in iOS – some comments referring to Dark Mode as "Apple finally supporting accessibility," which I have to be honest makes me very sad.</p>
			<p>Accessibility has always played a massive part in iOS regardless of the appearance – but, even with the introduction of Dark Mode, this still goes unchanged as Dark Mode supports all accessibility features.</p>
			<p>If you refer back to an earlier section in this chapter, <em class="italic">Core development concepts in Dark Mode</em>, you'll remember that we mentioned the option to schedule our light and dark appearances – much like you could with Nightshift that was introduced in iOS 9, again another element with a focus on accessibility.</p>
			<p>In this section, we went a little outside of the box with regard to Dark Mode and stepped away from the basic implementation, allowing us to look at the wider options available to use and things to think about when implementing Dark Mode in our apps.</p>
			<h1 id="_idParaDest-65"><a id="_idTextAnchor064"/>Summary</h1>
			<p>In this chapter, we've covered a lot about Dark Mode – not only from a programmatic perspective but also the theory behind the appearances and purpose of colors used within our apps.</p>
			<p>We started by taking a look at how Xcode and iOS are set up for Dark Mode, learning about the environment overrides used in Xcode, and how we can even switch appearances in our storyboard while developing.</p>
			<p>Next, we covered adaptive and semantic colors, and learned not only how these are used with Apple's default system colors but also how we can create dynamic and adaptive color sets ourselves.</p>
			<p>Following on from what we learned about color sets, we applied this to images and harnesses the power of the assets catalog.</p>
			<p>Finally, we covered some "great to know" topics, such as Dark Mode in SwiftUI, programmatically hailing appearances, and accessibility.</p>
			<p>In the next chapter, we'll take a look at lists in iOS 14, covering everything you need to know about UITableViews and UICollectionViews.</p>
			<h1 id="_idParaDest-66"><a id="_idTextAnchor065"/>Further reading</h1>
			<ul>
				<li><strong class="bold">Apple human interface guidelines (dark mode)</strong>: <a href="https://developer.apple.com/design/human-interface-guidelines/ios/visual-design/dark-mode/">https://developer.apple.com/design/human-interface-guidelines/ios/visual-design/dark-mode/</a></li>
				<li><strong class="bold">Apple human interface guidelines (color)</strong>: <a href="https://developer.apple.com/design/human-interface-guidelines/ios/visual-design/color/">https://developer.apple.com/design/human-interface-guidelines/ios/visual-design/color/</a></li>
				<li><strong class="bold">Asset catalog reference</strong>: <a href="https://developer.apple.com/library/archive/documentation/Xcode/Reference/xcode_ref-Asset_Catalog_Format/index.html">https://developer.apple.com/library/archive/documentation/Xcode/Reference/xcode_ref-Asset_Catalog_Format/index.html</a></li>
			</ul>
		</div>
	</body></html>