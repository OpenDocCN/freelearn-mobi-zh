<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Setting Up the Development Environment</h1></div></div></div><p>Android 5<a id="id0" class="indexterm"/> is the most significant update available at the present time, since its platform was created in 2009. It introduced a completely reworked user interface and thousands of new APIs, including the all new camera APIs. Android 5 also incorporates exciting, new, power-saving technologies, and improved app performance.</p><p>In this chapter, we will install and configure all the development tools required for building an Android app. These will include the Android Studio and Android SDK, various platform specific tools and system images, and an Android Virtual Device. Once our environment is properly set up, we will create a simple "Hello World" project and test it on a mobile device, as well as on an emulator. This exercise will give us a good opportunity to become acquainted with some of the most widely used elements of our development environment, as well as providing a quick, but useful, demonstration of how an Android Studio project is put together.</p><p>In this chapter, we will:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Understand what is new and different about Android 5</li><li class="listitem" style="list-style-type: disc">Download and install the Android Studio and SDK</li><li class="listitem" style="list-style-type: disc">Install the latest SDK tools, platform-tools, and build-tools</li><li class="listitem" style="list-style-type: disc">Install the Lollipop platform and system images</li><li class="listitem" style="list-style-type: disc">Create a basic "Hello World" project</li><li class="listitem" style="list-style-type: disc">Run the app on a handset</li><li class="listitem" style="list-style-type: disc">Configure an Android Virtual Device (AVD)</li><li class="listitem" style="list-style-type: disc">Run the app on the AVD emulator</li></ul></div><p>Before we start, it's worth while taking a closer look at Android 5 itself, and see what sets it apart from other Android versions, and what it has to offer to us, as developers.</p><div><div><div><div><h1 class="title"><a id="ch01lvl1sec08"/>What is Android 5?</h1></div></div></div><p>Android 5, or Lollipop, represents the most revolutionary upgrade to the Android operating system to <a id="id1" class="indexterm"/>date. It introduces many exciting, new features for users, plus a host of new APIs and access to cutting edge technologies for developers. The most significant, and obvious, changes have to be the new Material Design UI and the ability to deploy Lollipop on wearables, TVs, and in our cars.</p><p>It's not a bad idea to have a quick look at how Android 5 appears to the user, before exploring what it means for us as developers.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec07"/>Lollipop from a user's perspective</h2></div></div></div><p>The first thing any <a id="id2" class="indexterm"/>Android 5 user will will be aware of, other than the expanded and improved notifications bar and a more functional lock screen, is the new visual language-Material Design. They will notice how almost everything they touch or interact with responds with an animation. These simple onscreen behaviors are intended to provide the user with a clear, and intuitive, visual feedback. Another interesting change is the new Overview feature which replaces Recent apps, allowing individual documents and entire apps to be available.</p><div><img src="img/B04321_01_01.jpg" alt="Lollipop from a user's perspective"/></div><p>Perhaps the<a id="id3" class="indexterm"/> most interesting departure, from the user's point of view, that Lollipop makes from previous versions is how they will now encounter it on their television sets, in their cars, and on wearable devices, such as watches and glasses. Those with these wearables will undoubtedly want these apps that take advantage of the two new sensors that Lollipop introduces, such as the heart rate and tilt sensors.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec08"/>Lollipop from a developer's perspective</h2></div></div></div><p>From a developer's point of view, Android 5 provides far more exciting prospects than a prettier UI, improved battery life, and a better lock screen. For us, with over 5,000 new APIs, a whole <a id="id4" class="indexterm"/>new design language and dozens of new features and technologies, Android 5 gives us the most powerful set of tools yet. Not only is Android now more powerful, it is also easier to program than before. With a truly helpful IDE, and APIs that are designed for ease of use, developing an app has never been simpler or less daunting. If you want to turn your ideas into a reality, then Android 5 is the way. It is truer now than it has ever been that we are limited only by the power of our imagination.</p><div><div><div><div><h3 class="title"><a id="ch01lvl3sec01"/>Material Design</h3></div></div></div><p>The Material Design UI paradigm is far more than an attractive and easier to understand interface. It is<a id="id5" class="indexterm"/> a serious design language, with some important points to make about how we interact with our devices. Inspired by ideas of how materials of the future might behave, such material can be thought of as a dynamic and responsive piece of paper, which can move, change shape and size, split apart, join together, and exist in three dimensions. It is this added dimension, with real-time, programmable shadows that gives Material Design its sense of depth. The way content is displayed on material is also dynamic and Google suggests that we think of it as "smart ink". There a few design rules that need to be considered when building apps using Material Design, and we will cover these when we return to the subject in later chapters. From a practical point of view, the SDK provides us with two versions of material theme (light and dark) and two widgets: <code class="literal">CardView</code> for simple content and <code class="literal">RecyclerView</code> for lists. We can also define and customize the shadows, animations, and drawables our apps use.</p></div><div><div><div><div><h3 class="title"><a id="ch01lvl3sec02"/>Other devices</h3></div></div></div><p>One of the<a id="id6" class="indexterm"/> most exciting opportunities that Lollipop offers us as developers is the ability to create apps for devices other than phones and tablets. Android 5 makes it possible to write apps for screens as small as wrist watches or as large as home cinemas, including anything in between.</p><div><div><div><div><h4 class="title"><a id="ch01lvl4sec01"/>TV</h4></div></div></div><p>Android 5 makes<a id="id7" class="indexterm"/> coding for TV sets very similar to coding for handsets. The major differences are size, viewing distances and the way that the TV apps are generally navigated with a remote control and D-pad. The Android 5 SDK comes equipped with purpose-built themes and layouts, which make it simple for us to deploy an app built for a tablet, onto a TV, or vice versa.</p></div><div><div><div><div><h4 class="title"><a id="ch01lvl4sec02"/>Wear</h4></div></div></div><p>When it comes to designing apps for wearables, issues such as power consumption and restricted screen <a id="id8" class="indexterm"/>size become some of the more important deciding factors. For this reason, Android 5 imposes a strict time-out policy on wearable apps. As all Android wearable apps need to be installed on a handset first, we have the opportunity to present the content on either the wearable or the parent device. Despite these restrictions, and the fact that not all features are available on wearables (such as web browsing), the addition of an API for the new heart-rate sensor, provides the developers interested in creating health and fitness based apps with new and exciting opportunities.</p></div><div><div><div><div><h4 class="title"><a id="ch01lvl4sec03"/>Auto</h4></div></div></div><p>Android in our<a id="id9" class="indexterm"/> cars offers another new field introduced by Lollipop. The emphasis here rests entirely on safety: only messaging and audio features are allowed to run on in-car apps. This means that when developing apps for cars, we need to take into account which features will be disabled for safety reasons.</p><p>This is all the theory and background we will need for now. It's time to get to work and set up our work space.</p></div></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Installing and configuring the development environment</h1></div></div></div><p>Before we <a id="id10" class="indexterm"/>can even begin to work with the Android SDK, we <a id="id11" class="indexterm"/>need to make sure that we have the latest Java Development Kit (JDK) installed. It is more than likely that you have this already, but if you are unsure, type <code class="literal">java -version</code> at the command line, and hopefully you will see something like this:</p><div><img src="img/B04321_01_02.jpg" alt="Installing and configuring the development environment"/></div><div><div><h3 class="title"><a id="note02"/>Note</h3><p>Note that Android 5 requires Java 1.7 or higher.</p></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec09"/>Installing the SDK</h2></div></div></div><p>If you only<a id="id12" class="indexterm"/> have the Java Runtime Environment (JRE), you <a id="id13" class="indexterm"/>can download the JDK from <a class="ulink" href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</a>. You will also need to take a note of where the JDK is installed on your <a id="id14" class="indexterm"/>computer. It should be something like <code class="literal">C:\Program Files\Java\jdk1.8.0_25</code>. Let us get started with the installation, by performing the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Download and <a id="id15" class="indexterm"/>install the Android Studio and SDK. They can be found at <a class="ulink" href="http://developer.android.com/sdk/index.html">http://developer.android.com/sdk/index.html</a> and should come bundled together as a single executable.</li><li class="listitem">Run the executable and follow the wizard, making sure to install all the components, as seen in the following screenshot:<div><img src="img/B04321_01_03.jpg" alt="Installing the SDK"/></div></li><li class="listitem">Before running the Android Studio we need to set up an environment variable to<a id="id16" class="indexterm"/> point to our JDK. From your <a id="id17" class="indexterm"/>control panel's <strong>System Properties</strong> window, select the <strong>Advanced</strong> tab and then the <strong>Environment Variables...</strong> button. Add a new user variable called <code class="literal">JAVA_HOME</code> and paste it in the path to your JDK, as noted earlier:<div><img src="img/B04321_01_04.jpg" alt="Installing the SDK"/></div></li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec10"/>Managing the SDK tools</h2></div></div></div><p>There are<a id="id18" class="indexterm"/> still one or two tools we need before <a id="id19" class="indexterm"/>we can start to build and test any apps. The SDK separates tools, platforms, and device system images, allowing us to download only the packages we need or those that are specific to our project.</p><p>The Android SDK Manager is the program we use to do this. It can be run from the Android Studio, or as a stand-alone application from the SDK's root directory, by executing the <code class="literal">SDK Manager.exe</code> file. For now, we will run it from within the Android Studio environment. This can be done from within an open project, by clicking on the SDK Manager icon in the toolbar, or from the quick start screen from the Configure page.</p><div><img src="img/B04321_01_05.jpg" alt="Managing the SDK tools"/></div><div><ol class="orderedlist arabic"><li class="listitem">Open the<a id="id20" class="indexterm"/> SDK Manager; we<a id="id21" class="indexterm"/> can see that there are three sections: a <code class="literal">Tools</code> folder, a list of API platform folders, dating right back to Android 1.5 and an <code class="literal">Extras</code> folder.</li><li class="listitem">Open the <code class="literal">Tools</code> folder. At the top, you will see <strong>Android SDK Tools</strong> and <strong>Android SDK Platform-tools</strong>. These will represent the latest tools available and both of them have to be installed.<p>Beneath this, you will see a list of build tools, and as this book is focused on Lollipop, we need to only install the latest version.</p><div><img src="img/B04321_01_06.jpg" alt="Managing the SDK tools"/></div></li><li class="listitem">Moving on to the list of platforms, again, all we need to do is select those that apply to us as Lollipop developers, and that means anything with an API level of 21 or higher.<p>At some point, you will want to test your apps on earlier platforms to reach the widest possible market, but as this book is focused on Android 5, it is only necessary to install the most recent platform. Select all items in this folder.</p><p>There are several handy tools in the <strong>Extras</strong> folder. In particular, the <strong>Android Support Library</strong> and <strong>Google Play services</strong>, which offer a wide range of extra APIs. If you are planning on testing your apps on a real device connected to a PC, then you will need the <strong>Google USB Driver</strong> and if <a id="id22" class="indexterm"/>you have a <a id="id23" class="indexterm"/>recent Intel processor, you will want the hardware accelerator for running the emulators. Select the packages shown below, and install them.</p><div><img src="img/B04321_01_07.jpg" alt="Managing the SDK tools"/></div></li></ol></div><p>We are now ready to create our first app, but first, a note on hardware acceleration. The Emulator Accelerator needs to be executed manually and can be found in the SDK folder under <code class="literal">extras\intel\Hardware_Accelerated_Execution_Manager\intelhaxm-android.exe</code>. Depending on your system, you may also have to enable virtualization in your BIOS.</p><p>Android software is regularly updated, and it is well worth while checking back with the SDK Manager from time to time for updates, especially before starting a new project.</p><div><div><h3 class="title"><a id="tip02"/>Tip</h3><p>Unfortunately, as Android is under constant development, installation is not always as straightforward as it appears here. Google do their best to address issues as<a id="id24" class="indexterm"/> they arrive, and in case of any problems, the web page <a class="ulink" href="http://tools.android.com/knownissues">http://tools.android.com/knownissues</a> can be very useful.</p></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Creating a "Hello World" app</h1></div></div></div><p>Finally, it is time to build our first app. It will do next to nothing but will give us a good look at how apps<a id="id25" class="indexterm"/> are put together by the Android Studio. We will see which files and code are automatically generated for us and get to grips with the directory structure of our project, by performing the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Start the Android Studio and from the start screen, select <strong>Start a new Android Studio project</strong>.</li><li class="listitem">Follow the wizard, and accept the suggested values, making sure that you select the <strong>Phone and Tablet</strong> form factor and a minimum SDK level, no lower than API 21.</li><li class="listitem">Select the <strong>Blank Activity</strong> template and accept the field values suggested by the wizard on the final screen and click on <strong>Finish</strong>. After a brief pause, the IDE will open up.<div><img src="img/B04321_01_08.jpg" alt="Creating a &quot;Hello World&quot; app"/></div></li></ol></div><p>At first sight the IDE can appear daunting, but if we approach it one element at a time it is actually <a id="id26" class="indexterm"/>very straightforward. Take a look at the panel on the left – this displays the directory structure of our project. There are two main branches, <strong>app</strong> and <strong>Gradle Scripts</strong>. We will return to Gradle, when it comes to packaging our apps, but for now, expand the <strong>app</strong> branch.</p><div><img src="img/B04321_01_09.jpg" alt="Creating a &quot;Hello World&quot; app"/></div><p>There are three main sections here, <code class="literal">manifests</code>, <code class="literal">java</code>, and <code class="literal">res</code> (which is short for resources). Along with this directory structure, the Android Studio also generates several code files for us automatically, so when we first create a project below including the following:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">manifest</code> file declares many of our app's broader properties, such as the permissions required by the user. It can be opened, viewed, and edited by double-clicking on the <code class="literal">AndroidManifest.xml</code> node.</li><li class="listitem" style="list-style-type: disc">Android projects keep the layout data and procedural code separate. The layout information for the single activity we created here can be found in the XML file that was named <code class="literal">activity_main.xml</code> for us. There are two ways to view this file: the design view, which displays a list of widgets and an image of a phone and a text view, which can be accessed via the <strong>Text</strong> tab at the bottom of the pane. Any drawables, strings, and menu definitions we might need are also filed in the <code class="literal">res</code> directory.</li><li class="listitem" style="list-style-type: disc">When we created the project, the IDE also created a Java class called <code class="literal">MainActivity</code>. To start with, all it contains are empty callback routines that are called when the Activity is first created, when the menu is created and when a menu item is selected.</li></ul></div><p>Both Android Studio<a id="id27" class="indexterm"/> and the emulator generate a lot of temporary files during operation. This can lead to performance issues with your anti-virus software. If you are comfortable doing so, setting exclusions for Android directories can help to speed up the software considerably.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec11"/>Testing the app on a physical device</h2></div></div></div><p>It is now time <a id="id28" class="indexterm"/>to see how our app looks on an actual device and also on an emulator. To run the project on an actual phone or tablet, you will first have had to download the Google USB driver from the SDK Manager and enabled USB debugging in your handset's settings. Connect your handset and click on the <strong>Run</strong> button on the IDE's main toolbar, or select <strong>Run</strong> from the menu. After confirming the device you are using, the app will be installed and launched.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Setting up a virtual device</h1></div></div></div><p>It is unlikely that we will always have access to all the hardware we want our apps to run on, but with <a id="id29" class="indexterm"/>Android Virtual Devices, we can create almost any form factor we can imagine and test out our apps on those. Let's set up a virtual device by performing the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Open the AVD Manager from the main toolbar:<div><img src="img/B04321_01_10.jpg" alt="Setting up a virtual device"/></div></li><li class="listitem">We could simply select one of the preconfigured devices, but to get a better understanding of how AVDs work, hit the <strong>Create Virtual Device...</strong> button.</li><li class="listitem">Select <strong>Phone</strong> from the <strong>Category</strong> list.</li><li class="listitem">Select one of the phones presented. I chose <strong>Nexus 6</strong>, but this is not important.</li><li class="listitem">Click on the <strong>Clone Device...</strong> button, so as to maintain the original device.</li><li class="listitem">The following <a id="id30" class="indexterm"/>page allows us to edit the device's hardware profile. Here, we get to choose features such as screen size, memory capacity, and sensors. Leave everything as it is but do have a quick look at the options available, for later.</li><li class="listitem">Hit <strong>Finish</strong>.</li><li class="listitem">You will be returned to the hardware selection screen. As before, select <strong>Phone</strong> from the <strong>Category</strong> list, and you will now find the AVD we just cloned. Select it and click on <strong>Next</strong>.</li><li class="listitem">Select a system image with an API level of 21 or higher and a target of 5 or greater and click on <strong>Next</strong>.<div><div><h3 class="title"><a id="tip03"/>Tip</h3><p>If you have the Intel hardware acceleration enabled, then choose <strong>x86</strong> or <strong>x86_64</strong> as the ABI. Otherwise, you will have to make do with ARM. For the purposes of this demonstration, I will assume that you are using an ARM ABI.</p></div></div></li><li class="listitem">The following page is mainly used just to verify our settings, but it also gives us the opportunity to adjust the scale and improve the performance of the emulator. Whether or not you adjust the scale will depend on the screen you are working on and the resolution of the emulated device. Similarly, the choice between accelerating the emulator's performance by harnessing your computer's own GPU or by speeding up start times with a snapshot will depend on your hardware and your project's purpose.</li><li class="listitem">Hit <strong>Finish</strong>.</li></ol></div><p>Running an app on a virtual device is no different from running one on an actual phone, the only difference being which device you choose.</p><div><img src="img/B04321_01_11.jpg" alt="Setting up a virtual device"/></div><p>As one would<a id="id31" class="indexterm"/> imagine, the touch screen of the AVD can be operated with the mouse. The device can be rotated by pressing Left <em>Ctrl</em> + <em>F12</em>. Also, the power button can be pressed with <em>F7</em> and the volume can be turned up and down with <em>Ctrl</em> + <em>F5</em> and <em>Ctrl</em> + <em>F6</em>.</p><p>This pretty much concludes our whistle-stop tour of Lollipop, Android Studio, and the SDK. Before we get started with some actual programming, there is one last tool that it is worth taking a<a id="id32" class="indexterm"/> look at, the <strong>Android Device Monitor</strong>.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec12"/>Monitoring devices</h2></div></div></div><p>Run the app <a id="id33" class="indexterm"/>again, on either a <a id="id34" class="indexterm"/>device or an emulator, but first open the Android Device Monitor. It can be found on the main toolbar, to the right of the SDK Manager. The device monitor provides some very useful views on what is actually going on inside our devices and some fun ways of manipulating them. A paired down version of the Device Monitor is available directly from the IDE, by selecting Android from the icon in the lower left corner of the editor.</p><div><img src="img/B04321_01_12.jpg" alt="Monitoring devices"/></div><p>Along <a id="id35" class="indexterm"/>with a stream of useful debug<a id="id36" class="indexterm"/> information, the device monitor gives us direct access to its data, via a file explorer and tools that allow us to send it calls, SMS messages and set it to fake locations.</p><div><div><h3 class="title"><a id="tip04"/>Tip</h3><p>The camera icon in the <strong>Devices</strong> toolbar can be used to take full-sized screenshots, even when the onscreen device is scaled.</p></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Summary</h1></div></div></div><p>We have covered quite a lot for an introductory chapter, but we have encountered most of the essential tools that we will need later. By now, you will have a fully functional and up-to-date IDE, and know how to create and test apps on an AVD. You have seen some of the more important files and resources that are generated when an Android project is first created and should now understand where these files can be found within the project.</p><p>Having had a look around the most prominent features of our development environment, we are now in a position to dig a little deeper, and see how we can build sophisticated and dynamic layouts, looking at how a Java code can bring these designs to life.</p></div></body></html>