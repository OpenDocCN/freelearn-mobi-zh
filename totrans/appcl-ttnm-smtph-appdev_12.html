<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch12"/>Chapter 12. Preparing your App for Distribution and Getting it Published</h1></div></div></div><p>In this chapter, we will cover:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Joining the iOS Developer Program</li><li class="listitem" style="list-style-type: disc">Installing iOS Developer Certificates and Provisioning Profiles</li><li class="listitem" style="list-style-type: disc">Build your app for iOS using Titanium Studio</li><li class="listitem" style="list-style-type: disc">Joining the Google Android Developer Program</li><li class="listitem" style="list-style-type: disc">Creating your application's distribution key</li><li class="listitem" style="list-style-type: disc">Building and submitting your app to the Android Marketplace</li></ul></div><div><div><div><div><h1 class="title"><a id="ch12lvl1sec01"/>Introduction</h1></div></div></div><p>The final piece of our development puzzle is addressing how we package and distribute our Titanium applications to the iTunes store and Android Marketplace in order for our potential customers to download and enjoy all our hard work. Each of these stores has their own separate processes, certifications, and membership programs.</p><p>In this chapter, we'll show you how to set up your system in preparation for distribution and how to register for each site, as well as how to package and submit your apps to the iTunes and Android Marketplace stores.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch12lvl1sec02"/>Joining the iOS Developer Program</h1></div></div></div><p>In order to submit applications to the iTunes store, you must first pay to become a member of the Apple's iOS Developer Program. Membership is paid, and starts from $99 USD (or equivalent), recurring annually. Even if you intend to develop and distribute your apps for free, you will still need to be a paid member of the iOS Developer Program. It is worth noting up front that only Mac users can follow and implement the steps for the iOS recipes since the building and distribution of iOS apps is only available to those running the Mac OSX operating system.<a id="id394" class="indexterm"/>
</p><div><div><div><div><h2 class="title"><a id="ch12lvl2sec01"/>How to do it…</h2></div></div></div><p>To register for Apple's iOS program, first open up a web browser and navigate to<a class="ulink" href="http://developer.apple.com/programs/register"> http://developer.apple.com/programs/register</a>, and click on the<strong> Get Started</strong> link. The following page that loads will then ask you if you want to create a new Apple ID or use an existing one. Unless you have registered for some of Apple's developer services before, you should choose the<strong> Create New Profile</strong> link.</p><p>Once you are on the<strong> Create Profile</strong> page:<a id="id395" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem">Provide your contact information, including your country of residence. This is important since you'll need to provide some evidence of your residence when you want to start selling paid applications.</li><li class="listitem">On the next page, provide the information required in Professional Profile.</li><li class="listitem">Finally, carefully read and agree to the Terms and Conditions set out by Apple and confirm that you agree, and are at least 18 years old (or the legal equivalent in your country). Click on the<strong> I Agree</strong> button to complete your account creation.</li><li class="listitem">Apple will then send you an e-mail with a confirmation code/link. Clicking on this link in your e-mail will open your browser and confirm your e-mail address and complete your account setup.</li></ol></div><p>You should now be able to see the following page in your browser. It is from here that we will register to the Developer Program and pay the $99 USD (or equivalent) annual fee.</p><div><img src="img/3968_12_01_new.jpg" alt="How to do it…"/></div><p>Click on the<strong> Programs &amp; Add-ons</strong> tab in the top left of the page's menu, which will take you to a page showing the list of memberships you are currently subscribed to. Presuming you have a new account, then a list of three developer programs should appear, each with a<strong> Join Today</strong> button on the right. To continue, follow these steps:<a id="id396" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem">Click on the iOS Developer Program's<strong> Join Today</strong> button, which should appear at the top of that list.</li><li class="listitem">On the next page that loads, click on<strong> Enroll Now</strong>, and continue until you get to the step-by-step wizard.</li><li class="listitem">Select<strong> I'm registered as a developer with Apple and would like to enroll in a paid Apple Developer Program</strong>. from the list on the right and press<strong> Continue</strong>.</li><li class="listitem">From here you need to provide all of the information asked of you in order to complete your account setup. You should choose whether to register as a business or individual. Be aware that whichever method of registration you should choose you need to ensure you have all of the relevant documentation. You will be asked to submit this documentation for verification by Apple and you'll not be able to submit paid applications until that documentation is received and approved. Some of this information cannot be changed and once you have entered it and completed the application it is, for all intents and purposes, set in stone!</li><li class="listitem">Finally, agree to the final set of terms and conditions and then make your payment online. You will require a credit card or debit card to make this purchase.</li></ol></div><p>You should now be able to log in to your new Apple Developer account by navigating your browser to<a class="ulink" href="http://developer.apple.com/devcenter/ios"> http://developer.apple.com/devcenter/ios</a>. Once logged in, you should get some new menu options on your account's home page, including<strong> Provisioning</strong> and<strong> iTunes Connect</strong>. Any information you are missing for your account can be found under the iTunes Connect option, under the<strong> Contracts, Tax and Banking</strong> section. It is likely that you may need to upload some documentation and agree to new terms and conditions from time to time within this section of the website.<a id="id397" class="indexterm"/>
</p><div><img src="img/3968_12_02.jpg" alt="How to do it…"/></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch12lvl1sec03"/>Installing iOS Developer Certificates and Provisioning Profiles</h1></div></div></div><p>There are two types of certificates required to build your applications, both for debugging on a device and for iTunes store distribution. The first is your Development Certificate. This certificate is installed on your Mac within the<code class="literal"> KeyChain</code> and is used for every single application you will develop. It identifies you, the developer, when you are distributing an app.<a id="id398" class="indexterm"/>
</p><p>The second type is the application's Provisioning Profile. This profile certificate is both application specific and release specific. This means you'll need to create a separate profile for each state of the application you wish to release (most commonly being Development and Distribution).</p><p>In this recipe, we will go through the process of creating and installing your Developer Certificate, and then creating and using an application-specific Provisioning Profile in Titanium Studio.</p><div><div><div><div><h2 class="title"><a id="ch12lvl2sec02"/>How to do it...</h2></div></div></div><p>We will now start off with the steps required for installing iOS Developer Certificates and Provisioning Profiles.</p><div><ol class="orderedlist"><li class="listitem">Set up your iOS Developer Certificate.<a id="id399" class="indexterm"/></li><li class="listitem">Log in to your Apple Developer account if you have not done so already, at<a class="ulink" href="http://developer.apple.com/ios"> http://developer.apple.com/ios</a>, and click on the<strong> iOS Provisioning Portal</strong> link. The page that loads will have a number of options on the left-hand menu, click on the<strong> Certificates</strong> option. A page will load with a series of steps entitled<strong> How to create a Development Certificate</strong>. You will need to follow these steps exactly as described, and when you have gone through them from start to finish you should have a Certificate Signing Request (CSR) file saved on your Mac. For this recipe, we'll make the assumption that you have followed these steps closely and have saved a CSR to your desktop.<a id="id400" class="indexterm"/></li><li class="listitem">Click on the<strong> Choose</strong> button at the bottom of the screen to select the CSR file from your computer and upload it to the web page. Once it has finished uploading, select the<strong> Submit</strong> button in the bottom right corner of the page.<p>When the screen reloads, you should now see a certificate appear in the grid, with the name you gave it when generated, and a status of <strong>Pending Issuance</strong>. If you own the iOS account, you can simply wait 20-30 seconds and refresh the page to have the status change to <strong>Issued</strong> and a <strong>Download</strong> action appear to the right of the grid. If the account you are using belongs to another party, you will need to wait for them to confirm this action before you receive an issued certificate. Download the certificate now, and double-click the resulting saved file when it has completed downloading. It will then automatically open in <code class="literal">KeyChain</code> Access and show you that it's been installed. If you have a message at the bottom of the page about the WWDR certificate needing to be installed, you may also choose to download and run that at this point.
</p></li><li class="listitem">Setting up your device.<p>If you have an iPhone or iPod touch and wish to test with it, then you first need to register that device against your iTunes account. Click on the <strong>Devices</strong> menu link on the left-hand side of the page and then <strong>Add Device</strong>. The screen that appears will ask you for information about who owns the device, and more specifically, what that device's unique identifier is. You can find this identifier by plugging in your device to your Mac and opening iTunes. It will appear under <strong>My iPhone/iPod</strong> and then clicking on the <strong>Serial Number</strong> label that appears.
</p><p>An example of the unique identifier is shown in the following screenshot:
<a id="id401" class="indexterm"/>
</p><div><img src="img/3968_12_03.jpg" alt="How to do it..."/></div><p>Creating your Application Provisioning profile.<a id="id402" class="indexterm"/>
</p><p>Now that your Developer Certificate is set up, it's time to create the provisioning profiles for an application we have built. For this example, we're going to use the details for the <strong>LoanCalc</strong> app we built in <a class="link" href="ch01.html" title="Chapter 1. Building Apps using Native UI Components"><em>Chapter 1</em></a>. However, you could use any application you have already created.
</p></li></ol></div><p>Click on the<strong> App IDs</strong> link from the left-hand menu, and when the screen loads, select the<strong> New App ID</strong> button.</p><p>Give your app a description and leave the Bundle Seed ID drop down list set as<strong> Generate New</strong>.</p><p>Enter in the Bundle Identifier. This is the all-important identifier that you give your application upon its creation in Titanium Studio. In this example, our bundle identifier is<code class="literal"> com.packtpub.loancalc</code>.</p><p>Press<strong> Submit</strong> to complete the process and generate your App ID.</p><p>Now click on<strong> Provisioning</strong> and select<strong> New Profile</strong> after the screen loads. It should have the<strong> Development</strong> tab activated.</p><p>Choose a name for your profile. We'll keep it simple and call this one<strong> LoanCalc Development Profile</strong>. You should now be able to check your certificate checkbox, and choose the<code class="literal"> LoanCalc</code> app identifier from the drop down list, as well as the device you wish to use for this Development profile. Press<strong> Submit</strong> when you have completed filling in the form.</p><p>Your new profile should now appear in the list of profiles under the<strong> Development</strong> tab. Wait for 20-30 seconds and refresh the page, and its status should change from<strong> Pending</strong> to<strong> Download</strong>. Download the certificate to a location on your computer such as the Desktop.</p><p>Repeat the previous steps, but instead of choosing the<strong> Development</strong> tab options, choose the<strong> Distribution</strong> tab instead. You'll also have an additional option when creating the certificate for<strong> Distribution: App Store or Ad Hoc</strong>. If you want to distribute your app on the iTunes store, ensure you check the first radio button option.<a id="id403" class="indexterm"/>
</p><div><h3 class="title"><a id="note78"/>Note</h3><p>If you're not the account owner, but have been given membership status to someone else's iTunes account (e.g. if you are the employee of a larger company), then you need to ensure that you've been given admin access in order to set up your certificates and profiles.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch12lvl1sec04"/>Build your app for iOS using Titanium Studio</h1></div></div></div><p>In this recipe, we will continue the process started in the two recipes prior to this one and build our application for both development and distribution to the iTunes store.</p><div><h3 class="title"><a id="tip07"/>Tip</h3><p>Remember, if all else fails, you can always build your application manually in XCode by navigating to the<code class="literal"> build/iphone</code> folder of your project and opening the XCode project file.</p></div><div><div><div><div><h2 class="title"><a id="ch12lvl2sec03"/>How to do it...</h2></div></div></div><div><ol class="orderedlist"><li class="listitem">Building your application for development.<a id="id404" class="indexterm"/><p>i. Open your project in Titanium Studio; we are using the<code class="literal"> LoanCalc</code> app from<a class="link" href="ch01.html" title="Chapter 1. Building Apps using Native UI Components"> Chapter 1</a> as an example, however, you may use any project you wish. Ensure that the Application ID in Titanium Studio (on the<strong> Edit</strong> tab) matches the ID you used when creating your provisioning profiles. In our case, this ID is<code class="literal"> com.packtpub.loancalc</code>.</p><p>ii. Switch across to the<strong> Test &amp; Package</strong> tab, and choose<strong> Run on Device</strong>. Titanium Studio should automatically have the iPhone option highlighted. If it doesn't, then you either aren't on a Mac (required) or perhaps don't have the necessary XCode tools installed. You can download XCode from<a class="ulink" href="http://developer.apple.com/xcode"> http://developer.apple.com/xcode</a>.</p><p>iii. On the file selection icon next to the<strong> Upload Provisioning Profile</strong> text box, select the development profile you created for<code class="literal"> LoanCalc</code>. Presuming you installed your WWDR Certificate and Development Certificate properly as per the previous recipe, you should now see a screen similar to the one shown in the following screenshot:<a id="id405" class="indexterm"/>
</p><div><img src="img/3968_12_04.jpg" alt="How to do it..."/></div><p>iv. Press the<strong> Finish</strong> button to have Titanium Studio kick off the build process. During this process your application will be built and added to your list of apps in the iTunes library. You will need to sync your iPhone or iPod Touch in order to get your app running on your device.</p></li><li class="listitem">Building your applications for distribution.<a id="id406" class="indexterm"/><p>i. First, we need to create your new application in iTunes Connect, on the Apple Developer website. Navigate to the iTunes Connect section on the Apple Developer website in your browser and click<strong> Manage Applications</strong>. The next screen that loads will list all of your current apps (if you have created any). To create a new one, click<strong> Add New App</strong> in the top left corner. Add in the information requested, including the app name (<strong>Packt LoanCalc</strong> in our example) and select the<code class="literal"> LoanCalc</code> app from the product identifier list. The SKU can be any code you wish, e.g. packtpub001. Fill in the information on the next two screens with a description, keywords, screenshots, and data about your application. When finished, you should be forwarded to a screen that looks like the one shown:</p><div><img src="img/3968_12_05.jpg" alt="How to do it..."/></div><p>ii. Now, if you're ready to upload, press the<strong> View Details</strong> button in the bottom left, and on the next page that loads, press the<strong> Ready To Upload Binary</strong> button that appears in the top right of the screen. Apple will ask you a couple of security questions. Answer these and your App status will changed from<strong> Prepare for Upload</strong> to<strong> Ready for Upload</strong>.<a id="id407" class="indexterm"/>
</p><p>iii. Switch back to Titanium`Studio, make sure your project is selected in the Project explorer page, and then select the<strong> Distribution</strong> button followed by the<strong> Distribute - App Store</strong> option.</p><p>iv. You should now be faced with a similar screen to the one you used to package your app for development testing. Enter in a distribution location (any will do, we have chosen the<code class="literal"> Downloads</code> folder for this example), and choose your Distribution profile that you saved from the previous recipe. Your<strong> Distribute</strong> screen in Titanium Studio should now look something like this:<a id="id408" class="indexterm"/>
</p><div><img src="img/3968_12_06.jpg" alt="How to do it..."/></div><p>v. Hit the<strong> Finish</strong> button to start the build process. If you get an error about a missing file in the<code class="literal"> Users/[your username]/Library/MobileDevice/Provisioning Profiles</code> directory, then simply copy the Distribution profile saved on your computer to this directory and rename it to the name of the missing file in the error dialog.<a id="id409" class="indexterm"/>
</p><p>vi. When this process is complete, XCode should load and the Organizer window should appear on screen with your application archived and ready to be submitted to the iTunes store, as seen in the following screenshot:</p><div><img src="img/3968_12_07.jpg" alt="How to do it..."/></div><p>vii. Hit<strong> Submit</strong> on this screen and follow the prompts. If everything has been done correctly (and according to Apple's rules), your app should be uploaded to the iTunes server and you should receive email confirmation of it being received within a few minutes!<a id="id410" class="indexterm"/>
</p></li></ol></div><div><h3 class="title"><a id="note79"/>Note</h3><p>You can check on the progress of your submission at any time via the iTunes Connect section of the developer program website. Approval usually takes between 1-2 weeks. However, this tends to fluctuate depending on the number of submissions and whether your app is rejected or requires changes before approval will be granted. Apple will send you emails at each stage of the submission cycle, including when you first submit the app, when they start reviewing it, and when they approve or reject it.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch12lvl1sec05"/>Joining the Google Android Developer Program</h1></div></div></div><p>In order to submit applications to the Android Marketplace, you must first register a Google account, and then register for both a Google Checkout account and Android Developer account. All of these accounts utilize the same username and password combination and the process is quite straightforward. Membership is paid, and starts from $25 USD (or equivalent), and is a one-time payment.<a id="id411" class="indexterm"/>
</p><div><div><div><div><h2 class="title"><a id="ch12lvl2sec04"/>How to do it…</h2></div></div></div><p>To register, first open up a web browser and navigate to<a class="ulink" href="http://market.android.com/publish"> http://market.android.com/publish</a>. You'll be asked to log in to your Google Account (as seen in the following screenshot). If you don't have one, then this is the stage at which you need to create an account.</p><div><img src="img/3968_12_08.jpg" alt="How to do it…"/></div><p>Once you've completed the sign in or registration process, you'll then be asked to provide your Developer/Publisher details. After that, you'll be required to pay the US $25 registration fee. That's it—simple and straightforward! You can now start to create and upload applications to the Android Marketplace.<a id="id412" class="indexterm"/>
</p><div><h3 class="title"><a id="tip08"/>Tip</h3><p>Google may send you an e-mail a few weeks after registering, asking for identification for the account, usually in the form of a passport or driver's licence. You can e-mail them this information back within the allotted timeframe and all will be well.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch12lvl1sec06"/>Creating your application's distribution key</h1></div></div></div><p>In order to build applications made for the Android Marketplace, you need to create a distribution key on your local computer. This key is used to digitally sign your app.</p><div><div><div><div><h2 class="title"><a id="ch12lvl2sec05"/>How to do it…</h2></div></div></div><p>Open the Terminal if you use Mac or Linux, or alternatively the command prompt if you're a Windows user. Change the current directory to the following using the<code class="literal"> cd</code> command:<a id="id413" class="indexterm"/>
</p><div><pre class="programlisting">cd /&lt;path to your android sdk&gt;/tools
//e.g. cd /Users/boydlee/android-sdk/tools
</pre></div><p>To create the key, we need to use the Java<strong> keytool</strong> located in this directory. In the command prompt/terminal, type in the following, while replacing<code class="literal"> my-release-key.keystore</code> and<code class="literal"> alias_name</code> with the key and alias of your application:</p><div><pre class="programlisting">Windows: START"Command $ keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -validity 10000
Windows: Mac: Terminal $ keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -validity 10000
</pre></div><p>For example, our<code class="literal"> LoanCalc</code> application key command will look something like:</p><div><pre class="programlisting">$ keytool -genkey -v -keystore packtpub.loancalc -alias loancalc -keyalg RSA -validity 10000
</pre></div><p>Press<em> Enter</em> and execute the command and you'll be asked a series of questions. You need to provide a password for the keystore - it would be wise to write it down as you will need it to package your app later. We'll use the password<code class="literal"> packtpub</code>. When you are prompted for the secondary key password, simply press<em> Enter</em> to use the same one.</p><p>Now your key will be exported and saved to the directory you were currently in. In our case, this is the<code class="literal"> tools</code> directory under our Android SDK folder. You will need to remember the file location in order to build your Android app using Titanium Studio in the next recipe.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch12lvl1sec07"/>Building and submitting your app to the Android Marketplace</h1></div></div></div><p>In this recipe, we will continue the process started in the two previous recipes and build our application for distribution to the Android Marketplace.<a id="id414" class="indexterm"/>
</p><div><div><div><div><h2 class="title"><a id="ch12lvl2sec06"/>How to do it…</h2></div></div></div><p>Open your project in Titanium Studio. We are using the<code class="literal"> LoanCalc</code> app from<a class="link" href="ch01.html" title="Chapter 1. Building Apps using Native UI Components"> Chapter 1</a> as an example, however, you may use any project you wish. Make sure your project is selected in the Project explorer page, and then select the<strong> Distribution</strong> button followed by the<strong> Distribute - Android</strong> option, as seen in the following screenshot:</p><div><img src="img/3968_12_09.jpg" alt="How to do it…"/></div><p>You will need to enter in the distribution location (where you want the packaged APK file saved to) and the location of the keystore file you created in the previous recipe, along with the password and alias you provided earlier. After you enter in that information it should look something like the following screenshot:</p><div><img src="img/3968_12_10.jpg" alt="How to do it…"/></div><p>If all of the information is correct, click<strong> Finish</strong>. After a few minutes the APK file will be written out to the distribution location you provided. Go back to the Android Marketplace website, and on the home screen, click<strong> Add New Application</strong>. Select the<strong> Upload</strong> button and choose your saved APK (<code class="literal">LoanCalc.apk</code> in our case) and upload it to the server. If everything was successful, you should see a screen similar to the one shown next:<a id="id415" class="indexterm"/>
</p><div><img src="img/3968_12_11.jpg" alt="How to do it…"/></div><p>All that is left to do now is fill in the remaining information, including a description and title for your app, plus some screenshots. You will also be asked to select pricing information and agree to Google's terms and conditions. Once that is done, all that is left to do is press<strong> Submit</strong>. Within a few minutes, your application should start to appear in the Android Marketplace! Unlike Apple, there is no approval process necessary for apps submitted for Android.<a id="id416" class="indexterm"/>
</p><p>You should now be able to build and submit applications to both the Apple and Android Marketplaces.</p></div></div></body></html>