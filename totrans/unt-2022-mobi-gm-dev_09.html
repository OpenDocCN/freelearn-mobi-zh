<html><head></head><body>
		<div id="_idContainer273">
			<h1 id="_idParaDest-107" class="chapter-number"><a id="_idTextAnchor290"/>9</h1>
			<h1 id="_idParaDest-108"><a id="_idTextAnchor291"/>Keeping Players Involved with Notifications</h1>
			<p>One of the best ways to keep users coming back to your game is through the use of push notifications. This allows you to stay in contact with your users even when they’re not using your game. Used wisely, this can keep users playing your game for a long period of time. Using notifications too often or poorly will cause users to mute your app’s notifications, which is not an <span class="No-Break">ideal situation.</span></p>
			<p>In this chapter, we will explore how to create notifications for both Android and iOS devices. We will then learn how to schedule notifications to keep players returning to the game later on, as well as ways that we can <span class="No-Break">customize them.</span></p>
			<p>The chapter is split into a number of topics. It contains a simple, step-by-step process from beginning to end. Here is the outline of <span class="No-Break">our tasks:</span></p>
			<ul>
				<li>Setting <span class="No-Break">up notifications</span></li>
				<li>Scheduling notifications ahead <span class="No-Break">of time</span></li>
				<li>Customizing <span class="No-Break">notification presentation</span></li>
				<li><span class="No-Break">Canceling notifications</span></li>
			</ul>
			<h1 id="_idParaDest-109"><a id="_idTextAnchor292"/>Technical requirements</h1>
			<p>This book utilizes Unity 2022.1.0b16 and Unity Hub 3.3.1, but the steps should work with minimal changes in future versions of the editor. If you would like to download the exact version used in this book, and there is a new version out, you can visit Unity’s download archive at <a href="https://unity3d.com/get-unity/download/archive">https://unity3d.com/get-unity/download/archive</a>. You can also find the system requirements for Unity at <a href="https://docs.unity3d.com/2022.1/Documentation/Manual/system-requirements.html">https://docs.unity3d.com/2022.1/Documentation/Manual/system-requirements.html</a> in the <em class="italic">Unity Editor system requirements</em> section. To deploy your project, you will need an Android or <span class="No-Break">iOS device.</span></p>
			<p>You can find the code files present in this chapter on GitHub <span class="No-Break">at </span><a href="https://github.com/PacktPublishing/Unity-2022-Mobile-Game-Development-3rd-Edition/tree/main/Chapter09"><span class="No-Break">https://github.com/PacktPublishing/Unity-2022-Mobile-Game-Development-3rd-Edition/tree/main/Chapter09</span></a><span class="No-Break">.</span></p>
			<h1 id="_idParaDest-110"><a id="_idTextAnchor293"/>Setting up notifications</h1>
			<p>Before we can<a id="_idIndexMarker579"/> start adding notifications to our project, we will need to add a special preview package that Unity makes available. Follow the steps <span class="No-Break">given here:</span></p>
			<ol>
				<li>From the Unity Editor, go to <strong class="bold">Window</strong> | <span class="No-Break"><strong class="bold">Package</strong></span><span class="No-Break"> </span><span class="No-Break"><strong class="bold">Manager</strong></span><span class="No-Break">.</span></li>
				<li>From there, if the top-left section does not say <strong class="bold">Packages: Unity Registry</strong>, click on the <strong class="bold">In Project</strong> drop-down menu from the toolbar of the <strong class="bold">Packages</strong> menu and select <span class="No-Break"><strong class="bold">Unity Registry</strong></span><span class="No-Break">.</span></li>
				<li>Scroll down the available options until you reach <strong class="bold">Mobile Notifications</strong> and select it. Once there, click on the arrow to the side of it and select <strong class="bold">See All Versions</strong> and then select the latest version (in my case, it was <strong class="bold">Version 2.0.2</strong>). From there, click the <strong class="bold">Install</strong> button and you’ll see the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer262" class="IMG---Figure">
					<img src="image/B18868_09_01.jpg" alt="Figure 9.1: Installing the Mobile Notifications package"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.1: Installing the Mobile Notifications package</p>
			<p class="callout-heading">Note</p>
			<p class="callout">It’s important to note that this package requires your game to use Android 5.1 (API level 22) and iOS 10 or above in order to <span class="No-Break">function properly.</span></p>
			<p>We will also be using a cross-platform wrapper, also written by Unity, in order to get notifications working quickly and remove the requirement of writing <span class="No-Break">platform-specific code.</span></p>
			<ol>
				<li value="4">After this, open<a id="_idIndexMarker580"/> up the <strong class="bold">Samples</strong> section and then click on the <strong class="bold">Import</strong> button next to the <strong class="bold">Notification </strong><span class="No-Break"><strong class="bold">Samples</strong></span><span class="No-Break"> button.</span></li>
			</ol>
			<div>
				<div id="_idContainer263" class="IMG---Figure">
					<img src="image/B18868_09_02.jpg" alt="Figure 9.2: Importing the notification samples"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.2: Importing the notification samples</p>
			<p>This project, created by Unity, is used to show how you can use Unity’s Mobile Notifications API in some real-world examples. We are using it for the cross-platform wrapper, which will allow us to create a notification once, and it will work on both Android and iOS without us doing any <span class="No-Break">additional work.</span></p>
			<ol>
				<li value="5">After installing this, you may close the <strong class="bold">Package Manager</strong> window. To ensure that we can export our project, we need to ensure that our project has the correct Minimum <span class="No-Break">API level.</span></li>
				<li>Next, go to the <strong class="bold">Project Settings</strong> menu by going to <strong class="bold">Edit</strong> | <strong class="bold">Project Settings</strong>. From there, go to the <strong class="bold">Player</strong> options and under <strong class="bold">Other Settings</strong> scroll down to <strong class="bold">Minimum API Level</strong> and verify that it is set to the version specified in the Mobile Notifications package (in this case, <strong class="bold">Android 5.1 ‘Lollipop’ (API level 22)</strong>) or higher. Afterward, you <a id="_idIndexMarker581"/>can close the <strong class="bold">Project </strong><span class="No-Break"><strong class="bold">Settings</strong></span><span class="No-Break"> window:</span></li>
			</ol>
			<div>
				<div id="_idContainer264" class="IMG---Figure">
					<img src="image/B18868_09_03.jpg" alt="Figure 9.3: Ensuring the Minimum API Level is set correctly"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.3: Ensuring the Minimum API Level is set correctly</p>
			<p><a id="_idTextAnchor294"/>You should see that there are a number of folders that are part of the project. The files that we care about are located in the <strong class="source-inline">Assets\Samples\Mobile Notifications\2.0.2\Notification Samples\Scripts</strong> folder. See the <span class="No-Break">following screenshot:</span></p>
			<div>
				<div id="_idContainer265" class="IMG---Figure">
					<img src="image/B18868_09_04.jpg" alt="Figure 9.4: The Notification Samples Scripts folder"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.4: The Notification Samples Scripts folder</p>
			<p>This gives us the <a id="_idIndexMarker582"/>code needed – in particular, the <strong class="source-inline">GameNotificationManager</strong> class – to be added to our script. At this point, we could move these scripts into a subfolder of our <strong class="source-inline">Scripts</strong> folder and delete the other files or keep the files where <span class="No-Break">they are.</span></p>
			<p><a id="_idTextAnchor295"/>To begin displaying notifications on our screen, we first need to add a new object to our level that will contain the Game <span class="No-Break">Notifications Manager:</span></p>
			<ol>
				<li>Open the <strong class="bold">MainMenu</strong> scene if it isn’t already open. From there, create a new game object by going to <strong class="bold">GameObject</strong> | <span class="No-Break"><strong class="bold">Create Empty</strong></span><span class="No-Break">.</span></li>
				<li>From the <strong class="bold">Inspector</strong> window, change the name of the object to <strong class="source-inline">Notifications Manager</strong> and, for the sake of neatness, reset the <strong class="bold">Transform</strong> component’s <strong class="bold">Position</strong> property by right-clicking on the <strong class="bold">Transform</strong> component and selecting the <strong class="bold">Reset </strong><span class="No-Break"><strong class="bold">Position</strong></span><span class="No-Break"> option.</span></li>
				<li>Afterward, attach the <strong class="bold">Game Notifications Manager</strong> component to the <strong class="bold">Notifications Manager</strong> object by clicking on the <strong class="bold">Add Component</strong> button and then typing in <strong class="source-inline">gamen</strong>, and then selecting <strong class="bold">Game Notifications Manager </strong>from the list. It<a id="_idIndexMarker583"/> should look something like the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer266" class="IMG---Figure">
					<img src="image/B18868_09_05.jpg" alt="Figure 9.5: Adding the Game Notifications Manager"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.5: Adding the Game Notifications Manager</p>
			<p>After the component has been placed, we can do the setup needed to create our first notification. Due to the implementation of the <strong class="source-inline">GameNotificationsManager</strong> class, we will need to have another script to send the notifications, which we will <span class="No-Break">call </span><span class="No-Break"><strong class="source-inline">NotificationsController</strong></span><span class="No-Break">.</span></p>
			<ol>
				<li value="4">From the <strong class="bold">Project</strong> window, open the <strong class="source-inline">Assets/Scripts</strong> folder and create a new C# script called <strong class="source-inline">NotificationsController</strong>. Double-click on the newly created file to open up your code editor <span class="No-Break">of choice.</span></li>
				<li><a id="_idTextAnchor296"/>Next, add the <a id="_idIndexMarker584"/>following code for <span class="No-Break">the class:</span></li>
			</ol>
			<pre class="source-code">
using UnityEngine;
using NotificationSamples; /* GameNotificationManager */
public class NotificationsController : MonoBehaviour
{
    private GameNotificationsManager notificationsManager;
    // Start is called before the first frame update
    private void Start()
    {
        /* Get access to the notifications manager */
        notificationsManager =
            GetComponent&lt;GameNotificationsManager&gt;();
        /* Create a channel to use (required for Android)
        */
        var channel = new
            GameNotificationChannel("channel0",
                "Default Channel",
                    "Generic Notifications");
        /* Initialize the manager so it can be used. */
        notificationsManager.Initialize(channel);
    }
}</pre>
			<p>In the preceding code, we are first getting access to the <strong class="source-inline">GameNotificationsManager</strong> class through the component. Since we are attaching this script to the same game object that contains this script, we can use the <strong class="source-inline">GetComponent</strong> function. Afterward, we create a channel to post our notifications on. Lastly, we initialize the <strong class="source-inline">GameNotificationsManager </strong>component using<a id="_idIndexMarker585"/> <span class="No-Break">the channel.</span></p>
			<ol>
				<li value="6">Save your script and go back to the Unity Editor. From the <strong class="bold">Inspector</strong> window, attach the <strong class="bold">Notifications Controller</strong> script to the <strong class="bold">Notifications Manager</strong> object, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer267" class="IMG---Figure">
					<img src="image/B18868_09_06.jpg" alt="Figure 9.6: Adding the Notifications Manager﻿"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.6: Adding the Notifications Manager<a id="_idTextAnchor297"/></p>
			<p>Now that we <a id="_idIndexMarker586"/>have the setup taken care of, let’s see how we can actually schedule<a id="_idTextAnchor298"/> a notification <span class="No-Break">to happen<a id="_idTextAnchor299"/>.</span></p>
			<h1 id="_idParaDest-111"><a id="_idTextAnchor300"/>Scheduling notifications ahead of time</h1>
			<p>One of the most common <a id="_idIndexMarker587"/>forms of creating a notification is asking players to come back and play the game at a later time. This encourages users to continue playing our game and to come back multiple times. We can do this by setting a delivery time in the future using the <span class="No-Break">following steps:</span></p>
			<ol>
				<li>Open up the <strong class="source-inline">NotificationsController</strong> script and add the following function <span class="No-Break">to it:</span><pre class="source-code">
public void ShowNotification(string title, string body,
DateTime deliveryTime)
{
    IGameNotification notification =
        notificationsManager.CreateNotification();
    if (notification != null)
    {
        notification.Title = title;
        notification.Body = body;
        notification.DeliveryTime = deliveryTime;
    notificationsManager.ScheduleNotification(
        notification);
    }
<a id="_idTextAnchor301"/>}</pre></li>
			</ol>
			<p>This function takes in three parameters – the title, the body, and the time at which to send <span class="No-Break">the notification.</span></p>
			<ol>
				<li value="2">This function requires the use of the <strong class="source-inline">System</strong> namespace for the <strong class="source-inline">DateTime</strong> class, so at the top of the <strong class="source-inline">NotificationsController</strong> file, add the <span class="No-Break">following line:</span><pre class="source-code">
using System; /* DateTime */</pre></li>
				<li>Creating the function doesn’t do anything, so for the sake of testing that everything has been set up correctly, let’s call the function within our <strong class="source-inline">Start</strong> function by adding<a id="_idIndexMarker588"/> the following <span class="No-Break">highlighted code:</span><pre class="source-code">
// Start is called before the first frame update
private void Start()
{
    /* Get access to the notifications manager */
    notificationsManager =
        GetComponent&lt;GameNotificationsManager&gt;();
    /* Create a channel to use for it (required for
       Android) */
    var channel = new
        GameNotificationChannel("channel0",
            "Default Channel",
                "Generic Notifications");
    /* Initialize the manager so it can be used. */
    notificationsManager.Initialize(channel);
<strong class="bold">    /* Create sample notification to happen in 5</strong>
<strong class="bold">       seconds */</strong>
<strong class="bold">    var notifText = "Come back and try to beat your</strong>
<strong class="bold">        score!!";</strong>
<strong class="bold">    var notifTime = DateTime.Now.AddSeconds(5);</strong>
<strong class="bold">    </strong><strong class="bold">ShowNotification("Endless Runner", notifText,</strong>
<strong class="bold">        notifTime);</strong>
}</pre></li>
			</ol>
			<p>In this example, we <a id="_idIndexMarker589"/>are passing in <strong class="source-inline">"Endless Runner"</strong> as the title, <strong class="source-inline">"Come back!"</strong> as the body, and for the third parameter, we are getting the current time by using <strong class="source-inline">DateTime.Now</strong> and then asking to add 5 seconds by using the <strong class="source-inline">AddSeconds</strong> method, passing <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">5</strong></span><span class="No-Break">.</span></p>
			<ol>
				<li value="4">Save the script and return to the <span class="No-Break">Unity Editor.</span></li>
				<li>Unfortunately, you won’t be able to test whether notifications work on your PC. We’ll have to export the game to see whether it <span class="No-Break">works correctly.</span></li>
				<li>Export your game to your device and start the game. As you can see, our notifications are <span class="No-Break">working correctly!</span></li>
			</ol>
			<div>
				<div id="_idContainer268" class="IMG---Figure">
					<img src="image/B18868_09_07.jpg" alt="Figure 9.7: Our default notification working prop﻿erly"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.7: Our default notification working prop<a id="_idTextAnchor302"/>erly</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">By default, the <strong class="bold">Game Notifications Manager</strong> component has <strong class="bold">Mode</strong> set to <strong class="bold">Queue Clear and Reschedule</strong>, which will make it so that you will be unable to see notifications if the game is open. If you would like to see the notifications always, change the mode <span class="No-Break">to </span><span class="No-Break"><strong class="bold">NoQueue</strong></span><span class="No-Break">.</span></p>
			<ol>
				<li value="7">Generally, these kinds<a id="_idIndexMarker590"/> of notifications should be sent a day after the player has last played. We can do that by modifying the function to <span class="No-Break">the following:</span><pre class="source-code">
    // Start is called before the first frame update
    private void Start()
    {
        /* Get access to the notifications manager */
        notificationsManager =
        GetComponent&lt;GameNotificationsManager&gt;();
        /* Create a channel to use (required for
           Android) */
        var channel = new
            GameNotificationChannel("channel0",
                "Default Channel",
                    "Generic Notifications");
        /* Initialize the manager so it can be used.
        */
        notificationsManager.Initialize(channel);
<strong class="bold">        /* Create sample notification to happen in 5</strong>
<strong class="bold">           seconds */</strong>
<strong class="bold">        var notifText = "Come back and try to beat</strong>
<strong class="bold">            your score!!";</strong>
<strong class="bold">        var notifTime = DateTime.Now.AddDays(1);</strong>
<strong class="bold">        ShowNotification("Endless Runner", notifText,</strong>
<strong class="bold">            notifTime);</strong>
    }</pre></li>
			</ol>
			<p>This will make it so that <a id="_idIndexMarker591"/>when we reach a level, we will display the notification after a day, but this will also happen every time we go to the main menu. To prevent this, we can add a <strong class="source-inline">static bool</strong> variable that will turn on when adding the notification. In Unity, when a variable is marked as <strong class="source-inline">static</strong>, it will be consistent throughout the running of the program. To add this variable, follow the steps <span class="No-Break">given here:</span></p>
			<ol>
				<li>Update the script to add the following code highlighted <span class="No-Break">in bold:</span><pre class="source-code">
<strong class="bold">    </strong><strong class="bold">private static bool addedReminder = false;</strong>
    // Start is called before the first frame update
    private void Start()
    {
        /* Get access to the notifications manager */
        notificationsManager =
        GetComponent&lt;GameNotificationsManager&gt;();
        /* Create a channel to use (required for
           Android) */
        var channel = new
            GameNotificationChannel("channel0",
                "Default Channel",
                    "Generic Notifications");
        /* Initialize the manager so it can be used.
        */
        notificationsManager.Initialize(channel);
<strong class="bold">        /* Check if the notification hasn't been added</strong>
<strong class="bold">           yet */</strong>
<strong class="bold">        if (!addedReminder)</strong>
<strong class="bold">        {</strong>
            /* Create sample notification to happen
               later */
            var notifText = "Come back and try to beat
                your score!!";
            var notifTime = DateTime.Now.AddDays(1);
            ShowNotification("Endless Runner",
                notifText, notifTime);
<strong class="bold">            /* Cannot be added again until the user</strong>
<strong class="bold">               quits game */</strong>
<strong class="bold">            addedReminder = true;</strong>
        }
    }</pre></li>
				<li>Save your script. Now<a id="_idIndexMarker592"/>, when we play the game, we will only see the notification once every time we play <span class="No-Break">th<a id="_idTextAnchor303"/>e game!</span></li>
			</ol>
			<p>This shows us how we can create notifications within our script, but right now, the notifications are kind of plain. Thankfully, it’s possible to customize notifications, w<a id="_idTextAnchor304"/>hich is what we’ll be <a id="_idIndexMarker593"/>working <span class="No-Break">on next.</span></p>
			<p class="callout-heading">Note</p>
			<p class="callout">If you’d like to look into how to send notifications from outside of Unity to your app through tools such as Google Firebase, check <span class="No-Break">out </span><a href="https://firebase.google.com/products/cloud-messaging"><span class="No-Break">https://firebase.google.com/products/cloud-mes<span id="_idTextAnchor305"/>saging</span></a><span class="No-Break">.</span></p>
			<h1 id="_idParaDest-112"><a id="_idTextAnchor306"/>Customizing notifications</h1>
			<p>Unity includes some<a id="_idIndexMarker594"/> default visuals to be used with notifications, but generally, replacing the content with our own will help our game stand out and be more visually appealing to players. In order to have custom icons for Android notifications, you are required to have a small icon with at least 48 x 48 pixels, and have only white pixels with a transparent backdrop. The large icon must be at least 192 x 192 and can have whatever colors we’d like. You can create images of your own, or use the images named <strong class="source-inline">Hi-ResIcon.png</strong> and <strong class="source-inline">Small-ResIcon.png</strong> provided in the example code for this book in the <span class="No-Break"><strong class="source-inline">Chapter 08</strong></span><strong class="source-inline">\Assets\Sprites</strong> folder of the GitHub repository. Follow the steps given here <span class="No-Break">for customization:</span></p>
			<ol>
				<li>From the <strong class="bold">Project</strong> window, select the images you are planning to use for the small and <span class="No-Break">large icons.</span></li>
				<li>With the images selected, go to the <strong class="bold">Inspector</strong> window and check the <strong class="bold">Alpha Is </strong><span class="No-Break"><strong class="bold">Transparency</strong></span><span class="No-Break"> property.</span></li>
				<li>Finally, open up the <strong class="bold">Advanced</strong> options and check the <strong class="bold">Read/Write</strong> properties. Click on the <strong class="bold">Apply</strong> button so the <span class="No-Break">changes<a id="_idTextAnchor307"/> happen.</span></li>
			</ol>
			<p>You can see the options in the <strong class="bold">Inspector</strong> window in the <span class="No-Break">following screenshot:</span></p>
			<div>
				<div id="_idContainer269" class="IMG---Figure">
					<img src="image/B18868_09_08.jpg" alt="Figure 9.﻿8: Setting the properties needed for the notification icons"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.8: Setting the properties needed for the notification icons</p>
			<p>At this point, our images <a id="_idIndexMarker595"/>are ready and we can start to put them into our notifications. To do this, we will need to go to the <strong class="bold">Project </strong><span class="No-Break"><strong class="bold">Settings</strong></span><span class="No-Break"> menu:</span></p>
			<ol>
				<li>Open the <strong class="bold">Project Settings</strong> menu by going to <strong class="bold">Edit</strong> | <span class="No-Break"><strong class="bold">Project Settings</strong></span><span class="No-Break">.</span></li>
				<li>From there, go to the <strong class="bold">Mobile Notifications</strong> <span class="No-Break">settings option.</span></li>
				<li>From the menu, you’ll see two options – iOS and Android. We will want to use the default properties for the iOS options so we will first select <strong class="bold">Android</strong> if it isn’t <span class="No-Break">selected already.</span></li>
				<li>Check the <strong class="bold">Reschedule Notifications on Device Restart</strong> option. This will make it so that if someone plays the game again, they will no longer get the notification we created earlier. This will help the user not get annoyed at us spamming them <span class="No-Break">t<a id="_idTextAnchor308"/>oo often.</span></li>
				<li>Next, under <strong class="bold">Notification Icons</strong>, click on the plus (<strong class="bold">+</strong>) icon. Drag and drop the small icon image into the first <strong class="bold">Texture 2D</strong> option. Next, click on the plus (<strong class="bold">+</strong>) icon again and then <a id="_idIndexMarker596"/>change <strong class="bold">Type</strong> to <strong class="bold">Large</strong>. Afterward, assign your large icon to the Texture <span class="No-Break">2D spot:</span></li>
			</ol>
			<div>
				<div id="_idContainer270" class="IMG---Figure">
					<img src="image/B18868_09_09.jpg" alt="Figure 9.9: Setting up Mobile Notification Icons"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.9: Setting up Mobile Notification Icons</p>
			<ol>
				<li value="6">Then, go back to the <strong class="source-inline">NotificationsController</strong> script and update the <strong class="source-inline">ShowNotification</strong> function to use our <span class="No-Break">new icons:</span><pre class="source-code">
public void ShowNotification(string title, string body, DateTime deliveryTime)
{
    IGameNotification notification =
    notificationsManager.CreateNotification();
    if (notification != null)
    {
        notification.Title = title;
        notification.Body = body;
        notification.DeliveryTime = deliveryTime;
        notification.SmallIcon = "icon_0";
        notification.LargeIcon = "icon_1";
        notificationsManager.ScheduleNotification(
            notification);
    }
}</pre></li>
				<li>Save your script and<a id="_idIndexMarker597"/> return to the Unity Editor. Export your game to Android and you should see the icons update. Now, the notification will show the small icon from the toolbar, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer271" class="IMG---Figure">
					<img src="image/B18868_09_10.jpg" alt="Figure 9.10: Small notification icon being shown"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.10: Small notification icon being shown</p>
			<p>And it will use both icons when accessing the notification itself! This can be seen in the <span class="No-Break">following</span><span class="No-Break"><a id="_idIndexMarker598"/></span><span class="No-Break"> screenshot:</span></p>
			<div>
				<div id="_idContainer272" class="IMG---Figure">
					<img src="image/B18868_09_11.jpg" alt="Figure 9.11: Seeing the notification from the notifications bar with bo﻿th icons"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.11: Seeing the notification from the notifications bar with bo<a id="_idTextAnchor309"/>th icons</p>
			<p>It is also possible to modify other properties, such as the badge number used in iOS, by using a line such as <span class="No-Break">the following:</span></p>
			<pre class="source-code">
notification.BadgeNumber = 5;</pre>
			<p class="callout-heading">Important note</p>
			<p class="callout">For more information on how you can customize your notifications, check <span class="No-Break">out </span><a href="https://docs.unity3d.com/Packages/com.unity.mobile.notifications@1.0/manual/index.html"><span class="No-Break">https://docs.unity3d.com/Packages/com.unity.mobile.notifications@1.0/manual/index.html</span></a><span class="No-Break">.</span></p>
			<p>This allows us to have our notifications look just the way we want them to with as much polish as we would like them to have. Now that we have our notifications customized the way that we want<a id="_idIndexMarker599"/> them, it might be pertinent for us to discuss how we can cancel notifications that we no longer wish to <span class="No-Break">have happen.</span></p>
			<h1 id="_idParaDest-113"><a id="_idTextAnchor310"/>Canceling notifications</h1>
			<p>There are several <a id="_idIndexMarker600"/>reasons why we may want to cancel notifications. This could be due to the fact that, during play, the player has made a decision that has caused something to no longer <span class="No-Break">be relevant.</span></p>
			<p>For this example, let’s create a sample notification that we will cancel before it has a chance to happen. But for us to cancel a notification, we must have a way of knowing which notification is which. Thankfully, the Notifications Manager has a property called an <strong class="source-inline">Id</strong> that each notification has. We can set the notification ourselves by hand or Unity will generate it for us. In our case, we will use the automatically <span class="No-Break">generated one:</span></p>
			<ol>
				<li>Open up the <strong class="source-inline">NotificationsController</strong> script and go to the <strong class="source-inline">ShowNotification</strong> function. Update it to <span class="No-Break">the following:</span><pre class="source-code">
public int? ShowNotification(string title, string body, DateTime deliveryTime)
{
    IGameNotification notification =
    notificationsManager.CreateNotification();
    if (notification != null)
    {
        notification.Title = title;
        notification.Body = body;
        notification.DeliveryTime = deliveryTime;
        notification.SmallIcon = "icon_0";
        notification.LargeIcon = "icon_1";
        var pendingNotif =
            notificationsManager.ScheduleNotification(
                notification);
        return pendingNotif.Notification.Id;
    }
    return null;
}</pre></li>
			</ol>
			<p>Note that our return<a id="_idIndexMarker601"/> type for this function has changed from <strong class="source-inline">void</strong> to <strong class="source-inline">int?</strong> and the question mark is not a typo. This is something<a id="_idIndexMarker602"/> called a <strong class="bold">nullable type</strong>. Nullable types are instances of the <strong class="source-inline">System.Nullable</strong> struct, which is basically a special type that allows us to have a variable that can consist of having any value of the type associated with it, but also can be assigned to <strong class="source-inline">null</strong> as well. That means that this value can either be set or not. Some platforms, such as PCs, don’t have support for notifications with the system so, in those cases, they’ve chosen to use <strong class="source-inline">null</strong> instead of something like <span class="No-Break"><em class="italic">negative one</em></span><span class="No-Break">.</span></p>
			<ol>
				<li value="2">Now that we’ve updated our script, let’s now show an example of how we can cancel a notification. Go to the <strong class="source-inline">Start</strong> function and update it to <span class="No-Break">the following:</span><pre class="source-code">
// Start is called before the first frame update
private void Start()
{
    /* Get access to the notifications manager */
    notificationsManager =
    GetComponent&lt;GameNotificationsManager&gt;();
    /* Create a channel to use (required for Android)
    */
    var channel = new
        GameNotificationChannel("channel0",
            "Default Channel",
                "Generic Notifications");
    /* Initialize the manager so it can be used. */
    notificationsManager.Initialize(channel);
    /* Check if the notification hasn't been added yet
    */
    if (!addedReminder)
    {
        /* Create sample notification to happen in 5
           seconds */
        var notifText = "Come back and try to beat
            your score!!";
        // After 5 seconds
        var notifTime = DateTime.Now.AddSeconds(5);
        // After 1 day
        //notifTime = DateTime.Now.AddDays(1);
        ShowNotification("Endless Runner", notifText,
            notifTime);
<strong class="bold">        // Example of canceling a notification</strong>
<strong class="bold">        var id = ShowNotification("Test", "Should Not</strong>
<strong class="bold">            Happen", notifTime);</strong>
<strong class="bold">        if(id.HasValue)</strong>
<strong class="bold">        {</strong>
<strong class="bold">            notificationsManager.CancelNotification(</strong>
<strong class="bold">                id.Value);</strong>
<strong class="bold">        }</strong>
        /* Cannot be added again until the user quits
           game */
        addedReminder = true;
    }
}</pre></li>
				<li>Save your script and build your game. If you open up the project on your Android or IOS device, you<a id="_idIndexMarker603"/> should be able to see that the verification that we have set to not be canceled plays as normal. But the one that we canceled does <span class="No-Break">not happen.</span></li>
			</ol>
			<p class="callout-heading">Tip</p>
			<p class="callout">You can also cancel all notifications at once by simply calling the <strong class="source-inline">CancelAllNotifications</strong> function from the <strong class="source-inline">GameNotificationManager</strong> class. For more information on canceling notifications, check <span class="No-Break">out </span><a href="https://docs.unity3d.com/Packages/com.unity.mobile.notifications@1.0/manual/index.html"><span class="No-Break">https://docs.unity3d.com/Packages/com.unity.mobile.notifications@1.0/manua<span id="_idTextAnchor311"/>l/index.html</span></a><span class="No-Break">.</span></p>
			<h1 id="_idParaDest-114"><a id="_idTextAnchor312"/>Summary</h1>
			<p>At this point, we have seen how we can make use of Unity’s Mobile Notifications package to create notifications for our players. We’ve learned how to schedule them to take place in the future as well as how to customize these notifications to have our own distinct <span class="No-Break">visual style!</span></p>
			<p>We now have everything in place for players to play and come back to our game, but we are only relying on what we created. In addition to that, we may want to see what our players are doing while playing our games. Then, we can use that information to improve and/or tweak <span class="No-Break">our game.</span></p>
			<p>In the next chapter, we will take a look at how we can do this using tools from <span class="No-Break">Unity Analytics.</span></p>
		</div>
	</body></html>