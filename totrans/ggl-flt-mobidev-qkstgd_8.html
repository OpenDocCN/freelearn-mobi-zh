<html><head></head><body>
        

                            
                    <h1 class="header-title">Deploying Flutter Apps</h1>
                
            
            
                
<p>Deploying the Flutter app is one of the easiest processes to enable developers to prepare the apps for publishing on app stores. By now, you must have learned Google's mobile app SDK provides several features to craft high-quality native interfaces on iOS and Android, in record time.</p>
<p>In this chapter, we will look at the following topics:</p>
<ul>
<li class="h1">Deploying on Android</li>
<li class="h1">Deploying on iOS</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Deploying on Android</h1>
                
            
            
                
<p>In the course of this book so far, the build that we have built is a debug type. Ideally, this is used for testing the app before following the steps to produce the release version of the app to be uploaded. Flutter also allows creating flavors of the app. If you wish to build a production version of the app you have developed, follow the upcoming steps.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Reviewing the AndroidManifest.xml file</h1>
                
            
            
                
<p>This file holds some of the major global settings of the app that come in handy when building the production version of the app. It can be located at <kbd>&lt;app dir&gt;/android/app/src/main</kbd>. When you click on the <kbd>AndroidManifest.xml</kbd> file, you will find the snippet in the <kbd>Application</kbd> tag shown as follows:</p>
<pre>…..<br/>android:name="io.flutter.app.FlutterApplication"<br/>android:label="flutter_app_battery"<br/>android:icon="@mipmap/ic_launcher"&gt;<br/>….</pre>
<p>The explanation for the properties visible in the preceding code are as follows:</p>
<ul>
<li><kbd>android.name</kbd>: This property sets the package name for the app</li>
<li><kbd>android.label</kbd>: This property sets the final name of the app</li>
<li><kbd>android:icon</kbd>: This property sets the launch icon for the app</li>
</ul>
<pre>….<br/>&lt;uses-permission android:name="android.permission.INTERNET"/&gt;<br/>…..</pre>
<p>The <kbd>&lt;uses-permission&gt;</kbd> tag allows developers to set the permission needed for the developers in the app. For example, if you wish to use the internet, the preceding property has to be used, or if you wish to access the camera, <kbd>&lt;uses-permission android:name="android.permission.CAMERA"/&gt;</kbd> has to be used. This will manifest element for all camera features. The developers can also demand to ask the users for the permission access in the <strong>runtime</strong> mode.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">The build.gradle configurations</h1>
                
            
            
                
<p>The next step is to review the Gradle build file situated in <kbd>&lt;app dir&gt;/android/app</kbd> and to confirm whether the values entered in the following parameters are correct:</p>
<ul>
<li>Set the <kbd>VersionCode</kbd> and <kbd>VersionName</kbd> in the following snippet. Please note that the <kbd>VersionCode</kbd> value should be unique for every uploaded build and that it is an absolute value. The greatest value the Google Play store allows for <kbd>versionCode</kbd> is <kbd>2100000000</kbd>. On the other hand, <kbd>VersionName</kbd> is a string value. There is no purpose of <kbd>VersionName</kbd> to show up the value on the play store. The string value can be cascaded as a <kbd>&lt;major&gt;.&lt;minor&gt;.&lt;point&gt;</kbd> string—for example, 1.2.2:</li>
</ul>
<pre style="padding-left: 60px">…….<br/>…….<br/>def flutterVersionCode = localProperties.getProperty('flutter.versionCode')<br/>if (flutterVersionCode == null)<br/>{ flutterVersionCode = '1' }<br/> def flutterVersionName = localProperties.getProperty('flutter.versionName')<br/>if (flutterVersionName == null)<br/>{ flutterVersionName = '1.0' }<br/>……<br/>……</pre>
<ul>
<li><kbd>applicationId</kbd>: This is to enable developers to specify the final, unique application ID.</li>
<li><kbd>minSdkVersion</kbd> and <kbd>targetSdkVersion</kbd>: These two values specify the minimum API level and the target API level on which the app is designed to run on:</li>
</ul>
<pre style="padding-left: 60px">defaultConfig<br/>{ // TODO: Specify your own unique Application ID (https://developer.android.com/studio/build/application-id.html).<br/>applicationId "deviceinformation.flutterappbattery"<br/>minSdkVersion 16<br/>targetSdkVersion 27<br/>versionCode flutterVersionCode.toInteger()<br/>versionName flutterVersionName<br/>testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"<br/>}</pre>


            

            
        
    

        

                            
                    <h1 class="header-title">Icons within apps</h1>
                
            
            
                
<p>A trendy, eye-catching icon can be a great trigger for someone to launch the app. By default, the launcher icon is a default icon. By adhering to the Android Launcher Icon guidelines, you can build your own icon that can be used for the app's launch trigger from the mobile screen:</p>
<ol>
<li>Once your icon files are ready, check the <kbd>&lt;app dir&gt;/android/app/src/main/res/</kbd> directory and place the files in the respective folders using configuration qualifiers. You can read more about this here: <a href="https://developer.android.com/guide/topics/resources/providing-resources#AlternativeResources">https://developer.android.com/guide/topics/resources/providing-resources#AlternativeResources</a>.<a href="https://developer.android.com/guide/topics/resources/providing-resources#AlternativeResources"/></li>
<li>Once you have placed the files in the folders, simply head to <kbd>AndroidManifest.xml</kbd> and update the application tag's <kbd>android:icon</kbd> attribute.</li>
<li>To ensure the icon has been replaced, <kbd>Flutter run</kbd> and inspect the app icon in the launcher.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">Signing the app</h1>
                
            
            
                
<p>This is one of the key steps before publishing the app on the Google Play store. To publish the app, signing the app using a digital signature is a key part. Follow these steps to sign the app:</p>
<ol>
<li><strong>Create a keystore</strong>: If you already have a <kbd>keystore</kbd>, skip to step 2. If you wish to build the new <kbd>keystore</kbd>, use the <kbd>KeyTool</kbd> tool to generate one using this command-line code:</li>
</ol>
<pre style="padding-left: 60px"><strong>keytool -genkey -v -keystore ~/appkey.jks -keyalg RSA -keysize 2048 -validity 10000 -alias appkey</strong></pre>
<p style="padding-left: 60px"><kbd>KeyTool</kbd> is part of the Java JDK, which is installed as part of Android Studio. Ensure you give an absolute path before running the command line. Also note that the file generated has to be kept private.</p>
<ol start="2">
<li><strong>Reference keystore from the app</strong>: Next, create a file named<br/>
<kbd>&lt;app dir&gt;/android/key.properties</kbd> that contains a reference to your keystore. Keep this file private. Take a look at this code:</li>
</ol>
<pre style="padding-left: 60px">storePassword=&lt;password used in the previous step&gt;<br/>keyPassword=&lt;password used in the previous step&gt;<br/>keyAlias=appkey<br/>storeFile=&lt;location of the key store file, e.g. /Users/&lt;user name&gt;/appkey.jks&gt;</pre>
<ol start="3">
<li><strong>Configure signing in Gradle</strong>: Head to the <kbd>&lt;app dir&gt;/android/app/build.gradle</kbd> file and replace <kbd><strong>android {</strong></kbd> with the following code:</li>
</ol>
<pre style="padding-left: 60px">def keystoreProperties = new Properties()<br/>def keystorePropertiesFile = rootProject.file('key.properties')<br/>if (keystorePropertiesFile.exists()) {<br/>    keystoreProperties.load(new FileInputStream(keystorePropertiesFile))<br/>}<br/>android {</pre>
<ol start="4">
<li>Next, remove the following code:</li>
</ol>
<pre style="padding-left: 60px">buildTypes {<br/>    release {<br/>        // TODO: Add your own signing config for the release build.<br/>        // Signing with the debug keys for now, so `flutter run --     <br/>        //release` works.<br/>        signingConfig signingConfigs.debug<br/>    }<br/>}</pre>
<p style="padding-left: 60px">Replace it with this code:</p>
<pre style="padding-left: 60px">signingConfigs {<br/>    release {<br/>        keyAlias keystoreProperties['keyAlias']<br/>        keyPassword keystoreProperties['keyPassword']<br/>        storeFile file(keystoreProperties['storeFile'])<br/>        storePassword keystoreProperties['storePassword']<br/>    }<br/>}<br/>buildTypes {<br/>    release {<br/>        signingConfig signingConfigs.release<br/>    }<br/>}</pre>
<p>Once these steps are performed, your app's release builds will be signed automatically.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Using ProGuard</h1>
                
            
            
                
<p>By default, Flutter build generation does not obfuscate or minify Android Host. You may want to reduce the size of the APK or save the code from reverse engineering. <strong>ProGuard</strong> is one such way to protect your code:</p>
<ol>
<li><strong>Configure ProGuard: </strong>Create a new file called <kbd><strong>/</strong>android/app/proguard-rules.pro</kbd> and add these rules:</li>
</ol>
<pre style="padding-left: 60px">#Flutter Wrapper<br/>-keep class io.flutter.app.** { *; }<br/>-keep class io.flutter.plugin.**  { *; }<br/>-keep class io.flutter.util.**  { *; }<br/>-keep class io.flutter.view.**  { *; }<br/>-keep class io.flutter.**  { *; }<br/>-keep class io.flutter.plugins.**  { *; }</pre>
<p style="padding-left: 60px">Using the preceding code, you can protect only the engine libraries in Flutter. For protecting the others, add the code as per your development needs.</p>
<ol start="2">
<li><strong>Enable obfuscation and/or minification</strong>: Open the <kbd>/android/app/build.gradle</kbd> file and locate the <kbd>buildTypes</kbd> definition:</li>
</ol>
<pre style="padding-left: 60px"> …..<br/> …..<br/>buildTypes {<br/>        release {<br/>            // TODO: Add your own signing config for the release build.<br/>            // Signing with the debug keys for now, so `flutter run --release` works.<br/>            signingConfig signingConfigs.debug<br/>        }<br/>…..<br/>…..</pre>
<p style="padding-left: 60px">Inside, release the configuration set <kbd>minifyEnabled</kbd> and <kbd>useProguard</kbd> flags to true. Note also point ProGuard to the file you have created in step 1. The refreshed code will look like this:</p>
<pre style="padding-left: 60px">…<br/>…<br/>buildTypes {<br/>        release {<br/>            signingConfig signingConfigs.release<br/>            minifyEnabled true<br/>            useProguard true<br/>            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'<br/>        }<br/>…<br/>…</pre>


            

            
        
    

        

                            
                    <h1 class="header-title">Building a release APK</h1>
                
            
            
                
<p>Generating a release is just a two-step process after you have successfully completed the preceding steps. Using the command line, perform the following:</p>
<ol>
<li><kbd>cd &lt;app dir&gt;</kbd> (note to replace <kbd>&lt;app dir&gt;</kbd> with your application's directory path).</li>
<li>Run flutter build apk. This will create a release APK at <kbd>&lt;app dir&gt;/build/app/outputs/apk/release/app-release.apk</kbd>.</li>
</ol>
<p>This build can be published on the Google Play store. Ensure you read the publishing guidelines before the app is uploaded.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Deploying on iOS</h1>
                
            
            
                
<p>As in the case of the Google Play store, Apple follows its own app publishing guidelines as well. Please be sure to read all the information regarding the same, before building the app. Here is the link you can check to read more details about Apple app publishing: <a href="https://developer.apple.com/app-store/review/">https://developer.apple.com/app-store/review/</a>. Once the app is submitted, as in the case of Google as well, Apple will check the app to adhere to its publishing guidelines. Note that Flutter supports iOS 8.0 and later. This is important to know when we set the Xcode for build generation.</p>
<p>As in the case of Google, we use the <strong>Google Play Developer</strong> console. In the case of Apple, we will use <strong>App Store Connect</strong>, which was previously known as iTunes. This console is used to manage your app's life cycle. This console will help you set the app's name, descriptions, and app screenshots, which will be published along with the app, pricing, and manage releases.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Registering Bundle ID</h1>
                
            
            
                
<p>Every app that is published on the Apple store has a unique Bundle ID that is identified with Apple. To register a new Bundle ID for your app, follow these steps:</p>
<ol>
<li>Open the App IDs page of your Apple developer account.</li>
<li>Click on the + icon to create a new Bundle ID.</li>
<li>Type an app name and select Explicit App ID, and enter an ID.</li>
<li>Select the services your app is going to use and then click Continue.</li>
<li>The next step confirms the details. Now, click Register to register your Bundle ID.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">Generating an application record on App Store connect</h1>
                
            
            
                
<p>To register an app on the App Store connect, please follow these steps:</p>
<ol>
<li>Open Apple App Store connect in your browser and click <strong>My Apps</strong>.</li>
<li>Click on the + icon at the top-left corner of the My Apps page | New App.</li>
</ol>
<ol start="3">
<li>Within the pop-up screen, fill out your app's details. In the Platforms section, ensure that iOS is checked. At this point, it is worth mentioning that Flutter does not, as yet, support tvOS. So, leave that checkbox unchecked. The name of the app can't be longer than 30 characters. In the SKU section, add a unique ID for your app that is not visible in the App Store:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-169 image-border" src="img/6dafc872-0735-46f9-9165-ddcd4bac208a.png" style="width:30.50em;height:32.75em;"/></p>
<ol start="4">
<li>Check Create.</li>
<li>Navigate to the application details for your app that was created using the previous steps, and select App Information from the sidebar.</li>
<li>Select the Bundle ID in the General Information section.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">Verifying the Xcode settings</h1>
                
            
            
                
<p>Verifying build-publishing settings in Xcode is rather simple compared to that in Android Studio. Firstly, navigate to the target's settings in Xcode and do the following:</p>
<ol>
<li>Open <kbd>Runner.xcworkspace</kbd> in your app's ios folder, in Xcode.</li>
<li>Select the Runner project from the Xcode project navigator, which shows up the app's settings. Select the Runner target from the main view's sidebar.</li>
<li>Select the General tab.</li>
</ol>
<p>The displayed information will need your attention to cross-check the important settings; so in the Identity section, look at the following details:</p>
<ul>
<li>Display Name: This is the name of the app that will be displayed in the App Store and anywhere else where the name is used</li>
<li>Bundle Identifier: This is the app ID you registered on App Store Connect, as discussed in the previous steps</li>
</ul>
<p>In the <em>Signing the app</em> section, please take a look at the following details:</p>
<ul>
<li>Automatically manage signing: Defines whether Xcode should automatically manage app signing and provisioning. By default, it is set to <kbd>True</kbd>.</li>
<li>The Team: Select the team associated with your registered Apple Developer account. If you wish to add some more members, click on Add Account, followed by updating the settings.</li>
</ul>
<p>Finally in the Deployment section, check the Deployment Target: that holds the value for the minimum iOS version your app will support.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Choosing the app icon</h1>
                
            
            
                
<p>As in the case of Android Studio, even in the case of iOS, a placeholder icon is created. If you wish to have your own icon, please read the iOS app icon guidelines before proceeding with the following steps:</p>
<ol>
<li>Select <kbd>Assets.xcassets</kbd> in the <kbd>Runner</kbd> folder; this will be present in the Xcode project navigator</li>
<li>If your icons are ready, update the placeholder icons with your own app icons that have been generated</li>
<li>To check whether the icon is updated, run your app by using Flutter Run</li>
</ol>
<p class="mce-root"/>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating the build archive</h1>
                
            
            
                
<p>This is the final step for creating the build archive and then uploading it to the Apple Store. On the command line, follow these steps in your application directory:</p>
<ol>
<li>Run flutter build iOS to create a release build.</li>
<li>Perform this only if your Xcode is below version 8.3. To ensure that Xcode refreshes the release mode configuration, restart your Xcode workspace.</li>
</ol>
<p>In Xcode, please use these steps to configure the app version and build:</p>
<ol>
<li>In Xcode, open <kbd>Runner.xcworkspace</kbd> in your app's <kbd>ios</kbd> folder.</li>
<li>Select Product | Scheme | Runner.</li>
<li>Select Product | Destination | Generic iOS Device.</li>
<li>Select Runner in the Xcode project navigator followed by Runner target in the settings view sidebar.</li>
<li>In the Identity section, update the version and also update the Build identifier to a unique build number. This is used to track the number of the build uploaded. Each build should have a unique build number.</li>
</ol>
<p>The final step is to create the build archive and upload it to App Store Connect:</p>
<ol>
<li>Select the product and then Achieve to product a build archive</li>
<li>In the Xcode organizer window in the sidebar | select the iOS app | select the build archive that you just produced</li>
<li>Click the Validate button</li>
<li>After the archive is validated, you can click the Upload to App store option</li>
</ol>
<p>If there are any errors, reproduce the build and try to repeat the process again.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Summary</h1>
                
            
            
                
<p>Once you have worked on your awesome app, deployment and publishing are key aspects. We covered how to publish the android and iOS app on Play Store. It is important to know that app upload just lists the app. You should also look at the App Store as key techniques to have a better visibility for the apps.</p>


            

            
        
    </body></html>