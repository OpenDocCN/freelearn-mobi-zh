- en: '20'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '20'
- en: Getting Started with the Camera and Photo Library
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 开始使用相机和相册
- en: In the previous chapter, you created the `RatingView` class and added it to
    the Add New Journal Entry and Journal Entry Detail screens.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，你创建了`RatingView`类并将其添加到了“添加新日记条目”和“日记条目详情”屏幕中。
- en: In this chapter, you will complete the implementation of the Add New Journal
    Entry screen by adding a way for the user to get a photo from the **camera** or
    **photo library**, which they can then add to a new journal entry. You’ll start
    by adding a **tap gesture recognizer** to the image view in the **New Entry Scene**,
    and configure it to display an **image picker controller** instance. Then, you
    will implement methods from the `UIImagePickerControllerDelegate` protocol, which
    allows you to get a photo from the camera or photo library and make the photo
    smaller before it is saved to the journal entry instance. You’ll also modify the
    `Info.plist` file to allow you to access the camera or photo library.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你将通过添加用户从**相机**或**相册**获取照片的方式，来完成“添加新日记条目”屏幕的实现。你将首先在“新条目场景”中的图像视图上添加一个**轻触手势识别器**，并将其配置为显示一个**图像选择器控制器**实例。然后，你将实现`UIImagePickerControllerDelegate`协议中的方法，这允许你从相机或相册获取照片，并在将其保存到日记条目实例之前将其缩小。你还将修改`Info.plist`文件，以便你可以访问相机或相册。
- en: By the end of this chapter, you’ll have learned how to access the camera or
    photo library in your own apps.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，你将学会如何在你的应用中访问相机或相册。
- en: 'The following topics will be covered in this chapter:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Creating a new `UIImagePickerController` instance
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个新的`UIImagePickerController`实例
- en: Implementing `UIImagePickerControllerDelegate` methods
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实现`UIImagePickerControllerDelegate`方法
- en: Getting permission to use the camera or photo library
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获取使用相机或相册的权限
- en: Technical requirements
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: You will continue working on the `JRNL` project that you modified in the previous
    chapter.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 你将继续在上一章中修改的`JRNL`项目中工作。
- en: 'The resource files and completed Xcode project for this chapter are in the
    `Chapter20` folder of the code bundle for this book, which can be downloaded here:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的资源文件和完成的Xcode项目位于本书代码包的`Chapter20`文件夹中，可以在此处下载：
- en: '[https://github.com/PacktPublishing/iOS-18-Programming-for-Beginners-Ninth-Edition](https://github.com/PacktPublishing/iOS-18-Programming-for-Beginners-Ninth-Edition%0D)'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://github.com/PacktPublishing/iOS-18-Programming-for-Beginners-Ninth-Edition](https://github.com/PacktPublishing/iOS-18-Programming-for-Beginners-Ninth-Edition%0D)'
- en: 'Check out the following video to see the code in action:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 观看以下视频，以查看代码的实际效果：
- en: '[https://youtu.be/MvOOKyBcVak](https://youtu.be/MvOOKyBcVak%0D)'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://youtu.be/MvOOKyBcVak](https://youtu.be/MvOOKyBcVak%0D)'
- en: Let’s start by modifying the Add New Journal Entry screen to display an image
    picker controller, which allows you to use the device camera or select a photo
    from the user’s photo library.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们先修改“添加新日记条目”屏幕，以显示一个图像选择器控制器，这允许你使用设备相机或从用户的相册中选择照片。
- en: Creating a new UIImagePickerController instance
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建一个新的UIImagePickerController实例
- en: To make it easy for a user to use the camera or photo library, Apple implemented
    the `UIImagePickerController` class. This class manages the system interfaces
    for taking photos and choosing items from the user’s photo library. An instance
    of this class is called an image picker controller, and it can display an image
    picker on the screen.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 为了让用户更容易使用相机或相册，Apple实现了`UIImagePickerController`类。这个类管理了系统接口，用于拍照和从用户的相册中选择项目。这个类的实例被称为图像选择器控制器，它可以在屏幕上显示图像选择器。
- en: 'If you have ever added a photo to a social media post, you will have seen what
    the image picker looks like. It typically displays either the view from your camera
    or a grid of photos from your photo library, and you can then choose a photo to
    be added to your post:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你曾经向社交媒体帖子中添加过照片，你将看到图像选择器的样子。它通常显示来自你的相机的视图或来自你的相册的照片网格，然后你可以选择一张照片添加到你的帖子中：
- en: '![](img/B31371_20_01.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![img/B31371_20_01.png](img/B31371_20_01.png)'
- en: 'Figure 20.1: Simulator showing the image picker'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 图20.1：模拟器显示图像选择器
- en: To learn more about the `UIImagePickerController` class, see [https://developer.apple.com/documentation/uikit/uiimagepickercontroller](https://developer.apple.com/documentation/uikit/uiimagepickercontroller).
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于`UIImagePickerController`类的信息，请参阅[https://developer.apple.com/documentation/uikit/uiimagepickercontroller](https://developer.apple.com/documentation/uikit/uiimagepickercontroller)。
- en: 'To display the image picker on the Add New Journal Entry screen, you’ll add
    a tap gesture recognizer instance to the image view in the **New Entry Scene**,
    and you’ll add a method to create and display an image picker controller when
    the image view is tapped. Follow these steps:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 在“添加新日志条目”屏幕上显示图片选择器，你需要在“新条目场景”中的图片视图上添加一个轻点手势识别器实例，并且当图片视图被轻点时，你需要添加一个创建并显示图片选择器控制器的方法。按照以下步骤操作：
- en: In the Project navigator, click the **Main** storyboard file. Click **New Entry
    Scene** in the document outline.
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你应该在助理编辑器中看到`AddJournalEntryViewController`文件的全部内容。*Ctrl* + *拖动*文档大纲中的**轻点手势识别器**到`locationSwitchValueChanged(_:)`方法和闭合花括号之间的空间：
- en: 'Click the image view in the **New Entry** **Scene**. Click the Attributes inspector
    button and, under **View**, tick the **User Interaction Enabled** checkbox:'
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '![图片](img/B31371_20_05.png)'
- en: '![](img/B31371_20_02.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: 这条语句将图片选择器控制器的`delegate`属性设置为`AddJournalEntryViewController`实例。
- en: 'Figure 20.2: Attributes inspector showing the User Interaction Enabled checkbox'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '![图片](img/B31371_20_02.png)'
- en: 'Click the Library button to display the library. Type `tap` in the filter field.
    A **Tap Gesture Recognizer** object will appear as one of the results. Drag it
    to the image view:'
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果需要更多工作空间，请点击导航器和检查器按钮。点击调整编辑器选项按钮，并从弹出菜单中选择**助理**：
- en: '![](img/B31371_20_03.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: 图20.4：调整编辑器选项菜单，选择助理
- en: 'Figure 20.3: Library with Tap Gesture Recognizer object selected'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '![图片](img/B31371_20_02.png)'
- en: 'Click the Navigator and Inspector buttons if you need more room to work. Click
    the Adjust Editor Options button and choose **Assistant** from the pop-up menu:'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在项目导航器中，点击**主**故事板文件。在文档大纲中点击**新条目场景**。
- en: '![](img/B31371_20_04.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/B31371_20_04.png)'
- en: 'Figure 20.4: Adjust Editor Options menu with Assistant selected'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '![图片](img/B31371_20_03.png)'
- en: 'You should see the contents of the `AddJournalEntryViewController` file in
    the assistant editor. *Ctrl* + *Drag* from the **Tap Gesture Recognizer** in the
    document outline to the space between the `locationSwitchValueChanged(_:)` method
    and the closing curly brace:'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这条语句创建了一个`UIImagePickerController`类的实例，并将其分配给`imagePickerController`。
- en: '![](img/B31371_20_05.png)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: 点击**新条目**场景中的图片视图。点击属性检查器按钮，在**视图**下勾选**用户交互启用**复选框：
- en: 'Figure 20.5: Editor area showing drag destination'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们分解这个过程：
- en: 'In the pop-up dialog box, set **Name** to `getPhoto` and set **Type** to `UITapGestureRecognizer`.
    Click **Connect**:'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在弹出对话框中，将**名称**设置为`getPhoto`，将**类型**设置为`UITapGestureRecognizer`。点击**连接**：
- en: '![](img/B31371_20_06.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/B31371_20_05.png)'
- en: 'Figure 20.6: Pop-up dialog box for action creation'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 你已成功将轻点手势识别器添加到**新条目**场景中的图片视图，并将其链接到`AddJournalEntryViewController`类中的`getPhoto()`方法。现在你将修改`getPhoto()`方法以创建并显示一个`UIImagePickerController`实例。
- en: 'Verify that the `getPhoto(_:)` method has been created in the `AddJournalEntryViewController`
    class. Click the **x** to close the assistant editor window:'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 图20.3：选择轻点手势识别器对象的库
- en: '![](img/B31371_20_07.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: 在项目导航器中，点击`AddJournalEntryViewController`文件。在文件中所有其他代码之后添加一个新扩展，使`AddJournalEntryViewController`类声明符合`UIImagePickerControllerDelegate`和`UINavigationControllerDelegate`协议：
- en: 'Figure 20.7: Assistant editor showing getPhoto(_:) method'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 图20.7：助理编辑器显示getPhoto(_:)方法
- en: You have successfully added a tap gesture recognizer to the image view in the
    **New Entry** **Scene** and linked it to a `getPhoto()` method in the `AddJournalEntryViewController`
    class. Now you’ll modify the `getPhoto()` method to create and display a `UIImagePickerController`
    instance.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '![图片](img/B31371_20_06.png)'
- en: 'Follow these steps:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 图20.2：属性检查器显示用户交互启用复选框
- en: 'In the Project navigator, click the **AddJournalEntryViewController** file.
    Add a new extension after all other code in the file to make the `AddJournalEntryViewController`
    class declaration conform to the `UIImagePickerControllerDelegate` and `UINavigationControllerDelegate`
    protocols:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照以下步骤操作：
- en: '[PRE0]'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Modify the `getPhoto()` method as shown:'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照以下方式修改`getPhoto()`方法：
- en: '[PRE1]'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Let’s break this down:'
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 点击库按钮以显示库。在过滤器字段中输入`tap`。一个**轻点手势识别器**对象将作为结果之一出现。将其拖到图片视图：
- en: '[PRE2]'
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This statement creates an instance of the `UIImagePickerController` class and
    assigns it to `imagePickerController`.
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 验证`getPhoto(_:)`方法是否已在`AddJournalEntryViewController`类中创建。点击**x**关闭助理编辑器窗口：
- en: '[PRE3]'
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: This statement sets the image picker controller’s `delegate` property to the
    `AddJournalEntryViewController` instance.
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图片](img/B31371_20_07.png)'
- en: '[PRE4]'
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: This block of code is known as a conditional compilation block. It starts with
    an `#if` compilation directive and ends with an `#endif` compilation directive.
    If you’re running in Simulator, only the statement setting the image picker controller’s
    `sourceType` property to the photo library is compiled.
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这段代码块被称为条件编译块。它从`#if`编译指令开始，以`#endif`编译指令结束。如果你在模拟器中运行，只有设置图像选择控制器`sourceType`属性为相册库的语句会被编译。
- en: If you’re running on an actual device, the statements setting the image picker
    controller’s `sourceType` property to the camera and displaying the camera controls
    are compiled. This means that the image picker controller will use the photo library
    when running in Simulator and will use the camera when running on an actual device.
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你在一个实际设备上运行，设置图像选择控制器`sourceType`属性为相机并显示相机控制的语句会被编译。这意味着当在模拟器中运行时，图像选择控制器将使用相册库；当在实际设备上运行时，将使用相机。
- en: 'You can learn more about conditional compilation blocks at this link: https://docs.swift.org/swift-book/documentation/the-swift-programming-language/statements/#Conditional-Compilation-Block.'
  id: totrans-56
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你可以在此链接中了解更多关于条件编译块的信息：https://docs.swift.org/swift-book/documentation/the-swift-programming-language/statements/#Conditional-Compilation-Block。
- en: '[PRE5]'
  id: totrans-57
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: This statement presents the image picker controller on the screen.
  id: totrans-58
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这条语句在屏幕上显示图像选择控制器。
- en: You’ve implemented all the code required to present the image picker controller
    when the image view is tapped. In the next section, you’ll implement the `UIImagePickerControllerDelegate`
    methods that will be called when the user chooses an image or cancels.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经实现了在图像视图被点击时显示图像选择控制器的所有必需代码。在下一节中，你将实现当用户选择图像或取消时会被调用的`UIImagePickerControllerDelegate`方法。
- en: Implementing UIImagePickerControllerDelegate methods
  id: totrans-60
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实现UIImagePickerControllerDelegate方法
- en: The `UIImagePickerControllerDelegate` protocol has a set of methods that you
    must implement in your delegate object to interact with the image picker controller
    interface.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '`UIImagePickerControllerDelegate`协议有一组方法，你必须在你委托对象中实现这些方法以与图像选择控制器界面交互。'
- en: To learn more about the `UIImagePickerControllerDelegate` protocol, see [https://developer.apple.com/documentation/uikit/uiimagepickercontrollerdelegate](https://developer.apple.com/documentation/uikit/uiimagepickercontrollerdelegate).
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于`UIImagePickerControllerDelegate`协议的信息，请参阅[https://developer.apple.com/documentation/uikit/uiimagepickercontrollerdelegate](https://developer.apple.com/documentation/uikit/uiimagepickercontrollerdelegate)。
- en: When the image picker controller appears on screen, the user has the option
    of selecting a photo or canceling. If the user cancels, the `imagePickerControllerDidCancel(_:)`
    method is triggered, and if the user selects a photo, the `imagePickerController(_:didFinishPickingMediaWithInfo:)`
    method is triggered.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 当图像选择控制器出现在屏幕上时，用户可以选择选择照片或取消。如果用户取消，将触发`imagePickerControllerDidCancel(_:)`方法；如果用户选择照片，将触发`imagePickerController(_:didFinishPickingMediaWithInfo:)`方法。
- en: 'You’ll implement these methods in your `AddJournalEntryViewController` class
    now. In the Project navigator, click the **AddJournalEntryViewController** file.
    Type the following code in the `UIImagePickerControllerDelegate` extension:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你将在`AddJournalEntryViewController`类中实现这些方法。在项目导航器中，点击**AddJournalEntryViewController**文件。在`UIImagePickerControllerDelegate`扩展中输入以下代码：
- en: '[PRE6]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: The `imagePickerControllerDidCancel(_:)` method is triggered when the user cancels.
    The image picker controller is dismissed and the user is returned to the Add New
    Journal Entry screen.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户取消时，将触发`imagePickerControllerDidCancel(_:)`方法。图像选择控制器将被关闭，用户将返回到添加新日志条目屏幕。
- en: The `imagePickerController(_:didFinishPickingMediaWithInfo:)` method is triggered
    when the user selects a photo. This photo is then assigned to `selectedImage`.
    Next, the `selectedImage` instance’s `preparingThumbnail(of:)` method will be
    used to create a smaller image with a width and height of 300 points, the same
    as the size of the image view on the Journal Entry Detail screen. This image will
    then be assigned to the `photoImageView` property and the image picker controller
    will be dismissed
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户选择照片时，将触发`imagePickerController(_:didFinishPickingMediaWithInfo:)`方法。然后，这张照片将被分配给`selectedImage`。接下来，将使用`selectedImage`实例的`preparingThumbnail(of:)`方法创建一个宽度为300点、高度为300点的较小图像，其大小与日志条目详情屏幕上的图像视图大小相同。然后，这个图像将被分配给`photoImageView`属性，图像选择控制器将被关闭。
- en: 'You can learn more about the `preparingThumbnail(of:)` method at this link:
    [https://developer.apple.com/documentation/uikit/uiimage/3750835-preparingthumbnail](https://developer.apple.com/documentation/uikit/uiimage/3750835-preparingthumbnail).'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在此链接中了解更多关于`preparingThumbnail(of:)`方法的信息：[https://developer.apple.com/documentation/uikit/uiimage/3750835-preparingthumbnail](https://developer.apple.com/documentation/uikit/uiimage/3750835-preparingthumbnail)。
- en: All the required `UIImagePickerController` delegate methods have been implemented.
    In the next section, you’ll modify the `Info.plist` file so that your app will
    ask for permission to use the camera or photo library.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 所有必需的`UIImagePickerController`代理方法都已实现。在下一节中，您将修改`Info.plist`文件，以便您的应用请求使用相机或照片库的权限。
- en: Getting permission to use the camera or photo library
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 获取使用相机或照片库的权限
- en: Apple stipulates that your app must inform the user if it wishes to access the
    camera or photo library. If you don’t do this, your app will be rejected and will
    not be allowed on the App Store.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 苹果规定，如果您的应用希望访问相机或照片库，必须通知用户。如果您不这样做，您的应用将被拒绝，并且不允许在App Store上发布。
- en: 'You’ll modify the `Info.plist` file in your project to make your app display
    messages when it tries to access the camera or photo library. Follow these steps:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 您将修改项目中的`Info.plist`文件，以便在应用尝试访问相机或照片库时显示消息。请按照以下步骤操作：
- en: Click the **Info** file in the Project navigator. Move your pointer over the
    **Information Property List** row and click the **+** button to create a new row.
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在项目导航器中点击**Info**文件。将指针移至**信息属性列表**行，并点击**+**按钮以创建新行。
- en: In the new row, set the **Key** to **Privacy – Photo Library Usage Description**
    and set the **Value** to `This app uses photos in your photo library when creating
    journal entries`.
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在新行中，将**键**设置为**隐私 - 照片库使用描述**，并将**值**设置为`此应用在创建日志条目时使用您的照片库中的照片`。
- en: 'Add a second row using the **+** button. This time, set the **Key** to **Privacy
    – Camera Usage Description** and set the **Value** to `This app uses your camera
    when creating journal entries`. Your `Info.plist` file should look like the following
    when done:'
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用**+**按钮添加第二行。这次，将**键**设置为**隐私 - 相机使用描述**，并将**值**设置为`此应用在创建日志条目时使用您的相机`。完成操作后，您的`Info.plist`文件应如下所示：
- en: '![](img/B31371_20_08.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/B31371_20_08.png)'
- en: 'Figure 20.8: Info.plist with additional keys added'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 图20.8：添加额外键的Info.plist
- en: 'Build and run your app. Go to the Add New Journal Entry screen and tap the
    image view. The image picker will appear:'
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建并运行您的应用。转到添加新日志条目屏幕，并点击图像视图。将出现图像选择器：
- en: '![](img/B31371_20_09.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/B31371_20_09.png)'
- en: 'Figure 20.9: Simulator showing image picker'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 图20.9：模拟器显示图像选择器
- en: If you run the app on an actual iOS device, a dialog box will appear asking
    for permission to use the camera. Click **OK** to continue.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您在实际的iOS设备上运行应用，将出现一个对话框请求使用相机的权限。点击**确定**以继续。
- en: 'Select a photo and it will appear in the image view on the Add New Journal
    Entry screen. Enter sample details for the journal entry and click **Save**:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择一张照片，它将出现在添加新日志条目屏幕上的图像视图中。为日志条目输入示例详细信息，然后点击**保存**：
- en: '![](img/B31371_20_10.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/B31371_20_10.png)'
- en: 'Figure 20.10: Simulator showing photo on Add New Journal Entry screen'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 图20.10：模拟器显示在添加新日志条目屏幕上的照片
- en: 'You will be returned to the Journal List screen. Tap the newly added journal
    entry. You will see the photo is displayed on the Journal Entry Detail screen:'
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您将返回到日志列表屏幕。点击新添加的日志条目。您将在日志条目详情屏幕上看到照片：
- en: '![](img/B31371_20_11.png)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/B31371_20_11.png)'
- en: 'Figure 20.11: Simulator showing photo on the Journal Entry Detail screen'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 图20.11：模拟器显示在日志条目详情屏幕上的照片
- en: You can now add photos to a new journal entry on the Add New Journal Entry screen
    and display them on the Journal Entry Detail screen. Fantastic!
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 您现在可以在添加新日志条目屏幕上添加照片，并在日志条目详情屏幕上显示它们。太棒了！
- en: Summary
  id: totrans-89
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, you completed the implementation of the Add New Journal Entry
    screen by adding a way for the user to get a photo from the camera or photo library,
    which then can be added to a new journal entry. First, you added a tap gesture
    recognizer to the image view in the New Entry scene and configured it to display
    an image picker controller. Then, you implemented the `UIImagePickerDelegate`
    protocol, which allows you to get a photo from the camera or the photo library,
    and made the photo smaller before it is saved to the journal entry instance. You
    also modified the `Info.plist` file to allow you to access the camera and photo
    library.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你通过添加用户从相机或相册获取照片的方法，完成了添加新日记条目屏幕的实现。首先，你向新条目场景中的图像视图添加了一个轻点手势识别器，并将其配置为显示图像选择器控制器。然后，你实现了`UIImagePickerDelegate`协议，这允许你从相机或相册获取照片，并在将其保存到日记条目实例之前将其照片缩小。你还修改了`Info.plist`文件，以便你可以访问相机和相册。
- en: You are now able to write your own apps that import photos from your camera
    or photo library.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你能够编写自己的应用程序，从你的相机或相册导入照片。
- en: In the next chapter, you’ll implement a way for the user to search through the
    journal entries on the Journal List screen.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，你将实现用户在日记列表屏幕上搜索日记条目的方法。
- en: Join us on Discord!
  id: totrans-93
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 加入我们的Discord社区！
- en: Read this book alongside other users, experts, and the author himself. Ask questions,
    provide solutions to other readers, chat with the author via Ask Me Anything sessions,
    and much more. Scan the QR code or visit the link to join the community.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 与其他用户、专家以及作者本人一起阅读这本书。提出问题，为其他读者提供解决方案，通过“问我任何问题”的环节与作者聊天，以及更多。扫描二维码或访问链接加入社区。
- en: '[https://packt.link/ios-Swift](https://packt.link/ios-Swift%0D)'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://packt.link/ios-Swift](https://packt.link/ios-Swift%0D)'
- en: '[![](img/QR_Code2370024260177612484.png)](https://packt.link/ios-Swift%0D)'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '[![](img/QR_Code2370024260177612484.png)](https://packt.link/ios-Swift%0D)'
