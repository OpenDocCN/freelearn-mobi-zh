<html><head></head><body><div class="chapter" title="Chapter&#xA0;7.&#xA0;Advanced Content Creation for Urban Warrior"><div class="titlepage"><div><div><h1 class="title"><a id="ch07"/>Chapter 7. Advanced Content Creation for Urban Warrior</h1></div></div></div><div class="blockquote"><blockquote class="blockquote"><p>With our game level finished from the previous chapter, we now have a level that has been playtested and we know that it is quite fun. Now that we have a great base to build on we can create our own content for our game to customize it and make the game really your own.</p></blockquote></div><p>In this chapter we shall discuss the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Creating a main menu for our game with input</li><li class="listitem" style="list-style-type: disc">Adding audio on mobile UDK for our game</li><li class="listitem" style="list-style-type: disc">Importing custom textures to our game</li><li class="listitem" style="list-style-type: disc">Creating materials for both PC and iOS to use</li><li class="listitem" style="list-style-type: disc">Adding static meshes on mobile UDK for our game</li><li class="listitem" style="list-style-type: disc">Some tips for optimization and debugging on the iOS</li></ul></div><p>The assets that I will be bringing into the game in this level will be available on the Packt Publishing website, but with the information contained in this chapter it should be fairly easy to create assets of your own that you can bring into the game. With that being said, let's begin!</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;" title="Note"><h3 class="title"><a id="tip06"/>Tip</h3><p>
<span class="strong"><strong>Downloading the example code</strong></span>
</p><p>You can download the example code files for all Packt books you have purchased from your account at <a class="ulink" href="http://www.packtpub.com">http://www.packtpub.com</a>. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p></div><div class="section" title="Main menu environment creation"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec01"/>Main menu environment creation</h1></div></div></div><p>As nice as dropping right in the action of a game is, most games have a menu of some sort. This will also be a nice way of showing you how we can use aspects that we have already covered before doing something different.<a class="indexterm" id="id384"/>
</p></div></div>
<div class="section" title="Time for action&#x2014;building main menu backdrop"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec02"/>Time for action—building main menu backdrop</h1></div></div></div><p>Sure, most menus in a game look like they're something special, but in reality they are just a new level. To build the main menu backdrop perform the following steps:<a class="indexterm" id="id385"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">First, let's open up the map that we previously used in <a class="link" href="ch03.html" title="Chapter 3. Taking It to the Next Level: Enriching with Content">Chapter 3</a>,<span class="emphasis"><em> Taking It to the Next Level; Enriching with Content</em></span>. Select the skydome and the two directional lights we created and copy them by pressing<span class="emphasis"><em> Ctrl+C</em></span>, this is shown in the following screenshot:<div class="mediaobject"><img alt="Time for action—building main menu backdrop" height="162" src="graphics/1901_07_01.jpg"/></div></li><li class="listitem">Create a new level by selecting<span class="strong"><strong> File</strong></span> |<span class="strong"><strong> New..</strong></span>. and select the<span class="strong"><strong> Blank Map</strong></span> template. Paste the objects into your level.</li><li class="listitem">Right-click on the<span class="strong"><strong> Cube</strong></span> icon on the left-hand side toolbar directly underneath the<span class="strong"><strong> Brushes</strong></span> text. In the settings for the builder brush check the<span class="strong"><strong> Hollow</strong></span> option. This will create a hollow cube. Click on the<span class="strong"><strong> Build</strong></span> button and then add the geometry to our level by clicking on the<span class="strong"><strong> CSG_Add</strong></span> option that we used in <a class="link" href="ch02.html" title="Chapter 2. Beginning Urban Warrior, a Third-person Shooter">Chapter 2</a>,<span class="emphasis"><em> Beginning Urban Warrior; A First Person Shooter</em></span> or by using<span class="emphasis"><em> Ctrl+A</em></span>.<a class="indexterm" id="id386"/></li><li class="listitem">Move the camera inside of the box and create a<span class="strong"><strong> Player Start</strong></span> actor by right-clicking and selecting<span class="strong"><strong> New Actor</strong></span> |<span class="strong"><strong> New Player Start</strong></span>. If the object has a red<span class="strong"><strong> X</strong></span> on it move the object until it has plenty of space on all sides in order to spawn the player there:<a class="indexterm" id="id387"/><div class="mediaobject"><img alt="Time for action—building main menu backdrop" src="graphics/1901_07_02.jpg" width="172"/></div></li><li class="listitem">Access the<span class="strong"><strong> WorldInfo Properties</strong></span> by going to the top menu and selecting<span class="strong"><strong> View</strong></span> |<span class="strong"><strong> World Properties</strong></span>. In the<span class="strong"><strong> Game Type</strong></span> section set the<span class="strong"><strong> Default Game Type</strong></span> and<span class="strong"><strong> Game Type</strong></span> for PIE to<span class="strong"><strong> MobileMenuGame</strong></span>.<a class="indexterm" id="id388"/></li><li class="listitem">By either copying and pasting from the actual game level or finding<code class="literal"> StaticMesh'LT_Mech.SM.Mesh.S_LT_Mech_SM_CityNoRing01</code> inside the Content Borwser, place two of the objects into your game world in such a way that they have buildings in all angles.<div class="mediaobject"><img alt="Time for action—building main menu backdrop" height="243" src="graphics/1901_07_03.jpg"/></div></li><li class="listitem">Go to the<span class="strong"><strong> Actor Classes</strong></span> tab by selecting<span class="strong"><strong> View</strong></span> |<span class="strong"><strong> Browser Windows</strong></span> |<span class="strong"><strong> Actor Classes</strong></span>. Select the<span class="strong"><strong> CameraActor</strong></span> found in<span class="strong"><strong> Common</strong></span> |<span class="strong"><strong> CameraActor</strong></span> and exit the building. Create a camera by right-clicking and selecting<span class="strong"><strong> Add Camera Actor Here</strong></span>. Position the camera in the middle of your area, tilted slightly to the sky. In particular you want to make sure that you cannot see the hollow box we created earlier. If it's easier for you to move it out of the way, feel free to do that.<a class="indexterm" id="id389"/><div class="mediaobject"><img alt="Time for action—building main menu backdrop" height="184" src="graphics/1901_07_04.jpg"/></div></li><li class="listitem">Press<span class="emphasis"><em> F4</em></span> in order to access the Camera Actor's properties. In the<span class="strong"><strong> Movement</strong></span> section change the<span class="strong"><strong> Physics</strong></span> property to<span class="strong"><strong> PHYS_Rotating</strong></span>. Select the<span class="strong"><strong> Yaw</strong></span> section of the<span class="strong"><strong> Rotation Rate</strong></span> and set it to<code class="literal"> 20</code>. This special type of physics will move the actor along the rotation rate but will not be able to do anything else. This would be great for our main menu as we just want a nice background effect to show up. This is how the Camera Actor's property window will look:<a class="indexterm" id="id390"/><div class="mediaobject"><img alt="Time for action—building main menu backdrop" height="156" src="graphics/1901_07_05.jpg"/></div></li><li class="listitem">With our level created and our<span class="strong"><strong> CameraActor</strong></span> selected let's go into Kismet. Create a<span class="strong"><strong> Level Loaded Event</strong></span> (New<span class="strong"><strong> Event</strong></span> |<span class="strong"><strong> Level Loaded)</strong></span>. To its right-hand side create a new Matinee by right-clicking and selecting<span class="strong"><strong> New Matinee</strong></span>. Connect the<span class="strong"><strong> Loaded</strong></span> and<span class="strong"><strong> Visible</strong></span> output of the<span class="strong"><strong> Level Loaded</strong></span> event to the<span class="strong"><strong> Play</strong></span> action of the<span class="strong"><strong> Matinee</strong></span> and double-click on the<span class="strong"><strong> Matinee</strong></span> to enter the Matinee editor.<a class="indexterm" id="id391"/></li><li class="listitem">Create a camera track with the name<code class="literal"> Turning Camera</code> by right-clicking and selecting<span class="strong"><strong> Add New Camera Group</strong></span>. Then create a new<span class="strong"><strong> Director Group</strong></span> by right-clicking and selecting<span class="strong"><strong> Add New Director Group</strong></span>. Add a<span class="strong"><strong> Keyframe</strong></span> at the beginning of the Matinee sequence and select<span class="strong"><strong> Turning Camera</strong></span> at the<span class="strong"><strong> Cut To Group</strong></span> option that comes up. Close the Matinee editor.</li><li class="listitem">Back in Kismet select the Matinee object and make sure that the<span class="strong"><strong> Looping</strong></span> option is checked. Exit Kismet.</li><li class="listitem">Create a<span class="strong"><strong> Lightmass Importance Volume</strong></span> to cover the area around the player including the buildings. Also make sure that the lights are not inside any of the buildings, move them if you need to.</li><li class="listitem">Build our game by selecting<span class="strong"><strong> Build</strong></span> |<span class="strong"><strong> Build All</strong></span> and clicking on<span class="strong"><strong> Close</strong></span> when finished.</li><li class="listitem">Save your project and start your game by clicking on the<span class="strong"><strong> Start Mobile Previewer</strong></span> button. This is how your screen should look:<div class="mediaobject"><img alt="Time for action—building main menu backdrop" src="graphics/1901_07_06.jpg" width="309"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec01"/>What just happened?</h2></div></div></div><p>We now see a nice cityscape as our camera pans around at a constant rate. This will be a nice looking background for our title screen, and with this as a basis we can build our main menu.<a class="indexterm" id="id392"/>
</p></div></div>
<div class="section" title="Importing textures"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec03"/>Importing textures</h1></div></div></div><p>A mobile graphics hardware works with different formats and handles textures differently than a normal PC graphics hardware. By taking the necessary precautions and creating textures accordingly, many obstacles can be avoided. Now, I'm by no means an art expert but I'll briefly go over some things that you should abide by if you do decide to do your own textures for iOS.<a class="indexterm" id="id393"/>
</p><p>When creating your own textures it is important to make the size of the image in powers of two such as 256, 512, 1024, and 2048. Computers process data in "chunks" for purposes of efficiency. For game content creation, on devices mobile especially, if a texture is not in a power of two Unreal will waste resources both in terms of time and processing power in order fix the problem. In effect the essence of the power of two rule is optimization, being as efficient and as "lite" as possible while providing the user an appropriate visual experience. When working with iOS, hardware textures can have a size of up to 2048 by 2048 but use them sparingly. This is particularly important in the case of games targeting lower end devices (such as iPhone 3GS, iPad 1, and iPod touch 4th generation) that only have 256 MB of RAM.<a class="indexterm" id="id394"/>
</p><p>The following texture formats are supported:<code class="literal"> .bmp, .pcx, .png, .tga, .float</code> and<code class="literal"> .psd</code>.<a class="indexterm" id="id395"/>
</p></div>
<div class="section" title="Time for action&#x2014;finishing the main menu"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec04"/>Time for action—finishing the main menu</h1></div></div></div><p>That being said, let's import our first texture into the game:<a class="indexterm" id="id396"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open up the<span class="strong"><strong> Content Browser</strong></span> by either selecting its icon or going to the<span class="strong"><strong> View</strong></span> menu and selecting<span class="strong"><strong> View</strong></span> |<span class="strong"><strong> Browser Windows</strong></span> |<span class="strong"><strong> Content Browser</strong></span>. Click on the<span class="strong"><strong> Import</strong></span> button in the menu at the bottom of the window. Find the image that you would like to bring into the game and select<span class="strong"><strong> Open</strong></span>:<div class="mediaobject"><img alt="Time for action—finishing the main menu" height="192" src="graphics/1901_07_07.jpg"/></div></li><li class="listitem">There will be an import dialog that will come up. In the<span class="strong"><strong> Packages</strong></span> section type the name<code class="literal"> UW-MainMenuPKG</code> and confirm that<code class="literal"> logo</code> is in the<span class="strong"><strong> Name</strong></span> section. You should be brought back to the<span class="strong"><strong> Content Browser</strong></span> where you will see our new package with one new file:<a class="indexterm" id="id397"/><div class="mediaobject"><img alt="Time for action—finishing the main menu" src="graphics/1901_07_08.jpg" width="303"/></div></li><li class="listitem">Underneath the<span class="strong"><strong> New Packages</strong></span> option in the<span class="strong"><strong> Packages</strong></span> section on the left-hand side toolbar, right-click on the package that we just created and select<span class="strong"><strong> Save</strong></span> to save the package as a file. It is important to save things often to make sure you don't lose your work:<a class="indexterm" id="id398"/><div class="mediaobject"><img alt="Time for action—finishing the main menu" height="219" src="graphics/1901_07_09.jpg"/></div><p>Close the <span class="strong"><strong>Content Browser</strong></span> and go back into Kismet. Create a <span class="strong"><strong>Draw Image event</strong></span> by right-clicking and selecting <span class="strong"><strong>New Event</strong></span> | <span class="strong"><strong>HUD</strong></span> | <span class="strong"><strong>Draw Image</strong></span>. In the properties for it select the <span class="strong"><strong>Display Color</strong></span> as white. In the <span class="strong"><strong>Display Location</strong></span> section set the <span class="strong"><strong>X</strong></span> value to <code class="literal">.25</code>. Set the <span class="strong"><strong>XL</strong></span> and <span class="strong"><strong>YL</strong></span> to <code class="literal">0.5</code> and <span class="strong"><strong>UL</strong></span> and <span class="strong"><strong>VL</strong></span> to <code class="literal">512</code>. It is important to note that this Kismet event doesn't give you the option to do proper scaling for aspect ratio differences so more complex logos may be squished, so play with the values until you find what works for you. Check the <span class="strong"><strong>Is Active</strong></span> checkbox and change the <span class="strong"><strong>Authorized Global Scale</strong></span> to <code class="literal">1.0</code>. Go to the <span class="strong"><strong>Content Browser</strong></span> and left-click on our logo image. In the <span class="strong"><strong>Draw Image</strong></span> properties click on the green arrow next to the <span class="strong"><strong>Display Texture</strong></span> option in order to set our logo image in the world. Place a Player 0 variable underneath the Target by right clicking and selecting <span class="strong"><strong>New Variable</strong></span> | <span class="strong"><strong>Player</strong></span> | <span class="strong"><strong>Player</strong></span>. Inside the <span class="strong"><strong>Player</strong></span> variable uncheck the <span class="strong"><strong>All Players</strong></span> checkbox in its properties. A few of the changes we made are seen in the following screenshot:
<a class="indexterm" id="id399"/>
</p><div class="mediaobject"><img alt="Time for action—finishing the main menu" src="graphics/1901_07_10.jpg" width="295"/></div></li><li class="listitem">Save your project and start your game by clicking on the<span class="strong"><strong> Start Mobile Previewer</strong></span> button. This is how the preview would look:<a class="indexterm" id="id400"/><div class="mediaobject"><img alt="Time for action—finishing the main menu" src="graphics/1901_07_11.jpg" width="265"/></div><p>We now have a title that follows us when we start the game, but as of right now nothing happens and there's no way to start the game properly. What we're going to do next is place some text that says "<span class="strong"><strong>Tap anywhere to begin</strong></span>" in the middle of the screen and then create a button which when tapped will open our main game level. Knowing what we plan on doing, let's do that now!
<a class="indexterm" id="id401"/>
</p></li><li class="listitem">Open up the<span class="strong"><strong> Content Browser</strong></span> by going to the<span class="strong"><strong> View</strong></span> menu and selecting<span class="strong"><strong> View</strong></span> |<span class="strong"><strong> Browser Windows</strong></span> |<span class="strong"><strong> Content Browser</strong></span>. In the<span class="strong"><strong> Object Type</strong></span> section change the tab from<span class="strong"><strong> Favorites</strong></span> to<span class="strong"><strong> All Types</strong></span> and check<span class="strong"><strong> Fonts</strong></span>. In the search bar type<code class="literal"> 36</code> and left-click on the font on the bottom which specifically is<code class="literal"> Font'UI_Fonts.Fonts.UI_Fonts_Positec36'</code>. With it selected, open up Kismet.<div class="mediaobject"><img alt="Time for action—finishing the main menu" src="graphics/1901_07_12.jpg" width="346"/></div></li><li class="listitem">Go back to Kismet and create a<span class="strong"><strong> Show Text</strong></span> event by right-clicking next to the<span class="strong"><strong> Draw Image</strong></span> event and selecting<span class="strong"><strong> New Event</strong></span> |<span class="strong"><strong> HUD</strong></span> |<span class="strong"><strong> Draw Text</strong></span>. In the<span class="strong"><strong> Properties</strong></span> section click on the green arrow next to<span class="strong"><strong> Display Font</strong></span> to set the font we are going to use. Change the<span class="strong"><strong> Display Color</strong></span> to white. On the<span class="strong"><strong> Display Location</strong></span> put<span class="strong"><strong> X</strong></span> as<code class="literal"> .5</code>,<span class="strong"><strong> Y</strong></span> as<code class="literal"> .75</code> to be directly below our image and<span class="strong"><strong> Z</strong></span> to<code class="literal"> 0</code>. In the<span class="strong"><strong> Display Text</strong></span> section type<code class="literal"> Tap anywhere to begin!</code>. Change the<span class="strong"><strong> Text Draw Method</strong></span> to<span class="strong"><strong> DRAW_CenterText</strong></span> and check the<span class="strong"><strong> Is Active</strong></span> checkbox . Change the<span class="strong"><strong> Authorized Global Scale</strong></span> to<code class="literal"> 1.0</code>. Underneath the<span class="strong"><strong> Target</strong></span> place a Player 0 variable by right-clicking and selecting<span class="strong"><strong> New Variable</strong></span> |<span class="strong"><strong> Player</strong></span> |<span class="strong"><strong> Player</strong></span> and uncheck the<span class="strong"><strong> All Players</strong></span> checkbox in its properties. A few of the changes we made are seen in the following screenshot:<a class="indexterm" id="id402"/><div class="mediaobject"><img alt="Time for action—finishing the main menu" src="graphics/1901_07_13.jpg" width="396"/></div></li><li class="listitem">Create a bool variable underneath the<span class="strong"><strong> Active</strong></span> section on the<span class="strong"><strong> Draw Text Event</strong></span> by right-clicking on the square under the word and selecting<span class="strong"><strong> Create New Bool Variable</strong></span>. Move the Matinee Sequence we just created in the<span class="strong"><strong> Level Loaded</strong></span> event by selecting it and its associated object, and hold the<span class="emphasis"><em> Ctrl</em></span> key to move it by dragging your left mouse button. To the right of the<span class="strong"><strong> Level Loaded</strong></span> event create a new<span class="strong"><strong> Toggle</strong></span> action by right-clicking and selecting<span class="strong"><strong> New Action</strong></span> |<span class="strong"><strong> Toggle</strong></span> |<span class="strong"><strong> Toggle</strong></span>. Connect the<span class="strong"><strong> Loaded and Visible</strong></span> output to the<span class="strong"><strong> Toggle</strong></span> input of<span class="strong"><strong> Toggle</strong></span>. Connect the<span class="strong"><strong> Bool</strong></span> input of<span class="strong"><strong> Toggle</strong></span> to the bool on our<span class="strong"><strong> Draw Text</strong></span> action. Connect the<span class="strong"><strong> Out</strong></span> from the<span class="strong"><strong> Toggle</strong></span> event to the<span class="strong"><strong> Toggle</strong></span> input of it and right click on the<span class="strong"><strong> Out</strong></span> output and click on<span class="strong"><strong> Set Activate Delay</strong></span> and give it a value of<code class="literal"> 0.1</code> as shown in the following screenshot:<a class="indexterm" id="id403"/><div class="mediaobject"><img alt="Time for action—finishing the main menu" src="graphics/1901_07_14.jpg" width="253"/></div></li><li class="listitem">Now that we have the blinking text saying to hit the button, how about we create a button to respond to the players touch? Remove the connection between the<span class="strong"><strong> Loaded and Visible</strong></span> output of the<span class="strong"><strong> Level Loaded</strong></span> event and the<span class="strong"><strong> Toggle</strong></span> input of the<span class="strong"><strong> Toggle</strong></span> event, move it over to the right and create an<span class="strong"><strong> Add Input Zone</strong></span> action by right-clicking and selecting<span class="strong"><strong> New Action</strong></span> |<span class="strong"><strong> Mobile</strong></span> |<span class="strong"><strong> Add Input Zone</strong></span>. Set the<span class="strong"><strong> Zone Name</strong></span> to<code class="literal"> StartGame</code>. Click on the little blue triangle next to the<span class="strong"><strong> New Zone</strong></span> to create a new<span class="strong"><strong> MobileInputZone</strong></span>. Inside the<span class="strong"><strong> Zone</strong></span> you just created, in the<span class="strong"><strong> Bounds</strong></span> section set the<span class="strong"><strong> Authored Global Scale</strong></span> to<code class="literal"> 1.0</code> and the<span class="strong"><strong> Size X</strong></span> and<span class="strong"><strong> Size Y</strong></span> to<code class="literal"> 1.0</code> and check<span class="strong"><strong> Relative Size X</strong></span> and<span class="strong"><strong> Relative Size Y</strong></span> checkboxes, as shown in the following screenshot:<a class="indexterm" id="id404"/><div class="mediaobject"><img alt="Time for action—finishing the main menu" src="graphics/1901_07_15.jpg" width="332"/></div><p>Now that we have a button created (it's invisible so you can't see it, but I assure you it's there) we should work on creating some sort of interaction when it happens.
<a class="indexterm" id="id405"/>
</p></li><li class="listitem">Create a<span class="strong"><strong> Mobile Button Access</strong></span> event by right-clicking and selecting<span class="strong"><strong> New Event</strong></span> |<span class="strong"><strong> Input</strong></span> |<span class="strong"><strong> Mobile Button Access</strong></span>. Inside the properties under<span class="strong"><strong> Seq Event Mobile Zone Base</strong></span> in the<span class="strong"><strong> Target Zone Name</strong></span> put the zone we created earlier,<code class="literal"> StartGame</code>. In the<span class="strong"><strong> Sequence Event</strong></span> section change the<span class="strong"><strong> Re Trigger Delay</strong></span> to<code class="literal"> 1.0</code>. In the<span class="strong"><strong> Sequence Object</strong></span> properties under<span class="strong"><strong> Obj Comment</strong></span> type<code class="literal"> Pressed</code> and then the check<span class="strong"><strong> Output Obj Comment To Screen</strong></span> checkbox.<p>Inside the Unreal Editor it is not possible to open up other levels, however it will work in the actual game. This is just to verify that the button does indeed work for us.
</p></li><li class="listitem">Create a<span class="strong"><strong> Console Command</strong></span> action by right-clicking and selecting<span class="strong"><strong> New Action</strong></span> |<span class="strong"><strong> Misc</strong></span> |<span class="strong"><strong> Console Command</strong></span>. In the<span class="strong"><strong> Commands</strong></span> section under<span class="strong"><strong> [0]</strong></span> type<code class="literal"> open levelname</code> where<code class="literal"> levelname</code> is the name of the level you want to load. Create a<span class="strong"><strong> Player 0</strong></span> variable underneath the<span class="strong"><strong> Target</strong></span> of the<span class="strong"><strong> Console Command</strong></span>. Remember that when you are ready to publish the game, remove the comments that you created.</li><li class="listitem">Save your project and start your game by clicking on the<span class="strong"><strong> Start Mobile Previewer</strong></span> button. The preview will look like the following screenshot:<div class="mediaobject"><img alt="Time for action—finishing the main menu" src="graphics/1901_07_16.jpg" width="284"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec02"/>What just happened?</h2></div></div></div><p>With that, we have created a main menu such that when we tap the screen will go into our game level creating a professional looking start to our game.<a class="indexterm" id="id406"/>
</p></div></div>
<div class="section" title="Adding sounds"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec05"/>Adding sounds</h1></div></div></div><p>Something that many people take for granted, sound, can have a massive effect on people when they are playing your game. To give you a taste of how simple it is to add sounds to your game let's add one when we start the game.</p><p>However, just because it is easy to add sounds to our game, playing sounds on iOS devices is quite hard to do—it takes a lot of computing as an iOS device is only able to play one at a time; this is because sounds that are played are uncompressed. This is unlike music that you listen to on your computer (unless you are an audiophile) which is compressed in a format like MP3 which uses a compression algorithm to keep the size of files small. However, having uncompressed sounds makes the files a lot larger. Initializing multiple sounds in the same frame can cause a lot of performance problems. It is a good idea to not play multiple sounds at once if you can help it. This being said, you're going to want to make them as small as possible. Using 22 kHz sounds over 44 kHz sounds on iOS is an easy way to gain a lot of performance that would otherwise be going into processing the sound files. Given that the typical use case of an iOS device is either going to be over the bad speaker or bad headphones included with the device, you can gain a lot of performance for minimal sound difference.<a class="indexterm" id="id407"/>
</p></div>
<div class="section" title="Time for action&#x2014;playing a sound effect"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec06"/>Time for action—playing a sound effect</h1></div></div></div><p>We want the player to know that we have understood him/her tapping to start the game. Let's play a sound to show him/her we know. We can do this as follows:<a class="indexterm" id="id408"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open up the<span class="strong"><strong> Content Browser</strong></span> by either selecting its icon or going to the<span class="strong"><strong> View</strong></span> menu and selecting<span class="strong"><strong> View</strong></span> |<span class="strong"><strong> Browser Windows | Content Browser</strong></span> . Click on the<span class="strong"><strong> Import</strong></span> button in the menu at the bottom of the window. Find the sound that you would like to bring into the game and select<span class="strong"><strong> Open</strong></span>. In the window that pops up set the package with the same name that you just created and open up the tab in the Options menu and check<span class="strong"><strong> Auto Create Cue</strong></span> then click on<span class="strong"><strong> OK</strong></span>, saying yes if it asks you to import the entire package.<div class="mediaobject"><img alt="Time for action—playing a sound effect" src="graphics/1901_07_17.jpg" width="238"/></div></li><li class="listitem">Right-click on the package name on the left-hand side of the<span class="strong"><strong> Content Browser</strong></span> and save our package by selecting<span class="strong"><strong> Save</strong></span> on the menu. Left-click on the<span class="strong"><strong> Sound Cue</strong></span> object and exit into Kismet.<a class="indexterm" id="id409"/><div class="mediaobject"><img alt="Time for action—playing a sound effect" src="graphics/1901_07_18.jpg" width="396"/></div></li><li class="listitem">Inside Kismet disconnect the<span class="strong"><strong> Console Command</strong></span> action that we created previously by holding down<span class="emphasis"><em> Alt</em></span> and clicking on the line connecting it from the<span class="strong"><strong> Mobile Button Access</strong></span> event and move it to the right by holding<span class="emphasis"><em> Ctrl</em></span> and dragging. In the space available create a<span class="strong"><strong> Play Sound</strong></span> action by right-clicking and selecting<span class="strong"><strong> New Action</strong></span> |<span class="strong"><strong> Sound</strong></span> |<span class="strong"><strong> Play Sound</strong></span>. In the<span class="strong"><strong> Play Sound</strong></span> action's properties click on the green arrow in the<span class="strong"><strong> Play Sound</strong></span> property to set it to the sound we created. Connect the<span class="strong"><strong> Input Pressed</strong></span> output from the<span class="strong"><strong> Mobile Button Access</strong></span> event to the<span class="strong"><strong> Play</strong></span> on the<span class="strong"><strong> Play Sound</strong></span> action and the<span class="strong"><strong> Finished</strong></span> from the<span class="strong"><strong> Play Sound</strong></span> action to the<span class="strong"><strong> Console Command</strong></span> event. Your screen should look like the following screenshot:<a class="indexterm" id="id410"/><div class="mediaobject"><img alt="Time for action—playing a sound effect" src="graphics/1901_07_19.jpg" width="396"/></div></li><li class="listitem">Save your project and start your game by clicking on the<span class="strong"><strong> Start Mobile Previewer</strong></span> button.</li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec03"/>What just happened?</h2></div></div></div><p>And now our menu creates a sound whenever we tap the screen!</p></div></div>
<div class="section" title="Customizing sounds"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec07"/>Customizing sounds</h1></div></div></div><p>Note that the way that I'm doing sound right now doesn't take into account the sound's position in space. This doesn't matter since the sound is going to be playing directly at the player, but if you wanted to, you can edit the<span class="strong"><strong> SoundCue</strong></span> by right-clicking on it in the<span class="strong"><strong> Content Browser</strong></span> and selecting<span class="strong"><strong> Edit Using SoundCue Editor</strong></span>.<a class="indexterm" id="id411"/>
</p><p>The SoundCue Editor is very similar to Kismet other than the fact that the only event called is when it is played which is shown by an image of a Speaker. The<span class="strong"><strong> attenuation</strong></span> feature can be applied to events in order to put a given sound into world space instead of it always being the same. However, this can only work if the sound is a mono sound.<a class="indexterm" id="id412"/>
</p><div class="mediaobject"><img alt="Customizing sounds" src="graphics/1901_07_20.jpg" width="396"/></div><p>Once this is set it is possible to drag-and-drop a SoundCue inside a level, into the game world. So if you would like to add sound effects in your level that way you are welcome to try this and when you go around your level the sound will become louder and shift location based on where you are in the game world. There are plenty of other features to look at here, such as randomizers, but we'll only be playing a simple sound here. Play around with it in your own time or look at the Sound Cues that Epic provides with UDK to see the possible things you can do, such as adding modulation and variation to sounds, just like the gun shots sound different depending on your location in the game world, when you fire them. Have fun with it!<a class="indexterm" id="id413"/>
</p></div>
<div class="section" title="Adding music"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec08"/>Adding music</h1></div></div></div><p>Similar to sound, music is done slightly differently on iOS than they are done for the PC. Since mobiles are usually media players they have hardware that specifically works with playing music efficiently, but the mobile platform is also limited in what it can do. Let's first add some music to our level.<a class="indexterm" id="id414"/>
</p></div>
<div class="section" title="Time for action&#x2014;adding a background music track"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec09"/>Time for action—adding a background music track</h1></div></div></div><p>Now, mobile devices have dedicated sound hardware for compressed sounds. iOS devices can play back one compressed stream at a time with little to no cost, so it will be our job to create music that works well in that regard. However, MP3 files do not work in the PC version of Unreal in either the editor or main game so I will be showing you how to add music in the Editor as well. We can do this as follows:<a class="indexterm" id="id415"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go to Windows Explorer and open your<code class="literal"> UDKGame\Build\iPhone\Resources\Music</code> folder. This is the folder that you need to place any MP3 file that you want to play within your game. For the sake of this we will be using a file already included with UDK, but feel free to put in any MP3 file that you like and whenever I say<code class="literal"> Jazz_Menu_01</code>, type the name of your file. The music folder would look like the following screenshot:<div class="mediaobject"><img alt="Time for action—adding a background music track" height="162" src="graphics/1901_07_21.jpg"/></div></li><li class="listitem">Open the<span class="strong"><strong> Content Browser</strong></span> by either selecting its icon or going to the<span class="strong"><strong> View</strong></span> menu and selecting<span class="strong"><strong> View</strong></span> |<span class="strong"><strong> Browser Windows</strong></span> |<span class="strong"><strong> Content Browser</strong></span>. Inside the<span class="strong"><strong> Content Browser</strong></span> change the<span class="strong"><strong> Object Type</strong></span> to<span class="strong"><strong> Sound Cues</strong></span> and type<code class="literal"> music</code> in the textbox at the top of the window. Left-click on the first item which is<code class="literal"> SoundCue'A_Music_GoDown.MusicSegments.A_Music_GoDown_Ambient01Cue'</code> and exit into Kismet. The following screenshot shows this:<a class="indexterm" id="id416"/><div class="mediaobject"><img alt="Time for action—adding a background music track" src="graphics/1901_07_22.jpg" width="396"/></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;" title="Note"><h3 class="title"><a id="note13"/>Note</h3><p>Note that this file will not be used in the game when it goes on an iOS device, but will let you know that for sure that sound is playing. If you had your own music file you could export it with Audacity (<a class="ulink" href="http://audacity.sourceforge.net/">http://audacity.sourceforge.net/</a>) and import it in much the same way that you would for sound effects, but that is a good exercise to do on your own.</p></div></li><li class="listitem">In Kismet remove the connection between the<span class="strong"><strong> Loaded and Visible</strong></span> output on the<span class="strong"><strong> Level Loaded</strong></span> event and the<span class="strong"><strong> In</strong></span> section of the<span class="strong"><strong> Add Input Zone</strong></span> action. Move the<span class="strong"><strong> Level Loaded</strong></span> action to the left by holding<span class="emphasis"><em> Ctrl</em></span> and dragging. In the space created right-click and create a<span class="strong"><strong> Play Music Track</strong></span> action by right-clicking and selecting<span class="strong"><strong> New Action</strong></span> |<span class="strong"><strong> Sound</strong></span> |<span class="strong"><strong> Play Music Track</strong></span>. Connect the<span class="strong"><strong> Loaded and Visible</strong></span> output from the<span class="strong"><strong> Level Loaded</strong></span> event into the<span class="strong"><strong> In</strong></span> of the<span class="strong"><strong> Play Music Track</strong></span> and the<span class="strong"><strong> Out</strong></span> from the<span class="strong"><strong> Play Music Track</strong></span> action into the<span class="strong"><strong> In</strong></span> of the<span class="strong"><strong> Add Input Zone</strong></span> action. Inside the properties for the<span class="strong"><strong> Play Music Track</strong></span> action extend the<span class="strong"><strong> Seq Act Play Music Track</strong></span> section. Click on the green arrow next to the<span class="strong"><strong> Sound Cue</strong></span> to set the PC version of music to play, and then at the bottom of the screen you will see<span class="strong"><strong> MP3Filename</strong></span> where you will put<code class="literal"> Jazz_Menu_01.</code><a class="indexterm" id="id417"/><div class="mediaobject"><img alt="Time for action—adding a background music track" src="graphics/1901_07_23.jpg" width="342"/></div></li><li class="listitem">Save your project and start your game by clicking on the<span class="strong"><strong> Start Mobile Previewer</strong></span> button.</li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec04"/>What just happened?</h2></div></div></div><p>With that, we have created a main menu that when tapped will go into our game level creating a professional looking start to our game.<a class="indexterm" id="id418"/>
</p></div></div>
<div class="section" title="Custom materials"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec10"/>Custom materials</h1></div></div></div><p>Materials are what the Unreal Engine uses in order to put images onto brushes or 3D models that we've created; now, we'll get to putting in custom models in a minute, but first we need to get materials in and for those that don't know how to use a 3D modeling program this will be the extent of what they can do, without learning another program. There are also some stunning professional-quality maps made only using Materials and BSPs and minimal meshes such as the<span class="emphasis"><em> Hardcore Oldskool Low-Poly Map Pack</em></span> at <a class="ulink" href="http://holp.beyondunreal.com/index.html">http://holp.beyondunreal.com/index.html</a>, so you don't have to learn one if you don't want to, but it helps.<a class="indexterm" id="id419"/>
</p></div>
<div class="section" title="Time for action&#x2014;customizing brushes"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec11"/>Time for action—customizing brushes</h1></div></div></div><p>The level that we created in the previous chapter does indeed look good, but it would be even better to put actual buildings into the level, so let's try to make the brushes more building-like by adding some custom Materials to them!<a class="indexterm" id="id420"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open up the<span class="strong"><strong> Content Browser</strong></span> by either selecting its icon or going to the<span class="strong"><strong> View</strong></span> menu and selecting<span class="strong"><strong> View</strong></span> |<span class="strong"><strong> Browser Windows</strong></span> |<span class="strong"><strong> Content Browser</strong></span>. Click on the<span class="strong"><strong> Import</strong></span> button in the menu at the bottom of the window. Select both the files<code class="literal"> building03</code> and<code class="literal"> building03_NRM</code> by clicking on one, holding down the<span class="emphasis"><em> Ctrl</em></span> key and selecting the other. With these selected click on<span class="strong"><strong> Open</strong></span>. This is how your screen would look:<div class="mediaobject"><img alt="Time for action—customizing brushes" height="243" src="graphics/1901_07_24.jpg"/></div></li><li class="listitem">There will be an import dialog that will come up. In the<span class="strong"><strong> Package</strong></span> section type the name<code class="literal"> UW-GamePKG</code> and confirm that<code class="literal"> building03</code> is in the<span class="strong"><strong> Name</strong></span> section. Inside the<span class="strong"><strong> Options</strong></span> section check the box for<span class="strong"><strong> Create Material</strong></span> and click on<span class="strong"><strong> OK</strong></span> and then for the<code class="literal"> building03_NRM</code> file uncheck the<span class="strong"><strong> Create Material</strong></span> option and click on<span class="strong"><strong> OK</strong></span>. You should be brought back to the<span class="strong"><strong> Content Browser</strong></span> where you will see our new package with three new files, as shown in the following screenshot:<a class="indexterm" id="id421"/><div class="mediaobject"><img alt="Time for action—customizing brushes" src="graphics/1901_07_25.jpg" width="396"/></div></li><li class="listitem">Double-click on the<code class="literal"> building03_Mat</code> material in order to enter the<span class="strong"><strong> Material Editor</strong></span>. Now the<span class="strong"><strong> Material Editor</strong></span> may look scary at first, but just like the Sound Editor it is amazingly similar to Kismet when you look at it. Click on the<span class="strong"><strong> Texture Sample</strong></span> with the texture that we imported and drag it to the right-hand side of the<span class="strong"><strong> Diffuse</strong></span> option by holding<span class="emphasis"><em> Ctrl</em></span> and dragging.<a class="indexterm" id="id422"/></li><li class="listitem">Go to the<span class="strong"><strong> Content Browser</strong></span> and select the<code class="literal"> building03_NRM</code> texture by left-clicking it and going back into the<span class="strong"><strong> Material Editor</strong></span>. Hold down the<span class="emphasis"><em> T</em></span> key and left-click on the screen near the<span class="strong"><strong> Normal</strong></span> section of the<span class="strong"><strong> PreviewMaterial_0</strong></span> area, you should see a new Texture Sample show up. You also select the Texture Sample from the menu on the right-hand side and drag-and-drop it in from the<span class="strong"><strong> Material Expressions</strong></span> area. Connect the<span class="strong"><strong> Normal</strong></span> option from the<span class="strong"><strong> PreviewMaterial_0</strong></span> to the black connector of the new<span class="strong"><strong> Texture Sample</strong></span>.<p>You will notice that our Material now looks like it has depth to it. That is because a normal map is a technique used for faking the lighting of bumps and dents. It is used to add details without using more polygons and what you see now is how it would look if you played your game on PC. When playing the game on iOS, UDK will attempt to bake it into the lightmap used by the level using the PC materials normal map, while the advanced effects use the normal map slot under the <span class="strong"><strong>Mobile</strong></span> section of the material editor.
<a class="indexterm" id="id423"/>
</p><p>Again, there are a lot of other options that you can use on the PC version of UDK that you cannot use on the iOS. However, there is a very good guide for those who want to create their own textures on the different things you can do on UDN at <a class="ulink" href="http://udn.epicgames.com/Three/MobileMaterialReference.html">http://udn.epicgames.com/Three/MobileMaterialReference.html</a>.
</p></li><li class="listitem">Deselect the<span class="strong"><strong> Texture Sample</strong></span> and you should see the<span class="strong"><strong> Properties</strong></span> for the Material at the bottom of the screen. Open up the<span class="strong"><strong> Mobile</strong></span> section by click on the green arrow beside<span class="strong"><strong> Mobile Normal Texture</strong></span> in order to load our normal map into the game. Go into the<span class="strong"><strong> Content Browser</strong></span> and select our diffuse texture and then click the green arrow for<span class="strong"><strong> Mobile Base Texture</strong></span>. The<span class="strong"><strong> Material Editor</strong></span> window will look like the following screenshot:<div class="mediaobject"><img alt="Time for action—customizing brushes" src="graphics/1901_07_26.jpg" width="396"/></div></li><li class="listitem">In the menu click on the green checkmark at the top in order to save the changes that you've made and close the<span class="strong"><strong> Material Editor</strong></span>. Save the package you've created by right-clicking on the package and selecting<span class="strong"><strong> Save</strong></span> from the menu and saving the package in a location on your computer.<a class="indexterm" id="id424"/></li><li class="listitem">Repeat steps 1 to 6 for the other materials in the folder as we will be using them later.<div class="mediaobject"><img alt="Time for action—customizing brushes" src="graphics/1901_07_27.jpg" width="395"/></div></li><li class="listitem">Open up the game level that we created in the previous chapter. Find a large brush that you created for a building before, left-click to select one of the surfaces then right-click and select<span class="strong"><strong> Select Surfaces</strong></span> |<span class="strong"><strong> Matching Brush</strong></span>. Go to the<span class="strong"><strong> Content Browser</strong></span> and select<code class="literal"> building01_Mat</code> by left-clicking on it. At the brush right-click and select<span class="strong"><strong> Apply Material : building01_Mat</strong></span>. You may click on the<span class="strong"><strong> Unlit</strong></span> button on the perspective toolbar or press<span class="emphasis"><em> Alt+3</em></span> to help you see what's going on. When you are finished you can press<span class="emphasis"><em> Alt+4</em></span> to go back to<span class="strong"><strong> Lit</strong></span> mode.<a class="indexterm" id="id425"/></li><li class="listitem">We can start to see how the building could work out using this material, but each side seems to be doing its own thing in the different coordinates, thankfully we can easily fix this problem.<a class="indexterm" id="id426"/></li><li class="listitem">Open up the<span class="strong"><strong> Surface Properties</strong></span> menu by either pressing<span class="emphasis"><em> F5</em></span> or going to<span class="strong"><strong> View</strong></span> |<span class="strong"><strong> Surface Properties</strong></span> and selecting the matching brush textures again. Change the<span class="strong"><strong> Alignment</strong></span> to<span class="strong"><strong> Box</strong></span> and hit<span class="strong"><strong> Apply</strong></span>. Then change the<span class="strong"><strong> Simple</strong></span> scaling value to<code class="literal"> 4.0</code> and hit<span class="strong"><strong> Apply</strong></span> again.<div class="mediaobject"><img alt="Time for action—customizing brushes" height="239" src="graphics/1901_07_28.jpg"/></div></li><li class="listitem">Apply textures to your level on buildings that you would like to see changed using the materials provided or with your own. Note that since the player will not see the roofs of our buildings we do not need to have a texture for them. This is seen in the following screenshot:<div class="mediaobject"><img alt="Time for action—customizing brushes" height="138" src="graphics/1901_07_29.jpg"/></div></li><li class="listitem">Save your project and start your game by clicking on the<span class="strong"><strong> Start Mobile Previewer</strong></span> button.<a class="indexterm" id="id427"/><div class="mediaobject"><img alt="Time for action—customizing brushes" src="graphics/1901_07_30.jpg" width="231"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec05"/>What just happened?</h2></div></div></div><p>We now have a world that looks more polished with our own textures filling the world. With the same basic concepts here you can paint your brushes however you want!<a class="indexterm" id="id428"/>
</p></div></div>
<div class="section" title="Custom meshes"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec12"/>Custom meshes</h1></div></div></div><p>The static meshes that are included inside of UDK are fine, but if you want to create anything that is remotely different and detailed, chances are you will need to import custom meshes of your own.<a class="indexterm" id="id429"/>
</p><p>For those creating their own models, there are various different tutorials on the internet for you to look at, but in general export your model as an FBX file and enable smoothing groups when exporting it and try to keep your models as low poly as possible. For more information on the creation of the models you can visit: <a class="ulink" href="http://udn.epicgames.com/Three/DesigningForMobile.html">http://udn.epicgames.com/Three/DesigningForMobile.html</a>.</p></div>
<div class="section" title="Time for action&#x2014;importing custom objects"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec13"/>Time for action—importing custom objects</h1></div></div></div><p>In our case, we would like to replace some of the BSP buildings that we created in the game with some simple static meshes that I created. We can do this as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open up the<span class="strong"><strong> Content Browser</strong></span> by either selecting its icon or going to the<span class="strong"><strong> View</strong></span> menu and selecting<span class="strong"><strong> View</strong></span> |<span class="strong"><strong> Browser Windows</strong></span> |<span class="strong"><strong> Content Browser</strong></span>. Click on the<span class="strong"><strong> Import</strong></span> button in the menu at the bottom of the window. Find the two building<code class="literal"> .fbx</code> files, select them and then click on<span class="strong"><strong> Open</strong></span>. In the window that pops up set the package with the same name that you created before and click on<span class="strong"><strong> OK</strong></span>, saying yes if it asks you to import the entire package. This is seen in the following screenshot:<a class="indexterm" id="id430"/><div class="mediaobject"><img alt="Time for action—importing custom objects" height="229" src="graphics/1901_07_31.jpg"/></div></li><li class="listitem">Right-click on the package name on the left-hand side of the<span class="strong"><strong> Content Browser</strong></span> and save our package by selecting<span class="strong"><strong> Save</strong></span> in the menu. Double-click on the first building in order to enter its properties, as shown in the following screenshot:<div class="mediaobject"><img alt="Time for action—importing custom objects" src="graphics/1901_07_32.jpg" width="395"/></div></li><li class="listitem">With the<span class="strong"><strong> Static Mesh Editor</strong></span> open go back into the<span class="strong"><strong> Content Browser</strong></span> and left-click on<code class="literal"> building01_Mat</code> file. Inside the Properties under<span class="strong"><strong> LODInfo.[0].Elements.[0]</strong></span> in<span class="strong"><strong> Material</strong></span> click on the green arrow pointing towards the left to set the Material to the one we selected, as shown in the following screenshot:<a class="indexterm" id="id431"/><div class="mediaobject"><img alt="Time for action—importing custom objects" height="148" src="graphics/1901_07_33.jpg"/></div></li><li class="listitem">On the menu at the top of the<span class="strong"><strong> Static Mesh Editor</strong></span> click<span class="strong"><strong> Collision</strong></span> |<span class="strong"><strong> 6DOP Simplified Collision</strong></span> in order to make the building collide with objects.<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;" title="Note"><h3 class="title"><a id="note14"/>Note</h3><p>If you would like to see the collision generated for the object you can click on the icon in the panel at the top of the screen that looks like it has a red box around it. You can also import your own custom collision that you created in your favorite modeling program. For more information about that, visit: <a class="ulink" href="http://udn.epicgames.com/Three/FBXStaticMeshPipeline.html#Collision">http://udn.epicgames.com/Three/FBXStaticMeshPipeline.html#Collision</a>
</p></div></li><li class="listitem">Double-click on<span class="strong"><strong> building02</strong></span> to enter the<span class="strong"><strong> Static Mesh Editor</strong></span> and repeat steps 3 and 4 using<code class="literal"> building02_Mat</code> as the material to use.<a class="indexterm" id="id432"/></li><li class="listitem">Back in our level find a building that is a similar shape to<span class="strong"><strong> building01</strong></span>. Delete that brush and in its place right-click and select<span class="strong"><strong> Add Static Mesh : UWGamePKG.Building01</strong></span>. Scale the object up till it fits the area of the object you deleted and move it down until it fits the ground or hit the<span class="emphasis"><em> End</em></span> key, then click on<span class="strong"><strong> Rebuild All</strong></span>.<div class="mediaobject"><img alt="Time for action—importing custom objects" src="graphics/1901_07_34.jpg" width="148"/></div></li><li class="listitem">Do the same for other buildings, and continue replacing brushes with the buildings at random intervals trying to make it so you can't see duplicates of them within the same frame or area.<a class="indexterm" id="id433"/><div class="mediaobject"><img alt="Time for action—importing custom objects" src="graphics/1901_07_35.jpg" width="267"/></div></li><li class="listitem">Turn on the<span class="strong"><strong> Emulate Mobile Feature</strong></span> at this point to give you a better feel of what the game may look on the device. You can toggle the mode on and off by clicking on the little icon that looks like a phone to the left-hand side of the<span class="strong"><strong> Install on iOS Device</strong></span> button.<a class="indexterm" id="id434"/></li><li class="listitem">Save your project and start your game by clicking on the<span class="strong"><strong> Start Mobile Previewer</strong></span> button.<div class="mediaobject"><img alt="Time for action—importing custom objects" src="graphics/1901_07_36.jpg" width="235"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec06"/>What just happened?</h2></div></div></div><p>You now have all sorts of custom features added into your game giving you some great examples and now if you'd like to go in and bring in your own models you are free to do that as well!<a class="indexterm" id="id435"/>
</p></div></div>
<div class="section" title="Optimizations"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec14"/>Optimizations</h1></div></div></div><p>There are a ton of resources on how to optimize your game and plenty of discussions on forums of the best ways to do things. In the following sections I will talk about different aspects that I use in order to optimize my games.<a class="indexterm" id="id436"/>
</p><div class="section" title="Console commands—statistics"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec07"/>Console commands—statistics</h2></div></div></div><p>One of the neat new additions to UDK in terms of mobiles is the fact that by holding four fingers on the screen at a time you can open up the console window. You can find a list of console commands you can use in UDK at <a class="ulink" href="http://udn.epicgames.com/Three/ConsoleCommands.html">http://udn.epicgames.com/Three/ConsoleCommands.html</a>. Also note that the values you may see on the PC are in no way an indicator of how things will be on an iOS device so be sure to do your testing by either using the four-finger process or calling the<code class="literal"> Console Command</code> in Kismet. The following are some of the stats that I found most useful when debugging projects.<a class="indexterm" id="id437"/>
</p><div class="section" title="stat fps"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec01"/>stat fps</h3></div></div></div><p>The easiest one to see why we would want it, the FPS counter tells us how many frames per second our game runs. 24 frames per second is the accepted threshold where animation becomes possible, if it is much less, the visuals seems jagged or our brains can tell that they are just images. 30 FPS is an accepted standard in most Unreal games, though some have been able to do 60.<a class="indexterm" id="id438"/>
</p></div><div class="section" title="stat game"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec02"/>stat game</h3></div></div></div><p>This shows statistics related to the time it takes to run different parts of the game, which may make it easier to see which sections of the game are taking the longest to run with the number of checkmarks, and the time it takes to do certain things such as Kismet and UnrealScript.<a class="indexterm" id="id439"/>
</p></div><div class="section" title="stat memory"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec03"/>stat memory</h3></div></div></div><p>This shows how much memory is being used by each individual section of the game. The larger the memory, the more processing power it takes to use and the larger your game will be. Apple only allows you to download apps that are 50 MB or less through 3G/4G, so having an app with a size larger than this will force it to be downloaded through WiFi, which will probably be how your game will wind up, due to the size of UDK, but it still is a good idea to keep your memory footprint low.<a class="indexterm" id="id440"/>
</p><div class="mediaobject"><img alt="stat memory" height="213" src="graphics/1901_07_37.jpg"/></div></div><div class="section" title="stat es2"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec04"/>stat es2</h3></div></div></div><p>OpenGL ES2 is the iOS rendering device and while inside the Mobile Previewer it may crash when run on an iOS device. You can see useful data in terms of how many draw calls are done as well other useful stats to see. Try to keep your draw calls down as low as you can as it will probably be the thing that slows your game down the most.<a class="indexterm" id="id441"/>
</p><div class="mediaobject"><img alt="stat es2" height="216" src="graphics/1901_07_38.jpg"/></div></div></div><div class="section" title="Combining meshes"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec08"/>Combining meshes</h2></div></div></div><p>Speaking of draw calls, we have just learned how to create meshes in our game project earlier in this chapter. When wanting to optimize our game, it may be a good idea to combine similar meshes that contain the same texture together as long as it is still low poly. Having fewer meshes reduces the amount of draw calls that need to be made. In the same regard, reduce the amount of materials that you use on an individual object, constraining yourself to only one Material per object if you possibly can. Using multiple materials on an object at the very least doubles the amount of memory needed to compute and run it, which is not a very good thing when you're trying to make your game as efficient as possible.<a class="indexterm" id="id442"/>
</p></div><div class="section" title="Precomputed visibility"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec09"/>Precomputed visibility</h2></div></div></div><p>Hardware occlusion queries are appealing in games because they work in completely dynamic scenes, but sadly iOS devices do not support occluding objects. By occluding objects I mean that if the player does not see an object, the game can skip drawing that object. While our little game happens to run fine, larger projects will want to make use of this feature as it can greatly improve runtimes. To learn how to set precomputed visibility in your game, see: <a class="ulink" href="http://udn.epicgames.com/Three/PrecomputedVisibility.html">http://udn.epicgames.com/Three/PrecomputedVisibility.html</a>.<a class="indexterm" id="id443"/>
</p></div><div class="section" title="Streaming volumes"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec10"/>Streaming volumes</h2></div></div></div><p>While we're on the topic of larger levels, by far the best way in my opinion to create larger levels is by using streaming volumes. What that basically does is make it so that when you enter a certain area of the world, a level will be loaded. However, in the transition between levels there may be a time when more than one level is open which will lower your frame rate drastically. I personally create small areas in between my larger levels that contain parts of both levels that make the transition more seamless and less of a hog on memory all at once. For more information on streaming volumes and how to set it up, check out: <a class="ulink" href="http://udn.epicgames.com/Three/LevelStreamingVolumes.html">http://udn.epicgames.com/Three/LevelStreamingVolumes.html</a>
<a class="indexterm" id="id444"/>
</p></div></div>
<div class="section" title="Debugging"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec15"/>Debugging</h1></div></div></div><p>Being able to debug your game doesn't seem that important, until something in your game breaks. Having a firm grounding in ways to see what is going on in your game will definitely help you later on down the road as you delve into projects of your own.<a class="indexterm" id="id445"/>
</p><div class="section" title="Comment your code"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec11"/>Comment your code</h2></div></div></div><p>This is something that was drilled into me in college and advice I am very thankful for taking. Chances are that while working on any large project you are not going to be touching a particular sequence in Kismet every day. Weeks are going to go by and you are going to forget why certain things were done. This is just as applicable to Kismet as it is to any other kind of programming language, and thankfully Unreal gives us the ability to make it simple to tell others what is going on. Selecting multiple objects and then right-clicking and selecting<span class="strong"><strong> Comment</strong></span> allows you to type something in, which can give a clue into what a group of Kismet nodes are used for, such as this reworked Player Spawned event:<a class="indexterm" id="id446"/>
</p><div class="mediaobject"><img alt="Comment your code" height="116" src="graphics/1901_07_39.jpg"/></div><p>I also added in object comments at the end of the different input zones, for example I did this when I put in the push button example, except I didn't trigger the output on the screen. Now it is used so that when I glance at the code I know what I'm adding. Cleaning up the code that we did during the project I came up with this:<a class="indexterm" id="id447"/>
</p><div class="mediaobject"><img alt="Comment your code" src="graphics/1901_07_40.jpg" width="131"/></div><p>Even with a glance it is always better to look at than having no guidance at all, making it simple to find what you're looking for either there or in any of the subsequences we created. You could even take this idea further, creating subsequences for each of the different items, but that's more of finding what you're comfortable with and getting accustomed to your own style of doing things.</p></div><div class="section" title="Captain's log"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec12"/>Captain's log</h2></div></div></div><p>Now, there will come a time where you are sure everything is correct and all of your Kismet actions are being called. Well, there's one way to be sure of the value that something is, and that's by logging it and displaying what the data is at runtime. You can create a<span class="strong"><strong> Log</strong></span> action by going into<span class="strong"><strong> New Action</strong></span> |<span class="strong"><strong> Misc</strong></span> |<span class="strong"><strong> Log</strong></span>. From there you can right-click on the object and select<span class="strong"><strong> Expose Variable</strong></span> and choose a type of something you'd like to get the value of. With that if you set the<span class="strong"><strong> Target</strong></span> to<span class="strong"><strong> Player 0</strong></span> and the other item to some of that type, when you play the game and it is called, the game will display what it is. For example when I add a<span class="strong"><strong> Log</strong></span> action to this event:<a class="indexterm" id="id448"/>
</p><div class="mediaobject"><img alt="Captain's log" height="220" src="graphics/1901_07_41.jpg"/></div><p>
<code class="literal">UTPawn_0</code> gets displayed in the log. This is the name of the object that we put in the object variable link of the Log action.<a class="indexterm" id="id449"/>
</p><div class="mediaobject"><img alt="Captain's log" src="graphics/1901_07_42.jpg" width="282"/></div><p>Being able to make sure that an object has a value you think it should have is one of the most obvious ways to tell if something is wrong, other than it not being called at all, of course.<a class="indexterm" id="id450"/>
</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec16"/>Summary</h1></div></div></div><p>Our game is now effectively our own, or at least on its way to being our own. With this knowledge I'm confident that you are more than ready to build your game to be as large as you'd like as well as inputting all sorts of custom stuff into the game. We've specifically learned how to:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Create a main menu for our game with input</li><li class="listitem" style="list-style-type: disc">Add audio on mobile UDK for our game</li><li class="listitem" style="list-style-type: disc">Import custom textures to our game</li><li class="listitem" style="list-style-type: disc">Create a materials for both PC and iOS to use</li><li class="listitem" style="list-style-type: disc">Add static meshes on Mobile UDK for our game</li><li class="listitem" style="list-style-type: disc">Optimize and Debug our game on the iOS</li></ul></div><p>Now that we've learned how to import all of your custom content to your heart's desire, we need to complete our main game in the next chapter. We will go over how to take the game that we created and get it onto the iTunes store and the steps that it requires as well to make your game a success!</p></div></body></html>