<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;Arduino and iOS &#x2013; Platforms and Integration"><div class="titlepage" id="aid-DB7S2"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Arduino and iOS – Platforms and Integration</h1></div></div></div><p>This chapter will give you a brief introduction to the Arduino and iOS platforms and the integration methods between them. Moreover, you will learn how to set up the development environments on both the platforms and get them ready for the projects in the following chapters.</p><p>We will assume that you already have some basic knowledge of the two platforms and electronics, and you are able to build a circuit, at least by using a breadboard. However, the main subject of the chapter is to learn how to integrate the two platforms together.</p><p>Arduino has been an Open Hardware device since its early origin, and you can easily find any kind of information you need about it. Conversely, the iOS platform is not very open, especially from the hardware point of view. You cannot design and build a hardware device that works with iOS devices without joining an Apple dedicated program (MFi). The program has strong requirements that only large companies can fulfill.</p><div class="note" title="Note"><h3 class="title"><a id="tip02"/>Tip</h3><p>
<span class="strong"><strong>More information on Arduino and iOS</strong></span>
</p><p>More <a id="id0" class="indexterm"/>information on Arduino and iOS development can be found at <a class="ulink" href="http://www.arduino.cc">http://www.arduino.cc</a> and <a class="ulink" href="http://apple.co/1HThS1O">http://apple.co/1HThS1O</a> respectively.</p></div><p>Nevertheless, at the end of the chapter, you will learn how to transfer data between the two platforms in ways that also allow your applications to be sold on the iTunes App Store. This <a id="id1" class="indexterm"/>consists of nothing that is too complex. We are going to use TCP/IP <a id="id2" class="indexterm"/>or Bluetooth BLE.</p><p>The following are the topics that will be covered in this chapter:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Hardware and software requirements</li><li class="listitem">Arduino and the development environment setup</li><li class="listitem">iOS and the development environment setup</li><li class="listitem">Communication <a id="id3" class="indexterm"/>methods between the Arduino and iOS devices</li></ul></div><div class="section" title="Hardware and software requirements"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Hardware and software requirements</h1></div></div></div><p>To <a id="id4" class="indexterm"/>implement all the projects in this book, you <a id="id5" class="indexterm"/>will need some hardware and software components, which can be easily bought from any of your local stores or over the Internet.</p><div class="section" title="Hardware requirements for the Arduino platform"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec08"/>Hardware requirements for the Arduino platform</h2></div></div></div><p>To<a id="id6" class="indexterm"/> execute the projects in this book, you mainly need Arduino UNO and the following additional hardware components:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Arduino <a id="id7" class="indexterm"/>UNO R3 (<a class="ulink" href="http://bit.ly/1IInOke">http://bit.ly/1IInOke</a>).</li><li class="listitem">A USB cable (A to B type).</li><li class="listitem">A 9V external DC power supply (optional but recommended).</li><li class="listitem">An official<a id="id8" class="indexterm"/> Wi-Fi Shield (<a class="ulink" href="http://bit.ly/1UQgq9v">http://bit.ly/1UQgq9v</a>, <a class="ulink" href="http://bit.ly/1i5k1Cn">http://bit.ly/1i5k1Cn</a>).</li><li class="listitem">A <a id="id9" class="indexterm"/>Bluetooth BLE nRF8001 breakout board from Adafruit (<a class="ulink" href="http://bit.ly/1MvkyJm">http://bit.ly/1MvkyJm</a>).</li><li class="listitem">A digital multimeter (optional but strongly recommended).</li><li class="listitem">A breadboard (the larger, the better).</li><li class="listitem">Some tools (skewdrivers, pliers, tweezers, nippers, and so on).</li><li class="listitem">Some Male/Male and Male/Female jumper wires (the more, the better; they are never enough!)</li><li class="listitem">Some electronics components, which will be shown chapter by chapter.</li><li class="listitem">A rover robot for a project in <a class="link" title="Chapter 5. TV Set Constant Volume Controller" href="part0039.xhtml#aid-1565U1">Chapter 5</a>, <span class="emphasis"><em>TV Set Constant Volume Controller</em></span>.</li><li class="listitem">An iBeacon for<a id="id10" class="indexterm"/> a project in <a class="link" title="Chapter 6. Automatic Garage Door Opener" href="part0045.xhtml#aid-1AT9A1">Chapter 6</a>, <span class="emphasis"><em>Automatic Garage Door Opener</em></span> (<a class="ulink" href="http://apple.co/1GXnt7Z">http://apple.co/1GXnt7Z</a>).</li></ol><div style="height:10px; width: 1px"/></div><div class="note" title="Note"><h3 class="title"><a id="tip03"/>Tip</h3><p>
<span class="strong"><strong>Buy original products only!</strong></span>
</p><p>There are a lot of counterfeited Arduino products, especially online, that are sold for a few dollars. Apart from the moral considerations, an original product will provide you with much more quality and certainty to right functioning. Projects in this book are developed and tested on original products. You have been warned!</p><p>
<span class="strong"><strong>The official Wi-Fi Shield</strong></span>
</p><p>The <a id="id11" class="indexterm"/>official Wi-Fi Shield is not cheap, and it can be tough to make it work with iOS sometimes. Many other products are cheaper. Some are compatible, others are not. If you choose to use a different Wi-Fi Shield, you need to be sure that it works with the Wi-Fi library that is included in the Arduino IDE. Otherwise, you will have to modify the Arduino code in this book<a id="id12" class="indexterm"/> on your own. You can also buy this Shield at <a class="ulink" href="http://bit.ly/1i5k1Cn">http://bit.ly/1i5k1Cn</a>.</p><p>
<span class="strong"><strong>Arduino.cc versus Arduino.org conflict</strong></span>
</p><p>At the <a id="id13" class="indexterm"/>time of writing this book, Arduino split in two companies—arduino.cc and arduino.org. They are in the middle of a legal battle, and there is a lot of confusion about products with the same name, which are sold by both the companies. Though the situation is getting clearer in USA and Asia, it is still unpredictable in Europe. In this book, we will be using the products and development environment from arduino.cc.</p><p>
<span class="strong"><strong>The Bluetooth Breakout board</strong></span>
</p><p>The <a id="id14" class="indexterm"/>Bluetooth device that we chose has been tested many times on different projects and works well. There are many other devices that are available on the market and which can do exactly the same job. If you decide to use a different Bluetooth device, be sure that is a BLE (Bluetooth Low Energy) device, which is also known as Bluetooth 4.0, Bluetooth Low Energy and Bluetooth Smart. You can easily write iOS applications, which communicate through Bluetooth only if it is Bluetooth BLE.</p></div></div><div class="section" title="Software requirements for the Arduino platform"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec09"/>Software requirements for the Arduino platform</h2></div></div></div><p>All that <a id="id15" class="indexterm"/>you need is Arduino IDE 1.6.4, the libraries included in the IDE, and some additional libraries that are available online. You will be instructed to download them when needed.</p></div><div class="section" title="Hardware requirements for the iOS platform"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec10"/>Hardware requirements for the iOS platform</h2></div></div></div><p>The Apple development environment that is needed to write iOS applications (Xcode) is available<a id="id16" class="indexterm"/> only for the Mac OS X operating system (the 10.10.3 Yosemite version). So, you need a recent Intel-based Mac computer to run Yosemite.</p><p>Moreover, you need an iOS device (iPhone, iPad, or iPod touch) that runs iOS 8.4 and supports Bluetooth 4.0.</p><p>If you are already a member of the <span class="strong"><strong>Apple Developer Program</strong></span> (<span class="strong"><strong>ADP</strong></span>) for iOS (which costs about $99 per year), your life will be easy. Unfortunately, Apple doesn't allow you to upload <a id="id17" class="indexterm"/>programs that are written with Xcode to your own device if you are not a member of ADP. You can still run the programs in the device simulator, but it will not be able to simulate the Bluetooth BLE subsystem. This will be a problem for projects that use Bluetooth BLE. Anyway, adapting the code presented in this book to use Wi-Fi instead of Bluetooth BLE should not be too complex.</p><div class="note" title="Note"><h3 class="title"><a id="tip04"/>Tip</h3><p>
<span class="strong"><strong>Xcode and the new Apple rules</strong></span>
</p><p>At the <a id="id18" class="indexterm"/>time of writing this book, Apple announced a new <a id="id19" class="indexterm"/>version of iOS (version 9) and Xcode (version 7) that are now in their beta versions. Some restriction rules will be removed from these versions, and the user should be able to upload self-written apps to their own devices even if they are not subscribed to the Apple Developer Program.</p></div></div><div class="section" title="Software requirements for the iOS platform"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec11"/>Software requirements for the iOS platform</h2></div></div></div><p>As <a id="id20" class="indexterm"/>already mentioned, to write applications for the iOS platform, you need Xcode (6.4 at the time of writing this book) and some additional open source libraries that are available online. You will be instructed to download them when needed. Xcode runs exclusively on Mac with OS X (version 10.10.3 Yosemite or higher). Even if most of the code of this book can run on the previous versions of iOS, your iOS device has to be able to run iOS 8.3 and higher since it is the version that is used across the book.</p></div></div></div>
<div class="section" title="Arduino and the development environment setup" id="aid-E9OE1"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Arduino and the development environment setup</h1></div></div></div><p>Arduino is a very basic but powerful microprocessor board. It allows you to acquire digital <a id="id21" class="indexterm"/>and analog inputs, process them, and control external devices.</p><p>You can find<a id="id22" class="indexterm"/> all the details about this device at <a class="ulink" href="http://bit.ly/1IInOke">http://bit.ly/1IInOke</a>.</p><p>What makes it different from many other similar (or even more powerful) devices on the market is that it has a very simple development environment (IDE) and plenty of libraries, which allow you to make projects in a matter of hours. Most of these libraries are already available in the IDE or are very easy to add.</p><div class="note" title="Note"><h3 class="title"><a id="tip05"/>Tip</h3><p>
<span class="strong"><strong>Arduino UNO – Arduino MEGA</strong></span>
</p><p>In<a id="id23" class="indexterm"/> this book, we are <a id="id24" class="indexterm"/>going to refer to Arduino UNO. Many other <a id="id25" class="indexterm"/>boards from Arduino are available with different hardware characteristics, FLASH, and the RAM memory size. Most of the projects in this book will run on Arduino MEGA with no changes in their code and minor changes in hardware.</p><p>
<span class="strong"><strong>Other platforms</strong></span>
</p><p>Every <a id="id26" class="indexterm"/>few weeks, a new platform that is compatible with Arduino comes out. Two of these platforms, which are known to be compatible with the projects in this book, are RFduino, which <a id="id27" class="indexterm"/>supports Bluetooth BLE without any additional <a id="id28" class="indexterm"/>hardware, (for more information, visit <a class="ulink" href="http://www.rfduino.com">http://www.rfduino.com</a>) and Teensy (to know more about Teensy, visit <a class="ulink" href="https://www.pjrc.com/teensy">https://www.pjrc.com/teensy</a>). Some changes in hardware and/or software may be necessary to work with these platforms.</p></div><div class="section" title="IDE installation"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec12"/>IDE installation</h2></div></div></div><p>The process<a id="id29" class="indexterm"/> of installing the IDE is very quick and easy, especially because you don't need to install additional drivers on OS X.</p><p>You can use the following steps to have the development environment ready in minutes:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Make sure that you have installed an application that can open a ZIP file. If you don't have such an application, you can find them available for free on the App <a id="id30" class="indexterm"/>Store (The Unarchiver may be an option, which can be downloaded from <a class="ulink" href="http://apple.co/1gT7W2D">http://apple.co/1gT7W2D</a>).</li><li class="listitem">Download<a id="id31" class="indexterm"/> Arduino IDE 1.6.4 from <a class="ulink" href="http://bit.ly/1gT8u8E">http://bit.ly/1gT8u8E</a>.</li><li class="listitem">Usually, the browser will download the file in your <code class="literal">Downloads</code> folder. Open this folder and unzip the ZIP file (<code class="literal">Arduino-1.6.4-macosx.zip</code>).</li><li class="listitem">Move the <code class="literal">Arduino.app</code> file to your app folder.</li></ol><div style="height:10px; width: 1px"/></div><p>The development environment is now ready to run.</p><p>Just to be sure that everything is working as expected, upload one of the included examples (Blink is fine) to <a id="id32" class="indexterm"/>your UNO. Refer to <a class="ulink" href="http://bit.ly/1KsUhqv">http://bit.ly/1KsUhqv</a> in order to properly configure the board and port in the IDE.</p><div class="note" title="Note"><h3 class="title"><a id="tip06"/>Tip</h3><p>
<span class="strong"><strong>The IDE version to use</strong></span>
</p><p>The<a id="id33" class="indexterm"/> code in this book was tested with IDE 1.6.4, which<a id="id34" class="indexterm"/> is the latest version that is available at the time of writing this book. Even if a new version of the IDE is available, you should use the suggested version. The libraries that are included in different versions of the IDE usually vary, and this may cause unexpected behavior. You can test a newer IDE once you have completely built and tested the project on Arduino and iOS.</p></div></div></div>
<div class="section" title="iOS and the development environment setup" id="aid-F8901"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>iOS and the development environment setup</h1></div></div></div><p>In the<a id="id35" class="indexterm"/> last few years, commonly named smartphones have become the most used personal devices. iPhone is one of the most used smartphones all over the world, and iPads have replaced personal computers in many cases.</p><p>iPhone, iPad, and iPod touch run the same operating system, which is called iOS. They have a neat and homogeneous user interface, which allows its users to interact with the device through simple gestures (such as tapping and double-tapping the screen) or complex gestures (such as swiping or pinching the screen).</p><p>Applications that run on both iPhone and iPad can be easily written with minor changes, and the platforms are so powerful that almost any application can run on them.</p><p>We can directly go to the process of installing the development environment so that we can start having fun with iOS and Arduino.</p><div class="section" title="Xcode installation"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec13"/>Xcode installation</h2></div></div></div><p>You can <a id="id36" class="indexterm"/>perform the following steps to install Xcode in minutes:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open the App Store application. Usually, you will find it in the Dock. Alternatively, you can run it from Launchpad or by navigating to <span class="strong"><strong>Finder</strong></span> | <span class="strong"><strong>Applications</strong></span> | <span class="strong"><strong>App Store</strong></span>.</li><li class="listitem">Connect to the App Store by using your account (browse <span class="strong"><strong>Store</strong></span> | <span class="strong"><strong>Sign in</strong></span>).</li><li class="listitem">Locate Xcode (navigate to <span class="strong"><strong>Categories</strong></span> | <span class="strong"><strong>Developer Tools</strong></span> or search for it).</li><li class="listitem">Click on the <span class="strong"><strong>Get</strong></span> button to start downloading.</li></ol><div style="height:10px; width: 1px"/></div><p>In a short span of time, the application will be downloaded and installed (depending on the speed<a id="id37" class="indexterm"/> of your Internet connection).</p></div></div>
<div class="section" title="Communication methods between Arduino and iOS devices" id="aid-G6PI1"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Communication methods between Arduino and iOS devices</h1></div></div></div><p>iOS is not so open platform, especially<a id="id38" class="indexterm"/> from the hardware point of view. Apple requires that the hardware devices connected to iPhone or iPad should not only be compliant with straight requirements, but also be certified by Apple itself. For this, they need to join an Apple dedicated program (MFi: <a class="ulink" href="http://apple.co/1PwSeWO">http://apple.co/1PwSeWO</a>). The requirements to join the program<a id="id39" class="indexterm"/> are very tight, and only a large company can fulfill them.</p><p>Nevertheless, Apple allows the use of TCP/IP and Bluetooth BLE to communicate with any external device. These are the two methods that we are going to use all over the book to transfer data with Arduino. On Arduino's side, we have to choose additional hardware that is compatible with these two methods or, in a more technical jargon, these two protocols.</p><p>Arduino provides the following two Shields for TCP/IP communication:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">The Ethernet Shield</li><li class="listitem">The Wi-Fi Shield</li></ul></div><p>Both these Shields include an SD card bay to store data.</p><p>The <a id="id40" class="indexterm"/>Ethernet Shield is relatively cheap and very reliable. Since it uses an Ethernet connection, it's drawback is that it needs physical wiring to your home network or router. This reduces the flexibility of your projects.</p><p>Conversely, the <a id="id41" class="indexterm"/>Wi-Fi Shield allows you to install your Arduino board everywhere in your house without the awkwardness of wires. This is the reason why we chose to use the Wi-Fi Shield in this book.</p><p>The other connection method (protocol) that is allowed by Apple to transfer data to and from external devices is Bluetooth BLE (also known as Bluetooth 4.0). This protocol consumes less energy, but it's not compatible with the previous versions. If your iOS device is quite new, Bluetooth BLE will be supported. Please check this out on your device page at the Apple site.</p><div class="note" title="Note"><h3 class="title"><a id="tip07"/>Tip</h3><p>
<span class="strong"><strong>BLE supporting devices</strong></span>
</p><p>If you<a id="id42" class="indexterm"/> wish to check whether a device supports BLE, visit <a class="ulink" href="http://bit.ly/1blI106">http://bit.ly/1blI106</a>.</p></div><p>Arduino doesn't provide a Bluetooth BLE Shield, but other vendors do. We chose the Bluetooth BLE nRF8001 breakout board <a id="id43" class="indexterm"/>from Adafruit.</p><div class="note" title="Note"><h3 class="title"><a id="tip08"/>Tip</h3><p>
<span class="strong"><strong>Bluetooth 4.0</strong></span>
</p><p>You <a id="id44" class="indexterm"/>can learn more about Bluetooth 4.0 by visiting <a class="ulink" href="http://bit.ly/1Pj9caw">http://bit.ly/1Pj9caw</a>.</p></div><div class="section" title="TCP/IP versus Bluetooth"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec14"/>TCP/IP versus Bluetooth</h2></div></div></div><p>You<a id="id45" class="indexterm"/> may wonder which is the best communication method for <a id="id46" class="indexterm"/>iOS and Arduino. There is no right answer. This actually depends on your project and your requirements. The following table shows the main pros and cons of each method:</p><div class="informaltable"><table border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th valign="bottom">
<p>Method</p>
</th><th valign="bottom">
<p>Pros</p>
</th><th valign="bottom">
<p>Cons</p>
</th></tr></thead><tbody><tr><td valign="top">
<p>
<span class="strong"><strong>Wi-Fi</strong></span>
</p>
</td><td valign="top">
<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Arduino can be<a id="id47" class="indexterm"/> located almost everywhere in your house.</li><li class="listitem">The iOS device can be everywhere (if the network is properly set, even on the other side of the world).</li><li class="listitem">An SD card can be used to store data.</li></ul></div>
</td><td valign="top">
<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">This is expensive.</li><li class="listitem">Even <a id="id48" class="indexterm"/>if data could be transferred with up to 54 Mbps, the Wi-Fi Shield is not so responsive in transferring data.</li><li class="listitem">The power consumption is so high that you cannot use a battery to power Arduino and the Wi-Fi Shield.</li></ul></div>
</td></tr><tr><td valign="top">
<p>
<span class="strong"><strong>Bluetooth</strong></span>
</p>
</td><td valign="top">
<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Arduino can<a id="id49" class="indexterm"/> be located almost everywhere in your house.</li><li class="listitem">BLE devices consume much less power. So, a battery can be used to power it.</li><li class="listitem">Data transfer speeds reach up to 1 Mbps but with no latency.</li></ul></div>
</td><td valign="top">
<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">The<a id="id50" class="indexterm"/> iOS device has to be near Arduino (about 100 meters; lesser for indoors).</li><li class="listitem">No SD card is available on the board if you wish to store additional data.</li></ul></div>
</td></tr></tbody></table></div></div></div>
<div class="section" title="Summary" id="aid-H5A41"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Summary</h1></div></div></div><p>In this chapter, you mainly learned the basics of integrating the Arduino and iOS devices. In the following chapters, you will learn how to write code for this integration in practice.</p><p>Moreover, you installed the Arduino IDE to write and upload programs to Arduino and Xcode to write and upload programs to your iOS devices.</p><p>So, sit back. We just got the ball rolling! Let's get rolling!</p></div></body></html>