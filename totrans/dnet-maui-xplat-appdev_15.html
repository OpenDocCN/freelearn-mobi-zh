<html><head></head><body>
<div><div><h1 class="chapterNumber">12</h1>
<h1 class="chapterTitle" id="_idParaDest-308">Deploying and Publishing in App Stores</h1>
<p class="normal">After completing the development work, our aim is to publish our app on various app stores. Since .NET MAUI is a cross-platform framework, we can build the same source code for Android, iOS, macOS, and Windows. While it’s possible to deploy our app to a repository such as GitHub, most users on these platforms rely on app stores. As a result, we need to understand how to prepare our app for different app stores. That is the focus of this chapter. In this chapter, we will discuss the steps required to prepare the application packages before publishing.</p>
<p class="normal">We will cover the following topics in this chapter:</p>
<ul>
<li class="bulletList">Preparing application packages for publishing</li>
<li class="bulletList">Automating the build process using GitHub Actions</li>
</ul>
<h1 class="heading-1" id="_idParaDest-309">Technical requirements</h1>
<p class="normal">To test and debug the source code in this chapter, we need to install .NET MAUI on Windows and macOS. For complete details about environment setup, please refer to the <em class="italic">Development environment setup</em> section in <em class="chapterRef">Chapter 1</em>, <em class="italic">Getting Started with .NET MAUI</em>.</p>
<p class="normal">We will build Windows and Android packages using Windows, while iOS and macOS packages will be built using macOS.</p>
<p class="normal">The source code for this chapter can be found at the following GitHub repository: <a href="https://github.com/PacktPublishing/.NET-MAUI-Cross-Platform-Application-Development-Second-edition/tree/65b2d502abe294c0e121ef0536b9bd1c6a7b79f3">https://github.com/PacktPublishing/.NET-MAUI-Cross-Platform-Application-Development-Second-edition/tree/main/2nd/chapter12</a>.</p>
<p class="normal">To check out the source code for this chapter, use the command below:</p>
<pre class="programlisting con"><code class="hljs-con">$ git clone -b 2nd/chapter12 https://github.com/PacktPublishing/.NET-MAUI-Cross-Platform-Application-Development-Second-edition.git PassXYZ.Vault2
</code></pre>
<p class="normal">For more information about the source code in this book, please refer to the <em class="italic">Managing the source code in this book</em> section in <em class="chapterRef">Chapter 2</em>, <em class="italic">Building Our First .NET MAUI App</em>.</p>
<h1 class="heading-1" id="_idParaDest-310">Preparing application packages for publishing</h1>
<p class="normal">In<a id="_idIndexMarker906"/> previous chapters, minimal platform-specific knowledge was required for .NET MAUI development. However, when preparing to publish our app to individual app stores, we cannot avoid addressing platform-specific information. In this chapter, we will discuss the necessary steps to prepare the app for publishing, and then we will show how to automate the process using GitHub Actions.</p>
<p class="normal">There are numerous CI/CD tools available for automating the build and deployment process. For .NET MAUI, both GitHub Actions and Azure DevOps are viable options. You can refer to the <em class="italic">Further reading</em> section for more details about other alternatives. However, in this chapter, our primary emphasis will be on employing GitHub Actions as a build and deployment instrument.</p>
<h2 class="heading-2" id="_idParaDest-311">Preparing for publishing</h2>
<p class="normal">To <a id="_idIndexMarker907"/>prepare for publishing, we will focus on the tasks that need to be completed before submitting the package to an app store. For information about the actual publishing process, please refer to the documentation provided by each app store.</p>
<p class="normal">During the preparation for publishing, we aim to answer the following questions:</p>
<ul>
<li class="bulletList">How is an app identified in the app store?</li>
<li class="bulletList">How are the app developers identified?</li>
<li class="bulletList">Which devices can the app support?</li>
</ul>
<p class="normal">Building and signing application packages on different platforms require platform-specific configurations. In .NET MAUI, the platform-specific information is included in the Visual Studio project file and the platform-specific configuration file. Conditional compilation is used in the Visual Studio project file to specify platform-specific information. Refer to <em class="italic">Table 12.1</em> for an overview of the necessary changes for each platform.</p>
<table class="table-container" id="table001-8">
<tbody>
<tr>
<td class="table-cell">
<p class="normal"><strong class="keyWord">Item</strong></p>
</td>
<td class="table-cell">
<p class="normal"><strong class="keyWord">Android</strong></p>
</td>
<td class="table-cell">
<p class="normal"><strong class="keyWord">Windows</strong></p>
</td>
<td class="table-cell">
<p class="normal"><strong class="keyWord">iOS</strong></p>
</td>
<td class="table-cell">
<p class="normal"><strong class="keyWord">macOS</strong></p>
</td>
</tr>
<tr>
<td class="table-cell">
<p class="normal">Package format</p>
</td>
<td class="table-cell">
<p class="normal"><code class="inlineCode">.apk/.aab</code></p>
</td>
<td class="table-cell">
<p class="normal"><code class="inlineCode">.msix</code></p>
</td>
<td class="table-cell">
<p class="normal"><code class="inlineCode">.ipa</code></p>
</td>
<td class="table-cell">
<p class="normal"><code class="inlineCode">.app/.pkg</code></p>
</td>
</tr>
<tr>
<td class="table-cell">
<p class="normal">Signing</p>
</td>
<td class="table-cell">
<p class="normal"><code class="inlineCode">Keystore</code></p>
</td>
<td class="table-cell">
<p class="normal">Signing certificate</p>
<p class="normal"><code class="inlineCode">Package.StoreAssociation.xml</code></p>
</td>
<td class="table-cell" colspan="2">
<p class="normal">Distrubution certificate</p>
<p class="normal">Distribution profile</p>
</td>
</tr>
<tr>
<td class="table-cell">
<p class="normal">ApplicationId</p>
</td>
<td class="table-cell">
<p class="normal"><code class="inlineCode">package="com.passxyz.vault2"</code></p>
</td>
<td class="table-cell">
<p class="normal"><code class="inlineCode">Publisher="CN=F81DB 4B-AF4A-473E-ADEA-A55EE7432C05"</code></p>
</td>
<td class="table-cell" colspan="2">
<p class="normal"><code class="inlineCode">&lt;key&gt;CFBundleIdentifier&lt;/key&gt;</code></p>
<p class="normal"><code class="inlineCode">&lt;string&gt;com.passxyz.vault2&lt;/string&gt;</code></p>
</td>
</tr>
<tr>
<td class="table-cell">
<p class="normal">ApplicationVersion</p>
</td>
<td class="table-cell">
<p class="normal"><code class="inlineCode">android:versionCode="1"</code></p>
</td>
<td class="table-cell">
<p class="normal"><code class="inlineCode">Version="0.3.8.0"</code></p>
</td>
<td class="table-cell" colspan="2">
<p class="normal"><code class="inlineCode">&lt;key&gt;CFBundleVersion&lt;/key&gt;</code></p>
<p class="normal"><code class="inlineCode">&lt;string&gt;2&lt;/string&gt;</code></p>
</td>
</tr>
<tr>
<td class="table-cell">
<p class="normal">Configuration file</p>
</td>
<td class="table-cell">
<p class="normal"><code class="inlineCode">AndroidManifest.xml</code></p>
</td>
<td class="table-cell">
<p class="normal"><code class="inlineCode">Package.appxmanifest</code></p>
</td>
<td class="table-cell" colspan="2">
<p class="normal"><code class="inlineCode">Info.plost</code></p>
</td>
</tr>
</tbody>
</table>
<p class="packt_figref">Table 12.1: The build configuration</p>
<p class="normal"><em class="italic">Table 12.1</em> outlines how to identify an app using the <code class="inlineCode">ApplicationId</code> and <code class="inlineCode">ApplicationVersion</code> variables defined in the Visual Studio project file. For each platform, a specific platform configuration file is used.</p>
<p class="normal">For Android<a id="_idIndexMarker908"/> distribution, either a <code class="inlineCode">.apk</code> file or <code class="inlineCode">.aab</code> file is generated. The <code class="inlineCode">.apk</code> file is the original Android package format used to install app packages on devices or emulators, while the <code class="inlineCode">.aab</code> file is used for submission to Google Play Store. Before submission, we need to sign the package using a Keystore. <code class="inlineCode">ApplicationId</code> and <code class="inlineCode">ApplicationVersion</code> are mapped to a package ID and version code in the Android configuration file <code class="inlineCode">AndroidManifest.xml</code>.</p>
<p class="normal">For iOS or macOS distribution, a <code class="inlineCode">.ipa</code> file is generated for iOS, and either a <code class="inlineCode">.app</code> or <code class="inlineCode">.pkg</code> file is generated for macOS. To sign an iOS or macOS package, we need a distribution certificate and a distribution profile. The <code class="inlineCode">ApplicationId</code> is mapped to the bundle ID, and <code class="inlineCode">ApplicationVersion</code> is mapped to the bundle version in <code class="inlineCode">Info.plist</code>.</p>
<p class="normal">For Windows <a id="_idIndexMarker909"/>distribution, the MSIX package format is used, and the package is built with the <code class="inlineCode">.msix</code> file extension. Windows employs a <strong class="keyWord">universally unique identifier</strong> (<strong class="keyWord">UUID</strong>) as the <code class="inlineCode">ApplicationId</code>, which is generated as <code class="inlineCode">ApplicationGuid</code>. </p>
<p class="normal">The <code class="inlineCode">ApplicationVersion</code> is mapped to the <code class="inlineCode">Version</code> attribute of the <code class="inlineCode">Identity</code> tag in <code class="inlineCode">Package.appxmanifest</code>.</p>
<div><p class="normal"><strong class="keyWord">What is MSIX?</strong></p>
<p class="normal">MSIX<a id="_idIndexMarker910"/> is a modern Windows app package format designed for all Windows apps. It aims to provide a more reliable and secure installation process, along with enhanced system resource usage and simplified updates. MSIX allows developers to package and distribute their applications through various channels, including Microsoft Store, web, or third-party platforms.</p>
<p class="normal">For more<a id="_idIndexMarker911"/> information on MSIX, please refer to the Microsoft documentation: <a href="https://learn.microsoft.com/en-us/windows/msix/overview">https://learn.microsoft.com/en-us/windows/msix/overview</a>.</p>
</div>
<p class="normal">In the following sections, we will explain how to generate release packages for each platform. We will build Windows and Android packages on Windows, while iOS and macOS packages will be built on macOS. We will demonstrate how to accomplish this using both Visual Studio and the command line.</p>
<h2 class="heading-2" id="_idParaDest-312">Publishing to Microsoft Store</h2>
<p class="normal">We can build a <code class="inlineCode">.msix</code> package for <a id="_idIndexMarker912"/>Microsoft Store using <a id="_idIndexMarker913"/>either Visual Studio or the command line on Windows.</p>
<p class="normal">In Visual Studio, we need to set the target framework as <code class="inlineCode">net8.0-windows10.0.19041.0</code> and set the build type to <code class="inlineCode">Release</code>.</p>
<p class="normal">After that, we can right-click on the project node and select the <code class="inlineCode">Publish… </code>menu item.</p>
<p class="normal">A window will appear with the <strong class="screenText">Select distribution method</strong> option (<em class="italic">Figure 12.1</em>). Here, select <strong class="screenText">Microsoft Store under a new app name</strong> and click the <strong class="screenText">Next</strong> button:</p>
<figure class="mediaobject"><img alt="A screenshot of a computer  Description automatically generated" height="707" src="img/B21554_12_01.png" width="825"/></figure>
<p class="packt_figref">Figure 12.1: Select distribution method</p>
<p class="normal">Before proceeding to the next step, as shown in <em class="italic">Figure 12.2</em>, we need to have an app name ready.</p>
<p class="normal">To create<a id="_idIndexMarker914"/> a new <a id="_idIndexMarker915"/>app name, follow these steps:</p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1">Visit <strong class="keyWord">Microsoft Store Developer Dashboard</strong> at the <a id="_idIndexMarker916"/>following URL: <a href="https://partner.microsoft.com/en-us/dashboard/">https://partner.microsoft.com/en-us/dashboard/</a>.</li>
<li class="numberedList">Register and create a new app name.</li>
</ol>
<p class="normal">Once we have an app name, we can associate it with our app, as shown in <em class="italic">Figure 12.2</em>:</p>
<figure class="mediaobject"><img alt="Figure 12.2: Associating your app with Microsoft Store" height="472" src="img/B21554_12_02.png" width="825"/></figure>
<p class="packt_figref">Figure 12.2: Associating your app with Microsoft Store</p>
<p class="normal">After <a id="_idIndexMarker917"/>clicking the <strong class="screenText">Next</strong> button, Visual <a id="_idIndexMarker918"/>Studio will search for the app name in Microsoft Store. The app name created in Microsoft Store, as shown in <em class="italic">Figure 12.3</em>, will be retrieved for you to continue the publishing process:</p>
<figure class="mediaobject"><img alt="Figure 12.3: Selecting an app name" height="761" src="img/B21554_12_03.png" width="825"/></figure>
<p class="packt_figref">Figure 12.3: Selecting an app name</p>
<p class="normal">After <a id="_idIndexMarker919"/>selecting the app name, click the <strong class="screenText">Next</strong> button. A<a id="_idIndexMarker920"/> screen to select and configure packages will appear, as shown in <em class="italic">Figure 12.4</em>. Here, we can choose the packages for our app and configure additional settings before proceeding with the publication process.</p>
<figure class="mediaobject"><img alt="Figure 12.4: Selecting and configuring packages" height="751" src="img/B21554_12_04.png" width="825"/></figure>
<p class="packt_figref">Figure 12.4: Selecting and configuring packages</p>
<p class="normal">To<a id="_idIndexMarker921"/> continue the process, we need to create a<a id="_idIndexMarker922"/> publish profile here. To create an MSIX publish profile, follow these steps:</p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1">Click on the drop-down menu under <strong class="screenText">Publishing profile</strong>. A dialog will be displayed, as shown in <em class="italic">Figure 12.4</em>.</li>
<li class="numberedList">Clicking the <strong class="screenText">OK</strong> button in the dialog box to create a new MSIX publish profile.</li>
</ol>
<p class="normal">Once <a id="_idIndexMarker923"/>we have a publish profile, click on<a id="_idIndexMarker924"/> the <strong class="screenText">Create</strong> button (which will now be active) to create the package. The build and package creation process may take some time. Upon completion, we will see a screen similar to the one depicted in <em class="italic">Figure 12.5</em>, indicating that the MSIX package is ready for submission.</p>
<figure class="mediaobject"><img alt="Figure 12.5: An MSIX package" height="665" src="img/B21554_12_05.png" width="825"/></figure>
<p class="packt_figref">Figure 12.5: An MSIX package</p>
<p class="normal">The location of the new package is shown in <em class="italic">Figure 12.5</em>. There is an option to verify the package by running the <strong class="screenText">Windows App Certification Kit.</strong></p>
<p class="normal">In the preceding steps, two files related to the app’s publication will have been created in the <code class="inlineCode">project</code> folder:</p>
<ul>
<li class="bulletList"><code class="inlineCode">Package.StoreAssociation.xml</code>: this file associates the app with Microsoft Store.</li>
<li class="bulletList"><code class="inlineCode">Properties\PublishProfiles\MSIX-win10-x86.pubxml</code>: this is the publish profile.</li>
</ul>
<p class="normal">Both files may contain sensitive information, so they should not be checked into the Git repository.</p>
<p class="normal">To integrate the build process in the CI/CD environment, we need to execute the build process using the command line. To build a <code class="inlineCode">.msix</code> package using the command line, execute the following command from the project folder:</p>
<pre class="programlisting con"><code class="hljs-con">dotnet publish PassXYZ.Vault/PassXYZ.Vault.csproj -c Release -f net8.0-windows10.0.19041.0
</code></pre>
<p class="normal">Once<a id="_idIndexMarker925"/> the <code class="inlineCode">.msix</code> package is built, we can <a id="_idIndexMarker926"/>upload it to Microsoft Store in the <code class="inlineCode">Packages</code> section of the app submission.</p>
<h2 class="heading-2" id="_idParaDest-313">Publishing to Google Play Store</h2>
<p class="normal">To prepare for submission to<a id="_idIndexMarker927"/> Google Play Store, you <a id="_idIndexMarker928"/>need to create a new app in the Google Play Console. A Google account is required to create a new app in the Google Play Console.</p>
<p class="normal">Every Android app has a unique application ID or package ID, which is defined in the configuration file, <code class="inlineCode">AndroidManifest.xml</code>. This configuration file is generated by Visual Studio from the project file and can be found at <code class="inlineCode">Platforms/Android/AndroidManifest.xml</code>. Let’s review the <code class="inlineCode">AndroidManifest.xml</code> of our app in <em class="italic">Listing 12.1</em>:</p>
<pre class="programlisting code"><code class="hljs-code">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest
  xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.passxyz.vault2"                                    //(1)
  android:installLocation="auto"
  android:versionCode="1"&gt;                                        //(2)
  &lt;application
    android:allowBackup="true"
    android:icon="@mipmap/appicon"
    android:roundIcon="@mipmap/appicon_round"
    android:supportsRtl="true"&gt;&lt;/application&gt;
  &lt;uses-permission
    android:name="android.permission.ACCESS_NETWORK_STATE" /&gt;
  &lt;uses-permission android:name=
    "android.permission.INTERNET" /&gt;
&lt;/manifest&gt;
</code></pre>
<p class="packt_figref">Listing 12.1: <code class="inlineCode">AndroidManifest.xml</code> (<a href="https://epa.ms/AndroidManifest12-1">https://epa.ms/AndroidManifest12-1</a>)</p>
<p class="normal">In our app, the application ID is <code class="inlineCode">"com.passxyz.vault2"</code> <strong class="keyWord">(1)</strong>, which is generated from <code class="inlineCode">ApplicationId</code>, and the version is the value of <code class="inlineCode">android:versionCode</code> <strong class="keyWord">(2)</strong>, which is generated from <code class="inlineCode">ApplicationVersion</code>.</p>
<p class="normal">The declaration of the app identifier and version can be found in the <code class="inlineCode">PassXYZ.Vault.csproj</code> project file:</p>
<pre class="programlisting code"><code class="hljs-code">&lt;!-- App Identifier --&gt;
&lt;ApplicationId&gt;com.passxyz.vault2&lt;/ApplicationId&gt;
&lt;ApplicationIdGuid&gt;8606B3B5-C03C-41D7-825F-B33718CF791C
  &lt;/ApplicationIdGuid&gt;
&lt;!-- Versions --&gt;
&lt;ApplicationDisplayVersion&gt;1.0&lt;/ApplicationDisplayVersion&gt;
&lt;ApplicationVersion&gt;1&lt;/ApplicationVersion&gt;
</code></pre>
<p class="normal">To sign an <a id="_idIndexMarker929"/>Android package, we <a id="_idIndexMarker930"/>need to create a Keystore file. For information on creating a Keystore file and signing an Android app, refer to the following Android documentation: <a href="https://developer.android.com/studio/publish/app-signing">https://developer.android.com/studio/publish/app-signing</a>.</p>
<p class="normal">Once we have a Keystore file and have prepared the required configuration, follow these steps in Visual Studio:</p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1">Set the target framework as <code class="inlineCode">net8.0-android</code> and the build type as <code class="inlineCode">Release</code>.</li>
<li class="numberedList">Right-click the project node and select <strong class="screenText">Publish…</strong>.</li>
</ol>
<p class="normal">After completing these steps, the build will start, and an archive will be created, as shown in <em class="italic">Figure 12.6</em>:</p>
<figure class="mediaobject"><img alt="Figure 12.6: Creating an archive for Android" height="439" src="img/B21554_12_06.png" width="825"/></figure>
<p class="packt_figref">Figure 12.6: Creating an archive for Android</p>
<p class="normal">After the<a id="_idIndexMarker931"/> package is created, we <a id="_idIndexMarker932"/>can sign it by clicking the <strong class="screenText">Distribute…</strong> button. Then, we will need to choose a distribution channel, as shown in <em class="italic">Figure 12.7</em>:</p>
<figure class="mediaobject"><img alt="Figure 12.7: Selecting a channel" height="649" src="img/B21554_12_07.png" width="825"/></figure>
<p class="packt_figref">Figure 12.7: Selecting a channel</p>
<p class="normal">Although it is<a id="_idIndexMarker933"/> possible to sign and submit the <a id="_idIndexMarker934"/>package by selecting <strong class="screenText">Google Play</strong>, we will choose <strong class="screenText">Ad Hoc</strong> for signing. We will manually submit the signed package to Google Play later.</p>
<p class="normal">Upon selecting <code class="inlineCode">Ad Hoc</code>, we will be presented with a different screen, as shown in <em class="italic">Figure 12.8</em>, where we can proceed with the process of signing our Android package:</p>
<figure class="mediaobject"><img alt="Figure 12.8: Signing Identity using a Keystore file" height="649" src="img/B21554_12_08.png" width="825"/></figure>
<p class="packt_figref">Figure 12.8: Signing Identity using a Keystore file</p>
<p class="normal">As shown in <em class="italic">Figure 12.8</em>, click <a id="_idIndexMarker935"/>the <strong class="screenText">+</strong> button to add a<a id="_idIndexMarker936"/> Keystore file. After adding the Keystore file, click the <strong class="screenText">Save As</strong> button to sign the package.</p>
<p class="normal">The signed <code class="inlineCode">.aab</code> file can be submitted to Google Play Store through the Google Play Console.</p>
<p class="normal">If you don’t have an existing Keystore file, you can follow the guide mentioned earlier to create a new one. The default location of Keystore files is <code class="inlineCode">%USERPROFILE%\AppData\Local\Xamarin\Mono for Android\Keystore\</code>.</p>
<p class="normal">It’s critical to <a id="_idIndexMarker937"/>securely store your keystore file <a id="_idIndexMarker938"/>and password, as they will be required again when you submit an updated version of your application to the App Store.</p>
<p class="normal">If you select the <strong class="keyWord">Google Play</strong> option in <em class="italic">Figure 12.7</em>, the screen displayed is as shown in <em class="italic">Figure 12.9</em>. You will then need to access the Google Play API using your <strong class="screenText">Client Id</strong> and <strong class="screenText">Client Secret</strong>. Despite the <strong class="keyWord">Google Play</strong> and <strong class="keyWord">Ad Hoc</strong> options sharing strong similarities, selecting <strong class="keyWord">Google Play</strong> allows you to automatically submit the build result to Google Play Store:</p>
<figure class="mediaobject"><img alt="A screenshot of a computer  Description automatically generated" height="600" src="img/B21554_12_09.png" width="825"/></figure>
<p class="packt_figref">Figure 12.9: Connect to Google Play Store using your Client ID and Client Secret</p>
<p class="normal">To create the package from the command line, execute the following command in the project folder:</p>
<pre class="programlisting con"><code class="hljs-con">dotnet publish PassXYZ.Vault/PassXYZ.Vault.csproj -c Release -f net8.0-android
</code></pre>
<p class="normal">To learn how to upload a signed Android app bundle to Google Play Store, please refer to the following Android document: <a href="https://developer.android.com/studio/publish/upload-bundle">https://developer.android.com/studio/publish/upload-bundle</a>.</p>
<h2 class="heading-2" id="_idParaDest-314">Publishing to Apple’s App Store</h2>
<p class="normal">We can discuss the <a id="_idIndexMarker939"/>submission of an iOS <a id="_idIndexMarker940"/>or macOS app to the App Store simultaneously, since they share many similarities.</p>
<p class="normal">In this section, we will be discussing the process of building, signing, and deploying .NET MAUI apps for iOS and macOS using a macOS environment.</p>
<p class="normal">Building, signing, and deploying .NET MAUI apps for iOS or macOS requires specific tooling and environments, due to Apple’s requirements. Here’s what you need:</p>
<ul>
<li class="bulletList"><strong class="keyWord">macOS</strong>: Because of Apple’s restrictions, you must build iOS and macOS applications on a Mac. This can be a local machine, or you could use a cloud macOS environment like GitHub Actions or Azure Pipelines, which offers hosted macOS agents.</li>
<li class="bulletList"><strong class="keyWord">Xcode</strong>: Install the latest stable version of Xcode. This is required for iOS SDKs and simulators. </li>
<li class="bulletList"><strong class="keyWord">.NET 8</strong>: .NET MAUI is built on .NET 8, so you will need the .NET 8 SDK installed.</li>
<li class="bulletList"><strong class="keyWord">MAUI</strong>: Install the latest stable version of .NET MAUI, including the .NET MAUI workload and templates.</li>
<li class="bulletList"><strong class="keyWord">Apple Developer account</strong>: To sign and deploy an app to the App Store, you will need an Apple Developer account. This requires an annual subscription fee but is necessary to distribute your apps to users.</li>
<li class="bulletList"><strong class="keyWord">Provisioning profiles and certificates</strong>: To sign your app, you will need a provisioning profile and a matching distribution certificate. You can create and manage these in the Apple Developer portal or automatically manage them through Xcode. For details on how to create a signing certificate and a provisioning profile, refer to the following document: <a href="https://learn.microsoft.com/en-us/dotnet/maui/ios/deployment/provision">https://learn.microsoft.com/en-us/dotnet/maui/ios/deployment/provision</a>.</li>
</ul>
<p class="normal">To<a id="_idIndexMarker941"/> simultaneously fulfill the needs <a id="_idIndexMarker942"/>of Xamarin and .NET MAUI builds, you might have multiple Xcode installations on your macOS. You can check for all Xcode installations on your Mac with the following command:</p>
<pre class="programlisting con"><code class="hljs-con">% ls /Applications | grep 'Xcode'
Xcode.app
Xcode_14.3.1.app
Xcode_15.2.app
</code></pre>
<p class="normal">To check the currently selected Xcode, you can use this command:</p>
<pre class="programlisting con"><code class="hljs-con">% xcrun xcode-select–print-path
/Applications/Xcode_15.2.app/Contents/Developer
</code></pre>
<p class="normal">If you need to choose a specific Xcode version, the following command can be used:</p>
<pre class="programlisting con"><code class="hljs-con">% sudo xcode-select -s /Applications/Xcode.app
</code></pre>
<p class="normal">Once these tools are installed and set up, you can build, sign, and deploy your .NET MAUI apps for iOS or macOS using the .NET CLI for command-line builds and deployments.</p>
<p class="normal">In iOS or macOS apps, the bundler identifier and bundler version are used to identify an app. This information is stored in the <code class="inlineCode">Info.plist</code> configuration file. The bundler identifier is generated from <code class="inlineCode">ApplicationId</code>, and the bundler version is generated from <code class="inlineCode">ApplicationVersion</code> in the Visual Studio project file.</p>
<p class="normal">iOS apps can be distributed exclusively through the App Store. The package for submission is a file with the <code class="inlineCode">.ipa</code> extension. Although macOS apps can also be distributed through the App Store, their packages can be installed directly.</p>
<p class="normal">Although some publishing steps can be performed in a Windows environment, you still need to connect to a network-accessible macOS computer. To reduce the complexity, we use a macOS environment to build both iOS and macOS apps. Before building the packages, we need to update the Visual Studio project file to configure our own signing certificate and distribution profile:</p>
<pre class="programlisting code"><code class="hljs-code">&lt;PropertyGroup Condition="$(TargetFramework.Contains('-ios')) and '$(Configuration)' == 'Release'"&gt;
  &lt;RuntimeIdentifier&gt;ios-arm64&lt;/RuntimeIdentifier&gt;
  &lt;CodesignKey&gt;iPhone Distribution: Shugao Ye (W9WL9WPD24)
  &lt;/CodesignKey&gt;
  &lt;CodesignProvision&gt;passxyz_2023&lt;/CodesignProvision&gt;
&lt;/PropertyGroup&gt;
&lt;PropertyGroup Condition="$(TargetFramework.Contains('-
  maccatalyst')) and '$(Configuration)' == 'Release'"&gt;
  &lt;CodesignEntitlement&gt;Entitlements.plist
  &lt;/CodesignEntitlement&gt;
  &lt;CodesignKey&gt;
    3rd Party Mac Developer Application: Shugao Ye
      (W9WL9WPD24)
  &lt;/CodesignKey&gt;
  &lt;CodesignProvision&gt;passxyz.maccatalyst&lt;/CodesignProvision&gt;
&lt;/PropertyGroup&gt;
</code></pre>
<p class="normal">As shown, you can use conditional configuration for both iOS and macOS builds. Different signing certificates and distribution profiles are used for iOS and macOS.</p>
<p class="normal">If you are <a id="_idIndexMarker943"/>not sure whether the settings are <a id="_idIndexMarker944"/>correct, you can verify them using <code class="inlineCode">Xcode</code>. Creating an app in Xcode involves using the same <code class="inlineCode">"com.passxyz.vault2"</code> bundler ID as our app. After that, check the configuration of <strong class="screenText">Signing</strong>, as shown in <em class="italic">Figure 12.10</em>. This process allows you to compare the signing configurations between your Visual Studio project and the equivalent in Xcode, helping to identify any discrepancies or issues with the setup.</p>
<figure class="mediaobject"><img alt="Figure 12.10: The iOS signing settings in Xcode" height="322" src="img/B21554_12_10.png" width="825"/></figure>
<p class="packt_figref">Figure 12.10: The iOS signing settings in Xcode</p>
<p class="normal">If there are any issues with the signing certificate or provisioning profile, error messages will be reported by Xcode. Once the settings are correct in Xcode, the same settings can be used in the Visual Studio project without any issues.</p>
<p class="normal">With all the configurations ready, we can build the <code class="inlineCode">.ipa</code> file in the project folder using the following command:</p>
<pre class="programlisting con"><code class="hljs-con">dotnet publish PassXYZ.Vault/PassXYZ.Vault.csproj -c Release -f net8.0-ios /p:CreatePackage=true /p:ArchiveOnBuild=True
</code></pre>
<p class="normal">Once the command executes successfully, an <code class="inlineCode">.ipa</code> file is generated. We can submit this file to the App Store. There are three methods that can be used to upload a package to the App Store. For more details, please refer to the following documentation: <a href="https://developer.apple.com/help/app-store-connect/manage-builds/upload-builds">https://developer.apple.com/help/app-store-connect/manage-builds/upload-builds</a>.</p>
<p class="normal">From the documentation, we<a id="_idIndexMarker945"/> know<a id="_idIndexMarker946"/> that we can use <strong class="keyWord">Xcode</strong>, <strong class="keyWord">altool</strong>, or <strong class="keyWord">Transporter</strong> to<a id="_idIndexMarker947"/> upload a package.</p>
<p class="normal">As we are <a id="_idIndexMarker948"/>not directly utilizing Xcode to <a id="_idIndexMarker949"/>construct the .NET MAUI app, we will not employ Xcode to upload the build to Apple Store. If the goal is to establish a comprehensive CI/CD solution, <strong class="keyWord">altool</strong> can be used to upload the build to Apple Store. </p>
<p class="normal">However, in this<a id="_idIndexMarker950"/> chapter, our primary focus is on <strong class="keyWord">Continuous Integration</strong> (<strong class="keyWord">CI</strong>), leaving <strong class="keyWord">Continuous Delivery</strong> (<strong class="keyWord">CD</strong>) for you to delve into<a id="_idIndexMarker951"/> independently. The setup for CD often requires more account-specific configurations.</p>
<p class="normal">We will use the Transporter app here. After signing in to the Transporter app, we can upload the package to the App Store, as shown in <em class="italic">Figure 12.11</em>:</p>
<figure class="mediaobject"><img alt="Figure 12.11: Uploading a package using the Transporter app" height="619" src="img/B21554_12_11.png" width="825"/></figure>
<p class="packt_figref">Figure 12.11: Uploading a package using the Transporter app</p>
<p class="normal">The <a id="_idIndexMarker952"/>building and uploading processes of a macOS package are similar to those for an iOS app. There are three different<a id="_idIndexMarker953"/> frameworks (AppKit, Mac Catalyst, and SwiftUI) that can be employed to build macOS apps. In .NET MAUI, Mac Catalyst is used for platform-specific implementation.</p>
<p class="normal">By default, App Sandbox is not enabled in Mac Catalyst apps, so we need to enable it. To enable it in the macOS app, we need to add an <code class="inlineCode">Entitlements.plist</code> file to the build configuration. </p>
<p class="normal">We can review the <code class="inlineCode">Entitlements.plist</code> file in <em class="italic">Listing 12.2</em>:</p>
<pre class="programlisting code"><code class="hljs-code">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN"
  "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
  &lt;key&gt;com.apple.security.app-sandbox&lt;/key&gt;
  &lt;true/&gt;
  &lt;key&gt;com.apple.security.files.user-selected.read-only
    &lt;/key&gt;
  &lt;true/&gt;
  &lt;key&gt;com.apple.security.network.client&lt;/key&gt;
  &lt;true/&gt;
&lt;/dict&gt;
&lt;/plist&gt;
</code></pre>
<p class="packt_figref">Listing 12.2: <code class="inlineCode">Entitlements.plist</code> (<a href="https://epa.ms/Entitlements12-2">https://epa.ms/Entitlements12-2</a>)</p>
<p class="normal">Just like <a id="_idIndexMarker954"/>in the iOS build, we can verify<a id="_idIndexMarker955"/> the configuration for the macOS build in Xcode, as shown in <em class="italic">Figure 12.12</em>. By doing this, you ensure that the proper signing and provisioning setup is in place for our macOS app, before building and submitting it to the App Store.</p>
<figure class="mediaobject"><img alt="Figure 12.12: The macOS app’s Signing settings in Xcode" height="355" src="img/B21554_12_12.png" width="825"/></figure>
<p class="packt_figref">Figure 12.12: The macOS app’s Signing settings in Xcode</p>
<p class="normal">With all configurations ready, we can build the package in our project folder using the following command:</p>
<pre class="programlisting con"><code class="hljs-con">dotnet publish PassXYZ.Vault/PassXYZ.Vault.csproj -c Release -f net8.0-maccatalyst  /p:CreatePackage=true /p:EnablePackageSigning=true"
</code></pre>
<p class="normal">After successfully building the package, we can upload the <code class="inlineCode">.pkg</code> file to the App Store using the Transporter app, as shown in <em class="italic">Figure 12.13</em>. This will demonstrate that both iOS and macOS packages have been successfully uploaded to the App Store. You can then proceed to App Store Connect to complete the rest of the submission process.</p>
<figure class="mediaobject"><img alt="Figure 12.13: Uploading the macOS app using the Transporter app" height="616" src="img/B21554_12_13.png" width="825"/></figure>
<p class="packt_figref">Figure 12.13: Uploading the macOS app using the Transporter app</p>
<p class="normal">After uploading <a id="_idIndexMarker956"/>packages to Microsoft Store, Google <a id="_idIndexMarker957"/>Play Store, and Apple App Store, we can test the uploaded packages before the final release using the testing tools provided by the stores:</p>
<ul>
<li class="bulletList"><strong class="keyWord">Apple App Store</strong>: <strong class="keyWord">TestFlight</strong> can be used to test iOS/macOS apps before the production release</li>
<li class="bulletList"><strong class="keyWord">Google Play Store</strong>: Alpha or beta testing can be set up before the production release</li>
<li class="bulletList"><strong class="keyWord">Microsoft Store</strong>: Package flights can be used on Microsoft Store to test uploaded packages</li>
</ul>
<p class="normal">Now that we have learned the basic steps of preparing application packages for supported platforms, we can explore setting up the automated build of .NET MAUI app in a <code class="inlineCode">CI/CD</code> environment, such as GitHub Actions or Azure DevOps. Implementing CI/CD can streamline the development and deployment process, ensuring that your app is continuously tested, built, and ready for release as you make updates and improvements.</p>
<h1 class="heading-1" id="_idParaDest-315">GitHub Actions</h1>
<p class="normal">Since our source code is hosted on GitHub, let’s use <a id="_idIndexMarker958"/>GitHub Actions as an example to introduce you to how to set up CI workflows for .NET MAUI development. GitHub Actions is an automation platform that can help streamline and automate essential tasks related to your project, like building, testing, and deploying code updates. This powerful feature ensures that your code remains verified and ready for deployment at any time, allowing developers to focus on writing new features and fixing bugs while maintaining quality assurance.</p>
<h2 class="heading-2" id="_idParaDest-316">Understanding GitHub Actions</h2>
<p class="normal">For .NET MAUI app development, our<a id="_idIndexMarker959"/> target is to build, test, and deploy our apps to app stores or specified publishing channels. In this section, we will focus on CI using GitHub Actions rather than both CI and CD. To deploy apps to various stores, there are many account-specific setup steps; please refer to the .NET MAUI document for the details: <a href="https://learn.microsoft.com/en-us/dotnet/maui/deployment/">https://learn.microsoft.com/en-us/dotnet/maui/deployment/</a>.</p>
<p class="normal">A GitHub Actions workflow is a process that automatically builds and deploys the deliverables from a project. The workflow usually starts from an event such as a <code class="inlineCode">push</code> or <code class="inlineCode">pull_request</code> event, or when an issue is submitted. Once a workflow is triggered, the defined jobs will start to perform certain tasks inside a runner. Each job consists of one or more steps that either run a script or an action.</p>
<p class="normal">In summary, GitHub Actions includes events, runners, jobs/steps, actions, and runners. These components work together to automate various tasks in your development and deployment process, making it more efficient and less error prone.</p>
<h3 class="heading-3" id="_idParaDest-317">Workflows</h3>
<p class="normal">GitHub <a id="_idIndexMarker960"/>Actions workflows<a id="_idIndexMarker961"/> are defined by a YAML file in the <code class="inlineCode">.github/workflows</code> directory. YAML is a superset of JSON and provides a more human-readable language. A repository can have one or multiple workflows to perform different jobs. Refer to <em class="italic">Figure 12.14</em> to understand the workflow defined in the <code class="inlineCode">PassXYZ.Vault</code> project.</p>
<figure class="mediaobject"><img alt="Figure 12.14: The workflow of Windows runner" height="222" src="img/B21554_12_14.png" width="825"/></figure>
<p class="packt_figref">Figure 12.14: The workflow of Windows runner</p>
<p class="normal">As seen in <em class="italic">Figure 12.14</em>, this example illustrates how a workflow performs Android and Windows builds. A workflow is triggered by a <code class="inlineCode">push</code> or <code class="inlineCode">pull_request</code> event, or manually. It runs inside a Windows runner to perform the builds. When the workflow is triggered, two jobs, <strong class="keyWord">Android Build</strong> and <strong class="keyWord">Windows Build</strong>, begin execution. Each job includes four steps to perform the build, as depicted in <em class="italic">Figure 12.14</em>.</p>
<p class="normal">In our project, we defined the two following workflows:</p>
<ul>
<li class="bulletList"><code class="inlineCode">passxyz-ci-macos.yml</code>: This is a workflow to build iOS and macOS on a macOS runner.</li>
<li class="bulletList"><code class="inlineCode">passxyz-ci-windows.yml</code>: This is a workflow to build Android and Windows on a Windows runner.</li>
</ul>
<p class="normal">We <a id="_idIndexMarker962"/>can see the <a id="_idIndexMarker963"/>YAML files in <em class="italic">Listing 12.3</em> and <em class="italic">Listing 12.4</em>:</p>
<pre class="programlisting code"><code class="hljs-code">name: PassXYZ.Vault CI Build (Windows)
on:                                                                //(1)
  push:                                                            //(2)
    branches: [ chapter12 ]
    paths-ignore:
      - '**/*.md'
      - '**/*.gitignore'
      - '**/*.gitattributes'
  pull_request:                                                    //(3)
    branches: [ chapter12 ]
  workflow_dispatch:                                               //(4)
permissions:
  contents: read
env:
  DOTNET_NOLOGO: true
  DOTNET_SKIP_FIRST_TIME_EXPERIENCE: true
  DOTNET_CLI_TELEMETRY_OPTOUT: true
  DOTNETVERSION: 8.0.x
  DOTNETSDK: 'net8.0'
  PROJECT_NAME: PassXYZ.Vault
jobs:                                                              //(5)
# MAUI Android Build
  build-android:                                                   //(6)
    runs-on: windows-latest                                        //(7)
    name: Android Build
    steps:                                                         //(8)
      - name: Checkout
        uses: actions/checkout@v3                                  //(9)
      - name: Setup .NET
        uses: actions/setup-dotnet@v2
        with:
          dotnet-version: ${{env.DOTNETVERSION}}
      - name: Install MAUI workload
        run: dotnet workload install maui   
      - name: Restore Dependencies
        run: dotnet restore ${{env.PROJECT_NAME}}/$
          {{env.PROJECT_NAME}}.csproj
      - name: Build MAUI Android
        run: dotnet publish ${{env.PROJECT_NAME}}/$
          {{env.PROJECT_NAME}}.csproj -c Release -f ${{env.DOTNETSDK}}-android --no-restore
      - name: Upload Android Artifact
        uses: actions/upload-artifact@v3
        with:
          name: passxyz-android-ci-build
          path: ${{env.PROJECT_NAME}}/bin/Release/
${{env.DOTNETSDK}}-android/*Signed.a*
# MAUI Windows Build
  build-windows:
    runs-on: windows-latest
    name: Windows Build
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Setup .NET
        uses: actions/setup-dotnet@v2
        with:
          dotnet-version: ${{env.DOTNETVERSION}}
      - name: Install MAUI workload
        run: dotnet workload install maui   
      - name: Restore Dependencies
        run: dotnet restore ${{env.PROJECT_NAME}}
          /${{env.PROJECT_NAME}}.csproj
      - name: Build MAUI Windows
        run: dotnet publish ${{env.PROJECT_NAME}}/
${{env.PROJECT_NAME}}.csproj -c Release -f ${{env.DOTNETSDK}}-windows10.0.19041.0
      - name: Upload Windows Artifact
        uses: actions/upload-artifact@v3
        with:
          name: passxyz-windows-ci-build
          path: ${{env.PROJECT_NAME}}/...
</code></pre>
<p class="packt_figref">Listing 12.3: <code class="inlineCode">passxyz-ci-windows.yml</code> (<a href="https://epa.ms/passxyz-ci-windows12-3">https://epa.ms/passxyz-ci-windows12-3</a>)</p>
<p class="normal">These <a id="_idIndexMarker964"/>workflow files define the steps necessary to automate the build<a id="_idIndexMarker965"/> process for different target platforms, helping ensure that our .NET MAUI app is always ready for deployment.</p>
<p class="normal">In the following sessions, we will now analyze it in detail, providing insights into how these workflows help automate the build process for your .NET MAUI app. Understanding the structure and functionality of these workflow files will enable you to customize and enhance your development pipeline, ensuring that your app is always ready for deployment and matches your specific requirements.</p>
<h3 class="heading-3" id="_idParaDest-318">Events</h3>
<p class="normal">Events<a id="_idIndexMarker966"/> are crucial in <a id="_idIndexMarker967"/>triggering the workflow, and they are defined after the <code class="inlineCode">on:</code> keyword <strong class="keyWord">(1)</strong>. In the previous workflow, we defined the <code class="inlineCode">push</code> <strong class="keyWord">(2)</strong>, <code class="inlineCode">pull_request</code> <strong class="keyWord">(3)</strong> and <code class="inlineCode">workflow_dispatch</code> <strong class="keyWord">(4)</strong> events. For both <code class="inlineCode">push</code> and <code class="inlineCode">pull_request</code> events, we monitor the activities on the main branch, and we also don’t ignore any build-related commits such as markdown files or configuration files. </p>
<p class="normal">For more information on<a id="_idIndexMarker968"/> events that can be used to trigger workflows, please refer to the <a id="_idIndexMarker969"/>following GitHub documentation: <a href="https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows">https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows</a>.</p>
<p class="normal">Understanding the events triggering workflows enables you to customize when specific actions should be executed in response to changes in your project. This helps maintain your app’s quality while accommodating the unique needs of your development process.</p>
<h3 class="heading-3" id="_idParaDest-319">Jobs</h3>
<p class="normal">When a workflow is triggered, it initiates <a id="_idIndexMarker970"/>the execution of the defined jobs. Jobs<a id="_idIndexMarker971"/> are defined after the <code class="inlineCode">jobs</code>: <strong class="keyWord">(5)</strong> keyword. One or more jobs can be defined within a workflow, each identified by a job ID, such as <code class="inlineCode">build-android</code> <strong class="keyWord">(6)</strong>. In <em class="italic">Listing 12.3</em>, there are two jobs, <code class="inlineCode">build-android</code> and <code class="inlineCode">build-windows</code>. Each job can define a name, a runner, and multiple steps.</p>
<p class="normal">Jobs are the core components of a workflow, containing a sequence of tasks that need to be executed when certain events occur. By defining jobs specific to your app’s development needs, you can ensure that the correct actions are taken during the build process, leading to a smoother and more efficient development pipeline.</p>
<h3 class="heading-3" id="_idParaDest-320">Runners</h3>
<p class="normal">A runner<a id="_idIndexMarker972"/> is the type of<a id="_idIndexMarker973"/> platform that runs the job. In our configuration, both Android and Windows jobs are executed using Windows runners. The runner is defined after the <code class="inlineCode">runs-on</code>: <strong class="keyWord">(7)</strong> keyword. For more information on the configuration of runners, please refer to the GitHub Actions documentation. The runner that we use is <code class="inlineCode">windows-latest</code>, which is the label of the runner image.</p>
<p class="normal">Choosing the right runner for your jobs is essential for ensuring that your app builds correctly and efficiently. By understanding the available runner options and their pre-installed tools, you can better tailor your development pipeline to the unique needs of your .NET MAUI app.</p>
<h3 class="heading-3" id="_idParaDest-321">Steps</h3>
<p class="normal">Multiple steps<a id="_idIndexMarker974"/> can be <a id="_idIndexMarker975"/>defined within a job, and they are defined after the <code class="inlineCode">steps</code>: <strong class="keyWord">(8)</strong> keyword. In both Android and Windows builds, there are multiple steps: <em class="italic">checkout</em>, <em class="italic">install .NET MAUI workload</em>, <em class="italic">restore dependencies</em>, <em class="italic">build</em>, and <em class="italic">upload</em>. Each step can run a script or an action. In the checkout step, a <code class="inlineCode">checkout</code> action is used after the <code class="inlineCode">uses:</code> <strong class="keyWord">(9)</strong> keyword. An action is a custom application in the GitHub Actions platform to perform a complex but frequent repeated task. Using actions allows for code reuse, similar to how components function in object-oriented programming. To use an action, simply specify the action name with an optional version number. In our script, we can specify the checkout action as <code class="inlineCode">actions/checkout@v3</code>.</p>
<p class="normal">The source code of the <code class="inlineCode">checkout</code> action is hosted on GitHub and can be found at the following site: <a href="https://github.com/actions/checkout">https://github.com/actions/checkout</a>.</p>
<p class="normal">Once the source code is checked out, we need to install the .NET MAUI workload using the following command after the <code class="inlineCode">run</code>: syntax:</p>
<pre class="programlisting con"><code class="hljs-con">dotnet workload install maui
</code></pre>
<p class="normal">In the restore and build steps, we can run the following <code class="inlineCode">dotnet</code> command after the <code class="inlineCode">run</code>: syntax:</p>
<pre class="programlisting con"><code class="hljs-con">dotnet restore ${{env.PROJECT_NAME}}/${{env.PROJECT_NAME}}.csproj
</code></pre>
<p class="normal">After the build is completed, we can upload the artifact using another <code class="inlineCode">upload-artifact</code> action.</p>
<p class="normal">We have<a id="_idIndexMarker976"/> introduced<a id="_idIndexMarker977"/> the <code class="inlineCode">passxyz-ci-windows.yml</code> workflow, which performs Android and Windows builds. Now, let’s review the <code class="inlineCode">passxyz-ci-macos.yml</code> workflow, which performs iOS and macOS builds, in <em class="italic">Listing 12.4</em>:</p>
<pre class="programlisting code"><code class="hljs-code">name: PassXYZ.Vault CI Build (MacOS)
on:
  push:
    branches: [ chapter12 ]
    paths-ignore:
      - '**/*.md'
      - '**/*.gitignore'
      - '**/*.gitattributes'
  pull_request:
    branches: [ chapter12 ]
  workflow_dispatch:
permissions:
  contents: read
env:
  DOTNET_NOLOGO: true
  DOTNET_SKIP_FIRST_TIME_EXPERIENCE: true
  DOTNET_CLI_TELEMETRY_OPTOUT: true
  DOTNETVERSION: 8.0.x
  DOTNETSDK: 'net8.0'
  PROJECT_NAME: PassXYZ.Vault
jobs:
# MAUI iOS Build
  build-ios:
    runs-on: macos-14                                            //(1)
    name: iOS Build
    steps:
      - name: Setup Xcode
        run: sudo xcode-select -s /Applications/Xcode_15.1.0.app
      - name: Checkout
        uses: actions/checkout@v3
      - name: Setup .NET
        uses: actions/setup-dotnet@v2
        with:
          dotnet-version: ${{env.DOTNETVERSION}}
      - name: Install MAUI workload
        run: dotnet workload install maui   
      - name: Restore Dependencies
        run: dotnet restore ${{env.PROJECT_NAME}}
          /${{env.PROJECT_NAME}}.csproj
      - name: Build MAUI iOS
        run: dotnet build ${{env.PROJECT_NAME}}
          /${{env.PROJECT_NAME}}.csproj -c Release -f
${{env.DOTNETSDK}}-ios --no-restore /p:buildForSimulator=True
/p:packageApp=True /p:ArchiveOnBuild=False
      - name: Upload iOS Artifact
        uses: actions/upload-artifact@v3
        with:
          name: passxyz-ios-ci-build
          path: ${{env.PROJECT_NAME}}/bin/Release/
${{env.DOTNETSDK}}-ios/iossimulator-x64/**/*.app
# MAUI MacCatalyst Build
  build-mac:
    runs-on: macos-14
    name: MacCatalyst Build
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Setup .NET
        uses: actions/setup-dotnet@v2
        with:
          dotnet-version: ${{env.DOTNETVERSION}}
      - name: Install MAUI workload
        run: dotnet workload install maui   
      - name: Restore Dependencies
        run: dotnet restore ${{env.PROJECT_NAME}}
          /${{env.PROJECT_NAME}}.csproj
      - name: Build MAUI MacCatalyst
        run: dotnet publish ${{env.PROJECT_NAME}}
          /${{env.PROJECT_NAME}}.csproj -c Release 
-f${{env.DOTNETSDK}}-maccatalyst --no-restore -p:BuildIpa=True
      - name: Upload MacCatalyst Artifact
        uses: actions/upload-artifact@v3
        with:
          name: passxyz-macos-ci-build
          path: ${{env.PROJECT_NAME}}/bin/Release/${{env.DOTNETSDK}}-
            maccatalyst/maccatalyst-x64/publish/*.pkg
</code></pre>
<p class="packt_figref">Listing 12.4: <code class="inlineCode">passxyz-ci-macos.yml</code> (<a href="https://epa.ms/passxyz-ci-macos12-4">https://epa.ms/passxyz-ci-macos12-4</a>)</p>
<p class="normal">This <a id="_idIndexMarker978"/>workflow follows similar principles and includes steps to restore, install, build, and <a id="_idIndexMarker979"/>upload artifacts for the iOS and macOS versions of our .NET MAUI app. The difference here is that the <code class="inlineCode">macos-14</code> <strong class="keyWord">(1)</strong> runner is used. The rest of the steps are similar to a Windows or Android build.</p>
<p class="normal">We have now introduced the configuration of all builds in GitHub Actions. You can check the build status on GitHub to see how the app builds will progress and succeed in our .NET MAUI project. Monitoring build statuses can help you identify any potential issues with your app during the development process and maintain the quality of your code.</p>
<figure class="mediaobject"><img alt="Figure 12.15: The Android and Windows build status" height="767" src="img/B21554_12_15.png" width="825"/></figure>
<p class="packt_figref">Figure 12.15: The Android and Windows build status</p>
<p class="normal">As seen in <em class="italic">Figure 12.15</em>, both the Android and Windows builds are completed successfully. The <a id="_idIndexMarker980"/>build artifacts can be downloaded from GitHub after the build is<a id="_idIndexMarker981"/> finished. This ensures you have access to the latest app builds, making it easier to distribute them for testing or deployment.</p>
<figure class="mediaobject"><img alt="Figure 12.16: The iOS and MacCatalyst build status" height="767" src="img/B21554_12_16.png" width="825"/></figure>
<p class="packt_figref">Figure 12.16: The iOS and MacCatalyst build status</p>
<p class="normal">As seen in <em class="italic">Figure 12.16</em>, both the iOS and Mac Catalyst builds completed successfully.</p>
<p class="normal">By successfully configuring GitHub Actions for your .NET MAUI project, you can maintain a CI process that ensures the quality of your code and streamlines development. Furthermore, this automated workflow simplifies the management of app builds and allows developers to focus on feature development and bug fixing.</p>
<p class="normal">We have now concluded the introduction to packaging our app for app store submissions and automating the build process using GitHub Actions. With these techniques in place, you can ensure a smoother and more efficient development pipeline for your .NET MAUI app, resulting in higher quality code and quicker deployments to the app stores.</p>
<h1 class="heading-1" id="_idParaDest-322">Summary</h1>
<p class="normal">CI/CD are common practices in today’s development process. In this chapter, we introduced how to prepare a build so that the resulting packages can be used for the submission to various app stores. The process after the submission of build packages is not covered, since they are platform- and account-specific topics. Please refer to the <em class="italic">Further reading</em> section to find out more about how to publish applications to Google Play, Apple Store, and Microsoft Store.</p>
<p class="normal">After discussing the build process of each platform, we demonstrated how to automate the process using GitHub Actions.</p>
<p class="normal">With all the skills that you’ve learned from this book, you should be able to develop your own .NET MAUI applications and be ready to submit your apps to supported app stores. As you continue to grow as a developer, remember to explore new techniques and refine your understanding of .NET MAUI to create even better applications and streamline your development process.</p>
<p class="normal">Here are some online resources to learn .NET MAUI and stay up to date with the latest trends and news:</p>
<ul>
<li class="bulletList"><strong class="keyWord">Official .NET Blog</strong>: The Microsoft .NET team frequently posts updates and tutorials on .NET MAUI.</li>
<li class="bulletList"><strong class="keyWord">.NET MAUI GitHub repository</strong>: This is the official repository of .NET MAUI. You can find the latest code, issues, and discussions about .NET MAUI here.</li>
<li class="bulletList"><strong class="keyWord">Microsoft docs</strong>: This is the official documentation by Microsoft, and it provides a comprehensive guide to learning .NET MAUI.</li>
<li class="bulletList"><strong class="keyWord">Microsoft Learn</strong>: Platform to find various learning paths and modules. You can find resources for .NET and possibly future content about .NET MAUI.</li>
<li class="bulletList">.<strong class="keyWord">NET Community Standups</strong>: Regular community standups hosted by Microsoft engineers, where they discuss the latest trends and updates to .NET MAUI.</li>
<li class="bulletList"><strong class="keyWord">Stack Overflow</strong>: A question and answer site for professional and enthusiast programmers.</li>
<li class="bulletList">.<strong class="keyWord">NET MAUI YouTube tutorials</strong>: You can learn .NET MAUI by watching step-by-step tutorials on YouTube. For example, the Xamarin Developers YouTube channel posts tutorials and discussions about .NET MAUI.</li>
<li class="bulletList"><strong class="keyWord">Twitter</strong>: Follow the official .NET account (<code class="inlineCode">@dotnet</code>) and other Microsoft developers for the latest updates and developments.</li>
</ul>
<h1 class="heading-1" id="_idParaDest-323">Further reading</h1>
<ul>
<li class="bulletList">Getting Started with DevOps and .NET MAUI: <a href="https://devblogs.microsoft.com/dotnet/devops-for-dotnet-maui/">https://devblogs.microsoft.com/dotnet/devops-for-dotnet-maui/</a></li>
<li class="bulletList">Upload your app to the Play Console: <a href="https://developer.android.com/studio/publish/upload-bundle">https://developer.android.com/studio/publish/upload-bundle</a></li>
<li class="bulletList">Publish a .NET MAUI iOS app: <a href="https://learn.microsoft.com/en-us/dotnet/maui/ios/deployment/?view=net-maui-8.0">https://learn.microsoft.com/en-us/dotnet/maui/ios/deployment/?view=net-maui-8.0</a></li>
<li class="bulletList">Publish a .NET MAUI Mac Catalyst app: <a href="https://learn.microsoft.com/en-us/dotnet/maui/mac-catalyst/deployment/?view=net-maui-8.0">https://learn.microsoft.com/en-us/dotnet/maui/mac-catalyst/deployment/?view=net-maui-8.0</a></li>
<li class="bulletList">Publish a .NET MAUI app for Android: <a href="https://learn.microsoft.com/en-us/dotnet/maui/android/deployment/overview?view=net-maui-8.0">https://learn.microsoft.com/en-us/dotnet/maui/android/deployment/overview?view=net-maui-8.0</a></li>
<li class="bulletList">Publish a .NET MAUI app for Windows: <a href="https://learn.microsoft.com/en-us/dotnet/maui/windows/deployment/overview?view=net-maui-8.0">https://learn.microsoft.com/en-us/dotnet/maui/windows/deployment/overview?view=net-maui-8.0</a></li>
<li class="bulletList">Upload iOS builds to Apple Store: <a href="https://developer.apple.com/help/app-store-connect/manage-builds/upload-builds">https://developer.apple.com/help/app-store-connect/manage-builds/upload-builds</a></li>
</ul>
<h1 class="heading-1">Leave a review!</h1>
<p class="normal"><em class="italic">Enjoyed this book? Help readers like you by leaving an Amazon review. Scan the QR code below for a 40% discount code.</em></p>
<p class="normal"><img alt="" height="182" src="img/Leave_a_review_QR.png" width="182"/></p>
<p class="normal"><em class="italic">*Limited Offer</em></p>
</div>
</div></body></html>