<html><head></head><body>
<div id="_idContainer085">
<h1 class="chapter-number" id="_idParaDest-78"><a id="_idTextAnchor082"/><span class="koboSpan" id="kobo.1.1">6</span></h1>
<h1 id="_idParaDest-79"><a id="_idTextAnchor083"/><span class="koboSpan" id="kobo.2.1">Animating a Girl on a Swing</span></h1>
<p><span class="koboSpan" id="kobo.3.1">Welcome to the next project. </span><span class="koboSpan" id="kobo.3.2">In this one, we’re going to animate parts of an image, specifically an image of a girl on a swing, and make those individual parts move with a </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">natural motion.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">To do this, we’re going to take a look at an animating technique that uses any image or vector file of a subject and then cuts that image up into various parts in order to animate them separately. </span><span class="koboSpan" id="kobo.5.2">We will also take a look at a new modifier called </span><strong class="source-inline"><span class="koboSpan" id="kobo.6.1">mask</span></strong><span class="koboSpan" id="kobo.7.1">, which is used for setting the opacity of </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">a view.</span></span></p>
<p><span class="koboSpan" id="kobo.9.1">Let’s take a look at what we will learn in </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">this project:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.11.1">Gathering and </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">slicing images</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">Adding </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">animating variables</span></span></li>
<li><span class="koboSpan" id="kobo.15.1">Adding images to </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">the scene</span></span></li>
<li><span class="koboSpan" id="kobo.17.1">Using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.18.1">mask</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.19.1"> modifier</span></span></li>
</ul>
<h1 id="_idParaDest-80"><a id="_idTextAnchor084"/><span class="koboSpan" id="kobo.20.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.21.1">You can download the resources and the finished project from the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.22.1">Chapter 6</span></strong></span><span class="koboSpan" id="kobo.23.1"> folder on </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">GitHub: </span></span><a href="https://github.com/PacktPublishing/Animating-SwiftUI-Applications"><span class="No-Break"><span class="koboSpan" id="kobo.25.1">https://github.com/PacktPublishing/Animating-SwiftUI-Applications</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.26.1">.</span></span></p>
<h1 id="_idParaDest-81"><a id="_idTextAnchor085"/><span class="koboSpan" id="kobo.27.1">Gathering and slicing images</span></h1>
<p><span class="koboSpan" id="kobo.28.1">In this project, I will be </span><a id="_idIndexMarker321"/><span class="koboSpan" id="kobo.29.1">using some simple graphics, including an image of a girl, a leafy</span><a id="_idIndexMarker322"/><span class="koboSpan" id="kobo.30.1"> background, and a branch. </span><span class="koboSpan" id="kobo.30.2">And, as I mentioned, we will be animating two parts of the scene: the swing and the </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">girl’s legs.</span></span></p>
<p><span class="koboSpan" id="kobo.32.1">The first thing you need to do is download the images as explained in the </span><em class="italic"><span class="koboSpan" id="kobo.33.1">Technical requirements</span></em><span class="koboSpan" id="kobo.34.1"> section and then cut the images into various parts. </span><span class="koboSpan" id="kobo.34.2">To do this, I will simply use Mac’s Preview app, which is a free app that’s already installed on your Mac computer. </span><span class="koboSpan" id="kobo.34.3">Inside this app, there is an option called </span><strong class="bold"><span class="koboSpan" id="kobo.35.1">Markup</span></strong><span class="koboSpan" id="kobo.36.1">, as </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">shown here:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer072">
<span class="koboSpan" id="kobo.38.1"><img alt="Figure 6.1: Accessing the Markup tools " src="image/B18674_06_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.39.1">Figure 6.1: Accessing the Markup tools</span></p>
<p><span class="koboSpan" id="kobo.40.1">Clicking on </span><strong class="bold"><span class="koboSpan" id="kobo.41.1">Markup</span></strong><span class="koboSpan" id="kobo.42.1"> will open up an array of helpful editing tools that we can use to transform an image in unique </span><a id="_idIndexMarker323"/><span class="koboSpan" id="kobo.43.1">ways. </span><span class="koboSpan" id="kobo.43.2">One of the best tools for cutting images is the </span><strong class="bold"><span class="koboSpan" id="kobo.44.1">Lasso Selection</span></strong><span class="koboSpan" id="kobo.45.1"> tool, which lets us draw a selection box around some or all of the parts of the</span><a id="_idIndexMarker324"/><span class="koboSpan" id="kobo.46.1"> image, and either cut it out or copy it to another window. </span><span class="koboSpan" id="kobo.46.2">You can find the tool in the drop-down menu </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">located here:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer073">
<span class="koboSpan" id="kobo.48.1"><img alt="Figure 6.2: Accessing the Lasso Selection tool " src="image/B18674_06_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.49.1">Figure 6.2: Accessing the Lasso Selection tool</span></p>
<p><span class="koboSpan" id="kobo.50.1">To use it, click and drag your cursor around any object, and then connect the start and end points when you’re done. </span><span class="koboSpan" id="kobo.50.2">We want to drag the lasso around the girl’s lower legs, just above the knee joint, </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">like so:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer074">
<span class="koboSpan" id="kobo.52.1"><img alt="Figure 6.3: Using the Lasso Selection tool [Credit: &lt;a href=”https://www.freepik.com/vectors/clip-art”&gt;Clip art vector created by brgfx - www.freepik.com&lt;/a&gt;] " src="image/B18674_06_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.53.1">Figure 6.3: Using the Lasso Selection tool [Credit: &lt;a href=”</span><a href="https://www.freepik.com/vectors/clip-art"><span class="koboSpan" id="kobo.54.1">https://www.freepik.com/vectors/clip-art</span></a><span class="koboSpan" id="kobo.55.1">”&gt;Clip art vector created by brgfx - </span><a href="http://www.freepik.com"><span class="koboSpan" id="kobo.56.1">www.freepik.com</span></a><span class="koboSpan" id="kobo.57.1">&lt;/a&gt;]</span></p>
<p><span class="koboSpan" id="kobo.58.1">With the legs selected </span><a id="_idIndexMarker325"/><span class="koboSpan" id="kobo.59.1">using the </span><strong class="bold"><span class="koboSpan" id="kobo.60.1">Lasso Selection</span></strong><span class="koboSpan" id="kobo.61.1"> tool, copy the selection by pressing </span><em class="italic"><span class="koboSpan" id="kobo.62.1">Command + C</span></em><span class="koboSpan" id="kobo.63.1">. </span><span class="koboSpan" id="kobo.63.2">Now they are saved to the Mac clipboard. </span><span class="koboSpan" id="kobo.63.3">To make that copy into a </span><a id="_idIndexMarker326"/><span class="koboSpan" id="kobo.64.1">separate image, go to </span><strong class="bold"><span class="koboSpan" id="kobo.65.1">File</span></strong><span class="koboSpan" id="kobo.66.1">, and select </span><strong class="bold"><span class="koboSpan" id="kobo.67.1">New from Clipboard</span></strong><span class="koboSpan" id="kobo.68.1">. </span><span class="koboSpan" id="kobo.68.2">Save the PNG to your desktop and rename it </span><strong class="source-inline"><span class="koboSpan" id="kobo.69.1">leg</span></strong><span class="koboSpan" id="kobo.70.1">. </span><span class="koboSpan" id="kobo.70.2">Your image will look something </span><span class="No-Break"><span class="koboSpan" id="kobo.71.1">like this:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer075">
<span class="koboSpan" id="kobo.72.1"><img alt="Figure 6.4: Separating the leg with the Lasso Selection tool " src="image/B18674_06_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.73.1">Figure 6.4: Separating the leg with the Lasso Selection tool</span></p>
<p><span class="koboSpan" id="kobo.74.1">This image is okay, but there’s a problem. </span><span class="koboSpan" id="kobo.74.2">The image contains a background that won’t look good in the scene; we only want the leg without any background. </span><span class="koboSpan" id="kobo.74.3">The best way I have found to remove backgrounds is to use a helpful free online tool called </span><strong class="bold"><span class="koboSpan" id="kobo.75.1">removebg</span></strong><span class="koboSpan" id="kobo.76.1">, which you can access here: </span><a href="https://www.remove.bg/upload"><span class="koboSpan" id="kobo.77.1">https://www.remove.bg/upload</span></a><span class="koboSpan" id="kobo.78.1">. </span><span class="koboSpan" id="kobo.78.2">Simply drop the image onto that website, and it identifies the background and </span><span class="No-Break"><span class="koboSpan" id="kobo.79.1">removes it.</span></span></p>
<p><span class="koboSpan" id="kobo.80.1">At this point, we now</span><a id="_idIndexMarker327"/><span class="koboSpan" id="kobo.81.1"> have our image of a leg (though our animation includes</span><a id="_idIndexMarker328"/><span class="koboSpan" id="kobo.82.1"> two legs, one image will work just fine to represent both legs of </span><span class="No-Break"><span class="koboSpan" id="kobo.83.1">the girl).</span></span></p>
<p><span class="koboSpan" id="kobo.84.1">Next in our project, we also want a piece of rope, which we will use to tie the swing to the tree in our background image. </span><span class="koboSpan" id="kobo.84.2">However, if you look at </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.85.1">Figure 6</span></em></span><em class="italic"><span class="koboSpan" id="kobo.86.1">.3</span></em><span class="koboSpan" id="kobo.87.1">, the rope is a little too short for what we need. </span><span class="koboSpan" id="kobo.87.2">To get an extra piece of rope, I used the </span><strong class="bold"><span class="koboSpan" id="kobo.88.1">Lasso Selection</span></strong><span class="koboSpan" id="kobo.89.1"> tool around the rope, copied it, and made a new image, then removed the background with </span><strong class="bold"><span class="koboSpan" id="kobo.90.1">removebg</span></strong><span class="koboSpan" id="kobo.91.1"> (as we did with the leg). </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.92.1">Figure 6</span></em></span><em class="italic"><span class="koboSpan" id="kobo.93.1">.5</span></em><span class="koboSpan" id="kobo.94.1"> is the result; this is what we will use in the scene to extend the </span><span class="No-Break"><span class="koboSpan" id="kobo.95.1">existing rope:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer076">
<span class="koboSpan" id="kobo.96.1"><img alt="Figure 6.5: Rope " src="image/B18674_06_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.97.1">Figure 6.5: Rope</span></p>
<p><span class="koboSpan" id="kobo.98.1">Next, I looked for a suitable background, which was a tree with some grass and a sky. </span><span class="koboSpan" id="kobo.98.2">Here is the one we will </span><a id="_idIndexMarker329"/><span class="koboSpan" id="kobo.99.1">use (it originally had a tire swing; however, I didn’t want that kind of </span><a id="_idIndexMarker330"/><span class="koboSpan" id="kobo.100.1">swing, so I removed it using some other software called Affinity Photo). </span><span class="koboSpan" id="kobo.100.2">Now we have a tree and we can tie a swing to </span><span class="No-Break"><span class="koboSpan" id="kobo.101.1">its branch:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer077">
<span class="koboSpan" id="kobo.102.1"><img alt="Figure 6.6: Our background image " src="image/B18674_06_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.103.1">Figure 6.6: Our background image</span></p>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.104.1">[Credit: </span><a href="https://www.istockphoto.com/vector/tire-swing-in-autumn-gm165677003-10337433?phrase=tyre%20swing"><span class="koboSpan" id="kobo.105.1">https://www.istockphoto.com/vector/tire-swing-in-autumn-gm165677003-10337433?phrase=tyre%20swing</span></a><span class="koboSpan" id="kobo.106.1">]</span></p>
<p><span class="koboSpan" id="kobo.107.1">I also thought the</span><a id="_idIndexMarker331"/><span class="koboSpan" id="kobo.108.1"> tree was a little sparse, so I found some leaves that can </span><a id="_idIndexMarker332"/><span class="koboSpan" id="kobo.109.1">be positioned onto the branch later, and they will also hide the top part of </span><span class="No-Break"><span class="koboSpan" id="kobo.110.1">the rope:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer078">
<span class="koboSpan" id="kobo.111.1"><img alt="Figure 6.7: Our leaves image " src="image/B18674_06_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.112.1">Figure 6.7: Our leaves image</span></p>
<p><span class="koboSpan" id="kobo.113.1">As you play around with slicing up images and making the individual parts to animate, you may find that you want something better than Mac’s Preview app. </span><span class="koboSpan" id="kobo.113.2">You may also find that, even though </span><strong class="bold"><span class="koboSpan" id="kobo.114.1">removebg</span></strong><span class="koboSpan" id="kobo.115.1"> works in most cases, it may not work in every instance. </span><span class="koboSpan" id="kobo.115.2">If so, you can use professional software such as Photoshop; however, that can be expensive. </span><span class="koboSpan" id="kobo.115.3">Instead, you </span><a id="_idIndexMarker333"/><span class="koboSpan" id="kobo.116.1">can try my favorite image editing software that I mentioned</span><a id="_idIndexMarker334"/><span class="koboSpan" id="kobo.117.1"> earlier, Affinity Designer and Affinity Photo. </span><span class="koboSpan" id="kobo.117.2">They are very reasonably priced and as robust as Photoshop, but they are much more user-friendly. </span><span class="koboSpan" id="kobo.117.3">Definitely take a look at them if you want to learn how to manipulate images that you can use in an iOS app without paying a yearly subscription, as you would </span><span class="No-Break"><span class="koboSpan" id="kobo.118.1">for Photoshop.</span></span></p>
<p><span class="koboSpan" id="kobo.119.1">Once we have all the parts we need for the girl in the swing scene, we can start assembling it in Xcode. </span><span class="koboSpan" id="kobo.119.2">So, create a new project – I have called mine </span><strong class="source-inline"><span class="koboSpan" id="kobo.120.1">Girl On A Swing</span></strong><span class="koboSpan" id="kobo.121.1"> – then open the Assets catalog and drop all the images inside as we have </span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">done before.</span></span></p>
<p><span class="koboSpan" id="kobo.123.1">Now we can start coding in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.124.1">ContentView</span></strong><span class="koboSpan" id="kobo.125.1"> file; this is the only file we need for this project as there is very little code required to make this </span><span class="No-Break"><span class="koboSpan" id="kobo.126.1">project work.</span></span></p>
<h1 id="_idParaDest-82"><a id="_idTextAnchor086"/><span class="koboSpan" id="kobo.127.1">Adding the animating variables</span></h1>
<p><span class="koboSpan" id="kobo.128.1">As we have done before, we start off by adding the properties needed to keep track of the different parts </span><a id="_idIndexMarker335"/><span class="koboSpan" id="kobo.129.1">we want to animate. </span><span class="koboSpan" id="kobo.129.2">In our case, we need </span><span class="No-Break"><span class="koboSpan" id="kobo.130.1">three properties:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.131.1">One property for the girl image, aptly </span><span class="No-Break"><span class="koboSpan" id="kobo.132.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.133.1">girl</span></strong></span></li>
<li><span class="koboSpan" id="kobo.134.1">One for the left leg, </span><span class="No-Break"><span class="koboSpan" id="kobo.135.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.136.1">leftLeg</span></strong></span></li>
<li><span class="koboSpan" id="kobo.137.1">One for the right leg, </span><span class="No-Break"><span class="koboSpan" id="kobo.138.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.139.1">rightLeg</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.140.1">Even though we are using one image for both the right and left legs, we still need two separate leg properties for the animation to work because the legs will be moving at different times </span><span class="No-Break"><span class="koboSpan" id="kobo.141.1">and speeds.</span></span></p>
<p><span class="koboSpan" id="kobo.142.1">All of these properties will be </span><strong class="source-inline"><span class="koboSpan" id="kobo.143.1">State</span></strong><span class="koboSpan" id="kobo.144.1"> properties, so they will update the view instantly as their values change. </span><span class="koboSpan" id="kobo.144.2">Put the following code into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.145.1">ContentView</span></strong><span class="koboSpan" id="kobo.146.1"> file, just above the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.147.1">body</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.148.1"> property:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.149.1">
    @State private var girl = false
    @State private var leftLeg = false
    @State private var rightLeg = false</span></pre>
<p><span class="koboSpan" id="kobo.150.1">As usual, all the properties are all set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.151.1">false</span></strong><span class="koboSpan" id="kobo.152.1"> so the animation won’t start until they are changed </span><span class="No-Break"><span class="koboSpan" id="kobo.153.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.154.1">true</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.155.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.156.1">We’re also going to add a fourth property, which I’m calling </span><strong class="source-inline"><span class="koboSpan" id="kobo.157.1">fadeOutRope</span></strong><span class="koboSpan" id="kobo.158.1">. </span><span class="koboSpan" id="kobo.158.2">This isn’t strictly necessary, but it gives me an opportunity to show you how to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.159.1">mask</span></strong><span class="koboSpan" id="kobo.160.1"> modifier, which masks a view by changing its opacity; if we pass in a gradient color, we can make the rope fade out as it reaches the tree branch. </span><span class="koboSpan" id="kobo.160.2">Here is the property I want you to add under the </span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">previous ones:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.162.1">
let fadeOutRope = Gradient(colors: [.clear, .black])</span></pre>
<p><span class="koboSpan" id="kobo.163.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.164.1">Gradient</span></strong><span class="koboSpan" id="kobo.165.1"> function needs an array of colors to work, so I gave it two colors: a </span><strong class="source-inline"><span class="koboSpan" id="kobo.166.1">clear</span></strong><span class="koboSpan" id="kobo.167.1"> color (or non-color), and a </span><strong class="source-inline"><span class="koboSpan" id="kobo.168.1">black</span></strong><span class="koboSpan" id="kobo.169.1"> color. </span><span class="koboSpan" id="kobo.169.2">These two colors will be blended together into the rope image, making the top portion fade out. </span><span class="koboSpan" id="kobo.169.3">As I said, this is not strictly necessary; however, I think it’s better to fade out the top of the rope because it’s not tied to the branch of the tree in the image we are using, so we want to blend it in a little bit, giving the appearance that it is attached somewhere in the tree. </span><span class="koboSpan" id="kobo.169.4">Later, we will use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.170.1">mask</span></strong><span class="koboSpan" id="kobo.171.1"> modifier, add</span><a id="_idIndexMarker336"/><span class="koboSpan" id="kobo.172.1"> an image of some leaves to help conceal the top of the rope, and make the scene look even </span><span class="No-Break"><span class="koboSpan" id="kobo.173.1">more natural.</span></span></p>
<h1 id="_idParaDest-83"><a id="_idTextAnchor087"/><span class="koboSpan" id="kobo.174.1">Adding the images to the scene</span></h1>
<p><span class="koboSpan" id="kobo.175.1">There are four images we</span><a id="_idIndexMarker337"/><span class="koboSpan" id="kobo.176.1"> need to add to our scene, which we will add in the </span><span class="No-Break"><span class="koboSpan" id="kobo.177.1">following order:</span></span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.178.1">The background</span></span></li>
<li><span class="koboSpan" id="kobo.179.1">The </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">right leg</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.181.1">The girl</span></span></li>
<li><span class="koboSpan" id="kobo.182.1">The </span><span class="No-Break"><span class="koboSpan" id="kobo.183.1">left leg</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.184.1">So, let’s </span><span class="No-Break"><span class="koboSpan" id="kobo.185.1">get started!</span></span></p>
<h2 id="_idParaDest-84"><a id="_idTextAnchor088"/><span class="koboSpan" id="kobo.186.1">Adding the background</span></h2>
<p><span class="koboSpan" id="kobo.187.1">We’ll add the </span><a id="_idIndexMarker338"/><span class="koboSpan" id="kobo.188.1">background inside a </span><strong class="source-inline"><span class="koboSpan" id="kobo.189.1">ZStack</span></strong><span class="koboSpan" id="kobo.190.1">, this will be the first view in the file, and so all subsequent views will be placed on top of this. </span><span class="koboSpan" id="kobo.190.2">Here is the code </span><span class="No-Break"><span class="koboSpan" id="kobo.191.1">you need:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.192.1">
var body: some View {
        ZStack {
            Image("tree").resizable()
                .frame(width: 550, height: 900)
               }
            }</span></pre>
<p><span class="koboSpan" id="kobo.193.1">In </span><strong class="source-inline"><span class="koboSpan" id="kobo.194.1">ZStack</span></strong><span class="koboSpan" id="kobo.195.1">, we call the </span><strong class="source-inline"><span class="koboSpan" id="kobo.196.1">Image</span></strong><span class="koboSpan" id="kobo.197.1"> initializer and pass in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.198.1">tree</span></strong><span class="koboSpan" id="kobo.199.1"> string. </span><span class="koboSpan" id="kobo.199.2">Next, we use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.200.1">resizable</span></strong><span class="koboSpan" id="kobo.201.1"> modifier to resize the tree, and then set the </span><strong class="source-inline"><span class="koboSpan" id="kobo.202.1">frame</span></strong><span class="koboSpan" id="kobo.203.1"> of the background to a width of </span><strong class="source-inline"><span class="koboSpan" id="kobo.204.1">550</span></strong><span class="koboSpan" id="kobo.205.1"> and a height of </span><strong class="source-inline"><span class="koboSpan" id="kobo.206.1">900</span></strong><span class="koboSpan" id="kobo.207.1"> so the background image can extend to the edges of an iPhone of </span><span class="No-Break"><span class="koboSpan" id="kobo.208.1">any size.</span></span></p>
<h2 id="_idParaDest-85"><a id="_idTextAnchor089"/><span class="koboSpan" id="kobo.209.1">Adding the right leg</span></h2>
<p><span class="koboSpan" id="kobo.210.1">When it comes to adding the </span><strong class="source-inline"><span class="koboSpan" id="kobo.211.1">rightleg</span></strong><span class="koboSpan" id="kobo.212.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.213.1">leftleg</span></strong><span class="koboSpan" id="kobo.214.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.215.1">girl</span></strong><span class="koboSpan" id="kobo.216.1"> properties, we need another </span><strong class="source-inline"><span class="koboSpan" id="kobo.217.1">ZStack</span></strong><span class="koboSpan" id="kobo.218.1"> so we can layer all of the views on top of each other, then use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.219.1">offset</span></strong><span class="koboSpan" id="kobo.220.1"> modifier to move</span><a id="_idIndexMarker339"/><span class="koboSpan" id="kobo.221.1"> them into place </span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">as needed.</span></span></p>
<p><span class="koboSpan" id="kobo.223.1">To add the right leg to the scene, enter the </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.225.1">
 ZStack {
    ///right leg
    Image("leg").resizable().aspectRatio(contentMode: .fit)
        .rotationEffect(.degrees(rightLeg ? </span><span class="koboSpan" id="kobo.225.2">-20 : 50),
          anchor: .topTrailing )
        .scaleEffect(0.12)
        .offset(x: -448, y: 92)
        .animation(Animation.easeInOut(duration: 
          1).delay(0.09).repeatForever(autoreverses: true),
          value: rightLeg)
        .onAppear() {
            rightLeg.toggle()
        }
     }</span></pre>
<p><span class="koboSpan" id="kobo.226.1">First, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.227.1">Image</span></strong><span class="koboSpan" id="kobo.228.1"> initializer gets passed into it the name of the image we want to display; here, it’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.229.1">"leg"</span></strong><span class="koboSpan" id="kobo.230.1">. </span><span class="koboSpan" id="kobo.230.2">Remember, we are using this one image to represent the right and left legs (we can get away with using a single image because this is a 2D scene; we don’t have a 3D view around the image, so we can’t really see any variance in </span><span class="No-Break"><span class="koboSpan" id="kobo.231.1">each leg).</span></span></p>
<p><span class="koboSpan" id="kobo.232.1">Next, we will use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.233.1">resizable</span></strong><span class="koboSpan" id="kobo.234.1"> modifier and set the aspect ratio to </span><strong class="source-inline"><span class="koboSpan" id="kobo.235.1">fit</span></strong><span class="koboSpan" id="kobo.236.1">. </span><span class="koboSpan" id="kobo.236.2">Using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.237.1">fit</span></strong><span class="koboSpan" id="kobo.238.1"> option resizes the image content to use all the available screen space, both vertically </span><span class="No-Break"><span class="koboSpan" id="kobo.239.1">and horizontally.</span></span></p>
<p><span class="koboSpan" id="kobo.240.1">The next line of code sets the </span><strong class="source-inline"><span class="koboSpan" id="kobo.241.1">rotationEffect</span></strong><span class="koboSpan" id="kobo.242.1"> on the leg. </span><span class="koboSpan" id="kobo.242.2">The right leg will be rotated by </span><strong class="source-inline"><span class="koboSpan" id="kobo.243.1">-20</span></strong><span class="koboSpan" id="kobo.244.1"> degrees when the </span><strong class="source-inline"><span class="koboSpan" id="kobo.245.1">rightLeg</span></strong><span class="koboSpan" id="kobo.246.1"> property is </span><strong class="source-inline"><span class="koboSpan" id="kobo.247.1">true</span></strong><span class="koboSpan" id="kobo.248.1">, and it will rotate </span><strong class="source-inline"><span class="koboSpan" id="kobo.249.1">50</span></strong><span class="koboSpan" id="kobo.250.1"> degrees when it </span><span class="No-Break"><span class="koboSpan" id="kobo.251.1">is </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.252.1">false</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.253.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.254.1">Notice the </span><strong class="source-inline"><span class="koboSpan" id="kobo.255.1">anchor</span></strong><span class="koboSpan" id="kobo.256.1"> parameter too? </span><span class="koboSpan" id="kobo.256.2">An anchor point is the point around which the image will rotate. </span><span class="koboSpan" id="kobo.256.3">When thinking</span><a id="_idIndexMarker340"/><span class="koboSpan" id="kobo.257.1"> about humans (and animals too), our anchor points are our joints. </span><span class="koboSpan" id="kobo.257.2">We bend and move from those joints, our pivot points. </span><span class="koboSpan" id="kobo.257.3">In our project, by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.258.1">topTrailing</span></strong><span class="koboSpan" id="kobo.259.1"> option, the leg will rotate about the </span><span class="No-Break"><span class="koboSpan" id="kobo.260.1">knee joint.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.261.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.262.1">If you type a dot (</span><strong class="source-inline"><span class="koboSpan" id="kobo.263.1">.</span></strong><span class="koboSpan" id="kobo.264.1">) into your code, you can see the other options Xcode offers for your </span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">anchor point.</span></span></p>
<p><span class="koboSpan" id="kobo.266.1">After that, we need to scale the image down to a usable size. </span><span class="koboSpan" id="kobo.266.2">As it is, it’s too big for the screen, so by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.267.1">scaleEffect</span></strong><span class="koboSpan" id="kobo.268.1"> modifier, we have scaled it down to 12 percent of its original size. </span><span class="koboSpan" id="kobo.268.2">For our scene, that’s a </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">nice fit.</span></span></p>
<p><span class="koboSpan" id="kobo.270.1">The next line of code uses the </span><strong class="source-inline"><span class="koboSpan" id="kobo.271.1">offset</span></strong><span class="koboSpan" id="kobo.272.1"> modifier to place the right leg in the exact location we need. </span><span class="koboSpan" id="kobo.272.2">It needs to be placed at the knee joint of the girl image, which I worked out to be a value of -448 for the </span><em class="italic"><span class="koboSpan" id="kobo.273.1">x</span></em><span class="koboSpan" id="kobo.274.1">-axis and 92 for the </span><em class="italic"><span class="koboSpan" id="kobo.275.1">y</span></em><span class="koboSpan" id="kobo.276.1">-axis. </span><span class="koboSpan" id="kobo.276.2">Arriving at those coordinates is really just a matter of trial and error. </span><span class="koboSpan" id="kobo.276.3">For example, if you want to move the part up on the screen, add a smaller number for the </span><em class="italic"><span class="koboSpan" id="kobo.277.1">y</span></em><span class="koboSpan" id="kobo.278.1"> position, and if you want to move the image to right, add a larger number for the </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.279.1">x</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.280.1"> position.</span></span></p>
<p><span class="koboSpan" id="kobo.281.1">Finally, we get to the animation, most of which we have seen before. </span><span class="koboSpan" id="kobo.281.2">Here, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.282.1">animation</span></strong><span class="koboSpan" id="kobo.283.1"> modifier does the work of moving the leg, with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.284.1">duration</span></strong><span class="koboSpan" id="kobo.285.1"> of 1 second, which is the time it takes for the animation to finish. </span><span class="koboSpan" id="kobo.285.2">Also, using a slight </span><strong class="source-inline"><span class="koboSpan" id="kobo.286.1">delay</span></strong><span class="koboSpan" id="kobo.287.1"> of </span><strong class="source-inline"><span class="koboSpan" id="kobo.288.1">.09</span></strong><span class="koboSpan" id="kobo.289.1"> seconds will give a more random look to the animation as we will set the left leg to a </span><span class="No-Break"><span class="koboSpan" id="kobo.290.1">different delay.</span></span></p>
<p><span class="koboSpan" id="kobo.291.1">As well as this, we want the animation to repeat forever, or at least until the user stops the app, so that’s why the </span><strong class="source-inline"><span class="koboSpan" id="kobo.292.1">repeatForever</span></strong><span class="koboSpan" id="kobo.293.1"> function is used. </span><span class="koboSpan" id="kobo.293.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.294.1">autoReverse</span></strong><span class="koboSpan" id="kobo.295.1"> parameter has a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.296.1">true</span></strong><span class="koboSpan" id="kobo.297.1"> because we want the animation to go forward in one direction, finish, reverse itself, and continue in the opposite direction. </span><span class="koboSpan" id="kobo.297.2">Also, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.298.1">animation</span></strong><span class="koboSpan" id="kobo.299.1"> modifier needs a property for its </span><strong class="source-inline"><span class="koboSpan" id="kobo.300.1">value</span></strong><span class="koboSpan" id="kobo.301.1"> parameter, and for that, we pass the </span><strong class="source-inline"><span class="koboSpan" id="kobo.302.1">rightLeg</span></strong><span class="koboSpan" id="kobo.303.1"> property </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">into it</span></span><span class="No-Break"><span class="koboSpan" id="kobo.305.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.306.1">The final part of this code is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.307.1">onAppear</span></strong><span class="koboSpan" id="kobo.308.1"> modifier. </span><span class="koboSpan" id="kobo.308.2">This modifier is used to run code when the view appears on the screen, hence the name </span><strong class="source-inline"><span class="koboSpan" id="kobo.309.1">onAppear</span></strong><span class="koboSpan" id="kobo.310.1">. </span><span class="koboSpan" id="kobo.310.2">In </span><strong class="source-inline"><span class="koboSpan" id="kobo.311.1">body</span></strong><span class="koboSpan" id="kobo.312.1">, we toggle the </span><strong class="source-inline"><span class="koboSpan" id="kobo.313.1">rightLeg</span></strong><span class="koboSpan" id="kobo.314.1"> property to </span><strong class="source-inline"><span class="koboSpan" id="kobo.315.1">true</span></strong><span class="koboSpan" id="kobo.316.1"> to activate </span><span class="No-Break"><span class="koboSpan" id="kobo.317.1">the animation.</span></span></p>
<p><span class="koboSpan" id="kobo.318.1">Now, having a leg on the </span><a id="_idIndexMarker341"/><span class="koboSpan" id="kobo.319.1">screen that is animating back and forth is not really the look we are going for, so let’s add the girl now, followed by the </span><span class="No-Break"><span class="koboSpan" id="kobo.320.1">left leg.</span></span></p>
<h2 id="_idParaDest-86"><a id="_idTextAnchor090"/><span class="koboSpan" id="kobo.321.1">Adding the girl</span></h2>
<p><span class="koboSpan" id="kobo.322.1">To add the girl to</span><a id="_idIndexMarker342"/><span class="koboSpan" id="kobo.323.1"> the scene, enter the </span><span class="No-Break"><span class="koboSpan" id="kobo.324.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.325.1">
 Image("Girl").resizable().aspectRatio(contentMode: .fit)
                .scaleEffect(0.25)
                .offset(x: -300, y: 0)</span></pre>
<p><span class="koboSpan" id="kobo.326.1">This is similar code to adding the leg: we used the </span><strong class="source-inline"><span class="koboSpan" id="kobo.327.1">Image</span></strong><span class="koboSpan" id="kobo.328.1"> initializer, passed in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.329.1">Girl</span></strong><span class="koboSpan" id="kobo.330.1"> image, made it </span><strong class="source-inline"><span class="koboSpan" id="kobo.331.1">resizable</span></strong><span class="koboSpan" id="kobo.332.1">, and set its </span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">aspectRatio</span></strong><span class="koboSpan" id="kobo.334.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">fit</span></strong><span class="koboSpan" id="kobo.336.1">. </span><span class="koboSpan" id="kobo.336.2">Then we only needed two more modifiers to finish this image off: </span><strong class="source-inline"><span class="koboSpan" id="kobo.337.1">scaleEffect</span></strong><span class="koboSpan" id="kobo.338.1">, which will scale the image down to fit in the scene, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.339.1">offset</span></strong><span class="koboSpan" id="kobo.340.1"> to place the girl image in the correct position on the </span><em class="italic"><span class="koboSpan" id="kobo.341.1">x</span></em><span class="koboSpan" id="kobo.342.1">-and </span><em class="italic"><span class="koboSpan" id="kobo.343.1">y</span></em><span class="koboSpan" id="kobo.344.1">-axes (using values of </span><strong class="source-inline"><span class="koboSpan" id="kobo.345.1">-300</span></strong><span class="koboSpan" id="kobo.346.1"> for </span><strong class="source-inline"><span class="koboSpan" id="kobo.347.1">x</span></strong><span class="koboSpan" id="kobo.348.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.349.1">0</span></strong><span class="koboSpan" id="kobo.350.1"> for </span><strong class="source-inline"><span class="koboSpan" id="kobo.351.1">y</span></strong><span class="koboSpan" id="kobo.352.1"> will place the girl in about the middle of </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">the screen).</span></span></p>
<h2 id="_idParaDest-87"><a id="_idTextAnchor091"/><span class="koboSpan" id="kobo.354.1">Adding the left leg</span></h2>
<p><span class="koboSpan" id="kobo.355.1">Finally, to </span><a id="_idIndexMarker343"/><span class="koboSpan" id="kobo.356.1">complete the girl image, she needs a </span><span class="No-Break"><span class="koboSpan" id="kobo.357.1">left leg:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.358.1">
///left leg
    Image("leg").resizable().aspectRatio(contentMode: .fit)
        .rotationEffect(.degrees(leftLeg ? </span><span class="koboSpan" id="kobo.358.2">-45 : 30),
          anchor: .topTrailing)
        .scaleEffect(0.12)
        .offset(x: -455, y: 90)
        .animation(Animation.easeInOut(duration:
          0.4).delay(1).repeatForever(autoreverses: true),
          value: leftLeg)
        .onAppear() {
            leftLeg.toggle()
        }</span></pre>
<p><span class="koboSpan" id="kobo.359.1">The code for this left leg is pretty much the same as for the right leg, but we used the </span><strong class="source-inline"><span class="koboSpan" id="kobo.360.1">leftLeg</span></strong><span class="koboSpan" id="kobo.361.1"> property and changed some values. </span><span class="koboSpan" id="kobo.361.2">For example, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.362.1">duration</span></strong><span class="koboSpan" id="kobo.363.1"> property for this leg is </span><strong class="source-inline"><span class="koboSpan" id="kobo.364.1">0.4</span></strong><span class="koboSpan" id="kobo.365.1"> and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.366.1">delay</span></strong><span class="koboSpan" id="kobo.367.1"> property is </span><strong class="source-inline"><span class="koboSpan" id="kobo.368.1">1</span></strong><span class="koboSpan" id="kobo.369.1"> second. </span><span class="koboSpan" id="kobo.369.2">As I mentioned earlier, by adding different durations and delays</span><a id="_idIndexMarker344"/><span class="koboSpan" id="kobo.370.1"> from the other images, we can randomize the swinging effect a little bit so that the legs don’t both go up and down together. </span><span class="koboSpan" id="kobo.370.2">This will give the animation a more natural </span><span class="No-Break"><span class="koboSpan" id="kobo.371.1">swinging motion.</span></span></p>
<h2 id="_idParaDest-88"><a id="_idTextAnchor092"/><span class="koboSpan" id="kobo.372.1">Bringing the images together</span></h2>
<p><span class="koboSpan" id="kobo.373.1">With this code in place, we have</span><a id="_idIndexMarker345"/><span class="koboSpan" id="kobo.374.1"> finished piecing together the girl in the swing scene, but if you look at the preview, it only shows the background </span><span class="No-Break"><span class="koboSpan" id="kobo.375.1">so far:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer079">
<span class="koboSpan" id="kobo.376.1"><img alt="Figure 6.8: Our animation with just the background " src="image/B18674_06_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.377.1">Figure 6.8: Our animation with just the background</span></p>
<p><span class="koboSpan" id="kobo.378.1">Where are the two legs and the girl that we just coded? </span><span class="koboSpan" id="kobo.378.2">Well, it’s all there, but it’s just not positioned over the </span><a id="_idIndexMarker346"/><span class="koboSpan" id="kobo.379.1">background yet; it’s all off to the side of the screen. </span><span class="koboSpan" id="kobo.379.2">This is because we positioned the legs in relation to the girl, but we didn’t position the completed image in relation to the background scene. </span><span class="koboSpan" id="kobo.379.3">To do that, let’s come out of the second </span><strong class="source-inline"><span class="koboSpan" id="kobo.380.1">ZStack</span></strong><span class="koboSpan" id="kobo.381.1"> brace and add the </span><span class="No-Break"><span class="koboSpan" id="kobo.382.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.383.1">
        .offset(x: 25, y: 0)
        .rotationEffect(.degrees(girl ? </span><span class="koboSpan" id="kobo.383.2">-30 : -45), anchor:
          .top)
        .animation(Animation.easeInOut(duration:
          1).delay(0.09).repeatForever(autoreverses: true),
          value: girl)
     .onAppear() {
            girl.toggle()
        }</span></pre>
<p><span class="koboSpan" id="kobo.384.1">This is what the </span><span class="No-Break"><span class="koboSpan" id="kobo.385.1">code does:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.386.1">The first line offsets the completed </span><strong class="source-inline"><span class="koboSpan" id="kobo.387.1">Girl</span></strong><span class="koboSpan" id="kobo.388.1"> image a small amount so it’s centered. </span></li>
<li><span class="koboSpan" id="kobo.389.1">The second line</span><a id="_idIndexMarker347"/><span class="koboSpan" id="kobo.390.1"> sets the rotation parameters for the completed image, meaning how far we want the girl to swing back and forth. </span><span class="koboSpan" id="kobo.390.2">If the </span><strong class="source-inline"><span class="koboSpan" id="kobo.391.1">girl</span></strong><span class="koboSpan" id="kobo.392.1"> property is </span><strong class="source-inline"><span class="koboSpan" id="kobo.393.1">true</span></strong><span class="koboSpan" id="kobo.394.1">, the girl image will swing to the right (</span><strong class="source-inline"><span class="koboSpan" id="kobo.395.1">-30</span></strong><span class="koboSpan" id="kobo.396.1">), and if it’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.397.1">false</span></strong><span class="koboSpan" id="kobo.398.1">, the image will swing to the left (</span><strong class="source-inline"><span class="koboSpan" id="kobo.399.1">-45</span></strong><span class="koboSpan" id="kobo.400.1">); this creates the swinging animation. </span><span class="koboSpan" id="kobo.400.2">The anchor point is placed above the girl image; this is where we want the image to </span><span class="No-Break"><span class="koboSpan" id="kobo.401.1">pivot from.</span></span></li>
<li><span class="koboSpan" id="kobo.402.1">And the third line adds the animation to the completed image, with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.403.1">duration</span></strong><span class="koboSpan" id="kobo.404.1"> value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.405.1">1</span></strong><span class="koboSpan" id="kobo.406.1"> second and a slight </span><strong class="source-inline"><span class="koboSpan" id="kobo.407.1">delay</span></strong><span class="koboSpan" id="kobo.408.1"> of </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.409.1">0.09</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.410.1"> seconds.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.411.1">And with that code completed, you can now see the girl and the legs. </span><span class="koboSpan" id="kobo.411.2">However, there’s still a problem: the image of the girl and her legs looks too small, and the legs are not connected to </span><span class="No-Break"><span class="koboSpan" id="kobo.412.1">the girl:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer080">
<span class="koboSpan" id="kobo.413.1"><img alt="Figure 6.9: Our animation with the image parts disconnected " src="image/B18674_06_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.414.1">Figure 6.9: Our animation with the image parts disconnected</span></p>
<p><span class="koboSpan" id="kobo.415.1">To fix this, we need to </span><a id="_idIndexMarker348"/><span class="koboSpan" id="kobo.416.1">add one line of code just after the closing brace of the very </span><span class="No-Break"><span class="koboSpan" id="kobo.417.1">first </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.418.1">ZStack</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.419.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.420.1">
    .frame(width: 950, height: 900)</span></pre>
<p><span class="koboSpan" id="kobo.421.1">This code sets the frame’s width and height of all the views inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.422.1">ZStack</span></strong><span class="koboSpan" id="kobo.423.1"> so it’s in proportion to the background. </span><span class="koboSpan" id="kobo.423.2">Here is </span><span class="No-Break"><span class="koboSpan" id="kobo.424.1">the result:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer081">
<span class="koboSpan" id="kobo.425.1"><img alt="Figure 6.10: Our animation with the image parts (nearly) connected " src="image/B18674_06_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.426.1">Figure 6.10: Our animation with the image parts (nearly) connected</span></p>
<p><span class="koboSpan" id="kobo.427.1">Go ahead and run the application to see what it does. </span><span class="koboSpan" id="kobo.427.2">There are three animations happening here; the</span><a id="_idIndexMarker349"/><span class="koboSpan" id="kobo.428.1"> girl is swinging back and forth, and each leg is separately kicking up and down, as </span><span class="No-Break"><span class="koboSpan" id="kobo.429.1">shown here:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer082">
<span class="koboSpan" id="kobo.430.1"><img alt="Figure 6.11: The animation (with the parts nearly connected) " src="image/B18674_06_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.431.1">Figure 6.11: The animation (with the parts nearly connected)</span></p>
<p><span class="koboSpan" id="kobo.432.1">Everything is now animating... </span><span class="koboSpan" id="kobo.432.2">but look at the top of the swing in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.433.1">Figure 6</span></em></span><em class="italic"><span class="koboSpan" id="kobo.434.1">.11</span></em><span class="koboSpan" id="kobo.435.1">. </span><span class="koboSpan" id="kobo.435.2">The rope ends in mid-air. </span><span class="koboSpan" id="kobo.435.3">Let’s use the rope and leaf images in the Assets catalog to </span><span class="No-Break"><span class="koboSpan" id="kobo.436.1">fix this.</span></span></p>
<h1 id="_idParaDest-89"><a id="_idTextAnchor093"/><span class="koboSpan" id="kobo.437.1">Using the mask modifier</span></h1>
<p><span class="koboSpan" id="kobo.438.1">The rope is not attached to anything – how can we fix that? </span><span class="koboSpan" id="kobo.438.2">Well, it’s easy: by adding two rope pieces and</span><a id="_idIndexMarker350"/><span class="koboSpan" id="kobo.439.1"> using a </span><strong class="source-inline"><span class="koboSpan" id="kobo.440.1">mask</span></strong><span class="koboSpan" id="kobo.441.1"> modifier to help them gradually fade out </span><a id="_idIndexMarker351"/><span class="koboSpan" id="kobo.442.1">at </span><span class="No-Break"><span class="koboSpan" id="kobo.443.1">the top.</span></span></p>
<p><span class="koboSpan" id="kobo.444.1">Directly after the closing brace of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.445.1">onAppear</span></strong><span class="koboSpan" id="kobo.446.1"> modifier for the left leg, add </span><span class="No-Break"><span class="koboSpan" id="kobo.447.1">this code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.448.1">
    //MARK: - ROPE
    ///right side rope masked
    Image("rope").resizable().aspectRatio(contentMode:
      .fit)
        .mask(LinearGradient(gradient: fadeOutRope,
          startPoint: .top, endPoint: .bottom))
        .frame(width: 57, height: 80)
        .offset(x: -189, y: -100)
    ///left side rope masked
    Image("rope").resizable().aspectRatio(contentMode:
      .fit)
        .mask(LinearGradient(gradient: fadeOutRope,
          startPoint: .top, endPoint: .bottom))
        .frame(width: 57, height: 80)
        .offset(x: -228, y: -108)</span></pre>
<p><span class="koboSpan" id="kobo.449.1">We need two pieces of rope because the swing has two pieces, a right piece and a left piece. </span><span class="koboSpan" id="kobo.449.2">For this reason, I added two blocks of code, one for each piece. </span></p>
<p><span class="koboSpan" id="kobo.450.1">The code to add the rope is</span><a id="_idIndexMarker352"/><span class="koboSpan" id="kobo.451.1"> nothing new; we’re just using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.452.1">Image</span></strong><span class="koboSpan" id="kobo.453.1"> initializer to pass in our rope image and setting the aspect ratio to </span><strong class="source-inline"><span class="koboSpan" id="kobo.454.1">fit</span></strong><span class="koboSpan" id="kobo.455.1">. </span><span class="koboSpan" id="kobo.455.2">But what is new here is that we’re using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.456.1">mask</span></strong><span class="koboSpan" id="kobo.457.1"> modifier. </span><span class="koboSpan" id="kobo.457.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.458.1">mask</span></strong><span class="koboSpan" id="kobo.459.1"> modifier applies a masking view to the view it’s</span><a id="_idIndexMarker353"/><span class="koboSpan" id="kobo.460.1"> called on. </span><span class="koboSpan" id="kobo.460.2">The masking view defines the visible area of the view it is applied to, and any parts of the view that fall outside of the masking view’s frame will not </span><span class="No-Break"><span class="koboSpan" id="kobo.461.1">be visible.</span></span></p>
<p><span class="koboSpan" id="kobo.462.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.463.1">mask</span></strong><span class="koboSpan" id="kobo.464.1"> modifier takes a single parameter, which is the view that will be used as the mask. </span><span class="koboSpan" id="kobo.464.2">If we pass in </span><strong class="source-inline"><span class="koboSpan" id="kobo.465.1">gradient</span></strong><span class="koboSpan" id="kobo.466.1"> as we’re doing here, we can gradually fade out the rope as it extends upward. </span><span class="koboSpan" id="kobo.466.2">This is where the </span><strong class="source-inline"><span class="koboSpan" id="kobo.467.1">LinearGradient</span></strong><span class="koboSpan" id="kobo.468.1"> function and our </span><strong class="source-inline"><span class="koboSpan" id="kobo.469.1">fadeOutRope</span></strong><span class="koboSpan" id="kobo.470.1"> property come into play; the latter contains an array of gradient colors (two colors actually, clear and black) that we pass into the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.471.1">LinearGradient</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.472.1"> function.</span></span></p>
<p><span class="koboSpan" id="kobo.473.1">We also need to consider the </span><strong class="source-inline"><span class="koboSpan" id="kobo.474.1">startPoint</span></strong><span class="koboSpan" id="kobo.475.1"> (where you want to start blending in the next color) and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.476.1">endPoint</span></strong><span class="koboSpan" id="kobo.477.1"> (where you want to end one color and start another color). </span><span class="koboSpan" id="kobo.477.2">In our code, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.478.1">startPoint</span></strong><span class="koboSpan" id="kobo.479.1"> for the gradient is at the top of the rope image, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.480.1">endPoint</span></strong><span class="koboSpan" id="kobo.481.1"> is at the bottom of the rope image. </span><span class="koboSpan" id="kobo.481.2">The reason why we want the start point at the top is so that it will have a clear color so we can fade out the rope as it </span><span class="No-Break"><span class="koboSpan" id="kobo.482.1">moves upward.</span></span></p>
<p><span class="koboSpan" id="kobo.483.1">In the final two lines of code, we set the size of the left and right rope images and offset them so they fit perfectly over the rope that’s attached to the swing. </span><span class="koboSpan" id="kobo.483.2">This is the result of adding the two rope images with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.484.1">mask</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.485.1"> modifier:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer083">
<span class="koboSpan" id="kobo.486.1"><img alt="Figure 6.12: Our animation after adding the mask modifier " src="image/B18674_06_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.487.1">Figure 6.12: Our animation after adding the mask modifier</span></p>
<p><span class="koboSpan" id="kobo.488.1">If you run the app </span><a id="_idIndexMarker354"/><span class="koboSpan" id="kobo.489.1">now, you’ll see that the rope extends up and fades away </span><a id="_idIndexMarker355"/><span class="koboSpan" id="kobo.490.1">at the top. </span><span class="koboSpan" id="kobo.490.2">This looks much better because now the rope appears to be somewhere near </span><span class="No-Break"><span class="koboSpan" id="kobo.491.1">the branch.</span></span></p>
<p><span class="koboSpan" id="kobo.492.1">To improve this even further, we can partially cover up the end of the rope by adding the leaves image to the </span><a id="_idIndexMarker356"/><span class="koboSpan" id="kobo.493.1">scene. </span><span class="koboSpan" id="kobo.493.2">To do this, add this final bit of code at the very end of the </span><span class="No-Break"><span class="koboSpan" id="kobo.494.1">first </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.495.1">ZStack</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.496.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.497.1">
Image("leaves").resizable().aspectRatio(contentMode: .fit)
        .frame(width: 460, height: 400)
        .rotationEffect(.degrees(-10), anchor: .trailing)
        .offset(x: -50, y: -180)</span></pre>
<p><span class="koboSpan" id="kobo.498.1">This is familiar code that we have used already, adding leaves to the scene, setting an appropriate </span><strong class="source-inline"><span class="koboSpan" id="kobo.499.1">aspectRatio</span></strong><span class="koboSpan" id="kobo.500.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.501.1">frame</span></strong><span class="koboSpan" id="kobo.502.1"> size, rotating it to the correct angle, which is perpendicular to the</span><a id="_idIndexMarker357"/><span class="koboSpan" id="kobo.503.1"> branch, and finally locating it on the x-and y-axis with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.504.1">offset</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.505.1"> modifier.</span></span></p>
<p><span class="koboSpan" id="kobo.506.1">Now the rope at the top is partially hidden by the leaves, giving the effect that it's tied off somewhere up in </span><span class="No-Break"><span class="koboSpan" id="kobo.507.1">the branch:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer084">
<span class="koboSpan" id="kobo.508.1"><img alt="Figure 6.13: Our completed animation " src="image/B18674_06_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.509.1">Figure 6.13: Our completed animation</span></p>
<p><span class="koboSpan" id="kobo.510.1">And </span><a id="_idIndexMarker358"/><span class="koboSpan" id="kobo.511.1">with that, the </span><a id="_idIndexMarker359"/><span class="koboSpan" id="kobo.512.1">project is complete. </span><span class="koboSpan" id="kobo.512.2">Run it and see what </span><span class="No-Break"><span class="koboSpan" id="kobo.513.1">you think.</span></span></p>
<h1 id="_idParaDest-90"><a id="_idTextAnchor094"/><span class="koboSpan" id="kobo.514.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.515.1">In this project, we learned how to take an image and cut out various parts at the joints, use those new images in code, and animate them in different and interesting ways. </span><span class="koboSpan" id="kobo.515.2">We also worked with modifiers that we have worked with before, including </span><strong class="source-inline"><span class="koboSpan" id="kobo.516.1">rotation</span></strong><span class="koboSpan" id="kobo.517.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.518.1">scale</span></strong><span class="koboSpan" id="kobo.519.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.520.1">offset</span></strong><span class="koboSpan" id="kobo.521.1">, but also a new </span><span class="No-Break"><span class="koboSpan" id="kobo.522.1">modifier, </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.523.1">mask</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.524.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.525.1">There are ways to take this project further. </span><span class="koboSpan" id="kobo.525.2">If you’re feeling curious, see whether you can cut the arms and head from the picture, and then give them some animation as well. </span><span class="koboSpan" id="kobo.525.3">Play around with the parameters so you can make each part move just enough to look natural. </span><span class="koboSpan" id="kobo.525.4">Maybe you can make the arms pivot at the elbow just slightly as the swing moves forward and backward. </span><span class="koboSpan" id="kobo.525.5">Add a button if you want so you can start and stop the animation that way. </span><span class="koboSpan" id="kobo.525.6">Mainly, just experiment and </span><span class="No-Break"><span class="koboSpan" id="kobo.526.1">have fun!</span></span></p>
<p><span class="koboSpan" id="kobo.527.1">In the next project, we will look at the three different axes of rotation, </span><em class="italic"><span class="koboSpan" id="kobo.528.1">x</span></em><span class="koboSpan" id="kobo.529.1">, </span><em class="italic"><span class="koboSpan" id="kobo.530.1">y</span></em><span class="koboSpan" id="kobo.531.1">, and </span><em class="italic"><span class="koboSpan" id="kobo.532.1">z</span></em><span class="koboSpan" id="kobo.533.1">, and create an animation that will rotate a fan using gears and chains, similar to a bicycle chain that turns </span><span class="No-Break"><span class="koboSpan" id="kobo.534.1">its gears.</span></span></p>
</div>
<div>
<div class="IMG---Figure" id="_idContainer086">
</div>
</div>
</body></html>