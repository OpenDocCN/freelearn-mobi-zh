<html><head></head><body>
        <section>

            <header>
                <h1 class="header-title">Managing Inputs</h1>
            </header>

            <article>
                
<p>Now that we have learned how to run a program on the Android Emulator, it is time for us to do some more cool stuff, which will equip us with the knowledge required to make our game. In this chapter, we will continue with XML files and will step into the territory of taking user inputs. In a gist, we will be learning the following:</p>
<ul>
<li>Exploring different types of XML files and the resource folder further</li>
<li>Creating buttons and linking them to take inputs</li>
<li>Working with accelerometer readings</li>
<li>Mobile touch inputs</li>
</ul>
<p>So, let's get started.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Resource folder in detail</h1>
            </header>

            <article>
                
<p>In the last chapter, we used the <kbd>activity_fullscreen.xml</kbd> file to edit the frontend of our application. Now, we will take a look at some more of these XML files and understand how they can be useful to us for making games. To understand these type of files, we must first know a little bit about them. To start off, the very basic information about XML is that it's a short form of <em>Extensible Markup Language</em>. Now, if you have studied HTML, you will know that its full form is quite similar to it--HyperText Markup Language. It's quite similar in syntax as well, but the function of an XML file is to hold data. If you go by the definition of an XML file, it goes something like this: XML is a software and hardware-independent tool for storing and transporting data.</p>
<p>You can read more about XML files at <a href="https://en.wikipedia.org/wiki/XML">https://en.wikipedia.org/wiki/XML</a>.<br/>
We have not yet seen an XML file in the code yet, so let's do that. Click on <span class="packt_screen">Text</span> as shown in the following screenshot:</p>
<p><img class="image-border" height="369" src="assets/B05066_01_33.png" width="691"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">The <span class="packt_screen">Text</span> mode for code editing is just besides the <span class="packt_screen">Design</span> button<br/></div>
<p class="CDPAlignLeft CDPAlign">Now, you can actually see the XML code opened up:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="369" src="assets/B05066_01_34.png" width="691"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">This is your default XML code</div>
<p class="CDPAlignLeft CDPAlign">Pay close attention to this code, and you will find something like this:</p>
<div class="CDPAlignLeft CDPAlign">
<pre>
&lt;<span>TextView<br/></span><span>    </span><span>android</span><span>:text=</span><span>"Hello World!"<br/></span><span>    </span><span>android</span><span>:layout_width=</span><span>"wrap_content"<br/></span><span>    </span><span>android</span><span>:layout_height=</span><span>"wrap_content"<br/></span><span>    </span><span>android</span><span>:id=</span><span>"@+id/TextView"<br/></span><span>    </span><span>tools</span><span>:text=</span><span>"helloWorld"<br/></span><span>    </span><span>android</span><span>:textAppearance=</span><span>"@style/TextAppearance.AppCompat.Headline" </span>/&gt;
</pre></div>
<p class="CDPAlignLeft CDPAlign">If you see this, you can observe your <kbd>Hello World!</kbd> text on the very first line of this code. The data that we changed visually in our previous chapter can be changed through code over here. It is almost the same for all components, and you will learn about different components as you practice further.</p>
<p class="CDPAlignLeft CDPAlign">Now, this is not the only type of XML file. As we read in the definition, XML files are used to store data. Let's see the other kinds of XML files, which can be used to store data. We can use these files for storing game scores, filenames, text data, and so much more. Let's take one such new type of XML file, which is already available in our project folder to understand further:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="373" src="assets/B05066_01_35.png" width="699"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">The strings.xml file contains all your string data and is in the <span class="packt_screen">res/values/</span> folder</div>
<p class="CDPAlignLeft CDPAlign">Navigate to the <kbd>app/res/values/</kbd> folder and double-click on the <span class="packt_screen">strings.xml</span> file.</p>
<p class="CDPAlignLeft CDPAlign">You can see the code for this file when you open it. Here, you can observe that there are multiple values and an ID to each value in the form of a <kbd>name</kbd>. Observe carefully the second line that reads as follows:</p>
<div class="CDPAlignLeft CDPAlign">
<pre>
&lt;<span>string </span><span>name=</span><span>"app_name"</span>&gt;First Game&lt;/<span>string</span>&gt;
</pre></div>
<p class="CDPAlignLeft CDPAlign">Remember this name? We had set this as our app name when we started the project. It is stored in the value <kbd>app_name</kbd>. Also, if you go back and search for <kbd>app_name</kbd> using <em>Ctrl</em> + <em>F </em>on your <kbd>activity_fullscreen.xml</kbd> file, you will find this entry. Go ahead and explore a little for yourself.</p>
<p class="CDPAlignLeft CDPAlign">Also, check out the other files to get an understanding. Here's a basic explanation for the four XML files in our project folder:</p>
<ul>
<li><kbd>attrs.xml</kbd>: This declares custom theme attributes that allow changing the styles that are used for button bars, depending on the API level</li>
<li><kbd>colors.xml</kbd>: <span>This d</span>efines colors that can be used in hex code</li>
<li><kbd>strings.xml</kbd>: <span>This h</span>olds data for all string-related values</li>
<li><kbd>styles.xml</kbd>: <span>This s</span>ets the base theme of the application</li>
</ul>
<p class="CDPAlignLeft CDPAlign">So, that's it about XML files. Let's now move on to something even more interesting--inputs.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Taking user inputs</h1>
            </header>

            <article>
                
<p class="CDPAlignLeft CDPAlign">There are multiple ways in which you can take inputs from your Android device. Here are a few ways:</p>
<ul>
<li>UI buttons: Buttons drawn on your app's UI</li>
<li>Hardware buttons: The keys on your Android device</li>
<li>Touch screen inputs: Touches mapped based on the screen coordinates</li>
<li>Accelerometer readings: Motion sensor readings</li>
</ul>
<p>We will be taking a look at each of these input types. So, let's start with the very first type of input, UI buttons.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Button input</h1>
            </header>

            <article>
                
<p>The button input is one of the most common type of components used in an Android project. Let's come back to our design mode and create a button on the screen:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="373" src="assets/B05066_01_36.png" width="699"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Reverting back to <span class="packt_screen">Design</span> mode from <span class="packt_screen">Text</span> mode</div>
<p class="CDPAlignLeft CDPAlign">Click on the <span class="packt_screen">Design</span> button and switch back to our visual editor mode on our <span class="packt_screen">activity_fullscreen.xml</span> file.</p>
<p class="CDPAlignLeft CDPAlign">Here, we will need to do some changes to our XML file. Follow the steps as mentioned:</p>
<ol>
<li>From the <span class="packt_screen">Palette</span>, scroll down and find <span class="packt_screen">Linear Layout(Horizontal)</span> and drag and drop it inside the <span class="packt_screen">fullscreen_content_controls.</span></li>
<li>In the <span class="packt_screen">Component Tree</span> window below the <span class="packt_screen">Palette</span>, drag and drop your <span class="packt_screen">TextView</span> under your newly created <span class="packt_screen">LinearLayout(horizontal)</span>.</li>
<li>Select the <span class="packt_screen">Button</span> component from your <span class="packt_screen">Palette</span> and drag and drop it in into your <span class="packt_screen">Component Tree</span> window's <span><span class="packt_screen">LinearLayout(<span>h</span><span>orizontal).</span></span></span></li>
</ol>
<p>Once you do this, you will get an output like this:</p>
<p><img class="image-border" src="assets/B05066_03_05.png"/></p>
<p class="CDPAlignLeft CDPAlign">You now have a button and text on the screen.</p>
<p class="CDPAlignLeft CDPAlign">If we had not used the <span class="packt_screen">Linear Layout</span> component, then our button and text would have overlapped each other since if you observe in your <span class="packt_screen">Component Tree</span> our <span class="packt_screen">TextView</span> was initially inside <span class="packt_screen">FrameLayout</span>, which does not have alignment options. You can try dragging your button and text inside the <span class="packt_screen">FrameLayout</span> and see for yourself.</p>
<p class="CDPAlignLeft CDPAlign">Now, let's proceed toward making this button work. Click on your newly created button, and in the properties window on right side, take a look at the <span class="packt_screen">ID</span> property. This is the property that lets your code know which button to interact with; change it to <kbd>myFirstButton</kbd>:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="522" src="assets/B05066_03_06.png" width="293"/></div>
<p class="CDPAlignLeft CDPAlign">You have now given a custom ID to your button.</p>
<p class="CDPAlignLeft CDPAlign">Repeat the same for your <span class="packt_screen">TextView</span> by changing its ID to <kbd>myTextView</kbd>. Keep these two IDs in mind, and let's move on to our next step. Now, we will actually link this visual button to our code, so we can change the text of our <span class="packt_screen">TextView</span> component. Go to your <kbd>app/java/nikhil.nikmlnkr.game</kbd> folder and open up the <span class="packt_screen">FullscreenActivity</span>.</p>
<div class="CDPAlignLeft CDPAlign packt_infobox">Note that <kbd>nikhil.nikmlnkr.game</kbd> is the package name used in this book. Your package name might be different based on what you set it initially, so navigate to the folder based on your package name. For the purpose of this book, we will assume the package name is <kbd>nikhil.nikmlnkr.game</kbd>.</div>
<p class="CDPAlignLeft CDPAlign">After we open that file, we will have opened the main Java code for our application. You can see that there is already a lot of code written over there. Don't get overwhelmed by it because soon you will understand on your own what each code block is about. Let's start by writing some code of our own to get started to link our button to our code file; search for the <kbd>void onCreate</kbd> function.</p>
<p class="CDPAlignLeft CDPAlign">The <kbd>onCreate()</kbd> method is where you initialize your activity. If the activity is started and the application is not loaded, then both <kbd>onCreate()</kbd> methods will be called. You can initialize your variables and methods over here.<br/>
You can see something like this:</p>
<div class="CDPAlignLeft CDPAlign">
<pre>
<span>    @Override<br/></span><span>    protected void </span>onCreate(Bundle savedInstanceState) {<br/><span>        super</span>.onCreate(savedInstanceState);<br/><br/>        setContentView(R.layout.<span>activity_fullscreen</span>);<br/><span><br/>        mVisible </span>= <span>true</span>;<br/><span>        mControlsView </span>= findViewById<br/>        (R.id.<span>fullscreen_content_controls</span>);<br/><span>        mContentView </span>= findViewById(R.id.<span>fullscreen_content</span>);<br/><span><br/>        // Manually show or hide the System UI<br/></span><span>        mContentView</span>.setOnClickListener(<span>new </span>View.OnClickListener(){<br/><span>            @Override<br/></span><span>            public void </span>onClick(View view) {<br/>                toggle();<br/>            }<br/>        });<br/><span><br/>        /* Upon interacting with UI controls, delay any scheduled hide()</span><span> <br/>        operations to prevent the jarring behavior of controls going away</span><span> while <br/>        interacting with the UI.*/<br/><br/></span>        findViewById(R.id.<span>dummy_button</span>).<br/>        setOnTouchListener(<span>mDelayHideTouchListener</span>);<br/>    }
</pre></div>
<p class="CDPAlignLeft CDPAlign">Now, modify it to look somewhat like this; changes are marked in bold:</p>
<div class="CDPAlignLeft CDPAlign">
<pre>
<span>    @Override<br/></span><span>    protected void </span>onCreate(Bundle savedInstanceState) {<br/><span>        super</span>.onCreate(savedInstanceState);<br/><br/>        setContentView(R.layout.<span>activity_fullscreen</span>);<br/><strong>        // Declare variable references for our TextView and Button with<br/></strong><strong>        // their IDs<br/></strong><strong>        final TextView tv = <br/>        (TextView)findViewById(R.id.myTextView);<br/></strong><strong>        final Button button = <br/>        (Button) findViewById(R.id.myFirstButton);</strong><br/><strong><br/>        // Make an OnClickListener to listen to button click events<br/></strong><strong>        button.setOnClickListener(new View.OnClickListener() {<br/></strong><strong>            public void onClick(View v) {<br/></strong><strong>                // Perform action on click<br/>                tv.setText("Button Clicked");</strong><br/><strong>            }<br/></strong><strong>        });<br/></strong><span>        mVisible </span>= <span>true</span>;<br/><span>        mControlsView </span>= <br/>        findViewById(R.id.<span>fullscreen_content_controls</span>);<br/><span>        mContentView </span>= <br/>        findViewById(R.id.<span>fullscreen_content</span>);<br/><br/><span><br/>        // Manually show or hide the System UI<br/></span><span>        mContentView</span>.setOnClickListener(<span>new </span>View.OnClickListener(){<br/><span>            @Override<br/></span><span>            public void </span>onClick(View view) {<br/>                toggle();<br/>            }<br/>        });<br/><br/><span>        // Upon interacting with UI controls, delay any scheduled hide()<br/></span><span>        // operations to prevent the jarring behavior of controls going<br/></span><span>        // away while interacting with the UI.<br/></span><br/>        findViewById(R.id.<span>dummy_button</span>).<br/>        setOnTouchListener(<span>mDelayHideTouchListener</span>);<br/>    }
</pre></div>
<p class="CDPAlignLeft CDPAlign">By writing this code, you have done the following:</p>
<ul>
<li>Linked your button's ID to your code</li>
<li>Linked your text view's ID to your code</li>
<li>Created a button click listener, which is needed, to take input from a button</li>
</ul>
<p>Once you are ready with this, run your app on the emulator with the steps we learned in the preceding chapter: </p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="395" src="assets/B05066_03_07.png" width="216"/></div>
<p class="CDPAlignLeft CDPAlign">On pressing our <span class="packt_screen">Button</span>, the text will change to <span class="packt_screen">Button Clicked</span>, as we coded in our file.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Hardware button input</h1>
            </header>

            <article>
                
<p>Now, let's test out our hardware buttons along with a Toast example. Don't feel hungry yet reading Toast! It's not the one that you are going to eat. A Toast is a message that gets displayed on your screen for a few seconds and disappears. You will see what it is in a few minutes. So, now open up your <kbd>FullscreenActivity.java</kbd> file where you typed your <kbd>onCreate</kbd> code, and after your <kbd>onCreate</kbd> method, type the following:</p>
<pre>
<span>    @Override<br/></span><span>    public void </span>onBackPressed() {<br/><span>        // your code.<br/></span>        Toast.<span>makeText</span>(FullscreenActivity.<span>this</span>, <br/><span>        "Back button pressed"</span>, Toast.<span>LENGTH_SHORT</span>).show();<br/>    }
</pre>
<p>Observe the code here. In the first line, we have used the keyword <kbd>@Override</kbd>. This is because we are overriding the parent class functionality, which is the default Android behavior to do something else that we want. If you do not override the function, then by default Android will close the app since that is the function of the back button.</p>
<p>If you are getting an error on Toast with a red underline, then click on the text where you are getting the error and then press <em>Alt</em> + <em>Enter</em>. This will add the missing imports that are required to be included for running it. Once you are done with it, run your app again on the emulator, and you will see the following output:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="530" src="assets/B05066_03_08.png" width="288"/></div>
<p>So, now you have successfully mapped your hardware button to display a Toast message. Bravo! Let's move ahead and try to track our touch coordinates.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Touch input</h1>
            </header>

            <article>
                
<p>Now that we have seen how to map our hardware buttons, let's dive deeper into the most commonly used input on Android: touch input. However, before we understand touch input, we must understand the coordinate system used to track touches on the screen. Let's take a look at the following illustration to understand this:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="195" src="assets/B05066_03_09.png" width="329"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Coordinates system in Android</div>
<p class="CDPAlignLeft CDPAlign">In order to track our touches, we must have a basic understanding of how screen coordinates are mapped on our device. As you can see in the preceding image, our screen's coordinates start from (0,0) at the top-left corner and end at the bottom-right corner with <strong>(w,h)</strong> where w is the screen width and h is the screen height. So, let's say if your phone's resolution is 480 x 850, then your bottom-right corner coordinates will be <kbd>w=480</kbd>, <kbd>h=850</kbd>. Thus, your extreme coordinates will be mapped as (480,850). Just keep this in mind, and you will understand the reason why we need to know this shortly.</p>
<p class="CDPAlignLeft CDPAlign">Now, open up your XML file and drag and drop another <span class="packt_screen">TextView</span> component:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/B05066_03_10.png"/></div>
<p class="CDPAlignCenter CDPAlign CDPAlignLeft">Give it an <span class="packt_screen">ID</span> <kbd>coords</kbd> and <span class="packt_screen">text</span> as <kbd>Coords</kbd>:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/B05066_03_11.png"/></div>
<p class="CDPAlignLeft CDPAlign">Now, click on your <span class="packt_screen">LinearLayout</span> from the <span class="packt_screen">Component Tree</span> view and give it an <span class="packt_screen">ID</span> as <kbd>parent</kbd><span class="packt_screen">.</span></p>
<p class="CDPAlignLeft CDPAlign">Now, go to your <kbd>FullscreenActivity.java</kbd> code file and modify your <kbd>onCreate</kbd> function to look like this:</p>
<pre>
<span>    @Override<br/></span><span>    protected void </span>onCreate(Bundle savedInstanceState) {<br/><span>        super</span>.onCreate(savedInstanceState);<br/><br/>        setContentView(R.layout.<span>activity_fullscreen</span>);<br/><span>        final </span>TextView tv = <br/>        (TextView) findViewById(R.id.<span>myTextView</span>);<br/><span>        final </span>Button button = <br/>        (Button) findViewById(R.id.<span>myFirstButton</span>);<br/><br/>        button.setOnClickListener(<span>new </span>View.OnClickListener() {<br/><span>            public void </span>onClick(View v) {<br/><span>                // Perform action on click<br/></span><span>                tv</span>.setText(<span>"Button Clicked"</span>);<br/>            }<br/>        });<br/><span>        mVisible </span>= <span>true</span>;<br/><span>        mControlsView </span>=<br/>        findViewById(R.id.<span>fullscreen_content_controls</span>);<br/><span>        mContentView </span>=<br/>        findViewById(R.id.<span>fullscreen_content</span>);<br/><span>        <br/>        final </span>LinearLayout parent = <br/>        (LinearLayout) findViewById(R.id.parent);<br/><span><br/>        final </span>TextView text = (TextView) findViewById(R.id.<span>coords</span>);<br/><br/>        parent.setOnTouchListener(<span>new </span>View.OnTouchListener() {<br/><span>            public boolean </span>onTouch(View v, MotionEvent ev) {<br/><span>                text</span>.setText<br/>                (<span>"Touch at " </span>+ ev.getX() + <span>", " </span>+ ev.getY());<br/><span>                return true</span>;<br/>        }<br/>    });<br/><span><br/>    // Set up the user interaction to manually show or hide the system UI.<br/></span><span>    mContentView</span>.setOnClickListener(<span>new </span>View.OnClickListener() {<br/><span>        @Override<br/></span><span>        public void </span>onClick(View view) {<br/>            toggle();<br/>        }<br/>    });<br/><span><br/>    // Upon interacting with UI controls, delay any scheduled hide()<br/></span><span>    // operations to prevent the jarring behavior of controls going<br/></span><span>    // away while interacting with the UI.<br/></span><span> <br/></span>    findViewById(R.id.<span>dummy_button</span>).<br/>    setOnTouchListener(<span>mDelayHideTouchListener</span>);<br/>    }
</pre>
<p>To give an explanation for the preceding code, what we have done over here is quite simple: we have declared a reference for our <span class="packt_screen">LinearLayout</span> as <kbd>parent</kbd> and then another reference for our newly created <span class="packt_screen">coords(</span><span class="packt_screen">TextView)</span>. Now, after our declaration, we instructed the <kbd>parent</kbd> class to have a <kbd>Touch listener</kbd> property on it. This will help us get the coordinates that we touched. As you can see in the preceding code, we have a <kbd>MotionEvent</kbd> variable <kbd>ev</kbd>, which will give us the coordinates. Then, in the next line, we fetched the value in the form of <em>x</em> and <em>y</em> coordinates, which will then be set as text on our <span class="packt_screen">coords(TextView)</span>.</p>
<p>Go ahead and run your code now, and when the emulator starts, try clicking randomly anywhere; that will give you coordinates that you just touched:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/B05066_03_12.png"/></div>
<p class="CDPAlignLeft CDPAlign">It will show you where you touched on the screen.</p>
<p>Now, by this time, you must have observed that it is pretty tedious to drag and drop and align all the texts properly, right? That is because we are working with <span class="packt_screen">LinearLayout</span>. There is a way through which you can organize all your texts properly. That is through <span class="packt_screen">RelativeLayout</span>. Let's take a look at a working example to help you get a better understanding of the same. Go to the <span class="packt_screen">TextView</span> of your XML file as we learned to do in the preceding chapter, and wherever you see <span class="packt_screen">LinearLayout</span> change it to <span class="packt_screen">RelativeLayout</span>. Here is a reference code for the same:</p>
<pre>
&lt;<span>RelativeLayout<br/></span><span>    </span><span>android</span><span>:orientation=</span><span>"horizontal"<br/></span><span>    </span><span>android</span><span>:layout_width=</span><span>"match_parent"<br/></span><span>    </span><span>android</span><span>:layout_height=</span><span>"match_parent"<br/></span><span>    </span><span>android</span><span>:id=</span><span>"@+id/parent"</span>&gt;<br/><br/>    &lt;<span>Button<br/></span><span>        </span><span>android</span><span>:text=</span><span>"Button"<br/></span><span>        </span><span>android</span><span>:layout_width=</span><span>"wrap_content"<br/></span><span>        </span><span>android</span><span>:layout_height=</span><span>"wrap_content"<br/></span><span>        </span><span>android</span><span>:id=</span><span>"@+id/myFirstButton"<br/></span><span>        </span><span>android</span><span>:layout_weight=</span><span>"1" </span>/&gt;<br/><br/>    &lt;<span>TextView<br/></span>        android:text="Hello World!"<br/>        android:layout_width="wrap_content"<br/>        android:layout_height="wrap_content"<br/>        android:id="@+id/myTextView"<span class="underline"><br/></span><span>        </span><span>tools</span><span>:text=</span><span>"helloWorld"<br/></span><span>        </span><span>android</span><span>:textAppearance=</span><span>"@style/TextAppearance.AppCompat.Headline"<br/></span><span>        </span><span>android</span><span>:layout_weight=</span><span>"1"<br/></span><span>        </span><span>android</span><span>:layout_alignBaseline=</span><span>"@+id/myFirstButton"<br/></span><span>        </span><span>android</span><span>:layout_alignBottom=</span><span>"@+id/myFirstButton"<br/></span><span>        </span><span>android</span><span>:layout_toRightOf=</span><span>"@+id/myFirstButton"<br/></span><span>        </span><span>android</span><span>:layout_toEndOf=</span><span>"@+id/myFirstButton" </span>/&gt;<br/><br/>    &lt;<span>TextView<br/></span><span>        </span><span>android</span><span>:text=</span><span>"Coords"<br/></span><span>        </span><span>android</span><span>:layout_width=</span><span>"wrap_content"<br/></span><span>        </span><span>android</span><span>:layout_height=</span><span>"wrap_content"<br/></span><span>        </span><span>android</span><span>:id=</span><span>"@+id/coords"<br/></span><span>        </span><span>android</span><span>:layout_weight=</span><span>"1"<br/></span><span>        </span><span>android</span><span>:textAppearance=</span><span>"@style/TextAppearance.AppCompat.Headline"<br/></span><span>        </span><span>android</span><span>:layout_below=</span><span>"@+id/myFirstButton"<br/></span><span>        </span><span>android</span><span>:layout_alignRight=</span><span>"@+id/myFirstButton"<br/></span><span>        </span><span>android</span><span>:layout_alignEnd=</span><span>"@+id/myFirstButton" </span>/&gt;<br/>&lt;/<span>RelativeLayout</span>&gt;
</pre>
<p>Now, you have successfully converted your <span class="packt_screen">LinearLayout</span> to <span class="packt_screen">RelativeLayout</span>, which will give you more control over your design options. You can now adjust your components on screen with more ease, and so you can align them nicely as follows:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/B05066_03_13.png"/></div>
<p>Once you do this, you can easily adjust your texts by simply dragging them anywhere you want. You won't mess up the layouts when you use <span class="packt_screen">RelativeLayouts</span>. Now, let's move on to the next example for getting accelerometer inputs, and take another <span class="packt_screen">TextView</span> component on screen for that as you see in the preceding code and give it an <span class="packt_screen">ID</span> <kbd>accel</kbd> with a <span class="packt_screen">text</span> <kbd>Accelerometer</kbd>. However, before we proceed with the code for the same, there is a minor change that we need to do in our existing code.</p>
<p>Since we just changed our <span class="packt_screen">LinearLayout</span> to <span class="packt_screen">RelativeLayout</span>, we also have to reference the same for our touch function in our Java code file. Open up your Java code file, and there you will observe that it is already giving you an error prompt on <span class="packt_screen">LinearLayout</span>. That is because there is actually no <span class="packt_screen">LinearLayout</span> in our project with the ID <span class="packt_screen">parent</span> because we changed it to <span class="packt_screen">RelativeLayout</span>. Don't worry about this though; simply type in <span class="packt_screen">RelativeLayout</span> instead of <span class="packt_screen">LinearLayout</span>, and you are sorted. Here is how:</p>
<pre>
<span>    @Override<br/></span><span>    protected void </span>onCreate(Bundle savedInstanceState) {<br/><span>        super</span>.onCreate(savedInstanceState);<br/><br/>        setContentView(R.layout.<span>activity_fullscreen</span>);<br/><span>        final </span>TextView tv = <br/>        (TextView) findViewById(R.id.<span>myTextView</span>);<br/><span>        final </span>Button button =<br/>        (Button) findViewById(R.id.<span>myFirstButton</span>);<br/><br/>        button.setOnClickListener(<span>new </span>View.OnClickListener() {<br/><span>            public void </span>onClick(View v) {<br/><span>                // Perform action on click<br/></span><span>                tv</span>.setText(<span>"Button Clicked"</span>);<br/>            }<br/>        });<br/><span>        mVisible </span>= <span>true</span>;<br/><span>        mControlsView </span>=<br/>        findViewById(R.id.<span>fullscreen_content_controls</span>);<br/><span><br/>        mContentView </span>= <br/>        findViewById(R.id.<span>fullscreen_content</span>);<br/><span><br/>        final </span>RelativeLayout parent = <br/>        (RelativeLayout) findViewById(R.id.<span>parent</span>);<br/><span><br/>        final </span>TextView text = <br/>        (TextView) findViewById(R.id.<span>coords</span>);<br/>        parent.setOnTouchListener(<span>new </span>View.OnTouchListener() {<br/><span>            public boolean </span>onTouch(View v, MotionEvent ev) {<br/><span>                text</span>.setText<br/>                (<span>"Touch at " </span>+ ev.getX() + <span>", " </span>+ ev.getY());<br/><span>                return true</span>;<br/>            }<br/>        });<br/><span>        <br/>        // Set up the user interaction to manually show or hide the system UI.<br/></span><span>        mContentView</span>.setOnClickListener(<span>new </span>View.OnClickListener(){<br/><span>            @Override<br/></span><span>            public void </span>onClick(View view) {<br/>                toggle();<br/>            }<br/>        });<br/><span><br/>        // Upon interacting with UI controls, delay any scheduled hide()<br/></span><span>        // operations to prevent the jarring behavior of controls going<br/></span><span>        // away while interacting with the UI.<br/></span><span>   <br/></span>        findViewById(R.id.<span>dummy_button</span>).<br/>        setOnTouchListener(<span>mDelayHideTouchListener</span>);<br/>    }
</pre>
<p>Run your app once, and you can see how neat it looks now:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/B05066_03_14.png"/></div>
<p>Now, we have successfully made pretty neat adjustments to our layout as well as implemented a touch listener to detect touches.</p>
<p>Now, we move on to our final type of input for this chapter, <em>The Accelerometer input</em>.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">The Accelerometer input</h1>
            </header>

            <article>
                
<p>We will now take a look at the accelerometer component on Android. If you don't know what an accelerometer is, it is something that is used to detect movement in Android. In layman terms, we can call it the motion sensor. The best example for this is any racing game that lets you control the car based on your phone's movement. This is something really interesting, which you can use in further chapters to apply motion to objects, so make sure that you grasp this properly. Type in the code you see in the following block starting from <kbd>sensorManager</kbd>:</p>
<pre>
<span>    @Override<br/></span><span>    protected void </span>onCreate(Bundle savedInstanceState) {<br/><span>        super</span>.onCreate(savedInstanceState);<br/><br/>        setContentView(R.layout.<span>activity_fullscreen</span>);<br/><span>        final </span>TextView tv = <br/>        (TextView) findViewById(R.id.<span>myTextView</span>);<br/><span><br/>        final </span>Button button = <br/>        (Button) findViewById(R.id.<span>myFirstButton</span>);<br/><br/>        button.setOnClickListener(<span>new </span>View.OnClickListener() {<br/><span>            public void </span>onClick(View v) {<br/><span>                // Perform action on click<br/></span><span>                tv</span>.setText(<span>"Button Clicked"</span>);<br/>            }<br/>        });<br/><span>        mVisible </span>= <span>true</span>;<br/><span>        mControlsView </span>=<br/>        findViewById(R.id.<span>fullscreen_content_controls</span>);<br/><span>        mContentView </span>=<br/>        findViewById(R.id.<span>fullscreen_content</span>);<br/><br/><span>        final </span>RelativeLayout parent =<br/>        (RelativeLayout) findViewById(R.id.<span>parent</span>);<br/><span>        <br/>        final </span>TextView text = <br/>        (TextView) findViewById(R.id.<span>coords</span>);<br/><br/>        parent.setOnTouchListener(<span>new </span>View.OnTouchListener() {<br/><span>            public boolean </span>onTouch(View v, MotionEvent ev) {<br/><span>                text</span>.setText<br/>                (<span>"Touch at " </span>+ ev.getX() + <span>", " </span>+ ev.getY());<br/><span>                return true</span>;<br/>            }<br/>        });<br/>        SensorManager sensorManager = <br/>        (SensorManager) getSystemService(Context.<span>SENSOR_SERVICE</span>);<br/>        Sensor sensor =<br/>        sensorManager.getDefaultSensor(Sensor.<span>TYPE_ACCELEROMETER</span>);<br/><br/>        sensorManager.registerListener(<span>new </span>SensorEventListener() {<br/><span>            @Override<br/></span><span>            public void </span>onSensorChanged(SensorEvent event) {<br/><span><br/>                float </span>x = event.<span>values</span>[<span>0</span>];<br/><span>                float </span>y = event.<span>values</span>[<span>1</span>];<br/><span>                float </span>z = event.<span>values</span>[<span>2</span>];<br/>                TextView acc = (TextView) findViewById(R.id.<span>accel</span>);<br/>                acc.setText(<span>"x: "</span>+x+<span>", y: "</span>+y+<span>", z: "</span>+z);<br/><br/>            }<br/><span><br/>            @Override<br/></span><span>            public void </span>onAccuracyChanged(Sensor sensor, <br/><span>            int </span>accuracy){<br/>            }<br/>        }, sensor, SensorManager.<span>SENSOR_DELAY_FASTEST</span>);<br/><span>        // Set up the user interaction to manually show or hide the system UI.<br/></span><span>        mContentView</span>.setOnClickListener(<span>new </span>View.OnClickListener(){<br/><span>            @Override<br/></span><span>            public void </span>onClick(View view) {<br/>                toggle();<br/>            }<br/>        });<br/><span>        // Upon interacting with UI controls, delay any scheduled hide()<br/></span><span>        // operations to prevent the jarring behavior of controls going <br/></span><span>        // away while interacting with the UI.<br/></span><br/>        findViewById(R.id.<span>dummy_button</span>).<br/>        setOnTouchListener(<span>mDelayHideTouchListener</span>);<br/>    }
</pre>
<p>Again, over here if you get an error related to import statements while typing, then press <em>Alt</em> + <em>Enter</em> and you will be prompted with suggestions. Select the corresponding import statement from the list to solve the error. Now, the code will be explained. We made a variable for our <kbd>sensorManager</kbd> component of Android, which is responsible for tracking our <kbd>accelerometer</kbd> values. As you can see after the line following it, we have taken the sensor type as <kbd>TYPE_ACCELEROMETER</kbd>. Next, we created another listener for our component and then we took in the <kbd>x</kbd>, <kbd>y</kbd>, and <kbd>z</kbd> values. After that, we simply took a reference to the <span class="packt_screen">accel</span> <span class="packt_screen">TextView</span> component in our XML file and set its text to display those values.</p>
<p>Now, it is obvious that you won't be able to see accelerometer values changing on your emulator, so you will have to test it on your mobile device. However, just for curiosity's sake, try and run the code on your computer:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/B05066_03_15.png"/></div>
<p class="CDPAlignLeft CDPAlign">You will see some values, but they will not be changing because our PC does not have a motion sensor.</p>
<p>So, let's run our app on our mobile now. We can do this in two ways:</p>
<ul>
<li>Build and deploy directly to our device through USB, which will allow us to run the app directly on a physical device</li>
<li>Build an apk and then transfer the apk file to our phone and install it</li>
</ul>
<p>Let's start!</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Building and deploying through USB</h1>
            </header>

            <article>
                
<p class="CDPAlignLeft CDPAlign">To make your device ready for debugging you need to enable your device for debugging first. In order to enable your device for debugging in <span class="packt_screen">Developer options</span>. To access these settings, open the Developer options in the system settings. On Android 4.2 and higher versions, the Developer options screen is hidden by default. To make it visible, go to <span class="packt_screen">Settings</span> | <span class="packt_screen">About phone</span> and tap on <span class="packt_screen">Build number</span> seven times:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="476" src="assets/B05066_03_21.png" width="267"/></div>
<p class="CDPAlignLeft CDPAlign">After this, return to the previous screen to find Developer options at the bottom:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="414" src="assets/B05066_03_22.png" width="233"/></div>
<p class="CDPAlignCenter CDPAlign CDPAlignLeft">Now, enable the USB debugging option on your device:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="496" src="assets/B05066_03_23.png" width="279"/></div>
<p>With an Android-powered device, you can develop and debug your Android applications just as you would on the emulator. Before you can start, there are just a few things to do:</p>
<p>Verify that your application is debuggable in your manifest or <kbd>build.gradle</kbd> file.</p>
<p>In the build file, make sure that the <kbd>debuggable</kbd> property in the <kbd>debug</kbd> build type is set to true. The build type property overrides the manifest setting:</p>
<pre>
android {<br/>    buildTypes {<br/>        debug {<br/>            debuggable true<br/>        }
</pre>
<p>In the <kbd>AndroidManifest.xml</kbd> file, add <kbd>android:debuggable="true"</kbd> to the <kbd>&lt;application&gt;</kbd> element.</p>
<div class="note packt_infobox">Note: If you manually enable debugging in the manifest file, ensure that you disable it in your release build (your published application should usually <em>not</em> be debuggable).</div>
<ol>
<li>Enable <span class="packt_screen">USB debugging</span> in the device system settings, under <span class="packt_screen">Settings</span> | <span class="packt_screen">Developer options</span>.
<div class="note packt_infobox">Note: On Android 4.2 and newer versions, <span class="packt_screen">Developer options</span> is hidden by default. To make it available, go to <span class="packt_screen">Settings</span> | <span class="packt_screen">About phone</span> and tap on <span class="packt_screen">Build number</span> seven times. Return to the previous screen to find <span class="packt_screen">Developer options</span>.</div>
</li>
<li>Set up your system to detect your device:
<ul>
<li>If you're developing on Windows, you need to install a USB driver for ADB. For an installation guide and links to OEM drivers, refer to the <a href="https://developer.android.com/tools/extras/oem-usb.html">OEM USB Drivers</a> document.</li>
<li>If you're developing on macOS X, it just works, so skip this step.</li>
<li>If you're developing on Ubuntu Linux, you need to add a udev rules file that contains a USB configuration for each type of device you want to use for development. In the rules file, each device manufacturer is identified by a unique vendor ID, as specified by the ATTR{idVendor} property. For a list of vendor IDs, refer to <a href="https://developer.android.com/studio/run/device.html#VendorIds">USB Vendor IDs</a>, as follows. To set up device detection on Ubuntu Linux, perform the following:
<ol>
<li>Log in as root and create this file: <kbd>/etc/udev/rules.d/51-android.rules</kbd>.
<p>Use the following format to add each vendor to the file:<br/>
<kbd>SUBSYSTEM=="usb", ATTR{idVendor}=="0bb4", MODE="0666", GROUP="plugdev"</kbd><br/>
<br/>
In this example, the vendor ID is for HTC. The MODE assignment specifies read/write permissions, and GROUP defines which Unix group owns the device node.</p>
<div class="note packt_infobox">Note: The rule syntax may vary slightly depending on your environment. Consult the udev documentation for your system as needed. For an overview of rule syntax, refer to this guide at <a href="http://www.reactivated.net/writing_udev_rules.html">writing udev rules</a>.</div>
</li>
<li>Now, execute <kbd>chmod a+r /etc/udev/rules.d/51-android.rules</kbd>.</li>
</ol>
</li>
</ul>
</li>
</ol>
<div class="note packt_infobox">Note: When you connect a device running Android 4.2.2 or higher versions to your computer, the system shows a dialog asking whether to accept an RSA key that allows debugging through this computer. This security mechanism protects user devices because it ensures that USB debugging and other ADB commands cannot be executed unless you're able to unlock the device and acknowledge the dialog. This requires that you have ADB version 1.0.31 (available with SDK Platform-tools r16.0.1 and higher) in order to debug on a device running Android 4.2.2 or higher versions.</div>
<p>When plugged in over USB, you can verify that your device is connected by executing ADB devices from your SDK platform-tools/ directory. If connected, you'll see the device name listed as a device.</p>
<p>On pressing run or debugging your application, you will be presented with a Device Chooser dialog that lists the available emulator(s) and connected device(s). Select the device on which you want to install and run the application.</p>
<p>If using the <strong>Android Debug Bridge</strong> (<strong>ADB</strong>), you can issue commands with the <kbd>-d</kbd> flag to target your connected device.<br/>
You can find the vendor IDs at <a href="https://developer.android.com/studio/run/device.html">https://developer.android.com/studio/run/device.html</a>.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Building an apk and installing on device</h1>
            </header>

            <article>
                
<p>From the top task bar where you see <span class="packt_screen">File</span>, <span class="packt_screen">Edit</span>, and so on, click on <span class="packt_screen">Build</span> and then click on <span class="packt_screen">Generate APK</span>. Once you have done this, it will start generating an apk for you. Once it is finished right-click on your <span class="packt_screen">app</span> folder, which is on the left-hand side, as seen in the following screenshot, and click on <span class="packt_screen">Show in Explorer</span>:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/B05066_03_16.png"/></div>
<p class="CDPAlignLeft CDPAlign"><span class="packt_screen">Show in Explorer</span> will open the window in which your project folder is located:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/B05066_03_17.png"/></div>
<p>In your project folder, navigate to the <kbd>app/build/outputs/apk/</kbd> folder, and there you will see your <kbd>app-debug.apk</kbd> file. Transfer this onto your mobile phone and install the apk and run it:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="471" src="assets/B05066_03_18.png" width="264"/></div>
<p class="CDPAlignLeft CDPAlign">Click on <span class="packt_screen">Install</span>:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="475" src="assets/B05066_03_19.png" width="267"/></div>
<p class="CDPAlignLeft CDPAlign">Click on <span class="packt_screen">Open</span>:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="321" src="assets/B05066_03_20.png" width="180"/></div>
<p class="CDPAlignLeft CDPAlign">Accelerometer values will change as you move your phone around.</p>
<p>Congratulations! You also learned how to create an apk and run it on your actual device.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Summary</h1>
            </header>

            <article>
                
<p>In this chapter, you have learned how to take different types of user inputs and also how to generate an apk and run it on your actual device. You also learned the various types of XML files.</p>
<p>In the next chapter, we will learn how to create sprites--no, not the cold drink! We will learn how to create images as well as play with colors. The next chapter will be our entry into creating graphics on screen and will be a big step for you.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    </body></html>