<html><head></head><body>
<div id="sbo-rt-content"><div class="Basic-Text-Frame" id="_idContainer153">
<h1 class="chapterNumber">10</h1>
<h1 class="chapterTitle" id="_idParaDest-255">Implementing Razor Components</h1>
<p class="normal">In the previous chapter, we explored Blazor routing and layout and, subsequently, built a navigation framework by establishing our app’s routing and layout. Upon setting up the navigation framework, we crafted top-level pages. The implementation of Razor pages allows for password database navigation, akin to the XAML version. While Razor pages are indeed Razor components, they are not reusable. In this chapter, we will introduce the creation of reusable Razor components. Furthermore, we will delve into data binding and the Razor component lifecycle to foster a comprehensive understanding of these aspects. Armed with this knowledge, we will optimize our code by converting duplicate code into reusable Razor components. Ultimately, we will use the Razor components to implement CRUD operations within our app.</p>
<p class="normal">We will cover the following topics in this chapter:</p>
<ul>
<li class="bulletList">Understanding Razor components</li>
<li class="bulletList">Creating a Razor class library</li>
<li class="bulletList">Creating reusable Razor components</li>
<li class="bulletList">Understanding the Razor component lifecycle</li>
<li class="bulletList">Refactoring Razor components</li>
<li class="bulletList">Using templated components</li>
</ul>
<h1 class="heading-1" id="_idParaDest-256">Technical requirements</h1>
<p class="normal">To test and debug the source code in this chapter, you need to have Visual Studio 2022 installed on your PC or Mac. Please refer to the <em class="italic">Development environment setup</em> section in <em class="chapterRef">Chapter 1</em>, <em class="italic">Getting Started with .NET MAUI</em>, for details.</p>
<p class="normal">The source code for this chapter is available in the following GitHub repository: <a href="https://github.com/PacktPublishing/.NET-MAUI-Cross-Platform-Application-Development-Second-edition/tree/d5302ca26a3c362a291785a9771d87ad8552bdb2"><span class="url">https://github.com/PacktPublishing/.NET-MAUI-Cross-Platform-Application-Development-Second-</span><span class="url">edition/tree/main/2nd/chapter10</span></a>.</p>
<p class="normal">To check out the source code of this chapter, you can use the below command:</p>
<pre class="programlisting con"><code class="hljs-con">$ git clone -b 2nd/chapter10 https://github.com/PacktPublishing/.NET-MAUI-Cross-Platform-Application-Development-Second-edition.git PassXYZ.Vault2
</code></pre>
<p class="normal">To find out more about the source code in this book, please refer to the <em class="italic">Managing the source code</em> section in this book, in <em class="chapterRef">Chapter 2</em>, <em class="italic">Building Our First .NET MAUI App</em>.</p>
<h1 class="heading-1" id="_idParaDest-257">Understanding Razor components</h1>
<p class="normal">Although we <a id="_idIndexMarker751"/>developed and utilized Razor components in the previous two chapters, we have not yet delved deeply into them. In this section, we will continue refining the app from the last chapter while exploring Razor components more thoroughly, thereby gaining a better understanding of key concepts surrounding these components.</p>
<p class="normal">Blazor apps are constructed using Razor components. The first Razor component in our app is <code class="inlineCode">Main</code>, and it is defined in <code class="inlineCode">Main.razor</code>, as illustrated below:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">Router</span><span class="hljs-tag"> </span><span class="hljs-attr">AppAssembly</span><span class="hljs-tag">=</span><span class="hljs-string">"@typeof(Main).Assembly"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">Found</span><span class="hljs-tag"> </span><span class="hljs-attr">Context</span><span class="hljs-tag">=</span><span class="hljs-string">"routeData"</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">RouteView</span><span class="hljs-tag"> </span><span class="hljs-attr">RouteData</span><span class="hljs-tag">=</span><span class="hljs-string">"@routeData"</span>
<span class="hljs-tag">      </span><span class="hljs-attr">DefaultLayout</span><span class="hljs-tag">=</span><span class="hljs-string">"@typeof(MainLayout)"</span><span class="hljs-tag"> /&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">FocusOnNavigate</span><span class="hljs-tag"> </span><span class="hljs-attr">RouteData</span><span class="hljs-tag">=</span><span class="hljs-string">"@routeData"</span><span class="hljs-tag"> </span><span class="hljs-attr">Selector</span><span class="hljs-tag">=</span><span class="hljs-string">"h1"</span><span class="hljs-tag"> /&gt;</span>
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">Found</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">NotFound</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">LayoutView</span><span class="hljs-tag"> </span><span class="hljs-attr">Layout</span><span class="hljs-tag">=</span><span class="hljs-string">"@typeof(MainLayout)"</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag"> </span><span class="hljs-attr">role</span><span class="hljs-tag">=</span><span class="hljs-string">"alert"</span><span class="hljs-tag">&gt;</span>
        Sorry, there's nothing at this address.
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">LayoutView</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">NotFound</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">Router</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">The <code class="inlineCode">Router</code> component, which<a id="_idIndexMarker752"/> is installed within the <code class="inlineCode">Main</code> component, takes care of routing pages and selecting the default layout component. All other Razor pages are managed by the <code class="inlineCode">Router</code> components. These Razor pages, loaded by the <code class="inlineCode">Router</code>, have route templates defined and serve to display the user interface. In our project, Razor pages can be found in the <code class="inlineCode">Pages</code> folder.</p>
<p class="normal">To understand the startup sequence of the Blazor Hybrid app, we can refer to <em class="italic">Figure 10.1</em> below:</p>
<figure class="mediaobject"><img alt="" height="472" src="../Images/B21554_10_01.png" width="824"/></figure>
<p class="packt_figref">Figure 10.1: Startup of the Blazor Hybrid app</p>
<p class="normal">As a .NET MAUI application, the starting point of the Blazor Hybrid app is also the <code class="inlineCode">MauiProgram</code> class <strong class="keyWord">(1)</strong>. Within the <code class="inlineCode">MauiProgram</code> class, an instance of the <code class="inlineCode">App</code> class <strong class="keyWord">(2)</strong> is constructed. The first XAML page to be loaded into this is the <code class="inlineCode">MainPage</code> <strong class="keyWord">(3)</strong> class. This <code class="inlineCode">MainPage</code> includes an instance of <code class="inlineCode">BlazorWebView</code> <strong class="keyWord">(4)</strong> that hosts the Blazor pages. For further information on how the Razor component <code class="inlineCode">Main</code> is loaded into <code class="inlineCode">BlazorWebView</code>, please refer to <em class="chapterRef">Chapter 8</em><em class="italic">, Introducing Blazor Hybrid App Development</em>. Once the <code class="inlineCode">Main</code> component is loaded into <code class="inlineCode">BlazorWebView</code>, it exhibits the root of the navigation stack. In this particular scenario, the root page of the navigation stack is the <code class="inlineCode">Login</code> page.</p>
<p class="normal">Additionally, there are reusable Razor components that act as the building blocks of Razor pages. These Razor components are stored in the <code class="inlineCode">Shared</code> folder.</p>
<p class="normal">Essentially, each file possessing a <code class="inlineCode">.razor</code> file extension represents a Razor component, which is compiled into a C# class upon execution. The filename serves as the class name, while the folder name contributes to the namespace. For instance, the <code class="inlineCode">Login</code> Razor component resides in the <code class="inlineCode">Pages</code> folder, so the folder name <code class="inlineCode">Pages</code> is included as part of the namespace. Thus, the complete name of the <code class="inlineCode">Login</code> class is <code class="inlineCode">PassXYZ.Vault.Pages.Login</code>.</p>
<p class="normal">Razor components <a id="_idIndexMarker753"/>can be written either in a single file or divided into a Razor file (<code class="inlineCode">.razor</code>) and a code-behind C# file (<code class="inlineCode">.cs</code>). The code-behind C# file defines a partial class containing all the programming logic. This approach was employed when we created the <code class="inlineCode">Login</code> component in <em class="chapterRef">Chapter 8</em><em class="italic">, Introducing Blazor Hybrid App Development</em>.</p>
<figure class="mediaobject"><img alt="Figure 9.1: Razor component naming convention" height="236" src="../Images/B21554_10_02.png" width="524"/></figure>
<p class="packt_figref">Figure 10.2: Razor component naming convention</p>
<p class="normal">As shown in <em class="italic">Figure 10.2</em>, when creating the <code class="inlineCode">Login</code> component, we incorporated the Bootstrap CSS style for styling purposes. Razor components offer CSS isolation, which simplifies CSS usage and prevents collisions with other components or libraries. Moreover, Razor components <a id="_idIndexMarker754"/>can include their own CSS style in a <code class="inlineCode">.razor.css</code> file.</p>
<h2 class="heading-2" id="_idParaDest-258">Inheritance</h2>
<p class="normal">As a <a id="_idIndexMarker755"/>Razor component is a C# class, it encompasses all features inherent to a C# class. Consequently, a Razor component can serve as a child class of another Razor component. In <em class="chapterRef">Chapter 9</em><em class="italic">, Understanding Blazor Layout and Routing</em>, we observed that all layout components are derived classes of <code class="inlineCode">LayoutComponentBase</code> when creating layout components. As illustrated in the <code class="inlineCode">MainLayout.razor</code> code below, we employ the <code class="inlineCode">@inherits</code> directive to specify the <code class="inlineCode">LayoutComponentBase</code> as the base class:</p>
<pre class="programlisting code"><code class="hljs-code">@inherits LayoutComponentBase
<span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"page"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"sidebar"</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">NavMenu</span><span class="hljs-tag">/&gt;&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">main</span><span class="hljs-tag">&gt;</span>@Body<span class="hljs-tag">&lt;/</span><span class="hljs-name">main</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">Every Razor component is derived from the <code class="inlineCode">ComponentBase</code> class. As a result, it is feasible to create a Razor component derived from the <code class="inlineCode">ComponentBase</code> class using a C# file, without requiring a Razor markup file. For instance, we can create an <code class="inlineCode">AppName</code> Razor component within a C# class, demonstrated as follows:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">using</span> Microsoft.AspNetCore.Components;
<span class="hljs-keyword">using</span> Microsoft.AspNetCore.Components.Rendering;
<span class="hljs-keyword">namespace</span> <span class="hljs-title">PassXYZ.Vault.Pages</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AppName</span> : <span class="hljs-title">ComponentBase</span>
{
  <span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">BuildRenderTree</span>
<span class="hljs-function">    (</span><span class="hljs-params">RenderTreeBuilder builder</span><span class="hljs-function">)</span>
  {
    <span class="hljs-keyword">base</span>.BuildRenderTree(builder);
    builder.OpenElement(<span class="hljs-number">0</span>, <span class="hljs-string">"div"</span>);
    builder.AddContent(<span class="hljs-number">1</span>, <span class="hljs-string">"PassXYZ.Vault"</span>);
    builder.CloseElement();
  }
}
</code></pre>
<p class="normal"><code class="inlineCode">AppName</code> is a Razor component that is designed without a Razor markup file (<code class="inlineCode">.razor</code>); however, it functions identically to other Razor components, as demonstrated here:</p>
<pre class="programlisting code"><code class="hljs-code">...
<span class="hljs-tag">&lt;</span><span class="hljs-name">AppName</span><span class="hljs-tag">/&gt;</span>
...
</code></pre>
<p class="normal">The above example is used to demonstrate how to create a Razor component in C# code. However, it’s generally recommended to create UI components utilizing Razor markup instead of C# code.</p>
<p class="normal">In this section, we introduced Razor components. We can place reusable Razor components in a shared folder to ensure that they are accessible throughout the project. Additionally, a Razor class library can be created to share Razor components across multiple projects. In the subsequent section, we will delve into the process of packaging these Razor components into a library.</p>
<h1 class="heading-1" id="_idParaDest-259">Creating a Razor class library</h1>
<p class="normal">In our project, we create<a id="_idIndexMarker756"/> reusable components and store them in the <code class="inlineCode">Shared</code> folder. These components can be utilized by other components, such as layout components or <code class="inlineCode">NavMenu</code>. Additionally, we can encapsulate Razor components within the Razor class library, making them accessible for use across various projects. </p>
<p class="normal">The components in the Razor class library are not specific to a single project, making them suitable for use in any Blazor project, whether it be Blazor Hybrid, Blazor WebAssembly, or Blazor Server apps.</p>
<p class="normal">In this book, we construct Razor components utilizing Bootstrap. Numerous open-source Razor class libraries built on top of Bootstrap can be found on GitHub. Several of these libraries are sufficiently robust for commercial product development. Below are a few examples:</p>
<ul>
<li class="bulletList"><code class="inlineCode">BootstrapBlazor</code>: <a href="https://github.com/dotnetcore/BootstrapBlazor"><span class="url">https://github.com/dotnetcore/BootstrapBlazor</span></a></li>
<li class="bulletList"><code class="inlineCode">Blazorise</code>: <a href="https://github.com/Megabit/Blazorise"><span class="url">https://github.com/Megabit/Blazorise</span></a></li>
<li class="bulletList"><code class="inlineCode">Havit.Blazor</code>: <a href="https://github.com/havit/Havit.Blazor/"><span class="url">https://github.com/havit/Havit.Blazor/</span></a></li>
</ul>
<p class="normal">These open-source projects are constructed as Razor class libraries, enabling their reuse in a manner analogous to other .NET libraries. Razor class libraries can be published as <code class="inlineCode">NuGet</code> packages, allowing for seamless integration into our Blazor projects. For example, the <code class="inlineCode">BootstrapBlazor</code> library can be found at this link: <a href="https://www.nuget.org/packages/BootstrapBlazor/"><span class="url">https://www.nuget.org/packages/BootstrapBlazor/</span></a>.</p>
<p class="normal">In this section, we will develop a Razor class library similar to the aforementioned open-source projects. We will incorporate reusable Razor components within our Razor class library. This library can then be published as a NuGet package. We have the option to create a Razor class library using either Visual Studio or the .NET command line.</p>
<p class="normal">To create a Razor class library using Visual Studio, we can add a new project to our solution, as illustrated in <em class="italic">Figure 10.3</em>, by following these steps:</p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1">Search for and select <strong class="screenText">Razor Class Library</strong> from the project templates.</li>
<li class="numberedList">Click <strong class="screenText">Next</strong>, and name the project <strong class="screenText">PassXYZ.BlazorUI</strong>.</li>
<li class="numberedList">On the subsequent screen, click <strong class="screenText">Create</strong> to establish the library.</li>
</ol>
<figure class="mediaobject"><img alt="Figure 9.2: Creating a Razor class library" height="499" src="../Images/B21554_10_03.png" width="759"/></figure>
<p class="packt_figref">Figure 10.3: Creating a Razor class library</p>
<p class="normal">To create the <a id="_idIndexMarker757"/>project using a dotnet command line, we can navigate to the solution folder and execute the following command in the Command Prompt:</p>
<pre class="programlisting con"><code class="hljs-con">dotnet new razorclasslib -n PassXYZ.BlazorUI
</code></pre>
<p class="normal">The <code class="inlineCode">dotnet new</code> command creates a new project utilizing the <code class="inlineCode">razorclasslib</code> template, naming the project <code class="inlineCode">PassXYZ.BlazorUI</code>. In order to include the project in the solution, we can execute the following command:</p>
<pre class="programlisting con"><code class="hljs-con">dotnet sln add PassXYZ.BlazorUI\PassXYZ.BlazorUI.csproj
</code></pre>
<p class="normal">In order to create our Razor components using this skeleton project, we must remove the unused <code class="inlineCode">Component1.*</code> and <code class="inlineCode">ExampleJsInterop.cs</code> files from the <code class="inlineCode">PassXYZ.BlazorUI</code> project.</p>
<p class="normal">To utilize Razor components in the <code class="inlineCode">PassXYZ.BlazorUI</code> project, we must include the project reference within the <code class="inlineCode">PassXYZ.Vault</code> project. To do so, we can simply right-click the project node in Visual Studio and select <code class="inlineCode">Add -&gt; Project Reference</code>. Alternatively, we can directly modify the <code class="inlineCode">PassXYZ.Vault.csproj</code> project file by adding the following line:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">ItemGroup</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">ProjectReference</span>
<span class="hljs-tag">    </span><span class="hljs-attr">Include</span><span class="hljs-tag">=</span><span class="hljs-string">"..\PassXYZ.BlazorUI\PassXYZ.BlazorUI.csproj"</span>
<span class="hljs-tag">      /&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">ItemGroup</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">In order to<a id="_idIndexMarker758"/> create a new Razor component utilizing this library, we must update the <code class="inlineCode">PassXYZ.Vault\_Imports.razor</code> file by adding the following line:</p>
<pre class="programlisting code"><code class="hljs-code">@using PassXYZ.BlazorUI
</code></pre>
<h2 class="heading-2" id="_idParaDest-260">Using static assets in the Razor class library</h2>
<p class="normal">We employ <a id="_idIndexMarker759"/>Bootstrap within our Razor components, so it’s <a id="_idIndexMarker760"/>necessary to include Bootstrap CSS and JavaScript files in the Razor class library. From the perspective of a Blazor app, we can place these static assets in either the project’s <code class="inlineCode">wwwroot</code> folder or the component library’s <code class="inlineCode">wwwroot</code> folder. Taking the Bootstrap CSS file as an example, if we store it in the project’s <code class="inlineCode">wwwroot</code> directory, we can reference it in <code class="inlineCode">index.xhtml</code> using the following path:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">script</span><span class="hljs-tag"> </span><span class="hljs-attr">src</span><span class="hljs-tag">=</span><span class="hljs-string">"css/bootstrap/bootstrap.bundle.min.js"</span><span class="hljs-tag">/&gt;</span>
</code></pre>
<p class="normal">If we opt to store it in the component library’s <code class="inlineCode">wwwroot</code> folder, we can reference it using the following path:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">script</span><span class="hljs-tag"> </span><span class="hljs-attr">src</span><span class="hljs-tag">=</span><span class="hljs-string">"_content/PassXYZ.BlazorUI/css/bootstrap/</span>
<span class="hljs-string">  bootstrap.bundle.min.js"</span><span class="hljs-tag">/&gt;</span>
</code></pre>
<p class="normal">The distinction<a id="_idIndexMarker761"/> lies in the necessity to reference the URL in the <a id="_idIndexMarker762"/>component library, which should begin with <code class="inlineCode">_content/{LibraryProjectName}</code>.</p>
<p class="normal">Once we have established a Razor class library project, we can proceed to include additional components in it.</p>
<h1 class="heading-1" id="_idParaDest-261">Creating reusable Razor components</h1>
<p class="normal">In this section, we will<a id="_idIndexMarker763"/> refactor our code to develop reusable components. This process will enable us to gain a deeper understanding of the features of Razor components and learn how to optimize them to improve reusability.</p>
<p class="normal">In <em class="chapterRef">Chapter 8</em><em class="italic">, Introducing Blazor Hybrid App Development</em>, we created the Blazor Hybrid version of our app. Additionally, we incorporated layout and routing functionalities in <em class="chapterRef">Chapter 9</em><em class="italic">, Understanding Blazor Routing and Layout</em>. As a result, our app can now browse and update the password database. However, we have not yet implemented the majority of CRUD operations. After refining the Razor components in this chapter, we will proceed to add these functionalities.</p>
<p class="normal">To navigate the password database, we developed two Razor components – <code class="inlineCode">Items</code> and <code class="inlineCode">ItemDetail</code>. The <code class="inlineCode">Items</code> class is employed to exhibit a list of password entries and groups within the current group, while the <code class="inlineCode">ItemDetail</code> class is utilized for presenting the content of an individual password entry.</p>
<p class="normal">Upon examining the layout of <code class="inlineCode">Items</code> and <code class="inlineCode">ItemDetail</code>, as illustrated in <em class="italic">Figure 10.4</em>, we can observe that both pages possess a similarity in terms of their appearance and overall design.</p>
<figure class="mediaobject"><img alt="Figure 9.3: UI layout of Items and ItemDetail" height="546" src="../Images/B21554_10_04.png" width="825"/></figure>
<p class="packt_figref">Figure 10.4: UI layout of Items and ItemDetail</p>
<p class="normal">The layout of both <a id="_idIndexMarker764"/>pages features a sidebar, a header, and a list view. The sidebar is defined in the <code class="inlineCode">layout</code> component, while the header and list view are implemented in both <code class="inlineCode">Items</code> and <code class="inlineCode">ItemDetail</code> with partially duplicated code. In this chapter, we will optimize our code by abstracting the duplicated portions into reusable components.</p>
<p class="normal">There are two buttons in the header: <code class="inlineCode">Add</code> and <code class="inlineCode">Back</code>. The <code class="inlineCode">Back</code> button allows for navigation back to the parent group, while the <code class="inlineCode">Add</code> button enables the user to add a new item or field.</p>
<p class="normal">In the list view item, we can utilize the context menu to execute item-level operations, such as editing or deleting. The context menu comprises menu items designated for specific actions related to the selected item or field. When performing edit or delete CRUD operations, upon selecting a menu item, a modal dialog relevant to the chosen action will appear.</p>
<p class="normal">In the present implementation, both <code class="inlineCode">Items</code> and <code class="inlineCode">ItemDetail</code> incorporate all UI elements within a single Razor markup. We will begin to streamline the code by breaking it down into smaller, reusable components, which will result in a cleaner implementation.</p>
<p class="normal">In this chapter, we will transform modal dialogs, headers, and list views into Razor components. Let’s begin with modal dialogs. To facilitate adding, editing, and deleting operations, we require two types of dialog boxes:</p>
<ul>
<li class="bulletList">Editor dialog: for adding or editing items or fields</li>
<li class="bulletList">Confirmation dialog: for confirmation prior to deleting an item or a field</li>
</ul>
<p class="normal">In <em class="chapterRef">Chapter 9</em>, <em class="italic">Understanding Blazor Routing and Layout</em>, we implemented modal dialogs by utilizing HTML<a id="_idIndexMarker765"/> and CSS code from Bootstrap examples. However, we have not examined these elements thoroughly, as our markup files appear lengthy and intricate. In this chapter, we will dissect the code and convert it into Razor components.</p>
<h2 class="heading-2" id="_idParaDest-262">Creating a base modal dialog component</h2>
<p class="normal">To <a id="_idIndexMarker766"/>improve the editor and confirmation dialogs, we <a id="_idIndexMarker767"/>can first construct a base modal dialog. By leveraging this base modal dialog, we can create either editor or confirmation dialogs as needed.</p>
<p class="normal">To create a new Razor component in the <code class="inlineCode">PassXYZ.BlazorUI</code> project, right-click on the project node and select <code class="inlineCode">Add</code> -&gt; <code class="inlineCode">New Item…</code> -&gt; <code class="inlineCode">Razor Component</code> from the project template. Name the Razor component <code class="inlineCode">ModalDialog</code>, and create a C# code-behind file for it. Next, enter the code shown in <em class="italic">Listing 10.1</em> into <code class="inlineCode">ModalDialog.razor</code> and the code in <em class="italic">Listing 10.2</em> into <code class="inlineCode">ModalDialog.razor.cs</code>.</p>
<p class="normal">The UI code is derived from the <code class="inlineCode">Items</code> and <code class="inlineCode">ItemDetail</code> code found in <em class="chapterRef">Chapter 9</em>, <em class="italic">Understanding Blazor Routing and Layout</em>, as depicted in <em class="italic">Listing 10.1</em>:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"modal fade"</span><span class="hljs-tag"> </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">@Id</span><span class="hljs-tag"> </span><span class="hljs-attr">tabindex</span><span class="hljs-tag">=</span><span class="hljs-string">"-1"</span>
<span class="hljs-tag">    </span><span class="hljs-attr">aria-labelledby</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">ModelLabel"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"modal-dialog"</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"modal-content"</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"modal-header"</span><span class="hljs-tag">&gt;</span>                                      <span class="hljs-comment">//(1)</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">h5</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"modal-title"</span><span class="hljs-tag"> </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"ModelLabel"</span><span class="hljs-tag">&gt;</span>@Title<span class="hljs-tag">&lt;/</span><span class="hljs-name">h5</span><span class="hljs-tag">&gt;</span>           <span class="hljs-comment">//(2)</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"button"</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">btn-close"</span><span class="hljs-tag">            </span>          <span class="hljs-tag"> </span><span class="hljs-comment">//(3)</span>
<span class="hljs-tag">        </span><span class="hljs-attr">data-bs-dismiss</span><span class="hljs-tag">=</span><span class="hljs-string">"modal"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-label</span><span class="hljs-tag">=</span><span class="hljs-string">"Close"</span><span class="hljs-tag">/&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"modal-body"</span><span class="hljs-tag">&gt;</span>                                        <span class="hljs-comment">//(4)</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">form</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"row gx-2 gy-3"</span><span class="hljs-tag">&gt;</span>
        @ChildContent                                               <span class="hljs-comment">//(5)</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"col-12"</span><span class="hljs-tag">&gt;</span>
          <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"button"</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"btn btn-secondary"</span>
<span class="hljs-tag">            </span><span class="hljs-attr">data-bs-dismiss</span><span class="hljs-tag">=</span><span class="hljs-string">"modal"</span><span class="hljs-tag"> @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span>
<span class="hljs-tag">              </span><span class="hljs-string">"OnClickClose"</span><span class="hljs-tag">&gt;</span>
            @CloseButtonText                                        <span class="hljs-comment">//(6)</span>
          <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
            <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"submit"</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"btn btn-primary"</span>
<span class="hljs-tag">              </span><span class="hljs-attr">data-bs-dismiss</span><span class="hljs-tag">=</span><span class="hljs-string">"modal"</span><span class="hljs-tag"> @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span>
<span class="hljs-tag">                </span><span class="hljs-string">"OnClickSave"</span><span class="hljs-tag">&gt;</span>
            @SaveButtonText                                         <span class="hljs-comment">//(7)</span>
          <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">form</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="packt_figref">Listing 10.1: <code class="inlineCode">ModalDialog.razor</code> (<a href="https://epa.ms/ModalDialog10-1"><span class="url">https://epa.ms/ModalDialog10-1</span></a>)</p>
<p class="normal">In the markup code displayed in <em class="italic">Listing 10.1</em>, we observe a typical HTML code snippet with Bootstrap styling. We have incorporated C# variables within the HTML to construct the component UI.</p>
<p class="normal">This base <a id="_idIndexMarker768"/>dialog UI comprises a header <strong class="keyWord">(1)</strong> and a body <strong class="keyWord">(4)</strong>. Within the header, there is a title <strong class="keyWord">(2)</strong> and a close button <strong class="keyWord">(3)</strong>. The body contains a child content area <strong class="keyWord">(5)</strong> and two buttons (<strong class="screenText">Close</strong> <strong class="keyWord">(6)</strong>/<strong class="screenText">Save</strong> <strong class="keyWord">(7)</strong>). </p>
<p class="normal">For a<a id="_idIndexMarker769"/> visual representation of the layout of this base modal dialog, please refer to <em class="italic">Figure 10.5:</em></p>
<figure class="mediaobject"><img alt="Figure 9.4: Base dialog" height="193" src="../Images/B21554_10_05.png" width="732"/></figure>
<p class="packt_figref">Figure 10.5: Base dialog</p>
<p class="normal">Although the <a id="_idIndexMarker770"/>HTML and CSS code closely <a id="_idIndexMarker771"/>resemble the Bootstrap example, we have substituted all hardcoded content with C# variables. If we were to use this modal dialog component to construct a new component, the following would serve as an example:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">ModalDialog</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">@id</span><span class="hljs-tag"> </span><span class="hljs-attr">Title</span><span class="hljs-tag">=</span><span class="hljs-string">"Please confirm"</span><span class="hljs-tag"> </span>
<span class="hljs-tag">  </span><span class="hljs-attr">OnSaveAsync</span><span class="hljs-tag">=</span><span class="hljs-string">@OnSaveClicked</span>
<span class="hljs-tag">  </span><span class="hljs-attr">SaveButtonText</span><span class="hljs-tag">=</span><span class="hljs-string">"Save"</span><span class="hljs-tag"> </span><span class="hljs-attr">CloseButtonText</span><span class="hljs-tag">=</span><span class="hljs-string">"Close"</span><span class="hljs-tag">&gt;</span>
    Do you want to delete UserName?
<span class="hljs-tag">&lt;/</span><span class="hljs-name">ModalDialog</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown-item"</span><span class="hljs-tag"> </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"modal"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">data-bs-target</span><span class="hljs-tag">=</span><span class="hljs-string">"#@Id"</span><span class="hljs-tag">&gt;</span>Please confirm<span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">In the above markup code, we define the modal dialog using the <code class="inlineCode">&lt;ModalDialog&gt;</code> component tag. Each modal dialog is assigned a unique ID for identification purposes. We can display the dialog box by clicking a button, wherein the modal dialog ID is provided to facilitate its identification.</p>
<p class="normal">Within the <code class="inlineCode">&lt;ModalDialog&gt;</code> component tag, we have assigned values to multiple attributes defined in the <code class="inlineCode">ModalDialog</code> component, including the <code class="inlineCode">ID</code>, <code class="inlineCode">title</code>, <code class="inlineCode">button text</code>, <code class="inlineCode">event handler</code>, and more.</p>
<h2 class="heading-2" id="_idParaDest-263">Data binding</h2>
<p class="normal">Rather <a id="_idIndexMarker772"/>than directly assigning a string or data to the attribute of <a id="_idIndexMarker773"/>an HTML element, we have the option to assign a variable to it. This capability is the data binding feature provided by Razor components. In this section, we will explore how to use data binding effectively. In data binding, assigning a variable to the attribute of a DOM element results in data flow from Razor components to DOM elements. Conversely, responding to a DOM event causes data to flow from DOM elements to Razor components. </p>
<p class="normal">Since we can use a Razor component in the same way as a DOM element, the data flow between child and parent Razor components resembles the data exchange between Razor components and DOM elements.</p>
<p class="normal">For instance, we can bind the <code class="inlineCode">id</code> variable to the <code class="inlineCode">Id</code> attribute of <code class="inlineCode">ModalDialog</code>, managing the button click event using the <code class="inlineCode">OnSaveClicked</code> event handler:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">ModalDialog</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">@id</span><span class="hljs-tag"> </span><span class="hljs-attr">Title</span><span class="hljs-tag">=</span><span class="hljs-string">"Please confirm"</span><span class="hljs-tag"> </span>
<span class="hljs-tag">  </span><span class="hljs-attr">OnSaveAsync</span><span class="hljs-tag">=</span><span class="hljs-string">@OnSaveClicked</span>
<span class="hljs-tag">  </span><span class="hljs-attr">SaveButtonText</span><span class="hljs-tag">=</span><span class="hljs-string">"Save"</span><span class="hljs-tag"> </span><span class="hljs-attr">CloseButtonText</span><span class="hljs-tag">=</span><span class="hljs-string">"Close"</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">In the previous example, the data flows from the <code class="inlineCode">id</code> variable to the <code class="inlineCode">Id</code> attribute of <code class="inlineCode">ModalDialog</code>. When the <code class="inlineCode">OnSaveClicked</code> event handler is invoked, the data flows back from <code class="inlineCode">ModalDialog</code> to the current context. The <code class="inlineCode">ModalDialog</code> attributes, <code class="inlineCode">Id</code> and <code class="inlineCode">OnSaveAsync</code>, are<a id="_idIndexMarker774"/> defined in the C# code-behind file. In<a id="_idIndexMarker775"/> the following section, let’s examine the C# code-behind file of <code class="inlineCode">ModalDialog</code>.</p>
<h2 class="heading-2" id="_idParaDest-264">Component parameters</h2>
<p class="normal">Razor components’ attributes <a id="_idIndexMarker776"/>can be defined using component<a id="_idIndexMarker777"/> parameters. To establish component parameters, we need to create public properties adorned with the <code class="inlineCode">[Parameter]</code> attribute.</p>
<p class="normal">In the <code class="inlineCode">ModalDialog</code> class, illustrated in <em class="italic">Listing 10.2</em>, we declare seven component parameters: <code class="inlineCode">Id</code>, <code class="inlineCode">Title</code>, <code class="inlineCode">ChildContent</code>, <code class="inlineCode">OnClose</code>, <code class="inlineCode">OnSaveAsync</code>, <code class="inlineCode">CloseButtonText</code>, and <code class="inlineCode">SaveButtonText</code>. These component parameters can be utilized in data binding:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">using</span> Microsoft.AspNetCore.Components;
<span class="hljs-keyword">using</span> System.Diagnostics;
<span class="hljs-keyword">using</span> System.Diagnostics.CodeAnalysis;
<span class="hljs-keyword">namespace</span> <span class="hljs-title">PassXYZ.BlazorUI</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ModalDialog</span> : <span class="hljs-title">IDisposable</span>
{
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span>? Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                                 <span class="hljs-comment">//(1)</span>
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span>? Title { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                              <span class="hljs-comment">//(2)</span>
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> RenderFragment ChildContent { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                <span class="hljs-comment">//(3)</span>
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> Func&lt;Task&gt;? OnClose { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                        <span class="hljs-comment">//(4)</span>
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> Func&lt;Task&lt;<span class="hljs-built_in">bool</span>&gt;&gt;? OnSaveAsync { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                <span class="hljs-comment">//(5)</span>
  [<span class="hljs-meta">Parameter</span>]
  [<span class="hljs-meta">NotNull</span>]
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span>? CloseButtonText { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                      <span class="hljs-comment">//(6)</span>
  [<span class="hljs-meta">Parameter</span>]
  [<span class="hljs-meta">NotNull</span>]
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span>? SaveButtonText { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                       <span class="hljs-comment">//(7)</span>
  <span class="hljs-keyword">private</span><span class="hljs-function"> </span><span class="hljs-keyword">async</span><span class="hljs-function"> Task </span><span class="hljs-title">OnClickClose</span><span class="hljs-function">()</span> {
    <span class="hljs-keyword">if</span> (OnClose != <span class="hljs-literal">null</span>) { <span class="hljs-keyword">await</span> OnClose(); }
  }
  <span class="hljs-keyword">private</span><span class="hljs-function"> </span><span class="hljs-keyword">async</span><span class="hljs-function"> Task </span><span class="hljs-title">OnClickSave</span><span class="hljs-function">()</span> {
    <span class="hljs-keyword">if</span> (OnSaveAsync != <span class="hljs-literal">null</span>) { <span class="hljs-keyword">await</span> OnSaveAsync(); }
  }
  <span class="hljs-keyword">void</span> IDisposable.Dispose() {
      GC.SuppressFinalize(<span class="hljs-keyword">this</span>);
  }
}
</code></pre>
<p class="packt_figref">Listing 10.2: <code class="inlineCode">ModalDialog.razor.cs</code> (<a href="https://epa.ms/ModalDialog10-2"><span class="url">https://epa.ms/ModalDialog10-2</span></a>)</p>
<p class="normal">The <a id="_idIndexMarker778"/>parameters <a id="_idIndexMarker779"/>of the <code class="inlineCode">ModalDialog</code> component are defined as follows:</p>
<ul>
<li class="bulletList"><code class="inlineCode">Id</code> <strong class="keyWord">(1)</strong>: This identifier is used to distinguish a modal dialog.</li>
<li class="bulletList"><code class="inlineCode">Title</code> <strong class="keyWord">(2)</strong>: This represents the title of the modal dialog.</li>
<li class="bulletList"><code class="inlineCode">ChildContent</code> <strong class="keyWord">(3)</strong>: This is designated for the insertion of the child component’s content. The data type that we’re referring to is a <code class="inlineCode">RenderFragment</code> delegate, which represents a segment of UI content. For more details, please refer to the following Microsoft document. We’ll dive deeper into this topic in <em class="chapterRef">Chapter 11</em>: <a href="https://learn.microsoft.com/en-us/aspnet/core/blazor/performance?view=aspnetcore-8.0#define-reusable-renderfragments-in-code"><span class="url">https://learn.microsoft.com/en-us/aspnet/core/blazor/performance?view=aspnetcore-8.0#define-reusable-renderfragments-in-code</span></a>.</li>
</ul>
<p class="normal">Two event handlers – <code class="inlineCode">OnClose</code> <strong class="keyWord">(4)</strong> and <code class="inlineCode">OnSaveAsync</code> <strong class="keyWord">(5)</strong> – are defined to manage button click actions. We can customize the text on both buttons using <code class="inlineCode">CloseButtonText</code> <strong class="keyWord">(6)</strong> and <code class="inlineCode">SaveButtonText</code> <strong class="keyWord">(7)</strong>.</p>
<p class="normal">We can handle component parameters similarly to HTML attributes. A C# field, property, or method return value can be assigned to the component parameter of <code class="inlineCode">ModalDialog</code>. Once we create the base <code class="inlineCode">ModalDialog</code> component, we can then develop <code class="inlineCode">Editor</code> and <code class="inlineCode">Confirmation</code> dialog components using it.</p>
<p class="normal">Let’s create a new modal dialog, <code class="inlineCode">ConfirmDialog</code>, which will prompt the user to confirm the deletion of an item. To create a new <code class="inlineCode">ConfirmDialog</code> component within the <code class="inlineCode">PassXYZ.BlazorUI</code> project, you can right-click on the project node and select <code class="inlineCode">Add</code> -&gt; <code class="inlineCode">New Item…</code> -&gt; <code class="inlineCode">Razor Component</code> from the project template. We can name the Razor component <code class="inlineCode">ConfirmDialog</code> and input the following code provided in <em class="italic">Listing 10.3</em>:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">ModalDialog</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">@Id</span><span class="hljs-tag"> </span><span class="hljs-attr">Title</span><span class="hljs-tag">=</span><span class="hljs-string">@($w</span><span class="hljs-tag">"</span><span class="hljs-attr">Deleting</span><span class="hljs-tag"> {</span><span class="hljs-attr">Title</span><span class="hljs-tag">}")   </span>
<span class="hljs-tag">  </span><span class="hljs-attr">OnSaveAsync</span><span class="hljs-tag">=</span><span class="hljs-string">@OnSave</span>
<span class="hljs-tag">  </span><span class="hljs-attr">SaveButtonText</span><span class="hljs-tag">=</span><span class="hljs-string">"Confirm"</span><span class="hljs-tag"> </span><span class="hljs-attr">CloseButtonText</span><span class="hljs-tag">=</span><span class="hljs-string">"Cancel"</span><span class="hljs-tag">&gt;</span>
  Please confirm to delete @Title?
<span class="hljs-tag">&lt;/</span><span class="hljs-name">ModalDialog</span><span class="hljs-tag">&gt;</span>
@code {
  [CascadingParameter(Name = "Id")]
  public string Id { get; set; } = "confirmDialog";                <span class="hljs-comment">//(1)</span>
  [Parameter]
  public string? Title { get; set; }                               <span class="hljs-comment">//(2)</span>
  [Parameter]
  public Action? OnConfirmClick { get; set; }
  async Task<span class="hljs-tag">&lt;</span><span class="hljs-name">bool</span><span class="hljs-tag">&gt;</span> OnSave() {
    OnConfirmClick?.Invoke();
    return await Task.FromResult(true);
  }
}
</code></pre>
<p class="packt_figref">Listing 10.3: <code class="inlineCode">ConfirmDialog.razor</code> (<a href="https://epa.ms/ConfirmDialog10-3"><span class="url">https://epa.ms/ConfirmDialog10-3</span></a>)</p>
<p class="normal">We define the <code class="inlineCode">Id</code> <strong class="keyWord">(1)</strong> and <code class="inlineCode">Title</code> <strong class="keyWord">(2)</strong> component parameters in the <code class="inlineCode">ConfirmDialog</code> and pass their values to the base class using data binding. Additionally, we subscribe to the <code class="inlineCode">OnSaveAsync</code> event by utilizing the <code class="inlineCode">OnSave</code> event handler. We also define our own event handler, <code class="inlineCode">OnConfirmClick</code>, as a component parameter, allowing other components to subscribe to it.</p>
<p class="normal">In the <code class="inlineCode">ConfirmDialog</code>, we actually bind parameters using nested components. In this scenario, the data flow should follow the suggested directions:</p>
<ul>
<li class="bulletList">Change notifications should move upward through the hierarchy.</li>
<li class="bulletList">New parameter values should flow downward through the hierarchy.</li>
</ul>
<p class="normal">The values for<a id="_idIndexMarker780"/> the <code class="inlineCode">Id</code> and <code class="inlineCode">Title</code> attributes are assigned <a id="_idIndexMarker781"/>by the components that utilize <code class="inlineCode">ConfirmDialog</code>, and their values cascade down to <code class="inlineCode">ModalDialog</code>. The <code class="inlineCode">Save</code> or <code class="inlineCode">Close</code> button events are initiated within the <code class="inlineCode">ModalDialog</code> component and subsequently propagate upwards through the chain to <code class="inlineCode">ConfirmDialog</code> and higher-level components. Using the <code class="inlineCode">Save</code> button as an example, the event follows the upward direction illustrated here:</p>
<pre class="programlisting code"><code class="hljs-code">onclick (DOM) -&gt; OnSaveAsync (ModalDialog) -&gt; OnConfirmClick (ConfirmDialog)
</code></pre>
<p class="normal">The process begins with the <code class="inlineCode">onclick</code> event in the DOM. <code class="inlineCode">ModalDialog</code> defines its own event, <code class="inlineCode">OnSaveAsync</code>, which is activated by the <code class="inlineCode">onclick</code> event handler. <code class="inlineCode">ConfirmDialog</code>, on the other hand, establishes<a id="_idIndexMarker782"/> its own event called <code class="inlineCode">OnConfirmClick</code>, which<a id="_idIndexMarker783"/> is initiated by the <code class="inlineCode">OnSaveAsync</code> event handler.</p>
<h2 class="heading-2" id="_idParaDest-265">Nested components</h2>
<p class="normal"><code class="inlineCode">ConfirmDialog</code> serves<a id="_idIndexMarker784"/> as an example of nested <a id="_idIndexMarker785"/>components. As demonstrated, we can embed components within other components by declaring them using HTML syntax. The embedded components appear as HTML tags, with the tag name corresponding to the component type. For instance, we can utilize <code class="inlineCode">ModalDialog</code> inside <code class="inlineCode">ConfirmDialog</code>, as illustrated here:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">ModalDialog</span><span class="hljs-tag"> </span><span class="hljs-attr">...</span><span class="hljs-tag">&gt;</span>Please confirm to delete @Title?<span class="hljs-tag">&lt;/</span><span class="hljs-name">ModalDialog</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">Nested components serve as a means to construct a component hierarchy in Blazor. In object-oriented programming languages, inheritance and composition are two methods for extending and reusing a class. In Blazor, composition is employed within nested components to enhance functionalities. Inheritance represents an <code class="inlineCode">'is-a'</code> relationship, whereas composition signifies a <code class="inlineCode">'has-a'</code> relationship. In the case of nested components, the parent component encompasses a child component.</p>
<p class="normal">In Microsoft Blazor and ASP.NET Core documents, the terms <code class="inlineCode">"ancestor"</code> and <code class="inlineCode">"descendant"</code> or <code class="inlineCode">"parent"</code> and <code class="inlineCode">"child"</code> are utilized to describe the relationship between nested components. In this context, the parent and child relationship is not one of inheritance but of composition. A more suitable term could be “outer component” or “inner component.” However, to maintain consistency with Microsoft documentation, I will not opt for alternative terms in our discussion. Please be mindful that when we discuss nested components and data binding, the ancestor and descendant relationship represents a <code class="inlineCode">"has-a"</code> relationship or a composition.</p>
<p class="normal">In our previous example, the <code class="inlineCode">ConfirmDialog</code> component serves as the outer component, while the <code class="inlineCode">ModalDialog</code> acts as the inner component. The relationship between them is such that the <code class="inlineCode">ConfirmDialog</code> contains the <code class="inlineCode">ModalDialog</code> within it.</p>
<h3 class="heading-3" id="_idParaDest-266">Child content rendering</h3>
<p class="normal">When building nested <a id="_idIndexMarker786"/>components, there are often scenarios where one component sets the content of another component. The outer component supplies the content situated between the inner component’s opening and closing tags. In the case of <code class="inlineCode">ConfirmDialog</code>, the content of <code class="inlineCode">ModalDialog</code> is configured as follows:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">ModalDialog</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">@Id</span><span class="hljs-tag"> </span><span class="hljs-attr">Title</span><span class="hljs-tag">=</span><span class="hljs-string">@($</span><span class="hljs-tag">"</span><span class="hljs-attr">Deleting</span><span class="hljs-tag"> {</span><span class="hljs-attr">Title</span><span class="hljs-tag">}")</span>
<span class="hljs-tag">  </span><span class="hljs-attr">OnSaveAsync</span><span class="hljs-tag">=</span><span class="hljs-string">@OnSave</span>
<span class="hljs-tag">    </span><span class="hljs-attr">SaveButtonText</span><span class="hljs-tag">=</span><span class="hljs-string">"Confirm"</span><span class="hljs-tag"> </span><span class="hljs-attr">CloseButtonText</span><span class="hljs-tag">=</span><span class="hljs-string">"Cancel"</span><span class="hljs-tag">&gt;</span>
    Please confirm to delete @Title?
<span class="hljs-tag">&lt;/</span><span class="hljs-name">ModalDialog</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">This is accomplished by employing a unique component parameter called <code class="inlineCode">ChildContent</code>, which is of the <code class="inlineCode">RenderFragment</code> type. In the previous code, the <code class="inlineCode">"Please confirm to delete @Title?"</code> string is assigned to the <code class="inlineCode">ChildContent</code> parameter of <code class="inlineCode">ModalDialog</code>.</p>
<p class="normal">The <code class="inlineCode">ConfirmDialog</code> represents a relatively simple example of nested components. Let’s consider another example, <code class="inlineCode">EditorDialog</code>, to further examine the features of Razor components. As previously mentioned, we require two dialog boxes to manage add, edit, and delete actions. The <code class="inlineCode">ConfirmDialog</code> serves to seek user confirmation before deleting an item or a field. In order to add or edit an item or a field, we need a dialog box equipped with editing capabilities.</p>
<p class="normal">We can follow the same procedure to create a new component, <code class="inlineCode">EditorDialog</code>. After selecting <code class="inlineCode">Add</code> -&gt; <code class="inlineCode">New Item…</code> -&gt; <code class="inlineCode">Razor Component</code> in the project template, we can assign the name <code class="inlineCode">EditorDialog</code> to the Razor component and create a corresponding C# code-behind file. Subsequently, we can input the code from <em class="italic">Listing 10.4</em> into <code class="inlineCode">EditorDialog.razor</code> and the code from <em class="italic">Listing 10.5</em> into <code class="inlineCode">EditorDialog.razor.cs</code>.</p>
<p class="normal">Let us examine the Razor markup code of <code class="inlineCode">EditorDialog</code>, as displayed in <em class="italic">Listing 10.4</em>:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">ModalDialog</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">@Id</span><span class="hljs-tag"> </span><span class="hljs-attr">Title</span><span class="hljs-tag">=</span><span class="hljs-string">@Key</span><span class="hljs-tag"> </span><span class="hljs-attr">OnSaveAsync</span><span class="hljs-tag">=</span><span class="hljs-string">@OnSaveClicked</span>
<span class="hljs-tag">  </span><span class="hljs-attr">SaveButtonText</span><span class="hljs-tag"> =</span><span class="hljs-string">"Save"</span><span class="hljs-tag"> </span><span class="hljs-attr">CloseButtonText</span><span class="hljs-tag">=</span><span class="hljs-string">"Close"</span><span class="hljs-tag">&gt;</span>
  @if (IsKeyEditingEnable) {                                        <span class="hljs-comment">//(1)</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">input</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"text"</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"form-control"</span><span class="hljs-tag"> </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">keyField"</span>
<span class="hljs-tag">       @</span><span class="hljs-attr">bind</span><span class="hljs-tag">=</span><span class="hljs-string">"Key"</span><span class="hljs-tag"> </span><span class="hljs-attr">placeholder</span><span class="hljs-tag">=</span><span class="hljs-string">@KeyPlaceHolder</span><span class="hljs-tag"> </span><span class="hljs-attr">required</span><span class="hljs-tag">&gt;</span>            <span class="hljs-comment">//(2)</span>
  }
  @ChildContent
  <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">textarea</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"form-control"</span><span class="hljs-tag"> </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"valueField"</span>
<span class="hljs-tag">      </span><span class="hljs-attr">style</span><span class="hljs-tag">=</span><span class="hljs-string">"height: 100px"</span>
<span class="hljs-tag">      </span><span class="hljs-attr">placeholder</span><span class="hljs-tag">=</span><span class="hljs-string">@ValuePlaceHolder</span>
<span class="hljs-tag">      @</span><span class="hljs-attr">bind</span><span class="hljs-tag">=</span><span class="hljs-string">"Value"</span><span class="hljs-tag"> </span><span class="hljs-attr">required</span><span class="hljs-tag"> /&gt;</span>                                     <span class="hljs-comment">//(3)</span>
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">ModalDialog</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="packt_figref">Listing 10.4: <code class="inlineCode">EditorDialog.razor</code> (<a href="https://epa.ms/EditorDialog10-4"><span class="url">https://epa.ms/EditorDialog10-4</span></a>)</p>
<p class="normal">The <code class="inlineCode">EditorDialog</code>, built using <code class="inlineCode">ModalDialog</code>, is designed for editing key-value pairs. There are two use cases we aim to support with this component: creating a new key-value pair, where both the key and value are editable, and modifying an existing key-value pair, where<a id="_idIndexMarker787"/> only the value field may need alteration. </p>
<p class="normal">To facilitate these scenarios, we use a component parameter called <code class="inlineCode">IsKeyEditingEnabled</code> <strong class="keyWord">(1)</strong> to detect the conditions. To create a new key-value pair, the key input is rendered as an <code class="inlineCode">&lt;input&gt;</code> element <strong class="keyWord">(2)</strong>, while to edit an existing key-value pair, the key is displayed as the title in the header area. In both cases, the value can be edited using a <code class="inlineCode">&lt;textarea&gt;</code> element <code class="codeHighlighted" style="font-weight: bold;">(3)</code>. This constitutes the core functionality of our <code class="inlineCode">EditorDialog</code> component.</p>
<p class="normal">As shown in <em class="italic">Figure 10.6</em>, the UI depicts two different dialogs. On the left-hand side, a dialog appears when we intend to add a new field, requiring us to input the field name and content. Meanwhile, on the right-hand side, a dialog is displayed when we aim to edit an existing URL field. The field name is presented in the title, and the content can be modified in the <code class="inlineCode">&lt;textarea&gt;</code> element.</p>
<figure class="mediaobject"><img alt="Figure 9.5: Editing a field" height="829" src="../Images/B21554_10_06.png" width="825"/></figure>
<p class="packt_figref">Figure 10.6: Editing a field</p>
<p class="normal">In the <code class="inlineCode">EditorDialog</code> component, when <a id="_idIndexMarker788"/>we edit the key and value using the <code class="inlineCode">&lt;input&gt;</code> and <code class="inlineCode">&lt;textarea&gt;</code> HTML elements, the initial value is displayed. This initial value is set from the Razor component to the DOM. Once we make changes, the data flows from the DOM back to the Razor component, exemplifying two-way data binding.</p>
<h2 class="heading-2" id="_idParaDest-267">Two-way data binding</h2>
<p class="normal">Two-way data<a id="_idIndexMarker789"/> binding can be established using <a id="_idIndexMarker790"/>the <code class="inlineCode">@bind</code> Razor directive attribute. This syntax enables an HTML element attribute to bind to a field, property, expression value, or the result of a method. In <em class="italic">Listing 10.4</em>, the value of the <code class="inlineCode">&lt;input&gt;</code> element is bound to the <code class="inlineCode">Key</code> property within the <code class="inlineCode">EditorDialog</code> component:</p>
<pre class="programlisting code"><code class="hljs-code">    <span class="hljs-tag">&lt;</span><span class="hljs-name">input</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"text"</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"form-control"</span><span class="hljs-tag"> </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"keyField"</span>
<span class="hljs-tag">       @</span><span class="hljs-attr">bind</span><span class="hljs-tag">=</span><span class="hljs-string">"Key"</span><span class="hljs-tag"> </span><span class="hljs-attr">placeholder</span><span class="hljs-tag">=</span><span class="hljs-string">@KeyPlaceHolder</span><span class="hljs-tag"> </span><span class="hljs-attr">required</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">In the case of two-way data binding, the DOM element <code class="inlineCode">&lt;input&gt;</code> value is updated whenever the <code class="inlineCode">Key</code> property undergoes a change. Similarly, when the user modifies the <code class="inlineCode">&lt;input&gt;</code> value in the DOM, the <code class="inlineCode">Key</code> property is updated accordingly.</p>
<p class="normal">In the previous example, we have the option to replace the <code class="inlineCode">@bind</code> directive attribute with two one-way data bindings, as demonstrated in the following code:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">input</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"text"</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"form-control"</span><span class="hljs-tag"> </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"keyField"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">value</span><span class="hljs-tag">=</span><span class="hljs-string">"@Key"</span>
<span class="hljs-tag">  @</span><span class="hljs-attr">onchange</span><span class="hljs-tag">=</span><span class="hljs-string">"@((ChangeEventArgs e) =&gt; Key = e?.Value?</span>
<span class="hljs-string">    .ToString())"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">placeholder</span><span class="hljs-tag">=</span><span class="hljs-string">@KeyPlaceHolder</span><span class="hljs-tag"> </span><span class="hljs-attr">required</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">Upon rendering our <code class="inlineCode">EditorDialog</code> component, the value of the <code class="inlineCode">&lt;input&gt;</code> element is derived from the <code class="inlineCode">Key</code> property. As the user inputs a value into the textbox and shifts the element focus, the <code class="inlineCode">onchange</code> event is triggered, subsequently updating the <code class="inlineCode">Key</code> property with the modified value.</p>
<p class="normal">For the <code class="inlineCode">&lt;input&gt;</code> element, the default event of the <code class="inlineCode">@bind</code> directive attribute is the <code class="inlineCode">onchange</code> event. We can modify the event using the <code class="inlineCode">@bind:event="{event}"</code> attribute. The <code class="inlineCode">{event}</code> placeholder should represent a DOM event. For instance, we can replace the <code class="inlineCode">onchange</code> event with the <code class="inlineCode">oninput</code> event using the following code snippet:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">input</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"text"</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"form-control"</span><span class="hljs-tag"> </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"keyField"</span>
<span class="hljs-tag">  @</span><span class="hljs-attr">bind</span><span class="hljs-tag">=</span><span class="hljs-string">"Key"</span><span class="hljs-tag"> @</span><span class="hljs-attr">bind:event</span><span class="hljs-tag">=</span><span class="hljs-string">"oninput"</span><span class="hljs-tag"> </span><span class="hljs-attr">placeholder</span><span class="hljs-tag">=</span><span class="hljs-string">@KeyPlaceHolder</span><span class="hljs-tag"> </span><span class="hljs-attr">required</span><span class="hljs-tag">&gt;</span>
</code></pre>
<h3 class="heading-3" id="_idParaDest-268">Binding with component parameters</h3>
<p class="normal">In the previous section, we explored two-way data binding between a Razor component and a DOM element. As Razor components can function similarly to DOM elements, it is also possible to establish two-way data binding between two Razor components. This often occurs when there is a need for communication between parent and child components.</p>
<p class="normal">We can bind a component parameter of an inner component to the property of an outer component using the <code class="inlineCode">@bind-{PROPERTY}</code> syntax. In this case, <code class="inlineCode">{PROPERTY}</code> refers to the property to be bound. We have explained that the <code class="inlineCode">@bind</code> directive attribute can be replaced by two one-way data binding setups, which involve assigning a variable to the <code class="inlineCode">&lt;input&gt;</code> value attribute and assigning an event handler to the <code class="inlineCode">onchange</code> event. While the compiler can automatically add the event handler for <code class="inlineCode">@bind</code>, it cannot do so for <code class="inlineCode">@bind-{PROPERTY}</code>. Therefore, we need to define our own event of the <code class="inlineCode">EventCallback&lt;TValue&gt;</code> type to bind with component parameters. The event name must follow the <code class="inlineCode">{PARAMETER NAME}Changed</code> format. To illustrate the <code class="inlineCode">@bind-{PROPERTY}</code> directive attribute’s usage, let’s use our <code class="inlineCode">EditorDialog</code> component as an example.</p>
<p class="normal">In our code, we utilize the <code class="inlineCode">EditorDialog</code> in the <code class="inlineCode">ItemDetail</code> component to edit a field, or similarly, in the <code class="inlineCode">Items</code> component to edit an item. Let’s examine field editing as an example:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">EditorDialog</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">@_dialogEditId</span>
<span class="hljs-tag">  @</span><span class="hljs-attr">bind-Key</span><span class="hljs-tag">=</span><span class="hljs-string">"listGroupField.Key"</span><span class="hljs-tag">                                   </span><span class="hljs-comment">//(1)</span>
<span class="hljs-tag">  @</span><span class="hljs-attr">bind-Value</span><span class="hljs-tag">=</span><span class="hljs-string">"listGroupField.Value"</span><span class="hljs-tag">                               </span><span class="hljs-comment">//(2)</span>
<span class="hljs-tag">  </span><span class="hljs-attr">IsKeyEditingEnable</span><span class="hljs-tag">=</span><span class="hljs-string">@_isNewField</span><span class="hljs-tag"> </span>
<span class="hljs-tag">  </span><span class="hljs-attr">OnSave</span><span class="hljs-tag">=</span><span class="hljs-string">"UpdateFieldAsync"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">KeyPlaceHolder</span><span class="hljs-tag">=</span><span class="hljs-string">"Field name"</span><span class="hljs-tag"> </span>
<span class="hljs-tag">  </span><span class="hljs-attr">ValuePlaceHolder</span><span class="hljs-tag">=</span><span class="hljs-string">"Field content"</span><span class="hljs-tag">&gt;</span>
  @if (_isNewField) {
    <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"form-check"</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">input</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"form-check-input"</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"checkbox"</span>
<span class="hljs-tag">        @</span><span class="hljs-attr">bind</span><span class="hljs-tag">=</span><span class="hljs-string">"listGroupField.IsProtected"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"flexCheckDefault"</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">label</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"form-check-label"</span>
<span class="hljs-tag">        </span><span class="hljs-attr">for</span><span class="hljs-tag">=</span><span class="hljs-string">"flexCheckDefault"</span><span class="hljs-tag">&gt;</span>
        Password
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">label</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
  }
<span class="hljs-tag">&lt;/</span><span class="hljs-name">EditorDialog</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">In the previous code of <a id="_idIndexMarker791"/>the <code class="inlineCode">ItemDetail</code> component, we can create data binding for <code class="inlineCode">Key</code> <strong class="keyWord">(1)</strong> and <code class="inlineCode">Value</code> <strong class="keyWord">(2)</strong> to the <code class="inlineCode">listGroupField</code> of the <code class="inlineCode">Field</code> type. We need to implement the <code class="inlineCode">{PARAMETER NAME}Changed</code> events in the C# code-behind for <code class="inlineCode">EditorDialog</code>, as demonstrated in <em class="italic">Listing 10.5</em>:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">namespace</span> <span class="hljs-title">PassXYZ.BlazorUI</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EditorDialog</span> {
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span>? Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
  <span class="hljs-built_in">bool</span> _isKeyEditingEnable = <span class="hljs-literal">false</span>;
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> IsKeyEditingEnable ...
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> EventCallback&lt;<span class="hljs-built_in">bool</span>&gt;? IsKeyEditingEnableChanged {
    <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
  <span class="hljs-built_in">string</span> _key = <span class="hljs-built_in">string</span>.Empty;
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Key {                           <span class="hljs-tag">          </span>          <span class="hljs-comment">//(1</span><span class="hljs-comment">)</span>
    <span class="hljs-keyword">get</span> =&gt; _key;
    <span class="hljs-keyword">set</span> {
      <span class="hljs-keyword">if</span>(_key != <span class="hljs-keyword">value</span>) {
        _key = <span class="hljs-keyword">value</span>;
        KeyChanged?.InvokeAsync(_key);               <span class="hljs-tag">          </span>     <span class="hljs-comment">//(3)</span>
      }
    }
  }
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> EventCallback&lt;<span class="hljs-built_in">string</span>&gt;? KeyChanged { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } <span class="hljs-tag">          </span> <span class="hljs-comment">//(2)</span>
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span>? KeyPlaceHolder { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
  <span class="hljs-built_in">string</span> _value = <span class="hljs-built_in">string</span>.Empty;
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Value ...
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> EventCallback&lt;<span class="hljs-built_in">string</span>&gt;? ValueChanged { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span>? ValuePlaceHolder { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> RenderFragment ChildContent { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } =
    <span class="hljs-literal">default</span>!;
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> Action&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;? OnSave { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
  <span class="hljs-keyword">async</span><span class="hljs-function"> Task&lt;</span><span class="hljs-built_in">bool</span><span class="hljs-function">&gt; </span><span class="hljs-title">OnSaveClicked</span><span class="hljs-function">()</span> {
      OnSave?.Invoke(Key, Value);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
}
</code></pre>
<p class="packt_figref">Listing 10.5: <code class="inlineCode">EditorDialog.razor.cs</code> (<a href="https://epa.ms/EditorDialog10-5"><span class="url">https://epa.ms/EditorDialog10-5</span></a>)</p>
<p class="normal">In <em class="italic">Listing 10.5</em>, we utilize the <code class="inlineCode">Key</code> property as an example to illustrate the component parameter binding process. The <code class="inlineCode">Key</code> property is defined as a component parameter with the <code class="inlineCode">[Parameter]</code> attribute. An associated event, <code class="inlineCode">KeyChanged</code>, is defined as an <code class="inlineCode">EventCallback&lt;TValue&gt;</code> type. When the text input is modified by the user and the element focus shifts, the <code class="inlineCode">Key</code> property <a id="_idIndexMarker792"/>setter is invoked. Within the setter of the <code class="inlineCode">Key</code> property, the <code class="inlineCode">KeyChanged</code> event is triggered, which notifies the outer <code class="inlineCode">ItemDetail</code> component. Consequently, the linked variable <code class="inlineCode">listGroupField.Key</code> is updated.</p>
<h2 class="heading-2" id="_idParaDest-269">Communicating with cascading values and parameters</h2>
<p class="normal">We can utilize<a id="_idIndexMarker793"/> data binding to transfer data between parent and child components. Data binding is effective when passing data to intermediate child components. However, there may be instances where we need to pass data to components located several levels deep. In such situations, utilizing data binding requires creating multiple levels of chained data binding – subsequently increasing the complexity as the chained levels expand. For instance, when passing data from <code class="inlineCode">Items</code> to <code class="inlineCode">ModalDialog</code>, we first need to establish a data binding with <code class="inlineCode">ConfirmDialog</code>. Then, another level of data binding must be created between <code class="inlineCode">ConfirmDialog</code> and <code class="inlineCode">ModalDialog</code>.</p>
<p class="normal">In the <code class="inlineCode">Items</code> component, we need to pass the <code class="inlineCode">Id</code> of the dialog to <code class="inlineCode">ModalDialog</code>. An <code class="inlineCode">Id</code> is necessary to identify the specific dialog instance we wish to display. As demonstrated below, we define <code class="inlineCode">ConfirmDialog</code> within the <code class="inlineCode">Items</code> component. The <code class="inlineCode">Id</code> is defined within <code class="inlineCode">Items</code> and passed to <code class="inlineCode">ConfirmDialog</code> through the use of component parameters:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">ConfirmDialog</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">"@_dialogDeleteId"</span><span class="hljs-tag"> </span>
<span class="hljs-tag">  </span><span class="hljs-attr">Title</span><span class="hljs-tag">=</span><span class="hljs-string">@listGroupItem.Name</span>
<span class="hljs-tag">  </span><span class="hljs-attr">OnConfirmClick</span><span class="hljs-tag">=</span><span class="hljs-string">"DeleteItemAsync"</span><span class="hljs-tag"> /&gt;</span>
</code></pre>
<p class="normal">Then, <code class="inlineCode">ConfirmDialog</code> must pass the <code class="inlineCode">Id</code> to <code class="inlineCode">ModalDialog</code>:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">ModalDialog</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">@Id</span><span class="hljs-tag"> </span><span class="hljs-attr">Title</span><span class="hljs-tag">=</span><span class="hljs-string">@($</span><span class="hljs-tag">"</span><span class="hljs-attr">Deleting</span><span class="hljs-tag"> {</span><span class="hljs-attr">Title</span><span class="hljs-tag">}")</span>
<span class="hljs-tag">  </span><span class="hljs-attr">OnSaveAsync</span><span class="hljs-tag">=</span><span class="hljs-string">@OnSave</span>
<span class="hljs-tag">  </span><span class="hljs-attr">SaveButtonText</span><span class="hljs-tag">=</span><span class="hljs-string">"Confirm"</span><span class="hljs-tag"> </span><span class="hljs-attr">CloseButtonText</span><span class="hljs-tag">=</span><span class="hljs-string">"Cancel"</span><span class="hljs-tag">&gt;</span>
  Please confirm to delete @Title?
<span class="hljs-tag">&lt;/</span><span class="hljs-name">ModalDialog</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">In <code class="inlineCode">ModalDialog</code>, <code class="inlineCode">Id</code> is used as an attribute of the <code class="inlineCode">&lt;div&gt;</code> element:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"modal fade"</span><span class="hljs-tag"> </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">@Id</span><span class="hljs-tag"> </span><span class="hljs-attr">tabindex</span><span class="hljs-tag">=</span><span class="hljs-string">"-1"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">aria-labelledby</span><span class="hljs-tag">=</span><span class="hljs-string">"ModelLabel"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;</span> ...
</code></pre>
<p class="normal">In order to prevent numerous levels of data binding, we can employ cascading values and parameters as a technique to facilitate data flow through a component hierarchy.</p>
<p class="normal"><code class="inlineCode">CascadingValue</code> is a component within the Blazor framework. The outer component supplies a cascading value by using <code class="inlineCode">CascadingValue</code>, while the inner component can obtain it by employing the <code class="inlineCode">[CascadingParameter]</code> attribute. To demonstrate its usage, we can modify<a id="_idIndexMarker794"/> the <code class="inlineCode">Items</code> component’s code as follows:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">CascadingValue</span><span class="hljs-tag"> </span><span class="hljs-attr">Value</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">@_dialogDeleteId"</span><span class="hljs-tag"> </span><span class="hljs-attr">Name</span><span class="hljs-tag">=</span><span class="hljs-string">"Id"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">ConfirmDialog</span><span class="hljs-tag"> </span><span class="hljs-attr">Title</span><span class="hljs-tag">=</span><span class="hljs-string">@listGroupItem.Name</span>
<span class="hljs-tag">    </span><span class="hljs-attr">OnConfirmClick</span><span class="hljs-tag">=</span><span class="hljs-string">"DeleteItemAsync"</span><span class="hljs-tag"> /&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">CascadingValue</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">We utilize cascading values with the <code class="inlineCode">&lt;CascadingValue&gt;</code> tag. Within the <code class="inlineCode">&lt;CascadingValue&gt;</code> tag, we assign the <code class="inlineCode">_dialogDeleteId</code> variable to the <code class="inlineCode">Value</code> attribute and the <code class="inlineCode">Id</code> string to the <code class="inlineCode">Name</code> attribute. As this <code class="inlineCode">Id</code> is not directly employed by <code class="inlineCode">ConfirmDialog</code>, the <code class="inlineCode">Id</code> component parameter can be safely removed from <code class="inlineCode">ConfirmDialog</code>.</p>
<p class="normal">In the <code class="inlineCode">ModalDialog</code>, we modify the <code class="inlineCode">Id</code> property to be a parameter by utilizing the <code class="inlineCode">[CascadingParameter]</code> attribute instead of a component parameter:</p>
<pre class="programlisting code"><code class="hljs-code">[<span class="hljs-meta">CascadingParameter(Name = </span><span class="hljs-string">"Id"</span><span class="hljs-meta">)</span>]
<span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-literal">default</span>!;
</code></pre>
<p class="normal">When working <a id="_idIndexMarker795"/>with just one cascading value, specifying its name is not mandatory, as the compiler can locate it by data type. However, to prevent ambiguities, we can assign a name to the cascading value using the <code class="inlineCode">Name</code> attribute. Next, we will examine the final modifications in the <code class="inlineCode">Items</code> component, which employs cascading values for both <code class="inlineCode">ConfirmDialog</code> and <code class="inlineCode">EditorDialog</code>:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">CascadingValue</span><span class="hljs-tag"> </span><span class="hljs-attr">Value</span><span class="hljs-tag">=</span><span class="hljs-string">"@_dialogEditId"</span><span class="hljs-tag"> </span><span class="hljs-attr">Name</span><span class="hljs-tag">=</span><span class="hljs-string">"Id"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">EditorDialog</span><span class="hljs-tag"> @</span><span class="hljs-attr">bind-Key</span><span class="hljs-tag">=</span><span class="hljs-string">"listGroupItem.Name"</span>
<span class="hljs-tag">      @</span><span class="hljs-attr">bind-Value</span><span class="hljs-tag">=</span><span class="hljs-string">"listGroupItem.Notes"</span>
<span class="hljs-tag">      </span><span class="hljs-attr">IsKeyEditingEnable</span><span class="hljs-tag">=</span><span class="hljs-string">true</span>
<span class="hljs-tag">      </span><span class="hljs-attr">OnSave</span><span class="hljs-tag">=</span><span class="hljs-string">"UpdateItemAsync"</span><span class="hljs-tag"> </span><span class="hljs-attr">KeyPlaceHolder</span><span class="hljs-tag">=</span><span class="hljs-string">"Item name"</span>
<span class="hljs-tag">      </span><span class="hljs-attr">ValuePlaceHolder</span><span class="hljs-tag">=</span><span class="hljs-string">"Please provide a description"</span><span class="hljs-tag">&gt;</span>
    @if (_isNewItem) {
      <span class="hljs-tag">&lt;</span><span class="hljs-name">select</span><span class="hljs-tag"> @</span><span class="hljs-attr">bind</span><span class="hljs-tag">=</span><span class="hljs-string">"newItem.SubType"</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"form-select"</span>
<span class="hljs-tag">        </span><span class="hljs-attr">aria-label</span><span class="hljs-tag">=</span><span class="hljs-string">"Group"</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">option</span><span class="hljs-tag"> </span><span class="hljs-attr">selected</span><span class="hljs-tag"> </span><span class="hljs-attr">value</span><span class="hljs-tag">=</span><span class="hljs-string">@ItemSubType.Group</span><span class="hljs-tag">&gt;</span>
          @ItemSubType.Group<span class="hljs-tag">&lt;/</span><span class="hljs-name">option</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">option</span><span class="hljs-tag"> </span><span class="hljs-attr">value</span><span class="hljs-tag">=</span><span class="hljs-string">@ItemSubType.Entry</span><span class="hljs-tag">&gt;</span>
          @ItemSubType.Entry<span class="hljs-tag">&lt;/</span><span class="hljs-name">option</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">option</span><span class="hljs-tag"> </span><span class="hljs-attr">value</span><span class="hljs-tag">=</span><span class="hljs-string">@ItemSubType.PxEntry</span><span class="hljs-tag">&gt;</span>
          @ItemSubType.PxEntry<span class="hljs-tag">&lt;/</span><span class="hljs-name">option</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">option</span><span class="hljs-tag"> </span><span class="hljs-attr">value</span><span class="hljs-tag">=</span><span class="hljs-string">@ItemSubType.Notes</span><span class="hljs-tag">&gt;</span>
          @ItemSubType.Notes<span class="hljs-tag">&lt;/</span><span class="hljs-name">option</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">select</span><span class="hljs-tag">&gt;</span>
    }
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">EditorDialog</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">CascadingValue</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;</span><span class="hljs-name">CascadingValue</span><span class="hljs-tag"> </span><span class="hljs-attr">Value</span><span class="hljs-tag">=</span><span class="hljs-string">"@_dialogDeleteId"</span><span class="hljs-tag"> </span><span class="hljs-attr">Name</span><span class="hljs-tag">=</span><span class="hljs-string">"Id"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">ConfirmDialog</span><span class="hljs-tag"> </span><span class="hljs-attr">Title</span><span class="hljs-tag">=</span><span class="hljs-string">@listGroupItem.Name</span>
<span class="hljs-tag">    </span><span class="hljs-attr">OnConfirmClick</span><span class="hljs-tag">=</span><span class="hljs-string">"DeleteItemAsync"</span><span class="hljs-tag"> /&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">CascadingValue</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">As demonstrated, after implementing a cascading value, <code class="inlineCode">ConfirmDialog</code> and <code class="inlineCode">EditorDialog</code> no longer need to handle the <code class="inlineCode">Id</code> field directly. Consequently, the code is more compact <a id="_idIndexMarker796"/>compared to the previous version.</p>
<p class="normal">In this section, we explored the creation of reusable components. Some Razor components might rely on data or network services, necessitating additional steps during their creation or<a id="_idIndexMarker797"/> destruction. We can accomplish these actions as part of the lifecycle management of Razor components.</p>
<p class="normal">In the following section, let us examine the lifecycle of Razor components in greater detail.</p>
<h1 class="heading-1" id="_idParaDest-270">Understanding the Razor component lifecycle</h1>
<p class="normal">A Razor component, like any <a id="_idIndexMarker798"/>other object, possesses a lifecycle. It consists of a series of <a id="_idIndexMarker799"/>synchronous and asynchronous lifecycle methods that developers can override to perform additional operations during component initialization and rendering.</p>
<p class="normal">Refer to <em class="italic">Figure 10.7</em> for an overview of the Razor component lifecycle:</p>
<figure class="mediaobject"><img alt="Figure 9.6: Razor component lifecycle" height="423" src="../Images/B21554_10_07.png" width="825"/></figure>
<p class="packt_figref">Figure 10.7: Razor component lifecycle</p>
<p class="normal">In <em class="italic">Figure 10.7</em>, it is evident that we have the ability to add hooks during both the initialization and rendering phases. The methods listed below can be overridden to capture initialization events:</p>
<ul>
<li class="bulletList"><code class="inlineCode">SetParametersAsync</code></li>
<li class="bulletList"><code class="inlineCode">OnInitialized</code> and <code class="inlineCode">OnInitializedAsync</code></li>
<li class="bulletList"><code class="inlineCode">OnParametersSet</code> and <code class="inlineCode">OnParametersSetAsync</code></li>
</ul>
<p class="normal"><code class="inlineCode">SetParametersAsync</code> and <code class="inlineCode">OnInitializedAsync</code> are invoked only in the first render. <code class="inlineCode">OnParametersSet</code><code class="inlineCode">Async</code> is called every time a parameter is changed.</p>
<p class="normal">The following <a id="_idIndexMarker800"/>methods can be <a id="_idIndexMarker801"/>overridden to customize rendering:</p>
<ul>
<li class="bulletList"><code class="inlineCode">ShouldRender</code></li>
<li class="bulletList"><code class="inlineCode">OnAfterRender</code> and <code class="inlineCode">OnAfterRenderAsync</code></li>
</ul>
<p class="normal">We will examine these lifecycle methods in detail and demonstrate how they can be utilized in our code.</p>
<h2 class="heading-2" id="_idParaDest-271">SetParametersAsync</h2>
<p class="normal"><code class="inlineCode">SetParametersAsync</code> is the first hook <a id="_idIndexMarker802"/>after the object is created and it has the following signature:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> Task </span><span class="hljs-title">SetParametersAsync</span><span class="hljs-function">(</span><span class="hljs-params">ParameterView parameters</span><span class="hljs-function">)</span>
</code></pre>
<p class="normal">The <code class="inlineCode">ParameterView</code> parameter encompasses component parameters or cascading parameter values. <code class="inlineCode">SetParametersAsync</code> assigns values to each property with either the <code class="inlineCode">[Parameter]</code> or <code class="inlineCode">[CascadingParameter]</code> attribute. This function can be overridden to incorporate any logic that must be executed before setting the parameters. The subsequent hook following <code class="inlineCode">SetParametersAsync</code> is <code class="inlineCode">OnInitializedAsync</code>.</p>
<h2 class="heading-2" id="_idParaDest-272">OnInitialized and OnInitializedAsync</h2>
<p class="normal"><code class="inlineCode">OnInitialized</code> and <code class="inlineCode">OnInitializedAsync</code> are<a id="_idIndexMarker803"/> invoked when the<a id="_idIndexMarker804"/> component is initialized. They have the following signatures, respectively:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">OnInitialized</span><span class="hljs-function">()</span>
<span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-keyword">async</span><span class="hljs-function"> Task </span><span class="hljs-title">OnInitializedAsync</span><span class="hljs-function">()</span>
</code></pre>
<p class="normal">By overriding these two functions, we can incorporate logic to initialize our component at this stage. However, keep in mind that these functions are called only once, immediately following the component’s creation. For resource-intensive initialization tasks, asynchronous methods can be employed, such as downloading data via RESTful API calls. As illustrated in <em class="italic">Figure 10.7</em>, once an asynchronous method is completed, the DOM necessitates re-rendering.</p>
<h2 class="heading-2" id="_idParaDest-273">OnParametersSet and OnParametersSetAsync</h2>
<p class="normal">When component <a id="_idIndexMarker805"/>parameters are set or <a id="_idIndexMarker806"/>modified, <code class="inlineCode">OnParametersSet</code> and <code class="inlineCode">OnParametersSetAsync</code> are invoked. We observe that there are two versions to accommodate both synchronous and asynchronous scenarios. The asynchronous version, <code class="inlineCode">OnParametersSetAsync</code>, can be employed to manage time-consuming tasks. Upon completion of the asynchronous task, the DOM must be re-rendered to display any updates.</p>
<p class="normal">The methods have the following signatures, respectively:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">OnParametersSet</span><span class="hljs-function">()</span>
<span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-keyword">async</span><span class="hljs-function"> Task </span><span class="hljs-title">OnParametersSetAsync</span><span class="hljs-function">()</span>
</code></pre>
<p class="normal">These two methods are invoked whenever component parameters or cascading parameters change and may be called multiple times. In contrast, <code class="inlineCode">OnInitializedAsync</code> is called only once.</p>
<p class="normal">As illustrated in <em class="italic">Figure 10.7</em>, the DOM can undergo multiple renderings during the initialization phase, resulting in the invocation of asynchronous calls. The methods involved in this rendering process include <code class="inlineCode">ShouldRender</code> and <code class="inlineCode">OnAfterRenderAsync</code>.</p>
<h2 class="heading-2" id="_idParaDest-274">ShouldRender</h2>
<p class="normal">The <code class="inlineCode">ShouldRender</code> method <a id="_idIndexMarker807"/>returns a Boolean value, indicating whether the component ought to be rendered. As illustrated in <em class="italic">Figure 10.7</em>, the first render disregards this method. Consequently, a component must be rendered at least once. This method possesses the following signature:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-built_in">bool</span><span class="hljs-function"> </span><span class="hljs-title">ShouldRender</span><span class="hljs-function">()</span>
</code></pre>
<h2 class="heading-2" id="_idParaDest-275">OnAfterRender and OnAfterRenderAsync</h2>
<p class="normal"><code class="inlineCode">OnAfterRender</code> and <code class="inlineCode">OnAfterRenderAsync</code> are <a id="_idIndexMarker808"/>invoked after <a id="_idIndexMarker809"/>a component has completed its rendering process. Their respective signatures are as follows:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">OnAfterRender</span><span class="hljs-function">(</span><span class="hljs-built_in">bool</span><span class="hljs-params"> firstRender</span><span class="hljs-function">)</span>
<span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-keyword">async</span><span class="hljs-function"> Task </span><span class="hljs-title">OnAfterRenderAsync</span><span class="hljs-function">(</span><span class="hljs-built_in">bool</span>
<span class="hljs-params">  firstRender</span><span class="hljs-function">)</span>
</code></pre>
<p class="normal">These methods can be utilized to execute supplementary initialization tasks with the rendered content, such as invoking JavaScript code in the component. This method features a Boolean <code class="inlineCode">firstRender</code> parameter, enabling us to attach JavaScript event handlers only once. Although there is an asynchronous version of this method, the framework does not schedule another render cycle upon the completion of the asynchronous task.</p>
<p class="normal">To examine the impact of lifecycle methods, we can conduct a test by incorporating all lifecycle methods into the <code class="inlineCode">ConfirmDialog</code> component, as demonstrated below:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span><span class="hljs-function"> </span><span class="hljs-title">ConfirmDialog</span><span class="hljs-function">()</span>
{
  Debug.WriteLine(<span class="hljs-string">$"ConfirmDialog-</span><span class="hljs-subst">{Id}</span><span class="hljs-string">: is created"</span>);
}
<span class="hljs-keyword">public</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> Task </span><span class="hljs-title">SetParametersAsync</span>
<span class="hljs-function">  (</span><span class="hljs-params">ParameterView parameters</span><span class="hljs-function">)</span>
{
  Debug.WriteLine(<span class="hljs-string">$"ConfirmDialog-</span><span class="hljs-subst">{Id}</span><span class="hljs-string">:</span>
<span class="hljs-string">    SetParametersAsync called"</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">base</span>.SetParametersAsync(parameters);
}
<span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">OnInitialized</span><span class="hljs-function">()</span>
  =&gt; Debug.WriteLine(<span class="hljs-string">$"ConfirmDialog-</span><span class="hljs-subst">{Id}</span><span class="hljs-string">: OnInitialized</span>
<span class="hljs-string">    called - </span><span class="hljs-subst">{Title}</span><span class="hljs-string">"</span>);
<span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-keyword">async</span><span class="hljs-function"> Task </span><span class="hljs-title">OnInitializedAsync</span><span class="hljs-function">()</span> =&gt;
  <span class="hljs-keyword">await</span> Task.Run(() =&gt; {
  Debug.WriteLine(<span class="hljs-string">$"ConfirmDialog-</span><span class="hljs-subst">{Id}</span><span class="hljs-string">: OnInitializedAsync</span>
<span class="hljs-string">    called - </span><span class="hljs-subst">{Title}</span><span class="hljs-string">"</span>);
});
<span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">OnParametersSet</span><span class="hljs-function">()</span>
  =&gt; Debug.WriteLine(<span class="hljs-string">$"ConfirmDialog-</span><span class="hljs-subst">{Id}</span><span class="hljs-string">: OnParametersSet</span>
<span class="hljs-string">    called - </span><span class="hljs-subst">{Title}</span><span class="hljs-string">"</span>);
<span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-keyword">async</span><span class="hljs-function"> Task </span><span class="hljs-title">OnParametersSetAsync</span><span class="hljs-function">()</span> =&gt;
  <span class="hljs-keyword">await</span> Task.Run(() =&gt; {
Debug.WriteLine(<span class="hljs-string">$"ConfirmDialog-</span><span class="hljs-subst">{Id}</span><span class="hljs-string">:</span>
<span class="hljs-string">  OnParametersSetAsync called - </span><span class="hljs-subst">{Title}</span><span class="hljs-string">"</span>);
});
<span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">OnAfterRender</span><span class="hljs-function">(</span><span class="hljs-built_in">bool</span><span class="hljs-params"> firstRender</span><span class="hljs-function">)</span>
  =&gt; Debug.WriteLine(<span class="hljs-string">$"ConfirmDialog-</span><span class="hljs-subst">{Id}</span><span class="hljs-string">: OnAfterRender</span>
<span class="hljs-string">    called with firstRender = </span><span class="hljs-subst">{firstRender}</span><span class="hljs-string">"</span>);
<span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-keyword">async</span><span class="hljs-function"> Task </span><span class="hljs-title">OnAfterRenderAsync</span><span class="hljs-function">(</span><span class="hljs-built_in">bool</span>
<span class="hljs-params">  firstRender</span><span class="hljs-function">)</span> =&gt; <span class="hljs-keyword">await</span> Task.Run(() =&gt; {
    Debug.WriteLine(<span class="hljs-string">$"ConfirmDialog-</span><span class="hljs-subst">{Id}</span><span class="hljs-string">:</span>
<span class="hljs-string">      OnAfterRenderAsync called - </span><span class="hljs-subst">{Title}</span><span class="hljs-string">"</span>);
});
<span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-built_in">bool</span><span class="hljs-function"> </span><span class="hljs-title">ShouldRender</span><span class="hljs-function">()</span> {
  Debug.WriteLine(<span class="hljs-string">$"ConfirmDialog-</span><span class="hljs-subst">{Id}</span><span class="hljs-string">: ShouldRender called</span>
<span class="hljs-string">    - </span><span class="hljs-subst">{Title}</span><span class="hljs-string">"</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
</code></pre>
<p class="normal">We have overridden<a id="_idIndexMarker810"/> all lifecycle methods in <code class="inlineCode">ConfirmDialog</code> and<a id="_idIndexMarker811"/> added debug output to display the progress. Upon launching our app, we can observe the following output:</p>
<pre class="programlisting con"><code class="hljs-con">ConfirmDialog-: is created
ConfirmDialog-: SetParametersAsync called
ConfirmDialog-deleteModel: OnInitialized called -
ConfirmDialog-deleteModel: OnInitializedAsync called -
ConfirmDialog-deleteModel: OnParametersSet called -
ConfirmDialog-deleteModel: OnParametersSetAsync called -
ConfirmDialog-deleteModel: ShouldRender called -
ConfirmDialog-deleteModel: ShouldRender called -
ConfirmDialog-deleteModel: OnAfterRender called with
  firstRender = True
ConfirmDialog-deleteModel: OnAfterRenderAsync called -
ConfirmDialog-deleteModel: OnAfterRender called with
  firstRender = False
ConfirmDialog-deleteModel: OnAfterRenderAsync called -
ConfirmDialog-deleteModel: OnAfterRender called with
  firstRender = False
ConfirmDialog-deleteModel: OnAfterRenderAsync called -
</code></pre>
<p class="normal">The previous output is displayed when we first launch our app and the <code class="inlineCode">Items</code> page appears. We can observe that the <code class="inlineCode">Id</code> cascading parameter is not set before the <code class="inlineCode">SetParametersAsync</code> method is called. Since we have overridden the asynchronous methods, multiple render cycles are scheduled to occur simultaneously. As a result, the <code class="inlineCode">ShouldRender</code> and <code class="inlineCode">OnAfterRenderAsync</code> methods are invoked multiple times due to parallel rendering.</p>
<p class="normal">Now, let’s <a id="_idIndexMarker812"/>consider another case, which occurs when we <a id="_idIndexMarker813"/>click on the context menu on the <code class="inlineCode">Items</code> page. Upon clicking on the context menu of an item, such as a Google icon, the <code class="inlineCode">ConfirmDialog</code> is initialized once more. The resulting output is as follows:</p>
<pre class="programlisting con"><code class="hljs-con">ConfirmDialog-deleteModel: SetParametersAsync called
ConfirmDialog-deleteModel: OnParametersSet called - Google
ConfirmDialog-deleteModel: ShouldRender called - Google
ConfirmDialog-deleteModel: OnParametersSetAsync called –
  Google
ConfirmDialog-deleteModel: ShouldRender called - Google
ConfirmDialog-deleteModel: OnAfterRender called with
  firstRender = False
ConfirmDialog-deleteModel: OnAfterRenderAsync called –
  Google
ConfirmDialog-deleteModel: OnAfterRender called with
  firstRender = False
ConfirmDialog-deleteModel: OnAfterRenderAsync called –
  Google
</code></pre>
<p class="normal">The <code class="inlineCode">SetParametersAsync</code> method is called again, since the <code class="inlineCode">Title</code> component parameter has been changed. In the subsequent calls, we can observe that the <code class="inlineCode">Title</code> component parameter is set to <code class="inlineCode">Google</code>.</p>
<p class="normal">In our code, we use <code class="inlineCode">OnParametersSet</code> to load the list of items in <code class="inlineCode">Items.razor.cs</code>, as well as to load a list of fields in <code class="inlineCode">ItemDetail.razor.cs</code>. Let’s examine <code class="inlineCode">OnParametersSet</code> in <code class="inlineCode">ItemDetail.razor.cs</code>:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">protected</span><span class="hljs-function"> </span><span class="hljs-keyword">override</span><span class="hljs-function"> </span><span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">OnParametersSet</span><span class="hljs-function">()</span> {
  <span class="hljs-keyword">base</span>.OnParametersSet();
  <span class="hljs-keyword">if</span> (SelectedItemId == <span class="hljs-literal">null</span>) {                                     <span class="hljs-comment">//(1)</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidOperationException(
    <span class="hljs-string">"ItemDetail: SelectedItemId is null"</span>);
  }
  selectedItem = DataStore.GetItem(SelectedItemId, <span class="hljs-literal">true</span>);           <span class="hljs-comment">//(2)</span>
  <span class="hljs-keyword">if</span> (selectedItem == <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidOperationException(
  <span class="hljs-string">"ItemDetail: entry cannot be found with SelectedItemId"</span>);
  }
  <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (selectedItem.IsGroup) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidOperationException(
        <span class="hljs-string">"ItemDetail: SelectedItemId should not be a group</span>
<span class="hljs-string">          here."</span>);
    }
    fields.Clear();
    List&lt;Field&gt; tmpFields = selectedItem.GetFields();               <span class="hljs-comment">//(3)</span>
    <span class="hljs-keyword">foreach</span> (Field field <span class="hljs-keyword">in</span> tmpFields) {
      fields.Add(field);
    }
    notes = selectedItem.GetNotesInHtml();
  }
}
</code></pre>
<p class="normal"><strong class="keyWord">(1)</strong> In <code class="inlineCode">OnParametersSet</code>, we check whether the <code class="inlineCode">SelectedItemId</code> component parameter is <code class="inlineCode">null</code>. This represents the <code class="inlineCode">ID</code> of the selected item. <strong class="keyWord">(2)</strong> If it is not null, we can locate the item by calling the <code class="inlineCode">IDataStore</code> method named <code class="inlineCode">GetItem</code>. <strong class="keyWord">(3)</strong> Once we obtain the instance of the selected item, we can retrieve a list of fields by invoking the <code class="inlineCode">GetFields</code> method.</p>
<p class="normal">The<a id="_idIndexMarker814"/> implementation<a id="_idIndexMarker815"/> of <code class="inlineCode">OnParametersSet</code> in <code class="inlineCode">Items.razor.cs</code> is quite similar to this. For more details, you can refer to the following GitHub link: <a href="https://epa.ms/Items10-6"><span class="url">https://epa.ms/Items10-6</span></a>.</p>
<p class="normal">Thus far, we have developed a near-complete password manager app, with its UI built using Blazor. We have established reusable modal dialog components to accommodate the context menu, enabling us to perform CRUD operations. The final component we need to address is the actual implementation of these CRUD operations.</p>
<h1 class="heading-1" id="_idParaDest-276">Implementing CRUD operations</h1>
<p class="normal">After preparing the modal<a id="_idIndexMarker816"/> dialogs for CRUD operations, as discussed in the previous sections, we can now proceed to implement these CRUD operations in this section.</p>
<h2 class="heading-2" id="_idParaDest-277">CRUD operations of items</h2>
<p class="normal">To add or update an item, we <a id="_idIndexMarker817"/>can utilize the <code class="inlineCode">UpdateItemAsync</code> method in <code class="inlineCode">Items.razor.cs</code> to accommodate both scenarios. To distinguish between creating a new item and updating an existing one, we define a private <code class="inlineCode">_isNewItem</code> field as follows:</p>
<pre class="programlisting code"><code class="hljs-code">    <span class="hljs-built_in">bool</span> _isNewItem = <span class="hljs-literal">false</span>;
</code></pre>
<p class="normal">Next, we’ll see how to add or edit an item.</p>
<h3 class="heading-3" id="_idParaDest-278">Adding a new item</h3>
<p class="normal">To add a new item, simply <a id="_idIndexMarker818"/>click the <code class="inlineCode">+</code> button located in the header of the <code class="inlineCode">Items</code> page, as depicted in <em class="italic">Figure 10.8</em>:</p>
<figure class="mediaobject"><img alt="Figure 9.7: Adding a new item" height="285" src="../Images/B21554_10_08.png" width="633"/></figure>
<p class="packt_figref">Figure 10.8: Adding a new item</p>
<p class="normal">The Razor markup of this page header can be reviewed here:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"container"</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"row"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"col-12"</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">h1</span><span class="hljs-tag">&gt;</span>
    @if (selectedItem?.GetParentLink() != null) {
      <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"btn btn-outline-dark"</span>
<span class="hljs-tag">        </span><span class="hljs-attr">href</span><span class="hljs-tag">=</span><span class="hljs-string">"@selectedItem?.GetParentLink()"</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">oi oi-chevron-left"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">a</span><span class="hljs-tag">&gt;</span>                           <span class="hljs-comment">//(1)</span>
    }
    @(" " + Title)                                                 <span class="hljs-comment">//(2)</span>
<span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"button"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"btn btn-outline-dark float-end"</span>
<span class="hljs-tag">      </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"modal"</span>
<span class="hljs-tag">      </span><span class="hljs-attr">data-bs-target</span><span class="hljs-tag">=</span><span class="hljs-string">"#@_dialogEditId"</span>
<span class="hljs-tag">      @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt; _isNewItem=true)"</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"oi oi-plus"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>                                               <span class="hljs-comment">//(3)</span>
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">h1</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">The page header features the <code class="inlineCode">Back</code> button <strong class="keyWord">(1)</strong>, the <code class="inlineCode">Title</code> <strong class="keyWord">(2)</strong>, and the <code class="inlineCode">Add</code> button <strong class="keyWord">(3)</strong>. The <code class="inlineCode">Back</code> button is displayed only when there is an existing parent link.</p>
<p class="normal">Upon clicking the <code class="inlineCode">Add</code> button, a modal dialog with an <code class="inlineCode">Id</code> defined in the <code class="inlineCode">_dialogEditId</code> variable will be displayed. The <code class="inlineCode">onclick</code> event handler sets <code class="inlineCode">_isNewItem</code> to true, allowing the modal <a id="_idIndexMarker819"/>dialog event handler to recognize that the action is intended to add a new item.</p>
<h3 class="heading-3" id="_idParaDest-279">Editing or deleting an item</h3>
<p class="normal">To edit or delete an item, click <a id="_idIndexMarker820"/>on the context menu found on the<a id="_idIndexMarker821"/> item, as demonstrated in <em class="italic">Figure 10.9</em>:</p>
<figure class="mediaobject"><img alt="Figure 9.8: Editing or deleting an item" height="234" src="../Images/B21554_10_09.png" width="564"/></figure>
<p class="packt_figref">Figure 10.9: Editing or deleting an item</p>
<p class="normal">Upon clicking<a id="_idIndexMarker822"/> the context menu button, a list of menu items will be <a id="_idIndexMarker823"/>displayed. Let’s examine the markup for the context menu found in <code class="inlineCode">Items.razor</code>:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"list-group"</span><span class="hljs-tag">&gt;</span>
  @foreach (var item in items) {
<span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown list-group-item list-group-item-action</span>
<span class="hljs-string">  d-flex gap-1 py-2"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-current</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">img</span><span class="hljs-tag"> </span><span class="hljs-attr">src</span><span class="hljs-tag">=</span><span class="hljs-string">"@item.GetIcon()"</span><span class="hljs-tag"> </span><span class="hljs-attr">alt</span><span class="hljs-tag">=</span><span class="hljs-string">"twbs"</span><span class="hljs-tag"> </span><span class="hljs-attr">width</span><span class="hljs-tag">=</span><span class="hljs-string">"32"</span>
<span class="hljs-tag">        </span><span class="hljs-attr">height</span><span class="hljs-tag">=</span><span class="hljs-string">"32"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"rounded-circle flex-shrink-0 float-start"</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span><span class="hljs-tag"> </span><span class="hljs-attr">href</span><span class="hljs-tag">=</span><span class="hljs-string">"@item.GetActionLink()"</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"..."</span><span class="hljs-tag">&gt;</span> ...
      <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"opacity-50 btn btn-light</span>
<span class="hljs-string">          dropdown-toggle"</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"button"</span>
<span class="hljs-tag">            </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"itemsContextMenu"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-expanded</span><span class="hljs-tag">=</span><span class="hljs-string">"false"</span>
<span class="hljs-tag">          @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt; listGroupItem=item)"</span><span class="hljs-tag">&gt;</span>                  <span class="hljs-comment">//(1)</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"oi oi-menu"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">ul</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown-menu"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-labelledby</span><span class="hljs-tag">=</span>
<span class="hljs-tag">        </span><span class="hljs-string">"</span><span class="hljs-string">itemsContextMenu"</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown-item"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"modal"</span>
<span class="hljs-tag">              </span><span class="hljs-attr">data-bs-target</span><span class="hljs-tag">=</span><span class="hljs-string">"#@_dialogEditId"</span>
<span class="hljs-tag">              @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt; _isNewItem=false)"</span><span class="hljs-tag">&gt;</span>                <span class="hljs-comment">//(2)</span>
              Edit<span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown-item"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"modal"</span>
<span class="hljs-tag">              </span><span class="hljs-attr">data-bs-target</span><span class="hljs-tag">=</span><span class="hljs-string">"#@_dialogDeleteId"</span><span class="hljs-tag">&gt;</span>                  <span class="hljs-comment">//(3)</span>
              Delete<span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">ul</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
  }
<span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">In the preceding markup code, a context menu button <strong class="keyWord">(1)</strong> is defined. Upon clicking this button, two menu items, <code class="inlineCode">Edit</code> <strong class="keyWord">(2)</strong> and <code class="inlineCode">Delete</code> <strong class="keyWord">(3)</strong>, will appear. As the context menu markup code runs within a <code class="inlineCode">foreach</code> loop, we need to obtain a reference to the selected item for editing or deletion. In the C# code-behind logic, the <code class="inlineCode">listGroupItem</code> variable is employed to reference the selected item. </p>
<p class="normal">We can capture this reference through the <code class="inlineCode">onclick</code> event handler of the context menu button.</p>
<p class="normal">Upon selecting the <code class="inlineCode">Edit</code> menu item, it is crucial to set the <code class="inlineCode">_isNewItem</code> variable to <code class="inlineCode">false</code>. This adjustment allows the event handler of the modal dialog to discern that we are modifying an existing item.</p>
<p class="normal">Having completed all the <a id="_idIndexMarker824"/>previous setup, it’s time to examine the event handler<a id="_idIndexMarker825"/> in modal dialogs. First, let’s take a look at the <code class="inlineCode">UpdateItemAsync</code> event handler within <code class="inlineCode">Items.razor.cs</code>:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">private</span><span class="hljs-function"> </span><span class="hljs-keyword">async</span><span class="hljs-function"> </span><span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">UpdateItemAsync</span><span class="hljs-function">(</span><span class="hljs-built_in">string</span><span class="hljs-params"> key, </span><span class="hljs-built_in">string</span><span class="hljs-params"> </span><span class="hljs-keyword">value</span><span class="hljs-function">)</span> {
  <span class="hljs-keyword">if</span> (listGroupItem == <span class="hljs-literal">null</span>) { <span class="hljs-keyword">return</span>; }
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">string</span>.IsNullOrEmpty(key) || <span class="hljs-built_in">string</span>.IsNullOrEmpty(<span class="hljs-keyword">value</span>))
  { <span class="hljs-keyword">return</span>; }
  listGroupItem.Name = key;
  listGroupItem.Notes = <span class="hljs-keyword">value</span>;
  <span class="hljs-keyword">if</span> (_isNewItem) {                                               <span class="hljs-comment">//(1)</span>
      <span class="hljs-comment">// Add new item</span>
    <span class="hljs-keyword">if</span> (listGroupItem <span class="hljs-keyword">is</span> NewItem aNewItem) {
      Item? newItem = DataStore.CreateNewItem
        (aNewItem.SubType);
      <span class="hljs-keyword">if</span> (newItem != <span class="hljs-literal">null</span>) {
        newItem.Name = aNewItem.Name;
        newItem.Notes = aNewItem.Notes;
        items.Add(newItem);
        <span class="hljs-keyword">await</span> DataStore.AddItemAsync(newItem);
      }
    }
  }
  <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Update the current item</span>
    <span class="hljs-keyword">await</span> DataStore.UpdateItemAsync(listGroupItem);
  }
}
</code></pre>
<p class="normal">The <code class="inlineCode">UpdateItemAsync</code> event handler can manage both adding and editing an item. It checks the <code class="inlineCode">_isNewItem</code> variable <strong class="keyWord">(1)</strong> to determine whether we aim to add or edit an item. Subsequently, it calls <code class="inlineCode">IDataStore</code> methods to perform either addition or update actions.</p>
<p class="normal">Now, let’s examine the event handler for deleting an item:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">private</span><span class="hljs-function"> </span><span class="hljs-keyword">async</span><span class="hljs-function"> </span><span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">DeleteItemAsync</span><span class="hljs-function">()</span> {
  <span class="hljs-keyword">if</span> (listGroupItem == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (items.Remove(listGroupItem)) {
      _ = <span class="hljs-keyword">await</span> DataStore.DeleteItemAsync
         (listGroupItem.Id);
  }
}
</code></pre>
<p class="normal">In the <code class="inlineCode">DeleteItemAsync</code> event handler, the item is simply removed from the list, and the <code class="inlineCode">IDataStore</code> methods are called to execute the delete action.</p>
<h2 class="heading-2" id="_idParaDest-280">CRUD operations of fields</h2>
<p class="normal">The CRUD <a id="_idIndexMarker826"/>operations for fields resemble those we implemented for items. To add or update a field, we can employ the <code class="inlineCode">UpdateFieldAsync</code> method in <code class="inlineCode">ItemDetail.razor.cs</code> to manage both scenarios. To determine whether we aim to create a new field or update an existing one, we define a private <code class="inlineCode">_isNewField</code> field as follows:</p>
<pre class="programlisting code"><code class="hljs-code">    <span class="hljs-built_in">bool</span> _isNewField = <span class="hljs-literal">false</span>;
</code></pre>
<p class="normal">The UI for CRUD operations also bears similarity to what we discussed in the previous section. To view the <code class="inlineCode">Add</code> button and context menu items, please refer to <em class="italic">Figure 10.10</em>.</p>
<figure class="mediaobject"><img alt="Figure 9.9: Add, edit, or delete a field" height="867" src="../Images/B21554_10_10.png" width="825"/></figure>
<p class="packt_figref">Figure 10.10: Add, edit, or delete a field</p>
<p class="normal">We can examine the <a id="_idIndexMarker827"/>Razor markup code for the page header found in <code class="inlineCode">ItemDetail.razor</code> as follows:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"container"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"row"</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"col-12"</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">h1</span><span class="hljs-tag">&gt;</span>
      @if (selectedItem?.GetParentLink() != null) {
        <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"btn btn-outline-dark"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">href</span><span class="hljs-tag">=</span><span class="hljs-string">"@selectedItem?.GetParentLink()"</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">oi oi-chevron-left"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">a</span><span class="hljs-tag">&gt;</span>
      }
      @(" " + selectedItem!.Name)
      <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"button"</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">btn btn-outline-dark</span>
<span class="hljs-string">        float-end"</span>
<span class="hljs-tag">        </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"modal"</span><span class="hljs-tag"> </span><span class="hljs-attr">data-bs-</span>
<span class="hljs-tag">          </span><span class="hljs-attr">target</span><span class="hljs-tag">=</span><span class="hljs-string">"#@_dialogEditId"</span>
<span class="hljs-tag">        @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt; _isNewField=true)"</span><span class="hljs-tag">&gt;</span>
          <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"oi oi-plus"</span>
<span class="hljs-tag">            </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">h1</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">As we can observe, the preceding source code is quite similar to the one found in <code class="inlineCode">Items.razor</code>, with the exception of replacing the <code class="inlineCode">_isNewItem</code> variable with <code class="inlineCode">_isNewField</code>. We can consider refining this page header into a reusable component later on.</p>
<p class="normal">Similar to the previous <a id="_idIndexMarker828"/>section, let’s now examine the source code for the list group and context menu:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"list-group"</span><span class="hljs-tag">&gt;</span>
  @foreach (var field in fields) {
    @if(field.ShowContextAction == null) {
      <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown list-group-item ...</span>
<span class="hljs-string">        aria-current="</span><span class="hljs-attr">true</span><span class="hljs-tag">"&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"oi oi-pencil"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">true"</span><span class="hljs-tag">&gt;</span>
         <span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"d-flex gap-2 w-100</span>
<span class="hljs-string">          justify-content-between"</span><span class="hljs-tag">&gt;</span> ...
        <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">opacity-50 btn btn-light</span>
<span class="hljs-string">          dropdown-toggle"</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"button"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"itemDetailContextMenu"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-expanded</span><span class="hljs-tag">=</span><span class="hljs-string">"false"</span>
<span class="hljs-tag">          @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">@(() =&gt; listGroupField=field)"</span><span class="hljs-tag">&gt;</span>                <span class="hljs-comment">//(1)</span>
            <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"oi oi-menu"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;</span>
            <span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">ul</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown-menu"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">aria-labelledby</span><span class="hljs-tag">=</span><span class="hljs-string">"itemDetailContextMenu"</span><span class="hljs-tag">&gt;</span>
          <span class="hljs-tag">&lt;</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown-item"</span>
<span class="hljs-tag">            </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"modal"</span>
<span class="hljs-tag">            </span><span class="hljs-attr">data-bs-target</span><span class="hljs-tag">=</span><span class="hljs-string">"#@_dialogEditId"</span>
<span class="hljs-tag">            @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt; _isNewField=false)"</span><span class="hljs-tag">&gt;</span>                 <span class="hljs-comment">//</span><span class="hljs-comment">(2)</span>
                Edit
          <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;</span>
          <span class="hljs-tag">&lt;</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown-item"</span>
<span class="hljs-tag">            </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">modal"</span>
<span class="hljs-tag">            </span><span class="hljs-attr">data-bs-target</span><span class="hljs-tag">=</span><span class="hljs-string">"#@_dialogDeleteId"</span><span class="hljs-tag">&gt;</span>                    <span class="hljs-comment">//(3)</span>
                Delete
          <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;</span>
          @if (field.IsProtected) {
            <span class="hljs-tag">&lt;</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown-item"</span>
<span class="hljs-tag">              @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span><span class="hljs-string">"OnToggleShowPassword"</span><span class="hljs-tag">&gt;</span>                     <span class="hljs-comment">//(4)</span>
                @if (field.IsHide) { <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>Show<span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span> }
                else { <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>Hide<span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span> }
            <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;</span>
          }
        <span class="hljs-tag">&lt;/</span><span class="hljs-name">ul</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
    }
  }
<span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">The preceding <a id="_idIndexMarker829"/>source code of <code class="inlineCode">ItemDetail.razor</code> features a context <strong class="screenText">Menu</strong> button <strong class="keyWord">(1)</strong> and three buttons for the <strong class="screenText">Add</strong> <strong class="keyWord">(2)</strong>, <strong class="screenText">Edit</strong> <strong class="keyWord">(3)</strong>, and <strong class="screenText">Show</strong> <strong class="keyWord">(4)</strong> menu items. You may have noticed that the source code is quite similar to that in <code class="inlineCode">Items.razor</code>, encompassing a list group and a context menu. </p>
<p class="normal">We will further develop this into a reusable component later in this chapter. The variation in the context menu lies in the addition of a menu item that displays or conceals a field, if it is a protected field such as a password. We utilize the <code class="inlineCode">onclick</code> event handler, <code class="inlineCode">OnToggleShowPassword</code>, to set the <code class="inlineCode">IsHide</code> field property, thereby toggling the visibility of the password field.</p>
<p class="normal">Finally, let’s examine the event handlers for modal dialogs in <code class="inlineCode">ItemDetail.razor.cs</code>:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">private</span><span class="hljs-function"> </span><span class="hljs-keyword">async</span><span class="hljs-function"> </span><span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">UpdateFieldAsync</span><span class="hljs-function">(</span><span class="hljs-built_in">string</span><span class="hljs-params"> key, </span><span class="hljs-built_in">string</span>
<span class="hljs-params">  </span><span class="hljs-keyword">value</span><span class="hljs-function">)</span> {
  <span class="hljs-keyword">if</span> (selectedItem == <span class="hljs-literal">null</span> || listGroupField == <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullReferenceException(<span class="hljs-string">"Selected item is</span>
<span class="hljs-string">        null"</span>);
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">string</span>.IsNullOrEmpty(key) ||
      <span class="hljs-built_in">string</span>.IsNullOrEmpty(<span class="hljs-keyword">value</span>)) { <span class="hljs-keyword">return</span>; }
  listGroupField.Key = key;
  listGroupField.Value = <span class="hljs-keyword">value</span>;
  <span class="hljs-keyword">if</span> (_isNewField) {
    <span class="hljs-comment">// Add a new field</span>
    Field newField = selectedItem.AddField
      (listGroupField.Key,
      ((listGroupField.IsProtected) ?
        listGroupField.EditValue : listGroupField.Value),
          listGroupField.IsProtected);
    fields.Add(newField);
  }
  <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Update the current field</span>
    <span class="hljs-keyword">var</span> newData = (listGroupField.IsProtected) ?
      listGroupField.EditValue : listGroupField.Value;
    selectedItem.UpdateField(listGroupField.Key, newData, 
      listGroupField.IsProtected);
  }
  <span class="hljs-keyword">await</span> DataStore.UpdateItemAsync(selectedItem);
}
</code></pre>
<p class="normal">The <code class="inlineCode">UpdateFieldAsync</code> event handler manages both the addition and editing of a field. It receives two parameters – <code class="inlineCode">key</code> and <code class="inlineCode">value</code> – which are passed from the modal dialog and are used to set the field of <code class="inlineCode">listGroupField</code>. By examining the <code class="inlineCode">_isNewField</code> variable, the handler determines whether the intent is to add or edit a field. Subsequently, it calls <code class="inlineCode">IDataStore</code> methods to execute the add or update actions.</p>
<p class="normal">To remove a<a id="_idIndexMarker830"/> field, the <code class="inlineCode">DeleteFieldAsync</code> event handler below is triggered:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">private</span><span class="hljs-function"> </span><span class="hljs-keyword">async</span><span class="hljs-function"> </span><span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">DeleteFieldAsync</span><span class="hljs-function">()</span> {
  <span class="hljs-keyword">if</span> (listGroupField == <span class="hljs-literal">null</span> || selectedItem == <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullReferenceException(
      <span class="hljs-string">"Selected item or field is null"</span>);
  }
  listGroupField.ShowContextAction = listGroupField;
  selectedItem.DeleteField(listGroupField);
  <span class="hljs-keyword">await</span> DataStore.UpdateItemAsync(selectedItem);
}
</code></pre>
<p class="normal">In the <code class="inlineCode">DeleteFieldAsync</code> event handler, we simply remove the field from the selected item and invoke the <code class="inlineCode">IDataStore</code> method to update the database.</p>
<p class="normal">Having implemented CRUD operations, we have now successfully completed the implementation of password manager features. We have developed a new version of the password manager app utilizing Blazor UI. The distinction between this version and the one described in <em class="italic">Part 1</em> of this book lies in our use of Blazor to construct all user interfaces. The appearance and functionality of the Blazor UI closely resemble web apps, while the XAML <a id="_idIndexMarker831"/>UI maintains the characteristics of native apps.</p>
<p class="normal">Although we have successfully implemented all the required functionalities, we can observe some duplicated code in our current implementation. To resolve this issue, we can refactor our code, transforming the duplicate sections into Razor components.</p>
<h1 class="heading-1" id="_idParaDest-281">Refactoring Razor components</h1>
<p class="normal">In the current <a id="_idIndexMarker832"/>implementation, we can observe that most of the duplicated code is found in the <code class="inlineCode">Items</code> and <code class="inlineCode">ItemDetail</code> pages. Throughout the remainder of this chapter, we will transform this duplicated code into Razor components. </p>
<p class="normal">We will create the following components:</p>
<ul>
<li class="bulletList"><code class="inlineCode">Navbar</code>: This component displays a navigation bar.</li>
<li class="bulletList"><code class="inlineCode">Dropdown</code>: This component supports a context menu.</li>
<li class="bulletList"><code class="inlineCode">ListView</code>: This component displays a list of items.</li>
</ul>
<p class="normal">The <code class="inlineCode">ListView</code> component is the most complex one, so we will address it at the end of this section. For now, let’s focus on the <code class="inlineCode">Navbar</code> and <code class="inlineCode">Dropdown</code> components first.</p>
<h2 class="heading-2" id="_idParaDest-282">Creating the Navbar component</h2>
<p class="normal">Let’s examine the <a id="_idIndexMarker833"/>navigation bar UI in <em class="italic">Figure 10.11</em>. We can observe that the navigation bar features a <strong class="screenText">Back</strong> button, a <strong class="screenText">Title</strong>, and an <strong class="screenText">Add</strong> button:</p>
<figure class="mediaobject"><img alt="Figure 10.1: Navigation bar" height="379" src="../Images/B21554_10_11.png" width="825"/></figure>
<p class="packt_figref">Figure 10.11: Navigation bar</p>
<p class="normal">The following <a id="_idIndexMarker834"/>paragraph presents the current code of the navigation bar. This code snippet appears on both the <code class="inlineCode">Items</code> and <code class="inlineCode">ItemDetail</code> pages, resulting in a duplication:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"container"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"row"</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"col-12"</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">h1</span><span class="hljs-tag">&gt;</span>
        @if (selectedItem?.GetParentLink() != null) {             <span class="hljs-comment">//(1)</span>
          <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">btn btn-outline-dark"</span>
<span class="hljs-tag">            </span><span class="hljs-attr">href</span><span class="hljs-tag">=</span><span class="hljs-string">"@selectedItem?.GetParentLink()"</span><span class="hljs-tag">&gt;</span>
            <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"oi oi-chevron-left"</span>
<span class="hljs-tag">              </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">a</span><span class="hljs-tag">&gt;</span>                      <span class="hljs-comment">//(2)</span>
        }
        @(" " + Title)                                            <span class="hljs-comment">//(3)</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"button"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"btn btn-outline-dark float-end"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"modal"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">data-bs-target</span><span class="hljs-tag">=</span><span class="hljs-string">"#@_dialogEditId"</span>
<span class="hljs-tag">          @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt; _isNewItem=true)"</span><span class="hljs-tag">&gt;</span>                    <span class="hljs-comment">//(4)</span>
          <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"oi oi-plus"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;</span>
          <span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">h1</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">In the preceding code, <strong class="keyWord">(1)</strong> the <code class="inlineCode">Back</code> button is displayed when a parent link is present. <strong class="keyWord">(2)</strong> The <code class="inlineCode">Back</code> button is implemented using an <code class="inlineCode">&lt;a&gt;</code> tag. <strong class="keyWord">(3)</strong> The <code class="inlineCode">Title</code>, as a string, appears within the <code class="inlineCode">&lt;h1&gt;</code> tag. <strong class="keyWord">(4)</strong> The <code class="inlineCode">Add</code> button is implemented using a <code class="inlineCode">&lt;button&gt;</code> tag. The styling of both the <code class="inlineCode">Back</code> and <code class="inlineCode">Add</code> buttons employs Bootstrap formatting.</p>
<p class="normal">To transform the preceding code into a Razor component, we can generate a new Razor component in the <code class="inlineCode">PassXYZ.BlazorUI</code> project and name it <code class="inlineCode">Navbar</code>. The <code class="inlineCode">Navbar</code> component will display the UI elements illustrated in <em class="italic">Figure 10.11</em>, including a <code class="inlineCode">Back</code> button, a title, and an <code class="inlineCode">Add</code> button. In order to separate the UI and logic, we will create both a <code class="inlineCode">Navbar.razor.cs</code> C# code-behind file and the Razor markup, <code class="inlineCode">Navbar.razor</code>. We will define <a id="_idIndexMarker835"/>component parameters and event handlers in the C# code-behind file, as demonstrated in <em class="italic">Listing 10.6</em>:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Navbar</span>
{
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span>? ParentLink { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                         <span class="hljs-comment">//(1)</span>
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span>? DialogId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                           <span class="hljs-comment">//(2)</span>
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span>? Title { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                              <span class="hljs-comment">//(3)</span>
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> EventCallback&lt;MouseEventArgs&gt; OnAddClick { <span class="hljs-keyword">get</span>;
  <span class="hljs-keyword">set</span>; }                                                          <span class="hljs-comment">//(4)</span>
  <span class="hljs-keyword">private</span><span class="hljs-function"> </span><span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">OnClickClose</span><span class="hljs-function">(</span><span class="hljs-params">MouseEventArgs e</span><span class="hljs-function">)</span> {
      OnAddClick.InvokeAsync();
  }
}
</code></pre>
<p class="packt_figref">Listing 10.6: <code class="inlineCode">Navbar.razor.cs</code> (<a href="https://epa.ms/Navbar10-7"><span class="url">https://epa.ms/Navbar10-7</span></a>)</p>
<p class="normal">In <code class="inlineCode">Navbar</code>, there are four component parameters and an event handler defined. We can assign the parent link for the <code class="inlineCode">Back</code> button using the <code class="inlineCode">ParentLink</code> parameter <strong class="keyWord">(1)</strong>. The value of <code class="inlineCode">Title</code> is set according to the <code class="inlineCode">Title</code> parameter <strong class="keyWord">(3)</strong>. For the <code class="inlineCode">Add</code> button, it is necessary to provide an <code class="inlineCode">Id</code> and an event handler for the dialog box; hence, the <code class="inlineCode">DialogId</code> <strong class="keyWord">(2)</strong> and <code class="inlineCode">OnAddClick</code> <strong class="keyWord">(4)</strong> parameters are utilized.</p>
<p class="normal">Now, let us examine the Razor file of <code class="inlineCode">Navbar</code>, presented in <em class="italic">Listing 10.7</em>:</p>
<pre class="programlisting code"><code class="hljs-code">@namespace PassXYZ.BlazorUI
<span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"container"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"row"</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"col-12"</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">h1</span><span class="hljs-tag">&gt;</span>
        @if (ParentLink != null) {                                <span class="hljs-comment">//(1)</span>
          <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"btn btn-outline-dark"</span>
<span class="hljs-tag">            </span><span class="hljs-attr">href</span><span class="hljs-tag">=</span><span class="hljs-string">"@ParentLink"</span><span class="hljs-tag">&gt;</span>                                   <span class="hljs-comment">//(1)</span>
            <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"oi oi-chevron-left"</span>
<span class="hljs-tag">              </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
          <span class="hljs-tag">&lt;/</span><span class="hljs-name">a</span><span class="hljs-tag">&gt;</span>
        }
        @(" " + Title)                                            <span class="hljs-comment">//(3)</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"button"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"btn btn-outline-dark float-end"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"modal"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">data-bs-target</span><span class="hljs-tag">=</span><span class="hljs-string">"#@DialogId"</span><span class="hljs-tag">                   </span>         <span class="hljs-tag"> </span><span class="hljs-comment">//(</span><span class="hljs-comment">2)</span>
<span class="hljs-tag">          @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span><span class="hljs-string">"OnClickClose"</span><span class="hljs-tag">&gt;</span>                                <span class="hljs-comment">//(4)</span>
          <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"oi oi-plus"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">true"</span><span class="hljs-tag">&gt;</span>
          <span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">h1</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="packt_figref">Listing 10.7: <code class="inlineCode">Navbar.razor</code> (<a href="https://epa.ms/Navbar10-8"><span class="url">https://epa.ms/Navbar10-8</span></a>)</p>
<p class="normal">We can observe<a id="_idIndexMarker836"/> that the code closely resembles the code used in <code class="inlineCode">Items</code> and <code class="inlineCode">ItemDetail</code>. The key difference is that we have substituted hardcoded values with component parameters (<code class="inlineCode">ParentLink</code> <strong class="keyWord">(1)</strong>, <code class="inlineCode">DialogId</code> <strong class="keyWord">(2)</strong>, <code class="inlineCode">Title</code> <strong class="keyWord">(3)</strong>, and <code class="inlineCode">OnClickClose</code> <strong class="keyWord">(4)</strong>). With the integration of this new <code class="inlineCode">Navbar</code> component, we can modify the code in <code class="inlineCode">Items</code> by employing the <code class="inlineCode">Navbar</code> component, as demonstrated below:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">Navbar</span><span class="hljs-tag"> </span><span class="hljs-attr">ParentLink</span><span class="hljs-tag">=</span><span class="hljs-string">"@selectedItem?.GetParentLink()"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">Title</span><span class="hljs-tag">=</span><span class="hljs-string">"@Title"</span><span class="hljs-tag"> </span><span class="hljs-attr">DialogId</span><span class="hljs-tag">=</span><span class="hljs-string">"@_dialogEditId"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">OnAddClick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt; {_isNewItem=true;})"</span><span class="hljs-tag"> /&gt;</span>
</code></pre>
<p class="normal">We can then proceed to replace the code in <code class="inlineCode">ItemDetail</code> as follows:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">Navbar</span><span class="hljs-tag"> </span><span class="hljs-attr">ParentLink</span><span class="hljs-tag">=</span><span class="hljs-string">"@selectedItem?.GetParentLink()"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">Title</span><span class="hljs-tag">=</span><span class="hljs-string">"@selectedItem?.Name"</span><span class="hljs-tag"> </span><span class="hljs-attr">DialogId</span><span class="hljs-tag">=</span><span class="hljs-string">"@_dialogEditId"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">OnAddClick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt; {_isNewField=true;})"</span><span class="hljs-tag"> /&gt;</span>
</code></pre>
<p class="normal">As observed, we have streamlined the code by eliminating duplications, resulting in a more elegant <a id="_idIndexMarker837"/>and concise presentation.</p>
<p class="normal">Having completed the work for the <code class="inlineCode">Navbar</code>, let us now shift our focus to the <code class="inlineCode">Dropdown</code> component.</p>
<h2 class="heading-2" id="_idParaDest-283">Creating a Dropdown component for the context menu</h2>
<p class="normal">To<a id="_idIndexMarker838"/> develop a component akin to the context menu, we can reuse the Bootstrap <code class="inlineCode">Dropdown</code> component. As illustrated in <em class="italic">Figure 10.12</em>, a context menu comprises a context menu button and a list of menu items. Upon clicking the context menu button, users are presented with a display of menu items.</p>
<figure class="mediaobject"><img alt="Figure 10.2: Context menu" height="265" src="../Images/B21554_10_12.png" width="628"/></figure>
<p class="packt_figref">Figure 10.12: Context menu</p>
<p class="normal">The present code for the context menu is replicated in both the <code class="inlineCode">Items</code> and <code class="inlineCode">ItemDetail</code> pages, as demonstrated below:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"opacity-50 btn btn-light dropdown-toggle"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"button"</span><span class="hljs-tag"> </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"itemsContextMenu"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">aria-expanded</span><span class="hljs-tag">=</span><span class="hljs-string">"false"</span>
<span class="hljs-tag">  @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt; listGroupItem=item)"</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"oi oi-menu"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;</span><span class="hljs-name">ul</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown-menu"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">aria-labelledby</span><span class="hljs-tag">=</span><span class="hljs-string">"itemsContextMenu"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown-item"</span><span class="hljs-tag"> </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"modal"</span>
<span class="hljs-tag">        </span><span class="hljs-attr">data-bs-target</span><span class="hljs-tag">=</span><span class="hljs-string">"#@_dialogEditId"</span>
<span class="hljs-tag">        @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt; _isNewItem=false)"</span><span class="hljs-tag">&gt;</span>
        Edit
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown-item"</span><span class="hljs-tag"> </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"modal"</span>
<span class="hljs-tag">        </span><span class="hljs-attr">data-bs-target</span><span class="hljs-tag">=</span><span class="hljs-string">"#@_dialogDeleteId"</span><span class="hljs-tag">&gt;</span>
      Delete
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">ul</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">The <code class="inlineCode">Dropdown</code> component of Bootstrap comprises a button and an unordered list. We must define an event handler for the button to perform the necessary action. In the previous code, we set the <code class="inlineCode">item</code> variable to <code class="inlineCode">listGroupItem</code>. Regarding the menu items, each is implemented as a <code class="inlineCode">&lt;button&gt;</code> tag and accepts a dialog ID and an event handler as parameters. When a menu item is clicked, the corresponding modal dialog will be displayed.</p>
<p class="normal">We can<a id="_idIndexMarker839"/> create two new Razor components in the <code class="inlineCode">PassXYZ.BlazorUI</code> project, named <code class="inlineCode">Dropdown</code> and <code class="inlineCode">MenuItem</code>. To separate the UI and logic, we can implement them in the C# code-behind file (<em class="italic">Listing 10.9</em>) and the Razor file (<em class="italic">Listing 10.8</em>), which we will demonstrate now.</p>
<p class="normal">Let’s first examine the <code class="inlineCode">Dropdown</code> component UI in Listing 10.8:</p>
<pre class="programlisting code"><code class="hljs-code">@namespace PassXYZ.BlazorUI
<span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"opacity-50 btn btn-light dropdown-toggle"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"button"</span><span class="hljs-tag"> </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"itemDetailContextMenu"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">aria-expanded</span><span class="hljs-tag">=</span><span class="hljs-string">"false"</span><span class="hljs-tag"> @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span><span class="hljs-string">"OnClick"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"oi oi-menu"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>                                                         <span class="hljs-comment">//(1)</span>
<span class="hljs-tag">&lt;</span><span class="hljs-name">ul</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown-menu"</span>
<span class="hljs-tag">  </span><span class="hljs-attr">aria-labelledby</span><span class="hljs-tag">=</span><span class="hljs-string">"itemDetailContextMenu"</span><span class="hljs-tag">&gt;</span>
  @ChildContent
<span class="hljs-tag">&lt;/</span><span class="hljs-name">ul</span><span class="hljs-tag">&gt;</span>                                                            <span class="hljs-comment">//(2)</span>
</code></pre>
<p class="packt_figref">Listing 10.8: <code class="inlineCode">Dropdown.razor</code> (<a href="https://epa.ms/Dropdown10-9"><span class="url">https://epa.ms/Dropdown10-9</span></a>)</p>
<p class="normal">In the <code class="inlineCode">Dropdown</code> component, we define a button <strong class="keyWord">(1)</strong> and an unordered list <strong class="keyWord">(2)</strong>. The button’s click event is set up as an <code class="inlineCode">OnClick</code> event handler. The items within the unordered list appear as child content of the <code class="inlineCode">Dropdown</code> component. The component parameters <a id="_idIndexMarker840"/>can be found in the C# <code class="inlineCode">Dropdown.razor.cs</code> code-behind file, as shown in <em class="italic">Listing 10.9</em>:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">namespace</span> <span class="hljs-title">PassXYZ.BlazorUI</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Dropdown</span>
{
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> EventCallback&lt;MouseEventArgs&gt; OnClick {<span class="hljs-keyword">get</span>;<span class="hljs-keyword">set</span>;}        <span class="hljs-comment">//(1)</span>
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> RenderFragment ChildContent { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }               <span class="hljs-comment">//(2)</span>
}
</code></pre>
<p class="packt_figref">Listing 10.9: <code class="inlineCode">Dropdown.razor.cs</code> (<a href="https://epa.ms/Dropdown10-10"><span class="url">https://epa.ms/Dropdown10-10</span></a>)</p>
<p class="normal">In <code class="inlineCode">Dropdown.razor.cs</code>, two component parameters <code class="inlineCode">OnClick</code> <strong class="keyWord">(1)</strong> and <code class="inlineCode">ChildContent</code> <strong class="keyWord">(2)</strong> are defined. The <code class="inlineCode">MenuItem</code> component can be presented as the child content of the <code class="inlineCode">Dropdown</code> component. The UI code for <code class="inlineCode">MenuItem</code> can be observed in <em class="italic">Listing 10.10</em>:</p>
<pre class="programlisting code"><code class="hljs-code">@namespace PassXYZ.BlazorUI
<span class="hljs-tag">&lt;</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown-item"</span><span class="hljs-tag"> </span><span class="hljs-attr">data-bs-toggle</span><span class="hljs-tag">=</span><span class="hljs-string">"modal"</span>
<span class="hljs-tag">    </span><span class="hljs-attr">data-bs-target</span><span class="hljs-tag">=</span><span class="hljs-string">"#@Id"</span><span class="hljs-tag"> @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span><span class="hljs-string">"OnClick"</span><span class="hljs-tag">&gt;</span>
    @ChildContent
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="packt_figref">Listing 10.10: <code class="inlineCode">MenuItem.razor</code> (<a href="https://epa.ms/MenuItem10-11"><span class="url">https://epa.ms/MenuItem10-11</span></a>)</p>
<p class="normal">The <code class="inlineCode">MenuItem</code> component specifies three component parameters: <code class="inlineCode">Id</code>, <code class="inlineCode">OnClick</code>, and <code class="inlineCode">ChildContent</code>. These parameters are defined within <code class="inlineCode">MenuItem.razor.cs</code>, as demonstrated in <em class="italic">Listing 10.11</em>:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">namespace</span> <span class="hljs-title">PassXYZ.BlazorUI</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MenuItem</span>
{
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span>? Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                                  <span class="hljs-comment">//(1</span><span class="hljs-comment">)</span>
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> EventCallback&lt;MouseEventArgs&gt; OnClick {<span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>;}         <span class="hljs-comment">//(2)</span>
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> RenderFragment ChildContent { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                 <span class="hljs-comment">//(3)</span>
}
</code></pre>
<p class="packt_figref">Listing 10.11: <code class="inlineCode">MenuItem.razor.cs</code> (<a href="https://epa.ms/MenuItem10-12"><span class="url">https://epa.ms/MenuItem10-12</span></a>)</p>
<p class="normal"><strong class="keyWord">(1)</strong> The <code class="inlineCode">Id</code> parameter is employed to designate the dialog ID when a menu item is clicked. <strong class="keyWord">(2)</strong> <code class="inlineCode">OnClick</code> is utilized to register an event handler for a button click event. <strong class="keyWord">(3)</strong> <code class="inlineCode">ChildContent</code> serves to display child content, such as the name of the menu item.</p>
<p class="normal">We have successfully implemented the components for the context menu. Now, we can replace the redundant code in the <code class="inlineCode">Items</code> and <code class="inlineCode">ItemDetail</code> pages with these context menu <a id="_idIndexMarker841"/>components. The implementation of the context menu on the <code class="inlineCode">Items</code> page proceeds as follows:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">Dropdown</span><span class="hljs-tag"> </span><span class="hljs-attr">OnClick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt; currentItem.Data=listGroupItem=item)"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">MenuItem</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">@_dialogEditId"</span>
<span class="hljs-tag">    </span><span class="hljs-attr">OnClick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt; _isNewItem=false)"</span><span class="hljs-tag">&gt;</span>Edit<span class="hljs-tag">&lt;/</span><span class="hljs-name">MenuItem</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">MenuItem</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">"@_dialogDeleteId"</span><span class="hljs-tag">&gt;</span>Delete<span class="hljs-tag">&lt;/</span><span class="hljs-name">MenuItem</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">Dropdown</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">On the <code class="inlineCode">ItemDetail</code> page, the context menu is implemented as follows:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">Dropdown</span><span class="hljs-tag"> </span><span class="hljs-attr">OnClick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() = &gt;</span>
<span class="hljs-string">  {currentField.Data=listGroupField=field;})"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">MenuItem</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">@_dialogEditId"</span>
<span class="hljs-tag">    </span><span class="hljs-attr">OnClick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt; _isNewField=false)"</span><span class="hljs-tag">&gt;</span>Edit<span class="hljs-tag">&lt;/</span><span class="hljs-name">MenuItem</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">MenuItem</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">"@_dialogDeleteId"</span><span class="hljs-tag">&gt;</span>Delete<span class="hljs-tag">&lt;/</span><span class="hljs-name">MenuItem</span><span class="hljs-tag">&gt;</span>
  @if (field.IsProtected) {
    <span class="hljs-tag">&lt;</span><span class="hljs-name">MenuItem</span><span class="hljs-tag"> </span><span class="hljs-attr">OnClick</span><span class="hljs-tag">=</span><span class="hljs-string">"OnToggleShowPassword"</span><span class="hljs-tag">&gt;</span>
      @(field.IsHide ? "Show":"Hide")
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">MenuItem</span><span class="hljs-tag">&gt;</span>
  }
<span class="hljs-tag">&lt;/</span><span class="hljs-name">Dropdown</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">Following the refinement of the code for the <code class="inlineCode">Items</code> and <code class="inlineCode">ItemDetail</code> pages, we have implemented modal dialogs, navigation bars, and context menu components. Consequently, the code appears significantly more elegant and concise. Nevertheless, there is still potential for further refinement. The main UI logic in both the <code class="inlineCode">Items</code> and <code class="inlineCode">ItemDetail</code> pages revolves around a list view. We can optimize this part of the code by implementing a <code class="inlineCode">ListView</code> component. In order to create a <code class="inlineCode">ListView</code> component, we will need to utilize an advanced feature known as templated components.</p>
<h1 class="heading-1" id="_idParaDest-284">Using templated components</h1>
<p class="normal">In constructing a Razor <a id="_idIndexMarker842"/>component, component parameters serve as the communication channels between parent and child components. While discussing nested components, we brought attention to a special <code class="inlineCode">ChildContent</code> component parameter of the <code class="inlineCode">RenderFragment</code> type. This parameter enables the parent component to set the content of the child component. For instance, the content of <code class="inlineCode">MenuItem</code> in the following code can be assigned an HTML string:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">MenuItem</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">"@_dialogDeleteId"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">strong</span><span class="hljs-tag">&gt;</span>Delete<span class="hljs-tag">&lt;/</span><span class="hljs-name">strong</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">MenuItem</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">We are able to achieve this as <code class="inlineCode">MenuItem</code> defines the following component parameter, which can be observed in <em class="italic">Listing 10.11</em>:</p>
<pre class="programlisting code"><code class="hljs-code">[<span class="hljs-meta">Parameter</span>]
<span class="hljs-keyword">public</span> RenderFragment ChildContent { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</code></pre>
<p class="normal">If we want to explicitly specify the <code class="inlineCode">ChildContent</code> parameter, we can achieve this as follows:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">MenuItem</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">"@_dialogDeleteId"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">ChildContent</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">strong</span><span class="hljs-tag">&gt;</span>Delete<span class="hljs-tag">&lt;/</span><span class="hljs-name">strong</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">ChildContent</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">MenuItem</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal"><code class="inlineCode">ChildContent</code> is a unique component parameter that can be implicitly used in markup language. To utilize <code class="inlineCode">ChildContent</code>, we create a component capable of accepting a UI template of the <code class="inlineCode">RenderFragment</code> type as its parameter. Furthermore, we can define multiple UI templates as parameters when developing a new component. Components of this nature are referred to as templated components.</p>
<p class="normal">A render fragment, of the <code class="inlineCode">RenderFragment</code> type, signifies a portion of the UI designated for rendering. Furthermore, there is a generic version, <code class="inlineCode">RenderFragment&lt;TValue&gt;</code>, which accepts a type parameter. A specific type can be provided when invoking <code class="inlineCode">RenderFragment</code>.</p>
<h2 class="heading-2" id="_idParaDest-285">Creating a ListView component</h2>
<p class="normal">To create a <code class="inlineCode">ListView</code>, we need to <a id="_idIndexMarker843"/>utilize multiple UI templates as component parameters. We can create a new Razor component within the <code class="inlineCode">PassXYZ.BlazorUI</code> project and name it <code class="inlineCode">ListView</code>. Similar to what we did for <code class="inlineCode">Navbar</code> and the context menu, we can separate the UI and code into a Razor file (<em class="italic">Listing 10.12</em>) and a C# code-behind file (<em class="italic">Listing 10.13</em>):</p>
<pre class="programlisting code"><code class="hljs-code">@namespace PassXYZ.BlazorUI
@typeparam TItem
<span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"list-group"</span><span class="hljs-tag">&gt;</span>
  @if (Header != null) {
      @Header                                                     <span class="hljs-comment">//(1)</span>
  }
  @if (Row != null &amp;&amp; Items != null) {
    @foreach (var item in Items) {
      <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dropdown list-group-item</span>
<span class="hljs-string">        list-group-item-action</span>
<span class="hljs-string">        d-flex gap-1 py-2"</span><span class="hljs-tag"> </span><span class="hljs-attr">style</span><span class="hljs-tag">=</span><span class="hljs-string">"border: none"</span>
<span class="hljs-tag">        </span><span class="hljs-attr">aria-current</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;</span>
          @Row.Invoke(item)                                       <span class="hljs-comment">//(2)</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
    }
  }
  @if (Footer != null) {
      <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"container"</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">article</span><span class="hljs-tag">&gt;</span>@Footer<span class="hljs-tag">&lt;/</span><span class="hljs-name">article</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>                                                      <span class="hljs-comment">//(3)</span>
  }
<span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="packt_figref">Listing 10.12: <code class="inlineCode">ListView.razor</code> (<a href="https://epa.ms/ListView10-13"><span class="url">https://epa.ms/ListView10-13</span></a>)</p>
<p class="normal">In the <code class="inlineCode">ListView</code> Razor file, we define three UI templates, <code class="inlineCode">Header</code> <strong class="keyWord">(1)</strong>, <code class="inlineCode">Row</code> <strong class="keyWord">(2)</strong>, and <code class="inlineCode">Footer</code> <strong class="keyWord">(3)</strong>. We render the <code class="inlineCode">Header</code> and <code class="inlineCode">Footer</code> similarly to <code class="inlineCode">ChildContent</code>, but the <code class="inlineCode">Row</code> component parameter appears distinct. The rendering process for the <code class="inlineCode">Row</code> component is as follows:</p>
<pre class="programlisting code"><code class="hljs-code">@Row(item)
</code></pre>
<p class="normal">Alternatively, we can render it like this:</p>
<pre class="programlisting code"><code class="hljs-code">@Row.Invoke(item)
</code></pre>
<p class="normal">We render it with an <code class="inlineCode">item</code> argument. The type of <code class="inlineCode">Row</code> is <code class="inlineCode">RenderFragment&lt;TValue&gt;</code>, as we demonstrate in <em class="italic">Listing 10.13</em>:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">namespace</span> <span class="hljs-title">PassXYZ.BlazorUI</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ListView</span>&lt;<span class="hljs-title">TItem</span>&gt;
{
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> RenderFragment? Header { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                    <span class="hljs-comment">//(1)</span>
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> RenderFragment&lt;TItem&gt;? Row { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                <span class="hljs-comment">//(2)</span>
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> IEnumerable&lt;TItem&gt;? Items { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                 <span class="hljs-comment">//(3)</span>
  [<span class="hljs-meta">Parameter</span>]
  <span class="hljs-keyword">public</span> RenderFragment? Footer { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }                    <span class="hljs-comment">//(4)</span>
}
</code></pre>
<p class="packt_figref">Listing 10.13: <code class="inlineCode">ListView.razor.cs</code> (<a href="https://epa.ms/ListView10-14"><span class="url">https://epa.ms/ListView10-14</span></a>)</p>
<p class="normal">We define the <code class="inlineCode">ListView</code> as a generic <code class="inlineCode">ListView&lt;TItem&gt;</code> type with the <code class="inlineCode">TItem</code> type parameter. In the <code class="inlineCode">ListView</code> component, we can specify a list view header, using the <code class="inlineCode">Header</code> <strong class="keyWord">(1)</strong> parameter, and a footer, using the <code class="inlineCode">Footer</code> <strong class="keyWord">(4)</strong> parameter. The <code class="inlineCode">ListView</code> can be <a id="_idIndexMarker844"/>bound to any data collection of the <code class="inlineCode">IEnumerable&lt;TItem&gt;</code> type via the <code class="inlineCode">Items</code> parameter <strong class="keyWord">(3)</strong>. The <code class="inlineCode">Row</code> <strong class="keyWord">(2)</strong> parameter can be employed to establish the UI template for an individual item within the <code class="inlineCode">foreach</code> loop.</p>
<h2 class="heading-2" id="_idParaDest-286">Using the ListView component</h2>
<p class="normal">At this point, let’s<a id="_idIndexMarker845"/> examine the usage of the <code class="inlineCode">ListView</code> component in the <code class="inlineCode">Items</code> and <code class="inlineCode">ItemDetail</code> pages. We will use the <code class="inlineCode">ItemDetail</code> page as an example for our discussion:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">ListView</span><span class="hljs-tag"> </span><span class="hljs-attr">Items</span><span class="hljs-tag">=</span><span class="hljs-string">"fields"</span><span class="hljs-tag">&gt;</span>                                        <span class="hljs-comment">//(1)</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">Row</span><span class="hljs-tag"> </span><span class="hljs-attr">Context</span><span class="hljs-tag">=</span><span class="hljs-string">"field"</span><span class="hljs-tag">&gt;</span>                                          <span class="hljs-comment">//(2)</span>
    @if (field.ShowContextAction == null) {
      <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"oi oi-pencil"</span><span class="hljs-tag"> </span><span class="hljs-attr">aria-hidden</span><span class="hljs-tag">=</span><span class="hljs-string">"true"</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"d-flex gap-2 w-100</span>
<span class="hljs-string">        justify-content-between"</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
          <span class="hljs-tag">&lt;</span><span class="hljs-name">h6</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"mb-0"</span><span class="hljs-tag">&gt;</span>@field.Key<span class="hljs-tag">&lt;/</span><span class="hljs-name">h6</span><span class="hljs-tag">&gt;</span>
          <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"mb-0"</span><span class="hljs-tag">&gt;</span>@field.Value<span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">Dropdown</span>
<span class="hljs-tag">       </span><span class="hljs-attr">OnClick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt;</span>
<span class="hljs-string">       {currentField.Data=listGroupField=field;})"</span><span class="hljs-tag">&gt;</span>
         <span class="hljs-tag">&lt;</span><span class="hljs-name">MenuItem</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">"@_dialogEditId"</span>
<span class="hljs-tag">           </span><span class="hljs-attr">OnClick</span><span class="hljs-tag">=</span><span class="hljs-string">"@(() =&gt; _isNewField=false)"</span><span class="hljs-tag">&gt;</span>
           Edit
         <span class="hljs-tag">&lt;/</span><span class="hljs-name">MenuItem</span><span class="hljs-tag">&gt;</span>
         <span class="hljs-tag">&lt;</span><span class="hljs-name">MenuItem</span><span class="hljs-tag"> </span><span class="hljs-attr">Id</span><span class="hljs-tag">=</span><span class="hljs-string">"@_dialogDeleteId"</span><span class="hljs-tag">&gt;</span>Delete<span class="hljs-tag">&lt;/</span><span class="hljs-name">MenuItem</span><span class="hljs-tag">&gt;</span>
        @if (field.IsProtected) {
          <span class="hljs-tag">&lt;</span><span class="hljs-name">MenuItem</span><span class="hljs-tag"> </span><span class="hljs-attr">OnClick</span><span class="hljs-tag">=</span><span class="hljs-string">"OnToggleShowPassword"</span><span class="hljs-tag">&gt;</span>
            @(field.IsHide ? "Show":"Hide")
          <span class="hljs-tag">&lt;/</span><span class="hljs-name">MenuItem</span><span class="hljs-tag">&gt;</span>
        }
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">Dropdown</span><span class="hljs-tag">&gt;</span>
    }
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">Row</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">Footer</span><span class="hljs-tag">&gt;</span>
    @((MarkupString)notes)
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">Footer</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">ListView</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">As we have defined <code class="inlineCode">Header</code>, <code class="inlineCode">Row</code>, and <code class="inlineCode">Footer</code> as optional parameters, there is no obligation to specify all of them. In the <code class="inlineCode">ItemDetail</code> page, we utilize <code class="inlineCode">Row</code> and <code class="inlineCode">Footer</code>. <strong class="keyWord">(1)</strong> First, we need to pass the list of fields to the <code class="inlineCode">Items</code> parameter. <strong class="keyWord">(2)</strong> In the <code class="inlineCode">foreach</code> loop, each field is passed to the <code class="inlineCode">ListView</code> as an argument for the <code class="inlineCode">Row</code>, which is defined as follows:</p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">Row</span><span class="hljs-tag"> </span><span class="hljs-attr">Context</span><span class="hljs-tag">=</span><span class="hljs-string">"field"</span><span class="hljs-tag">&gt;</span>
</code></pre>
<p class="normal">The <code class="inlineCode">"field"</code> value of the <code class="inlineCode">Context</code> property is employed to specify the argument for <code class="inlineCode">Row</code>. Within the UI template of <code class="inlineCode">Row</code>, we showcase the key value of <code class="inlineCode">field</code> and establish a context menu using the <code class="inlineCode">Dropdown</code> and <code class="inlineCode">MenuItem</code> components, which were implemented in the previous section.</p>
<p class="normal">By utilizing <a id="_idIndexMarker846"/>the <code class="inlineCode">ListView</code> component, we have significantly enhanced the implementation of the <code class="inlineCode">ItemDetail</code> page. This improvement was achieved through the creation of our own Razor components.</p>
<p class="normal">Having completed the refactoring of our code, we have concluded the introduction of the <code class="inlineCode">.NET MAUI Blazor Hybrid</code> app. In Part 2, we recreated our app using Blazor while maintaining the same functionalities.</p>
<p class="normal">If you have experience in Blazor web app development, you may not see too much difference between the Blazor Hybrid app and the Blazor web app. This is precisely the advantage of the Blazor Hybrid app. You may now be wondering, how do we access a native API in a Blazor Hybrid app? Let’s have a brief overview in the next section.</p>
<h1 class="heading-1" id="_idParaDest-287">Accessing a native API from Blazor Hybrid apps</h1>
<p class="normal">When <a id="_idIndexMarker847"/>it comes to accessing native APIs, there<a id="_idIndexMarker848"/> isn’t a significant difference between .NET MAUI apps and Blazor Hybrid apps. As we learned in <em class="chapterRef">Chapter 7</em>, <em class="italic">Using Platform-Specific Features</em>, it’s vital to always create an abstract layer that encapsulates native access at the platform layer. Hence, we’re not directly accessing native APIs from cross-platform code in .NET MAUI or Blazor Hybrid apps. In our app, while we do need to access native APIs, we will access a native API through an abstract layer.</p>
<p class="normal">Access to platform APIs from .NET has seen significant evolution over time, transitioning from Xamarin plugins to the unified NuGet dependency presented by Xamarin.Essentials. As discussed in <em class="chapterRef">Chapter 7</em>, <em class="italic">Using Platform-Specific Features</em>, Xamarin.Essentials aimed to standardize all native access within a single library. Initially, the plan with .NET MAUI was to migrate everything as .NET MAUI Essentials. However, the .NET MAUI team later realized that breaking it down into more logically granular namespaces, such as <code class="inlineCode">Microsoft.Maui.Storage</code> or <code class="inlineCode">Microsoft.Maui.Devices</code>, and so on, made more sense.</p>
<p class="normal">In our app, we access platform-level APIs in the classes defined in the <code class="inlineCode">Services</code> folder, such as <code class="inlineCode">LoginService.cs</code>. For example, we defined a property, <code class="inlineCode">IsPrivacyNoticeAccepted</code>, in <code class="inlineCode">LoginService</code> to store whether the user has accepted the privacy notice or not. We use a <code class="inlineCode">Preferences</code> API to store the data in platform-specific persistent storage. <code class="inlineCode">Preferences</code> APIs are defined in the <code class="inlineCode">Microsoft.Maui.Storage</code> namespace, as we can see from the following code:</p>
<pre class="programlisting code"><code class="hljs-code">Public <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> IsPrivacyNoticeAccepted
{
<span class="hljs-keyword">get</span> =&gt; Preferences.Get(PrivacyNotice, <span class="hljs-literal">false</span>);
<span class="hljs-keyword">set</span> =&gt; Preferences.Set(PrivacyNotice, <span class="hljs-keyword">value</span>);
}
</code></pre>
<p class="normal">APIs such as <code class="inlineCode">Preferences</code> are provided by Microsoft as part of .NET MAUI libraries. If we find something that is not supported by Microsoft APIs, we have to create our own plugins<a id="_idIndexMarker849"/> or use<a id="_idIndexMarker850"/> plugins provided by the community. Please refer to <em class="italic">Chapter 7</em> about how to create and use .NET MAUI plugins.</p>
<h1 class="heading-1" id="_idParaDest-288">Summary</h1>
<p class="normal">In this chapter, we explained the process of creating Razor components. We covered topics such as data binding and the component lifecycle. Subsequently, we developed a set of modal dialog components to optimize our code. By utilizing Razor components, we can eliminate duplicate code and enhance the UI design. We incorporated CRUD operations within the event handlers of modal dialogs. As a result, we now have a new version of the password manager app.</p>
<p class="normal">In the subsequent chapter, we will transition to <em class="italic">Part 3</em> of this book. In <em class="italic">Part 3</em>, we will introduce the implementation of unit tests and the process of publishing a .NET MAUI application to app stores.</p>
<h1 class="heading-1">Leave a review!</h1>
<p class="normal"><em class="italic">Enjoying this book? Help readers like you by leaving an Amazon review. Scan the QR code below for a 40% discount code.</em></p>
<p class="normal"><img alt="" height="182" src="../Images/Leave_a_review_QR.png" width="182"/></p>
<p class="normal"><em class="italic">*Limited Offer</em></p>
</div>
</div></body></html>