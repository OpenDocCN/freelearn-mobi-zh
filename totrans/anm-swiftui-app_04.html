<html><head></head><body>
<div id="_idContainer066">
<h1 class="chapter-number" id="_idParaDest-57"><a id="_idTextAnchor060"/><span class="koboSpan" id="kobo.1.1">4</span></h1>
<h1 id="_idParaDest-58"><a id="_idTextAnchor061"/><span class="koboSpan" id="kobo.2.1">Building a Record Player</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In this project, we will create a record player that will move an arm over the record, make the record spin, and play music when a button </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">is pressed.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">Sure, record players are a </span><a id="_idIndexMarker238"/><span class="koboSpan" id="kobo.6.1">bit outdated now, but this project is a good way to learn new techniques about rotation – specifically, how to rotate objects around an anchor point. </span><span class="koboSpan" id="kobo.6.2">And you can always modify the design to look like a turntable, as many DJs still use vinyl, especially due to the vinyl resurgence in the last </span><span class="No-Break"><span class="koboSpan" id="kobo.7.1">few years.</span></span></p>
<p><span class="koboSpan" id="kobo.8.1">You might be thinking, </span><em class="italic"><span class="koboSpan" id="kobo.9.1">didn’t we rotate circles in the first project?</span></em><span class="koboSpan" id="kobo.10.1"> Well, this project is different. </span><span class="koboSpan" id="kobo.10.2">In the last project, the rotation animation we applied was on SwiftUI-created shapes, (specifically, circles), but in this project, we will be applying a rotation animation onto a photo image, then controlling it with a button, and mixing in some sounds to add to the </span><span class="No-Break"><span class="koboSpan" id="kobo.11.1">user experience.</span></span></p>
<p><span class="koboSpan" id="kobo.12.1">Before we start, let’s list our objectives for </span><span class="No-Break"><span class="koboSpan" id="kobo.13.1">this project:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.14.1">Adding images to the </span><span class="No-Break"><span class="koboSpan" id="kobo.15.1">Assets catalog</span></span></li>
<li><span class="koboSpan" id="kobo.16.1">Creating the record </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">player elements</span></span></li>
<li><span class="koboSpan" id="kobo.18.1">Combining all the elements into </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">one view</span></span></li>
<li><span class="koboSpan" id="kobo.20.1">Testing </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">the project</span></span></li>
</ul>
<h1 id="_idParaDest-59"><a id="_idTextAnchor062"/><span class="koboSpan" id="kobo.22.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.23.1">You can find the finished project in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.24.1">Chapter 4</span></strong></span><span class="koboSpan" id="kobo.25.1"> folder on </span><span class="No-Break"><span class="koboSpan" id="kobo.26.1">GitHub: </span></span><a href="https://github.com/PacktPublishing/Animating-SwiftUI-Applications"><span class="No-Break"><span class="koboSpan" id="kobo.27.1">https://github.com/PacktPublishing/Animating-SwiftUI-Applications</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.28.1">.</span></span></p>
<h1 id="_idParaDest-60"><a id="_idTextAnchor063"/><span class="koboSpan" id="kobo.29.1">Adding images to the Assets catalog</span></h1>
<p><span class="koboSpan" id="kobo.30.1">Okay, let’s get started </span><a id="_idIndexMarker239"/><span class="koboSpan" id="kobo.31.1">on the first objective: adding some images to</span><a id="_idIndexMarker240"/><span class="koboSpan" id="kobo.32.1"> the project. </span><span class="koboSpan" id="kobo.32.2">First, we need to create a new project in Xcode. </span><span class="koboSpan" id="kobo.32.3">I called mine </span><strong class="source-inline"><span class="koboSpan" id="kobo.33.1">Record Player</span></strong><span class="koboSpan" id="kobo.34.1"> (you can copy this name or choose something else if you like). </span><span class="koboSpan" id="kobo.34.2">Then, we need to fill out the other fields exactly as we did in the last chapter. </span><span class="koboSpan" id="kobo.34.3">Once this is done, we are ready </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">to start.</span></span></p>
<p><span class="koboSpan" id="kobo.36.1">When it comes to the images themselves, we need three: the record, the record player arm that will move over the record, and a wood grain image that we can use as the record player box. </span><span class="koboSpan" id="kobo.36.2">All of these images can be found on GitHub by clicking the link provided in the </span><em class="italic"><span class="koboSpan" id="kobo.37.1">Technical </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.38.1">requirements</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.39.1"> section.</span></span></p>
<p><span class="koboSpan" id="kobo.40.1">There are three main methods to add images to </span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">the project.</span></span></p>
<p><span class="koboSpan" id="kobo.42.1">The first method is using Xcode’s special file folder </span><a id="_idIndexMarker241"/><span class="koboSpan" id="kobo.43.1">called the </span><strong class="bold"><span class="koboSpan" id="kobo.44.1">Assets catalog</span></strong><span class="koboSpan" id="kobo.45.1">. </span><span class="koboSpan" id="kobo.45.2">This is an organizational file structure that you’ll see in the Project navigator that will hold all of your colors, app icons, and images. </span><span class="koboSpan" id="kobo.45.3">Simply click on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.46.1">Assets.xcassets</span></strong><span class="koboSpan" id="kobo.47.1"> file in Xcode and you will be taken to the Assets catalog. </span><span class="koboSpan" id="kobo.47.2">The catalog is split into two sections: the section on the left is where your files are listed, and the section on the right is where you can actually see your files when you click on them in the left pane. </span><span class="koboSpan" id="kobo.47.3">To bring your images into the catalog, simply drag them into the left column: </span></p>
<div>
<div class="IMG---Figure" id="_idContainer055">
<span class="koboSpan" id="kobo.48.1"><img alt="Figure 4.1: Adding files to the Assets catalog " src="image/B18674_04_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.49.1">Figure 4.1: Adding files to the Assets catalog</span></p>
<p><span class="koboSpan" id="kobo.50.1">These</span><a id="_idIndexMarker242"/><span class="koboSpan" id="kobo.51.1"> images will be accessible by referencing their</span><a id="_idIndexMarker243"/><span class="koboSpan" id="kobo.52.1"> name in the code we write (we will see how to do </span><span class="No-Break"><span class="koboSpan" id="kobo.53.1">this shortly).</span></span></p>
<p><span class="koboSpan" id="kobo.54.1">The second method to add image files to the project is just by dragging and dropping them into the Project navigator. </span><span class="koboSpan" id="kobo.54.2">However, this method includes the extra step of choosing how and where you want to copy the files into the project via the following </span><span class="No-Break"><span class="koboSpan" id="kobo.55.1">pop-up window:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer056">
<span class="koboSpan" id="kobo.56.1"><img alt="Figure 4.2: Adding files into the Project navigator " src="image/B18674_04_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.57.1">Figure 4.2: Adding files into the Project navigator</span></p>
<p><span class="koboSpan" id="kobo.58.1">Here, you want to make sure that you tick the checkbox that says </span><strong class="bold"><span class="koboSpan" id="kobo.59.1">Copy items if needed</span></strong><span class="koboSpan" id="kobo.60.1">. </span><span class="koboSpan" id="kobo.60.2">That’s important because Xcode will copy your files into the project, so if they are no longer available on your computer, it won’t matter, as they are part of your project now. </span></p>
<p><span class="koboSpan" id="kobo.61.1">You also want to make sure that you check the boxes for the specific target you want to copy those resources to. </span><span class="koboSpan" id="kobo.61.2">For example, if you want to build the app on your Mac, then you want to check the </span><strong class="bold"><span class="koboSpan" id="kobo.62.1">Record Player (macOS)</span></strong><span class="koboSpan" id="kobo.63.1"> option in the </span><strong class="bold"><span class="koboSpan" id="kobo.64.1">Add to targets</span></strong><span class="koboSpan" id="kobo.65.1"> box. </span><span class="koboSpan" id="kobo.65.2">If you’re just building it for the iPhone, then check the </span><strong class="bold"><span class="koboSpan" id="kobo.66.1">Record Player (iOS)</span></strong><span class="koboSpan" id="kobo.67.1"> option. </span><span class="koboSpan" id="kobo.67.2">You can also check both if </span><span class="No-Break"><span class="koboSpan" id="kobo.68.1">you prefer.</span></span></p>
<p><span class="koboSpan" id="kobo.69.1">The</span><a id="_idIndexMarker244"/><span class="koboSpan" id="kobo.70.1"> final method is opening the </span><strong class="bold"><span class="koboSpan" id="kobo.71.1">File</span></strong><span class="koboSpan" id="kobo.72.1"> menu and selecting</span><a id="_idIndexMarker245"/><span class="koboSpan" id="kobo.73.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.74.1">Add Files </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.75.1">to…</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.76.1"> option:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer057">
<span class="koboSpan" id="kobo.77.1"><img alt="Figure 4.3: Adding files to the project via the File menu " src="image/B18674_04_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.78.1">Figure 4.3: Adding files to the project via the File menu</span></p>
<p><span class="koboSpan" id="kobo.79.1">Now that we have added all the images, the next objective is to create the </span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">record player.</span></span></p>
<h1 id="_idParaDest-61"><a id="_idTextAnchor064"/><span class="koboSpan" id="kobo.81.1">Creating the record player elements</span></h1>
<p><span class="koboSpan" id="kobo.82.1">To create </span><a id="_idIndexMarker246"/><span class="koboSpan" id="kobo.83.1">our record player, we will create three separate files, each in charge of performing specific tasks: </span></p>
<ul>
<li><span class="koboSpan" id="kobo.84.1">The first file will hold the record </span><span class="No-Break"><span class="koboSpan" id="kobo.85.1">player box</span></span></li>
<li><span class="koboSpan" id="kobo.86.1">The second file will hold the spinning record, the record player arm, and the button to </span><span class="No-Break"><span class="koboSpan" id="kobo.87.1">control it</span></span></li>
<li><span class="koboSpan" id="kobo.88.1">The third file will hold the sound file that will play when the record player </span><span class="No-Break"><span class="koboSpan" id="kobo.89.1">animation </span></span><span class="No-Break"><a id="_idIndexMarker247"/></span><span class="No-Break"><span class="koboSpan" id="kobo.90.1">starts</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.91.1">Let’s get started with the </span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">first file.</span></span></p>
<h2 id="_idParaDest-62"><a id="_idTextAnchor065"/><span class="koboSpan" id="kobo.93.1">Creating the record player box</span></h2>
<p><span class="koboSpan" id="kobo.94.1">To create the file to hold the</span><a id="_idIndexMarker248"/><span class="koboSpan" id="kobo.95.1"> record player box, in Xcode, open the </span><strong class="bold"><span class="koboSpan" id="kobo.96.1">File</span></strong><span class="koboSpan" id="kobo.97.1"> menu, select </span><strong class="bold"><span class="koboSpan" id="kobo.98.1">New</span></strong><span class="koboSpan" id="kobo.99.1">, then select </span><strong class="bold"><span class="koboSpan" id="kobo.100.1">File</span></strong><span class="koboSpan" id="kobo.101.1">. </span><span class="koboSpan" id="kobo.101.2">You will notice that this brings up several </span><span class="No-Break"><span class="koboSpan" id="kobo.102.1">template options:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer058">
<span class="koboSpan" id="kobo.103.1"><img alt="Figure 4.4: Creating a new SwiftUI file " src="image/B18674_04_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.104.1">Figure 4.4: Creating a new SwiftUI file</span></p>
<p><span class="koboSpan" id="kobo.105.1">Looking at the top of the window, the row of tabs lets you select which platform you want to write code for. </span><span class="koboSpan" id="kobo.105.2">We’re only interested in iOS apps, so select the </span><strong class="bold"><span class="koboSpan" id="kobo.106.1">iOS</span></strong><span class="koboSpan" id="kobo.107.1"> tab. </span><span class="koboSpan" id="kobo.107.2">Then, under the </span><strong class="bold"><span class="koboSpan" id="kobo.108.1">User Interface</span></strong><span class="koboSpan" id="kobo.109.1"> heading, select </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.110.1">SwiftUI View</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.111.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.112.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.113.1">Next</span></strong><span class="koboSpan" id="kobo.114.1">, and you will be asked to name the file. </span><span class="koboSpan" id="kobo.114.2">I’m calling it </span><strong class="source-inline"><span class="koboSpan" id="kobo.115.1">RecordPlayerBox</span></strong><span class="koboSpan" id="kobo.116.1">. </span><span class="koboSpan" id="kobo.116.2">Make sure your targets are selected in the checkboxes so that the file and everything it contains will work correctly when you run the project. </span><span class="koboSpan" id="kobo.116.3">Once your targets have been set, click </span><strong class="bold"><span class="koboSpan" id="kobo.117.1">Create</span></strong><span class="koboSpan" id="kobo.118.1">. </span></p>
<p><span class="koboSpan" id="kobo.119.1">Now, we have our </span><a id="_idIndexMarker249"/><span class="koboSpan" id="kobo.120.1">new file to write our code, and you’ll notice it’s the same as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.121.1">ContentView</span></strong><span class="koboSpan" id="kobo.122.1"> file, except it’s called </span><strong class="source-inline"><span class="koboSpan" id="kobo.123.1">RecordPlayerBox</span></strong><span class="koboSpan" id="kobo.124.1">. </span><span class="koboSpan" id="kobo.124.2">Working in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.125.1">body</span></strong><span class="koboSpan" id="kobo.126.1"> property, we will start with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.127.1">ZStack</span></strong><span class="koboSpan" id="kobo.128.1">; this will be our main stack to hold all of our views. </span><span class="koboSpan" id="kobo.128.2">Within the </span><strong class="source-inline"><span class="koboSpan" id="kobo.129.1">ZStack</span></strong><span class="koboSpan" id="kobo.130.1">, we can build a rectangle using one of the images in the Assets catalog. </span><span class="koboSpan" id="kobo.130.2">Enter the following code, and then let’s look at what </span><span class="No-Break"><span class="koboSpan" id="kobo.131.1">it does:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.132.1">
ZStack {
            Rectangle()
                .frame(width: 345, height: 345)
                .cornerRadius(10)
            Image("woodGrain")
                .resizable().frame(width: 325, height: 325)
                .shadow(color: .white, radius: 3, x: 0, y: 0)
        }</span></pre>
<p><span class="koboSpan" id="kobo.133.1">First, we added a </span><strong class="source-inline"><span class="koboSpan" id="kobo.134.1">Rectangle</span></strong><span class="koboSpan" id="kobo.135.1"> view, and then, using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.136.1">frame</span></strong><span class="koboSpan" id="kobo.137.1"> modifier, it gets a dimension of </span><strong class="source-inline"><span class="koboSpan" id="kobo.138.1">345</span></strong><span class="koboSpan" id="kobo.139.1"> points for the width and height, making </span><span class="No-Break"><span class="koboSpan" id="kobo.140.1">a square.</span></span></p>
<p><span class="koboSpan" id="kobo.141.1">Then, using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.142.1">cornerRadius</span></strong><span class="koboSpan" id="kobo.143.1"> modifier, we rounded the corners of the rectangle by </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.144.1">10</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.145.1"> points.</span></span></p>
<p><span class="koboSpan" id="kobo.146.1">The next line of code is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.147.1">Image</span></strong><span class="koboSpan" id="kobo.148.1"> initializer, which is a view that displays an image. </span><span class="koboSpan" id="kobo.148.2">We want to use the wood grain image that’s in the Assets catalog, so we accessed it by typing the image’s name within quotes to create a string inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.149.1">Image</span></strong><span class="koboSpan" id="kobo.150.1"> initializer. </span><span class="koboSpan" id="kobo.150.2">In our case, we </span><span class="No-Break"><span class="koboSpan" id="kobo.151.1">typed </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.152.1">"woodGrain"</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.153.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.154.1">Now we have our image, but we have to resize it. </span><span class="koboSpan" id="kobo.154.2">In order to do that, we need to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.155.1">resizable</span></strong><span class="koboSpan" id="kobo.156.1"> modifier, which is used to prepare an image or other view to be resized so it fits within its parent view. </span><span class="koboSpan" id="kobo.156.2">When it’s applied to an </span><strong class="source-inline"><span class="koboSpan" id="kobo.157.1">Image</span></strong><span class="koboSpan" id="kobo.158.1"> view, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.159.1">resizable</span></strong><span class="koboSpan" id="kobo.160.1"> modifier will determine how the image should be scaled to fit within the </span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">space available.</span></span></p>
<p><span class="koboSpan" id="kobo.162.1">Then, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.163.1">frame</span></strong><span class="koboSpan" id="kobo.164.1"> modifier resizes the wood image to a width and height of </span><strong class="source-inline"><span class="koboSpan" id="kobo.165.1">325</span></strong><span class="koboSpan" id="kobo.166.1"> points. </span><span class="koboSpan" id="kobo.166.2">This will make it a little smaller than the </span><strong class="source-inline"><span class="koboSpan" id="kobo.167.1">Rectangle</span></strong><span class="koboSpan" id="kobo.168.1"> dimensions; however, making it smaller will allow some of the rectangle edges to show through, creating a border. </span><span class="koboSpan" id="kobo.168.2">The reason why the border is black is that the default color for creating a rectangle shape is black, as it is with all shapes. </span><span class="koboSpan" id="kobo.168.3">We can change it to any color we want by using a </span><strong class="source-inline"><span class="koboSpan" id="kobo.169.1">color</span></strong><span class="koboSpan" id="kobo.170.1"> modifier, but I think I’ll leave it </span><span class="No-Break"><span class="koboSpan" id="kobo.171.1">black here.</span></span></p>
<p><span class="koboSpan" id="kobo.172.1">The final line of </span><a id="_idIndexMarker250"/><span class="koboSpan" id="kobo.173.1">code creates a shadow by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.174.1">shadow</span></strong><span class="koboSpan" id="kobo.175.1"> modifier. </span><span class="koboSpan" id="kobo.175.2">Again, all the modifiers we are adding are for the wood grain image, so each modifier placed on the wood grain has its own specific task of modifying the wood grain image in some way. </span><span class="koboSpan" id="kobo.175.3">Since this modifier is placed on the wood grain image and is using a white color, a white shadow will be radiating around the image. </span><span class="koboSpan" id="kobo.175.4">Setting the radius to a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.176.1">3</span></strong><span class="koboSpan" id="kobo.177.1"> means the shadow will extend out from the image by 3 points. </span><span class="koboSpan" id="kobo.177.2">We can also choose to put a value in for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.178.1">x</span></strong><span class="koboSpan" id="kobo.179.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.180.1">y</span></strong><span class="koboSpan" id="kobo.181.1"> parameters, which will move the shadow on those axes either left, right, up, or down. </span></p>
<p><span class="koboSpan" id="kobo.182.1">How much the shadow is moved depends on the size of the value you put in. </span><span class="koboSpan" id="kobo.182.2">For example, if you put a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.183.1">10</span></strong><span class="koboSpan" id="kobo.184.1"> in for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.185.1">x</span></strong><span class="koboSpan" id="kobo.186.1"> parameter, the shadow will extend out from the right edge 10 points; if you put a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.187.1">10</span></strong><span class="koboSpan" id="kobo.188.1"> in for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.189.1">y</span></strong><span class="koboSpan" id="kobo.190.1"> parameter, the shadow will extend out 10 points from the bottom edge of the box. </span><span class="koboSpan" id="kobo.190.2">I put in a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.191.1">0</span></strong><span class="koboSpan" id="kobo.192.1"> because I want the shadow directly over the wood grain image; it won’t be shifted left or right or up and down. </span></p>
<p><span class="koboSpan" id="kobo.193.1">Play with these numbers and with the color of the shadow so you can see how much the values that we’ve used affect the shadow location and intensity. </span><span class="koboSpan" id="kobo.193.2">Don’t expect to see much of a difference with this </span><strong class="source-inline"><span class="koboSpan" id="kobo.194.1">shadow</span></strong><span class="koboSpan" id="kobo.195.1"> modifier yet though, because its color is white, and we’re working over a white background. </span><span class="koboSpan" id="kobo.195.2">When we add a gradient to the whole background later, the shadow will become more prominent. </span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.196.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.197.1">You can easily see which modifiers you have on any given view by the way Xcode indents them. </span><span class="koboSpan" id="kobo.197.2">For example, look at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.198.1">Rectangle</span></strong><span class="koboSpan" id="kobo.199.1"> view again. </span><span class="koboSpan" id="kobo.199.2">Its two modifiers, </span><strong class="source-inline"><span class="koboSpan" id="kobo.200.1">frame</span></strong><span class="koboSpan" id="kobo.201.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.202.1">cornerRadius</span></strong><span class="koboSpan" id="kobo.203.1">, are indented to the right, which means they are acting on the rectangle only. </span><span class="koboSpan" id="kobo.203.2">The same goes for </span><strong class="source-inline"><span class="koboSpan" id="kobo.204.1">Image("Woodgrain")</span></strong><span class="koboSpan" id="kobo.205.1">; its two modifiers are indented to the right </span><span class="No-Break"><span class="koboSpan" id="kobo.206.1">as well.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.207.1">Here’s a quick shortcut if your code starts to get messy and the indenting is not lined up: press </span><em class="italic"><span class="koboSpan" id="kobo.208.1">Command</span></em><span class="koboSpan" id="kobo.209.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.210.1">A</span></em><span class="koboSpan" id="kobo.211.1"> to select everything in the file, and then press </span><em class="italic"><span class="koboSpan" id="kobo.212.1">Control</span></em><span class="koboSpan" id="kobo.213.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.214.1">I</span></em><span class="koboSpan" id="kobo.215.1">. </span><span class="koboSpan" id="kobo.215.2">Xcode then properly indents the whole file, every bit of code, in </span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">one go.</span></span></p>
<p><span class="koboSpan" id="kobo.217.1">Now, look at </span><strong class="bold"><span class="koboSpan" id="kobo.218.1">Preview</span></strong><span class="koboSpan" id="kobo.219.1"> to see </span><a id="_idIndexMarker251"/><span class="koboSpan" id="kobo.220.1">how your record player box looks. </span><span class="koboSpan" id="kobo.220.2">The following is what I have according to the code we </span><span class="No-Break"><span class="koboSpan" id="kobo.221.1">have written:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer059">
<span class="koboSpan" id="kobo.222.1"><img alt="Figure 4.5: The finished box " src="image/B18674_04_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.223.1">Figure 4.5: The finished box</span></p>
<p><span class="koboSpan" id="kobo.224.1">Before we continue, I want to show you how you can alter the previews to display your creations in a size that fits the view or views on the screen. </span><span class="koboSpan" id="kobo.224.2">Notice in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.225.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.226.1">.5</span></em><span class="koboSpan" id="kobo.227.1"> that our box is much smaller than the iPhone </span><strong class="bold"><span class="koboSpan" id="kobo.228.1">Preview</span></strong><span class="koboSpan" id="kobo.229.1"> screen; sometimes, you might want to preview what you make in a screen size that fits the size of the view you just made – in our example, we made a box view. </span><span class="koboSpan" id="kobo.229.2">Here is how to shrink the </span><strong class="bold"><span class="koboSpan" id="kobo.230.1">Preview</span></strong><span class="koboSpan" id="kobo.231.1"> screen down to fit the </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">box view.</span></span></p>
<p><span class="koboSpan" id="kobo.233.1">At the bottom of every SwiftUI file is a struct that will have the same name as the struct we just used to write our code. </span><span class="koboSpan" id="kobo.233.2">This is a special struct that is used for development purposes, and it creates the </span><strong class="bold"><span class="koboSpan" id="kobo.234.1">Preview</span></strong><span class="koboSpan" id="kobo.235.1"> window that we need so we can see our work in real time. </span></p>
<p><span class="koboSpan" id="kobo.236.1">Inside the</span><a id="_idIndexMarker252"/><span class="koboSpan" id="kobo.237.1"> preview struct, add this modifier right at the end of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.238.1">RecordPlayerBox()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.239.1"> code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.240.1">
.previewLayout(.sizeThatFits).padding()</span></pre>
<p><span class="koboSpan" id="kobo.241.1">Using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.242.1">sizeThatFits</span></strong><span class="koboSpan" id="kobo.243.1"> value will bring the </span><strong class="bold"><span class="koboSpan" id="kobo.244.1">Preview</span></strong><span class="koboSpan" id="kobo.245.1"> window size down to about the same size as our finished box. </span><span class="koboSpan" id="kobo.245.2">I don’t want it exactly the same size, so I added a bit of padding around it. </span><span class="koboSpan" id="kobo.245.3">Here is </span><span class="No-Break"><span class="koboSpan" id="kobo.246.1">the result:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer060">
<span class="koboSpan" id="kobo.247.1"><img alt="Figure 4.6: The finished box fitting to the Preview screen " src="image/B18674_04_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.248.1">Figure 4.6: The finished box fitting to the Preview screen</span></p>
<p><span class="koboSpan" id="kobo.249.1">By using</span><a id="_idIndexMarker253"/><span class="koboSpan" id="kobo.250.1"> the </span><strong class="source-inline"><span class="koboSpan" id="kobo.251.1">previewLayout</span></strong><span class="koboSpan" id="kobo.252.1"> modifier, you can customize the </span><strong class="bold"><span class="koboSpan" id="kobo.253.1">Preview</span></strong><span class="koboSpan" id="kobo.254.1"> window to suit </span><span class="No-Break"><span class="koboSpan" id="kobo.255.1">your needs.</span></span></p>
<p><span class="koboSpan" id="kobo.256.1">And that’s our finished box. </span><span class="koboSpan" id="kobo.256.2">Simple, right? </span><span class="koboSpan" id="kobo.256.3">Now, with the record player box done, we can move on to our next objective: creating the </span><span class="No-Break"><span class="koboSpan" id="kobo.257.1">spinning record.</span></span></p>
<h2 id="_idParaDest-63"><a id="_idTextAnchor066"/><span class="koboSpan" id="kobo.258.1">Creating the spinning record</span></h2>
<p><span class="koboSpan" id="kobo.259.1">As mentioned earlier, our </span><a id="_idIndexMarker254"/><span class="koboSpan" id="kobo.260.1">second file is going to contain the record code. </span><span class="koboSpan" id="kobo.260.2">However, for simplicity’s sake, we’re actually going to make the record player arm and button in this file too. </span><span class="koboSpan" id="kobo.260.3">We could split those tasks up into separate files as we did with the box, so each part has its own file, but I think that for this small project, this one file will do the job for us. </span></p>
<p><span class="koboSpan" id="kobo.261.1">Since we are creating three different views in this one file, let’s give it a name that reflects each view the file will have, so </span><strong class="source-inline"><span class="koboSpan" id="kobo.262.1">RecordButtonArmView</span></strong><span class="koboSpan" id="kobo.263.1">. </span><span class="koboSpan" id="kobo.263.2">Now, do you remember how to make a new SwiftUI file? </span><span class="koboSpan" id="kobo.263.3">If not, jump back to the </span><em class="italic"><span class="koboSpan" id="kobo.264.1">Creating the record player box</span></em><span class="koboSpan" id="kobo.265.1"> section for a refresher. </span><span class="koboSpan" id="kobo.265.2">There’s also a shortcut to creating a new file: simply press </span><em class="italic"><span class="koboSpan" id="kobo.266.1">Command</span></em><span class="koboSpan" id="kobo.267.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.268.1">N</span></em><span class="koboSpan" id="kobo.269.1"> and choose the file template you want to use; we want the </span><strong class="bold"><span class="koboSpan" id="kobo.270.1">SwiftUI View</span></strong><span class="koboSpan" id="kobo.271.1"> template from </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">the options.</span></span></p>
<p><span class="koboSpan" id="kobo.273.1">With the file made, let’s </span><a id="_idIndexMarker255"/><span class="koboSpan" id="kobo.274.1">work on making that spinning record. </span><span class="koboSpan" id="kobo.274.2">As we have done before, we will need properties to make everything work, so working at the top of the file, within the struct, add the </span><span class="No-Break"><span class="koboSpan" id="kobo.275.1">following variables:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.276.1">
    @State private var rotateRecord = false
    @State private var moveArm = false
    @State private var duration = 0.0
    
    var animateForever: Animation {
        Animation.linear(duration: duration)
            .repeatForever(autoreverses: false)
    }</span></pre>
<p><span class="koboSpan" id="kobo.277.1">One of these variables is a little different, so let me explain what </span><span class="No-Break"><span class="koboSpan" id="kobo.278.1">we’re doing.</span></span></p>
<p><span class="koboSpan" id="kobo.279.1">The first three variables are </span><strong class="source-inline"><span class="koboSpan" id="kobo.280.1">State</span></strong><span class="koboSpan" id="kobo.281.1"> variables. </span><span class="koboSpan" id="kobo.281.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.282.1">rotateRecord</span></strong><span class="koboSpan" id="kobo.283.1"> variable is going to keep track of the spinning record and will initiate the spinning animation when its value changes to </span><strong class="source-inline"><span class="koboSpan" id="kobo.284.1">true</span></strong><span class="koboSpan" id="kobo.285.1">. </span><span class="koboSpan" id="kobo.285.2">The next </span><strong class="source-inline"><span class="koboSpan" id="kobo.286.1">State</span></strong><span class="koboSpan" id="kobo.287.1"> variable, </span><strong class="source-inline"><span class="koboSpan" id="kobo.288.1">moveArm</span></strong><span class="koboSpan" id="kobo.289.1">, will keep track of the record player arm, and the third </span><strong class="source-inline"><span class="koboSpan" id="kobo.290.1">State</span></strong><span class="koboSpan" id="kobo.291.1"> variable, </span><strong class="source-inline"><span class="koboSpan" id="kobo.292.1">duration</span></strong><span class="koboSpan" id="kobo.293.1">, is used to set the duration of the </span><span class="No-Break"><span class="koboSpan" id="kobo.294.1">spinning record.</span></span></p>
<p><span class="koboSpan" id="kobo.295.1">The final variable is a computed property. </span><span class="koboSpan" id="kobo.295.2">A computed property</span><a id="_idIndexMarker256"/><span class="koboSpan" id="kobo.296.1"> is a property that does not store a value but is, instead, computed every time it is accessed, meaning the code in its body will run every time the variable is used. </span><span class="koboSpan" id="kobo.296.2">The property we made is of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.297.1">Animation</span></strong><span class="koboSpan" id="kobo.298.1"> type, which means we can use this in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.299.1">animation</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.300.1"> modifiers.</span></span></p>
<p><span class="koboSpan" id="kobo.301.1">By using </span><strong class="source-inline"><span class="koboSpan" id="kobo.302.1">Animation.linear</span></strong><span class="koboSpan" id="kobo.303.1">, we initialize this variable with a linear timing curve for the animation. </span><span class="koboSpan" id="kobo.303.2">Remember we talked about timing curves in </span><a href="B18674_02.xhtml#_idTextAnchor034"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.304.1">Chapter 2</span></em></span></a><span class="koboSpan" id="kobo.305.1"> – a linear curve is a curve with no easing in or easing out; it’s simply a steady, non-fluctuating animation from the beginning to the middle, and to </span><span class="No-Break"><span class="koboSpan" id="kobo.306.1">the end.</span></span></p>
<p><span class="koboSpan" id="kobo.307.1">Then, by keeping the </span><strong class="source-inline"><span class="koboSpan" id="kobo.308.1">duration</span></strong><span class="koboSpan" id="kobo.309.1"> parameter as </span><strong class="source-inline"><span class="koboSpan" id="kobo.310.1">0</span></strong><span class="koboSpan" id="kobo.311.1">, this means the animation will have no duration and cannot start yet. </span><span class="koboSpan" id="kobo.311.2">This will change in order to start the animation later. </span></p>
<p><span class="koboSpan" id="kobo.312.1">Then, we’re using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.313.1">repeatForever</span></strong><span class="koboSpan" id="kobo.314.1"> option because we want the spinning record to keep going until we stop it. </span><span class="koboSpan" id="kobo.314.2">And finally, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.315.1">autoReverses</span></strong><span class="koboSpan" id="kobo.316.1"> parameter is set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.317.1">false</span></strong><span class="koboSpan" id="kobo.318.1">, as we don’t want the record to spin backward. </span></p>
<p><span class="koboSpan" id="kobo.319.1">Using a </span><a id="_idIndexMarker257"/><span class="koboSpan" id="kobo.320.1">computed property in this way simplifies things, as now we only need to pass that property into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.321.1">animation</span></strong><span class="koboSpan" id="kobo.322.1"> modifier, and four values will have been set with one computed property: </span><strong class="source-inline"><span class="koboSpan" id="kobo.323.1">Animation.linear</span></strong><span class="koboSpan" id="kobo.324.1"> curve, </span><strong class="source-inline"><span class="koboSpan" id="kobo.325.1">duration</span></strong><span class="koboSpan" id="kobo.326.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.327.1">repeatForever</span></strong><span class="koboSpan" id="kobo.328.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.329.1">autoReverses</span></strong><span class="koboSpan" id="kobo.330.1">. </span><span class="koboSpan" id="kobo.330.2">A computed property is also helpful if you are calling the animation modifier in several different places because rather than changing all the separate places to alter the animation, you could simply change the variable in one place. </span><span class="koboSpan" id="kobo.330.3">For example, if you want the auto-reverse feature in all of your other animations, all you have to do is change </span><strong class="source-inline"><span class="koboSpan" id="kobo.331.1">autoreverses</span></strong><span class="koboSpan" id="kobo.332.1"> in one place </span><span class="No-Break"><span class="koboSpan" id="kobo.333.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.334.1">true</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.335.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.336.1">We now have all the variables we need to set up this file. </span><span class="koboSpan" id="kobo.336.2">Next, we will actually add the record. </span><span class="koboSpan" id="kobo.336.3">Let’s first put everything in a main </span><strong class="source-inline"><span class="koboSpan" id="kobo.337.1">ZStack</span></strong><span class="koboSpan" id="kobo.338.1">, which will hold all </span><span class="No-Break"><span class="koboSpan" id="kobo.339.1">the views:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.340.1">
ZStack {
Image("record").resizable()
               .frame(width: 280, height: 280)
               .rotationEffect(Angle(degrees: rotateRecord ? </span><span class="koboSpan" id="kobo.340.2">                 360.0 : 0.0))
               .animation(animateForever.delay(1.5), value:                  rotateRecord)
 }</span></pre>
<p><span class="koboSpan" id="kobo.341.1">The first line of code accesses the </span><strong class="source-inline"><span class="koboSpan" id="kobo.342.1">"record"</span></strong><span class="koboSpan" id="kobo.343.1"> image in the Assets catalog to create the record on the screen by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.344.1">Image</span></strong><span class="koboSpan" id="kobo.345.1"> initializer (just as we did with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.346.1">"</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.347.1">woodGrain"</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.348.1"> image).</span></span></p>
<p><span class="koboSpan" id="kobo.349.1">Next, by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.350.1">resizable</span></strong><span class="koboSpan" id="kobo.351.1"> modifier again to initiate the resizing, we can change the size of the record image by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.352.1">frame</span></strong><span class="koboSpan" id="kobo.353.1"> modifier. </span><span class="koboSpan" id="kobo.353.2">Passing in a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.354.1">280</span></strong><span class="koboSpan" id="kobo.355.1"> points for the width and height makes the image just right for </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">the screen.</span></span></p>
<p><span class="koboSpan" id="kobo.357.1">In the next line of code, we added the </span><strong class="source-inline"><span class="koboSpan" id="kobo.358.1">rotationEffect</span></strong><span class="koboSpan" id="kobo.359.1"> modifier to the record. </span><span class="koboSpan" id="kobo.359.2">This modifier will rotate (or spin) the image to any angle we want. </span><span class="koboSpan" id="kobo.359.3">For the </span><strong class="source-inline"><span class="koboSpan" id="kobo.360.1">degrees</span></strong><span class="koboSpan" id="kobo.361.1"> parameter, we’re using the ternary operator and rotating the record </span><strong class="source-inline"><span class="koboSpan" id="kobo.362.1">360</span></strong><span class="koboSpan" id="kobo.363.1"> degrees, which is one full rotation. </span><span class="koboSpan" id="kobo.363.2">So, the record will spin one complete revolution, but it will only do so when the </span><strong class="source-inline"><span class="koboSpan" id="kobo.364.1">rotateRecord</span></strong><span class="koboSpan" id="kobo.365.1"> variable becomes </span><strong class="source-inline"><span class="koboSpan" id="kobo.366.1">true</span></strong><span class="koboSpan" id="kobo.367.1">. </span></p>
<p><span class="koboSpan" id="kobo.368.1">Next, we added the animation to the record, by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.369.1">animation</span></strong><span class="koboSpan" id="kobo.370.1"> modifier and passing in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.371.1">animateForever</span></strong><span class="koboSpan" id="kobo.372.1"> computed property for its first parameter. </span><span class="koboSpan" id="kobo.372.2">Remember, this property is doing a few things for us already: it’s setting a timing curve to linear, making the animation repeat forever, and stopping the animation from playing </span><span class="No-Break"><span class="koboSpan" id="kobo.373.1">in reverse.</span></span></p>
<p><span class="koboSpan" id="kobo.374.1">Notice the </span><a id="_idIndexMarker258"/><span class="koboSpan" id="kobo.375.1">use of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.376.1">delay</span></strong><span class="koboSpan" id="kobo.377.1"> modifier. </span><span class="koboSpan" id="kobo.377.2">This will add a 1.5-second delay to the start of the spinning record. </span><span class="koboSpan" id="kobo.377.3">This delay is added because old record players didn’t start spinning until the arm swung over the record first. </span><span class="koboSpan" id="kobo.377.4">This will add a little realism to </span><span class="No-Break"><span class="koboSpan" id="kobo.378.1">the animation.</span></span></p>
<p><span class="koboSpan" id="kobo.379.1">Finally, the animation’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.380.1">value</span></strong><span class="koboSpan" id="kobo.381.1"> parameter gets passed in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.382.1">rotateRecord</span></strong><span class="koboSpan" id="kobo.383.1"> variable, which supplies the animation to </span><span class="No-Break"><span class="koboSpan" id="kobo.384.1">the record.</span></span></p>
<p><span class="koboSpan" id="kobo.385.1">Before we move onto the record player arm, let’s make </span><strong class="bold"><span class="koboSpan" id="kobo.386.1">Preview</span></strong><span class="koboSpan" id="kobo.387.1"> smaller so it reflects the size of the record, just like we did with </span><span class="No-Break"><span class="koboSpan" id="kobo.388.1">the box:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.389.1">
struct RecordButtonArmView_Previews: PreviewProvider {
    static var previews: some View {
        RecordButtonArmView()
            </span><strong class="bold"><span class="koboSpan" id="kobo.390.1">.previewLayout(.sizeThatFits).padding()</span></strong><span class="koboSpan" id="kobo.391.1">
    }
}</span></pre>
<p><span class="koboSpan" id="kobo.392.1">Now, the record is complete and ready to spin some tunes. </span><span class="koboSpan" id="kobo.392.2">Here’s what it </span><span class="No-Break"><span class="koboSpan" id="kobo.393.1">looks like:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer061">
<span class="koboSpan" id="kobo.394.1"><img alt="Figure 4.7: Record disk " src="image/B18674_04_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.395.1">Figure 4.7: Record disk</span></p>
<p><span class="koboSpan" id="kobo.396.1">Nothing will </span><a id="_idIndexMarker259"/><span class="koboSpan" id="kobo.397.1">happen yet because we have to add the other views and functionality, but we’re making good progress. </span><span class="koboSpan" id="kobo.397.2">Next up, let’s work on the record </span><span class="No-Break"><span class="koboSpan" id="kobo.398.1">player arm.</span></span></p>
<h2 id="_idParaDest-64"><a id="_idTextAnchor067"/><span class="koboSpan" id="kobo.399.1">Creating the record player arm</span></h2>
<p><span class="koboSpan" id="kobo.400.1">With the spinning record</span><a id="_idIndexMarker260"/><span class="koboSpan" id="kobo.401.1"> completed, the next objective is the record player’s arm. </span><span class="koboSpan" id="kobo.401.2">Still working in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.402.1">RecordButtonArmView</span></strong><span class="koboSpan" id="kobo.403.1"> file, here is the code I want you to add, just underneath the call to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.404.1">animation</span></strong><span class="koboSpan" id="kobo.405.1"> modifier for </span><span class="No-Break"><span class="koboSpan" id="kobo.406.1">the record:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.407.1">
//Arm
            Image("playerArm").resizable()
                .aspectRatio(contentMode: .fit)
                .frame(width: 150, height: 150)
                .shadow(color: .gray, radius: 2, x: 0, y: 0)
                .rotationEffect(Angle.degrees(-35), anchor:                   .topTrailing)
                .rotationEffect(Angle.degrees(moveArm ? </span><span class="koboSpan" id="kobo.407.2">8 : 0),                   anchor: .topTrailing)
                .animation(Animation.linear(duration: 2),value:                   moveArm)
                .offset(x: 75, y: -30)</span></pre>
<p><span class="koboSpan" id="kobo.408.1">Similar to the </span><a id="_idIndexMarker261"/><span class="koboSpan" id="kobo.409.1">record image, we use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.410.1">Image</span></strong><span class="koboSpan" id="kobo.411.1"> initializer to display the </span><strong class="source-inline"><span class="koboSpan" id="kobo.412.1">"playerArm"</span></strong><span class="koboSpan" id="kobo.413.1"> image that we imported earlier into the Assets catalog. </span><span class="koboSpan" id="kobo.413.2">It gets resizable behaviors using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.414.1">resizable</span></strong><span class="koboSpan" id="kobo.415.1"> modifier, and the aspect ratio is set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.416.1">fit</span></strong><span class="koboSpan" id="kobo.417.1">, which will fit the image proportionally on the screen. </span><span class="koboSpan" id="kobo.417.2">Next, the image’s width and height are set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.418.1">150</span></strong><span class="koboSpan" id="kobo.419.1"> points, using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.420.1">frame</span></strong><span class="koboSpan" id="kobo.421.1"> modifier, as we have </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">seen before.</span></span></p>
<p><span class="koboSpan" id="kobo.423.1">Continuing, the next line of code sets a shadow with a gray color and casts it around the arm with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.424.1">2</span></strong><span class="koboSpan" id="kobo.425.1">-point radius. </span><span class="koboSpan" id="kobo.425.2">If you like, you can change the radius to whatever size you prefer, and experiment to see what works </span><span class="No-Break"><span class="koboSpan" id="kobo.426.1">for you.</span></span></p>
<p><span class="koboSpan" id="kobo.427.1">Then, the arm gets rotated by -35 degrees; this value lines it up perpendicular with the record on the left. </span><span class="koboSpan" id="kobo.427.2">Also, we set the anchor point here to </span><strong class="source-inline"><span class="koboSpan" id="kobo.428.1">topTrailing</span></strong><span class="koboSpan" id="kobo.429.1">, so when the arm swings over the record, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.430.1">topTrailing</span></strong><span class="koboSpan" id="kobo.431.1"> (or top-right) anchor point will not move but will serve as a pivot point for the whole arm </span><span class="No-Break"><span class="koboSpan" id="kobo.432.1">to move.</span></span></p>
<p><span class="koboSpan" id="kobo.433.1">The next line of code calls the </span><strong class="source-inline"><span class="koboSpan" id="kobo.434.1">rotationEffect</span></strong><span class="koboSpan" id="kobo.435.1"> modifier again – this time, passing in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.436.1">moveArm</span></strong><span class="koboSpan" id="kobo.437.1"> variable. </span><span class="koboSpan" id="kobo.437.2">Once this becomes </span><strong class="source-inline"><span class="koboSpan" id="kobo.438.1">true</span></strong><span class="koboSpan" id="kobo.439.1">, the arm will move </span><strong class="source-inline"><span class="koboSpan" id="kobo.440.1">8</span></strong><span class="koboSpan" id="kobo.441.1"> points to the left, and when it’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.442.1">false</span></strong><span class="koboSpan" id="kobo.443.1">, it goes back to its original spot, using a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.444.1">0</span></strong><span class="koboSpan" id="kobo.445.1">. </span></p>
<p><span class="koboSpan" id="kobo.446.1">As we have seen, to have an animation, we need the </span><strong class="source-inline"><span class="koboSpan" id="kobo.447.1">animation</span></strong><span class="koboSpan" id="kobo.448.1"> modifier, which is the next line of code. </span><span class="koboSpan" id="kobo.448.2">This has a linear timing curve and sets the animation to 2 seconds to complete, meaning it should take the arm 2 seconds to move over </span><span class="No-Break"><span class="koboSpan" id="kobo.449.1">the record.</span></span></p>
<p><span class="koboSpan" id="kobo.450.1">Finally, we need to position the arm just right in relation to the spinning record, so using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.451.1">offset</span></strong><span class="koboSpan" id="kobo.452.1"> modifier here, we can place it exactly where we want on the record player box. </span><span class="koboSpan" id="kobo.452.2">For our purposes, a record player’s arm is usually placed to the right of the record, with an inch or two of spacing between the arm and </span><span class="No-Break"><span class="koboSpan" id="kobo.453.1">the record.</span></span></p>
<p><span class="koboSpan" id="kobo.454.1">Here’s what</span><a id="_idIndexMarker262"/><span class="koboSpan" id="kobo.455.1"> the project should look like so far with the arm </span><span class="No-Break"><span class="koboSpan" id="kobo.456.1">in place:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer062">
<span class="koboSpan" id="kobo.457.1"><img alt="Figure 4.8: Record player arm " src="image/B18674_04_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.458.1">Figure 4.8: Record player arm</span></p>
<p><span class="koboSpan" id="kobo.459.1">We’re actually almost done with the project, but two more key components are needed. </span></p>
<p><span class="koboSpan" id="kobo.460.1">The first of these is a button that will start and stop the animation. </span><span class="koboSpan" id="kobo.460.2">This will be a dynamic button, meaning that the title of the button will change depending on what it’s doing. </span><span class="koboSpan" id="kobo.460.3">If the record player is not playing a record, we will keep the button color black, display the word </span><strong class="bold"><span class="koboSpan" id="kobo.461.1">Play</span></strong><span class="koboSpan" id="kobo.462.1">, and show the triangular </span><em class="italic"><span class="koboSpan" id="kobo.463.1">play</span></em><span class="koboSpan" id="kobo.464.1"> symbol. </span><span class="koboSpan" id="kobo.464.2">If the record player is playing the record, then the button will be red, display the word </span><strong class="bold"><span class="koboSpan" id="kobo.465.1">Stop</span></strong><span class="koboSpan" id="kobo.466.1">, and show the square </span><em class="italic"><span class="koboSpan" id="kobo.467.1">stop</span></em><span class="koboSpan" id="kobo.468.1"> symbol instead. </span></p>
<p><span class="koboSpan" id="kobo.469.1">The second </span><a id="_idIndexMarker263"/><span class="koboSpan" id="kobo.470.1">component is to add sound to the project. </span><span class="koboSpan" id="kobo.470.2">This involves importing an audio/video framework specifically made for sound and </span><span class="No-Break"><span class="koboSpan" id="kobo.471.1">video files.</span></span></p>
<p><span class="koboSpan" id="kobo.472.1">Let’s tackle the button </span><span class="No-Break"><span class="koboSpan" id="kobo.473.1">component first.</span></span></p>
<h2 id="_idParaDest-65"><a id="_idTextAnchor068"/><span class="koboSpan" id="kobo.474.1">Adding a custom dynamic button</span></h2>
<p><span class="koboSpan" id="kobo.475.1">A button</span><a id="_idIndexMarker264"/><span class="koboSpan" id="kobo.476.1"> is a control that performs an action when triggered. </span><span class="koboSpan" id="kobo.476.2">It can be configured to display a text label, an image, or both. </span><span class="koboSpan" id="kobo.476.3">When the user taps it, an action is sent to its target, which can trigger a method to be executed. </span><span class="koboSpan" id="kobo.476.4">So, let’s add one now. </span></p>
<p><span class="koboSpan" id="kobo.477.1">Still working in </span><a id="_idIndexMarker265"/><span class="koboSpan" id="kobo.478.1">the </span><strong class="source-inline"><span class="koboSpan" id="kobo.479.1">RecordButtonArmView</span></strong><span class="koboSpan" id="kobo.480.1"> file, as before, I will add the button code, and then explain how </span><span class="No-Break"><span class="koboSpan" id="kobo.481.1">it works:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.482.1">
                 //Button
                Button(action: {
                    rotateRecord.toggle()
                    if rotateRecord {
                        duration = 0.8
                        moveArm = true
                    } else {
                        duration = 0.0
                        moveArm = false
\                    }
                }) {
                    HStack() {
                        if !rotateRecord {
                            Text("Play").bold().                              foregroundColor(Color.black)
                            Image(systemName: "play.circle.                              fill").foregroundColor(Color.                              black)
                        } else {
                            Text("Stop").bold().                              foregroundColor(Color.black)
                            Image(systemName: "stop.fill").                              foregroundColor(Color.red)
                        }
                    }
                    .padding(.horizontal, 10)
                    .padding(.vertical, 5)
                    .background(Capsule().strokeBorder(Color.                      black, lineWidth: 2.00))
                }.offset(x: -105, y: 135)</span></pre>
<p><span class="koboSpan" id="kobo.483.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.484.1">Button</span></strong><span class="koboSpan" id="kobo.485.1"> control has an </span><strong class="source-inline"><span class="koboSpan" id="kobo.486.1">action</span></strong><span class="koboSpan" id="kobo.487.1"> parameter, and this is where we put the code that we want</span><a id="_idIndexMarker266"/><span class="koboSpan" id="kobo.488.1"> to be executed when the button is pressed. </span><span class="koboSpan" id="kobo.488.2">Inside this </span><strong class="source-inline"><span class="koboSpan" id="kobo.489.1">action</span></strong><span class="koboSpan" id="kobo.490.1"> closure, we toggled the </span><strong class="source-inline"><span class="koboSpan" id="kobo.491.1">rotateRecord</span></strong><span class="koboSpan" id="kobo.492.1"> variable before doing anything else. </span><span class="koboSpan" id="kobo.492.2">The reason for this is that we want the button to change the state of the variable because that’s the one that controls the spinning record. </span><span class="koboSpan" id="kobo.492.3">So, by toggling it, we’re changing the state </span><span class="No-Break"><span class="koboSpan" id="kobo.493.1">right away.</span></span></p>
<p><span class="koboSpan" id="kobo.494.1">Next, we checked to see what the state of </span><strong class="source-inline"><span class="koboSpan" id="kobo.495.1">rotateRecord</span></strong><span class="koboSpan" id="kobo.496.1"> is when using an </span><strong class="source-inline"><span class="koboSpan" id="kobo.497.1">if else</span></strong><span class="koboSpan" id="kobo.498.1"> statement. </span><span class="koboSpan" id="kobo.498.2">If it’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.499.1">true</span></strong><span class="koboSpan" id="kobo.500.1">, we set the duration variable to </span><strong class="source-inline"><span class="koboSpan" id="kobo.501.1">0.8</span></strong><span class="koboSpan" id="kobo.502.1"> seconds, as that’s how long we want it to take for the record to spin one revolution (this is a good speed for producing a spinning record effect). </span><span class="koboSpan" id="kobo.502.2">Next, we want to set the </span><strong class="source-inline"><span class="koboSpan" id="kobo.503.1">moveArm</span></strong><span class="koboSpan" id="kobo.504.1"> variable to </span><strong class="source-inline"><span class="koboSpan" id="kobo.505.1">true</span></strong><span class="koboSpan" id="kobo.506.1"> when the button is pressed, because setting that to </span><strong class="source-inline"><span class="koboSpan" id="kobo.507.1">true</span></strong><span class="koboSpan" id="kobo.508.1"> gets the arm to move over the record by </span><strong class="source-inline"><span class="koboSpan" id="kobo.509.1">8</span></strong><span class="koboSpan" id="kobo.510.1"> degrees. </span></p>
<p><span class="koboSpan" id="kobo.511.1">All of that happens if </span><strong class="source-inline"><span class="koboSpan" id="kobo.512.1">rotateRecord</span></strong><span class="koboSpan" id="kobo.513.1"> is true, but if it’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.514.1">false</span></strong><span class="koboSpan" id="kobo.515.1">, the code falls into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.516.1">else</span></strong><span class="koboSpan" id="kobo.517.1"> block. </span><span class="koboSpan" id="kobo.517.2">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.518.1">else</span></strong><span class="koboSpan" id="kobo.519.1"> block, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.520.1">duration</span></strong><span class="koboSpan" id="kobo.521.1"> is set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.522.1">0</span></strong><span class="koboSpan" id="kobo.523.1">, which effectively stops the record from spinning, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.524.1">moveArm</span></strong><span class="koboSpan" id="kobo.525.1"> is set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.526.1">false</span></strong><span class="koboSpan" id="kobo.527.1">, which will allow the arm to animate back to its original starting position: off the record, and to the right side. </span></p>
<p><span class="koboSpan" id="kobo.528.1">Then, we move into the labeling part of the button. </span><span class="koboSpan" id="kobo.528.2">Within this initializer, I declared an </span><strong class="source-inline"><span class="koboSpan" id="kobo.529.1">HStack</span></strong><span class="koboSpan" id="kobo.530.1">, and inside there, another </span><strong class="source-inline"><span class="koboSpan" id="kobo.531.1">if else</span></strong><span class="koboSpan" id="kobo.532.1"> statement. </span><span class="koboSpan" id="kobo.532.2">I’m using the not operator (</span><strong class="source-inline"><span class="koboSpan" id="kobo.533.1">!</span></strong><span class="koboSpan" id="kobo.534.1">) in front of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.535.1">rotateRecord</span></strong><span class="koboSpan" id="kobo.536.1"> variable too, which will read like this: if the </span><strong class="source-inline"><span class="koboSpan" id="kobo.537.1">rotateRecord</span></strong><span class="koboSpan" id="kobo.538.1"> variable is not </span><strong class="source-inline"><span class="koboSpan" id="kobo.539.1">true</span></strong><span class="koboSpan" id="kobo.540.1"> (this is another way of saying the variable is </span><strong class="source-inline"><span class="koboSpan" id="kobo.541.1">false</span></strong><span class="koboSpan" id="kobo.542.1">), then the record is not playing, so set the text for the button to the word </span><strong class="source-inline"><span class="koboSpan" id="kobo.543.1">"Play"</span></strong><span class="koboSpan" id="kobo.544.1">, make it bold and black, and provide a system image for it (a triangular </span><em class="italic"><span class="koboSpan" id="kobo.545.1">play</span></em><span class="koboSpan" id="kobo.546.1"> button). </span><span class="koboSpan" id="kobo.546.2">But if the code falls into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.547.1">else</span></strong><span class="koboSpan" id="kobo.548.1"> block here, it means the record is spinning; in this case, we want to make the text bold, change the foreground color to red, and provide a system image of a </span><em class="italic"><span class="koboSpan" id="kobo.549.1">stop</span></em><span class="koboSpan" id="kobo.550.1"> button. </span></p>
<p><span class="koboSpan" id="kobo.551.1">To finish off the button, we added a little bit of padding on its horizontal and vertical sides, gave it a capsule shape, and used the </span><strong class="source-inline"><span class="koboSpan" id="kobo.552.1">strokeBorder</span></strong><span class="koboSpan" id="kobo.553.1"> modifier to put a </span><strong class="source-inline"><span class="koboSpan" id="kobo.554.1">2</span></strong><span class="koboSpan" id="kobo.555.1">-point black line</span><a id="_idIndexMarker267"/><span class="koboSpan" id="kobo.556.1"> around </span><span class="No-Break"><span class="koboSpan" id="kobo.557.1">the button.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.558.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.559.1">You might be wondering, why use the not operator (</span><strong class="source-inline"><span class="koboSpan" id="kobo.560.1">!</span></strong><span class="koboSpan" id="kobo.561.1">) when you can say </span><strong class="source-inline"><span class="koboSpan" id="kobo.562.1">if false</span></strong><span class="koboSpan" id="kobo.563.1"> instead? </span><span class="koboSpan" id="kobo.563.2">You can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.564.1">if false</span></strong><span class="koboSpan" id="kobo.565.1"> statement instead of </span><strong class="source-inline"><span class="koboSpan" id="kobo.566.1">if !true</span></strong><span class="koboSpan" id="kobo.567.1">, but the </span><strong class="source-inline"><span class="koboSpan" id="kobo.568.1">!</span></strong><span class="koboSpan" id="kobo.569.1"> operator can help to make your code more readable. </span><span class="koboSpan" id="kobo.569.2">For example, consider the </span><span class="No-Break"><span class="koboSpan" id="kobo.570.1">following code:</span></span></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.571.1">if !</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.572.1">fingerprintAccepted {</span></strong></span></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.573.1">    //</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.574.1">access granted</span></strong></span></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.575.1">} </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.576.1">else {</span></strong></span></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.577.1">    //</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.578.1">access denied</span></strong></span></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.579.1">}</span></strong></p>
<p class="callout"><span class="koboSpan" id="kobo.580.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.581.1">!</span></strong><span class="koboSpan" id="kobo.582.1"> operator negates the Boolean value, making the code more readable because it emphasizes the opposite of what is expected. </span><span class="koboSpan" id="kobo.582.2">In the example, if </span><strong class="source-inline"><span class="koboSpan" id="kobo.583.1">fingerprintAccepted</span></strong><span class="koboSpan" id="kobo.584.1"> is </span><strong class="source-inline"><span class="koboSpan" id="kobo.585.1">false</span></strong><span class="koboSpan" id="kobo.586.1">, access will be granted. </span><span class="koboSpan" id="kobo.586.2">If </span><strong class="source-inline"><span class="koboSpan" id="kobo.587.1">fingerprintAccepted</span></strong><span class="koboSpan" id="kobo.588.1"> is </span><strong class="source-inline"><span class="koboSpan" id="kobo.589.1">true</span></strong><span class="koboSpan" id="kobo.590.1">, access will be denied. </span><span class="koboSpan" id="kobo.590.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.591.1">!</span></strong><span class="koboSpan" id="kobo.592.1"> operator makes it clear that the code is checking for the opposite </span><span class="No-Break"><span class="koboSpan" id="kobo.593.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.594.1">fingerprintAccepted</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.595.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.596.1">With that </span><a id="_idIndexMarker268"/><span class="koboSpan" id="kobo.597.1">code placed into your project, the current interface should look </span><span class="No-Break"><span class="koboSpan" id="kobo.598.1">like this:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer063">
<span class="koboSpan" id="kobo.599.1"><img alt="Figure 4.9: Adding the button control " src="image/B18674_04_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.600.1">Figure 4.9: Adding the button control</span></p>
<p><span class="koboSpan" id="kobo.601.1">Now, there’s a </span><strong class="bold"><span class="koboSpan" id="kobo.602.1">Play</span></strong><span class="koboSpan" id="kobo.603.1"> button to control the record. </span><span class="koboSpan" id="kobo.603.2">Next up, we want our record player animation to actually play sound, so let’s </span><span class="No-Break"><span class="koboSpan" id="kobo.604.1">do that.</span></span></p>
<h2 id="_idParaDest-66"><a id="_idTextAnchor069"/><span class="koboSpan" id="kobo.605.1">Creating a sound file to play audio</span></h2>
<p><span class="koboSpan" id="kobo.606.1">Now, we are </span><a id="_idIndexMarker269"/><span class="koboSpan" id="kobo.607.1">going to add sound to the project so that it plays when the record spins. </span><span class="koboSpan" id="kobo.607.2">To do this, navigate back to the GitHub folder for this project and drag the </span><strong class="source-inline"><span class="koboSpan" id="kobo.608.1">.m4a</span></strong><span class="koboSpan" id="kobo.609.1"> file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.610.1">music</span></strong><span class="koboSpan" id="kobo.611.1"> into the Project navigator. </span><span class="koboSpan" id="kobo.611.2">Make sure to check the </span><strong class="bold"><span class="koboSpan" id="kobo.612.1">Copy files to project</span></strong><span class="koboSpan" id="kobo.613.1"> box if that box </span><span class="No-Break"><span class="koboSpan" id="kobo.614.1">is unchecked.</span></span></p>
<p><span class="koboSpan" id="kobo.615.1">With our </span><strong class="source-inline"><span class="koboSpan" id="kobo.616.1">.m4a</span></strong><span class="koboSpan" id="kobo.617.1"> audio file, we need to create a separate Swift file for this sound. </span><span class="koboSpan" id="kobo.617.2">Press </span><em class="italic"><span class="koboSpan" id="kobo.618.1">Command</span></em><span class="koboSpan" id="kobo.619.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.620.1">N</span></em><span class="koboSpan" id="kobo.621.1"> to create a new file, but instead of creating a SwiftUI View file, we will create a simple Swift file instead. </span><span class="koboSpan" id="kobo.621.2">Then, name </span><span class="No-Break"><span class="koboSpan" id="kobo.622.1">it </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.623.1">PlaySound</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.624.1">.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.625.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.626.1">The main difference between a SwiftUI View file and Swift file is the purpose of the code contained in the file. </span><span class="koboSpan" id="kobo.626.2">A SwiftUI View file contains the code needed to define a view and its layout, while Swift file can contain a wide range of code that is not specifically related to </span><span class="No-Break"><span class="koboSpan" id="kobo.627.1">defining views.</span></span></p>
<p><span class="koboSpan" id="kobo.628.1">In this file, the first thing we need to do is import the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.629.1">AVFoundation</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.630.1"> framework:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.631.1">
import AVFoundation</span></pre>
<p><span class="koboSpan" id="kobo.632.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.633.1">AVFoundation</span></strong><span class="koboSpan" id="kobo.634.1"> framework </span><a id="_idIndexMarker270"/><span class="koboSpan" id="kobo.635.1">includes classes and methods that allow developers to manipulate and work with audio and video in </span><span class="No-Break"><span class="koboSpan" id="kobo.636.1">their apps.</span></span></p>
<p><span class="koboSpan" id="kobo.637.1">Next, let’s instantiate (create) an </span><span class="No-Break"><span class="koboSpan" id="kobo.638.1">audio player:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.639.1">
var audioPlayer: AVAudioPlayer?</span></pre>
<p><span class="koboSpan" id="kobo.640.1">Notice that this variable is an optional type, denoted by a question mark at the end. </span><span class="koboSpan" id="kobo.640.2">I made it optional because if for any reason the music file cannot be found within the project, it will stop the app from crashing. </span><span class="koboSpan" id="kobo.640.3">Instead, the app will still work but simply won’t play </span><span class="No-Break"><span class="koboSpan" id="kobo.641.1">the music.</span></span></p>
<p><span class="koboSpan" id="kobo.642.1">Now, let’s now create a function called </span><strong class="source-inline"><span class="koboSpan" id="kobo.643.1">playSound</span></strong><span class="koboSpan" id="kobo.644.1"> that will search through the project for the audio file, and load it if it </span><span class="No-Break"><span class="koboSpan" id="kobo.645.1">finds it:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.646.1">
func playSound(sound: String, type: String) {
    if let path = Bundle.main.path(forResource: sound, ofType: type) {
        do {
            audioPlayer = try AVAudioPlayer(contentsOf:               URL(fileURLWithPath: path))
            audioPlayer?.play()
        } catch {
            print("Could not find and play the sound file")
        }
    }
}</span></pre>
<p><span class="koboSpan" id="kobo.647.1">Here’s how the function works. </span><span class="koboSpan" id="kobo.647.2">It has two parameters, both of which are strings: one is called </span><strong class="source-inline"><span class="koboSpan" id="kobo.648.1">sound</span></strong><span class="koboSpan" id="kobo.649.1"> and the other is called </span><strong class="source-inline"><span class="koboSpan" id="kobo.650.1">type</span></strong><span class="koboSpan" id="kobo.651.1">. </span></p>
<p><span class="koboSpan" id="kobo.652.1">The first </span><a id="_idIndexMarker271"/><span class="koboSpan" id="kobo.653.1">thing we do is to create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.654.1">path</span></strong><span class="koboSpan" id="kobo.655.1"> constant using what is </span><a id="_idIndexMarker272"/><span class="koboSpan" id="kobo.656.1">called </span><strong class="bold"><span class="koboSpan" id="kobo.657.1">optional binding</span></strong><span class="koboSpan" id="kobo.658.1"> with an </span><strong class="source-inline"><span class="koboSpan" id="kobo.659.1">if let</span></strong><span class="koboSpan" id="kobo.660.1"> statement. </span><span class="koboSpan" id="kobo.660.2">Optional binding is a feature that lets us check the value of an optional, and if there is a value in it (meaning it’s not nil), then bind that optional to a variable </span><span class="No-Break"><span class="koboSpan" id="kobo.661.1">or constant.</span></span></p>
<p><span class="koboSpan" id="kobo.662.1">This constant called </span><strong class="source-inline"><span class="koboSpan" id="kobo.663.1">path</span></strong><span class="koboSpan" id="kobo.664.1"> will be assigned a path from the app’s bundle. </span><span class="koboSpan" id="kobo.664.2">The bundle is where the app and its resources are stored, and we need to get the path to the sound file that we added to the project, which is in the app’s bundle. </span><span class="koboSpan" id="kobo.664.3">We can access the main bundle of the app by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.665.1">Bundle.main</span></strong><span class="koboSpan" id="kobo.666.1"> property. </span><span class="koboSpan" id="kobo.666.2">This property returns a </span><strong class="source-inline"><span class="koboSpan" id="kobo.667.1">Bundle</span></strong><span class="koboSpan" id="kobo.668.1"> object that represents the main bundle of the app, and we can use this object to access any of the resources in the app, such as images, sounds, or </span><span class="No-Break"><span class="koboSpan" id="kobo.669.1">other files.</span></span></p>
<p><span class="koboSpan" id="kobo.670.1">So, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.671.1">if let</span></strong><span class="koboSpan" id="kobo.672.1"> statement reads as follows: the code searches the main bundle for a file with the given sound’s name and type extension. </span><span class="koboSpan" id="kobo.672.2">If found, the file path is stored in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.673.1">path</span></strong><span class="koboSpan" id="kobo.674.1"> constant and runs the code in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.675.1">do</span></strong><span class="koboSpan" id="kobo.676.1"> block. </span><span class="koboSpan" id="kobo.676.2">Otherwise, if for whatever reason the path to the file can’t be found, then the file we are looking for is missing or corrupt, and the flow of the program will proceed into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.677.1">catch</span></strong><span class="koboSpan" id="kobo.678.1"> block and execute the </span><span class="No-Break"><span class="koboSpan" id="kobo.679.1">code there.</span></span></p>
<p><span class="koboSpan" id="kobo.680.1">Okay, let’s assume the file path has found our sound file, then the code moves into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.681.1">do</span></strong><span class="koboSpan" id="kobo.682.1"> block, in which the code will try to create an audio player using that </span><strong class="source-inline"><span class="koboSpan" id="kobo.683.1">path</span></strong><span class="koboSpan" id="kobo.684.1"> constant. </span><span class="koboSpan" id="kobo.684.2">If that is successful, then it will try to play that file. </span><span class="koboSpan" id="kobo.684.3">But again, if for any reason the file can’t be played, the code will then fall into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.685.1">catch</span></strong><span class="koboSpan" id="kobo.686.1"> block and print an error message to the console (</span><strong class="source-inline"><span class="koboSpan" id="kobo.687.1">"Could not find and play the sound file"</span></strong><span class="koboSpan" id="kobo.688.1">). </span><span class="koboSpan" id="kobo.688.2">That error message won’t be shown to the user, it’s only for our debugging purposes, but the user’s app won’t crash with this code in place; the sound just won’t play. </span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.689.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.690.1">Here, it would be helpful to show the user an alert if we fall into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.691.1">catch</span></strong><span class="koboSpan" id="kobo.692.1"> block; however, we won’t do that just yet. </span><span class="koboSpan" id="kobo.692.2">If you would like to do this, we will cover this in </span><a href="B18674_12.xhtml#_idTextAnchor172"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.693.1">Chapter 12</span></em></span></a><span class="koboSpan" id="kobo.694.1">, where we create a word game. </span></p>
<p><span class="koboSpan" id="kobo.695.1">Okay, we have </span><a id="_idIndexMarker273"/><span class="koboSpan" id="kobo.696.1">everything in place to test the app, but before we can do that, we need to combine our three files – the </span><strong class="source-inline"><span class="koboSpan" id="kobo.697.1">RecordPlayerBox</span></strong><span class="koboSpan" id="kobo.698.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.699.1">RecordButtonArmView</span></strong><span class="koboSpan" id="kobo.700.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.701.1">PlaySound</span></strong><span class="koboSpan" id="kobo.702.1"> files – into one </span><span class="No-Break"><span class="koboSpan" id="kobo.703.1">unified view.</span></span></p>
<h1 id="_idParaDest-67"><a id="_idTextAnchor070"/><span class="koboSpan" id="kobo.704.1">Combining all the elements into one view</span></h1>
<p><span class="koboSpan" id="kobo.705.1">To put all of our </span><a id="_idIndexMarker274"/><span class="koboSpan" id="kobo.706.1">finished views together into one unified grouping to make the finished project, let’s go back into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.707.1">ContentView</span></strong><span class="koboSpan" id="kobo.708.1"> file and add the </span><span class="No-Break"><span class="koboSpan" id="kobo.709.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.710.1">
struct ContentView : View {
    var body: some View {
        ZStack {
            //MARK: - ADD THE GRADIENT BACKGROUND
            RadialGradient(gradient: Gradient(colors: [.white,              .black]), center: .center, startRadius: 20,              endRadius: 600)
                .scaleEffect(1.2)
                //.ignoresSafeArea()
            //MARK: - ADD THE RECORD PLAYER BOX
            RecordPlayerBox()
            
            //MARK: - ADD THE RECORD, THE BUTTON, AND THE ARM
                RecordButtonArmView()
        }
    }
}</span></pre>
<p><span class="koboSpan" id="kobo.711.1">Again, we’re using </span><strong class="source-inline"><span class="koboSpan" id="kobo.712.1">ZStack</span></strong><span class="koboSpan" id="kobo.713.1"> as the main view because we want to layer our other views on top of </span><span class="No-Break"><span class="koboSpan" id="kobo.714.1">each other.</span></span></p>
<p><span class="koboSpan" id="kobo.715.1">First, let’s look at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.716.1">RadialGradient</span></strong><span class="koboSpan" id="kobo.717.1"> view. </span><span class="koboSpan" id="kobo.717.2">This is a struct that takes an array of colors that are placed one by one between the open and closed brackets. </span><span class="koboSpan" id="kobo.717.3">Within those brackets, you can put as many colors as you want, separating each color by a comma (I’m using two colors: white and black). </span></p>
<p><span class="koboSpan" id="kobo.718.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.719.1">RadialGradient</span></strong><span class="koboSpan" id="kobo.720.1"> view </span><a id="_idIndexMarker275"/><span class="koboSpan" id="kobo.721.1">works by using the first color in the array to color the center of the background, and subsequent colors will surround that center. </span><span class="koboSpan" id="kobo.721.2">Using </span><strong class="source-inline"><span class="koboSpan" id="kobo.722.1">startRadius</span></strong><span class="koboSpan" id="kobo.723.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.724.1">endRadius</span></strong><span class="koboSpan" id="kobo.725.1"> values of </span><strong class="source-inline"><span class="koboSpan" id="kobo.726.1">20</span></strong><span class="koboSpan" id="kobo.727.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.728.1">600</span></strong><span class="koboSpan" id="kobo.729.1">, respectively, will make the radial gradient expand to cover the entire screen; however, it doesn’t include the safe areas of the iPhone (again, those are that little area by the notch at the top and a small area at the bottom of the phone). </span><span class="koboSpan" id="kobo.729.2">We can handle the safe areas in two ways: we can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.730.1">ignoreSafeArea</span></strong><span class="koboSpan" id="kobo.731.1"> modifier as we’ve done before, or we can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.732.1">scaleEffect</span></strong><span class="koboSpan" id="kobo.733.1"> modifier as we are doing here. </span><span class="koboSpan" id="kobo.733.2">By passing in </span><strong class="source-inline"><span class="koboSpan" id="kobo.734.1">1.2</span></strong><span class="koboSpan" id="kobo.735.1"> as a value for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.736.1">scaleEffect</span></strong><span class="koboSpan" id="kobo.737.1"> modifier, the gradient scales up 1.2 times the size of the iPhone screen, covering all the edges. </span><span class="koboSpan" id="kobo.737.2">This is effectively doing the same thing as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.738.1">ignoreSafeArea</span></strong><span class="koboSpan" id="kobo.739.1"> modifier would do. </span></p>
<p><span class="koboSpan" id="kobo.740.1">The next line of code makes a call to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.741.1">RecordPlayerBox</span></strong><span class="koboSpan" id="kobo.742.1"> view and places it over the gradient (remember that we are working in </span><strong class="source-inline"><span class="koboSpan" id="kobo.743.1">ZStack</span></strong><span class="koboSpan" id="kobo.744.1">, so views get stacked up onto one another). </span><span class="koboSpan" id="kobo.744.2">The final line of code makes a call to </span><strong class="source-inline"><span class="koboSpan" id="kobo.745.1">RecordButtonArmView</span></strong><span class="koboSpan" id="kobo.746.1">, placing it over the box, to complete </span><span class="No-Break"><span class="koboSpan" id="kobo.747.1">the interface.</span></span></p>
<p><span class="koboSpan" id="kobo.748.1">This is how our project will look (if you didn’t make any modifications along the way, </span><span class="No-Break"><span class="koboSpan" id="kobo.749.1">that is):</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer064">
<span class="koboSpan" id="kobo.750.1"><img alt="Figure 4.10: The finished interface " src="image/B18674_04_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.751.1">Figure 4.10: The finished interface</span></p>
<p><span class="koboSpan" id="kobo.752.1">The final </span><a id="_idIndexMarker276"/><span class="koboSpan" id="kobo.753.1">piece of the puzzle is to use the sound file that we created. </span><span class="koboSpan" id="kobo.753.2">This is easy to do, so as a challenge, try and think of where you would place the audio code to get the app to </span><span class="No-Break"><span class="koboSpan" id="kobo.754.1">play music.</span></span></p>
<p><span class="koboSpan" id="kobo.755.1">Did you figure it out? </span><span class="koboSpan" id="kobo.755.2">If you thought of putting code into the body of the button, then you are correct! </span><span class="koboSpan" id="kobo.755.3">The button is the view that controls the action: it gets the arm to swing over the record, and the record to spin, as well. </span><span class="koboSpan" id="kobo.755.4">So, inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.756.1">RecordButtonArmView</span></strong><span class="koboSpan" id="kobo.757.1"> file, and then inside the button’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.758.1">if</span></strong><span class="koboSpan" id="kobo.759.1"> statement, add the </span><span class="No-Break"><span class="koboSpan" id="kobo.760.1">following code:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.761.1">
playSound(sound: "music", type: "m4a")</span></pre>
<p><span class="koboSpan" id="kobo.762.1">This line of code calls the function that we made in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.763.1">PlaySound</span></strong><span class="koboSpan" id="kobo.764.1"> file, passing in the name of our music file, which is simply called </span><strong class="source-inline"><span class="koboSpan" id="kobo.765.1">music</span></strong><span class="koboSpan" id="kobo.766.1">, and the file extension for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.767.1">type</span></strong><span class="koboSpan" id="kobo.768.1"> parameter, which is </span><strong class="source-inline"><span class="koboSpan" id="kobo.769.1">m4a</span></strong><span class="koboSpan" id="kobo.770.1">. </span><span class="koboSpan" id="kobo.770.2">When the button is pressed, it means the user wants to spin the record and play the music, and this code will grab the music file and </span><span class="No-Break"><span class="koboSpan" id="kobo.771.1">play it.</span></span></p>
<p><span class="koboSpan" id="kobo.772.1">When the button is pressed again, that means the user wants to stop the music, so we need to add the following code to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.773.1">else</span></strong><span class="koboSpan" id="kobo.774.1"> block to do </span><span class="No-Break"><span class="koboSpan" id="kobo.775.1">just that:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.776.1">
audioPlayer?.stop()</span></pre>
<p><span class="koboSpan" id="kobo.777.1">This line of </span><a id="_idIndexMarker277"/><span class="koboSpan" id="kobo.778.1">code calls the audio player that we created and uses the </span><strong class="source-inline"><span class="koboSpan" id="kobo.779.1">stop</span></strong><span class="koboSpan" id="kobo.780.1"> function to stop the music. </span><span class="koboSpan" id="kobo.780.2">Notice the use of the question mark before calling the </span><strong class="source-inline"><span class="koboSpan" id="kobo.781.1">stop</span></strong><span class="koboSpan" id="kobo.782.1"> function. </span><span class="koboSpan" id="kobo.782.2">That’s because the </span><strong class="source-inline"><span class="koboSpan" id="kobo.783.1">audioPlayer</span></strong><span class="koboSpan" id="kobo.784.1"> variable was created as an optional. </span><span class="koboSpan" id="kobo.784.2">When we create optional variables, we need to use the question mark or exclamation mark when using </span><span class="No-Break"><span class="koboSpan" id="kobo.785.1">them too.</span></span></p>
<h1 id="_idParaDest-68"><a id="_idTextAnchor071"/><span class="koboSpan" id="kobo.786.1">Testing the project</span></h1>
<p><span class="koboSpan" id="kobo.787.1">And with that, the project is</span><a id="_idIndexMarker278"/><span class="koboSpan" id="kobo.788.1"> done. </span><span class="koboSpan" id="kobo.788.2">Let’s come back to </span><strong class="source-inline"><span class="koboSpan" id="kobo.789.1">ContentView</span></strong><span class="koboSpan" id="kobo.790.1"> and test everything out. </span><span class="koboSpan" id="kobo.790.2">If you hit the </span><strong class="bold"><span class="koboSpan" id="kobo.791.1">Play</span></strong><span class="koboSpan" id="kobo.792.1"> button in the </span><strong class="bold"><span class="koboSpan" id="kobo.793.1">Preview</span></strong><span class="koboSpan" id="kobo.794.1"> window or run it in the simulator, you should see that the record won’t start spinning until the player’s arm is directly over the record. </span><span class="koboSpan" id="kobo.794.2">As the record starts spinning, you should hear a golden oldy from the big band era of the 40s, complete with the scratchy intro sound that old records were notoriously famous for. </span><span class="koboSpan" id="kobo.794.3">You will also notice that the text on the button changes from </span><strong class="bold"><span class="koboSpan" id="kobo.795.1">Play</span></strong><span class="koboSpan" id="kobo.796.1"> to </span><strong class="bold"><span class="koboSpan" id="kobo.797.1">Stop</span></strong><span class="koboSpan" id="kobo.798.1">, and the color of the button changes from black to red, as shown in </span><span class="No-Break"><span class="koboSpan" id="kobo.799.1">this figure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer065">
<span class="koboSpan" id="kobo.800.1"><img alt="Figure 4.11: The spinning record " src="image/B18674_04_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.801.1">Figure 4.11: The spinning record</span></p>
<p><span class="koboSpan" id="kobo.802.1">When you</span><a id="_idIndexMarker279"/><span class="koboSpan" id="kobo.803.1"> press </span><strong class="bold"><span class="koboSpan" id="kobo.804.1">Stop</span></strong><span class="koboSpan" id="kobo.805.1">, the arm goes back to its original place, the record stops, and the </span><strong class="bold"><span class="koboSpan" id="kobo.806.1">Play</span></strong><span class="koboSpan" id="kobo.807.1"> button will </span><span class="No-Break"><span class="koboSpan" id="kobo.808.1">reappear again.</span></span></p>
<p><span class="koboSpan" id="kobo.809.1">After all of that, that completes our </span><span class="No-Break"><span class="koboSpan" id="kobo.810.1">second project!</span></span></p>
<h1 id="_idParaDest-69"><a id="_idTextAnchor072"/><span class="koboSpan" id="kobo.811.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.812.1">To recap what we covered in this project, we added images to the Assets catalog and accessed them in our code. </span><span class="koboSpan" id="kobo.812.2">Then, we created three separate files to hold the elements that we need – one to hold the record player box; one to hold the spinning record, the arm moved with an anchor point, and a dynamic button; and one in which we wrote code to access a sound file. </span><span class="koboSpan" id="kobo.812.3">Once we created these elements, we merged them into one view, to create a record and animated </span><span class="No-Break"><span class="koboSpan" id="kobo.813.1">record player.</span></span></p>
<p><span class="koboSpan" id="kobo.814.1">In the next chapter, we’re going to continue working with Swift animations by exploring colors. </span><span class="koboSpan" id="kobo.814.2">We will create a simple project that displays various images and then, using </span><strong class="source-inline"><span class="koboSpan" id="kobo.815.1">hueRotation</span></strong><span class="koboSpan" id="kobo.816.1">, change the color of the images to display a kaleidoscope effect. </span><span class="koboSpan" id="kobo.816.2">We will also look at how to pass data bidirectionally to another view, which gives up more flexibility than using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.817.1">@State</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.818.1">property wrapper.</span></span></p>
</div>
<div>
<div class="IMG---Figure" id="_idContainer067">
</div>
</div>
</body></html>