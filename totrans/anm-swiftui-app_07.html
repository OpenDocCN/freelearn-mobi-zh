<html><head></head><body>
<div id="_idContainer107">
<h1 class="chapter-number" id="_idParaDest-91"><a id="_idTextAnchor095"/><span class="koboSpan" id="kobo.1.1">7</span></h1>
<h1 id="_idParaDest-92"><a id="_idTextAnchor096"/><span class="koboSpan" id="kobo.2.1">Building a Series of Belts and Gears</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In this project, we’re going to explore rotation, and more specifically, how to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.4.1">rotation3DEffect</span></strong><span class="koboSpan" id="kobo.5.1"> modifier to rotate objects on the </span><em class="italic"><span class="koboSpan" id="kobo.6.1">x</span></em><span class="koboSpan" id="kobo.7.1">-, </span><em class="italic"><span class="koboSpan" id="kobo.8.1">y</span></em><span class="koboSpan" id="kobo.9.1">-, and </span><em class="italic"><span class="koboSpan" id="kobo.10.1">z</span></em><span class="koboSpan" id="kobo.11.1">-axis. </span><span class="koboSpan" id="kobo.11.2">We will be doing this by animating a series of gears and belts that will eventually move a </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">fan blade.</span></span></p>
<p><span class="koboSpan" id="kobo.13.1">As we create this project, we will also explore how to use Groups and Pragma Marks to make your code more organized, and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.14.1">zIndex</span></strong><span class="koboSpan" id="kobo.15.1"> property, which changes the depth of views. </span></p>
<p><span class="koboSpan" id="kobo.16.1">In this chapter, we will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.18.1">Animating our first </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">circular gear</span></span></li>
<li><span class="koboSpan" id="kobo.20.1">Adding a worm gear </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">using shadows</span></span></li>
<li><span class="koboSpan" id="kobo.22.1">Using a marching ants effect to create a </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">gear belt</span></span></li>
<li><span class="koboSpan" id="kobo.24.1">Animating a gear </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">shaft image</span></span></li>
<li><span class="koboSpan" id="kobo.26.1">Animating a </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">fan image</span></span></li>
<li><span class="koboSpan" id="kobo.28.1">Bringing everything together </span><span class="No-Break"><span class="koboSpan" id="kobo.29.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.30.1">ContentView</span></strong></span></li>
</ul>
<h1 id="_idParaDest-93"><a id="_idTextAnchor097"/><span class="koboSpan" id="kobo.31.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.32.1">You can download the resources and finished project from the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.33.1">Chapter 7</span></strong></span><span class="koboSpan" id="kobo.34.1"> folder on </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">GitHub: </span></span><a href="https://github.com/PacktPublishing/Animating-SwiftUI-Applications"><span class="No-Break"><span class="koboSpan" id="kobo.36.1">https://github.com/PacktPublishing/Animating-SwiftUI-Applications</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.37.1">.</span></span></p>
<h1 id="_idParaDest-94"><a id="_idTextAnchor098"/><span class="koboSpan" id="kobo.38.1">Animating our first circular gear</span></h1>
<p><span class="koboSpan" id="kobo.39.1">To begin </span><a id="_idIndexMarker360"/><span class="koboSpan" id="kobo.40.1">with, let’s create a new project, which I’m calling </span><strong class="source-inline"><span class="koboSpan" id="kobo.41.1">Gears and Belts</span></strong><span class="koboSpan" id="kobo.42.1">. </span><span class="koboSpan" id="kobo.42.2">Then, add the images for the project (which you can find in the GitHub repository provided in the </span><em class="italic"><span class="koboSpan" id="kobo.43.1">Technical requirements</span></em><span class="koboSpan" id="kobo.44.1"> section) by dragging and dropping the images into Swift’s asset catalog. </span><span class="koboSpan" id="kobo.44.2">The images we are using are </span><strong class="source-inline"><span class="koboSpan" id="kobo.45.1">singleGear</span></strong><span class="koboSpan" id="kobo.46.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.47.1">doubleGear</span></strong><span class="koboSpan" id="kobo.48.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.49.1">wormGear</span></strong><span class="koboSpan" id="kobo.50.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.51.1">motor</span></strong><span class="koboSpan" id="kobo.52.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.53.1">shaft</span></strong><span class="koboSpan" id="kobo.54.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.55.1">fan</span></strong><span class="koboSpan" id="kobo.56.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.57.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.58.1">goldBackground</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.60.1">In this section, we </span><a id="_idIndexMarker361"/><span class="koboSpan" id="kobo.61.1">are going to start by animating a gear image around the </span><em class="italic"><span class="koboSpan" id="kobo.62.1">z</span></em><span class="koboSpan" id="kobo.63.1">-axis, so let’s make a SwiftUI file that will handle creating all the gears we need (as we have done in previous projects, we are going to work on each element for the project in separate files, and then piece them together in </span><strong class="source-inline"><span class="koboSpan" id="kobo.64.1">ContentView</span></strong><span class="koboSpan" id="kobo.65.1"> to create the finished animations). </span></p>
<p><span class="koboSpan" id="kobo.66.1">To do this, go to </span><strong class="bold"><span class="koboSpan" id="kobo.67.1">File</span></strong><span class="koboSpan" id="kobo.68.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.69.1">New</span></strong><span class="koboSpan" id="kobo.70.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.71.1">File</span></strong><span class="koboSpan" id="kobo.72.1">, and then choose the </span><strong class="bold"><span class="koboSpan" id="kobo.73.1">SwiftUI View</span></strong><span class="koboSpan" id="kobo.74.1"> template. </span><span class="koboSpan" id="kobo.74.2">Alternatively, you can use the Mac shortcut </span><em class="italic"><span class="koboSpan" id="kobo.75.1">Command + N</span></em><span class="koboSpan" id="kobo.76.1"> to get to the same place more quickly. </span><span class="koboSpan" id="kobo.76.2">Whichever method you choose, name this file </span><strong class="source-inline"><span class="koboSpan" id="kobo.77.1">GearView</span></strong><span class="koboSpan" id="kobo.78.1"> and </span><span class="No-Break"><span class="koboSpan" id="kobo.79.1">press </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.80.1">Create</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.81.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.82.1">Now, we can fill this file by adding the variables needed to make and animate gears images. </span><span class="koboSpan" id="kobo.82.2">Let’s start with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.83.1">State</span></strong><span class="koboSpan" id="kobo.84.1"> variable that keeps track of the animation state, the state being whether the animation is in motion or not. </span><span class="koboSpan" id="kobo.84.2">Add this </span><strong class="source-inline"><span class="koboSpan" id="kobo.85.1">@State</span></strong><span class="koboSpan" id="kobo.86.1"> variable to </span><span class="No-Break"><span class="koboSpan" id="kobo.87.1">the file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.88.1">
@State private var rotateGear = false</span></pre>
<p><span class="koboSpan" id="kobo.89.1">This variable will help to keep track of whether the gear image is rotating or not, so I have called it </span><strong class="source-inline"><span class="koboSpan" id="kobo.90.1">rotateGear</span></strong><span class="koboSpan" id="kobo.91.1">. </span><span class="koboSpan" id="kobo.91.2">It is also set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.92.1">false</span></strong><span class="koboSpan" id="kobo.93.1">, which means the animation will start inactive until this variable is changed </span><span class="No-Break"><span class="koboSpan" id="kobo.94.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.95.1">true</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.97.1">The next variable will be of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.98.1">String</span></strong><span class="koboSpan" id="kobo.99.1"> type, which we can use to set the name of the </span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">gear image:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.101.1">
var gearImage: String = ""</span></pre>
<p><span class="koboSpan" id="kobo.102.1">If you look back into the asset catalog, you will see that you placed three different types of gear in there: a single gear, a double gear, and a worm gear. </span><span class="koboSpan" id="kobo.102.2">So, when it comes time to use all these files in </span><strong class="source-inline"><span class="koboSpan" id="kobo.103.1">ContentView</span></strong><span class="koboSpan" id="kobo.104.1">, this </span><strong class="source-inline"><span class="koboSpan" id="kobo.105.1">gearImage</span></strong><span class="koboSpan" id="kobo.106.1"> variable will help save time, as all we need to do is to type in the name of the gear we want to use. </span></p>
<p><span class="koboSpan" id="kobo.107.1">Next, we need to be able to set the size of the gear; here’s another variable to </span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">handle that:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.109.1">
var gearWidth: CGFloat = 0.0</span></pre>
<p><span class="koboSpan" id="kobo.110.1">You might be wondering why we are setting the width of the gear but not the height. </span><span class="koboSpan" id="kobo.110.2">Well, the gear images we are using are circles (except for the worm gear); as you may know, circles only need one dimension, the width or height, because circles have a diameter that is always the same, regardless of which dimension is measured. </span></p>
<p><span class="koboSpan" id="kobo.111.1">Continuing</span><a id="_idIndexMarker362"/><span class="koboSpan" id="kobo.112.1"> with the variables needed for this file, let’s add another variable that indicates the number of degrees our gear </span><span class="No-Break"><span class="koboSpan" id="kobo.113.1">will turn:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.114.1">
var gearDegrees: Double = 0.0</span></pre>
<p><span class="koboSpan" id="kobo.115.1">This variable is called </span><strong class="source-inline"><span class="koboSpan" id="kobo.116.1">gearDegrees</span></strong><span class="koboSpan" id="kobo.117.1">. </span><span class="koboSpan" id="kobo.117.2">A value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.118.1">360</span></strong><span class="koboSpan" id="kobo.119.1"> will turn the gear image for one revolution, but right now, it is initialized </span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">as </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.121.1">0.0</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.123.1">We will also place gears all around the screen, so we’ll need to set a couple of variables to handle the location of these gears. </span><span class="koboSpan" id="kobo.123.2">We will use two of them to set the </span><strong class="source-inline"><span class="koboSpan" id="kobo.124.1">X</span></strong><span class="koboSpan" id="kobo.125.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.126.1">Y</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.127.1"> location:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.128.1">
var offsetGearX: CGFloat = 0.0
var offsetGearY: CGFloat = 0.0</span></pre>
<p><span class="koboSpan" id="kobo.129.1">Next, we need to be able to rotate the gears, and later the belts, to different orientations in relation to their surroundings, so let’s add a variable that will be in charge of setting </span><span class="No-Break"><span class="koboSpan" id="kobo.130.1">that value:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.131.1">
var rotateDegrees: Double = 0.0</span></pre>
<p><span class="koboSpan" id="kobo.132.1">Then, we will add a variable to set the duration of the spinning gear, meaning how long it takes to finish </span><span class="No-Break"><span class="koboSpan" id="kobo.133.1">one revolution:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.134.1">
var duration: Double = 0.0</span></pre>
<p><span class="koboSpan" id="kobo.135.1">The duration variable is set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.136.1">0</span></strong><span class="koboSpan" id="kobo.137.1">, but when it gets set to a value such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.138.1">7</span></strong><span class="koboSpan" id="kobo.139.1">, for example, that means it will take 7 seconds for the gear to turn one </span><span class="No-Break"><span class="koboSpan" id="kobo.140.1">full revolution.</span></span></p>
<p><span class="koboSpan" id="kobo.141.1">Finally, for this file, we need three more variables to set the </span><em class="italic"><span class="koboSpan" id="kobo.142.1">x</span></em><span class="koboSpan" id="kobo.143.1">-, </span><em class="italic"><span class="koboSpan" id="kobo.144.1">y</span></em><span class="koboSpan" id="kobo.145.1">-, and </span><em class="italic"><span class="koboSpan" id="kobo.146.1">z</span></em><span class="koboSpan" id="kobo.147.1">-axis position of </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">the gear:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.149.1">
var xAxis: CGFloat = 0.0
var yAxis: CGFloat = 0.0
var zAxis: CGFloat = 0.0</span></pre>
<p><span class="koboSpan" id="kobo.150.1">Each of these variables will control the axis that the gear rotates around. </span><span class="koboSpan" id="kobo.150.2">The axis is what allows us to rotate an object in three dimensions, which will help create perspective and the effect of depth in the scene. </span><span class="koboSpan" id="kobo.150.3">These variables are appropriately named </span><strong class="source-inline"><span class="koboSpan" id="kobo.151.1">xAxis</span></strong><span class="koboSpan" id="kobo.152.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.153.1">yAxis</span></strong><span class="koboSpan" id="kobo.154.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.155.1">zAxis</span></strong><span class="koboSpan" id="kobo.156.1">. </span></p>
<p><span class="koboSpan" id="kobo.157.1">We have all the variables in place, so let’s now add the code into the body of the struct and make our first gear. </span><span class="koboSpan" id="kobo.157.2">First, let’s add a </span><strong class="source-inline"><span class="koboSpan" id="kobo.158.1">ZStack</span></strong><span class="koboSpan" id="kobo.159.1"> to hold all of the views </span><span class="No-Break"><span class="koboSpan" id="kobo.160.1">we need:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.161.1">
 ZStack {
        }</span></pre>
<p><span class="koboSpan" id="kobo.162.1">Now, inside</span><a id="_idIndexMarker363"/><span class="koboSpan" id="kobo.163.1"> the </span><strong class="source-inline"><span class="koboSpan" id="kobo.164.1">ZStack</span></strong><span class="koboSpan" id="kobo.165.1">, we can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.166.1">Image</span></strong><span class="koboSpan" id="kobo.167.1"> initializer, which will place a gear image on </span><span class="No-Break"><span class="koboSpan" id="kobo.168.1">the screen:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.169.1">
ZStack {
    Image(gearImage)
       }</span></pre>
<p><span class="koboSpan" id="kobo.170.1">Remember, we have initialized the preceding </span><strong class="source-inline"><span class="koboSpan" id="kobo.171.1">gearImage</span></strong><span class="koboSpan" id="kobo.172.1"> variable to an empty string; this is what we want because it allows us to pass in different string names that represent the gear images in the </span><span class="No-Break"><span class="koboSpan" id="kobo.173.1">asset catalog.</span></span></p>
<p><span class="koboSpan" id="kobo.174.1">Next, we need several modifiers to size and place the gear image, as well as the animation modifiers to make the gear image turn. </span><span class="koboSpan" id="kobo.174.2">Add the following code </span><span class="No-Break"><span class="koboSpan" id="kobo.175.1">under </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.176.1">Image(gearImage)</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.177.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.178.1">
ZStack {
            Image(gearImage)
                .resizable()
                .aspectRatio(contentMode: .fit)
                .frame(width: gearWidth)
                .rotationEffect(.degrees(rotateGear ? </span><span class="koboSpan" id="kobo.178.2">                  gearDegrees : 0))
                .animation(Animation.linear(duration:                   duration).repeatForever(autoreverses: false),                   value: rotateGear)
                .rotation3DEffect(
                    .degrees(rotateDegrees),axis: (x: xAxis, y:                       yAxis, z: zAxis))
                .offset(x: offsetGearX, y: offsetGearY)
        }</span></pre>
<p><span class="koboSpan" id="kobo.179.1">Let’s look at the </span><a id="_idIndexMarker364"/><span class="koboSpan" id="kobo.180.1">modifiers we are </span><span class="No-Break"><span class="koboSpan" id="kobo.181.1">using here:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.182.1">Firstly, we know that we need to give the image the ability to resize, which is what the </span><strong class="source-inline"><span class="koboSpan" id="kobo.183.1">resizable</span></strong><span class="koboSpan" id="kobo.184.1"> modifier is for. </span></li>
<li><span class="koboSpan" id="kobo.185.1">Then, we want to constrain the gear image dimensions with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.186.1">fit</span></strong><span class="koboSpan" id="kobo.187.1"> aspect ratio option; as we have seen before, this mode preserves the content’s aspect ratio and indicates that the object should be scaled to fit within the available space while maintaining its aspect ratio. </span><span class="koboSpan" id="kobo.187.2">This means that the object will be scaled down if necessary so that it fits within the space it’s being displayed in, without distorting </span><span class="No-Break"><span class="koboSpan" id="kobo.188.1">its shape.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.189.1">The other option is </span><strong class="source-inline"><span class="koboSpan" id="kobo.190.1">fill</span></strong><span class="koboSpan" id="kobo.191.1">; this means that the object will be scaled up or down to fill the space it is being displayed in without distorting its shape. </span><span class="koboSpan" id="kobo.191.2">Some parts of the object may be outside of the visible area, but the object will maintain its aspect ratio. </span><span class="koboSpan" id="kobo.191.3">We haven’t used this </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">here though.</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.193.1">Next, the frame of the image is set with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.194.1">gearWidth</span></strong><span class="koboSpan" id="kobo.195.1"> modifer, which has been initialized to </span><strong class="source-inline"><span class="koboSpan" id="kobo.196.1">0</span></strong><span class="koboSpan" id="kobo.197.1">. </span><span class="koboSpan" id="kobo.197.2">By doing this, we can pass in whatever value we need to create any </span><span class="No-Break"><span class="koboSpan" id="kobo.198.1">size gear.</span></span></li>
<li><span class="koboSpan" id="kobo.199.1">The next line calls the </span><strong class="source-inline"><span class="koboSpan" id="kobo.200.1">rotationEffect</span></strong><span class="koboSpan" id="kobo.201.1"> modifier, which will rotate </span><strong class="source-inline"><span class="koboSpan" id="kobo.202.1">gearImage</span></strong><span class="koboSpan" id="kobo.203.1"> by a value we pass in. </span><span class="koboSpan" id="kobo.203.2">This modifier will only rotate the gear image when the </span><strong class="source-inline"><span class="koboSpan" id="kobo.204.1">rotateGear</span></strong><span class="koboSpan" id="kobo.205.1"> variable becomes </span><strong class="source-inline"><span class="koboSpan" id="kobo.206.1">true</span></strong><span class="koboSpan" id="kobo.207.1">; otherwise, a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.208.1">0</span></strong><span class="koboSpan" id="kobo.209.1"> gets used, meaning </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">no rotation.</span></span></li>
<li><span class="koboSpan" id="kobo.211.1">After that, we add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.212.1">animation</span></strong><span class="koboSpan" id="kobo.213.1"> modifier, which gets a </span><strong class="source-inline"><span class="koboSpan" id="kobo.214.1">linear</span></strong><span class="koboSpan" id="kobo.215.1"> animation. </span><span class="koboSpan" id="kobo.215.2">The duration of the animation will depend on the value that’s held in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.216.1">duration</span></strong><span class="koboSpan" id="kobo.217.1"> variable – here, we have set the duration to </span><strong class="source-inline"><span class="koboSpan" id="kobo.218.1">repeatForever</span></strong><span class="koboSpan" id="kobo.219.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.220.1">autoreverses</span></strong><span class="koboSpan" id="kobo.221.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.222.1">false</span></strong><span class="koboSpan" id="kobo.223.1">. </span><span class="koboSpan" id="kobo.223.2">Then, we have the </span><strong class="source-inline"><span class="koboSpan" id="kobo.224.1">value</span></strong><span class="koboSpan" id="kobo.225.1"> parameter, which accepts into its parameter the variable we want to animate and then applies the animation to </span><span class="No-Break"><span class="koboSpan" id="kobo.226.1">the view.</span></span></li>
<li><span class="koboSpan" id="kobo.227.1">The next modifier is an interesting one, it’s called </span><strong class="source-inline"><span class="koboSpan" id="kobo.228.1">rotation3DEffect</span></strong><span class="koboSpan" id="kobo.229.1">. </span><span class="koboSpan" id="kobo.229.2">This rotates a view in three dimensions around the given axis; the amount of rotation will </span><a id="_idIndexMarker365"/><span class="koboSpan" id="kobo.230.1">be determined by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.231.1">degrees</span></strong><span class="koboSpan" id="kobo.232.1"> modifier that is being used within it. </span><span class="koboSpan" id="kobo.232.2">To understand how the view will be rotated, it’s important to know where the </span><em class="italic"><span class="koboSpan" id="kobo.233.1">x</span></em><span class="koboSpan" id="kobo.234.1">-, </span><em class="italic"><span class="koboSpan" id="kobo.235.1">y</span></em><span class="koboSpan" id="kobo.236.1">-, and </span><em class="italic"><span class="koboSpan" id="kobo.237.1">z</span></em><span class="koboSpan" id="kobo.238.1">-axes exist on an iPhone screen. </span><span class="koboSpan" id="kobo.238.2">Look at the </span><span class="No-Break"><span class="koboSpan" id="kobo.239.1">following illustration:</span></span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer087">
<span class="koboSpan" id="kobo.240.1"><img alt="Figure 7.1: The three axes " src="image/B18674_07_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.241.1">Figure 7.1: The three axes</span></p>
<p><span class="koboSpan" id="kobo.242.1">The </span><em class="italic"><span class="koboSpan" id="kobo.243.1">x</span></em><span class="koboSpan" id="kobo.244.1">-axis runs from left to right on the iPhone screen, the </span><em class="italic"><span class="koboSpan" id="kobo.245.1">y</span></em><span class="koboSpan" id="kobo.246.1">-axis runs from top to bottom, and the </span><em class="italic"><span class="koboSpan" id="kobo.247.1">z</span></em><span class="koboSpan" id="kobo.248.1">-axis runs from back to front. </span><span class="koboSpan" id="kobo.248.2">These axes are three different planes of dimensional space that hold views or objects, and when an object rotates, it does so on one, or all, of these axes. </span><span class="koboSpan" id="kobo.248.3">Looking at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.249.1">rotation3DEffect</span></strong><span class="koboSpan" id="kobo.250.1"> modifier, if we pass a value in one of the axis parameters, the view will then rotate on that axis by the specified number of degrees. </span></p>
<ul>
<li><span class="koboSpan" id="kobo.251.1">Back to the code, lastly, the gear image will need to be placed somewhere on the screen; for that placement, we can use the help of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.252.1">offset</span></strong><span class="koboSpan" id="kobo.253.1"> modifier. </span><span class="koboSpan" id="kobo.253.2">This modifier has two parameters, </span><strong class="source-inline"><span class="koboSpan" id="kobo.254.1">x</span></strong><span class="koboSpan" id="kobo.255.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.256.1">y</span></strong><span class="koboSpan" id="kobo.257.1">, and the values will be determined by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.258.1">offsetGearX</span></strong><span class="koboSpan" id="kobo.259.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.260.1">offsetGearY</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.261.1"> variables.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.262.1">With the modifiers all in place, we only need to start the animation, so let’s add the following code at the end of ZStack’s </span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">closing brace:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.264.1">
.onAppear() {
            rotateGear.toggle()
        }.shadow(color: .black, radius: 1, x: 0, y: 0)</span></pre>
<p><span class="koboSpan" id="kobo.265.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.266.1">onAppear</span></strong><span class="koboSpan" id="kobo.267.1"> modifier, as </span><a id="_idIndexMarker366"/><span class="koboSpan" id="kobo.268.1">we have seen before, will run the code in its body when the scene first appears. </span><span class="koboSpan" id="kobo.268.2">In the code, we want to toggle the </span><strong class="source-inline"><span class="koboSpan" id="kobo.269.1">rotateGear</span></strong><span class="koboSpan" id="kobo.270.1"> variable to </span><strong class="source-inline"><span class="koboSpan" id="kobo.271.1">true</span></strong><span class="koboSpan" id="kobo.272.1"> to start the animation. </span><span class="koboSpan" id="kobo.272.2">I’m also adding a little bit of black shadow to the gear image, which gives it a nicer look around </span><span class="No-Break"><span class="koboSpan" id="kobo.273.1">its border.</span></span></p>
<p><span class="koboSpan" id="kobo.274.1">Now, with everything we coded so far though, we still don’t see any images in the previews! </span><span class="koboSpan" id="kobo.274.2">Let’s fix that and add some values into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.275.1">Previews</span></strong><span class="koboSpan" id="kobo.276.1"> struct in order to create a gear. </span><span class="koboSpan" id="kobo.276.2">In this example, we’ll use the double gear image, and give it a size. </span><span class="koboSpan" id="kobo.276.3">Place the following code in </span><strong class="source-inline"><span class="koboSpan" id="kobo.277.1">GearView_Previews</span></strong><span class="koboSpan" id="kobo.278.1"> so we can see the </span><span class="No-Break"><span class="koboSpan" id="kobo.279.1">animation work:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.280.1">
 GearView(gearImage: "doubleGear", gearWidth: 100, gearDegrees:    360, offsetGearX: 0, offsetGearY: 0, duration: 5)
            .previewLayout(.fixed(width: 200, height: 200))</span></pre>
<p><span class="koboSpan" id="kobo.281.1">This code fills out the </span><strong class="source-inline"><span class="koboSpan" id="kobo.282.1">GearView</span></strong><span class="koboSpan" id="kobo.283.1"> struct with some values. </span><span class="koboSpan" id="kobo.283.2">The first parameter uses the </span><strong class="source-inline"><span class="koboSpan" id="kobo.284.1">doubleGear</span></strong><span class="koboSpan" id="kobo.285.1"> image from the asset catalog as the gear to display. </span><span class="koboSpan" id="kobo.285.2">Next, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.286.1">gearWidth</span></strong><span class="koboSpan" id="kobo.287.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.288.1">gearDegrees</span></strong><span class="koboSpan" id="kobo.289.1"> parameters receive values to set the width and turning degree. </span><span class="koboSpan" id="kobo.289.2">Then, for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.290.1">offset</span></strong><span class="koboSpan" id="kobo.291.1"> parameters, by setting them to zero, the gear will just stay in the middle of the screen. </span><span class="koboSpan" id="kobo.291.2">Finally, adding a duration of 5 seconds means it’ll take 5 seconds for the gear to turn for one complete revolution. </span></p>
<p><span class="koboSpan" id="kobo.292.1">With all that in place, now, we can run the previews and check what we have done </span><span class="No-Break"><span class="koboSpan" id="kobo.293.1">so far:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer088">
<span class="koboSpan" id="kobo.294.1"><img alt="Figure 7.2: Adding our first gear " src="image/B18674_07_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.295.1">Figure 7.2: Adding our first gear</span></p>
<p><span class="koboSpan" id="kobo.296.1">The gear now </span><a id="_idIndexMarker367"/><span class="koboSpan" id="kobo.297.1">turns, again, at a rate of one revolution in </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">5 seconds.</span></span></p>
<p><span class="koboSpan" id="kobo.299.1">Also, notice that I’m setting a fixed width and height for the preview window, as we don’t need a full-size screen to display a small gear; 200 x 200 is more than </span><span class="No-Break"><span class="koboSpan" id="kobo.300.1">enough room.</span></span></p>
<p><span class="koboSpan" id="kobo.301.1">Now, with our gear in place and this file complete, anytime we need to make a gear anywhere in the project, all we have to do is call the </span><strong class="source-inline"><span class="koboSpan" id="kobo.302.1">gearView</span></strong><span class="koboSpan" id="kobo.303.1"> struct and pass in some values to create a gear of any size, wherever needed on </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">the screen.</span></span></p>
<p><span class="koboSpan" id="kobo.305.1">However, despite all that work, there is one gear that we won’t be able to turn in any meaningful way because it’s not a circular shape, and that’s the worm gear image in the asset catalog. </span><span class="koboSpan" id="kobo.305.2">In the next section, I’ll explain what a worm gear is, and how to make it turn, or at least make it look like </span><span class="No-Break"><span class="koboSpan" id="kobo.306.1">it’s turning.</span></span></p>
<h1 id="_idParaDest-95"><a id="_idTextAnchor099"/><span class="koboSpan" id="kobo.307.1">Animating a worm gear using shadows</span></h1>
<p><span class="koboSpan" id="kobo.308.1">Worm gears</span><a id="_idIndexMarker368"/><span class="koboSpan" id="kobo.309.1"> look like big screws with spiral threads, but without a screw head on the top. </span><span class="koboSpan" id="kobo.309.2">They’re used in equipment and machines where strength is an important factor because they are </span><a id="_idIndexMarker369"/><span class="koboSpan" id="kobo.310.1">very durable and can handle a lot of torque. </span><span class="koboSpan" id="kobo.310.2">Here is a typical </span><span class="No-Break"><span class="koboSpan" id="kobo.311.1">worm gear:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer089">
<span class="koboSpan" id="kobo.312.1"><img alt="Figure 7.3: A worm gear " src="image/B18674_07_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.313.1">Figure 7.3: A worm gear</span></p>
<p><span class="koboSpan" id="kobo.314.1">If we add a worm gear image to the project and animate it as we did with the round gear, it wouldn’t work very well, simply because the worm gear image is not a round shape. </span><span class="koboSpan" id="kobo.314.2">So, how can we make an irregularly shaped image appear like it’s turning as it would in the real world? </span></p>
<p><span class="koboSpan" id="kobo.315.1">What we can do is place small, shaded rectangles over the shiny parts of the worm gear image and animate those rectangles instead, which will create the illusion that the image is turning or spinning. </span><span class="No-Break"><span class="koboSpan" id="kobo.316.1">Clever, right?</span></span></p>
<p><span class="koboSpan" id="kobo.317.1">First, create a new file, choose the </span><strong class="bold"><span class="koboSpan" id="kobo.318.1">SwiftUI View</span></strong><span class="koboSpan" id="kobo.319.1"> template, and name it  </span><strong class="source-inline"><span class="koboSpan" id="kobo.320.1">WormGearView</span></strong><span class="koboSpan" id="kobo.321.1">. </span><span class="koboSpan" id="kobo.321.2">Inside this file, within the </span><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">WormGear</span></strong><span class="koboSpan" id="kobo.323.1"> struct, we will start off by adding four </span><strong class="source-inline"><span class="koboSpan" id="kobo.324.1">State</span></strong><span class="koboSpan" id="kobo.325.1"> properties, one for each rectangle </span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">we need:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.327.1">
    @State private var rect1 = false
    @State private var rect2 = false
    @State private var rect3 = false
    @State private var rect4 = false</span></pre>
<p><span class="koboSpan" id="kobo.328.1">Now in </span><a id="_idIndexMarker370"/><span class="koboSpan" id="kobo.329.1">our main </span><strong class="source-inline"><span class="koboSpan" id="kobo.330.1">ZStack</span></strong><span class="koboSpan" id="kobo.331.1">, let’s add another </span><strong class="source-inline"><span class="koboSpan" id="kobo.332.1">ZStack</span></strong><span class="koboSpan" id="kobo.333.1"> within to display the worm </span><span class="No-Break"><span class="koboSpan" id="kobo.334.1">gear image:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.335.1">
 ZStack {
    ZStack {
                Image("wormGear").resizable().frame(width: 100,                   height: 75)
           }
        }</span></pre>
<p><span class="koboSpan" id="kobo.336.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.337.1">Image</span></strong><span class="koboSpan" id="kobo.338.1"> initializer declares the image and resizes it to a width and height that we </span><span class="No-Break"><span class="koboSpan" id="kobo.339.1">can use.</span></span></p>
<p><span class="koboSpan" id="kobo.340.1">Next, we will create the first rectangle that we need to place over the shiny part of the worm gear. </span><span class="koboSpan" id="kobo.340.2">To do so, add the </span><span class="No-Break"><span class="koboSpan" id="kobo.341.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.342.1">
HStack {
                    Rectangle()
                        .frame(width: 4, height: 40)
                        .foregroundColor(.black)
                        .cornerRadius(5)
                        .opacity(rect1 ? </span><span class="koboSpan" id="kobo.342.2">0 : 0.3)
                        .offset(x: 2, y: rect1 ? </span><span class="koboSpan" id="kobo.342.3">14 : -8)
                        .animation(Animation.easeInOut                           (duration: 0.5).repeatForever                           (autoreverses: true), value: rect1)
                        .rotationEffect(.degrees(-4), anchor:                           .top)
                        .onAppear(){
                            rect1.toggle()
                        }
        }</span></pre>
<p><span class="koboSpan" id="kobo.343.1">The</span><a id="_idIndexMarker371"/><span class="koboSpan" id="kobo.344.1"> rectangles will be placed in an </span><strong class="source-inline"><span class="koboSpan" id="kobo.345.1">HStack</span></strong><span class="koboSpan" id="kobo.346.1"> because we want to put them side by side, going from left to right across the gear. </span><span class="koboSpan" id="kobo.346.2">We’re also using familiar modifiers that we’ve used before. </span><span class="koboSpan" id="kobo.346.3">We’ve made the rectangles black and given them a slight corner radius. </span><span class="koboSpan" id="kobo.346.4">The opacity of the rectangle will depend on whether the animating variable called </span><strong class="source-inline"><span class="koboSpan" id="kobo.347.1">rect1</span></strong><span class="koboSpan" id="kobo.348.1"> is </span><strong class="source-inline"><span class="koboSpan" id="kobo.349.1">true</span></strong><span class="koboSpan" id="kobo.350.1"> or not: if the </span><strong class="source-inline"><span class="koboSpan" id="kobo.351.1">rect1</span></strong><span class="koboSpan" id="kobo.352.1"> property becomes </span><strong class="source-inline"><span class="koboSpan" id="kobo.353.1">true</span></strong><span class="koboSpan" id="kobo.354.1">, then we will give the rectangle a bit of visibility using an </span><strong class="source-inline"><span class="koboSpan" id="kobo.355.1">opacity</span></strong><span class="koboSpan" id="kobo.356.1"> of </span><strong class="source-inline"><span class="koboSpan" id="kobo.357.1">0.3</span></strong><span class="koboSpan" id="kobo.358.1">; when the </span><strong class="source-inline"><span class="koboSpan" id="kobo.359.1">rect1</span></strong><span class="koboSpan" id="kobo.360.1"> property is </span><strong class="source-inline"><span class="koboSpan" id="kobo.361.1">false</span></strong><span class="koboSpan" id="kobo.362.1">, we’ll remove all opacity and </span><span class="No-Break"><span class="koboSpan" id="kobo.363.1">hide it.</span></span></p>
<p><span class="koboSpan" id="kobo.364.1">The next line of code uses the </span><strong class="source-inline"><span class="koboSpan" id="kobo.365.1">offset</span></strong><span class="koboSpan" id="kobo.366.1"> modifier to place this rectangle directly over the first shiny part of this worm gear on the left side. </span><span class="koboSpan" id="kobo.366.2">This </span><strong class="source-inline"><span class="koboSpan" id="kobo.367.1">offset</span></strong><span class="koboSpan" id="kobo.368.1"> modifier is also responsible for moving the small rectangle up and down on the </span><em class="italic"><span class="koboSpan" id="kobo.369.1">y</span></em><span class="koboSpan" id="kobo.370.1">-axis, either up </span><strong class="source-inline"><span class="koboSpan" id="kobo.371.1">14</span></strong><span class="koboSpan" id="kobo.372.1"> points when </span><strong class="source-inline"><span class="koboSpan" id="kobo.373.1">rect1</span></strong><span class="koboSpan" id="kobo.374.1"> is </span><strong class="source-inline"><span class="koboSpan" id="kobo.375.1">true</span></strong><span class="koboSpan" id="kobo.376.1">, or it will move the rectangle down to </span><strong class="source-inline"><span class="koboSpan" id="kobo.377.1">-8</span></strong><span class="koboSpan" id="kobo.378.1"> points when it becomes </span><strong class="source-inline"><span class="koboSpan" id="kobo.379.1">false</span></strong><span class="koboSpan" id="kobo.380.1">. </span><span class="koboSpan" id="kobo.380.2">The effect we’re going for here is to animate these tiny rectangles up and down and at the same time, fade them in and out over the shiny part of the worm gear image, creating the illusion that the part </span><span class="No-Break"><span class="koboSpan" id="kobo.381.1">is turning.</span></span></p>
<p><span class="koboSpan" id="kobo.382.1">Now for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.383.1">animation</span></strong><span class="koboSpan" id="kobo.384.1"> modifier: this uses an </span><strong class="source-inline"><span class="koboSpan" id="kobo.385.1">easeInOut</span></strong><span class="koboSpan" id="kobo.386.1"> timing curve, has a duration of half a second, and is set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.387.1">repeatForever</span></strong><span class="koboSpan" id="kobo.388.1">, with </span><strong class="source-inline"><span class="koboSpan" id="kobo.389.1">autoreverses</span></strong><span class="koboSpan" id="kobo.390.1"> set </span><span class="No-Break"><span class="koboSpan" id="kobo.391.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.392.1">true</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.393.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.394.1">After that, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.395.1">rotationEffect</span></strong><span class="koboSpan" id="kobo.396.1"> modifier is used to rotate this small rectangle exactly where we want it on the worm gear. </span><span class="koboSpan" id="kobo.396.2">The rectangle will rotate around the anchor point, which we have set to the top part of </span><span class="No-Break"><span class="koboSpan" id="kobo.397.1">the rectangle.</span></span></p>
<p><span class="koboSpan" id="kobo.398.1">And finally, in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.399.1">onAppear</span></strong><span class="koboSpan" id="kobo.400.1"> modifier, we toggled </span><strong class="source-inline"><span class="koboSpan" id="kobo.401.1">rect1</span></strong><span class="koboSpan" id="kobo.402.1"> so the animation starts when the </span><span class="No-Break"><span class="koboSpan" id="kobo.403.1">view appears.</span></span></p>
<p><span class="koboSpan" id="kobo.404.1">Now, go ahead and run the project; you can see the results in </span><span class="No-Break"><span class="koboSpan" id="kobo.405.1">the preview:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer090">
<span class="koboSpan" id="kobo.406.1"><img alt="Figure 7.4: A worm gear in our animation " src="image/B18674_07_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.407.1">Figure 7.4: A worm gear in our animation</span></p>
<p><span class="koboSpan" id="kobo.408.1">Looking </span><a id="_idIndexMarker372"/><span class="koboSpan" id="kobo.409.1">at the figure, it’s a bit hard to see the rectangle, but it’s definitely there, a faint thin rectangle just after the third tooth. </span><span class="koboSpan" id="kobo.409.2">If you want to see the rectangle better, remove the worm gear by misspelling </span><strong class="source-inline"><span class="koboSpan" id="kobo.410.1">wormGear</span></strong><span class="koboSpan" id="kobo.411.1"> in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.412.1">Image</span></strong><span class="koboSpan" id="kobo.413.1"> initializer, which will remove the worm gear from the previews (they hate when we misspell something!). </span><span class="koboSpan" id="kobo.413.2">When you run the project again, this is what </span><span class="No-Break"><span class="koboSpan" id="kobo.414.1">you’ll see:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer091">
<span class="koboSpan" id="kobo.415.1"><img alt="Figure 7.5: The rectangle that overlays the worm gear " src="image/B18674_07_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.416.1">Figure 7.5: The rectangle that overlays the worm gear</span></p>
<p><span class="koboSpan" id="kobo.417.1">You</span><a id="_idIndexMarker373"/><span class="koboSpan" id="kobo.418.1"> should see the rectangle moving up and down, as well as fading in and out. </span></p>
<p><span class="koboSpan" id="kobo.419.1">For the placement of this rectangle, ideally, we want it to be on the left, over the first tooth; however, that will happen when we add the other rectangles into this </span><strong class="source-inline"><span class="koboSpan" id="kobo.420.1">HStack</span></strong><span class="koboSpan" id="kobo.421.1">. </span><span class="koboSpan" id="kobo.421.2">Remember, an </span><strong class="source-inline"><span class="koboSpan" id="kobo.422.1">HStack</span></strong><span class="koboSpan" id="kobo.423.1"> lines everything up from left to right, but since we only have one rectangle in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.424.1">HStack</span></strong><span class="koboSpan" id="kobo.425.1">, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.426.1">HStack</span></strong><span class="koboSpan" id="kobo.427.1"> places it in the middle </span><span class="No-Break"><span class="koboSpan" id="kobo.428.1">for now.</span></span></p>
<p><span class="koboSpan" id="kobo.429.1">So, let’s now add a second rectangle into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.430.1">HStack</span></strong><span class="koboSpan" id="kobo.431.1">, just under the </span><span class="No-Break"><span class="koboSpan" id="kobo.432.1">first one:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.433.1">
                    Rectangle()
                        .frame(width: 4, height: 40)
                        .foregroundColor(.black)
                        .cornerRadius(5)
                        .opacity(rect2 ? </span><span class="koboSpan" id="kobo.433.2">0 : 0.3)
                        .offset(x: 7, y: rect2 ? </span><span class="koboSpan" id="kobo.433.3">-15 : -8)
                        .animation(Animation.easeInOut                           (duration: 0.5).repeatForever                           (autoreverses: true), value: rect2)
                        .rotationEffect(.degrees(-8))
                        .onAppear(){
                            rect2.toggle()
                        }</span></pre>
<p><span class="koboSpan" id="kobo.434.1">This code is almost identical to what we’ve just added for the first rectangle. </span><span class="koboSpan" id="kobo.434.2">The difference here is we are offsetting the rectangle to a different location over the gear image, and the rotation is slightly different so it can be lined up over the next shiny part of </span><span class="No-Break"><span class="koboSpan" id="kobo.435.1">the gear.</span></span></p>
<p><span class="koboSpan" id="kobo.436.1">Run</span><a id="_idIndexMarker374"/><span class="koboSpan" id="kobo.437.1"> the code and you’ll see two animating rectangles. </span><span class="koboSpan" id="kobo.437.2">They’re not quite centered over the first and second shiny teeth of the gears yet, because we have two more rectangles to add, and then the </span><strong class="source-inline"><span class="koboSpan" id="kobo.438.1">HStack</span></strong><span class="koboSpan" id="kobo.439.1"> will center each animating rectangle perfectly </span><span class="No-Break"><span class="koboSpan" id="kobo.440.1">for us.</span></span></p>
<p><span class="koboSpan" id="kobo.441.1">Before we continue and add the third and fourth rectangles though, take a look at the first three modifiers of these two rectangles that we just added. </span><span class="koboSpan" id="kobo.441.2">They both have identical values in them, so we are repeating the code here, which is what we try to avoid when programming. </span><span class="koboSpan" id="kobo.441.3">Since the values don’t change in these modifiers and we will use them in all four rectangles, instead, we can make a custom modifier into which we can put these three modifiers and shorten our code a little bit. </span></p>
<p><span class="koboSpan" id="kobo.442.1">To create a custom modifier, we need to create a struct that conforms to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.443.1">ViewModifier</span></strong><span class="koboSpan" id="kobo.444.1"> protocol. </span><span class="koboSpan" id="kobo.444.2">This protocol has one requirement, which is to implement a method called </span><strong class="source-inline"><span class="koboSpan" id="kobo.445.1">body content</span></strong><span class="koboSpan" id="kobo.446.1"> that will accept our content and then must return </span><span class="No-Break"><span class="koboSpan" id="kobo.447.1">a view.</span></span></p>
<p><span class="koboSpan" id="kobo.448.1">We can create a custom modifier at the bottom of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.449.1">WormGear</span></strong><span class="koboSpan" id="kobo.450.1"> file. </span><span class="koboSpan" id="kobo.450.2">Moving outside of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.451.1">WormGear</span></strong><span class="koboSpan" id="kobo.452.1"> struct completely and coming to the bottom of this file, add the </span><span class="No-Break"><span class="koboSpan" id="kobo.453.1">following struct:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.454.1">
struct RectModifiers: ViewModifier {
    func body(content: Content) -&gt; some View {
        content
            .frame(width: 4, height: 40)
            .foregroundColor(.black)
            .cornerRadius(5)
    }
}</span></pre>
<p><span class="koboSpan" id="kobo.455.1">This is a custom modifier struct, which I called </span><strong class="source-inline"><span class="koboSpan" id="kobo.456.1">RectModifiers</span></strong><span class="koboSpan" id="kobo.457.1">; as you can see, we are implementing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.458.1">body content</span></strong><span class="koboSpan" id="kobo.459.1"> method inside it, which is the requirement needed to satisfy the </span><strong class="source-inline"><span class="koboSpan" id="kobo.460.1">ViewModifier</span></strong><span class="koboSpan" id="kobo.461.1"> protocol. </span><span class="koboSpan" id="kobo.461.2">Then, I added the three modifiers that we were repeating in our code (i.e., the ones that weren’t changing in value: </span><strong class="source-inline"><span class="koboSpan" id="kobo.462.1">frame</span></strong><span class="koboSpan" id="kobo.463.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.464.1">foregroundColor</span></strong><span class="koboSpan" id="kobo.465.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.466.1">cornerRadius</span></strong><span class="koboSpan" id="kobo.467.1">). </span></p>
<p><span class="koboSpan" id="kobo.468.1">Now, all we have to do is go back to the first rectangle that we created, just after the worm gear creation, remove those three modifiers, and instead, call our </span><span class="No-Break"><span class="koboSpan" id="kobo.469.1">custom modifier:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.470.1">
.modifier(RectModifiers())</span></pre>
<p><span class="koboSpan" id="kobo.471.1">To use it, we </span><a id="_idIndexMarker375"/><span class="koboSpan" id="kobo.472.1">pass into it the name of the custom struct we just made, </span><strong class="source-inline"><span class="koboSpan" id="kobo.473.1">RectModifiers</span></strong><span class="koboSpan" id="kobo.474.1">. </span><span class="koboSpan" id="kobo.474.2">This new modifier struct can hold as many modifiers as we want to put in there, so modifiers that don’t change in value are probably a good idea to use here; this reduces the amount of code we need to write, especially if we have many views (for example, if we were to add 30 or 40 rectangles in </span><span class="No-Break"><span class="koboSpan" id="kobo.475.1">this file).</span></span></p>
<p><span class="koboSpan" id="kobo.476.1">Now, we can proceed to add the final two rectangles to help with the illusion that this gear is turning. </span><span class="koboSpan" id="kobo.476.2">Here’s what the code </span><span class="No-Break"><span class="koboSpan" id="kobo.477.1">looks like:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.478.1">
                  Rectangle().modifier(RectModifiers())
                        .opacity(rect3 ? </span><span class="koboSpan" id="kobo.478.2">0 : 0.3)
                        .offset(x: 5, y: rect3 ? </span><span class="koboSpan" id="kobo.478.3">-5 : -10)
                        .animation(Animation.easeInOut                           (duration: 0.5).repeatForever                           (autoreverses: true), value: rect3)
                        .rotationEffect(.degrees(-8), anchor:                           .top)
                        .onAppear(){
                            rect3.toggle()
                        }
                    Rectangle().modifier(RectModifiers())
                        .opacity(rect4 ? </span><span class="koboSpan" id="kobo.478.4">0 : 0.3)
                        .offset(x: 4, y: rect4 ? </span><span class="koboSpan" id="kobo.478.5">-10 : -10)
                        .animation(Animation.easeInOut                           (duration: 0.5).repeatForever                           (autoreverses: true), value: rect4)
                        .rotationEffect(.degrees(-7), anchor:                           .top)
                        .onAppear(){
                            rect4.toggle()</span></pre>
<p><span class="koboSpan" id="kobo.479.1">Before </span><a id="_idIndexMarker376"/><span class="koboSpan" id="kobo.480.1">we try it out, let’s add some shadow to these moving rectangles to help make them a little more pronounced. </span><span class="koboSpan" id="kobo.480.2">Add this code at the end of the closing brace of the </span><span class="No-Break"><span class="koboSpan" id="kobo.481.1">first </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.482.1">ZStack</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.483.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.484.1">
 .shadow(color: .black, radius: 0.4, x: 0.0, y: 1)</span></pre>
<p><span class="koboSpan" id="kobo.485.1">By using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.486.1">shadow</span></strong><span class="koboSpan" id="kobo.487.1"> modifier, and passing in a black shadow to go over each rectangle, I have given this shadow </span><strong class="source-inline"><span class="koboSpan" id="kobo.488.1">4</span></strong><span class="koboSpan" id="kobo.489.1"> points of radius, and the shadow will be shown on the </span><em class="italic"><span class="koboSpan" id="kobo.490.1">y</span></em><span class="koboSpan" id="kobo.491.1">-axis with a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.492.1">1</span></strong><span class="koboSpan" id="kobo.493.1">. </span><span class="koboSpan" id="kobo.493.2">Using a positive number value will move the shadow along the </span><em class="italic"><span class="koboSpan" id="kobo.494.1">y</span></em><span class="koboSpan" id="kobo.495.1">-axis, while using a negative number will move the shadow along the </span><em class="italic"><span class="koboSpan" id="kobo.496.1">y</span></em><span class="koboSpan" id="kobo.497.1">-axis in the opposite direction. </span><span class="koboSpan" id="kobo.497.2">Play around with these numbers so you can see how they affect the shadow’s prominence </span><span class="No-Break"><span class="koboSpan" id="kobo.498.1">and location.</span></span></p>
<p><span class="koboSpan" id="kobo.499.1">And with that code, this file is now complete. </span><span class="koboSpan" id="kobo.499.2">Run the project and see what </span><span class="No-Break"><span class="koboSpan" id="kobo.500.1">you think:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer092">
<span class="koboSpan" id="kobo.501.1"><img alt="Figure 7.6: The finished worm gear " src="image/B18674_07_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.502.1">Figure 7.6: The finished worm gear</span></p>
<p><span class="koboSpan" id="kobo.503.1">We have a </span><a id="_idIndexMarker377"/><span class="koboSpan" id="kobo.504.1">worm gear that actually looks like it’s turning. </span><span class="koboSpan" id="kobo.504.2">Notice that each rectangle has lined up completely over the teeth of the worm gear, starting from the left and moving to the right. </span><span class="koboSpan" id="kobo.504.3">The shiny parts are being covered up and exposed over and over again, at a nice even pace, which is actually about how fast many worm </span><span class="No-Break"><span class="koboSpan" id="kobo.505.1">gears work.</span></span></p>
<p><span class="koboSpan" id="kobo.506.1">Now we have finished animating the worm gears, we’re going to create a marching ants effect that we can use to simulate a moving gear chain. </span><span class="koboSpan" id="kobo.506.2">We can accomplish that using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.507.1">dashPhase</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.508.1"> initializer.</span></span></p>
<h1 id="_idParaDest-96"><a id="_idTextAnchor100"/><span class="koboSpan" id="kobo.509.1">Using a marching ants effect to create a gear belt</span></h1>
<p><span class="koboSpan" id="kobo.510.1">Now that </span><a id="_idIndexMarker378"/><span class="koboSpan" id="kobo.511.1">we have animated our circular and worm gears, next, we need to make some belts that can be used to wrap around those gears and </span><span class="No-Break"><span class="koboSpan" id="kobo.512.1">connect them.</span></span></p>
<p><span class="koboSpan" id="kobo.513.1">What we are</span><a id="_idIndexMarker379"/><span class="koboSpan" id="kobo.514.1"> actually doing is creating a marching ants effect. </span><span class="koboSpan" id="kobo.514.2">You probably have used this effect before, but without knowing what it was called – anytime you used your mouse or trackpad and outlined a view or created a bounding box around objects to select them, you were using the marching ants effect. </span><span class="koboSpan" id="kobo.514.3">You may remember that in </span><a href="B18674_06.xhtml#_idTextAnchor082"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.515.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.516.1"> when we used the </span><strong class="bold"><span class="koboSpan" id="kobo.517.1">Lasso Selection</span></strong><span class="koboSpan" id="kobo.518.1"> tool in Mac’s Previews app, the little dashes that outlined the portion of the image selected were an example of </span><span class="No-Break"><span class="koboSpan" id="kobo.519.1">this effect.</span></span></p>
<p><span class="koboSpan" id="kobo.520.1">So, to create our gear belt, let’s start this section by adding another new file, which we’ll call </span><strong class="source-inline"><span class="koboSpan" id="kobo.521.1">BeltView</span></strong><span class="koboSpan" id="kobo.522.1">. </span><span class="koboSpan" id="kobo.522.2">Then, as we usually do, we’ll add the variables that make everything work first, inside the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.523.1">BeltView</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.524.1"> struct:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.525.1">
@State var animateBelt: Bool = false
    var beltWidth: CGFloat = 0.0
    var beltHeight: CGFloat = 0.0
    var offsetBeltX: CGFloat = 0.0
    var offsetBeltY: CGFloat = 0.0
    var dashPhaseValue: CGFloat = 45
    var rotateDegrees: Double = 0.0
    var xAxis: CGFloat = 0.0
    var yAxis: CGFloat = 0.0
    var zAxis: CGFloat = 0.0</span></pre>
<p><span class="koboSpan" id="kobo.526.1">Each one of these variables is in charge of a </span><span class="No-Break"><span class="koboSpan" id="kobo.527.1">specific task:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.528.1">animateBelt</span></strong><span class="koboSpan" id="kobo.529.1"> keeps track of the animation for </span><span class="No-Break"><span class="koboSpan" id="kobo.530.1">the belt.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.531.1">beltWidth</span></strong><span class="koboSpan" id="kobo.532.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.533.1">beltHeight</span></strong><span class="koboSpan" id="kobo.534.1"> set the width and height of </span><span class="No-Break"><span class="koboSpan" id="kobo.535.1">the belt.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.536.1">offsetBeltX</span></strong><span class="koboSpan" id="kobo.537.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.538.1">offsetBeltY</span></strong><span class="koboSpan" id="kobo.539.1"> locate the belt in specific areas on </span><span class="No-Break"><span class="koboSpan" id="kobo.540.1">the screen.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.541.1">dashPhaseValue</span></strong><span class="koboSpan" id="kobo.542.1"> is in charge of designing the belt – for example, how far we want to space the belt segments apart from each other, how thick they should be, and </span><span class="No-Break"><span class="koboSpan" id="kobo.543.1">so on.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.544.1">rotateDegrees</span></strong><span class="koboSpan" id="kobo.545.1"> is used after we position the belt to rotate it either horizontally or vertically by passing in a </span><span class="No-Break"><span class="koboSpan" id="kobo.546.1">degree number.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.547.1">xAxis</span></strong><span class="koboSpan" id="kobo.548.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.549.1">yAxis</span></strong><span class="koboSpan" id="kobo.550.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.551.1">zAxis</span></strong><span class="koboSpan" id="kobo.552.1"> orient the belt on the </span><em class="italic"><span class="koboSpan" id="kobo.553.1">x</span></em><span class="koboSpan" id="kobo.554.1">-, </span><em class="italic"><span class="koboSpan" id="kobo.555.1">y</span></em><span class="koboSpan" id="kobo.556.1">-, and </span><em class="italic"><span class="koboSpan" id="kobo.557.1">z</span></em><span class="koboSpan" id="kobo.558.1">-axes, respectively. </span><span class="koboSpan" id="kobo.558.2">You will see these three variables come into play when we start piecing together all these separate files </span><span class="No-Break"><span class="koboSpan" id="kobo.559.1">into </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.560.1">ContentView</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.561.1">.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.562.1">With </span><a id="_idIndexMarker380"/><span class="koboSpan" id="kobo.563.1">the variables in place, we can move into</span><a id="_idIndexMarker381"/><span class="koboSpan" id="kobo.564.1"> the </span><strong class="source-inline"><span class="koboSpan" id="kobo.565.1">body</span></strong><span class="koboSpan" id="kobo.566.1"> of the struct and start adding the code to create the belt. </span><span class="koboSpan" id="kobo.566.2">There’s not a lot of code to make a belt. </span><span class="koboSpan" id="kobo.566.3">First, start by adding a </span><strong class="source-inline"><span class="koboSpan" id="kobo.567.1">ZStack</span></strong><span class="koboSpan" id="kobo.568.1"> to hold </span><span class="No-Break"><span class="koboSpan" id="kobo.569.1">our views:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.570.1">
 ZStack {
        }</span></pre>
<p><span class="koboSpan" id="kobo.571.1">Next, we want to create the shape of the belt. </span><span class="koboSpan" id="kobo.571.2">If you look at most belts or chains that are gear-driven, they have a shape similar to a capsule, and luckily, SwiftUI gives us a capsule shape that we can use. </span><span class="koboSpan" id="kobo.571.3">Add the following code, including its modifiers, inside of </span><span class="No-Break"><span class="koboSpan" id="kobo.572.1">the </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.573.1">ZStack</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.574.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.575.1">
            Capsule()
                .stroke(Color.black, style: StrokeStyle                   (lineWidth: 7, lineJoin: .round, dash:                   [5, 1.4], dashPhase: animateBelt ? </span><span class="koboSpan" id="kobo.575.2">                  dashPhaseValue : 0))
                .frame(width: beltWidth, height: beltHeight)
                .animation(Animation.linear(duration:                   3).repeatForever(autoreverses: false).                  speed(3), value: animateBelt)</span></pre>
<p><span class="koboSpan" id="kobo.576.1">This is only about five lines of code, but it does a lot of work here. </span><span class="koboSpan" id="kobo.576.2">First, we declare the capsule shape that we need and then use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.577.1">stroke</span></strong><span class="koboSpan" id="kobo.578.1"> modifier on it. </span><span class="koboSpan" id="kobo.578.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.579.1">stroke</span></strong><span class="koboSpan" id="kobo.580.1"> modifier does</span><a id="_idIndexMarker382"/><span class="koboSpan" id="kobo.581.1"> quite a bit and is also responsible for designing the belt: its first parameter will give the belt a color (we have chosen black), and the second parameter is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.582.1">strokeStyle</span></strong><span class="koboSpan" id="kobo.583.1"> parameter, where we pass in a </span><strong class="source-inline"><span class="koboSpan" id="kobo.584.1">StrokeStyle</span></strong><span class="koboSpan" id="kobo.585.1"> struct. </span></p>
<p><span class="koboSpan" id="kobo.586.1">This </span><strong class="source-inline"><span class="koboSpan" id="kobo.587.1">StrokeStyle</span></strong><span class="koboSpan" id="kobo.588.1"> struct has some parameters of its own that help style </span><span class="No-Break"><span class="koboSpan" id="kobo.589.1">the belt:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.590.1">The first one is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.591.1">lineWidth</span></strong><span class="koboSpan" id="kobo.592.1"> parameter. </span><span class="koboSpan" id="kobo.592.2">This one is fairly self-explanatory; it just means how wide we want to make the belt, which we have set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.593.1">7</span></strong><span class="koboSpan" id="kobo.594.1"> points. </span></li>
<li><span class="koboSpan" id="kobo.595.1">There’s also a </span><strong class="source-inline"><span class="koboSpan" id="kobo.596.1">lineJoin</span></strong><span class="koboSpan" id="kobo.597.1"> parameter. </span><span class="koboSpan" id="kobo.597.2">This is a value that determines how the segments of the belt will join together. </span><span class="koboSpan" id="kobo.597.3">There are three options we could use, </span><strong class="source-inline"><span class="koboSpan" id="kobo.598.1">round</span></strong><span class="koboSpan" id="kobo.599.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.600.1">bevel</span></strong><span class="koboSpan" id="kobo.601.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.602.1">miter</span></strong><span class="koboSpan" id="kobo.603.1">; I thought the line segments would look best using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.604.1">round</span></strong><span class="koboSpan" id="kobo.605.1"> option, however feel free to experiment with all these values and numbers to get the best look </span><span class="No-Break"><span class="koboSpan" id="kobo.606.1">for you.</span></span></li>
<li><span class="koboSpan" id="kobo.607.1">The next parameter is called </span><strong class="source-inline"><span class="koboSpan" id="kobo.608.1">dash</span></strong><span class="koboSpan" id="kobo.609.1">, which is responsible for the length of the segments that’s used to create the belt, and the gap between those segments. </span><span class="koboSpan" id="kobo.609.2">The first value of this parameter will determine the length of the segment (a larger number makes the segments bigger, while a smaller number makes the segments smaller); I’m using </span><strong class="source-inline"><span class="koboSpan" id="kobo.610.1">5</span></strong><span class="koboSpan" id="kobo.611.1"> points for this value. </span><span class="koboSpan" id="kobo.611.2">The second value determines the gap size between the segments (a larger number creates a larger gap, while a smaller number creates a smaller gap); for this value, a </span><strong class="source-inline"><span class="koboSpan" id="kobo.612.1">1.4</span></strong><span class="koboSpan" id="kobo.613.1"> point value creates gap that looks </span><span class="No-Break"><span class="koboSpan" id="kobo.614.1">really good.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.615.1">After</span><a id="_idIndexMarker383"/><span class="koboSpan" id="kobo.616.1"> the </span><strong class="source-inline"><span class="koboSpan" id="kobo.617.1">strokeStyle</span></strong><span class="koboSpan" id="kobo.618.1"> struct, the next modifier is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.619.1">frame</span></strong><span class="koboSpan" id="kobo.620.1">, which sets the width and height of the whole belt. </span><span class="koboSpan" id="kobo.620.2">Then we added an </span><strong class="source-inline"><span class="koboSpan" id="kobo.621.1">animation</span></strong><span class="koboSpan" id="kobo.622.1"> modifier, with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.623.1">linear</span></strong><span class="koboSpan" id="kobo.624.1"> animation and a duration of three seconds to complete one revolution, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.625.1">autoreverses</span></strong><span class="koboSpan" id="kobo.626.1"> set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.627.1">false</span></strong><span class="koboSpan" id="kobo.628.1"> (as we just want the belt to turn in one </span><span class="No-Break"><span class="koboSpan" id="kobo.629.1">direction only).</span></span></p>
<p><span class="koboSpan" id="kobo.630.1">Now we need to add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.631.1">onAppear</span></strong><span class="koboSpan" id="kobo.632.1"> modifier so we can start the animation when the app loads up. </span><span class="koboSpan" id="kobo.632.2">To do that, add the following code right under the </span><span class="No-Break"><span class="koboSpan" id="kobo.633.1">existing code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.634.1">
      .onAppear {
                    animateBelt.toggle()
                }</span></pre>
<p><span class="koboSpan" id="kobo.635.1">This code toggles the </span><strong class="source-inline"><span class="koboSpan" id="kobo.636.1">animateBelt</span></strong><span class="koboSpan" id="kobo.637.1"> property to </span><strong class="source-inline"><span class="koboSpan" id="kobo.638.1">true</span></strong><span class="koboSpan" id="kobo.639.1">, kicking off the </span><span class="No-Break"><span class="koboSpan" id="kobo.640.1">belt animation.</span></span></p>
<p><span class="koboSpan" id="kobo.641.1">There’s only one last bit of code we need to add to finish off the styling of the belt, and that is to rotate the belt to the proper angle for the gears. </span><span class="koboSpan" id="kobo.641.2">Coming out of </span><strong class="source-inline"><span class="koboSpan" id="kobo.642.1">ZStack</span></strong><span class="koboSpan" id="kobo.643.1">, just after its closing brace, add the </span><span class="No-Break"><span class="koboSpan" id="kobo.644.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.645.1">
        .shadow(color: .black, radius: 10, x: 1, y: 0)
        .rotationEffect(.degrees(rotateDegrees), anchor:           .center)
        .offset(x: offsetBeltX, y: offsetBeltY)</span></pre>
<p><span class="koboSpan" id="kobo.646.1">This</span><a id="_idIndexMarker384"/><span class="koboSpan" id="kobo.647.1"> code will act on everything that is in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.648.1">ZStack</span></strong><span class="koboSpan" id="kobo.649.1"> because it’s been put after its closing brace. </span><span class="koboSpan" id="kobo.649.2">Here, I added a </span><strong class="source-inline"><span class="koboSpan" id="kobo.650.1">shadow</span></strong><span class="koboSpan" id="kobo.651.1"> modifier, setting the </span><a id="_idIndexMarker385"/><span class="koboSpan" id="kobo.652.1">color to black and a radius of </span><strong class="source-inline"><span class="koboSpan" id="kobo.653.1">10</span></strong><span class="koboSpan" id="kobo.654.1"> to make the belt more pronounced, and placed the shadow on the </span><em class="italic"><span class="koboSpan" id="kobo.655.1">x</span></em><span class="koboSpan" id="kobo.656.1">-axis. </span><span class="koboSpan" id="kobo.656.2">You can play around with the colors and these numbers for the shadow: by increasing the radius, you will make the shadow bigger, and by increasing the numbers for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.657.1">x</span></strong><span class="koboSpan" id="kobo.658.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.659.1">y</span></strong><span class="koboSpan" id="kobo.660.1"> parameters, you can move the shadow up, down, left, and right. </span><span class="koboSpan" id="kobo.660.2">Remember, you can use negative numbers to move the shadow in the opposite direction. </span></p>
<p><span class="koboSpan" id="kobo.661.1">The next modifier we are placing on the entire </span><strong class="source-inline"><span class="koboSpan" id="kobo.662.1">ZStack</span></strong><span class="koboSpan" id="kobo.663.1"> is </span><strong class="source-inline"><span class="koboSpan" id="kobo.664.1">rotationEffect</span></strong><span class="koboSpan" id="kobo.665.1">. </span><span class="koboSpan" id="kobo.665.2">This will rotate the completed belt to the angle we specify; when we call these various methods later in </span><strong class="source-inline"><span class="koboSpan" id="kobo.666.1">ContentView</span></strong><span class="koboSpan" id="kobo.667.1">, we’ll pass in different values that’ll orient the belt and size it just the way </span><span class="No-Break"><span class="koboSpan" id="kobo.668.1">we want.</span></span></p>
<p><span class="koboSpan" id="kobo.669.1">Finally, we added the </span><strong class="source-inline"><span class="koboSpan" id="kobo.670.1">offset</span></strong><span class="koboSpan" id="kobo.671.1"> modifier, which allows us to place the belt anywhere on the screen using the </span><em class="italic"><span class="koboSpan" id="kobo.672.1">x</span></em><span class="koboSpan" id="kobo.673.1">- </span><span class="No-Break"><span class="koboSpan" id="kobo.674.1">and </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.675.1">y</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.676.1">-coordinates.</span></span></p>
<p><span class="koboSpan" id="kobo.677.1">If you try to test out what we’ve done, you won’t see anything in the previews yet because we’ve just added a bunch of different variables into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.678.1">BeltView</span></strong><span class="koboSpan" id="kobo.679.1"> struct. </span><span class="koboSpan" id="kobo.679.2">However, we’re not using those variables in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.680.1">Previews</span></strong><span class="koboSpan" id="kobo.681.1"> struct. </span><span class="koboSpan" id="kobo.681.2">To fix this, let’s update the </span><strong class="source-inline"><span class="koboSpan" id="kobo.682.1">Previews</span></strong><span class="koboSpan" id="kobo.683.1"> struct to </span><span class="No-Break"><span class="koboSpan" id="kobo.684.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.685.1">
struct BeltView_Previews: PreviewProvider {
    static var previews: some View {
        BeltView(animateBelt: true, beltWidth: 380, beltHeight:           48, offsetBeltX: 0, offsetBeltY: 0, rotateDegrees:           90)
            .previewLayout(.fixed(width: 100, height: 400))
    }
}</span></pre>
<p><span class="koboSpan" id="kobo.686.1">When you</span><a id="_idIndexMarker386"/><span class="koboSpan" id="kobo.687.1"> run </span><strong class="source-inline"><span class="koboSpan" id="kobo.688.1">Previews</span></strong><span class="koboSpan" id="kobo.689.1"> now, you’ll see the belt </span><span class="No-Break"><span class="koboSpan" id="kobo.690.1">in action:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer093">
<span class="koboSpan" id="kobo.691.1"><img alt="Figure 7.7: The finished belt with the marching ants effect " src="image/B18674_07_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.692.1">Figure 7.7: The finished belt with the marching ants effect</span></p>
<p><span class="koboSpan" id="kobo.693.1">It’s turning </span><a id="_idIndexMarker387"/><span class="koboSpan" id="kobo.694.1">clockwise, has a nice style and spacing to fit our gears later, and the shadow makes it really come off the screen </span><span class="No-Break"><span class="koboSpan" id="kobo.695.1">a bit.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.696.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.697.1">If you notice that the belt is not animating smoothly, meaning it’s rotating but pauses slightly every few seconds or so, what you can do is play around with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.698.1">dashPhase</span></strong><span class="koboSpan" id="kobo.699.1"> value, which is used to specify the starting point of the dashes in a dashed or dotted line. </span><span class="koboSpan" id="kobo.699.2">I set it to an initial value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.700.1">45</span></strong><span class="koboSpan" id="kobo.701.1"> and that removed the pause for me, but if it does not remove it for your project, simply increase or decrease that value by 1, check the animation, and then tweak the value again by 1 until you find the sweet spot. </span></p>
<p><span class="koboSpan" id="kobo.702.1">And that’s </span><a id="_idIndexMarker388"/><span class="koboSpan" id="kobo.703.1">another file under our belt (sorry, couldn’t help myself!). </span><span class="koboSpan" id="kobo.703.2">Let’s continue on to the next section, where we’ll add a gear shaft to the mix. </span><span class="koboSpan" id="kobo.703.3">This object will turn a belt, which, in turn, will spin </span><span class="No-Break"><span class="koboSpan" id="kobo.704.1">a fan.</span></span></p>
<h1 id="_idParaDest-97"><a id="_idTextAnchor101"/><span class="koboSpan" id="kobo.705.1">Animating a gear shaft image</span></h1>
<p><span class="koboSpan" id="kobo.706.1">Continuing </span><a id="_idIndexMarker389"/><span class="koboSpan" id="kobo.707.1">on to the next component, we need a gear shaft. </span><span class="koboSpan" id="kobo.707.2">A gear shaft is a cylindrical rod that has round gears at each end and is used to attach other gears or belts together, ultimately producing some form of output or work. </span><span class="koboSpan" id="kobo.707.3">For example, within the motor in your car, there is a gear shaft that turns due to the gasoline combusting. </span><span class="koboSpan" id="kobo.707.4">The output or work produced by that process moves the car forward. </span><span class="koboSpan" id="kobo.707.5">Our gear shaft won’t move a car, but instead, will turn a fan. </span><span class="koboSpan" id="kobo.707.6">After creating this, as with the worm gear, we will animate the gear shaft by using animating rectangles. </span><span class="koboSpan" id="kobo.707.7">Again, this is because the image we are using is not round, so we cannot rotate it on the </span><em class="italic"><span class="koboSpan" id="kobo.708.1">z</span></em><span class="koboSpan" id="kobo.709.1">-axis like the other </span><span class="No-Break"><span class="koboSpan" id="kobo.710.1">gear images.</span></span></p>
<p><span class="koboSpan" id="kobo.711.1">Let’s start off by creating a new SwiftUI View file, which we’ll call </span><strong class="source-inline"><span class="koboSpan" id="kobo.712.1">GearShaftView</span></strong><span class="koboSpan" id="kobo.713.1">. </span><span class="koboSpan" id="kobo.713.2">Next, let’s add the variables we need for this file; we only need one variable, and that’s to track </span><span class="No-Break"><span class="koboSpan" id="kobo.714.1">the animation:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.715.1">
 @State var animateRect: Bool = false</span></pre>
<p><span class="koboSpan" id="kobo.716.1">After the variable, we just need to add the code for the gear shaft image and animate it. </span><span class="koboSpan" id="kobo.716.2">Add the following</span><a id="_idIndexMarker390"/><span class="koboSpan" id="kobo.717.1"> code inside the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.718.1">body</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.719.1"> property:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.720.1">
var body: some View 
        ZStack {
            ZStack {
                Image("shaft").resizable().frame(width: 160,                   height: 40)
                Rectangle().frame(width: 140, height: 8)
                    .foregroundColor(.black)
                    .cornerRadius(5)
                    .opacity(animateRect ? </span><span class="koboSpan" id="kobo.720.2">0 : 0.5)
                    .animation(Animation.easeInOut(duration:                       0.5).repeatForever(autoreverses: true),                       value: animateRect)
                    .onAppear() {
                        animateRect.toggle()
                    }.offset(x: 0, y: -7)
            }
        }
    }</span></pre>
<p><span class="koboSpan" id="kobo.721.1">We start by bringing the gear shaft image into the scene and setting the width and height dimensions for it. </span><span class="koboSpan" id="kobo.721.2">After that, we add a rectangle, which will be the animating shadow moving up and down over the shaft. </span><span class="koboSpan" id="kobo.721.3">The color of the shadow is black, with a little bit of a corner radius added on. </span><span class="koboSpan" id="kobo.721.4">The opacity will animate from 0, which is invisible, to 0.5, which is 50% visible. </span><span class="koboSpan" id="kobo.721.5">This will produce a nice shadowy rectangle that appears and disappears at the same cadence that the gears and shafts </span><span class="No-Break"><span class="koboSpan" id="kobo.722.1">are turning.</span></span></p>
<p><span class="koboSpan" id="kobo.723.1">In the next line of code, the animation is added, with a duration of one-half a second to complete one revolution. </span><span class="koboSpan" id="kobo.723.2">It has </span><strong class="source-inline"><span class="koboSpan" id="kobo.724.1">autoreverses</span></strong><span class="koboSpan" id="kobo.725.1"> set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.726.1">true</span></strong><span class="koboSpan" id="kobo.727.1"> because if we set </span><strong class="source-inline"><span class="koboSpan" id="kobo.728.1">autoreverses</span></strong><span class="koboSpan" id="kobo.729.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.730.1">false</span></strong><span class="koboSpan" id="kobo.731.1">, then the animation would look too abrupt (it needs </span><strong class="source-inline"><span class="koboSpan" id="kobo.732.1">autoreverses</span></strong><span class="koboSpan" id="kobo.733.1"> in order to slide the rectangle </span><span class="No-Break"><span class="koboSpan" id="kobo.734.1">back down).</span></span></p>
<p><span class="koboSpan" id="kobo.735.1">Then, we </span><a id="_idIndexMarker391"/><span class="koboSpan" id="kobo.736.1">start the animation in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.737.1">onAppear</span></strong><span class="koboSpan" id="kobo.738.1"> method and offset the rectangle so it’s neatly placed exactly where we want it, over the shaft image, using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.739.1">offset</span></strong><span class="koboSpan" id="kobo.740.1"> modifier set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.741.1">0</span></strong><span class="koboSpan" id="kobo.742.1"> for </span><strong class="source-inline"><span class="koboSpan" id="kobo.743.1">x</span></strong><span class="koboSpan" id="kobo.744.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.745.1">–7</span></strong><span class="koboSpan" id="kobo.746.1"> for </span><strong class="source-inline"><span class="koboSpan" id="kobo.747.1">y</span></strong><span class="koboSpan" id="kobo.748.1">. </span></p>
<p><span class="koboSpan" id="kobo.749.1">We are getting close to putting all these files together, but next up, we’re going to animate the </span><span class="No-Break"><span class="koboSpan" id="kobo.750.1">fan image.</span></span></p>
<h1 id="_idParaDest-98"><a id="_idTextAnchor102"/><span class="koboSpan" id="kobo.751.1">Animating a fan image</span></h1>
<p><span class="koboSpan" id="kobo.752.1">There are </span><a id="_idIndexMarker392"/><span class="koboSpan" id="kobo.753.1">actually two components left to create, the fan and the motor. </span><span class="koboSpan" id="kobo.753.2">However, we will add the motor when we start piecing all of the files together inside </span><strong class="source-inline"><span class="koboSpan" id="kobo.754.1">ContentView</span></strong><span class="koboSpan" id="kobo.755.1">. </span><span class="koboSpan" id="kobo.755.2">For that reason, let’s focus on creating the fan now. </span></p>
<p><span class="koboSpan" id="kobo.756.1">Like always, create a new file, select the </span><strong class="bold"><span class="koboSpan" id="kobo.757.1">SwiftUI View</span></strong><span class="koboSpan" id="kobo.758.1"> template, and call it </span><strong class="source-inline"><span class="koboSpan" id="kobo.759.1">FanView</span></strong><span class="koboSpan" id="kobo.760.1">. </span><span class="koboSpan" id="kobo.760.2">In this file, we only need two variables – one for the state of the animation and one to hold the degrees of rotation for the fan; here </span><span class="No-Break"><span class="koboSpan" id="kobo.761.1">they are:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.762.1">
       @State private var rotateFan = false
    var degrees: Double = 360 * 4</span></pre>
<p><span class="koboSpan" id="kobo.763.1">This file is quite short, so just add the following code to </span><span class="No-Break"><span class="koboSpan" id="kobo.764.1">complete it:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.765.1">
var body: some View {
        ZStack {
        Image("fan").resizable().aspectRatio(contentMode:           .fit).frame(width: 200)
            .rotationEffect(.degrees(rotateFan ? </span><span class="koboSpan" id="kobo.765.2">degrees : 0),               anchor: .center)
            .animation(Animation.linear(duration: 4)              .repeatForever(autoreverses: false),               value: rotateFan)
        }.onAppear() {
            rotateFan.toggle()
        }.shadow(color: .black, radius: 15)
    }</span></pre>
<p><span class="koboSpan" id="kobo.766.1">Let’s review this code. </span><span class="koboSpan" id="kobo.766.2">Inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.767.1">ZStack</span></strong><span class="koboSpan" id="kobo.768.1">, we added the image of the fan and resized it. </span><span class="koboSpan" id="kobo.768.2">Then we used the </span><strong class="source-inline"><span class="koboSpan" id="kobo.769.1">rotationEffect</span></strong><span class="koboSpan" id="kobo.770.1"> modifier on it to make it turn. </span><span class="koboSpan" id="kobo.770.2">We want the fan to spin around its center, so we set the anchor to </span><strong class="source-inline"><span class="koboSpan" id="kobo.771.1">center</span></strong><span class="koboSpan" id="kobo.772.1">, and then add the animation with a </span><a id="_idIndexMarker393"/><span class="koboSpan" id="kobo.773.1">duration of </span><strong class="source-inline"><span class="koboSpan" id="kobo.774.1">4</span></strong><span class="koboSpan" id="kobo.775.1">, which means it will spin 4 revolutions in 4 seconds. </span><span class="koboSpan" id="kobo.775.2">After that, set the animation to </span><strong class="source-inline"><span class="koboSpan" id="kobo.776.1">repeatForever</span></strong><span class="koboSpan" id="kobo.777.1"> and set </span><strong class="source-inline"><span class="koboSpan" id="kobo.778.1">autoreverses</span></strong><span class="koboSpan" id="kobo.779.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.780.1">false</span></strong><span class="koboSpan" id="kobo.781.1"> (reverse because we want the fan to spin only in </span><span class="No-Break"><span class="koboSpan" id="kobo.782.1">one direction).</span></span></p>
<p><span class="koboSpan" id="kobo.783.1">Then, let’s start the animation using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.784.1">onAppear</span></strong><span class="koboSpan" id="kobo.785.1"> modifier and add a nice heavy shadow around the fan with a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.786.1">15</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.787.1">-point radius.</span></span></p>
<p><span class="koboSpan" id="kobo.788.1">And that completes the fan. </span><span class="koboSpan" id="kobo.788.2">Now, let’s now head over to </span><strong class="source-inline"><span class="koboSpan" id="kobo.789.1">ContentView</span></strong><span class="koboSpan" id="kobo.790.1"> to create the final component – the motor – and start bringing all the files together in </span><span class="No-Break"><span class="koboSpan" id="kobo.791.1">one view.</span></span></p>
<h1 id="_idParaDest-99"><a id="_idTextAnchor103"/><span class="koboSpan" id="kobo.792.1">Bringing everything together in ContentView</span></h1>
<p><span class="koboSpan" id="kobo.793.1">Okay – we have accomplished a lot, including creating files for single and double gears, a worm gear, a gearshift, and a fan. </span><span class="koboSpan" id="kobo.793.2">Now, let’s create the final file for the motor and organize all</span><a id="_idIndexMarker394"/><span class="koboSpan" id="kobo.794.1"> these files together in </span><strong class="source-inline"><span class="koboSpan" id="kobo.795.1">ContentView</span></strong><span class="koboSpan" id="kobo.796.1">. </span></p>
<p><span class="koboSpan" id="kobo.797.1">We’re going to use a Swift feature </span><a id="_idIndexMarker395"/><span class="koboSpan" id="kobo.798.1">called </span><strong class="bold"><span class="koboSpan" id="kobo.799.1">Pragma Marks</span></strong><span class="koboSpan" id="kobo.800.1">; this is a special syntax that labels and delineates blocks of code with a very thin line between them and makes those labels appear in one drop-down menu for easy searching and navigation. </span><span class="koboSpan" id="kobo.800.2">That’s very helpful when you have very large files with hundreds or thousands of lines </span><span class="No-Break"><span class="koboSpan" id="kobo.801.1">of code.</span></span></p>
<p><span class="koboSpan" id="kobo.802.1">We will also use a SwiftUI feature called </span><strong class="bold"><span class="koboSpan" id="kobo.803.1">Groups</span></strong><span class="koboSpan" id="kobo.804.1">; this </span><a id="_idIndexMarker396"/><span class="koboSpan" id="kobo.805.1">can help us further organize all the code in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.806.1">ContentView</span></strong><span class="koboSpan" id="kobo.807.1"> file by grouping multiple objects together, such as views, scenes, or even commands, into a single unit. </span><span class="koboSpan" id="kobo.807.2">We will organize much of the code into groups based on whether it is animated on the </span><em class="italic"><span class="koboSpan" id="kobo.808.1">x</span></em><span class="koboSpan" id="kobo.809.1">-, </span><em class="italic"><span class="koboSpan" id="kobo.810.1">y</span></em><span class="koboSpan" id="kobo.811.1">-, </span><span class="No-Break"><span class="koboSpan" id="kobo.812.1">or </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.813.1">z</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.814.1">-axis.</span></span></p>
<p><span class="koboSpan" id="kobo.815.1">And then we will use the </span><strong class="bold"><span class="koboSpan" id="kobo.816.1">ZIndex</span></strong><span class="koboSpan" id="kobo.817.1"> modifier. </span><span class="koboSpan" id="kobo.817.2">This </span><a id="_idIndexMarker397"/><span class="koboSpan" id="kobo.818.1">modifier works with views that are overlapping each other, so it can be used to force a view either to the front or the back of other views. </span><span class="koboSpan" id="kobo.818.2">This is important because sometimes we need a view to be more prominent in the scene and another view to be hidden behind the scene, with only parts of it visible. </span><span class="koboSpan" id="kobo.818.3">You’ll see how this works soon. </span></p>
<p><span class="koboSpan" id="kobo.819.1">To help you complete this project, I have also labeled all the views to help you identify their location on the screen, and how they </span><span class="No-Break"><span class="koboSpan" id="kobo.820.1">are oriented:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer094">
<span class="koboSpan" id="kobo.821.1"><img alt="Figure 7.8: Our project with the views labeled " src="image/B18674_07_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.822.1">Figure 7.8: Our project with the views labeled</span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.823.1">G</span></strong><span class="koboSpan" id="kobo.824.1"> annotations refer to the </span><a id="_idIndexMarker398"/><span class="koboSpan" id="kobo.825.1">gears and </span><strong class="bold"><span class="koboSpan" id="kobo.826.1">B</span></strong><span class="koboSpan" id="kobo.827.1"> annotations refer to the belts. </span><span class="koboSpan" id="kobo.827.2">I numbered each gear and belt according to how it will appear in the code. </span><span class="koboSpan" id="kobo.827.3">We will be writing this code sequentially by the numbers – so, </span><strong class="bold"><span class="koboSpan" id="kobo.828.1">G1</span></strong><span class="koboSpan" id="kobo.829.1">, then </span><strong class="bold"><span class="koboSpan" id="kobo.830.1">G2</span></strong><span class="koboSpan" id="kobo.831.1">, then </span><strong class="bold"><span class="koboSpan" id="kobo.832.1">G3</span></strong><span class="koboSpan" id="kobo.833.1">, and so on. </span><span class="koboSpan" id="kobo.833.2">The diagram shows the placement of all </span><span class="No-Break"><span class="koboSpan" id="kobo.834.1">the parts.</span></span></p>
<p><span class="koboSpan" id="kobo.835.1">As always, we have the </span><strong class="source-inline"><span class="koboSpan" id="kobo.836.1">ContentView</span></strong><span class="koboSpan" id="kobo.837.1"> file already created for us when we started the project, so we don’t need to create any more new files. </span><span class="koboSpan" id="kobo.837.2">The first thing we are going to do here in </span><strong class="source-inline"><span class="koboSpan" id="kobo.838.1">ContentView</span></strong><span class="koboSpan" id="kobo.839.1"> is to add </span><span class="No-Break"><span class="koboSpan" id="kobo.840.1">the motor.</span></span></p>
<h2 id="_idParaDest-100"><a id="_idTextAnchor104"/><span class="koboSpan" id="kobo.841.1">Adding the motor</span></h2>
<p><span class="koboSpan" id="kobo.842.1">To </span><a id="_idIndexMarker399"/><span class="koboSpan" id="kobo.843.1">add the motor, move into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.844.1">body</span></strong><span class="koboSpan" id="kobo.845.1"> property of </span><strong class="source-inline"><span class="koboSpan" id="kobo.846.1">ContentView</span></strong><span class="koboSpan" id="kobo.847.1"> and then add a main </span><strong class="source-inline"><span class="koboSpan" id="kobo.848.1">ZStack</span></strong><span class="koboSpan" id="kobo.849.1"> to hold everything. </span><span class="koboSpan" id="kobo.849.2">Then, inside that, place </span><span class="No-Break"><span class="koboSpan" id="kobo.850.1">another </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.851.1">ZStack</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.852.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.853.1">
ZStack {
     ZStack {
            }
       }</span></pre>
<p><span class="koboSpan" id="kobo.854.1">Inside the second </span><strong class="source-inline"><span class="koboSpan" id="kobo.855.1">ZStack</span></strong><span class="koboSpan" id="kobo.856.1">, let’s add our first organizational structure, the Pragma Mark. </span><span class="koboSpan" id="kobo.856.2">To make a Pragma Mark, the syntax requires two forward slashes and </span><strong class="source-inline"><span class="koboSpan" id="kobo.857.1">MARK</span></strong><span class="koboSpan" id="kobo.858.1"> written in capital letters, followed by a colon. </span><span class="koboSpan" id="kobo.858.2">That will create a thin line moving across the file. </span><span class="koboSpan" id="kobo.858.3">You can write whatever you want after that for </span><span class="No-Break"><span class="koboSpan" id="kobo.859.1">the title.</span></span></p>
<p><span class="koboSpan" id="kobo.860.1">So, to create a Pragma Mark for the motor, enter the </span><span class="No-Break"><span class="koboSpan" id="kobo.861.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.862.1">
 //MARK: - MOTOR</span></pre>
<p><span class="koboSpan" id="kobo.863.1">Now, notice the very thin line that the Pragma Mark creates from one end of the code file to the other within </span><span class="No-Break"><span class="koboSpan" id="kobo.864.1">the editor:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer095">
<span class="koboSpan" id="kobo.865.1"><img alt="Figure 7.9: Our first Pragma Mark " src="image/B18674_07_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.866.1">Figure 7.9: Our first Pragma Mark</span></p>
<p><span class="koboSpan" id="kobo.867.1">The Pragma Mark also does something very useful behind the scenes too. </span><span class="koboSpan" id="kobo.867.2">If you look at the top left of your Xcode menu bar, where all the tabs appear, you’ll see a </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.868.1">MOTOR</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.869.1"> tab:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer096">
<span class="koboSpan" id="kobo.870.1"><img alt="Figure 7.10: The Pragma Mark tab " src="image/B18674_07_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.871.1">Figure 7.10: The Pragma Mark tab</span></p>
<p><span class="koboSpan" id="kobo.872.1">If you click on the tab, a drop-down menu will open up, containing all the Pragma Marks that you created; clicking on any one of them will take you immediately to the code in that part </span><a id="_idIndexMarker400"/><span class="koboSpan" id="kobo.873.1">of the file. </span><span class="koboSpan" id="kobo.873.2">You’ll see the usefulness of this when you have dozens or even hundreds of different blocks of code in one file, eliminating the need to scroll through a lengthy file. </span></p>
<p><span class="koboSpan" id="kobo.874.1">Now, let’s add the code that creates the motor in </span><span class="No-Break"><span class="koboSpan" id="kobo.875.1">the scene:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.876.1">
Group {
       Image("motor").resizable().aspectRatio(contentMode:          .fit).frame(width: 140, height: 120)
           .offset(x: -120, y: 90)
                }</span></pre>
<p><span class="koboSpan" id="kobo.877.1">This is our first time using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.878.1">Group</span></strong><span class="koboSpan" id="kobo.879.1"> syntax. </span><span class="koboSpan" id="kobo.879.2">Looking at the code inside the group, it contains everything that we’ve been doing all along: creating the motor using the image that’s in the Assets catalog, resizing it, setting the aspect ratio so the motor fits on the screen as we want, giving it a frame size, and offsetting on the </span><em class="italic"><span class="koboSpan" id="kobo.880.1">x</span></em><span class="koboSpan" id="kobo.881.1">- </span><span class="No-Break"><span class="koboSpan" id="kobo.882.1">and </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.883.1">y</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.884.1">-axis.</span></span></p>
<p><span class="koboSpan" id="kobo.885.1">If we run the code, this is what we should have in the previews </span><span class="No-Break"><span class="koboSpan" id="kobo.886.1">so far:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer097">
<span class="koboSpan" id="kobo.887.1"><img alt="Figure 7.11: The motor " src="image/B18674_07_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.888.1">Figure 7.11: The motor</span></p>
<p><span class="koboSpan" id="kobo.889.1">There’s </span><a id="_idIndexMarker401"/><span class="koboSpan" id="kobo.890.1">only one object in that group, the motor, but that’s perfectly fine – we’ll be adding more objects into further groups as we make them. </span><span class="koboSpan" id="kobo.890.2">For now, let’s now add some gears to </span><span class="No-Break"><span class="koboSpan" id="kobo.891.1">the scene.</span></span></p>
<h2 id="_idParaDest-101"><a id="_idTextAnchor105"/><span class="koboSpan" id="kobo.892.1">Adding the gears along the x-, y-, and z-axes</span></h2>
<p><span class="koboSpan" id="kobo.893.1">In this</span><a id="_idIndexMarker402"/><span class="koboSpan" id="kobo.894.1"> section, we will use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.895.1">GearView</span></strong><span class="koboSpan" id="kobo.896.1"> struct to add the gears. </span><span class="koboSpan" id="kobo.896.2">Remember, we already designed and animated the gears in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.897.1">GearView</span></strong><span class="koboSpan" id="kobo.898.1"> file, so all we need to do is call the </span><strong class="source-inline"><span class="koboSpan" id="kobo.899.1">GearView</span></strong><span class="koboSpan" id="kobo.900.1"> struct here in </span><strong class="source-inline"><span class="koboSpan" id="kobo.901.1">ContentView</span></strong><span class="koboSpan" id="kobo.902.1"> and pass in </span><span class="No-Break"><span class="koboSpan" id="kobo.903.1">some values.</span></span></p>
<p><span class="koboSpan" id="kobo.904.1">This is where we will also be rotating the gears and belts on the </span><em class="italic"><span class="koboSpan" id="kobo.905.1">x</span></em><span class="koboSpan" id="kobo.906.1">-, </span><em class="italic"><span class="koboSpan" id="kobo.907.1">y</span></em><span class="koboSpan" id="kobo.908.1">-, and </span><em class="italic"><span class="koboSpan" id="kobo.909.1">z</span></em><span class="koboSpan" id="kobo.910.1">-axes, so to recap how each axis operates on the screen (shown back in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.911.1">Figure 7</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.912.1">.1</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.913.1">):</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.914.1">The </span><em class="italic"><span class="koboSpan" id="kobo.915.1">y</span></em><span class="koboSpan" id="kobo.916.1">-axis runs from top to bottom and bottom </span><span class="No-Break"><span class="koboSpan" id="kobo.917.1">to top.</span></span></li>
<li><span class="koboSpan" id="kobo.918.1">The </span><em class="italic"><span class="koboSpan" id="kobo.919.1">x</span></em><span class="koboSpan" id="kobo.920.1">-axis runs from left to right and right </span><span class="No-Break"><span class="koboSpan" id="kobo.921.1">to left.</span></span></li>
<li><span class="koboSpan" id="kobo.922.1">The </span><em class="italic"><span class="koboSpan" id="kobo.923.1">z</span></em><span class="koboSpan" id="kobo.924.1">-axis moves from back to front or </span><a id="_idIndexMarker403"/><span class="koboSpan" id="kobo.925.1">front to back. </span><span class="koboSpan" id="kobo.925.2">Holding an object in your hand and moving closer to your eyes is an example of moving that object along </span><span class="No-Break"><span class="koboSpan" id="kobo.926.1">the </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.927.1">z</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.928.1">-axis.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.929.1">With that understanding, let’s start adding components. </span><span class="koboSpan" id="kobo.929.2">Put the following code in right after the closing brace of the </span><span class="No-Break"><span class="koboSpan" id="kobo.930.1">motor group:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.931.1">
      //MARK: - GEARS ANIMATING ON THE Z AXIS
                Group {
                    ///Gear 1
                    GearView(gearImage: "doubleGear",                       gearWidth: 40, gearDegrees: 360,                       offsetGearX: -124, offsetGearY: 102,                       duration: 5)
                    ///Gear 2
                    GearView(gearImage: "doubleGear",                       gearWidth: 100, gearDegrees: 360,                       offsetGearX: -124, offsetGearY: -280,                       duration: 7)
                    ///Gear 3
                    GearView(gearImage: "doubleGear",                       gearWidth: 100, gearDegrees: 360,                       offsetGearX: 124, offsetGearY: -280,                       duration: 7)
                    ///Gear 4
                    GearView(gearImage: "doubleGear",                       gearWidth: 100, gearDegrees: 360,                       offsetGearX: 124, offsetGearY: -70,                       duration: 7)
                    ///Gear 5
                    GearView(gearImage: "doubleGear",                       gearWidth: 80, gearDegrees: -360,                       offsetGearX: 49, offsetGearY: -113,                       duration: 5)
                    ///Gear 6
                    GearView(gearImage: "doubleGear",                       gearWidth: 100, gearDegrees: 360,                       offsetGearX: -6, offsetGearY: -80,                       duration: 7)
                }</span></pre>
<p><span class="koboSpan" id="kobo.932.1">I titled this</span><a id="_idIndexMarker404"/><span class="koboSpan" id="kobo.933.1"> group </span><strong class="source-inline"><span class="koboSpan" id="kobo.934.1">GEARS ANIMATING ON THE Z AXIS</span></strong><span class="koboSpan" id="kobo.935.1">. </span><span class="koboSpan" id="kobo.935.2">Here, I’m calling the </span><strong class="source-inline"><span class="koboSpan" id="kobo.936.1">GearView</span></strong><span class="koboSpan" id="kobo.937.1"> struct six times, which creates six gears that are turning on the </span><em class="italic"><span class="koboSpan" id="kobo.938.1">z</span></em><span class="koboSpan" id="kobo.939.1">-axis. </span><span class="koboSpan" id="kobo.939.2">Let’s just look at </span><strong class="source-inline"><span class="koboSpan" id="kobo.940.1">Gear 1</span></strong><span class="koboSpan" id="kobo.941.1">, as they are pretty similar, just with </span><span class="No-Break"><span class="koboSpan" id="kobo.942.1">different values.</span></span></p>
<p><span class="koboSpan" id="kobo.943.1">So, in </span><strong class="source-inline"><span class="koboSpan" id="kobo.944.1">Gear 1</span></strong><span class="koboSpan" id="kobo.945.1">, I set the gear’s width to </span><strong class="source-inline"><span class="koboSpan" id="kobo.946.1">40</span></strong><span class="koboSpan" id="kobo.947.1"> points, which makes a small gear, and positioned it directly over the front of the motor using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.948.1">offsetGearX</span></strong><span class="koboSpan" id="kobo.949.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.950.1">offsetGearY</span></strong><span class="koboSpan" id="kobo.951.1"> parameters. </span><span class="koboSpan" id="kobo.951.2">The amount of degrees passed into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.952.1">gearDegrees</span></strong><span class="koboSpan" id="kobo.953.1"> parameter is </span><strong class="source-inline"><span class="koboSpan" id="kobo.954.1">360</span></strong><span class="koboSpan" id="kobo.955.1">; that’s one revolution of a circle, as we want these gears to turn for a </span><span class="No-Break"><span class="koboSpan" id="kobo.956.1">full revolution.</span></span></p>
<p><span class="koboSpan" id="kobo.957.1">Since these are 2D images and not 3D images of gears, the depth is not really perceivable, and the gears will lie flat and be animated clockwise. </span><span class="koboSpan" id="kobo.957.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.958.1">duration</span></strong><span class="koboSpan" id="kobo.959.1"> parameter controls the amount of time it takes the gear to turn one full revolution; I’m using a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.960.1">7</span></strong><span class="koboSpan" id="kobo.961.1"> for the larger gears, and a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.962.1">5</span></strong><span class="koboSpan" id="kobo.963.1"> for the smaller ones. </span><span class="koboSpan" id="kobo.963.2">The small and larger gears are made using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.964.1">gearWidth</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.965.1"> parameter.</span></span></p>
<p><span class="koboSpan" id="kobo.966.1">Looking at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.967.1">gearDegrees</span></strong><span class="koboSpan" id="kobo.968.1"> parameter, the values I’m using are all set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.969.1">360</span></strong><span class="koboSpan" id="kobo.970.1"> (a positive number) to move them clockwise. </span><span class="koboSpan" id="kobo.970.2">Well, that is except for </span><strong class="source-inline"><span class="koboSpan" id="kobo.971.1">Gear 5</span></strong><span class="koboSpan" id="kobo.972.1">, which is set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.973.1">-360</span></strong><span class="koboSpan" id="kobo.974.1"> (a negative), as that gear will </span><span class="No-Break"><span class="koboSpan" id="kobo.975.1">move counterclockwise.</span></span></p>
<p><span class="koboSpan" id="kobo.976.1">This is what the previous code we just wrote should </span><span class="No-Break"><span class="koboSpan" id="kobo.977.1">look like:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer098">
<span class="koboSpan" id="kobo.978.1"><img alt="Figure 7.12: The gears rotating on the z-axis " src="image/B18674_07_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.979.1">Figure 7.12: The gears rotating on the z-axis</span></p>
<p><span class="koboSpan" id="kobo.980.1">If you run </span><a id="_idIndexMarker405"/><span class="koboSpan" id="kobo.981.1">this in the simulator, all of those gears will now be turning because we set the animation up already in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.982.1">GearView</span></strong><span class="koboSpan" id="kobo.983.1"> file. </span></p>
<p><span class="koboSpan" id="kobo.984.1">Let’s continue and add another group of gears that animate on the </span><em class="italic"><span class="koboSpan" id="kobo.985.1">y</span></em><span class="koboSpan" id="kobo.986.1">-axis this time. </span><span class="koboSpan" id="kobo.986.2">Add the following code right under the closing brace of the </span><span class="No-Break"><span class="koboSpan" id="kobo.987.1">previous group:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.988.1">
                //MARK: - GEARS ANIMATING ON THE Y AXIS
                Group {
                    ///Gear 7
                    GearView(gearImage: "singleGear",                       gearWidth: 100, gearDegrees: -360,                       offsetGearX: -62, offsetGearY: -85,                       rotateDegrees: 76, duration: 7, xAxis: 0,                       yAxis: 1, zAxis: 0)
                    ///Gear 8
                    GearView(gearImage: "singleGear",                       gearWidth: 25, gearDegrees: -360,                       offsetGearX: -59, offsetGearY: 19,                       rotateDegrees: 76, duration: 7, xAxis: 0,                       yAxis: 1, zAxis: 0)
                    ///Gear 10
                    GearView(gearImage: "singleGear",                       gearWidth: 100, gearDegrees: -360,                       offsetGearX: 160, offsetGearY: 94,                       rotateDegrees: 76, duration: 7, xAxis: 0,                       yAxis: 1, zAxis: 0)
                    ///Gear 11
                    GearView(gearImage: "singleGear",                       gearWidth: 25, gearDegrees: -360,                       offsetGearX: 163, offsetGearY: 252,                       rotateDegrees: 76, duration: 7, xAxis: 0,                       yAxis: 1, zAxis: 0)
                }</span></pre>
<p><span class="koboSpan" id="kobo.989.1">Again, we </span><a id="_idIndexMarker406"/><span class="koboSpan" id="kobo.990.1">start off this group of code by adding our organizational Pragma Mark called </span><strong class="source-inline"><span class="koboSpan" id="kobo.991.1">GEARS ANIMATING ON THE Y AXIS</span></strong><span class="koboSpan" id="kobo.992.1">. </span><span class="koboSpan" id="kobo.992.2">Here, we call the </span><strong class="source-inline"><span class="koboSpan" id="kobo.993.1">GearView</span></strong><span class="koboSpan" id="kobo.994.1"> struct four times, creating four gears that will rotate on </span><span class="No-Break"><span class="koboSpan" id="kobo.995.1">the </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.996.1">y</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.997.1">-axis.</span></span></p>
<p><span class="koboSpan" id="kobo.998.1">Looking at </span><strong class="source-inline"><span class="koboSpan" id="kobo.999.1">Gear 7</span></strong><span class="koboSpan" id="kobo.1000.1"> as an example, this has a width of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1001.1">100</span></strong><span class="koboSpan" id="kobo.1002.1"> points, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1003.1">gearDegrees</span></strong><span class="koboSpan" id="kobo.1004.1"> is set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1005.1">-360</span></strong><span class="koboSpan" id="kobo.1006.1"> (which means the gear rotates counterclockwise). </span><span class="koboSpan" id="kobo.1006.2">Next, the code repositions the gears using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1007.1">offsetGearX</span></strong><span class="koboSpan" id="kobo.1008.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1009.1">offsetGearY</span></strong><span class="koboSpan" id="kobo.1010.1"> parameters. </span><span class="koboSpan" id="kobo.1010.2">And by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1011.1">rotateDegrees</span></strong><span class="koboSpan" id="kobo.1012.1"> parameter, and passing in a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1013.1">76</span></strong><span class="koboSpan" id="kobo.1014.1">, we can rotate this gear on </span><span class="No-Break"><span class="koboSpan" id="kobo.1015.1">the </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1016.1">y</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1017.1">-axis.</span></span></p>
<p><span class="koboSpan" id="kobo.1018.1">The other three gears are almost exactly the same, except their size and offset locations vary, but they will all turn on </span><span class="No-Break"><span class="koboSpan" id="kobo.1019.1">the </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1020.1">y</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1021.1">-axis.</span></span></p>
<p><span class="koboSpan" id="kobo.1022.1">After adding this group of code, this is what your previews should </span><span class="No-Break"><span class="koboSpan" id="kobo.1023.1">look like:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer099">
<span class="koboSpan" id="kobo.1024.1"><img alt="Figure 7.13: The gears rotating on the y-axis " src="image/B18674_07_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1025.1">Figure 7.13: The gears rotating on the y-axis</span></p>
<p><span class="koboSpan" id="kobo.1026.1">Now, when you run the simulator, all these gears will </span><a id="_idIndexMarker407"/><span class="koboSpan" id="kobo.1027.1">be turning on their </span><span class="No-Break"><span class="koboSpan" id="kobo.1028.1">set axis.</span></span></p>
<p><span class="koboSpan" id="kobo.1029.1">Let’s continue and add another group that will make a gear animate on the </span><em class="italic"><span class="koboSpan" id="kobo.1030.1">x</span></em><span class="koboSpan" id="kobo.1031.1">-axis. </span><span class="koboSpan" id="kobo.1031.2">Add the following code right after the closing brace of the </span><span class="No-Break"><span class="koboSpan" id="kobo.1032.1">previous group:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1033.1">
  //MARK: - GEAR ANIMATING ON THE X AXIS
   Group {
                    ///Gear 9
                    GearView(gearImage: "singleGear",                       gearWidth: 175, gearDegrees: 360,                       offsetGearX: 60, offsetGearY: 39,                       rotateDegrees: 84, duration: 7,  xAxis:                       1, yAxis: 0, zAxis: 0)
                }</span></pre>
<p><span class="koboSpan" id="kobo.1034.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1035.1">GEAR ANIMATING ON THE X AXIS</span></strong><span class="koboSpan" id="kobo.1036.1"> group just has one gear here and it’s the biggest gear </span><a id="_idIndexMarker408"/><span class="koboSpan" id="kobo.1037.1">so far, with a width of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1038.1">175</span></strong><span class="koboSpan" id="kobo.1039.1"> points. </span><span class="koboSpan" id="kobo.1039.2">This gear will mesh up with two other gears – the gear to its right in the scene and the </span><span class="No-Break"><span class="koboSpan" id="kobo.1040.1">worm gear.</span></span></p>
<p><span class="koboSpan" id="kobo.1041.1">This is similar to the code we’ve already placed for the other gears in that we use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1042.1">GearView</span></strong><span class="koboSpan" id="kobo.1043.1"> initializer to create it and use the same parameters to size and locate it in the scene, but the difference here is that we’re using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1044.1">xAxis</span></strong><span class="koboSpan" id="kobo.1045.1"> parameter, and passing in a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1046.1">1</span></strong><span class="koboSpan" id="kobo.1047.1">. </span><span class="koboSpan" id="kobo.1047.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1048.1">xAxis</span></strong><span class="koboSpan" id="kobo.1049.1"> parameter will rotate this gear on the </span><em class="italic"><span class="koboSpan" id="kobo.1050.1">x</span></em><span class="koboSpan" id="kobo.1051.1">-axis, a completely different angle than for the </span><em class="italic"><span class="koboSpan" id="kobo.1052.1">y</span></em><span class="koboSpan" id="kobo.1053.1">-axis or </span><em class="italic"><span class="koboSpan" id="kobo.1054.1">z</span></em><span class="koboSpan" id="kobo.1055.1">-axis. </span><span class="koboSpan" id="kobo.1055.2">The amount of rotation is </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1056.1">84</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1057.1"> degrees.</span></span></p>
<p><span class="koboSpan" id="kobo.1058.1">Before we run this and check things out, let’s add the worm gear to see how everything fits together. </span></p>
<h2 id="_idParaDest-102"><a id="_idTextAnchor106"/><span class="koboSpan" id="kobo.1059.1">Adding the worm gear</span></h2>
<p><span class="koboSpan" id="kobo.1060.1">To add the</span><a id="_idIndexMarker409"/><span class="koboSpan" id="kobo.1061.1"> worm gear to our </span><strong class="source-inline"><span class="koboSpan" id="kobo.1062.1">ContentView</span></strong><span class="koboSpan" id="kobo.1063.1">, add the </span><span class="No-Break"><span class="koboSpan" id="kobo.1064.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1065.1">
 //MARK: - WORM GEAR
                Group {
                    WormGearView().offset(x: 60, y: 30).                      zIndex(-1)
                }</span></pre>
<p><span class="koboSpan" id="kobo.1066.1">This grouping is labeled </span><strong class="source-inline"><span class="koboSpan" id="kobo.1067.1">WORM GEAR</span></strong><span class="koboSpan" id="kobo.1068.1"> and is placed using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1069.1">offset</span></strong><span class="koboSpan" id="kobo.1070.1"> modifier. </span><span class="koboSpan" id="kobo.1070.2">Something new here though is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1071.1">zIndex</span></strong><span class="koboSpan" id="kobo.1072.1"> modifier. </span><span class="koboSpan" id="kobo.1072.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1073.1">zIndex</span></strong><span class="koboSpan" id="kobo.1074.1"> modifier places a view in front of or behind other views, which allows us to position our views from front to back or </span><span class="No-Break"><span class="koboSpan" id="kobo.1075.1">vice versa.</span></span></p>
<p><span class="koboSpan" id="kobo.1076.1">I’ve talked</span><a id="_idIndexMarker410"/><span class="koboSpan" id="kobo.1077.1"> about the </span><em class="italic"><span class="koboSpan" id="kobo.1078.1">z</span></em><span class="koboSpan" id="kobo.1079.1">-axis already, which relates to depth and objects moving closer to and farther away from us. </span><span class="koboSpan" id="kobo.1079.2">Why would we want to move a view closer or further away from our perspective? </span><span class="koboSpan" id="kobo.1079.3">Well, let’s look at an example of what happens if we don’t use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1080.1">zIndex</span></strong><span class="koboSpan" id="kobo.1081.1"> modifier in </span><span class="No-Break"><span class="koboSpan" id="kobo.1082.1">our code:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer100">
<span class="koboSpan" id="kobo.1083.1"><img alt="Figure 7.14: Adding the worm gear without zIndex " src="image/B18674_07_14.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1084.1">Figure 7.14: Adding the worm gear without zIndex</span></p>
<p><span class="koboSpan" id="kobo.1085.1">From the illustration, you can see that the worm gear has now moved to the front, which is not the placement that I want. </span><span class="koboSpan" id="kobo.1085.2">I want the worm gear to mesh up from behind </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1086.1">Gear 9</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1087.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1088.1">Let’s now add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1089.1">zIndex</span></strong><span class="koboSpan" id="kobo.1090.1"> modifier back into our code and look at </span><span class="No-Break"><span class="koboSpan" id="kobo.1091.1">the results:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer101">
<span class="koboSpan" id="kobo.1092.1"><img alt="Figure 7.15: Adding the worm gear with zIndex " src="image/B18674_07_15.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1093.1">Figure 7.15: Adding the worm gear with zIndex</span></p>
<p><span class="koboSpan" id="kobo.1094.1">All views in</span><a id="_idIndexMarker411"/><span class="koboSpan" id="kobo.1095.1"> SwiftUI have a default </span><strong class="source-inline"><span class="koboSpan" id="kobo.1096.1">zIndex</span></strong><span class="koboSpan" id="kobo.1097.1"> of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1098.1">0</span></strong><span class="koboSpan" id="kobo.1099.1">, so when I passed in a negative number, the worm gear was placed behind </span><strong class="source-inline"><span class="koboSpan" id="kobo.1100.1">Gear 9</span></strong><span class="koboSpan" id="kobo.1101.1">. </span><span class="koboSpan" id="kobo.1101.2">As you can see, this can be an important modifier when trying to organize your views regarding how close or far away you want them to be. </span></p>
<p><span class="koboSpan" id="kobo.1102.1">And with that, we have finished all the gears, so now we can move on to adding the belts into the scene. </span></p>
<h2 id="_idParaDest-103"><a id="_idTextAnchor107"/><span class="koboSpan" id="kobo.1103.1">Adding the belts</span></h2>
<p><span class="koboSpan" id="kobo.1104.1">Continuing </span><a id="_idIndexMarker412"/><span class="koboSpan" id="kobo.1105.1">with the building out of our scene, let’s add the belts. </span><span class="koboSpan" id="kobo.1105.2">Add the following grouping, which contains three belts that move on </span><span class="No-Break"><span class="koboSpan" id="kobo.1106.1">the </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1107.1">z</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1108.1">-axis:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1109.1">
//MARK: - BELTS ON THE Z AXIS
                Group {
                    ///Belt 1
                    BeltView(animateBelt: true, beltWidth:                       425, beltHeight: 48, offsetBeltX: -124,                       offsetBeltY: -90, rotateDegrees: 90)
                    ///Belt 2
                    BeltView(animateBelt: true, beltWidth:                       352, beltHeight: 100, offsetBeltX: 0,                       offsetBeltY: -280, rotateDegrees: 0)
                    ///Belt 3
                    BeltView(animateBelt: true, beltWidth:                       258, beltHeight: 48, offsetBeltX: 124,                       offsetBeltY: -175, rotateDegrees: 90)
                }</span></pre>
<p><span class="koboSpan" id="kobo.1110.1">Here, we called the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1111.1">BeltView</span></strong><span class="koboSpan" id="kobo.1112.1"> struct, set the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1113.1">animateBelt</span></strong><span class="koboSpan" id="kobo.1114.1"> properties to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1115.1">true</span></strong><span class="koboSpan" id="kobo.1116.1">, and then gave each belt an appropriate width and height so it could connect to its corresponding gears using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1117.1">beltWidth</span></strong><span class="koboSpan" id="kobo.1118.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1119.1">beltHeight</span></strong><span class="koboSpan" id="kobo.1120.1"> parameters. </span><span class="koboSpan" id="kobo.1120.2">After that, we place the belts where they need to be using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1121.1">offsetBelt</span></strong><span class="koboSpan" id="kobo.1122.1"> parameters. </span><span class="koboSpan" id="kobo.1122.2">Finally, we rotated the belts either by </span><strong class="source-inline"><span class="koboSpan" id="kobo.1123.1">90</span></strong><span class="koboSpan" id="kobo.1124.1"> degrees, which places the belt vertically, or by </span><strong class="source-inline"><span class="koboSpan" id="kobo.1125.1">0</span></strong><span class="koboSpan" id="kobo.1126.1"> degrees, which places the other belt horizontally. </span><span class="koboSpan" id="kobo.1126.2">Here’s what they look like in relation to the gears they </span><span class="No-Break"><span class="koboSpan" id="kobo.1127.1">mesh with:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer102">
<span class="koboSpan" id="kobo.1128.1"><img alt="Figure 7.16: The belts on the z-axis " src="image/B18674_07_16.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1129.1">Figure 7.16: The belts on the z-axis</span></p>
<p><span class="koboSpan" id="kobo.1130.1">Now, let’s </span><a id="_idIndexMarker413"/><span class="koboSpan" id="kobo.1131.1">take a look at rotating belts on the </span><em class="italic"><span class="koboSpan" id="kobo.1132.1">y</span></em><span class="koboSpan" id="kobo.1133.1">-axis. </span><span class="koboSpan" id="kobo.1133.2">As before, add the following code after the closing brace of the </span><span class="No-Break"><span class="koboSpan" id="kobo.1134.1">previous group:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1135.1">
  //MARK: - BELTS ON THE Y AXIS
                Group {
                    ///Belt 4
                    BeltView( beltWidth: 32, beltHeight: 125)
                        .rotation3DEffect(.degrees(75), axis:                           (x: 0, y: 1, z: 0))
                        .offset(x: -60, y: -33)
                    ///Belt 5
                    BeltView(beltWidth: 28, beltHeight: 180,                       offsetBeltY: -10)
                        .rotation3DEffect(.degrees(75), axis:                           (x: 0, y: 1, z: 0))
                        .offset(x: 162, y: 185)
                }</span></pre>
<p><span class="koboSpan" id="kobo.1136.1">Calling the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1137.1">BeltView</span></strong><span class="koboSpan" id="kobo.1138.1"> struct again, we have set these two belts to a width and height appropriate for the gear they</span><a id="_idIndexMarker414"/><span class="koboSpan" id="kobo.1139.1"> will be meshed with. </span><span class="koboSpan" id="kobo.1139.2">Then, we used the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1140.1">rotation3DEffect</span></strong><span class="koboSpan" id="kobo.1141.1"> modifier and rotated these belts on the </span><em class="italic"><span class="koboSpan" id="kobo.1142.1">y</span></em><span class="koboSpan" id="kobo.1143.1">-axis. </span><span class="koboSpan" id="kobo.1143.2">The rotation happens when we pass a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1144.1">1</span></strong><span class="koboSpan" id="kobo.1145.1"> into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1146.1">y</span></strong><span class="koboSpan" id="kobo.1147.1"> parameter, and they will rotate by </span><strong class="source-inline"><span class="koboSpan" id="kobo.1148.1">75</span></strong><span class="koboSpan" id="kobo.1149.1"> degrees. </span><span class="koboSpan" id="kobo.1149.2">As with the other belts, we offset them so that they line up with their corresponding gears using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1150.1">offset</span></strong><span class="koboSpan" id="kobo.1151.1"> modifier. </span></p>
<p><span class="koboSpan" id="kobo.1152.1">Now, your previews should look </span><span class="No-Break"><span class="koboSpan" id="kobo.1153.1">like this:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer103">
<span class="koboSpan" id="kobo.1154.1"><img alt="Figure 7.17: The belts on the y-axis " src="image/B18674_07_17.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1155.1">Figure 7.17: The belts on the y-axis</span></p>
<p><span class="koboSpan" id="kobo.1156.1">All those</span><a id="_idIndexMarker415"/><span class="koboSpan" id="kobo.1157.1"> belts and gears will be fully animated if you run the project in the simulator. </span><span class="koboSpan" id="kobo.1157.2">That leaves us with only two more groups to go – the gear shaft and fan, and </span><span class="No-Break"><span class="koboSpan" id="kobo.1158.1">a background.</span></span></p>
<h2 id="_idParaDest-104"><a id="_idTextAnchor108"/><span class="koboSpan" id="kobo.1159.1">Adding the gear shafts</span></h2>
<p><span class="koboSpan" id="kobo.1160.1">To</span><a id="_idIndexMarker416"/><span class="koboSpan" id="kobo.1161.1"> bring the shafts into the scene, add the following </span><span class="No-Break"><span class="koboSpan" id="kobo.1162.1">code next:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1163.1">
//MARK: - GEAR SHAFTS
                Group{
                    ///Shaft 1
                    GearShaftView().offset(x: 5, y: 28).                      zIndex(-1)
                    ///Shaft 2
                    GearShaftView().offset(x: 95, y: 260).                      zIndex(-1)
                }</span></pre>
<p><span class="koboSpan" id="kobo.1164.1">This is </span><a id="_idIndexMarker417"/><span class="koboSpan" id="kobo.1165.1">our </span><strong class="source-inline"><span class="koboSpan" id="kobo.1166.1">GEAR SHAFT</span></strong><span class="koboSpan" id="kobo.1167.1"> group. </span><span class="koboSpan" id="kobo.1167.2">Here, I’m calling the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1168.1">GearShaftView</span></strong><span class="koboSpan" id="kobo.1169.1"> struct twice, to create two gear shafts. </span><span class="koboSpan" id="kobo.1169.2">Then, all we have to do is simply offset them to the proper locations, and call </span><strong class="source-inline"><span class="koboSpan" id="kobo.1170.1">zIndex</span></strong><span class="koboSpan" id="kobo.1171.1"> on them, passing in a negative value. </span><span class="koboSpan" id="kobo.1171.2">This will position them behind the other views, creating the illusion that the shaft is actually part of the worm gear. </span><span class="koboSpan" id="kobo.1171.3">Here’s what the previous </span><span class="No-Break"><span class="koboSpan" id="kobo.1172.1">code produced:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer104">
<span class="koboSpan" id="kobo.1173.1"><img alt="Figure 7.18: The gear shafts " src="image/B18674_07_18.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1174.1">Figure 7.18: The gear shafts</span></p>
<p><span class="koboSpan" id="kobo.1175.1">The</span><a id="_idIndexMarker418"/><span class="koboSpan" id="kobo.1176.1"> worm gear and the gear shaft are the two objects that we could not animate with conventional methods because that would not look good, and it wouldn’t be an accurate representation of how they turn in the physical world. </span><span class="koboSpan" id="kobo.1176.2">So, we created our shadow boxes and placed them strategically over these two shafts. </span><span class="koboSpan" id="kobo.1176.3">When you run this in the simulator, you’ll notice these rectangles appear to make the worm gear and two </span><span class="No-Break"><span class="koboSpan" id="kobo.1177.1">shafts turn.</span></span></p>
<p><span class="koboSpan" id="kobo.1178.1">Remember, these are just images that are sitting on the screen doing nothing, but because of a little trickery, they actually appear like </span><span class="No-Break"><span class="koboSpan" id="kobo.1179.1">they’re turning!</span></span></p>
<p><span class="koboSpan" id="kobo.1180.1">Now, let’s add the final group – </span><span class="No-Break"><span class="koboSpan" id="kobo.1181.1">the fan.</span></span></p>
<h2 id="_idParaDest-105"><a id="_idTextAnchor109"/><span class="koboSpan" id="kobo.1182.1">Adding the fan</span></h2>
<p><span class="koboSpan" id="kobo.1183.1">It</span><a id="_idIndexMarker419"/><span class="koboSpan" id="kobo.1184.1"> would be nice if all of these gears and belts would produce some sort of output, so in this project, that output will be to spin a fan. </span><span class="koboSpan" id="kobo.1184.2">Let’s now add the final grouping of code right under the </span><span class="No-Break"><span class="koboSpan" id="kobo.1185.1">existing group:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1186.1">
  //MARK: - FAN
                Group {
                    ///Fan
                    FanView().offset(x: 0, y: 250).frame(width: 140, height: 140)
                }</span></pre>
<p><span class="koboSpan" id="kobo.1187.1">All we have done is called the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1188.1">FanView</span></strong><span class="koboSpan" id="kobo.1189.1"> struct, offset it to the bottom of the scene, and set a width for it (since it’s round, we don’t need to set a height). </span></p>
<p><span class="koboSpan" id="kobo.1190.1">Nearly there, just one last task: adding a background. </span></p>
<h2 id="_idParaDest-106"><a id="_idTextAnchor110"/><span class="koboSpan" id="kobo.1191.1">Adding the background</span></h2>
<p><span class="koboSpan" id="kobo.1192.1">I have a nice </span><a id="_idIndexMarker420"/><span class="koboSpan" id="kobo.1193.1">gold background that’ll look great with all the objects against it, so let’s come out of the main </span><strong class="source-inline"><span class="koboSpan" id="kobo.1194.1">ZStack</span></strong><span class="koboSpan" id="kobo.1195.1">, and after its closing brace, add the </span><span class="No-Break"><span class="koboSpan" id="kobo.1196.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1197.1">
 //MARK: - BACKGROUND
.background(Image("goldBackground").resizable().aspectRatio(contentMode: .fill)
            .frame(width: 400, height: 1000))</span></pre>
<p><span class="koboSpan" id="kobo.1198.1">This sets the gold background to a frame width and height of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1199.1">400</span></strong><span class="koboSpan" id="kobo.1200.1"> x </span><strong class="source-inline"><span class="koboSpan" id="kobo.1201.1">1000</span></strong><span class="koboSpan" id="kobo.1202.1">, sitting nicely on an iPhone. </span></p>
<p><span class="koboSpan" id="kobo.1203.1">Finally, run that in the simulator and see what </span><span class="No-Break"><span class="koboSpan" id="kobo.1204.1">you think:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer105">
<span class="koboSpan" id="kobo.1205.1"><img alt="Figure 7.19: The completed project " src="image/B18674_07_19.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1206.1">Figure 7.19: The completed project</span></p>
<p><span class="koboSpan" id="kobo.1207.1">Feel </span><a id="_idIndexMarker421"/><span class="koboSpan" id="kobo.1208.1">free to play around with all the parameters and settings, changing the colors of the belts or objects, changing the angles of rotation, and so on. </span><span class="koboSpan" id="kobo.1208.2">This will allow you to really understand what these parameters and functions all do, and how they synergistically </span><span class="No-Break"><span class="koboSpan" id="kobo.1209.1">work together!</span></span></p>
<p><span class="koboSpan" id="kobo.1210.1">Also, notice that we continued to use Pragma Marks throughout the project. </span><span class="koboSpan" id="kobo.1210.2">Let’s see how handy they are; so, come back up to the menu bar and click on the last tab (this tab doesn’t have a name, but you can </span><em class="italic"><span class="koboSpan" id="kobo.1211.1">always</span></em><span class="koboSpan" id="kobo.1212.1"> find the Pragma Marks in the last tab of the </span><span class="No-Break"><span class="koboSpan" id="kobo.1213.1">menu bar):</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer106">
<span class="koboSpan" id="kobo.1214.1"><img alt="Figure 7.20: Viewing the Pragma Marks of the project " src="image/B18674_07_20.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1215.1">Figure 7.20: Viewing the Pragma Marks of the project</span></p>
<p><span class="koboSpan" id="kobo.1216.1">Every</span><a id="_idIndexMarker422"/><span class="koboSpan" id="kobo.1217.1"> Pragma Mark indicates a different area of code based on the title we gave it, which makes it very easy to jump to in an instant, regardless of how big the </span><span class="No-Break"><span class="koboSpan" id="kobo.1218.1">file is.</span></span></p>
<h1 id="_idParaDest-107"><a id="_idTextAnchor111"/><span class="koboSpan" id="kobo.1219.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.1220.1">In summary, through creating this project, we’ve accomplished quite a bit. </span><span class="koboSpan" id="kobo.1220.2">As before, you saw how to create separate files – in this case, gears and chains – how to make a marching ants effect, how to combine everything into </span><strong class="source-inline"><span class="koboSpan" id="kobo.1221.1">ContentView</span></strong><span class="koboSpan" id="kobo.1222.1">, and how to organize the code neatly using Pragma Marks and Groups. </span><span class="koboSpan" id="kobo.1222.2">You also learned how to animate objects on all three axes, </span><em class="italic"><span class="koboSpan" id="kobo.1223.1">x</span></em><span class="koboSpan" id="kobo.1224.1">-, </span><em class="italic"><span class="koboSpan" id="kobo.1225.1">y</span></em><span class="koboSpan" id="kobo.1226.1">-, and </span><em class="italic"><span class="koboSpan" id="kobo.1227.1">z</span></em><span class="koboSpan" id="kobo.1228.1">-, and saw how to use </span><strong class="source-inline"><span class="koboSpan" id="kobo.1229.1">zIndex</span></strong><span class="koboSpan" id="kobo.1230.1"> to place views more dynamically, from back to front, and </span><span class="No-Break"><span class="koboSpan" id="kobo.1231.1">vice versa.</span></span></p>
<p><span class="koboSpan" id="kobo.1232.1">In the next project, we will look at animating a flower and its petals so that it appears to be breathing, and creating some snow in </span><span class="No-Break"><span class="koboSpan" id="kobo.1233.1">the background.</span></span></p>
</div>
<div>
<div class="IMG---Figure" id="_idContainer108">
</div>
</div>
</body></html>