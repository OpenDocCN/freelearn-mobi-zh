# 前言

本书介绍了 Android 开源项目的安全增强（SE）功能，并指导您使用 SE for Android 的过程来保护新的嵌入式系统。据我们所知，本书是第一个全面记录这一过程的第一手资料，以便学生、DIY 爱好者以及工程师可以创建由 SE for Android 保护的自定义系统。通常情况下，只有原始设备制造商（OEMs）会这样做，而且相当常见的是目标设备是手机或平板电脑。我们真心希望我们的书能改变这一点，吸引广泛的受众参与开发，使他们能够使用和理解这些现代安全工具。

我们非常努力确保这本书不仅仅是一本循序渐进的技术书籍。具体来说，我们选择了一个指导您通过失败走向成功的模式。您将首先获得关于如何获得和执行安全性的适当理论理解。然后我们将介绍一个从未以这种方式（甚至在我们撰写本书之前，我们也没有这样做）得到保护的系统。接下来，我们将引导您通过所有我们的智能猜测，接受新发现的异常情况，并最终执行我们的自定义安全策略。这需要您学会解决 SELinux、SE for Android 和 Google Android 等主要开源项目之间的差异，每个项目都有独立的目标和部署计划。这为您准备了解决其他设备的安全问题，这个过程总是不同的，但希望现在会更容易接近。

# 本书涵盖的内容

第一章, *Linux 访问控制*，讨论了基于任意访问控制（DAC）的基本知识，一些 Android 漏洞如何利用 DAC 问题，并证明了需要更健壮的解决方案。

第二章, *强制访问控制和 SELinux*，检查强制访问控制（MAC）及其在 SELinux 中的表现。本章还探讨了可操作的政策来控制 SELinux 对象交互。

第三章, *Android 很奇怪*，介绍了 Android 安全模型，并调查了 binder、zygote 和属性服务。

第四章, *在 UDOO 上安装*，介绍了从源代码构建和部署 Android 到 UDOO 嵌入式板的过程，并开启了 SELinux 支持。

第五章, *系统启动*，从策略加载的角度跟踪启动过程，并纠正问题以使 SELinux 在 UDOO 上达到可用的状态。

第六章, *探索 SELinuxFS*，检查 SELinuxFS 文件系统以及它如何为高级惯用语提供内核到用户空间的接口。

第七章，*利用审计日志*，调查了审计子系统，揭示了如何解释 SELinux 审计日志以利于策略编写。

第八章，*将上下文应用于文件*，教您如何文件系统和文件系统对象获得它们的标签和上下文，演示了包括动态类型转换在内的更改它们的技术。

第九章，*将服务添加到域*，强调进程标记，特别是由 init 运行和管理的 Android 服务。

第十章，*将应用程序放入域*，展示了如何通过配置文件和 SELinux 策略正确标记应用程序的私有数据目录以及应用程序的运行时上下文。

第十一章，*标签属性*，展示了如何创建和标记新的和现有的属性，以及在此过程中可能出现的某些异常。

第十二章，*掌握工具链*，涵盖了控制设备策略的各种组件是如何实际构建和创建的。本章回顾了 Android.mk 组件，详细说明了构建和配置管理的核心是如何工作的。

第十三章，*进入执行模式*，利用您在前几章中学到的所有技能来响应 CTS 的审计日志，并将 UDOO 置于执行模式。

附录，*开发环境*，指导您完成设置适合您跟随本书所有活动的 Linux 环境的必要步骤。

# 您需要这本书的内容

硬件要求包括：

+   UDOO 嵌入式开发板

+   8GB Mini SD 卡（虽然您可以使用容量更大的卡，但我们不推荐这样做）

+   至少 16GB 的 RAM

+   至少 80GB 的空闲硬盘空间

软件要求包括：

+   Ubuntu 12.04 LTS 桌面系统

+   Oracle JDK 6.0 版本 6u45

+   需要一些额外的 Linux 软件，但这些在书中有所描述，并且是免费的。

# 本书面向的对象

本书旨在为对 Linux 实现的操作系统概念有一定了解的开发人员和工程师编写。他们可能是想要保护他们基于 Android 的创作的爱好者，OEM 工程师构建手机，或者在 Android 看到增长的领域中的工程师。C 编程的基本背景将有所帮助。

# 惯例

在本书中，您将找到许多文本样式，用于区分不同类型的信息。以下是一些这些样式的示例及其含义的解释。

文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称如下所示：“现在让我们尝试执行`hello.txt`文件，看看会发生什么。”

代码块设置如下：

```kt
case INTERFACE_TRANSACTION:
{
reply.writeString(DESCRIPTOR);
return true;
}
```

任何命令行输入或输出都如下所示：

```kt
$ su testuser
Password: 
testuser@ubuntu:/home/bookuser$ 

```

**新术语**和**重要词汇**以粗体显示。屏幕上看到的单词，例如在菜单或对话框中，在文本中显示如下：“通过选择**退出**退出配置菜单，直到被要求保存你的新配置。”

### 注意

警告或重要提示以如下框中的形式出现。

### 小贴士

小技巧和技巧以如下形式出现。

# 读者反馈

我们始终欢迎读者的反馈。告诉我们你对这本书的看法——你喜欢什么或不喜欢什么。读者反馈对我们很重要，因为它帮助我们开发出你真正能从中获得最大收益的标题。

要向我们发送一般反馈，请简单地发送电子邮件至 `<feedback@packtpub.com>`，并在邮件主题中提及书籍标题。

如果你在某个领域有专业知识，并且对撰写或为书籍做出贡献感兴趣，请参阅我们的作者指南，网址为 [www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在你已经是 Packt 图书的骄傲拥有者，我们有一些事情可以帮助你从购买中获得最大收益。

## 下载示例代码

你可以从你购买的所有 Packt 出版物的账户中下载示例代码文件。[`www.packtpub.com`](http://www.packtpub.com)。如果你在其他地方购买了这本书，你可以访问 [`www.packtpub.com/support`](http://www.packtpub.com/support)，并注册以将文件直接发送给你。

## 勘误

尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果你在我们的某本书中发现了错误——可能是文本或代码中的错误——如果你能向我们报告这个错误，我们将不胜感激。通过这样做，你可以帮助其他读者避免挫败感，并帮助我们改进后续版本的书。如果你发现任何勘误，请通过访问 [`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择你的书籍，点击**勘误****提交****表**链接，并输入你的勘误详情。一旦你的勘误得到验证，你的提交将被接受，勘误将被上传到我们的网站或添加到该标题的勘误部分下的现有勘误列表中。

要查看之前提交的勘误表，请访问 [`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)，并在搜索字段中输入书籍名称。所需信息将在**勘误**部分显示。

## 侵权

在互联网上对版权材料的盗版是一个跨所有媒体的持续问题。在 Packt，我们非常重视我们版权和许可证的保护。如果您在互联网上发现任何形式的我们作品的非法副本，请立即提供位置地址或网站名称，以便我们可以寻求补救措施。

请通过 `<copyright@packtpub.com>` 与我们联系，并提供疑似盗版材料的链接。

我们感谢您在保护我们作者和我们提供有价值内容的能力方面的帮助。

## 问题

如果您对本书的任何方面有问题，您可以联系 `<questions@packtpub.com>`，我们将尽力解决问题。
