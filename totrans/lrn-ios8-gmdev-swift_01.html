<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Getting Started</h1></div></div></div><p>So you want to create games for iOS? With the introduction of <strong>SpriteKit</strong><a id="id0" class="indexterm"/> in<a id="id1" class="indexterm"/> <strong>Xcode 5</strong>, it has become a breeze to create two-dimensional games for iOS. Previously, even before thinking about creating games, you had to think about what framework to use to create games. There were so many frameworks available, and each had its own pros and cons. Also, what if you wanted to create your own framework? In that case, you had to write it from the ground up using <a id="id2" class="indexterm"/>
<strong>OpenGLES</strong>, which required writing a whole lot of code just to display a triangle. And let's not even talk about creating three-dimensional games using the frameworks, as most of the frameworks don't even support it.</p><p>Apple solved all of these questions and issues by giving all the required tools with Xcode 6. In Xcode 6, you are really limited by your imagination. You can create 2D or 3D games using <strong>SpriteKit</strong><a id="id3" class="indexterm"/> and <strong>SceneKit</strong><a id="id4" class="indexterm"/>. If you want to create your own 2D or 3D engine, there is Metal available, which makes it easy to communicate with the <a id="id5" class="indexterm"/>
<strong>GPU</strong> (short for <strong>Graphics Processing Unit</strong>). But if you are a veteran and have used OpenGL ES to create games, don't worry! That option is still there, so you are not tied down to using only Metal. So, let's get started with iOS 8 game development with Xcode 6.</p><p>The following topics will be covered in this chapter:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Downloading and installing Xcode</li><li class="listitem" style="list-style-type: disc">Creating an iOS developer account</li><li class="listitem" style="list-style-type: disc">Introducing Swift</li><li class="listitem" style="list-style-type: disc">Introducing Playground</li><li class="listitem" style="list-style-type: disc">Introducing SpriteKit</li><li class="listitem" style="list-style-type: disc">Looking at the default SpriteKit project</li><li class="listitem" style="list-style-type: disc">New features in SpriteKit</li><li class="listitem" style="list-style-type: disc">Looking at the default SceneKit project</li><li class="listitem" style="list-style-type: disc">Understanding 3D objects</li><li class="listitem" style="list-style-type: disc">The 2D/3D coordinate system</li><li class="listitem" style="list-style-type: disc">Exploring SceneKit</li><li class="listitem" style="list-style-type: disc">Introducing Metal</li><li class="listitem" style="list-style-type: disc">The graphics pipeline</li></ul></div><div><div><div><div><h1 class="title"><a id="ch01lvl1sec08"/>Downloading and installing Xcode</h1></div></div></div><p>If you have an Apple <a id="id6" class="indexterm"/>account, you can open the desktop version of the App Store and<a id="id7" class="indexterm"/> search for Xcode. Click on <strong>Install</strong> so that you can start <a id="id8" class="indexterm"/>downloading it. For this book, I will be using Xcode 6.1. By the time this book gets published, there might be a newer version of Xcode 6. If you wish to download the same version that I used to work with, you can create a free Apple Developer Account, go to the <strong>Downloads</strong> section, and download the previous version.</p><div><img src="img/B04014_01_01.jpg" alt="Downloading and installing Xcode"/></div><div><div><h3 class="title"><a id="tip02"/>Tip</h3><p>Before downloading Xcode, make sure you are working on either Mac OS X Yosemite 10.10 or Maverick 9.4. Otherwise, Xcode 6.1 can't be installed on your machine.</p></div></div><p>Xcode is Apple's <a id="id9" class="indexterm"/>
<strong>Integrated Development Environment</strong> (<strong>IDE</strong>). It is required for developing any sort of app for iOS or Mac OS X. It is not just an IDE; it is packed with a lot of tools and features, which makes it an integral part of any developer's arsenal. You can click on the <strong>...More</strong> button on Xcode's <strong>App Store</strong> page to see the different tools and features it has to offer. We will also look at some features of Xcode in the next chapter, when we cover the Xcode interface.</p><p>To install Xcode, click on the <strong>Install</strong> button under the icon. You will then<a id="id10" class="indexterm"/> be asked to enter your Apple ID and password. The installation <a id="id11" class="indexterm"/>will start soon after. Once you click on the <strong>Install</strong> button, the download will start in the launch pad, as shown in the following screenshot:</p><div><img src="img/B04014_01_02.jpg" alt="Downloading and installing Xcode"/></div><p>Once it is downloaded and installed, you can see it appear in your launch pad. You can click on the application's icon to launch the application.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Creating an iOS developer account</h1></div></div></div><p>To create any app and <a id="id12" class="indexterm"/>publish it on the App Store for iOS, Mac OS X, or Safari, you need to be enrolled in a developer program. You can create a free developer account to access certain sections such as tutorials and downloads, but you won't be given access to the latest beta software. Also, to run and test the app or game on your device, you need to be enrolled for this developer program.</p><p>Since we do plan to create a small game for iOS and publish it on the App Store, we do need to enroll for the iOS Developer Program. I will assume that we don't have a developer account yet, so let's create a <a id="id13" class="indexterm"/>new developer account first, and then we will enroll for the iOS program.</p><p>To register as an Apple developer<a id="id14" class="indexterm"/>, go to <a class="ulink" href="https://developer.apple.com/register/index.action">https://developer.apple.com/register/index.action</a>. The following page will be displayed:</p><div><img src="img/B04014_01_03.jpg" alt="Creating an iOS developer account"/></div><p>If you already have an Apple ID, you can use it to log in. Otherwise, click on <strong>Create Apple ID</strong>. Here, you will be asked to fill in the information under the following headings:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Name</strong>: Enter the following details here:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">First name</li><li class="listitem" style="list-style-type: disc">Middle name</li><li class="listitem" style="list-style-type: disc">Last name</li></ul></div></li><li class="listitem" style="list-style-type: disc"><strong>Apple ID and Password</strong>: Enter a preferred Apple ID and password here. Keep the following pointers in mind:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Apple ID</strong>: Any e-mail address of your choice.</li><li class="listitem" style="list-style-type: disc"><strong>Password</strong>: The password should have at least eight characters; it should have at least one lowercase character, one capital letter, and one number; and it should not contain identical characters consecutively. Also, it shouldn't be the same as the account name.</li><li class="listitem" style="list-style-type: disc"><strong>Confirm Password</strong>: Type the same password that you typed in the <strong>Password</strong> field.</li></ul></div></li><li class="listitem" style="list-style-type: disc"><strong>Security Questions</strong>: If you<a id="id15" class="indexterm"/> forget your password, you will be asked to answer some questions to gain access to your account. You can choose them here. So, be careful when choosing these questions, and also make note of the questions and answers for future reference. There are three questions, and each question has multiple choices. So, choose a question that is most relevant to you and select answers that you can remember easily.<p>All the headings mentioned until now can be seen in this screenshot:</p><div><img src="img/B04014_01_04.jpg" alt="Creating an iOS developer account"/></div></li><li class="listitem" style="list-style-type: disc"><strong>Date of Birth</strong>: Enter<a id="id16" class="indexterm"/> your date of birth.</li><li class="listitem" style="list-style-type: disc"><strong>Rescue Email Address</strong>: This is an alternate e-mail address through which you can be communicated with.<p>The preceding two headings can be seen in the following screenshot:</p><div><img src="img/B04014_01_05.jpg" alt="Creating an iOS developer account"/></div></li><li class="listitem" style="list-style-type: disc"><strong>Mailing Address</strong>: Enter<a id="id17" class="indexterm"/> your mailing address.</li><li class="listitem" style="list-style-type: disc"><strong>Preferred Language</strong>: Choose the language in which you are most comfortable. If you ask any questions to the Apple support team, they will respond to you in this language.</li><li class="listitem" style="list-style-type: disc"><strong>Email Preference</strong>: If you like to be up to date with the latest Apple news, software updates, and information on products and services, you can check the two check boxes below this heading.</li><li class="listitem" style="list-style-type: disc"><strong>CAPTCHA</strong>: Type the CAPTCHA<a id="id18" class="indexterm"/> image in the box shown in this screenshot:<div><img src="img/B04014_01_06.jpg" alt="Creating an iOS developer account"/></div></li></ul></div><p>Now click on <strong>Create Apple ID</strong> to generate the Apple ID. If you've done everything successfully, congratulations!!!!! You are now an Apple developer.</p><p>Once you are in, you <a id="id19" class="indexterm"/>will be greeted with the following screen:</p><div><img src="img/B04014_01_07.jpg" alt="Creating an iOS developer account"/></div><p>You will be spending<a id="id20" class="indexterm"/> most of the time in the <strong>Technical Resources and Tools</strong> section, though you have a strong developer community and developer support, which can be accessed at any time under the <strong>Community and Support</strong> section.</p><p>Under the <strong>Technical Resources and Tools</strong> section, you have two subsections: <strong>Dev Centers</strong> and <strong>Certificates, Identifiers &amp; Profiles</strong>. In the <strong>Dev Centers</strong> subsection, you will find all the technical resources for the appropriate development platform. Through the <strong>Certificates, Identifiers and Profiles</strong> link, you can generate and manage your certificates, create provisioning profiles, and manage App IDs and development devices. We will go through this section when we create an app and wish to run it on our device.</p><p>Let's look at the <strong>Dev Centers</strong> section. If you click on <strong>Mac</strong>, you will see the links to the resources that develop apps for Yosemite, such as the link to the latest build of OS X. You can also get articles, sample code, guides, and so on that you can use to develop the app you always wanted to make for Yosemite. You also get a link to the development video that was shown in WWDC.</p><p>If you click on <strong>Safari</strong>, you will see a layout similar to what you saw earlier, with links to sample code, and the developer library that you can use to develop apps for Safari.</p><p>Now click on <strong>iOS</strong> in <strong>Dev Centers</strong>. You should be greeted with the following screen:</p><div><img src="img/B04014_01_08.jpg" alt="Creating an iOS developer account"/></div><p>Here, you will <a id="id21" class="indexterm"/>find all the resources that are required to develop all kinds of apps for iOS. You can download the latest version of iOS SDK, or if you wish to download an older version of Xcode, you can do that from the <strong>Downloads</strong> link.</p><p>Similar to Mac Developer Library, you have an iOS Developer Library with links to how to get started, guides, sample code, references, and release notes. There are also links to videos on iOS development under the <strong>Development Videos</strong> section.</p><p>You can download Xcode, install it on your machine, and test your coding skills, but if you want to test your awesome app on a device and later publish it on the App Store, you need to register to the iOS Developer Program.</p><p>As I said earlier, you are required to be part of the program to be able to test the app on the device or publish it on the App Store. In the meantime, you can run the SpriteKit and SceneKit apps you make on the simulator. So, if you wish, you can enroll once you are satisfied with how the game looks on the simulator.</p><p>That being said, a simulator is just that—a simulator. How the game works on the simulator shouldn't be taken to mean how the game will actually work on the device. The game will run slower on the simulator because the Mac processor performs two tasks: running your OS and also the simulator.</p><p>So, it is better to test the app on the device to get a better understanding of how it is going to finally run on the device, and the more devices you run it on, the better.</p><div><div><h3 class="title"><a id="note02"/>Note</h3><p>Additionally, it should be noted that at the time of writing this book, apps/games developed using Metal cannot be run on the simulator, and they require an A7 or A8 chip to run on the device. If you try running them on the simulator, it will give an error.</p></div></div><p>So, if you are<a id="id22" class="indexterm"/> ready to enroll in the iOS Developer Program, click on the <strong>Learn More</strong> link under the <strong>Join the iOS Developer Program</strong> heading on the right-hand side of the page you are currently at.</p><p>Let's get enrolled in the iOS Developer Program. Get your credit card and your attorney ready, and click on the <strong>Enroll Now</strong> button at the top to start the process. Next, click on the <strong>Continue</strong> button to go to the next screen. Click on <strong>Continue</strong> again, as you have already created an Apple ID. If you have still not created an Apple ID, click on <strong>Create Apple ID</strong> and follow the mentioned steps, then come back to this page, and continue with your new Apple ID. Once you click on <strong>Continue</strong>, you will be redirected to a page where you will have to choose whether you want to register as an individual or a company.</p><p>If you register as an individual, your name will be displayed as the seller on the App Store, and you won't be asked for any documentation for registration. If you register as a company, non-profit organization, joint venture, partnership, or government organization, you should select the option to register as an organization. To enroll as an organization, you will need additional documents such as the Tax ID, D-U-N-S number (which is available for free), and so on.</p><p>In the case of the organization, the name of the organization will be displayed as the seller on the App Store. You can also include additional developers as part of the team, unlike individual registration, in which only one individual can be added per account, that is, the person who is enrolling. The following screenshot shows the screen where you can select whether you are registering as an individual or a company/organization:</p><div><img src="img/B04014_01_09.jpg" alt="Creating an iOS developer account"/></div><p>For this book, we <a id="id23" class="indexterm"/>will be enrolling as an individual, so click on <strong>Individual</strong> in the bottom-left corner of the screen to proceed to the next screen.</p><p>On the next page, you will have to choose the program that you want to enroll for. Since we are going to enroll for the iOS Developer Program, we check the box to the left of <strong>iOS Developer Program</strong> and click on <strong>Continue</strong>, as shown in the following screenshot:</p><div><img src="img/B04014_01_10.jpg" alt="Creating an iOS developer account"/></div><p>On the next page, you <a id="id24" class="indexterm"/>are required to agree to the Program License Agreement. Get your attorney over and ask them to read it. After their confirmation, click on the checkbox to agree to having read the agreement, and to being above the legal age. Click on <strong>I Agree</strong> at the bottom of the page to agree and move on to the next page.</p><p>Here, you have to enter your payment information. Provide your credit card and billing information and click on <strong>Continue</strong>. Now verify the information once again and click on <strong>Place Order</strong>.</p><p>Once you are done with this, you are a registered iOS developer. You will get a <strong>Thank You</strong> screen and also an e-mail confirmation. It will take up to 2 business days for the order to be processed, so in the meantime, we will take a sneak peek at Swift, SpriteKit, SceneKit, and Metal.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Introducing Swift</h1></div></div></div><p>With Xcode 6, Apple has introduced a new scripting language called<a id="id25" class="indexterm"/> Swift. If you are coming from a JavaScript or ActionScript background, you will find yourself very much at home. But even if you have been using Objective-C for a long time, don't worry. You can still create games using Objective-C. Before creating any project, you will be asked in which language you want to create the app/game. Just select <strong>Swift</strong> and you are good to go.</p><p>In <a class="link" href="ch02.html" title="Chapter 2. Swift Basics">Chapter 2</a>, <em>Swift Basics</em>, you will learn how to code in Swift, and we will see how it is different from Objective-C. When coding in Swift, we will start from the absolute beginning, with variables, <a id="id26" class="indexterm"/>control statements, loops, and advanced topics such as classes.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Introducing Playground</h1></div></div></div><p>Playground <a id="id27" class="indexterm"/>is a file that you can use to test your Swift code and see immediate results of your code. Let's actually create a new file and take a look at it.</p><p>If you have downloaded Xcode from the developer portal instead of the Mac Store, double-click on the DMG file to open it. Once it is open, you can drag the Xcode app into your <code class="literal">Applications</code> folder to install it.</p><p>Once it is installed, drag the app into the dock, as we will be using it quite often. Once you have dragged it into the dock, click on it to open it. You will have to agree to the terms and conditions once it opens, so agree to them to proceed.</p><p>You should see the welcome screen on Xcode. Here, you can click on any one of <strong>Get started with a playground</strong>, <strong>Create a new Xcode project</strong>, or <strong>Check out an existing project</strong>. The details of these three options are as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Get Started with a playground</strong>: With a playground, you can test your Swift coding skills and hone them before using the playground to develop an app or game</li><li class="listitem" style="list-style-type: disc"><strong>Create a new Xcode project</strong>: Whenever you want to create a new Xcode project, you will have to click on this button, and then you can also select the type of project you want to create</li><li class="listitem" style="list-style-type: disc"><strong>Check out an existing project</strong>: If you are using a <strong>source code manager</strong> (<strong>SCM</strong>)<a id="id28" class="indexterm"/> to manage code, such as GitHub, SVN, or BitBucker, you can check out the project you have there, using this</li></ul></div><p>These options can be seen in this screenshot:</p><div><img src="img/B04014_01_11.jpg" alt="Introducing Playground"/></div><p>For now, click on the <a id="id29" class="indexterm"/>
<strong>Get Started with a playground</strong> button. Give a filename (I gave it the name <code class="literal">playgroundTest</code>), select the <strong>iOS</strong> platform, and click on <strong>Next</strong>, as shown in the following screenshot:</p><div><img src="img/B04014_01_12.jpg" alt="Introducing Playground"/></div><p>On the next screen, you will<a id="id30" class="indexterm"/> be asked where you want to create the project folder. To be organized, I keep all my projects in the <code class="literal">_Projects</code> folder in the <code class="literal">Documents</code> folder, under the specific game technology's folder name starting with an underscore (<code class="literal">_</code>). So in this case, I created a new <code class="literal">_Projects</code> folder in the <code class="literal">Documents</code> folder. Then I created a new folder called <code class="literal">_Playground</code>, selected it, and clicked on <strong>Create</strong>.</p><p>You will see that the <code class="literal">playgroundTest</code> file is created in the <code class="literal">_Projects/_Playground</code> folder in the <code class="literal">Documents</code> folder. Once the file is created, you will see the following window:</p><div><img src="img/B04014_01_13.jpg" alt="Introducing Playground"/></div><p>You will be coding in the <a id="id31" class="indexterm"/>left pane, and you will be able to see the immediate result in the right-hand-side pane. You can see that there is already some code written on the left and the result is shown on the right. Here, the <code class="literal">Hello, playground</code> string is assigned to a new variable called <code class="literal">str</code>, and the <code class="literal">str</code> variable's value is immediately logged on the screen to the right.</p><p>We will cover more information about playgrounds when you learn Swift in <a class="link" href="ch03.html" title="Chapter 3. An Introduction to Xcode">Chapter 3</a>, <em>An Introduction to Xcode</em>, as all the coding practices that we will be doing will require the playground file.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Exploring SpriteKit</h1></div></div></div><p>SpriteKit<a id="id32" class="indexterm"/> is a 2D game development framework that was first introduced in iOS 7 and Xcode 5. It is primarily used to create 2D games, so objects can be placed or moved only in the <em>x</em> and <em>y</em> coordinates. Using SpriteKit, you can create 2D games for both iOS and OS X.</p><p>If you have used Cocos2d, you will feel very much at home with the architecture and syntax of SpriteKit. Since the game will be mostly populated with sprites, it is called SpriteKit.</p><p>Since SpriteKit is a 2D game development framework, it provides all the tools that you require to create a complete 2D game from start to finish. You can create a MainMenu Screen, Gameplay Screen, and Options Screen. You can also create buttons on each of these screens. When the buttons are pressed, you can navigate between the screens. In the gameplay screen, you can add players, enemies, text to display the score, and particles such as smoke and explosion with the particle editor.</p><p>SpriteKit also includes a physics engine that performs all the physics-related calculations. All you have to do is include it in the scene, and you will see the objects in the scene interacting with each other automatically, according to the physics simulation. In addition, SpriteKit also includes an automatic texture atlas generator for better optimization of your game assets.</p><p>There are some classes in <a id="id33" class="indexterm"/>SpriteKit that are the basic building blocks for creating any game.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec07"/>New features in SpriteKit</h2></div></div></div><p>There are a lot of new <a id="id34" class="indexterm"/>cool features added in SpriteKit in Xcode 6:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Graphics technologies:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Shaders</li><li class="listitem" style="list-style-type: disc">Lighting and shadows</li></ul></div></li><li class="listitem" style="list-style-type: disc">Physics simulations technologies:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Per-pixel physics</li><li class="listitem" style="list-style-type: disc">Physics fields</li><li class="listitem" style="list-style-type: disc">Inverse kinematics</li><li class="listitem" style="list-style-type: disc">Constraints</li></ul></div></li><li class="listitem" style="list-style-type: disc">Tools and improvements:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">SpriteKit Editor</li><li class="listitem" style="list-style-type: disc">Integration with SceneKit</li></ul></div></li></ul></div><p>SpriteKit now includes shaders that you can use to create new and interesting effects in your game. You can also create light sources to cast real-time 2D shadows.</p><p>The already powerful physics engine of SpriteKit has been made even more powerful with the inclusion of per-pixel physics for pixel-perfect collision detection. With the addition of physics fields, we can create an <em>Angry Birds Space</em> clone in no time, and with inverse kinematics, it is easier to make joint movements of your 2D characters look more realistic. Along with all of this, you can also use constraints to control the movement or rotation of any physics object in the scene along any direction or angle.</p><p>SpriteKit also includes <a id="id35" class="indexterm"/>a new editor that can be used to create a simple game without writing a single line of code. It can also be used to check for errors as a debugging tool.</p><p>SpriteKit can also be used with SceneKit. SceneKit is a 3D game development framework newly developed by Apple. If you want to create GUI elements in your 3D game, such as 2D buttons and radars, this can be achieved very easily using SpriteKit.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec08"/>Looking at the default SpriteKit project</h2></div></div></div><p>Let's look at the <a id="id36" class="indexterm"/>default SpriteKit project that gets created when we<a id="id37" class="indexterm"/> create a new project so that you can understand some of the terms that you will be using while creating the game.</p><p>For now, we will create a new project. So, click on the <strong>Create a New Xcode Project</strong> button in the middle. Once you have clicked, you will see the following window:</p><div><img src="img/B04014_01_14.jpg" alt="Looking at the default SpriteKit project"/></div><p>In the left panel, you need to select the platform you wish to create the game for, iOS or OS X. Since we are going to be creating games for iOS in this book, we will select from the iOS section.</p><p>In <strong>Applications</strong>, you<a id="id38" class="indexterm"/> can select the type of application that you want <a id="id39" class="indexterm"/>to create: <strong>Master-Detail Application</strong>, <strong>Page-Based Application</strong>, <strong>Single View Application</strong>, <strong>Tabbed Application</strong>, or <strong>Game</strong>. Since SpriteKit, SceneKit, Metal, and OpenGL ES are part of a game application, we will select <strong>Game</strong>. Then click on <strong>Next</strong>.</p><p>In the <strong>Choose options for your new project</strong> window, you will have to fill the <strong>Product Name</strong>, <strong>Organization Name</strong>, <strong>Organization Identifier</strong>, <strong>Language</strong>, <strong>Game Technology</strong>, and <strong>Devices</strong> fields:</p><div><img src="img/B04014_01_15.jpg" alt="Looking at the default SpriteKit project"/></div><p>The details of the fields shown in the preceding screenshot are as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Product Name</strong>: When you create an actual project, the entry for this field is the name of the game that you are creating, such as <code class="literal">AngryBirds</code>, <code class="literal">CutTheRope</code>, and so on.</li><li class="listitem" style="list-style-type: disc"><strong>Organization Name</strong>: Here, you can input the organization name for which you are developing your game. For the purpose of this book, you can input any name you want.</li><li class="listitem" style="list-style-type: disc"><strong>Organization Identifier</strong>: This is very important, and I can't stress enough on how important it<a id="id40" class="indexterm"/> is. On the App Store, Apple will <a id="id41" class="indexterm"/>identify your app by only this. Whatever input is given here translates into the value for <strong>Bundle Identifier</strong>. This has to be unique, and no other app on the App Store can have the same package name. Although you can call it whatever you wish, the standard format used is the reverse format of the company website followed by the product name, like this: <code class="literal">com.&lt;company name&gt;.&lt;product name&gt;</code>.<p>If you don't have a company or a website, don't fret. You just have to make sure your package name is unique. If it is not, Apple will not accept the app. In such a case, you can try different package names, and later you have the option to change the package name in Xcode to whatever Apple approved as the package name.</p></li><li class="listitem" style="list-style-type: disc"><strong>Language</strong>: From this drop-down list, you can select the language of choice in which you want to develop the game. You can choose between <strong>Objective-C</strong> and <strong>Swift</strong>. Since we will be developing the games in Swift in this book, we will use the <strong>Swift</strong> option here.</li><li class="listitem" style="list-style-type: disc"><strong>Game Technology</strong>: From this drop-down list, you can select the technology that you want to use to develop the game with. You have the option of choosing SceneKit, SpriteKit, Metal, and OpenGL ES. As we are going to use SpriteKit, select it from the dropdown.</li><li class="listitem" style="list-style-type: disc"><strong>Devices</strong>: From this drop-down list, you can select the device that you want to develop the game for. You can choose either <strong>iPhone</strong> or <strong>iPad</strong> if you want to develop for the iPhone or the iPad, or you can choose <strong>Universal</strong> if you want the game to run on both the platforms. You can choose <strong>iPad</strong> for now.</li></ul></div><p>Click on <strong>Next</strong> to proceed. In the screen that follows, you will be asked where to create the project folder. For this, create a new folder called <code class="literal">_SpriteKit</code> in the <code class="literal">_Projects</code> folder. Then select this folder and click on <strong>Create</strong>.</p><p>You will see that the <code class="literal">spriteKitTest</code> project folder is created in the <code class="literal">_Projects/_SpriteKit</code> folder in the <code class="literal">Documents</code> folder, as shown in the following screenshot:</p><div><img src="img/B04014_01_16.jpg" alt="Looking at the default SpriteKit project"/></div><p>Now double-click <a id="id42" class="indexterm"/>on the <code class="literal">spriteKitTest.xcodeproj</code> file to<a id="id43" class="indexterm"/> open your project in Xcode. Your project should open up, as shown in this screenshot:</p><div><img src="img/B04014_01_17.jpg" alt="Looking at the default SpriteKit project"/></div><p>Xcode has a built-in <a id="id44" class="indexterm"/>simulator that can show you how the game or app <a id="id45" class="indexterm"/>will look in a specified device. You can select the device by clicking on the name of the project to the right of the stop button at the top of the window, as shown in the following screenshot:</p><div><img src="img/B04014_01_18.jpg" alt="Looking at the default SpriteKit project"/></div><p>Click on the play <a id="id46" class="indexterm"/>button in the top-left corner to build the current<a id="id47" class="indexterm"/> project. The game will start compiling all of the code and will automatically launch the simulator. Once the simulator starts, give it some time to display the following screen:</p><div><img src="img/B04014_01_19.jpg" alt="Looking at the default SpriteKit project"/></div><p>Well, it won't look exactly like the preceding screenshot. For one thing, you won't see the image of the plane above <code class="literal">Hello, World</code>. Secondly, it will be in portrait mode, instead of landscape as shown in the preceding screenshot.</p><p>To change the view to landscape mode, click on the project name in the left panel. The middle panel will change and display the options for landscape, portrait, and so on. Uncheck the portrait option and stop and build the game again. Now the view will change from portrait to landscape whenever you build the game.</p><p>Next, how do you<a id="id48" class="indexterm"/> get the plane onto the screen? It is very simple; all <a id="id49" class="indexterm"/>you have to do for it to appear is to click anywhere on the screen. I clicked on the center of the screen, between the top and the place where <code class="literal">Hello, World</code> is shown, which is why the plane showed up there. To create more planes, all you have to do is keep on clicking wherever you want a new plane to appear. You will see that when you add more planes, the numbers on the bottom right of the screen also change, and the planes start rotating slower and slower. Why is this happening? And what are these numbers? Before that, let's first cover a few terms, classes, and functions that we need to familiarize ourselves with:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">SKScene</code>: This is a <a id="id50" class="indexterm"/>class used to create scenes, for example, the MainMenuScreen, OptionsScreen, and GamePlayScreen. Each scene will contain sprites such as the player and buttons, which will populate the screens and help you to navigate to other screens. In the project on the left-hand-side panel, you will find a file called <code class="literal">GameScene.swift</code>. This is the scene that gets loaded as soon as the game is built.</li><li class="listitem" style="list-style-type: disc"><code class="literal">SKSpriteNode</code>: As we saw<a id="id51" class="indexterm"/> earlier, each scene will be loaded with sprites or images. To load a sprite onto the screen, you have to use <code class="literal">SKSpriteNode</code>. In this scene, whenever you touch the screen, you create a sprite in the specific location. It gets the image name of <code class="literal">Spaceship</code>. This can be seen in the <code class="literal">touchesBegan</code> function in the same class.</li><li class="listitem" style="list-style-type: disc"><code class="literal">SKLabelNode</code>: In order to <a id="id52" class="indexterm"/>display any sort of text on the screen, you need to use <code class="literal">SKLabelNode</code> to decide which font should be used to create the text. You also need to provide the text that needs to be displayed on the screen, along with the size and the position of the text to be displayed. Here, we see that <code class="literal">SKLabelNode</code> is used to display <code class="literal">Hello, World</code> on the screen. In <code class="literal">myLabeltext</code>, you can write whatever you want to display, in quotes, and build again to see whatever you typed get displayed on the screen.</li><li class="listitem" style="list-style-type: disc"><code class="literal">SKAction</code>: These are used to <a id="id53" class="indexterm"/>modify nodes' parameters over a period of time. For example, you can scale an object up to twice its size over a 1-second duration, and then bring it back to its normal size. Or you can change the position of an object to make it move or rotate over a period of time. You can perform these actions together or one after the other, using SKAction. Here, as soon as the spaceship is created, an action is run on it, telling it<a id="id54" class="indexterm"/> to rotate by 180 degrees every <a id="id55" class="indexterm"/>second.<div><img src="img/B04014_01_20.jpg" alt="Looking at the default SpriteKit project"/></div></li><li class="listitem" style="list-style-type: disc"><code class="literal">touchesBegan</code>: SpriteKit <a id="id56" class="indexterm"/>has inbuilt overridable functions that can be used to register touches on the screen. There are four functions called <code class="literal">touchesBegan</code>, <code class="literal">touchesMoved</code>, <code class="literal">touchesEnded</code>, and <code class="literal">touchesCancelled</code>. You can use these functions in combination with each other to detect finger touches and create your own control schemes such as tap, swipe, and double tap.</li><li class="listitem" style="list-style-type: disc"><code class="literal">update</code>: The <code class="literal">update</code> function is <a id="id57" class="indexterm"/>another overridable function that is provided by SpriteKit and gets called repeatedly throughout the game, depending on how often you set it to call itself. Usually, the <code class="literal">update</code> function gets called 60 times a second. We can use this function to update the position, check a collision, or update the score of the game. The <code class="literal">update</code> function starts getting called automatically once the scene gets initialized.</li></ul></div><p>So now, knowing all that, let's<a id="id58" class="indexterm"/> answer the question asked earlier; what are the two values in the bottom-right corner of the screen?</p><p>The Nodes <a id="id59" class="indexterm"/>represent the number of nodes you have added to the scene. These nodes can be sprites, labels, and so on. This is why each time you add a new spaceship on the screen, you will see the node count increase. The more objects you add to the screen, the more the processing power required.</p><p>The number next to the node count is the calculation of FPS or frames per second. In the <code class="literal">update</code> function, we saw that the function gets called 60 times a second. So, 60 times in a second, the screen is wiped and redrawn again to create a new frame, and the position and rotation of each object will also be updated. So, if you add more objects to the screen, the processor has to do that much work more by drawing all the images on the screen. This is why you see a dip in the FPS; that is, the spaceship starts rotating slower and slower when you add more spaceships to the scene. Also, in this case, it needs to be taken into consideration that the new spaceships are also asked to rotate, so the processor has to do additional work calculating by how much the spaceships need to be rotated every second.</p><p>That's all for the introduction to SpriteKit and <code class="literal">GameScene.swift</code>. There are additional files on the panel that we will cover in the next chapter when we take a deeper look into Xcode. Let's look at SceneKit next.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Exploring SceneKit</h1></div></div></div><p>SceneKit is a 3D game<a id="id60" class="indexterm"/> development framework. So, it can be used to create 3D games or apps for iOS and OS X. It was initially released in OS X 10.8, and now it is available on iOS 8. It is a high-level API built on OpenGL and OpenGL ES, and can be integrated with SpriteKit, as we saw earlier.</p><p>In SceneKit, as in any 3D game development framework, we need to provide the camera, lights, and objects for the scene so that the scene can be rendered from the viewpoint of the camera and be processed and displayed on the viewport of the device.</p><div><img src="img/B04014_01_21.jpg" alt="Exploring SceneKit"/></div><p>All objects need to be added to the nodes by creating one for every object you place, whether it is a camera, light, or an object.</p><p>You can either add a predefined object, such as boxes, spheres, tori, and planes and add texture to it; or import COLLADA files or Alembic files created in a 3D program, export it in <code class="literal">.dae</code> or <code class="literal">.abc</code> format, and import it into SceneKit. These can be opened in <strong>Preview</strong> so that you can take a look and check the file before importing it to the SceneKit project. Apart from the geometries; the animations, textures, lights/camera, and so on that you added to the imported scene will also be imported. You can also add 3D text and shapes to your game using SceneKit.</p><p>If you assign a texture to the object in the <code class="literal">COLLADA</code> file, the texture maps need to be imported along with the file. You can add textures to primitive shapes, 3D text, and complex shapes. You will also be able to modify the 3D text and shapes by extruding them to give them depth, or chamfering the corners, in code.</p><p>Custom objects and <a id="id61" class="indexterm"/>shapes can also be created by providing the position, texture, coordinates, and color for each of the vertices used to create the shape. You have full freedom over the polygon count; if you want smoother models, you can divide the polygons to get a smoother result—all through code.</p><p>SceneKit, along with a camera, also provides different light types such as <strong>Ambient</strong>, <strong>Omni</strong>, <strong>Direction</strong>, and <strong>Spot light</strong>. These can be attached to the nodes, making them easy to place and move around.</p><p>There is also an editor that can be used to view your scene and all the objects added to the scene. You will also be able to look at the properties of the individual objects and modify them if you wish, after importing them to the scene.</p><p>The game assets will be managed by the Asset Catalogue, which will optimize the assets at build time, similar to the texture atlas creator in SpriteKit.</p><p>Similar to SpriteKit, SceneKit has actions that can be performed on objects to animate them. It also has a physics engine for physics simulations and collision detection. Like the physics engine in SpriteKit, you can add joints, constraints, and inverse kinematics to your objects and scenes.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec09"/>Looking at the default SceneKit project</h2></div></div></div><p>Similar to how you <a id="id62" class="indexterm"/>created a SpriteKit project, create a SceneKit <a id="id63" class="indexterm"/>project. The only difference when creating the project is that while selecting <strong>Game Technology</strong> in the drop-down list, select <strong>SceneKit</strong> instead of <strong>SpriteKit</strong>. Name the project <code class="literal">SceneKitTest</code>.</p><p>Once the project is created, double-click on the <code class="literal">SceneKitTest.xcodeproj</code> file. Once it opens, you should see a project structure similar to what you saw in the case of SpriteKit.</p><p>As we did earlier, you can click on the play button on the top of the window and select the simulator of your choice. Once the simulator loads, you should see a window similar to what is shown in the following screenshot. I have once again changed the view to landscape for the sake of convenience.</p><div><img src="img/B04014_01_22.jpg" alt="Looking at the default SceneKit project"/></div><p>At the bottom, you get<a id="id64" class="indexterm"/> more debug information than in <a id="id65" class="indexterm"/>SpriteKit. In the bottom-left corner, you have the FPS counter, which is the same as in SpriteKit. As expected, the FPS will be less than SpriteKit projects. This is because we are now looking at 3D models, which include a higher number of vertices and polygons for the processor to calculate, causing the FPS to dip. This is only on the simulator; on the actual device, the FPS will be at 60.</p><p>In the bottom-right corner of the screen, the diamond shows the number of draw calls, which is similar to the nodes in SpriteKit. Since there is only one object on the screen—the fighter jet—you get one draw call. The more the objects added, the higher the draw call.</p><p>The triangle tells the number of polygons that form the object. The star, or the asterisk, shows the number of vertices that are present in the object. You can click on the <strong>+</strong> sign on the left to get additional information such as <strong>Animations</strong>, <strong>Physics</strong>, <strong>Constraints</strong>, <strong>Particles</strong>, <strong>Delegate</strong>, <strong>Rendering</strong>, <strong>GL Flush</strong>, and <strong>2D</strong>.</p><p>3D objects are made <a id="id66" class="indexterm"/>of vertices, and these vertices are joined by <a id="id67" class="indexterm"/>lines forming triangular or rectangular shapes called polygons. These in turn form the mesh, giving a shape to the object, the fighter jet in this case. Then a 2D image is painted over the shape, giving it the look of a fighter jet. In the left panel, you can open <code class="literal">art.acnassets</code>. This is where all the art assets of the game will be stored. Select it to look at the mesh and the image, or texture files that get placed on the mesh.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec14"/>Understanding 3D objects</h1></div></div></div><p>I have taken the <code class="literal">ship.dae</code> COLLADA file and imported it into a <a id="id68" class="indexterm"/>3D program to show the mesh of the jet object. COLLADA files can be imported into any of the popular 3D software packages, such as 3DSMax, Maya, or Blender.</p><p>In the SceneKit project, we saw the object in all its textured glory. The scene had the textured object, along with the camera, and lights casting shadows. In the following figure, you can see the wire mesh view of the actual mesh of the object. This has been provided so that you can understand what a 3D polygon object is and how vertices make up the polygon to create a mesh of a 3D object.</p><div><img src="img/B04014_01_23.jpg" alt="Understanding 3D objects"/></div><p>The green lines are the lines that connect points to form the polygon surface of the object. You can see how these vertices are used to form triangles or polygons to create the desired shape, such as the wings, the cockpit, and the fuselage of the plane. The object is completely hollow. A texture is then pasted on it so that it looks as if it has had a fresh coat of paint put on it. You can also specify a material that can reflect light, making it shiny and reflective.</p><p>In SceneKit, you can import a 3D scene created in a 3D package, with the texture, lighting, animations, and camera completely intact. You can create it in your favorite 3D package and export it in the <code class="literal">.dae</code> format. You will be able to import it into SceneKit, like the jet.</p><p>If your game is very simple and doesn't require such complex shapes, then you can create a box, a sphere, and other primitive objects and shapes in SceneKit itself through code, and give them whatever color that you wish. However, you will still need to create a camera and lights so that the object will be visible in the scene.</p><p>Going back to the <a id="id69" class="indexterm"/>simulator, you can click and drag the viewport to rotate the object around its center to take a better look at the object. You can also double-click on the screen to reset the view to its initial state. Other than creating a 3D scene, SceneKit also allows the touch interface so that the player can interact with the object. We will look at this in detail when we cover SceneKit in depth later in this book.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec15"/>2D and 3D coordinate systems</h1></div></div></div><p>In the case of 2D game <a id="id70" class="indexterm"/>development, we have only two coordinate systems to worry about. The first is the screen coordinate system, and the other is the object coordinate system.</p><p>In 2D, whenever we place an object on the screen, we always wonder how far the object is from the bottom-left corner of the screen. This is because the bottom-left corner of the screen, and not the center of screen, is the origin. Therefore, if you place a sprite without changing its position, it will be created in the bottom-left part of the screen. The screen origin or the <code class="literal">(0, 0)</code> position is in the bottom-left corner of the screen. If you want to place the sprite in the center of the screen, you need to add half the width and height to the position property, since everything is in respect to the bottom-left corner of the screen. This is called the Screen Coordinate system.</p><p>The object coordinate system refers to the sprite itself. The center of the sprite is at the center of the object, unlike the screen, which has its origin at the bottom-left corner. The center of the sprite is called the <strong>anchor point</strong>. When you rotate a sprite, it will rotate about its center because its origin is at its center. You can change the origin of the sprite by accessing its <strong>Anchor Point</strong> property.</p><div><img src="img/B04014_01_24.jpg" alt="2D and 3D coordinate systems"/></div><p>In 3D game development, there<a id="id71" class="indexterm"/> are a couple of more coordinate systems. So, there are the World, Object, View, and Screen coordinate systems. Other than being referred to as Coordinate Systems, they are also referred to as a space.</p><p>In the case of 2D, the World Coordinate system is the same as the Screen Coordinate System, but in 3D that is not the case. In the following diagram, imagine you are seeing the jet on your device:</p><div><img src="img/B04014_01_25.jpg" alt="2D and 3D coordinate systems"/></div><p>The World space's <a id="id72" class="indexterm"/>origin is where the red, green, and yellow arrows originate from. The red arrow represents the positive <em>x</em> axis, green is the positive <em>y</em> axis, and yellow is the positive <em>z</em> axis. The World space's origin is at <code class="literal">0, 0, 0</code>.</p><p>The jet is placed within the World space. As with the sprite, the Object Coordinate System is at the center of the object.</p><p>The red box represents a camera looking towards the jet plane. The place where the camera is positioned is called a view, eye, or camera coordinate system. The view frustum represents the view limits of the camera. Anything placed outside this area won't be rendered by the camera. In graphics programming, this is called <a id="id73" class="indexterm"/>
<strong>clipping</strong>.</p><p>Finally, whatever is seen by the camera has to be projected onto the screen of the device. This is called the Screen Coordinate System.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec16"/>The basics of SceneKit</h1></div></div></div><p>Let's take a brief look at <a id="id74" class="indexterm"/>how the scene was created in this project. Open the <code class="literal">GameViewController.swift</code> file. To create a scene in SceneKit, you have a separate scene creator, here is it called <code class="literal">SCNScene</code>, to create 3D scenes.</p><p>The <code class="literal">GameViewController.swift</code> file is responsible for the views. Any app that is created must contain at least one view so that it can be displayed on the screen. Whenever you open a new application, a view is created. Once the view is created, the first function that gets called is the <code class="literal">viewDidLoad</code> function, which starts executing whatever code is written in it:</p><div><img src="img/B04014_01_26.jpg" alt="The basics of SceneKit"/></div><p>We create a new scene of <a id="id75" class="indexterm"/>the <code class="literal">SCNScene</code> type and load the <code class="literal">ship.dae</code> object. There's no need to load the material for the plane separately; it will automatically be assigned to the plane. As every scene first needs a camera, we create a new camera node and add it to the scene. Then the camera is positioned in the 3D space. So unlike SpriteKit, in which positions are specified in <em>x</em> and <em>y</em> coordinates, SceneKit needs its coordinates to be defined in terms of <em>x</em>, <em>y</em>, and <em>z</em>.</p><p>The origin is at the center of the scene. In one of the previous screenshots (the one which shows the world space), the red arrow shows the positive <em>x</em> axis, the green arrow denotes the positive <em>y</em> axis, and the yellow arrow shows the positive <em>z</em> axis. So, the camera—denoted by the red cube—is placed 15 pixels away from the object in the positive <em>z</em> direction. The jet object is placed at the origin.</p><p>Next, we create two light sources. First we create an omni light, and then we create an ambient light to illuminate the scene. If you don't add any light sources, nothing will be visible in the scene. You can try commenting out the lines, but due to this being where the light sources are added to the scene; you will see a black screen. The jet is still there, but due to the absence of light, you are just not able to see it.</p><p>Then we get the ship object from the scene and apply the rotation action to it, similarly to how it was done in SpriteKit. It is just that now, it is called <code class="literal">SCNAction</code> instead of <code class="literal">SKAction</code>. Also, you are providing the angle in all three axes, keeping the value for the <em>x</em> and <em>z </em>axes zero, and rotating the object in the <em>y</em> axis every second.</p><p>Then, a new <code class="literal">sceneView</code> variable is created, assigned with the current view and then,  the current scene is assigned to the scene of <code class="literal">sceneView</code>. Then <code class="literal">sceneView</code> is allowed to control the camera, and show the debug information, such as FPS. You should also set the background color to <code class="literal">black</code>.</p><p>A new function is created, called <code class="literal">handleTap</code>, where resetting of the view on double tapping is handled.</p><p>The <code class="literal">GameViewControllerclass</code> class has other functions such as <code class="literal">shouldAutoRotate</code>, <code class="literal">prefersStatusBarHidden</code>, <code class="literal">supportInterfaceOrientation</code>, and <code class="literal">didReceieveMemoryWarning</code>. Let us look at each of them in detail:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">shouldAutoRotate</code>: This<a id="id76" class="indexterm"/> function is set to <code class="literal">true</code> or <code class="literal">false</code> depending on whether you want to rotate the view if the device is flipped. If it is <code class="literal">true</code>, the view will be rotated.</li><li class="listitem" style="list-style-type: disc"><code class="literal">prefersStatusBarHidden</code>: Enable this <a id="id77" class="indexterm"/>function if you want the status bar hidden. If you want it to be shown for some reason, you should disable this option.</li><li class="listitem" style="list-style-type: disc"><code class="literal">supportInterfaceOrientation</code>: The <a id="id78" class="indexterm"/>device will automatically check which types of orientation are allowed. In this case, if it is an iPhone, it accepts all but the upside down orientation.</li><li class="listitem" style="list-style-type: disc"><code class="literal">didReceiveMemoryWarning</code>: If there<a id="id79" class="indexterm"/> are images and other data that you haven't released, and if they are putting stress on the memory, this function will automatically issue a warning saying that there is not enough memory and will close the app.</li></ul></div><p>All of this would have<a id="id80" class="indexterm"/> been fairly complex, but don't worry. We will break this down to its basics when we cover SceneKit later in the book.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec17"/>Introducing Metal</h1></div></div></div><p>Metal<a id="id81" class="indexterm"/> is Apple's new low-level graphics API. With it, you can communicate with the GPU directly and conduct graphics, as well as other computational operations. Using Metal, you can create 2D and 3D apps or games by developing your own custom framework from the ground up, without relying on pre-existing frameworks such as SpriteKit and SceneKit.</p><p>Metal, like any other graphics API, has a graphics pipeline with programmable shaders. You are also able to allocate the memory, including buffer and texture objects. Metal also has it own shader language for compiling and applying the shaders.</p><p>But why do we need Metal when there is SceneKit? In SceneKit, SpriteKit, or any other game development framework, Metal first interacts with a graphics library, such as OpenGL ES, which in turn transfers the information to the GPU. Well! With Metal, you have the absolute power to directly communicate with the GPU and create your own framework as per your desire so that you can create a more optimized game.</p><p>A framework always sits above OpenGL or Metal, then communicates with the graphics processor, as shown in the following diagram. With Metal, you can eliminate one layer and talk directly with the GPU:</p><div><img src="img/B04014_01_27.jpg" alt="Introducing Metal"/></div><p>You also have the freedom to create your own tools as per your own specifications, from the ground up. Further, you can access the memory to get the maximum juice out of the processor.</p><p>However, you might<a id="id82" class="indexterm"/> still say; "Well, OpenGL ES also provides all of this." That is true, but OpenGL ES is cross-platform and will work on other devices running many other operating systems. So, you can imagine the amount of extra material in OpenGL ES that is there to support all the devices and operating systems. This is where the difference between Metal and OpenGL ES lies.</p><p>Metal is very specifically written for the Apple range of devices and OS. In fact, at the time of writing this book, it is highly constrained to what Apple devices and OS are required to run it. You need an Apple device that has an A7 or A8 chip running iOS 8 to run games made with Metal. Moreover, if you want to test the game during development, you can't run it on a simulator, as it is not supported. You will require an actual device to run it, so you will require at least an iPad Mini 2, iPad Air, or iPhone 5S just to test your game.</p><p>With Metal, developers are seeing at least a 30 percent increase in performance as compared to the same game made with OpenGL ES running on the current Apple devices. So, if you are planning to create a 3D game just for the latest range of devices of Apple, it is highly recommended that you start creating your games using Metal.</p><p>You can create a Metal project and build it on your device to see the output. Since a lot of concepts will have to be covered to even start explaining all of the code on the screen—and since we will be covering these in detail later in the book—it is better that we go through the code later, after we understand the meaning of terms such as vertex buffer, frame buffer, and index buffer, and the difference between each of them.</p><p>If you have a device connected and have downloaded the developer license from the Apple Developer portal, you can click on the play button to build the app. Once the project is built, you will see the following screen:</p><div><img src="img/B04014_01_28.jpg" alt="Introducing Metal"/></div><p>To better understand<a id="id83" class="indexterm"/> Metal or OpenGL and appreciate the effort it actually takes to render even a triangle on the screen, you will need an understanding of what is called a <strong>graphics pipeline</strong>.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec18"/>The graphics pipeline</h1></div></div></div><p>If we look at any game <a id="id84" class="indexterm"/>development framework, we will realize that there are at least two functions that are present in almost every class. The first function is <code class="literal">init</code> or the <code class="literal">start</code> function, and the second function is the <code class="literal">update</code> function.</p><p>The <code class="literal">init</code> function or the start function is called once, at the beginning, to initialize all the variables of the class. On the other hand, the <code class="literal">update</code> function is usually called 60 times per second to update the position of the objects or detect collisions between objects.</p><p>Apart from initializing and updating the position, there is also another function that needs to be called along with the <code class="literal">update</code> function. Like a wiper on your windscreen, it needs to erase and redraw the content on the screen. This is called the <code class="literal">draw</code> function. In some frameworks, it is the third function, called <code class="literal">draw()</code>.</p><p>Every time this function is called, it is termed as a <em>draw call</em>. In SceneKit, we saw this word. But where is this function in SceneKit or SpriteKit? In both of these frameworks, similar to Cocos2d and ActionScript, there is something called a display list. Whenever you add an object using <code class="literal">addChild</code>, that object gets added to the display list.</p><p>A display list is like any array in which you can add or remove objects. The display list loops through all the objects that are added to it, and then draws all objects on the screen.</p><p>So, you don't have to worry about calling the <code class="literal">draw</code> function; you just add the object to be drawn by calling <code class="literal">addChild</code>. Otherwise—that is, if you don't want the object to be rendered—you can call the <code class="literal">removeChild</code> function to remove that object from the display list so that it won't be drawn to the screen.</p><p>The process of displaying things on the screen is known as a graphics pipeline. This is a step-by-step process of converting the vertex data and texture data that is provided to the GPU so that an object can be displayed and manipulated on the screen. Let's look at this process in detail.</p><p>Shown here are the stages in a render pipeline:</p><div><img src="img/B04014_01_29.jpg" alt="The graphics pipeline"/></div><p>Let us look at each stage in detail:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Vertices</strong>: You<a id="id85" class="indexterm"/> can provide either individual vertices with coordinates of each of the points, or the mesh itself. In the case of the jet, we provided the <code class="literal">.dae</code> file. The vertex information provided will contain the <em>x</em>, <em>y</em>, and <em>z</em> positions in 3D space. Apart from just position information, some of them may also contain information such as color, surface normal, and texture coordinate information. All of this information is stored in a sequence of memory space called a buffer, similar to an array.<p>Pieces of vertex information, such as position and color, are fed to the GPU as attributes. Attributes can be imagined as a set of properties of a particular vertex. So, there are position attributes, color attributes, and so on. All of these attributes are provided to the GPU to start generating the object.</p></li><li class="listitem" style="list-style-type: disc"><strong>Generating primitives</strong>: The <a id="id86" class="indexterm"/>vertices position provided in the position buffer are now connected to form small triangles, which in turn form the mesh of the object. These triangles are formed based on the sequential vertex information provided as an attribute.</li><li class="listitem" style="list-style-type: disc"><strong>Vertex/Geometry Shader</strong>: The information<a id="id87" class="indexterm"/> is then passed to the vertex shader. Vertex shaders are programmable by using a shader language. The language is similar to C. Using this language, we can change the position, causing the object to move, scale, and rotate, just as our <code class="literal">update</code> function does, within the game loop.</li><li class="listitem" style="list-style-type: disc"><strong>Rasterization</strong>: After <a id="id88" class="indexterm"/>knowing which vertex falls where, based on the locations of the polygons created by the vertices, the GPU starts drawing the pixels between the points.</li><li class="listitem" style="list-style-type: disc"><strong>Pixel/Fragment Shader</strong>: As in the <a id="id89" class="indexterm"/>vertex shader, where you were able to do vertex modification, pixel shaders enable you to perform pixel-based operations. So, since this is also a shader, you know that it is programmable as well. Using pixel shaders, you can create effects such as changing the color and transparency of texture provided.</li><li class="listitem" style="list-style-type: disc"><strong>Testing and Mixing</strong>: This is<a id="id90" class="indexterm"/> the stage where the GPU will check whether the pixel should be actually displayed on the screen. Suppose there is an object in front of the current object, and the current object should be only partially visible. The GPU will put only those pixels on the screen that should actually be visible, and will disregard the overlapping pixels.</li><li class="listitem" style="list-style-type: disc"><strong>Frame Buffer</strong>: Buffer? So<a id="id91" class="indexterm"/> is this a memory space again? Yes. Before the image gets finally displayed on the screen, the whole image is first stored in a memory space called the frame buffer. When all of the computation is done and the final image is ready to be displayed on the screen, the data from the frame buffer is taken and then displayed on the screen.</li></ul></div><p>If you don't understand all of this, it is completely fine. When we take a look at creating objects and displaying them on the screen in Metal, we will be walking through these steps practically, so don't worry about them.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec19"/>Summary</h1></div></div></div><p>There are a lot of basics and features of Xcode 6, and we covered them in this chapter. You saw how to become an Apple developer so that you can test the games that you are going to build on the device. Later, you will be uploading a game to the App Store.</p><p>We looked at how to create a playground file and project folders for different game technologies such as SceneKit, SpriteKit, and Metal, which we will be using in the forthcoming chapters. Finally, we looked at the render pipeline that is widely used to render stuff on the screen in any device.</p><p>In the next chapter, we will take a look at the interface of Xcode and the tools and features it provides.</p></div></body></html>