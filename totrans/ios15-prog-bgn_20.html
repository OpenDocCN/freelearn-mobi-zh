<html><head></head><body>
		<div><h1 id="_idParaDest-243"><em class="italic"><a id="_idTextAnchor248"/>Chapter 17</em>: Getting Started with JSON Files</h1>
			<p>In the previous chapter, you configured the <code>.plist</code> file. You configured custom annotations for each restaurant location and configured the callout buttons in them to present the <strong class="bold">Restaurant Detail</strong> screen when tapped. You also organized your code using extensions to make it easier to read and maintain.</p>
			<p>In this chapter, you will use data stored in <code>.plist</code> file. Next, you'll configure the <code>LocationViewController</code> class to store the location selected by the user in the <code>ExploreViewController</code> instance when the <code>ExploreViewController</code> class to pass the selected location and cuisine to the <code>RestaurantListViewController</code> instance when a type of cuisine is selected. Finally, the <code>RestaurantListViewController</code> class will then be modified to get a list of restaurants from a JSON file corresponding to the selected location and cuisine and display them in the <strong class="bold">Restaurant List</strong> screen.</p>
			<p>By the end of this chapter, you'll know how to load and parse data from JSON files for use in your own apps. You'll also learn about <code>UITableViewDelegate</code> methods and ways to pass data from one view controller to another.</p>
			<p>The following topics will be covered:</p>
			<ul>
				<li>Getting data from JSON files</li>
				<li>Using data from JSON files in your app</li>
				<li>Configuring the <code>MapDataManager</code> instance to use data from the <code>RestaurantDataManager</code> instance</li>
				<li>Storing a user-selected location</li>
				<li>Passing location and cuisine information to the <code>RestaurantListViewController</code> instance</li>
			</ul>
			<h1 id="_idParaDest-244"><a id="_idTextAnchor249"/>Technical requirements</h1>
			<p>You will continue working on the <code>LetsEat</code> project that you modified in the previous chapter.</p>
			<p>The resource files and completed Xcode project for this chapter are in the <code>Chapter17 </code>folder of the code bundle for this book, which can be downloaded here:</p>
			<p><a href="https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition">https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition</a></p>
			<p>Check out the following video to see the code in action:</p>
			<p><a href="https://bit.ly/3Hl8Ulz">https://bit.ly/3Hl8Ulz</a></p>
			<p>Let's start by learning how to read and parse JSON files to get data for use in your app.</p>
			<h1 id="_idParaDest-245"><a id="_idTextAnchor250"/>Getting data from JSON files</h1>
			<p>In <a href="B17469_14_Final_VK_ePub.xhtml#_idTextAnchor201"><em class="italic">Chapter 14</em></a><em class="italic">, Getting Data into Collection Views</em>, you learned how to load a file, read data <a id="_idIndexMarker865"/>from it using a data manager class, and put it into <a id="_idIndexMarker866"/>objects in your app. In this chapter, you will also do the same thing, the difference is that you will be reading data from a JSON file instead of a <code>.plist</code> file. This will simulate reading data from an online web-based service, where JSON is a commonly used format. Let's start by learning more about JSON files and how they work.</p>
			<h2 id="_idParaDest-246"><a id="_idTextAnchor251"/>Understanding the JSON format</h2>
			<p>JavaScript <a id="_idIndexMarker867"/>Object Notation (JSON) is a way to structure data in a file that can be easily read by both people and computers. Many iOS apps work with an online web-based service to access JSON files, which are then used to provide the app with data. </p>
			<p>You will not be learning about how to connect to an online service in this chapter. Instead, you will use sample JSON files downloaded from <a href="http://opentable.herokuapp.com">http://opentable.herokuapp.com</a>, which have been modified by Craig Clayton for this book. As you will see, working with JSON files is similar to working with <code>.plist</code> files. </p>
			<p>To help you to understand the JSON format, you will add the sample JSON files to your project and look at the structure of one of them. Follow these steps:</p>
			<ol>
				<li>In the Project navigator, create a new group inside the <code>Misc</code> folder and name it <code>JSON</code>. </li>
				<li>If you have not yet downloaded the project files for this chapter, go ahead and download them from this link: <a href="https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition">https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition</a>.</li>
				<li>Unzip the <a id="_idIndexMarker868"/>folder and open the <code>resources</code> folder in the <code>Chapter17</code> folder. You should see several JSON files inside. </li>
				<li>Drag all of the JSON files there into the <code>JSON</code> folder you just created. </li>
				<li>Click <strong class="bold">Finish</strong> on the screen that appears. </li>
				<li>Each JSON file contains restaurant details for a particular city. Click <code>Charleston.json</code> and you should see the following:</li>
			</ol>
			<div><div><img src="img/Figure_17.01_B17469.jpg" alt="Figure 17.1: Editor area showing contents for Charleston.json&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.1: Editor area showing contents for Charleston.json</p>
			<p>As you can see, the file starts with an opening square bracket, and each item inside consists of key-value pairs containing restaurant information, enclosed by curly braces and separated by commas. At the very end of the file, you can see a closing square bracket. The square brackets denote arrays, and the curly braces denote dictionaries. In other words, the JSON file contains an array of dictionaries, exactly the same as the <code>.plist</code> files you have been using earlier.</p>
			<p>Now that you have seen what a JSON file looks like, let's create a data manager class to load data from <a id="_idIndexMarker869"/>JSON files into your app in the next section.</p>
			<h2 id="_idParaDest-247"><a id="_idTextAnchor252"/>Creating the RestaurantDataManager class</h2>
			<p>You have<a id="_idIndexMarker870"/> learned how to create a data<a id="_idIndexMarker871"/> manager class to load data from a <code>.plist</code> file in <a href="B17469_14_Final_VK_ePub.xhtml#_idTextAnchor201"><em class="italic">Chapter 14</em></a><em class="italic">, Getting Data into Collection Views</em>. You will now create <code>RestaurantDataManager</code>, a data manager class that loads data from the JSON files that you added to your project earlier. As you will see, loading data from a JSON file will be similar to loading data from a <code>.plist</code> file.</p>
			<p class="callout-heading">Important Information</p>
			<p class="callout">To learn more about parsing JSON files, watch the video available here: <a href="https://developer.apple.com/videos/play/wwdc2017/212/">https://developer.apple.com/videos/play/wwdc2017/212/</a>.</p>
			<p>Before you create the <code>RestaurantDataManager</code> class, you'll need to modify the <code>RestaurantItem</code> class so it conforms to the <code>Decodable</code> protocol. Adopting this protocol allows you to use the <code>JSONDecoder</code> class to populate <code>RestaurantItem</code> instances using data from JSON files.</p>
			<p class="callout-heading">Important Information</p>
			<p class="callout">To learn more about Decodable and the JSON Decoder class, see these links:</p>
			<p class="callout"><a href="https://developer.apple.com/documentation/foundation/archives_and_serialization/encoding_and_decoding_custom_types">https://developer.apple.com/documentation/foundation/archives_and_serialization/encoding_and_decoding_custom_types</a></p>
			<p class="callout"><a href="https://developer.apple.com/documentation/foundation/jsondecoder">https://developer.apple.com/documentation/foundation/jsondecoder</a></p>
			<p>To modify the <code>RestaurantItem</code> class so it conforms to the <code>Decodable</code> protocol, follow these steps: </p>
			<ol>
				<li value="1">In the Project navigator, click the <code>RestaurantItem</code> file inside the <code>Model</code> folder in the <code>Map</code> folder. Modify the class declaration for <code>RestaurantItem</code> as shown to adopt the <code>Decodable</code> protocol:<pre>class RestaurantItem: NSObject, MKAnnotation<strong class="bold">, </strong>
<strong class="bold">Decodable {</strong></pre></li>
				<li>Remove the <code>init()</code> method and add the following enumeration to make the <code>RestaurantItem</code> class<a id="_idIndexMarker872"/> conform <a id="_idIndexMarker873"/>to the <code>Decodable</code> protocol:<pre>enum CodingKeys: String, CodingKey {
   case name
   case cuisines 
   case lat
   case long 
   case address
   case postalCode = "postal_code" 
   case state
   case imageURL = "image_url"
   case restaurantID = "id"
}</pre><p>The <code>CodingKeys</code> enumeration matches the <code>RestaurantItem</code> class properties to the keys in the JSON file. This allows the <code>JSONDecoder</code> instance to get values from the JSON file and assign them to properties in the <code>RestaurantItem</code> class. If the key name does not match the property name, you can map the key to the property, as shown in the preceding code block for <code>postalCode</code>, <code>imageURL</code>, and restaurantID.</p><p>After you modify the <code>RestaurantItem</code> class, you'll see an error in the <code>fetch(completion:)</code> method in the <code>MapDataManager</code> file. Don't worry about it as you will fix it in the next section.</p></li>
			</ol>
			<p>Now let's create the <code>RestaurantDataManager</code> class, which will read the JSON file and put the data into an array of <code>RestaurantItem</code> instances. Follow these steps:</p>
			<ol>
				<li value="1">Right-click on the <code>Restaurants</code> folder and create a new group named <code>Model</code>. Then right-click on the <code>Model</code> folder and choose <strong class="bold">New File</strong>.</li>
				<li><strong class="bold">iOS</strong> should <a id="_idIndexMarker874"/>already be <a id="_idIndexMarker875"/>selected. Choose <strong class="bold">Swift File</strong> and then click <strong class="bold">Next</strong>.</li>
				<li>Name this file <code>RestaurantDataManager</code>. Click <code>RestaurantDataManager</code> file appears in the Project navigator.</li>
				<li>Add the following after the <code>import</code> statement to declare the <code>RestaurantDataManager</code> class: <pre>class RestaurantDataManager {
 
}</pre></li>
				<li>Add the following property between the curly braces to hold an array of <code>RestaurantItem</code> instances:<pre>private var restaurantItems: [RestaurantItem] = []</pre><p>The <code>restaurantItems</code> array will store the <code>RestaurantItem</code> instances obtained from the JSON file. The <code>private</code> keyword means it is only accessible from within this class.</p></li>
				<li>Add the following method after the <code>restaurantItems</code> property to read a JSON file <a id="_idIndexMarker876"/>and return an array <a id="_idIndexMarker877"/>of <code>RestaurantItem</code> instances:<pre>func fetch(location: String, selectedCuisine: 
String = "All", completionHandler: (_ 
restaurantItems: [RestaurantItem]) -&gt; Void) { 
   if let file = Bundle.main.url(forResource: 
   location, withExtension: "json") {
      do {
         let data = try Data(contentsOf: file)
         let restaurants = try JSONDecoder().decode(
         [RestaurantItem].self, from: data)
         if selectedCuisine != "All" {
            restaurantItems = restaurants.filter {
              ($0.cuisines.contains(selectedCuisine))
            }
         } else { 
            restaurantItems = restaurants 
         }
      } catch {
         print("There was an error \(error)")
      }
   }
   completionHandler(restaurantItems)
}</pre><p>Let's break this down:</p><pre>func fetch(location: String, selectedCuisine: 
String = "All", completionHandler: (_ restaurantItems:
[RestaurantItem]) -&gt; Void)</pre><p>This method takes three parameters: <code>location</code>, a string containing the restaurant location, <code>selectedCuisine</code>, a string containing the cuisine selected by the user, and <code>completionHandler</code>, a closure used to process the result of <a id="_idIndexMarker878"/>this method <a id="_idIndexMarker879"/>when it has finished execution. If you do not provide a value for <code>selectedCuisine</code>, it will default to <code>"All"</code>. </p><pre>if let file = Bundle.main.url(forResource: location, 
withExtension: "json")</pre><p>This gets the URL of the JSON file in the app bundle and assigns it to <code>file</code>.</p><p><code>do</code> code block:</p><p>The first statement attempts to assign the contents of <code>file</code> to <code>data</code>. The next statement attempts to use a <code>JSONDecoder</code> instance to parse <code>data</code> and store it as an array of <code>RestaurantItem</code> instances, which is assigned to <code>restaurants</code>. In the next statement, if <code>selectedCuisine</code> is not <code>All</code>, the <code>filter</code> method is applied to the <code>restaurants</code> array using the <code>{($0.cuisines.contains(selectedCuisine))}</code> closure. This results in an array of <code>RestaurantItem</code> instances where the <code>cuisines</code> property contains the user-selected cuisine, and this array is assigned to <code>restaurantItems</code>. Otherwise, the entire <code>restaurants</code> array is assigned to <code>restaurantItems</code>.</p><p><code>catch</code> code block:</p><p>This prints an error message to the Debug area if the <code>do</code> code block fails.</p><pre>completionHandler(items)</pre><p>This statement processes the <code>restaurantItems</code> array using the closure provided.</p><p>Note that when you call this method in Xcode, the autocomplete feature gives you two possible choices; one that includes the <code>selectedCuisine:</code> parameter (that takes a string containing the selected cuisine) and one that doesn't (<code>selectedCuisine</code> is set to All).</p></li>
				<li>Add a method after the <code>fetch(location:selectedCuisine:completionHandler:)</code> method to<a id="_idIndexMarker880"/> return the number<a id="_idIndexMarker881"/> of items in the <code>restaurantItems</code> array:<pre>func numberOfRestaurantItems() -&gt; Int {
   restaurantItems.count
}</pre><p>You'll call this method to determine the number of collection view cells to display in the <strong class="bold">Restaurant List</strong> screen.</p></li>
				<li>Add a method just after the <code>numberOfRestaurantItems()</code> method to return a <code>RestaurantItem</code> instance from the <code>restaurantItems</code> array at the index provided:<pre>func restaurantItem(at index: Int) -&gt; 
RestaurantItem {
   restaurantItems[index]
}</pre><p>You'll call this method to configure the content of each collection view cell in the <strong class="bold">Restaurant List</strong> screen.</p></li>
			</ol>
			<p>The <code>RestaurantDataManager</code> class has been created, which allows you to read data stored in <code>JSON</code> files and put it into an array of <code>RestaurantItem</code> instances. Before you can use it, you'll need to modify your project quite a bit. Let's see what's required to <a id="_idIndexMarker882"/>display<a id="_idIndexMarker883"/> restaurant information in the <strong class="bold">Map</strong> and <strong class="bold">RestaurantList</strong> screens in the next section.</p>
			<h1 id="_idParaDest-248"><a id="_idTextAnchor253"/>Using data from JSON files in your app</h1>
			<p>Let's <a id="_idIndexMarker884"/>review <a id="_idIndexMarker885"/>how the <a id="_idIndexMarker886"/>app works. In the <strong class="bold">Map</strong> screen, the user will see all the restaurants near the user's location. Tapping a restaurant will display a callout bubble, and tapping the button in the callout button will display the details of said restaurant in the <strong class="bold">Restaurant Detail</strong> screen. </p>
			<p>In the <strong class="bold">Explore</strong> screen, the user will tap the <strong class="bold">LOCATION</strong> button and select a location such as <strong class="bold">Charleston, NC</strong> on the <strong class="bold">Locations</strong> screen. After a location has been selected, the user taps <strong class="bold">Done</strong> and will be returned to the <strong class="bold">Explore </strong>screen. The user will then select a cuisine in the <strong class="bold">Explore</strong> screen, and a list of restaurants in that location that offer that cuisine will be displayed in the <strong class="bold">Restaurant List</strong> screen. Tapping a restaurant will display the details of said restaurant in the <strong class="bold">Restaurant Detail </strong>screen.</p>
			<p>You will do the following:</p>
			<ul>
				<li>Configure the <code>MapViewController</code> class to get a list of restaurants from a JSON file instead of a <code>.plist</code> file. This will also fix the error in the <code>MapDataManager</code> class's <code>fetch(completion:)</code> method.</li>
				<li>Configure the <code>LocationViewController</code> class to store the location selected by the user.</li>
				<li>Pass the selected location to the <code>ExploreViewController</code> instance.</li>
				<li>Configure the <code>ExploreViewController</code> class to pass the selected location and cuisine to the <code>RestaurantListViewController</code> instance.</li>
				<li>Configure the <code>RestaurantListViewController</code> class to get a list of restaurants from a JSON file corresponding to the selected location.</li>
				<li>Configure the <code>RestaurantListViewController</code> class to display a list of restaurants based on the location and cuisine selected.</li>
			</ul>
			<p>This may seem daunting, so you'll do things step by step. To start, you'll configure the <code>MapDataManager</code> class <a id="_idIndexMarker887"/>to<a id="_idIndexMarker888"/> read<a id="_idIndexMarker889"/> data from JSON files instead of <code>.plist</code> files.</p>
			<h1 id="_idParaDest-249"><a id="_idTextAnchor254"/>Configuring the MapDataManager instance to use data from the RestaurantDataManager instance</h1>
			<p>Currently, there<a id="_idIndexMarker890"/> is an <a id="_idIndexMarker891"/>error in the <code>MapDataManager</code> file. This is because the <code>fetch(completion:)</code> method in your <code>MapDataManager</code> class calls the initializer method that you removed from the <code>RestaurantItem</code> class. You will now update the <code>MapDataManager</code> class to use the <code>RestaurantDataManager</code> instance as a data source, fixing the error in the process. Click the <code>MapDataManager</code> file (inside the <code>Model</code> folder in the <code>Map</code> folder) in the Project navigator and update the <code>fetch(completion:)</code> method as follows:</p>
			<pre>func fetch(completion: (_ annotations: [RestaurantItem]) -&gt; ()){
<strong class="bold">   let manager = RestaurantDataManager()</strong>
<strong class="bold">   manager.fetch(location: "Boston", completionHandler: { </strong>
<strong class="bold">      (restaurantItems) in self.items = restaurantItems</strong>
<strong class="bold">      completion(items)</strong>
<strong class="bold">   })</strong>
}</pre>
			<p>Let's break this down:</p>
			<pre>func fetch(completion: (_ annotations: [RestaurantItem]) -&gt; ())</pre>
			<p>This method has a completion method parameter. The completion method will be used to process the result when the method has finished execution.</p>
			<pre>let manager = RestaurantDataManager() </pre>
			<p>This creates an instance of the <code>RestaurantDataManager</code> class and assigns it to <code>manager</code>.</p>
			<pre>manager.fetch(location: "Boston", completionHandler: { 
   (restaurantItems) in self.items = restaurantItems
   completion(items)
})</pre>
			<p>This calls the <code>manager</code> instance's <code>fetch()</code> method to get a list of restaurants from <code>Boston.json</code>. This<a id="_idIndexMarker892"/> is <a id="_idIndexMarker893"/>hardcoded for now as the iOS Simulator does not have a functional GPS. To see restaurants at a different location, change the name of the JSON file used to another location. The array of <code>RestaurantItem</code> instances returned by this method is assigned to the <code>MapViewController</code> instance's <code>items</code> array, and the completion method that was passed in is used to process this array. As you saw in the previous chapter, this will generate the annotations that will be added to the map view in the <strong class="bold">Map</strong> screen.</p>
			<p class="callout-heading">Important Information</p>
			<p class="callout">To learn more about how to determine your location, visit <a href="https://developer.apple.com/documentation/mapkit/mkmapview/converting_a_user_s_location_to_a_descriptive_placemark">https://developer.apple.com/documentation/mapkit/mkmapview/converting_a_user_s_location_to_a_descriptive_placemark</a>.</p>
			<p>If you run your app now and select the <strong class="bold">Map</strong> screen, you should see pins for restaurants in Boston. </p>
			<p>In the next section, you'll configure the <code>LocationViewController</code> class so it can store the location selected by the user.</p>
			<h1 id="_idParaDest-250"><a id="_idTextAnchor255"/>Storing a user-selected location</h1>
			<p>At present, the <code>LocationDataManager</code> class<a id="_idIndexMarker894"/> loads data from <code>Locations.plist</code> and stores location information in an array of strings. You will create a new structure, <code>LocationItem</code>, and configure the <code>LocationDataManager</code> class to store locations in an array of <code>LocationItem</code> instances. After that, you'll modify the <code>LocationViewController</code> class so that it can store a <code>LocationItem</code> instance containing the user-selected location. You can then pass this instance to the <code>RestaurantListViewController</code> instance in your app. Follow these steps:</p>
			<ol>
				<li value="1">Right-click on the <code>Model</code> folder inside the <code>Location</code> folder and select <strong class="bold">New File</strong>.</li>
				<li><strong class="bold">iOS</strong> should already be selected. Choose <strong class="bold">Swift File</strong> and then click <strong class="bold">Next</strong>.</li>
				<li>Name this file <code>LocationItem</code>. Click <code>LocationItem</code> file appears in the Project navigator.</li>
				<li>Click the <code>LocationItem</code> file and add the following after the <code>import</code> statement to declare and define the <code>LocationItem</code> structure:<pre>struct LocationItem { 
   let city: String?
   let state: String?
}
extension LocationItem {
   init(dict: [String: String]) {
      self.city = dict["city"]
      self.state = dict["state"]
   }
   var cityAndState: String {
      guard let city = self.city, let state = 
      self.state else { 
         return "" 
      }
      return "\(city), \(state)"
   }
}</pre><p>The <code>LocationItem</code> structure has two <code>String</code> properties, <code>city</code> and <code>state</code>.</p><p>The <code>init()</code> method takes a dictionary, <code>dict</code>, as a parameter and assigns the values of the <code>city</code> and <code>state</code> keys to the <code>city</code> and <code>state</code> properties.</p><p>The <code>cityAndState</code> computed property returns a string made from combining the <code>city</code> and <code>state</code> values.</p></li>
			</ol>
			<p>Now you'll <a id="_idIndexMarker895"/>update the <code>LocationDataManager</code> class so that it can store city and state information in an array of <code>LocationItem</code> instances instead of strings. Follow these steps:</p>
			<ol>
				<li value="1">Click the <code>LocationDataManager</code> in the Project navigator and modify the <code>locations</code> array to store <code>LocationItem</code> instances instead of strings:<pre>private var locations:[<strong class="bold">LocationItem</strong>] = []</pre></li>
				<li>The <code>fetch()</code> method will now show an error. Modify the <code>fetch()</code> method to work with <code>LocationItem</code> instances instead of strings:<pre>func fetch() {
   for l<a id="_idTextAnchor256"/><a id="_idTextAnchor257"/>ocation in loadData() {
      <code>loadData()</code> method is now used to initialize <code>LocationItem</code> instances instead of strings, which are then appended to the <code>locations</code> array. The <code>loadData()</code> method still uses the same <code>Locations.plist</code> file that you created in <a href="B17469_15_Final_VK_ePub.xhtml#_idTextAnchor213"><em class="italic">Chapter 15</em></a>, <em class="italic">Getting Started with Table Views</em>.</p></li>
				<li>The <code>locationItem(at:)</code> method now shows an error. Modify it so it returns a <code>LocationItem</code> instance instead of a string:<pre>func locationItem(at index: Int) -&gt; 
<strong class="bold">LocationItem</strong> {
   locations[index]
}</pre></li>
			</ol>
			<p>You are done with the <code>LocationDataManager</code> class at this point. Next, you'll update the <code>LocationViewController</code> class to use <code>LocationItem</code> instances instead of<a id="_idIndexMarker896"/> strings to populate the table view cells. Follow these steps:</p>
			<ol>
				<li value="1">Click the <code>LocationViewController</code> file in the Project navigator.</li>
				<li>You will see an error in the <code>tableView(_:cellForRowAtIndexPath:)</code> method. This error is because you can't assign a <code>LocationItem</code> instance to the cell's <code>textLabel</code> property. Modify this method as follows:<pre>func tableView(_ tableView: UITableView, cellForRowAt 
indexPath: IndexPath) -&gt; UITableViewCell {
   let cell = tableView.dequeueReusableCell(
   withIdentifier: "locationCell", for: indexPath)
   <code>cityAndState</code> property of the <code>LocationItem</code> structure returns a string that combines a location's <code>city</code> and <code>state</code> strings, fixing the error.</p></li>
				<li>You need a property to keep track of the user's selection. Add the following property declaration just after the <code>manager</code> declaration:<pre>let m<a id="_idTextAnchor258"/><a id="_idTextAnchor259"/>anager = LocationDataManager()
<strong class="bold">var selectedCity: LocationItem?</strong></pre></li>
			</ol>
			<p>To handle user interaction with the table view, you'll make the <code>LocationViewController</code> class <a id="_idIndexMarker897"/>conform to the <code>UITableViewDelegate</code> protocol. </p>
			<p class="callout-heading">Tip</p>
			<p class="callout">The <code>UITableViewDelegate</code> protocol is covered in <a href="B17469_15_Final_VK_ePub.xhtml#_idTextAnchor213"><em class="italic">Chapter 15</em></a><em class="italic">, Getting Started with Table Views</em>. </p>
			<p>The <code>UITableViewDelegate</code> protocol specifies the messages that a table view will send to its delegate when the user interacts with the rows in it. Follow these steps to adopt it:</p>
			<ol>
				<li value="1">Add the following extension after the <code>UITableViewDataSource</code> extension:<pre>// MARK: UITableViewDelegate
extension LocationViewController: 
UITableViewDelegate {
 
}</pre><p>The extension helps to keep your code organized, and the <code>// MARK:</code> syntax makes this extension easy to find in the Editor area.</p></li>
				<li>The <code>UITableViewDelegate</code> method triggered when a user taps a row in the table view is <code>tableView(_:didSelectRowAt:)</code>. Add this method between the extension's curly braces. It should look like the following:<pre>// MARK: UITableViewDelegate
extension LocationViewContro<a id="_idTextAnchor260"/><a id="_idTextAnchor261"/>ller: UITableViewDelegate 
{
<code>selectedCity</code> property is assigned the corresponding <code>LocationItem</code> instance in the <code>locations</code> array. For example, if you tap the third row, the <code>LocationItem</code> instance with the values <code>"Charleston"</code> and <code>"NC"</code> is assigned to <code>selectedCity</code>. </p></li>
			</ol>
			<p>The <code>LocationViewController</code> class can now store a user-selected location, but when you choose a location in the <code>ExploreViewController</code> class and assign it to the <strong class="bold">Done</strong> button, but before you do, you'll create a new view controller for the collection view section header in the <strong class="bold">Explore</strong> screen first. This will let you display the user-selected location in the <strong class="bold">Explore</strong> screen. You'll do this in the next section.</p>
			<h2 id="_idParaDest-251"><a id="_idTextAnchor262"/>Adding a UICollectionReusableView subclass for the section header in the Explore screen</h2>
			<p>The <code>UICollectionReusableView</code> subclass for the collection view section header, and set up an outlet for the subtitle label, so you can display the user-selected location in the collection view section header. Follow these steps:</p>
			<ol>
				<li value="1">Right-click the <code>View</code> folder inside the <code>Explore</code> folder and select <strong class="bold">New File</strong>.</li>
				<li><strong class="bold">iOS</strong> should already be selected. Choose <strong class="bold">Cocoa Touch Class</strong> and then click <strong class="bold">Next</strong>.</li>
				<li>Configure the file as follows:<p><code>ExploreHeaderView</code></p><p><code>UICollectionReusableView</code></p><p><code>Swift</code></p><p>Click <strong class="bold">Next</strong>.</p></li>
				<li>Click <code>ExploreHeaderView</code> file appears in the Project navigator. Verify that it contains the following:<pre>class ExploreHeaderView: UICollectionReusableView {
 
}</pre></li>
				<li>Click the <code>Main</code> storyboard file in the Project navigator. Select the <code>ExploreHeaderView</code>: </li>
			</ol>
			<div><div><img src="img/Figure_17.02_B17469.jpg" alt="Figure 17.2: Identity inspector with Class set to ExploreHeaderView&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.2: Identity inspector with Class set to ExploreHeaderView</p>
			<p>Note that <strong class="bold">Collection Reusable View</strong> will change to <strong class="bold">Explore Header View</strong> in the document outline.</p>
			<p>The <code>ExploreHeaderView</code> class is now managing the collection view section header. In the <a id="_idIndexMarker901"/>next <a id="_idIndexMarker902"/>section, you will link the subtitle label in the collection view section header to an outlet in the <code>ExploreHeaderView</code> class, and add a property for the <code>ExploreHeaderView</code> class in the <code>ExploreViewController</code> class.</p>
			<h2 id="_idParaDest-252"><a id="_idTextAnchor265"/>Connecting the section header's label to the ExploreViewController class</h2>
			<p>To display<a id="_idIndexMarker903"/> the user-selected<a id="_idIndexMarker904"/> city in the collection view section header, you'll connect the subtitle label to an outlet in the <code>ExploreHeaderView</code> class, then add a property for it in the <code>ExploreViewController</code> class. Follow these steps:</p>
			<ol>
				<li value="1">In the document outline, click the subtitle label for the <strong class="bold">Explore Header View</strong> (it is the label that has the text <strong class="bold">PLEASE SELECT A LOCATION</strong>):<div><img src="img/Figure_17.03_B17469.jpg" alt="Figure 17.3: Document outline with PLEASE SELECT A LOCATION label selected&#13;&#10;"/></div><p class="figure-caption">Figure 17.3: Document outline with PLEASE SELECT A LOCATION label selected</p></li>
				<li>Click the Adjust Editor Options button and choose Assistant from the menu. An assistant editor appears on the right side of the screen. Make sure that it's showing the contents of the <code>ExploreHeaderView</code> file.</li>
				<li><em class="italic">Ctrl + Drag</em> from the <strong class="bold">PLEASE SELECT A LOCATION</strong> label to the space between<a id="_idIndexMarker905"/> the curly <a id="_idIndexMarker906"/>braces:<div><img src="img/Figure_17.04_B17469.jpg" alt="Figure 17.4: Editor area showing ExploreHeaderView file contents&#13;&#10;"/></div><p class="figure-caption">Figure 17.4: Editor area showing ExploreHeaderView file contents</p></li>
				<li>In the box that appears, set the name to <code>locationLabel</code> and click <strong class="bold">Connect</strong>.</li>
				<li>The <code>locationLabel</code> outlet has been created in the <code>ExploreHeaderView</code> class. Close the assistant editor by clicking the <strong class="bold">x</strong> button.</li>
				<li>Click the <code>ExploreViewController</code> file in the Project navigator. Add the following property declaration after the <code>manager</code> declaration to store the location passed to the <code>ExploreViewController</code> instance by the <code>LocationViewController</code> instanc<a id="_idTextAnchor266"/><a id="_idTextAnchor267"/>e:<pre>let manager = ExploreDataManager()
<strong class="bold">var selectedCity: LocationItem?</strong></pre></li>
				<li>After the <code>selectedCity</code> property declaration, declare a property that will be assigned an <code>ExploreHeaderView</code> instance, which will allow the <code>ExploreViewController</code> instance to set the value for <code>locationLabel</code>:<pre>let manager = ExploreDataMana<a id="_idTextAnchor268"/><a id="_idTextAnchor269"/>ger()
var selectedCity: LocationItem?
<strong class="bold">var headerView: ExploreHeaderView!</strong></pre></li>
			</ol>
			<p>Next, let's configure the <code>locationLabel</code> to the user-selected city and state when tapped. The <strong class="bold">Explore</strong> screen will then<a id="_idIndexMarker907"/> appear with the <a id="_idIndexMarker908"/>selected city displayed in the collection view section header. You will do this in the next section.</p>
			<h2 id="_idParaDest-253"><a id="_idTextAnchor270"/>Adding an unwind action method to the Done button</h2>
			<p>In <a href="B17469_10_Final_VK_ePub.xhtml#_idTextAnchor155"><em class="italic">Chapter 10</em></a><em class="italic">, Building Your User Interface</em>, you <a id="_idIndexMarker909"/>added <a id="_idIndexMarker910"/>an unwind action method for the <code>ExploreViewController</code> class, which dismisses the <code>selectedCity</code> property in the <code>ExploreViewController</code> instance to the location selected by the user. Follow these steps:</p>
			<ol>
				<li value="1">Add the following just after the <code>unwindLocationCancel(segue:)</code> method to impleme<a id="_idTextAnchor271"/><a id="_idTextAnchor272"/>nt the unwind action for the <code>LocationViewController</code> instance and the destination view controller is an <code>ExploreViewController</code> instance. This method first checks to see if the source view controller is a <code>LocationViewController</code> instance. If it is, the<a id="_idIndexMarker911"/> value <a id="_idIndexMarker912"/>of the <code>LocationViewController</code> instance's <code>selectedCity</code> property is assigned to the <code>ExploreViewController</code> instance's <code>selectedCity</code> property, if it exists. If the <code>ExploreViewController</code> instance's <code>selectedCity</code> property has a value, it is assigned to <code>location</code>, and the text of the subtitle label is set to the <code>cityAndState</code> property of <code>location</code>.</p></li>
				<li>Modify the <code>collectionView(_:viewForSupplementaryElementOf Kind:at:)</code> method as follows:<pre>func collectionView(_ collectionView: UICollectionView, 
viewForSupplementaryElementOfKind kind: String, at 
indexPath: IndexPath) -&gt; UICollectionReusableView {
   let <code>UICollectionViewDataSource</code> protocol. It returns the view that will be used as the collection view section header. Here, the collection view section header in the <code>ExploreHeaderView</code> instance.</p><p class="callout-heading">Important Information</p><p class="callout">You can learn more about the <code>UICollectionViewDataSource</code> protocol at this link: <a href="https://developer.apple.com/documentation/uikit/uicollectionviewdatasource/1618037-collectionview"> https://developer.apple.com/documentation/uikit/uicollectionviewdatasource/1618037-collectionview</a>.</p></li>
				<li>Click the <code>Main</code> storyboard<a id="_idIndexMarker913"/> file. Select <a id="_idIndexMarker914"/>the <strong class="bold">Location View Controller Scene</strong>. To set the method to be triggered by the <strong class="bold">Done</strong> button, <em class="italic">Ctrl + Drag</em> from the <strong class="bold">Done</strong> button to the Exit icon in the Scene Dock:<div><img src="img/Figure_17.05_B17469.jpg" alt="Figure 17.5: Location View Controller Scene showing Done button action being set&#13;&#10;"/></div><p class="figure-caption">Figure 17.5: Location View Controller Scene showing Done button action being set</p></li>
				<li>Choose <code>unwindLocationDoneWithSegue:</code> from the pop-up menu. This links the <code>unwindLocationDone(segue:)</code> unwind action in the <code>ExploreViewController</code> class:</li>
			</ol>
			<div><div><img src="img/Figure_17.06_B17469.jpg" alt="Figure 17.6: Pop-up menu with unwindLocationDoneWithSegue: selected&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.6: Pop-up menu with unwindLocationDoneWithSegue: selected</p>
			<p>Build and run<a id="_idIndexMarker915"/> your<a id="_idIndexMarker916"/> app and tap the <strong class="bold">LOCATION</strong> button. Tap a city and a tick will appear in the row. Tap <strong class="bold">Done</strong>:</p>
			<div><div><img src="img/Figure_17.07_B17469.jpg" alt="Figure 17.7: iOS Simulator showing Locations screen with location selected&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.7: iOS Simulator showing Locations screen with location selected</p>
			<p>The selected <a id="_idIndexMarker917"/>city <a id="_idIndexMarker918"/>name and state will replace the <strong class="bold">PLEASE SELECT A LOCATION</strong> text in the subtitle label inside the collection view section header:</p>
			<div><div><img src="img/Figure_17.08_B17469.jpg" alt="Figure 17.8: iOS Simulator showing Explore screen with subtitle label set&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.8: iOS Simulator showing Explore screen with subtitle label set</p>
			<p>Although this <a id="_idIndexMarker919"/>works, there<a id="_idIndexMarker920"/> are two issues that you need to fix when selecting a location. The first issue is that you can select multiple locations:</p>
			<div><div><img src="img/Figure_17.09_B17469.jpg" alt="Figure 17.9: iOS simulator showing Locations screen with multiple locations selected&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.9: iOS simulator showing Locations screen with multiple locations selected</p>
			<p>You want the user<a id="_idIndexMarker921"/> to <a id="_idIndexMarker922"/>only select one location, and if another is selected, the location selected earlier should be deselected.</p>
			<p>The second issue is that the checkmark next to the user-selected location disappears if you click <strong class="bold">Done</strong> in the <strong class="bold">Locations</strong> screen and click the <strong class="bold">LOCATION</strong> button in the <strong class="bold">Explore </strong>screen again:</p>
			<div><div><img src="img/Figure_17.10_B17469.jpg" alt="Figure 17.10: iOS simulator showing Locations screen with missing checkmark&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.10: iOS simulator showing Locations screen with missing checkmark</p>
			<p>The last<a id="_idIndexMarker923"/> selected<a id="_idIndexMarker924"/> location should have a checkmark when you go back to the <strong class="bold">Locations </strong>screen again.</p>
			<p>Let's modify the <code>LocationDataManager</code> class to make sure only one location can be selected at a time in the next section.</p>
			<h2 id="_idParaDest-254"><a id="_idTextAnchor273"/>Selecting only one location in the Locations screen</h2>
			<p>At present, you <a id="_idIndexMarker925"/>can select multiple locations in the <strong class="bold">Locations</strong> screen. You should only be able to select one location, and if another is selected, the previously selected location selected should be deselected. Follow these steps:</p>
			<ol>
				<li value="1">Click the <code>LocationItem</code> file. Make <code>LocationItem</code> conform to the <code>Equatable</code> protocol by modifying the <code>LocationItem</code> structure as follows:<pre>struct LocationItem: <code>LocationItem</code> instances are equal.</p></li>
				<li>Click the <code>LocationViewController</code> file. After the <code>viewDidLoad()</code> method, add a method that sets a check<a id="_idTextAnchor274"/><a id="_idTextAnchor275"/>mark only on the row containing the selected city:<pre>private func setCheckmark(for cell: UITableViewCell, 
location: LocationItem) {
   if selectedCity == location {
      cell.accessoryType = .checkmark {
   } else {
      cell.accessoryType = .none
   }
}</pre><p>The <code>setCheckmark(for:location:)</code> method takes <code>cell</code>, a table view cell, and <code>location</code>, a <code>LocationItem</code> instance, as arguments. If <code>location</code> and <code>selectedCity</code> are equal, the checkmark for that row is set. Otherwise, the checkmark is not set.</p></li>
				<li>In the <code>tableView(_:cellForRowAt:)</code> method, modify the code as follows to call <code>setCheckmark(for:location:)</code> after the line that sets the text for<a id="_idIndexMarker926"/> the cell's <code>textLabel</code> property:<pre>func tableView(_ tableView: UITableView, cellForRowAt 
indexPath: IndexPath) -&gt; UITableViewCell {
   let cell = tableView.dequeueReusableCell(
   withIdentifier: "locationCell", for: indexPath)
   let location = manager.locationItem(at 
   indexPath.row)
<a id="_idTextAnchor276"/><a id="_idTextAnchor277"/>   cell.textLabel?.text = location.cityAndState 
   <code>setCheckmark(for:at:)</code> will be called when each row in the table view is rendered, and the checkmark will only be set on the row containing the selected location.</p></li>
				<li>In the <code>tableView(_:didSelectRowAt:)</code> method, modify the code in the <code>if</code> statement as follows to reload the table view (thus rendering all the rows in it) after a location has been selected: <pre>if let cell = tableView.cellForRow(at: indexPath) {
   cell.accessoryType = .checkmark
   selectedCity = manager.locationItem(at:
   indexPath.row)
   <strong class="bold">tableView.reloadData()</strong>
}</pre></li>
			</ol>
			<p>Build and run your project. You should only be able to set one location now, and if you choose another location, the location you chose earlier will be deselected.</p>
			<p>You'll fix the second issue in the next section so that once a location is selected, it will remain selected when you go back to the <code>RestaurantListViewController</code> instance, so it can eventually display a list of restaurants at a particular location matching the cuisine selected by<a id="_idIndexMarker927"/> the user.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">This is a long chapter, so you may wish to take a break here.</p>
			<h1 id="_idParaDest-255"><a id="_idTextAnchor278"/>Passing location and cuisine information to the RestaurantListViewController instance</h1>
			<p>At present, you're <a id="_idIndexMarker928"/>able to set a location in the <code>RestaurantListViewController</code> instance, which will then display the restaurants at the selected location that offer the selected cuisine. You'll also make the checkmark next to your selected location reappear if you have selected a location in the <strong class="bold">Locations </strong>screen earlier. Follow these steps:</p>
			<ol>
				<li value="1">You'll add identifiers for each segue connected to the <code>Main</code> storyboard file and click the <strong class="bold">Explore View Controller Scene</strong>. Select the segue between the <strong class="bold">Explore View Controller Scene</strong> and the <strong class="bold">Location View Controller Scene</strong>:<div><img src="img/Figure_17.11_B17469.jpg" alt="Figure 17.11: Editor area showing segue between Explore and Location screens selected&#13;&#10;"/></div><p class="figure-caption">Figure 17.11: Editor area showing segue between Explore and Location screens selected</p></li>
				<li>Click the<a id="_idIndexMarker929"/> Attributes inspector button. Under <code>locationList</code>:<div><img src="img/Figure_17.12_B17469.jpg" alt="Figure 17.12: Attributes inspector with Identifier set to locationList&#13;&#10;"/></div><p class="figure-caption">Figure 17.12: Attributes inspector with Identifier set to locationList</p></li>
				<li>Select the segue between <code>restaurantList</code>:<div><img src="img/Figure_17.13_B17469.jpg" alt="Figure 17.13: Attributes inspector identifier setting for the segue between &#13;&#10;the Explore and Restaurant List screens&#13;&#10;"/></div><p class="figure-caption">Figure 17.13: Attributes inspector identifier setting for the segue between the Explore and Restaurant List screens</p><p>Once you<a id="_idIndexMarker930"/> know which segue is occurring, you can specify the methods to be executed for each segue. You'll create two methods, <code>showLocationList(segue:)</code> and <code>showRestaurantList(segue:)</code>, and you'll use the <code>prepare(for:sender:)</code> method to execute the desired method depending on which segue is occurring.</p></li>
				<li>Click the <code>ExploreViewController</code> file in the Project navigator. Inside the <code>private</code> extension, declare and define the <code>showLocationList(segue:)</code> method before the <code>unwindLocationCancel()</code> method to pass the user-selected city back to the <code>Lo<a id="_idTextAnchor279"/><a id="_idTextAnchor280"/>cationViewController</code> instance if it was set earlier:<pre>func showLocationList(segue: UIStoryboardSegue) {
   guard let navController = segue.destination as? 
   UINavigationController, let viewController = 
   navController.topViewController as? 
   LocationViewController else {
      return
   }
   viewController.selectedCity = selectedCity
}</pre><p>The <code>showLocationList(segue:)</code> method will be called before the <code>Main</code> storyboard file, you embedded the <code>viewControllers</code> property that holds an array of view controllers, and the last view controller in the array has its view visible onscreen. You can access the last view controller in the array using the <code>topViewController</code> property of the navigation controller.</p><p>The <code>guard</code> statement checks whether the segue destination is a <code>UINavigationController</code> instance and whether <code>topViewController</code> is the <code>LocationViewController</code> instance. If it is, the <code>selectedCity</code> property of the <code>ExploreViewController</code> instance is checked to see if it contains a value. If it does, that value is assigned to the <code>selectedCity</code> property of the <code>LocationViewController</code> instance. Remember that the <code>setCheckmark(for:at:)</code> method of the <code>LocationViewController</code> instance will be called for each row in the table view, and this sets a checkmark on the row containing the selected city.</p></li>
			</ol>
			<p>This will fix the second issue with the <code>RestaurantListViewController</code> instance. Follow these steps:</p>
			<ol>
				<li value="1">Click the <code>RestaurantListViewController</code> file in the Project navigator. Add the following properties inside the <code>RestaurantListViewCo<a id="_idTextAnchor281"/><a id="_idTextAnchor282"/>ntroller</code> class just before the <code>@IBOutlet</code> declaration:<pre><code>selectedRestaurant</code> will <a id="_idIndexMarker932"/>be set if you pick a restaurant in the <code>selectedCity</code> stores the city you picked in the <code>selectedCuisine</code> stores the cuisine you picked in the <strong class="bold">Explore</strong> screen.</p></li>
				<li>Add the following code after the <code>viewDidLoad()</code> method to print the selected city and cuisine to the Debug area when the view for the <code>R<a id="_idTextAnchor283"/><a id="_idTextAnchor284"/>estaurantListViewController</code> instance appears onscreen:<pre>override func viewDidAppear(_ animated: Bool) {
   super.viewDidAppear(animated)
   print("selected city \(selectedCity as Any)")
   print("selected cuisine \(selectedCuisine as Any)")
}</pre><p><code>viewDidAppear()</code> is called every time a view controller's view appears onscreen, while <code>viewDidLoad()</code> is only called once when a view controller initially loads its view. <code>viewDidAppear()</code> is used here because the <code>RestaurantListViewController</code> instance will show a different list of restaurants each time its view appears onscreen, depending on the choices made by the user. At the moment, the code just prints the selected location and cuisine to the Debug area, so you can see that these values are being passed correctly.</p><p class="callout-heading">Important Information</p><p class="callout">To learn more about the view controller lifecycle, see this link: <a href="https://developer.apple.com/documentation/uikit/uiviewcontroller">https://developer.apple.com/documentation/uikit/uiviewcontroller</a>.</p></li>
				<li>Click <a id="_idIndexMarker933"/>the <code>ExploreViewController</code> file in the Project navigator. Declare and define the <code>showRestaurantList(segue:)</code> method after the <code>showLocationList(segue:)</code> method to set the <code>RestaurantListViewController</code> <a id="_idTextAnchor285"/><a id="_idTextAnchor286"/><a id="_idTextAnchor287"/>instance's <code>selectedCuisine</code> and <code>selectedCity</code> properties:<pre>func showRestaurantList(segue: UIStoryboardSegue) {
   if let viewController = segue.destination as? 
   RestaurantListViewController, let city = 
   selectedCity, let index = 
   collectionView.indexPathsForSelectedItems?.first?
   .row {
      viewController.selectedCuisine = 
      manager.exploreItem(at: index).name
      viewController.selectedCity = city
   }
}</pre><p>You will call this method before the <code>if-let</code> statement checks to see whether the destination view controller is the <code>RestaurantListViewController</code> instance, sets <code>city</code> to the <code>selectedCity</code> value of the <code>ExploreViewController</code> instance if it is, and gets the index of the collection view cell the user tapped. If the statement is successful, the <code>RestaurantListViewController</code> instance's <code>selectedCuisine</code> property is set to the <code>name</code> of the <code>ExploreItem</code> instance located at that index in the <code>items</code> array. In the next line, the <code>RestaurantListViewController</code> instance's <code>selectedCity</code> property will be assigned the value stored in <code>city</code>.</p></li>
			</ol>
			<p>For this method <a id="_idIndexMarker934"/>to work, the <code>selectedCity</code> property of the <code>ExploreViewController</code> instance has to be set first before transitioning to the <strong class="bold">Restaurant Detail</strong> screen. You will alert the user to set the city before choosing a cuisine. Follow these steps:</p>
			<ol>
				<li value="1">Click the <code>ExploreViewController</code> file in the Project navigator. Add the following m<a id="_idTextAnchor288"/><a id="_idTextAnchor289"/>ethod before <code>unwindLocationCancel()</code> to display an alert:<pre>func showLocationRequiredAlert() {
   let alertController = UIAlertController(title: 
   "Location Needed", message: "Please select a 
   location.", preferredStyle: .alert)
   let okAction = UIAlertAction(title: "OK", style: 
   .default, handler: nil)
   alertController.addAction(okAction)
   present(alertController, animated: true, 
   completion: nil)
}</pre><p>The <code>showLocationRequiredAlert()</code> method creates a <code>UIAlertController</code> instance with the title set to <code>"Location Needed"</code> and a message, <code>"Please select a location."</code>. A <code>UIAlertAction</code> instance with an OK button is then added to the <code>UIAlertController</code> instance. Finally, the alert is presented to the user, and tapping the OK button dismisses it.</p></li>
				<li>Add the following code after <code>viewDidLoad()</code> to display this alert if a location has not <a id="_idIndexMarker935"/>been selected:<pre>override func shouldPerformSegue(withIdentifier 
identifier: String, sender: Any?) -&gt; Bool {
   if identifier == Segue.restaurantList.rawValue, 
   selectedCity == nil {
      showLocationRequiredAlert()
      return false
   }
   return true
}</pre><p>The <code>shouldPerformSegue(withIdentifier:sender:)</code> method is used to check whether the <code>restaurantList</code> and if the <code>selectedCity</code> is set; if not, the <code>showLocationRequiredAlert()</code> method is called and <code>shouldPerformSegue(withIdentifier:sender:)</code> returns <code>false</code>. Otherwise, <code>shouldPerformSegue(withIdentifier:sender:)</code> returns <code>true</code>, and the <strong class="bold">Restaurant List</strong> screen appears.</p></li>
			</ol>
			<p>Now that you've created the <code>showLocationList(segue:)</code> and the <code>showRestaurantList(segue:)</code> methods, you'll add code to implement the <code>prepare(for:sender:)</code> method after <code>viewDidLoad()</code> and before <code>shouldPerformSegue(withIdentifier:)</code>. This method calls <code>showLocationList(segue:)</code> or <code>showRestaurantList(segue:)</code> depending on the segue<a id="_idIndexMarker936"/> that will be executed:</p>
			<pre>override func prepare(for segue: UIStoryboardSegue, sender: Any?) {
   switch segue.identifier! {
   case Segue.locationList.rawValue:
     showLocationList(segue: segue)
   case Segue.restaurantList.rawValue:
     showRestaurantList(segue: segue)
   default:
      print("Segue not added")
   }
}</pre>
			<p>When the <code>locationList</code>, so the <code>showLocationList(segue:)</code> method is executed before the transition to the <code>restaurantList</code>, so the <code>showRestaurantListing(segue:)</code> method is executed before the transition to the <code>selectedType</code> and <code>selectedCity</code> properties in the <code>RestaurantListViewController</code> instance, which will be printed to the Debug area.</p>
			<p>Build and run your project. If you try to select a cuisine, you'll see this alert, stating you need to select a location:</p>
			<div><div><img src="img/Figure_17.14_B17469.jpg" alt="Figure 17.14: iOS Simulator showing alert&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.14: iOS Simulator showing alert</p>
			<p>If you pick a<a id="_idIndexMarker937"/> location, tap <strong class="bold">Done</strong>, and tap the <strong class="bold">LOCATION</strong> button again the location you selected earlier should still be selected:</p>
			<div><div><img src="img/Figure_17.15_B17469.jpg" alt="Figure 17.15: iOS simulator showing Locations screen with checkmark&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.15: iOS simulator showing Locations screen with checkmark</p>
			<p>If you pick a <a id="_idIndexMarker938"/>cuisine, you'll see the <strong class="bold">Restaurant List</strong> screen:</p>
			<div><div><img src="img/Figure_17.16_B17469.jpg" alt="Figure 17.16: iOS Simulator showing Restaurant List screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.16: iOS Simulator showing Restaurant List screen</p>
			<p>The location<a id="_idIndexMarker939"/> and cuisine you picked will appear in the Debug area:</p>
			<div><div><img src="img/Figure_17.17_B17469.jpg" alt="Figure 17.17: Debug area showing location and cuisine you selected&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.17: Debug area showing location and cuisine you selected</p>
			<p>Now that the <code>RestaurantListViewController</code> instance has a location, you can get the restaurant data for that location from the <code>RestaurantDataManager</code> instance. Click the <code>RestaurantListViewController</code> file in the Project navigator and update <code>viewDidAppear()</code> as follows. This prints the list of restaurants from the selected <a id="_idIndexMarker940"/>location that serves the selected cuisine:</p>
			<pre>override func viewDidAppear(_ animated: Bool) {
   super.viewDidAppear(animated)
<strong class="bold">   guard let city = selectedCity?.city, let cuisine = </strong>
<strong class="bold">   selectedCuisine else { </strong>
<strong class="bold">      return </strong>
<strong class="bold">   }</strong>
<strong class="bold">   let manager = RestaurantDataManager()</strong>
<strong class="bold">   manager.fetch(location: city, selectedCuisine: cuisine) {</strong>
<strong class="bold">      restaurantItems in if !restaurantItems.isEmpty {</strong>
<strong class="bold">         for restaurantItem in restaurantItems {</strong>
<strong class="bold">            if let restaurantName = restaurantItem.name {</strong>
<strong class="bold">               print(restaurantName)</strong>
<strong class="bold">            }</strong>
<strong class="bold">         }</strong>
<strong class="bold">      } else {</strong>
<strong class="bold">         print("No data")</strong>
<strong class="bold">      }</strong>
<strong class="bold">   }</strong>
}</pre>
			<p>The <code>guard</code> statement checks to see if <code>city</code> and <code>cuisine</code> have been assigned values successfully, and returns if they have not. Next, an instance of <code>RestaurantDataManager</code> is created and assigned to <code>manager</code>. The <code>fetch(location:selectedCuisine:completion:)</code> method returns an array of <code>RestaurantItem</code> instances for the selected <code>city</code> and <code>cuisine</code>, and the <code>for</code> loop prints the restaurant names to the Debug area. If there are no restaurants matching the criteria, <code>No data</code> will be printed to the Debug area. Build and run your project, select a city, tap a cuisine, and note the results in the Debug area. </p>
			<p>You can also see the results in the Report navigator. Click the Report navigator button and select<a id="_idIndexMarker941"/> the first entry as shown:</p>
			<div><div><img src="img/Figure_17.18_B17469.jpg" alt="Figure 17.18: Report navigator showing list of restaurant names&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.18: Report navigator showing list of restaurant names</p>
			<p>You'll see either a list of restaurants or <code>No data</code> in the Editor area.</p>
			<p>So, at this point, the <code>RestaurantListViewController</code> instance is successfully getting the data that it needs to display the list of restaurants. Now that you have this data, you need to configure the collection view to display it to the user. To do that, you will need to create a view controller for the collection view cells, and configure the <code>RestaurantListViewController</code> instance to populate them. You will do this in the next section.</p>
			<h2 id="_idParaDest-256"><a id="_idTextAnchor290"/>Creating a view controller for the cells on the Restaurant List screen</h2>
			<p>At present <a id="_idIndexMarker942"/>the <code>RestaurantCell</code> class for this purpose. Follow these steps:</p>
			<ol>
				<li value="1">Right-click the <code>Restaurants</code> folder and choose <code>View</code>.</li>
				<li>Right-click the <code>View</code> folder and select <strong class="bold">New File</strong>.</li>
				<li><strong class="bold">iOS</strong> should already be selected. Choose <strong class="bold">Cocoa Touch Class</strong> and then click <strong class="bold">Next</strong>.</li>
				<li>Configure <a id="_idIndexMarker943"/>the file as follows:<p><code>RestaurantCell</code></p><p><code>UICollectionViewCell </code></p><p><code>Swift</code></p><p>Click <strong class="bold">Next</strong>.</p></li>
				<li>Click <code>RestaurantCell</code> file appears in the Project navigator. It contains the implementation of the <code>RestaurantCell</code> class:<pre>import UIKit
class RestaurantCell: UICollectionViewCell {
}</pre></li>
			</ol>
			<p>Now let's create the outlets for the collection view cell in the <code>RestaurantCell</code> class. You will do this in the next section.</p>
			<h2 id="_idParaDest-257"><a id="_idTextAnchor291"/>Connecting the outlets for the RestaurantCell class</h2>
			<p>Now that you've <a id="_idIndexMarker944"/>created the <code>RestaurantCell</code> class, you'll need to create outlets in it and link them to the UI elements inside the collection view cells for the <code>RestaurantCell</code> instances to manage what is displayed by the collection view cell. Follow these steps:</p>
			<ol>
				<li value="1">Click the <code>Main</code> storyboard file. Click <code>restaurantCell</code> in the <code>RestaurantCell</code>:<div><img src="img/Figure_17.19_B17469.jpg" alt="Figure 17.19: Identity inspector Class settings for restaurantCell&#13;&#10;"/></div><p class="figure-caption">Figure 17.19: Identity inspector Class settings for restaurantCell</p></li>
				<li>In <code>RestaurantCell.swift</code>) to be displayed in the assistant editor when the Adjust Editor Options button is clicked: <div><img src="img/Figure_17.20_B17469.jpg" alt="Figure 17.20: Document outline with Available Times label selected&#13;&#10;"/></div><p class="figure-caption">Figure 17.20: Document outline with Available Times label selected</p></li>
				<li>Click the<a id="_idIndexMarker946"/> Adjust Editor Options button and choose <strong class="bold">Assistant</strong> from the menu.</li>
				<li>The assistant editor appears. The path bar at the top should show <code>RestaurantCell</code> file:<div><img src="img/Figure_17.21_B17469.jpg" alt="Figure 17.21: Assistant editor showing RestaurantCell.swift&#13;&#10;"/></div><p class="figure-caption">Figure 17.21: Assistant editor showing RestaurantCell.swift</p></li>
				<li>In the box that appears, type <code>titleLabel</code> in the <strong class="bold">Name</strong> field and click <strong class="bold">Connect</strong>:<div><img src="img/Figure_17.22_B17469.jpg" alt="Figure 17.22: Dialog box showing label Name set to titleLabel&#13;&#10;"/></div><p class="figure-caption">Figure 17.22: Dialog box showing label Name set to titleLabel</p></li>
				<li><em class="italic">Ctrl + Drag</em> from the subtitle <code>titleLabel</code> property you just <a id="_idIndexMarker947"/>created. In the box that appears, type <code>cuisineLabel</code> in the <strong class="bold">Name</strong> field and click <strong class="bold">Connect</strong>:<div><img src="img/Figure_17.23_B17469.jpg" alt="Figure 17.23: Dialog box showing label Name set to cuisineLabel&#13;&#10;"/></div><p class="figure-caption">Figure 17.23: Dialog box showing label Name set to cuisineLabel</p></li>
				<li><em class="italic">Ctrl + Drag</em> from the <code>american</code> image view to just after the other properties you created. In the box that appears, type <code>restaurantImageView</code> in the <strong class="bold">Name</strong> field and click <strong class="bold">Connect</strong>:<div><img src="img/Figure_17.24_B17469.jpg" alt="Figure 17.24: Dialog box showing image view Name set to restaurantImageView&#13;&#10;"/></div><p class="figure-caption">Figure 17.24: Dialog box showing image view Name set to restaurantImageView</p></li>
				<li>Click the <strong class="bold">x</strong> button to close the assistant editor.</li>
			</ol>
			<p>The outlets for the <code>RestaurantCell</code> class are now connected to the UI elements in the collection view cell. Later you'll configure the <code>RestaurantListViewController</code> instance to populate this collection view, but before you<a id="_idIndexMarker948"/> do, there is a possibility to consider. The user's choices for location and cuisine may not return any results, so you will implement a screen that informs the user when there is no data to be displayed. You'll do this in the next section.</p>
			<h2 id="_idParaDest-258"><a id="_idTextAnchor292"/>Displaying a custom UIView to indicate no data is available</h2>
			<p>The location <a id="_idIndexMarker949"/>and cuisine choices the user makes on the <code>UIView</code> subclass and an accompanying <strong class="bold">XIB</strong> file. XIB stands for <strong class="bold">Xcode Interface Builder</strong> and XIB files were used to create the user interface before storyboards were implemented. Let's create both files now by following these steps:</p>
			<ol>
				<li value="1">Right-click on the <code>Misc</code> folder and select <code>No Data</code>.</li>
				<li>Right-click on the <code>No Data</code> folder and choose <strong class="bold">New File</strong>.</li>
				<li><strong class="bold">iOS</strong> should already be selected. Choose <strong class="bold">Cocoa Touch Class</strong> and then click <strong class="bold">Next</strong>.</li>
				<li>Configure the file as follows:<p><code>NoDataView</code></p><p><code>UIView</code></p><p><code>Swift</code></p><p>Click <strong class="bold">Next</strong>.</p></li>
				<li>Click <code>NoDataView</code> file <a id="_idIndexMarker950"/>appears in the Project navigator.</li>
				<li>Right-click on the <code>No Data</code> folder and create a new file.</li>
				<li><strong class="bold">iOS</strong> should already be selected. Choose <strong class="bold">View</strong> and then click <strong class="bold">Next</strong>.</li>
				<li>Name this file <code>NoDataView</code>. Click <code>NoDataView</code> XIB file appears in the Project navigator.</li>
				<li>Click the <code>NoDataView</code> file in the Project navi<a id="_idTextAnchor293"/><a id="_idTextAnchor294"/>gator and declare and define the <code>NoDataView</code> class as follows:<pre>class NoDataView: UIView {
   var view: UIView!
   @IBOutlet var titleLabel: UILabel!
   @IBOutlet var descLabel: UILabel!
   override init(frame: CGRect) { 
      super.init(frame: frame) 
      setupView()
   }
   required init?(coder: NSCoder) { 
      super.init(coder: coder)
      setupView()
   }
   func loadViewFromNib() -&gt; UIView {
      let nib = UINib(nibName: "NoDataView", bundle: 
      Bundle.main)
      let view = nib.instantiate(withOwner: self, 
      options: nil) [0] as! UIView 
      return view
   }
   func setupView() {
      view = loadViewFromNib()
      view.frame = bounds
      view.autoresizingMask = [.flexibleWidth, 
      .flexibleHeight]
      addSubview(view)
   }
   func set(title: String, desc: String) {
      titleLabel.text = title
      descLabel.text = desc
   }
}</pre></li>
			</ol>
			<p>This class is a subclass of the <code>UIView</code> class, and it will manage the view in the <code>NoDataView</code> XIB file. Let's break this down:</p>
			<pre>var view: UIView!
@IBOutlet var titleLabel: UILabel!
@IBOutlet var descLabel: UILabel!</pre>
			<p><code>view</code> will be assigned the view from the <code>NoDataView</code> XIB file during initialization.</p>
			<p><code>titleLabel</code> and <code>descLabel</code> will be assigned to two <code>UILabel</code> instances that will be placed <a id="_idIndexMarker951"/>in the <code>NoDataView</code> XIB file when you build the user interface in the next section.</p>
			<pre>override init(frame: CGRect) { 
   super.init(frame:frame) 
   setupView()
}
required init?(coder: NSCoder) { 
   super.init(coder: coder)
   setupView()
}</pre>
			<p>The <code>NoDataView</code> class is a subclass of <code>UIView</code>. A <code>UIView</code> object has two <code>init</code> methods: the first handles view creation programmatically, and the second handles the loading of XIB files from the app bundle stored on the device. Here, both methods will call <code>setupView()</code>.</p>
			<pre>func loadViewFromNib() -&gt; UIView {
   let nib = UINib(nibName: "NoDataView", bundle: 
   Bundle.main)
   let view = nib.instantiate(withOwner: self, 
   options: nil) [0] as! UIView
   return view
}</pre>
			<p>This method finds and loads the <code>NoDataView</code> XIB file from the app bundle and returns a <code>UIView</code> instance stored inside it.</p>
			<pre>func setupView() {
   view = loadViewFromNib()
   view.frame = bounds
   view.autoresizingMask = [.flexibleWidth, .flexibleHeight]
   addSubview(view)
}</pre>
			<p>This method calls <code>loadViewFromNib()</code>, configures the view so it is the same size as the device<a id="_idIndexMarker952"/> screen, makes the width and height of the view flexible to adapt to size and orientation changes, and adds it to the device view hierarchy so it is visible onscreen.</p>
			<pre>func set(title: String, desc: String) {
   titleLabel.text = title
   descLabel.text = desc
}</pre>
			<p>This method sets the text of the <code>titleLabel</code> and <code>descLabel</code> properties. </p>
			<p>Now let's set up the <code>NoDataView</code> XIB file. You may want to refer to <a href="B17469_12_Final_VK_ePub.xhtml#_idTextAnchor182"><em class="italic">Chapter 12</em></a><em class="italic">, Modifying and Configuring Cells</em>, which covers using the Size inspector and the Auto Layout constraint menus in more detail. Follow these steps:</p>
			<ol>
				<li value="1">Click the <code>NoDataView</code> XIB file in the Project navigator.</li>
				<li>Select <code>NoDataView</code> and press <em class="italic">Return</em>.</li>
				<li>Click the Library button to display the library. Type <code>label</code> in the filter field. A <strong class="bold">Label</strong> object appears in the results.</li>
				<li>Drag two <strong class="bold">Label</strong> objects into the <strong class="bold">View</strong>, with one <strong class="bold">Label</strong> object above the other.</li>
				<li>Select the top label to represent the title. In the Attributes inspector, update the following values:<p><code>TITLE GOES HERE</code> to the text field under the <code>Default (Label Color)</code></p><p><code>Center</code></p><p><code>System Bold 26.0</code></p></li>
				<li>With the <a id="_idIndexMarker953"/>same label selected, update the following values in the Size inspector:<p><code>335</code></p><p><code>36</code></p></li>
				<li>Select the bottom label. This will represent the description. In the Attributes inspector, update the following values:<p><code>Description goes here</code> to the text field under the <code>Default (Label Color)</code></p><p><code>Center</code></p><p><code>System Thin 17.0</code></p></li>
				<li>In the Size inspector, update the following values:<p><code>335</code></p><p><code>21</code></p></li>
				<li>Select both labels by clicking the first label and holding down the <em class="italic">Shift</em> key while selecting the second label. </li>
				<li>With both labels still selected, click the <strong class="bold">Editor</strong> menu and choose <strong class="bold">Embed In </strong>|<strong class="bold"> Stack View</strong>.</li>
				<li>Select the <code>Vertical</code></p><p><code>Center</code></p><p><code>8</code></p></li>
				<li>With the <code>10</code></p><p><code>10</code></p><p>Click the <strong class="bold">Add 2 constraints</strong> button.</p></li>
				<li>With the <strong class="bold">Stack View</strong> still selected, click the Align button. Set the following values:<p><strong class="bold">Horizontally in Container</strong> (ticked) </p><p><strong class="bold">Vertically in Container</strong> (ticked) </p><p>Click the <strong class="bold">Add 2 Constraints</strong> button.</p></li>
				<li>Select <strong class="bold">File's Owner</strong> in the document outline.</li>
				<li>Open the Connections inspector and connect <code>titleLabel</code> to the label that says <code>TITLE GOES HERE</code>.</li>
				<li>Connect <code>descLabel</code> to the other label.</li>
			</ol>
			<p>When you are done, you should see the following:</p>
			<div><div><img src="img/Figure_17.25_B17469.jpg" alt="Figure 17.25: Editor area showing NoDataView XIB file contents&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.25: Editor area showing NoDataView XIB file contents</p>
			<p>You have completed configuring <code>NoDataView.xib</code>. Now, let's put it all together so that the <code>NoDataView</code> if there aren't any restaurants offering the <a id="_idIndexMarker955"/>selected cuisine at a particular location. You will do this in the next section.</p>
			<h2 id="_idParaDest-259"><a id="_idTextAnchor295"/>Displaying a list of restaurants on the Restaurant List screen</h2>
			<p>You now have <a id="_idIndexMarker956"/>everything you need to display a list of restaurants based on the selected location and cuisine on the <strong class="bold">Restaurant List</strong> screen. So, now it's time to put it all together. Follow these steps:</p>
			<ol>
				<li value="1">Click the <code>RestaurantListViewController</code> file in the Project navigator. Before the <code>selectedRestaurant</code> property, add the following to create an instance of <code>RestaurantDataManager</code> and assign it to a <code>manager</code> property:<pre><strong class="bold">private let manager = RestaurantDataManager()</strong>
var selectedRestaurant: RestaurantItem?</pre></li>
				<li>Add the following method inside the <code>private</code> extension to populate <code>manager</code>'s <code>items</code> array and to set the background view for the <code>selectedCity</code> and <code>selectedCuisine</code> properties are set; if they are, assign <code>selectedCity</code> to <code>city</code> and <code>selectedCuisine</code> to <code>cuisine</code>. Otherwise, exit the method.</p><pre>manager.fetch(location: city, selectedCuisine: cuisine)</pre><p>Calls the <code>fetch(location:selectedCuisine:completion:)</code> method of the <code>RestaurantDataManager</code> instance, which loads the appropriate <code>RestaurantItem</code> instances<a id="_idIndexMarker958"/> into its <code>restaurantItems</code> array.</p><pre>{ restaurantItems in
   if !restaurantItems.isEmpty {
      collectionView.backgroundView = nil
   } else {
      let view = NoDataView(frame: CGRect(x: 0, y: 0, 
      width: collectionView.frame.width, height: 
      collectionView.frame.height))
      view.set(title: "Restaurants", desc: 
      "No restaurants found.") 
      collectionView.backgroundView = view
   }</pre><p>If the <code>restaurantItems</code> array of the <code>RestaurantDataManager</code> instance is not empty, set <code>backgroundView</code> of the <code>collectionView</code> instance to <code>nil</code>. Otherwise, create an instance of <code>NoDataView</code>, set its title and description, and set it as the <code>backgroundView</code> property of the <code>collectionView</code> instance.</p><pre>collectionView.reloadData()</pre><p>Tells <code>collectionView</code> to refresh its view.</p></li>
				<li>Update <code>collectionView(_:cellForItemAt:)</code> as follows to set the <code>RestaurantCell</code> instance's<a id="_idIndexMarker959"/> properties:<pre>func collectionView(_ collectionView: 
UICollectionView, cellForItemAt indexPath: IndexPath) 
-&gt; UICollectionViewCell {
   <code>RestaurantItem</code> instance from the <code>restaurantItems</code> array of the <code>RestaurantDataManager</code> instance corresponding to the <code>RestaurantCell</code> instance's position.</p><pre>cell.titleLabel.text = restaurantItem.name</pre><p>This sets the text of the <code>RestaurantCell</code> instance's <code>titleLabel</code> to the value of<a id="_idIndexMarker960"/> the <code>RestaurantItem</code> instance's <code>name</code>.</p><pre>if let cuisine = restaurantItem.subtitle { 
   cell.cuisineLabel.text = cuisine
}</pre><p>This sets the text of the <code>RestaurantCell</code> instance's <code>cuisineLabel</code> to the value of the <code>RestaurantItem</code> instance's <code>subtitle</code>.</p><pre>if let imageURL = restaurantItem.imageURL {
   if let url = URL(string: imageURL) {
      let data = try? Data(contentsOf: url) 
      if let imageData = data {
         DispatchQueue.main.async {
            cell.restaurantImageView.image =
            UIImage(data: imageData)
         }
      }
   }
}</pre><p>This downloads the picture of the restaurant from the URL specified in the <code>RestaurantItem</code> instance's <code>imageURL</code> and assigns it to the <code>image</code> property of the <code>RestaurantCell</code> instance's <code>imgRestaurant</code> property.</p><pre>   return cell
}</pre><p>Returns <a id="_idIndexMarker961"/>the collection view cell.</p><p class="callout-heading">Important Information</p><p class="callout">You will notice that scrolling is jerky, and if there is no internet connection, the <strong class="bold">Restaurant List</strong> screen will be blank. This is because downloading images from the internet takes time, and is interrupting the rendering of the collection view. These issues will be fixed in <a href="B17469_24_Final_VK_ePub.xhtml#_idTextAnchor469"><em class="italic">Chapter 24</em></a><em class="italic">, Swift Concurrency</em>.</p></li>
				<li>Update <code>collectionView(_:numberOfItemsInSection:)</code> as follows to get the number of collection views to be displayed from <code>manager</code>:<pre>func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -&gt; Int {
   <strong class="bold">manager.numberOfRestaurantItems()</strong>
}</pre></li>
				<li>Update <code>viewDidAppear()</code> as follows to call <code>createData()</code> when the collection view appears onscreen:<pre>override func viewDidAppear(animated: Bool) {
   super.viewDidAppear(animated)
   <strong class="bold">createData()</strong>
}</pre></li>
			</ol>
			<p>Build and run your app. Set a location and click a cuisine. If there are restaurants that match the selected criteria, you'll see them displayed in the <code>NoDataView</code> instance<a id="_idIndexMarker962"/> will be displayed.</p>
			<div><div><img src="img/Figure_17.26_B17469.jpg" alt="Figure 17.26: iOS simulator showing Restaurant List screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.26: iOS simulator showing Restaurant List screen</p>
			<p>Before you finish with the <code>RestaurantListViewController</code> class, there is just one more thing. It would be nice if the selected city were shown in the <strong class="bold">Restaurant List</strong> screen. Let's add code to display it at the top of the <strong class="bold">Restaurant List</strong> screen's navigation bar using large titles. Follow these steps:</p>
			<ol>
				<li value="1">In the <code>RestaurantListViewController</code> file, add the following method into the <code>private</code> extension<a id="_idTextAnchor296"/><a id="_idTextAnchor297"/> after <code>createData()</code> to display the selected city in the navigation bar:<pre>func setupTitle() {
   navigationController?.setNavigationBarHidden(
   false, animated: false)
   title = selectedCity?.cityAndState.uppercased()
   navigationController?.navigationBar.
   prefersLargeTitles = true
}</pre><p>Every <code>UIViewController</code> instance has a <code>title</code> property, and if the navigation<a id="_idIndexMarker963"/> bar is visible, <code>title</code> will be visible as well. This method shows the navigation bar and sets the <code>RestaurantListViewController</code> instance's <code>title</code> to a string containing the city and state names in uppercase.</p></li>
				<li>Call <code>setupTitle()</code> after <code>createData()</code> in the <code>viewDidLoad()</code> method:<pre>override func viewDidLoad(_ animated: Bool){
   super.viewDidLoad(animated)
   createData()
   <code>setupTitle()</code> method when the <strong class="bold">Restaurant List</strong> screen appears.</p></li>
			</ol>
			<p>Build and run your app. Select a location and cuisine. You should see the city and state in uppercase letters at the top of the <strong class="bold">Restaurant List</strong> screen:</p>
			<div><div><img src="img/Figure_17.27_B17469.jpg" alt="Figure 17.27: iOS Simulator showing Restaurant List screen with title&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.27: iOS Simulator showing Restaurant List screen with title</p>
			<p>You have<a id="_idIndexMarker964"/> completed the implementation of the <strong class="bold">Restaurant List</strong> screen, and you have finally reached the end of this chapter. Good job!</p>
			<h1 id="_idParaDest-260"><a id="_idTextAnchor298"/>Summary</h1>
			<p>You have accomplished a lot in this chapter. You started by learning about the JSON format, and you created the <code>RestaurantDataManager</code> class, a data manager class that can load data from JSON files. You configured the <code>MapViewController</code> class to get data from a <code>RestaurantDataManager</code> instance to display a list of restaurants on the <code>LocationViewController</code> class to store the location selected by the user and pass it to an <code>ExploreViewController</code> instance when the <code>ExploreViewController</code> class to pass the selected location and cuisine to the <code>RestaurantListViewController</code> instance when a type of cuisine is selected. Finally, you configured the <code>RestaurantListViewController</code> class to get a list of restaurants from the <code>RestaurantDataManager</code> instance, and display them in the <code>NoDataView</code> class and view, which is displayed if there are no restaurants at a particular location offering the selected cuisine.  </p>
			<p>You are now able to load and read data from JSON files and pass that data between different view controllers in your app for display in collection views and map views. You also learned how to use <code>UITableViewController</code> delegate methods to handle user interaction with table views. This will be useful when you're creating your own apps.</p>
			<p>In the next chapter, you'll implement the <strong class="bold">Restaurant Detail</strong> screen, which displays details of a specific restaurant using a table view containing static cells.</p>
		</div>
	</body></html>