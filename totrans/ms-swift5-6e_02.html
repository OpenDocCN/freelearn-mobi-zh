<html><head></head><body>
  <div><h1 class="chapterNumber">2</h1>
    <h1 id="_idParaDest-30" class="chapterTitle">Swift Documentation and Installing Swift</h1>
    <p class="normal">I spent a lot of my career working as a Linux System Administrator and Network Security Administrator. These positions required me to compile and install packages from source. There are a lot of advantages to building packages from source rather than downloading prebuilt binaries. The biggest advantage, in my opinion, is that you can get the latest version without having to wait for someone else to build it. This allows me to patch my systems with the latest security updates without delay. With Swift, we are also able to download the latest code and compile ourselves without having to wait for someone else to build it.</p>
    <p class="normal">In this chapter, you will learn:</p>
    <ul>
      <li class="bullet">About the swift.org website and what it offers</li>
      <li class="bullet">How to find the latest documentation on Swift</li>
      <li class="bullet">Ways to install Swift</li>
      <li class="bullet">How to build Swift from source with its full toolchain and package manager</li>
    </ul>
    <p class="normal">In the previous chapter, we mentioned that Apple has released Swift as an open source project with the <a href="http://swift.org">swift.org</a> site dedicated to the Swift community. This means we can download the source code for the Swift language, examine it, and build Swift ourselves. Before we really dive into the Swift language and develop with it, let's look at how we can build Swift from source and the resources that Apple has made available to us. We will start by looking at the <a href="http://swift.org">swift.org</a> site.</p>
    <h1 id="_idParaDest-31" class="title">Swift.org</h1>
    <p class="normal">On December 3, 2015, Apple <a id="_idIndexMarker062"/>officially released the Swift language, supporting libraries, the debugger, and the package manager to the open source community under the Apache 2.0 license. At that time, the <a href="http://swift.org">swift.org</a> site was created as the community's gateway to the project. This site has a wealth of information and should be your primary site to find out what is happening in the Swift community and the language itself. The blog posts will keep you up to date with new releases of Swift, new Swift open source libraries, changes to the standard library, and other Swift news.</p>
    <p class="normal">You can also download pre-built binaries for several flavors of Linux. At the time this book is being written, we can download pre-built binaries for Ubuntu 16.04, Ubuntu 18.04, Ubuntu 20.04, CentOS 8, and Amazon Linux 2. The getting started page provides a list of dependencies for the previously mentioned flavors of Linux and instructions on how to install the binaries.</p>
    <p class="normal">The website also includes the official Swift documentation, which includes things like the language guide, a Swift introduction, and an API design guideline. Understanding the API design guideline is essential to ensuring that your code meets the recommended coding standards. In <em class="chapterRef">Chapter 18</em>, <em class="italic">Swift Formatting and Style Guide</em>, we provide recommendations for coding standards in Swift, which go hand in hand with Apple's recommendations.</p>
    <p class="normal">You will <a id="_idIndexMarker063"/>also find information on how to contribute to the Swift community, where the Swift source code can be downloaded, and there is even a section on recommended Google Summer of Code projects with Swift. If you really want to get into Swift development, whether it be server-side, Mac, or iOS development, I would recommend making regular visits to the <a href="http://swift.org">swift.org</a> site to keep up to date with what is happening in the Swift community.</p>
    <p class="normal">Apple and the Swift community also have a number of documentation resources that you can use for reference.</p>
    <h1 id="_idParaDest-32" class="title">Swift documentation</h1>
    <p class="normal">Apple and the Swift community, as a whole, have released a number of resources to help developers <a id="_idIndexMarker064"/>program in Swift. Apple's official documentation, which can be found at <a href="https://developer.apple.com/documentation/">https://developer.apple.com/documentation/</a>, includes API documentation for Swift as well as all of Apple's frameworks. Only a small portion of Apple's frameworks are open source and work across all platforms; however if you are looking to get started on one of Apple's frameworks this is definitely the place to start. However it can be hard to find documentation on specific Swift APIs.</p>
    <p class="normal">To quickly <a id="_idIndexMarker065"/>find documentation on Swift's API, my favorite site is <a href="https://swiftdoc.org">https://swiftdoc.org</a>. This site is incredibly easy to navigate and has autogenerated documentation for all types, protocols, operators, and global functions that make up the Swift language. I have noticed that this site does not always stay up to date; however, it is a great reference for any Swift developer. The code that generates this site is open source as well and can be found on GitHub here: <a href="https://github.com/SwiftDocOrg/swift-doc">https://github.com/SwiftDocOrg/swift-doc</a>. The GitHub page gives directions on how you can generate your own offline documentation.</p>
    <p class="normal">The final site <a id="_idIndexMarker066"/>that I am going to mention here is one that I recently discovered on one of my favorite Swift sites. It is the Swift knowledge base on the Hacking <a id="_idIndexMarker067"/>with Swift site located here: <a href="https://www.hackingwithswift.com/example-code/">https://www.hackingwithswift.com/example-code/</a>. Once you learn Swift and need to know how to do something like parsing JSON, extracting a PDF, or any other specific function, there is a good chance you can find what you need here.</p>
    <p class="normal">Now that we know where to look for documentation on Swift, let's see the different ways that we can install Swift.</p>
    <h1 id="_idParaDest-33" class="title">Installing Swift from swift.org</h1>
    <p class="normal">If you are developing on and for the Apple platform, I strongly suggest that you stick with the <a id="_idIndexMarker068"/>version of Swift that comes with Xcode. Apple will not approve an app that was compiled using a version of Swift that is different <a id="_idIndexMarker069"/>than the one that came with the version of Xcode that you are using. This may seem a little extreme, but it ensures that the apps are compiled with a stable version of Swift and one that has been fully vetted to work with your version of Xcode.</p>
    <p class="normal">If you are using one of the flavors of Linux that has pre-built binaries on the <a href="http://swift.org">swift.org</a> site, it is recommended that you use those. They are the easiest and quickest path to getting Swift up and running. You can also find complete installation instructions with a list of dependencies on the <a href="http://swift.org">swift.org</a> site under the <em class="italic">Getting Started</em> section.</p>
    <p class="normal">If pre-built binaries are not provided for your flavor of Linux, if you want to try the latest version of Swift, or if you just want to see what it is like to build Swift from source, you can do that as well.</p>
    <h1 id="_idParaDest-34" class="title">Building Swift and the Swift toolchain from source</h1>
    <p class="normal">There are <a id="_idIndexMarker070"/>a number of sites that show you how to build <a id="_idIndexMarker071"/>Swift from source, but unfortunately most of these sites give directions for building just the Swift language itself without the toolchain. I find that not very useful, unless you are only writing very simple applications. In my opinion, building Swift for Linux without the entire toolchain and the package manager is more of an exercise of <em class="italic">"Can I do it"</em> rather than building something you can use long term.</p>
    <div><p class="Information-Box--PACKT-">While using the latest build of Swift is not recommended for production systems, it does enable us to use the latest features of the language and also verify that changes introduced in our application are compatible with future versions of the Swift language.</p>
    </div>
    <p class="normal">In this chapter, we will look at how we can build Swift, its entire toolchain, and the Swift package manager from source. Since each flavor of Linux and macOS are somewhat different, I need to pick one platform to write these instructions on; therefore I am using Ubuntu 18.04 and the current Swift 5.3 development release at the time of writing this book. For other <a id="_idIndexMarker072"/>flavors or versions of Linux, you may have to <a id="_idIndexMarker073"/>make changes to the dependencies that are installed or how they are installed. The command to build Swift itself will be the same across all platforms.</p>
    <div><p class="Information-Box--PACKT-">Some of these commands can be quite large to type. All of the commands are in text files that you can cut and paste from in the downloadable code for this book.</p>
    </div>
    <p class="normal">Now let's start building Swift by installing the dependencies.</p>
    <h2 id="_idParaDest-35" class="title">Installing dependencies</h2>
    <p class="normal">The first thing we need to do is to make sure we have all of the dependencies required. The following <a id="_idIndexMarker074"/>command includes dependencies I have needed to install on different flavors of Linux. </p>
    <p class="normal">You may find that your distribution already has some of these preinstalled but to make sure you have everything, run the following command:</p>
    <pre class="programlisting con"><code class="hljs-con">sudo apt-get install git cmake ninja-build clang python uuid-dev libicu-dev icu-devtools libedit-dev libxml2-dev libsqlite3-dev swig libpython-dev python-six libncurses5-dev pkg-config libcurl4-openssl-dev systemtap-sdt-dev tzdata rsync 
</code></pre>
    <p class="normal">One thing to note is dependencies can change and if you attempt to compile from source and you receive an error that something is missing, add it with the <code class="Code-In-Text--PACKT-">apt-get install</code> command or the package manager on your system. Now that we have all of the dependencies installed, we need to download the Swift source code.</p>
    <h2 id="_idParaDest-36" class="title">Swift source</h2>
    <p class="normal">To download the Swift source code, we will want to create a new directory that we can download <a id="_idIndexMarker075"/>the code to, change to that directory, and then run the <code class="Code-In-Text--PACKT-">git</code> command to retrieve the source. The following commands will download the Swift source <a id="_idIndexMarker076"/>to a directory named <code class="Code-In-Text--PACKT-">swift-source</code>:</p>
    <pre class="programlisting con"><code class="hljs-con">mkdir swift-source
cd swift-source
git clone https://github.com/apple/swift.git
./swift/utils/update-checkout --clone
</code></pre>
    <p class="normal">Now that we have the source and have cloned what we need, let's build Swift.</p>
    <h2 id="_idParaDest-37" class="title">Building Swift </h2>
    <p class="normal">Before you <a id="_idIndexMarker077"/>begin building Swift, you will need to understand that this will take hours to build depending on your system or virtual machine setup. If you are using a virtual machine, like VirtualBox, I would strongly recommend that you allocate multiple cores to your virtual machine; it will dramatically shorten the build time. The following command will build Swift, its toolchain, and the package manager:</p>
    <pre class="programlisting con"><code class="hljs-con">./swift/utils/build-script --preset=buildbot_swiftpm_linux_platform,tools=RA,stdlib=RA
</code></pre>
    <p class="normal">Once this has built everything, we need to install it somewhere and put the binaries in our path.</p>
    <h2 id="_idParaDest-38" class="title">Installing Swift</h2>
    <p class="normal">Now that we have built Swift and its toolchain, we are ready to install it. I like to install Swift under <a id="_idIndexMarker078"/>the <code class="Code-In-Text--PACKT-">/opt</code> directory, others prefer installing it under the <code class="Code-In-Text--PACKT-">/usr/local/share</code> directory. What directory you put it under is totally up to you. I will walk you through installing it under the <code class="Code-In-Text--PACKT-">/opt</code> directory, if you would like to put it someplace else then simply replace the <code class="Code-In-Text--PACKT-">/opt</code> in the paths with the directory that you wish to install it to.</p>
    <p class="normal">Let's start the installation by changing to the /opt directory and creating a new directory named <code class="Code-In-Text--PACKT-">swift</code>. We need to change the permissions for this directory so that we can read, write, and execute files. The following commands will do this:</p>
    <pre class="programlisting con"><code class="hljs-con">cd /opt
sudo mkdir swift
sudo chmod 777 swift
</code></pre>
    <p class="normal">The command <code class="Code-In-Text--PACKT-">chmod 777 swift</code> adds read, write, and execute permissions for all users of this computer. I like to use this mode because then any user on the system can use Swift; however, this can be considered a security issue because it also means anyone can modify the files. Use this at your own risk and for production systems, I would really look at who needs permissions for this directly and lock it down more.</p>
    <p class="normal">Next we need to move the Swift binaries that we built to the <code class="Code-In-Text--PACKT-">swift</code> directory. To do this we will change to the <code class="Code-In-Text--PACKT-">swift</code> directory, create a new directory for our build, change to the directory, and copy the files over. The following commands will do this:</p>
    <pre class="programlisting con"><code class="hljs-con">cd swift
mkdir swift-5.3-dev
cd swift-5.3-dev
cp -R ~/swift-source/build/buildbot_incremental/toolchain-linux-x86_64/* ./
</code></pre>
    <p class="normal">Now we want to make a symlink to this directory called <code class="Code-In-Text--PACKT-">swift-current</code>. The reason for this is it enables us to add an entry to our <code class="Code-In-Text--PACKT-">PATH</code> environmental variable so that the operating <a id="_idIndexMarker079"/>system can find the Swift executables without us needing to enter the full path. If we set up this entry using the <code class="Code-In-Text--PACKT-">swift-current</code> path rather than the <code class="Code-In-Text--PACKT-">swift.5.3-dev</code> path, it enables us, when we install new versions of Swift, to simply change where the <code class="Code-In-Text--PACKT-">swift-current</code> symlink points to and have everything work. We can do this with the following command from the <code class="Code-In-Text--PACKT-">/opt/swift</code> directory:</p>
    <pre class="programlisting con"><code class="hljs-con">sudo ln -s /opt/swift/swift-5.3-dev swift-current
</code></pre>
    <p class="normal">Now we need to create the entry in our <code class="Code-In-Text--PACKT-">PATH</code> variable. To do this we add the <code class="Code-In-Text--PACKT-">/opt/swift/swift-current/usr/bin/</code> directory to the <code class="Code-In-Text--PACKT-">PATH</code> variable in our <code class="Code-In-Text--PACKT-">.profile</code> file located in your home directory. Then update the environment. The following commands do this:</p>
    <pre class="programlisting con"><code class="hljs-con">cd ~
echo 'PATH=$PATH:/opt/swift/swift-current/usr/bin/' &gt;&gt; .profile
source ~/.profile
</code></pre>
    <p class="normal">We should now have Swift installed and ready to go. The last thing we want to do is to test our installation.</p>
    <h2 id="_idParaDest-39" class="title">Testing the installation</h2>
    <p class="normal">The last thing <a id="_idIndexMarker080"/>we need to do is to verify that Swift has been successfully installed. To do this, we can run the following command:</p>
    <pre class="programlisting con"><code class="hljs-con">swift --version
</code></pre>
    <p class="normal">The output should look something like this but with the version of Swift that you installed:</p>
    <pre class="programlisting con"><code class="hljs-con">Apple Swift version 5.3-dev (LLVM a60975d8a4, Swift afe134eb2e)
Target: x86_64-unknown-linux-gnu
</code></pre>
    <p class="normal">If the output looks similar to this, then congratulations, Swift has been successfully installed on your system. If there is an issue, and your system is unable to find the <code class="Code-In-Text--PACKT-">swift</code> command, then the issue probably lies within the path. The first thing you will want to do is to echo your <code class="Code-In-Text--PACKT-">PATH</code> variable to verify that <code class="Code-In-Text--PACKT-">/opt/swift/swift-current/usr/bin/</code> is in your path. The following command will do this:</p>
    <pre class="programlisting con"><code class="hljs-con">echo $PATH
</code></pre>
    <p class="normal">If <code class="Code-In-Text--PACKT-">/opt/swift/swift-current/usr/bin/</code> is not in your path, you can attempt to run the <code class="Code-In-Text--PACKT-">PATH=$PATH:/opt/swift/swift-current/usr/bin/</code> command manually rather than adding it to your <code class="Code-In-Text--PACKT-">.profile</code> file.</p>
    <p class="normal">Finally let's verify that the package manager was also properly installed. To do this, we want to create a <code class="Code-In-Text--PACKT-">swift-code</code> directory under your home directory and create a new package as the following commands show:</p>
    <pre class="programlisting con"><code class="hljs-con">cd ~
mkdir swift-code
cd swift-code/
mkdir test
cd test
swift package init --type=executable
</code></pre>
    <p class="normal">The output should look something like this:</p>
    <pre class="programlisting con"><code class="hljs-con">Creating executable package: test
Creating Package.swift
Creating README.md
Creating .gitignore
Creating Sources/
Creating Sources/test/main.swift
Creating Tests/
Creating Tests/LinuxMain.swift
Creating Tests/testTests/
Creating Tests/testTests/testTests.swift
Creating Tests/testTests/XCTestManifests.swift
</code></pre>
    <p class="normal">We are <a id="_idIndexMarker081"/>now ready to use Swift and the package manager.</p>
    <h1 id="_idParaDest-40" class="title">Using the Swift package manager</h1>
    <p class="normal">There is a lot that you can do with the package manager that makes it a necessity for creating complex <a id="_idIndexMarker082"/>applications on the Linux platform. It helps with adding dependencies to projects and enables us to break our code up into multiple files and create library projects. You can use the package manager on the Mac platform as well, but I do find it easier to use Xcode.</p>
    <p class="normal">For the examples in this book, we will not need to add dependencies or use multiple files. Let's see how we can simply build and run an executable project in the package manager so you can use it to run the examples from this book if you would like. Keep in mind you are able to use the package manager on the Apple platform as well. When the package manager created <code class="Code-In-Text--PACKT-">main.swift</code> in the <code class="Code-In-Text--PACKT-">Sources/test/</code> directory it added the following code to it:</p>
    <pre class="programlisting code"><code class="hljs-code">print("Hello, world!")
</code></pre>
    <p class="normal">This code gives us the basic <code class="Code-In-Text--PACKT-">Hello World</code> application. You can replace this code with examples from this book as you are going through it. To see how we would build and run an application using the package manager, let's leave the code as is for now and run the following commands:</p>
    <pre class="programlisting con"><code class="hljs-con">swift build
swift run
</code></pre>
    <p class="normal">You should see the following output:</p>
    <pre class="programlisting con"><code class="hljs-con">Hello, world!
</code></pre>
    <p class="normal">The <code class="Code-In-Text--PACKT-">swift build</code> command compiled our application, and the <code class="Code-In-Text--PACKT-">swift run</code> command ran the executable that was built with the previous command. Most of the code in this book doesn't need the package manager to run, and it may be easier to simply use the compiler. Just keep in mind that for anything larger than a simple example, you will want to <a id="_idIndexMarker083"/>use the package manager or Xcode.</p>
    <p class="normal">Next, let's see how to use the Swift compiler.</p>
    <h1 id="_idParaDest-41" class="title">Using the Swift compiler</h1>
    <p class="normal">The Swift compiler <a id="_idIndexMarker084"/>is the basic utility to build Swift code and it is used by the package manager, Xcode, and any other utility that builds Swift code into executables. We can also call it ourselves. To see how to call it ourselves, create a file named <code class="Code-In-Text--PACKT-">hello.swift</code> and add the <code class="Code-In-Text--PACKT-">print("Hello, world!")</code> code to it as shown with the following code:</p>
    <pre class="programlisting con"><code class="hljs-con">echo `print("Hello, world!")` &gt;&gt; hello.swift
</code></pre>
    <p class="normal">Now we can compile this code with the following command, which calls the Swift compiler:</p>
    <pre class="programlisting con"><code class="hljs-con">swiftc hello.swift
</code></pre>
    <p class="normal">Finally we can execute the newly created application like we would any other executable:</p>
    <pre class="programlisting con"><code class="hljs-con">./hello
</code></pre>
    <p class="normal">And we will be greeted with our <code class="Code-In-Text--PACKT-">Hello, world!</code> message.</p>
    <h1 id="_idParaDest-42" class="title">Summary</h1>
    <p class="normal">In this chapter, we looked at some of the different documentation that Apple and the Swift community offer. This documentation can be essential as you are learning Swift and also for reference once you have mastered the language itself. We also looked at how we can build and install Swift and its full toolchain. While using the latest build of Swift is not recommended for production systems, I usually keep a virtual machine or my desktop setup with a recent build. This enables me to use the latest features of the language and also run my code against it to make sure I am not introducing changes that are not compatible with future versions of the language.</p>
    <p class="normal">In the next chapter, we will start to get into the language itself and we will see how to use variables and constants in Swift. We will also look at the various data types and how to use operators in Swift.</p>
  </div>
</body></html>