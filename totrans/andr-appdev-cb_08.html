<html><head></head><body><div class="chapter" title="Chapter&#xA0;8.&#xA0;Using the Touchscreen and Sensors"><div class="titlepage"><div><div><h1 class="title"><a id="ch08"/>Chapter 8. Using the Touchscreen and Sensors</h1></div></div></div><p>In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Listening for click and long-press events</li><li class="listitem" style="list-style-type: disc">Recognizing tap and other common gestures</li><li class="listitem" style="list-style-type: disc">Pinch-to-zoom with multi-touch gestures</li><li class="listitem" style="list-style-type: disc">Swipe-to-Refresh</li><li class="listitem" style="list-style-type: disc">Listing available sensors – an introduction to the Android Sensor Framework</li><li class="listitem" style="list-style-type: disc">Reading sensor data – using the Android Sensor Framework events</li><li class="listitem" style="list-style-type: disc">Reading device orientation</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec63"/>Introduction</h1></div></div></div><p>These days, mobile devices are packed with sensors, often including a gyroscope, magnetic, gravity, pressure, and/or temperature sensors, not to mention the touchscreen. This provides many new and exciting options to interact with your user. Through the sensors, you can determine three-dimensional device location and how the device itself is being used, such as shaking, rotation, tilt, and so on. Even the touchscreen offers many new input methods from just the simple click to gestures and multi-touch.</p><p>We'll start this chapter by exploring touchscreen interactions, starting with a simple click and long-press, then move on to detecting common gestures using the <code class="literal">SimpleOnGestureListener</code> class. Next we'll look at a multi-touch using the pinch-to-zoom gesture with <code class="literal">ScaleGestureDetector</code>.</p><p>This book is meant to offer a quick guide to adding features and functionality to your own applications. As such, it focuses on the code needed. It's highly recommended that you spend some time reading the Design Guidelines as well.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip25"/>Tip</h3><p>Google Gesture Design Guidelines<a id="id471" class="indexterm"/> at <a class="ulink" href="https://www.google.com/design/spec/patterns/gestures.html">https://www.google.com/design/spec/patterns/gestures.html</a>
</p></div></div><p>In the later part of this chapter we'll look at the sensor abilities in Android, using the Android Sensor Framework. We'll demonstrate how to obtain a list of all the available sensors, plus how to check for a specific sensor. Once we obtain a sensor, we'll demonstrate setting up a listener to read the sensor data. Finally, we'll end the chapter with a demonstration on how to determine the device orientation.</p></div></div>
<div class="section" title="Listening for click and long-press events"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec64"/>Listening for click and long-press events</h1></div></div></div><p>Almost every application <a id="id472" class="indexterm"/>needs to recognize and respond to basic events such <a id="id473" class="indexterm"/>as clicks and long-presses. It's so basic, in most of the recipes, we use the XML <code class="literal">onClick</code> attribute, but the more advanced listeners require setting up through code.</p><p>Android provides an Event Listener interface for receiving a single notification when certain actions occur, as shown in the following list:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">onClick()</code>: It's called when a View is pressed</li><li class="listitem" style="list-style-type: disc"><code class="literal">onLongClick()</code>: It's called when the View is long-pressed</li><li class="listitem" style="list-style-type: disc"><code class="literal">onFocusChange()</code>: It's called when the user navigates to or from the View</li><li class="listitem" style="list-style-type: disc"><code class="literal">onKey()</code>: It's called when a hardware key is pressed or released</li><li class="listitem" style="list-style-type: disc"><code class="literal">onTouch()</code>: It's called when a touch event occurs</li></ul></div><p>This recipe will demonstrate responding to the click event, as well as the long-press event.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec222"/>Getting ready</h2></div></div></div><p>Create a new project in Android Studio and call it: <code class="literal">PressEvents</code>. Use the default <span class="strong"><strong>Phone &amp; Tablet </strong></span>options and select <span class="strong"><strong>Empty Activity</strong></span> when prompted for the <span class="strong"><strong>Activity Type</strong></span>.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec223"/>How to do it...</h2></div></div></div><p>Setting up to receive basic View events is very simple. First we will create a View; we'll use a button for our example, then set the Event Listener in the Activity's <code class="literal">onCreate()</code> method. Here are the steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">activity_main.xml</code> and replace the existing <code class="literal">TextView</code> with the following <code class="literal">Button</code>:<div class="informalexample"><pre class="programlisting">&lt;Button
    android:id="@+id/button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button"
    android:layout_centerVertical="true"
    android:layout_centerHorizontal="true" /&gt;</pre></div></li><li class="listitem">Now open <code class="literal">MainActivy.java</code> and <a id="id474" class="indexterm"/>add the following code to the <a id="id475" class="indexterm"/>existing <code class="literal">onCreate()</code> method:<div class="informalexample"><pre class="programlisting">Button button = (Button)findViewById(R.id.button);
button.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        Toast.makeText(MainActivity.this, "Click", Toast.LENGTH_SHORT).show();
    }
});
button.setOnLongClickListener(new View.OnLongClickListener() {
    @Override
    public boolean onLongClick(View v) {
        Toast.makeText(MainActivity.this, "Long Press", Toast.LENGTH_SHORT).show();
        return true;
    }
});</pre></div></li><li class="listitem">Run the application on a device or emulator and try a regular click and long-press.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec224"/>How it works...</h2></div></div></div><p>In most of the examples used in this book, we set up the <code class="literal">onClick</code> listener in XML using the following attribute:</p><div class="informalexample"><pre class="programlisting">android:onClick=""</pre></div><p>You may notice the XML <code class="literal">onClick()</code> method callback requires the same method signature as the <code class="literal">setOnClickListener</code> .<code class="literal">onClick()</code> callback:</p><div class="informalexample"><pre class="programlisting">public void onClick(View v) {}</pre></div><p>That's because Android automatically sets up the callback for us when we use the XML <code class="literal">onClick</code> attribute. This example also demonstrates that we can have multiple listeners on a single View.</p><p>The last point to <a id="id476" class="indexterm"/>note is that the <code class="literal">onLongClick()</code> method returns a <a id="id477" class="indexterm"/>Boolean, as do most of the other event listeners. Return <code class="literal">true</code> to indicate the event has been handled.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec225"/>There's more...</h2></div></div></div><p>Although a button is typically used to indicate where a user should "press", we could have used both the <code class="literal">setOnClickListener()</code> and <code class="literal">setOnLongClickListener()</code> with any View, even a <code class="literal">TextView</code>.</p><p>As mentioned in the introduction, there are other Event Listeners. You can use Android Studio's auto-complete feature. Start by typing the following command:</p><div class="informalexample"><pre class="programlisting">button.setOn</pre></div><p>Then press <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Spacebar</em></span> to see the list.</p></div></div>
<div class="section" title="Recognizing tap and other common gestures"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec65"/>Recognizing tap and other common gestures</h1></div></div></div><p>Unlike the Event Listeners described in the previous recipe, gestures require a two-step process:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Gather the<a id="id478" class="indexterm"/> movement data</li><li class="listitem" style="list-style-type: disc">Analyze the data to<a id="id479" class="indexterm"/> determine whether it matches a known gesture</li></ul></div><p>Step 1 begins when the user touches the screen, which fires the <code class="literal">onTouchEvent()</code> callback with the movement data sent in a <code class="literal">MotionEvent</code> object. Fortunately, Android makes Step 2, analyzing the data, easier with the <code class="literal">GestureDetector</code> class, which detects the following gestures:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">onTouchEvent()</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">onDown()</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">onFling()</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">onLongPress()</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">onScroll()</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">onShowPress()</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">onDoubleTap()</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">onDoubleTapEvent()</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">onSingleTapConfirmed()</code></li></ul></div><p>This recipe will <a id="id480" class="indexterm"/>demonstrate <a id="id481" class="indexterm"/>using the <code class="literal">GestureDetector.SimpleOnGestureListener</code> to recognize the touch and double tap gestures.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec226"/>Getting ready</h2></div></div></div><p>Create a new project in Android Studio and call it: <code class="literal">CommonGestureDetector</code>. Use the default <span class="strong"><strong>Phone &amp; Tablet </strong></span>options and select <span class="strong"><strong>Empty Activity</strong></span> when prompted for the <span class="strong"><strong>Activity Type</strong></span>.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec227"/>How to do it...</h2></div></div></div><p>We will be using the activity itself for detecting gestures, so we don't need to add any Views to the layout. Open <code class="literal">MainActivity.java</code> and follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Add the following global variable:<div class="informalexample"><pre class="programlisting">private GestureDetectorCompat mGestureDetector;</pre></div></li><li class="listitem">Add the following <code class="literal">GestureListener</code> class within the <code class="literal">MainActivity</code> class:<div class="informalexample"><pre class="programlisting">private class GestureListener extends GestureDetector.SimpleOnGestureListener {
    @Override
    public boolean onSingleTapConfirmed(MotionEvent e) {
        Toast.makeText(MainActivity.this, "onSingleTapConfirmed", Toast.LENGTH_SHORT).show();
        return super.onSingleTapConfirmed(e);
    }
    @Override
    public boolean onDoubleTap(MotionEvent e) {
        Toast.makeText(MainActivity.this, "onDoubleTap", Toast.LENGTH_SHORT).show();
        return super.onDoubleTap(e);
    }
}</pre></div></li><li class="listitem">Override the <code class="literal">onTouchEvent()</code> as follows:<div class="informalexample"><pre class="programlisting">public boolean onTouchEvent(MotionEvent event) {
    mGestureDetector.onTouchEvent(event);
    return super.onTouchEvent(event);
}</pre></div></li><li class="listitem">Last, add the following line of code to <code class="literal">onCreate()</code>:<div class="informalexample"><pre class="programlisting">mGestureDetector = new GestureDetectorCompat(this, new GestureListener());</pre></div></li><li class="listitem">Run this application on a device or emulator.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec228"/>How it works...</h2></div></div></div><p>We're using<a id="id482" class="indexterm"/> <code class="literal">GestureDetectorCompat</code>, which is from the Support <a id="id483" class="indexterm"/>Library allowing gesture support on devices running Android 1.6 and later.</p><p>As mentioned in the recipe introduction, detecting gestures is a two-step process. To gather the movement, or gesture, data, we start tracking the movement with the touch event. Every time the <code class="literal">onTouchEvent()</code> is called, we send that data to the <code class="literal">GestureDetector</code>. The <code class="literal">GestureDetector</code> handles the second step, analyzing the data. Once a gesture has been detected, the appropriate callback is made. Our example handles both the single and double tap gestures.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec229"/>There's more...</h2></div></div></div><p>Your application can easily add support for the remaining gestures detected by the <code class="literal">GestureDetector</code> simply by overriding the appropriate callback.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec230"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">See the next recipe, <span class="emphasis"><em>Pinch-to-zoom with multi-touch gestures</em></span>, for multi-touch gestures</li></ul></div></div></div>
<div class="section" title="Pinch-to-zoom with multi-touch gestures"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec66"/>Pinch-to-zoom with multi-touch gestures</h1></div></div></div><p>The previous recipe used<a id="id484" class="indexterm"/> the <code class="literal">SimpleOnGestureListener</code> to provide detection of simple, one-finger, gestures. In this recipe, we will demonstrate multi-touch with the common pinch-to-zoom gesture using the <code class="literal">SimpleOnScaleGestureListener </code>class.</p><p>The following screenshot shows the icon zoomed out using the application created in the following recipe:</p><div class="mediaobject"><img src="graphics/B05057_08_01.jpg" alt="Pinch-to-zoom with multi-touch gestures"/></div><p>The following <a id="id485" class="indexterm"/>screenshot shows the icon zoomed in:</p><div class="mediaobject"><img src="graphics/B05057_08_02.jpg" alt="Pinch-to-zoom with multi-touch gestures"/></div><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec231"/>Getting ready</h2></div></div></div><p>Create a new project<a id="id486" class="indexterm"/> in Android Studio and call it: <code class="literal">MultiTouchZoom</code>. Use the default <span class="strong"><strong>Phone &amp; Tablet </strong></span>options and select <span class="strong"><strong>Empty Activity</strong></span> when prompted for the <span class="strong"><strong>Activity Type</strong></span>.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec232"/>How to do it...</h2></div></div></div><p>To provide a visual indication of the pinch-to-zoom, we'll use an <code class="literal">ImageView</code> with the application icon. Open <code class="literal">activity_main.xml</code> and follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Replace the existing <code class="literal">TextView</code> with the following <code class="literal">ImageView</code>:<div class="informalexample"><pre class="programlisting">&lt;ImageView
    android:id="@+id/imageView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@mipmap/ic_launcher"
    android:layout_centerVertical="true"
    android:layout_centerHorizontal="true" /&gt;</pre></div></li><li class="listitem">Now open <code class="literal">MainActivity.java</code> and add the following global variables to the class:<div class="informalexample"><pre class="programlisting">private ScaleGestureDetector mScaleGestureDetector;
private float mScaleFactor = 1.0f;
private ImageView mImageView;</pre></div></li><li class="listitem">Override <code class="literal">onTouchEvent()</code> as follows:<div class="informalexample"><pre class="programlisting">public boolean onTouchEvent(MotionEvent motionEvent) {
    mScaleGestureDetector.onTouchEvent(motionEvent);
    return true;
}</pre></div></li><li class="listitem">Add the <a id="id487" class="indexterm"/>following <code class="literal">ScaleListener</code> class to the <code class="literal">MainActivity</code> class:<div class="informalexample"><pre class="programlisting">private class ScaleListener extends ScaleGestureDetector.SimpleOnScaleGestureListener {
    @Override
    public boolean onScale(ScaleGestureDetector scaleGestureDetector) {
        mScaleFactor *= scaleGestureDetector.getScaleFactor();
        mScaleFactor = Math.max(0.1f, Math.min(mScaleFactor, 10.0f));
        mImageView.setScaleX(mScaleFactor);
        mImageView.setScaleY(mScaleFactor);
        return true;
    }
}</pre></div></li><li class="listitem">Add the following code to the existing <code class="literal">onCreate()</code> method:<div class="informalexample"><pre class="programlisting">mImageView=(ImageView)findViewById(R.id.imageView);
mScaleGestureDetector = new ScaleGestureDetector(this, new ScaleListener());</pre></div></li><li class="listitem">To experiment with the pinch-to-zoom functionality, run the application on a device with a touchscreen.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec233"/>How it works...</h2></div></div></div><p>The <code class="literal">ScaleGestureDetector</code> does all the work by analyzing the gesture data and reporting the final scale factor through the <code class="literal">onScale()</code> callback. We get the actual scale factor by calling <code class="literal">getScaleFactor()</code> on <code class="literal">ScaleGestureDetector</code>.</p><p>We use an <code class="literal">ImageView</code> with the application icon to provide a visual representation of the scaling by setting the <code class="literal">ImageView</code> scale using the scale factor returned from <code class="literal">ScaleGestureDetector</code>. To prevent the scaling from becoming too large or too small, we add the following check:</p><div class="informalexample"><pre class="programlisting">mScaleFactor = Math.max(0.1f, Math.min(mScaleFactor, 10.0f));</pre></div></div></div>
<div class="section" title="Swipe-to-Refresh"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec67"/>Swipe-to-Refresh</h1></div></div></div><p>Pulling down a list to indicate a manual refresh is known as the Swipe-to-Refresh gesture. It's such a common feature that this functionality has been encapsulated in a single widget called <code class="literal">SwipeRefreshLayout</code>.</p><p>This recipe will show how to use the widget to add Swipe-to-Refresh functionality<a id="id488" class="indexterm"/> with a <code class="literal">ListView</code>. The following screenshot shows the refresh in action:</p><div class="mediaobject"><img src="graphics/B05057_08_03.jpg" alt="Swipe-to-Refresh"/></div><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec234"/>Getting ready</h2></div></div></div><p>Create a new project in Android Studio and call it: <code class="literal">SwipeToRefresh</code>. Use the default <span class="strong"><strong>Phone &amp; Tablet </strong></span>options and select <span class="strong"><strong>Empty Activity</strong></span> when prompted for the <span class="strong"><strong>Activity Type</strong></span>.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec235"/>How to do it...</h2></div></div></div><p>First, we need to add the <code class="literal">SwipeRefreshLayout</code> widget and <code class="literal">ListView</code> to the activity layout, then we <a id="id489" class="indexterm"/>will implement the refresh listener in the java code. Here are the detailed steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">activity_main.xml</code> and replace the existing <code class="literal">&lt;TextView&gt;</code> with the following:<div class="informalexample"><pre class="programlisting">&lt;android.support.v4.widget.SwipeRefreshLayout
    
    android:id="@+id/swipeRefresh"
    android:layout_width="match_parent"
    android:layout_height="match_parent"&gt;
    &lt;ListView
        android:id="@android:id/list"
        android:layout_width="match_parent"
        android:layout_height="match_parent" /&gt;
&lt;/android.support.v4.widget.SwipeRefreshLayout&gt;</pre></div></li><li class="listitem">Now open <code class="literal">MainActivity.java</code> and add the following global variables to the class:<div class="informalexample"><pre class="programlisting">SwipeRefreshLayout mSwipeRefreshLayout;
ListView mListView;
List mArrayList = new ArrayList&lt;&gt;();
private int mRefreshCount=0;</pre></div></li><li class="listitem">Add the following method to handle the refresh:<div class="informalexample"><pre class="programlisting">private void refreshList() {
    mRefreshCount++;
    mArrayList.add("Refresh: " + mRefreshCount);
    ListAdapter countryAdapter = new ArrayAdapter&lt;String&gt;(this, android.R.layout.simple_list_item_1, mArrayList);
    mListView.setAdapter(countryAdapter);
    mSwipeRefreshLayout.setRefreshing(false);
}</pre></div></li><li class="listitem">Add the following code to the existing <code class="literal">onCreate()</code> method:<div class="informalexample"><pre class="programlisting">mSwipeRefreshLayout = (SwipeRefreshLayout)findViewById(R.id.swipeRefresh);
mSwipeRefreshLayout.setOnRefreshListener(new SwipeRefreshLayout.OnRefreshListener() {
    @Override
    public void onRefresh() {
        refreshList();
    }
});

mListView = (ListView)findViewById(android.R.id.list);
final String[] countries = new String[]{"China", "France", "Germany", "India", "Russia", "United Kingdom", "United States"};
mArrayList = new ArrayList&lt;String&gt;(Arrays.asList(countries));
ListAdapter countryAdapter = new ArrayAdapter&lt;String&gt;(this, android.R.layout.simple_list_item_1, mArrayList);
mListView.setAdapter(countryAdapter);</pre></div></li><li class="listitem">Run the application on a device or emulator.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec236"/>How it works...</h2></div></div></div><p>Most of the code <a id="id490" class="indexterm"/>for this recipe is to simulate a refresh by adding items to the <code class="literal">ListView</code> each time the refresh method is called. The main steps for implementing the Swipe-to-Refresh include:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Add the <code class="literal">SwipeRefreshLayout</code> widget.</li><li class="listitem">Include the <code class="literal">ListView</code> within the <code class="literal">SwipeRefreshLayout</code>.</li><li class="listitem">Add the <code class="literal">OnRefreshListener</code> to call your refresh method.</li><li class="listitem">Call <code class="literal">setRefreshing(false)</code> after completing your update.</li></ol></div><p>That's it. The widget makes adding Swipe-to-Refresh very easy!</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec237"/>There's more...</h2></div></div></div><p>Although the Swipe-to-Refresh gesture is a common feature of applications these days, it's still good practice to include a menu item (especially for accessibility reasons). Here is a snippet of XML for the menu layout:</p><div class="informalexample"><pre class="programlisting">&lt;menu  &gt;
    &lt;item
        android:id="@+id/menu_refresh"
        android:showAsAction="never"
        android:title="@string/menu_refresh"/&gt;
&lt;/menu&gt;</pre></div><p>Call your refresh method in the <code class="literal">onOptionsItemSelected()</code> callback. When performing a refresh from code, such as from the menu item event, you want to notify <code class="literal">SwipeRefreshLayout</code> of the refresh so it can update the UI. Do this with the following code:</p><div class="informalexample"><pre class="programlisting">SwipeRefreshLayout.setRefreshing(true);</pre></div><p>This tells the <code class="literal">SwipeRefreshLayout</code> that a refresh is starting so it can display the in-progress indicator.</p></div></div>
<div class="section" title="Listing available sensors &#x2013; an introduction to the Android Sensor Framework"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec68"/>Listing available sensors – an introduction to the Android Sensor Framework</h1></div></div></div><p>Android includes support for hardware sensors using the <a id="id491" class="indexterm"/>Android Sensor Framework. The framework includes the following classes and interfaces:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">SensorManager</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">Sensor</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">SensorEventListener</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">SensorEvent</code></li></ul></div><p>Most Android devices include hardware sensors, but they vary greatly between different manufacturers and models. If your application utilizes sensors, you have two choices:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Specify the sensor in the Android Manifest</li><li class="listitem" style="list-style-type: disc">Check for the sensor at runtime</li></ul></div><p>To specify your application uses a sensor, include the <code class="literal">&lt;uses-feature&gt;</code> declaration in the Android Manifest. Here is an example requiring a compass to be available:</p><div class="informalexample"><pre class="programlisting">&lt;uses-feature android:name="android.hardware.sensor.compass" android:required="true"/&gt;</pre></div><p>If your application utilizes the compass, but does not require it to function, you should set <code class="literal">android:required="false"</code> instead, otherwise the application will not be available through Google Play.</p><p>Sensors are grouped into the following three categories:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Motion sensors</li><li class="listitem" style="list-style-type: disc">Environmental sensors</li><li class="listitem" style="list-style-type: disc">Position sensors</li></ul></div><p>The Android SDK provides support for the following sensor types:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Sensor</p>
</th><th style="text-align: left" valign="bottom">
<p>Detects</p>
</th><th style="text-align: left" valign="bottom">
<p>Use</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TYPE_ACCELEROMETER</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Motion detection including gravity</p>
</td><td style="text-align: left" valign="top">
<p>Used to determine shake, tilt, and so on</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TYPE_AMBIENT_TEMPERATURE</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Measures ambient room temperature</p>
</td><td style="text-align: left" valign="top">
<p>Used for determining local temperature</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TYPE_GRAVITY</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Measures the force of gravity on all three axes</p>
</td><td style="text-align: left" valign="top">
<p>Used for motion detection</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TYPE_GYROSCOPE</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Measures rotation on all three axes</p>
</td><td style="text-align: left" valign="top">
<p>Used to determine turn, spin, and so on</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TYPE_LIGHT</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Measures light level</p>
</td><td style="text-align: left" valign="top">
<p>Used for setting screen brightness</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TYPE_LINEAR_ACCELERATION</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Motion detection excluding gravity</p>
</td><td style="text-align: left" valign="top">
<p>Used to determine acceleration</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TYPE_MAGNETIC_FIELD</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Measures geomagnetic field</p>
</td><td style="text-align: left" valign="top">
<p>Used to create a compass or determine bearing</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TYPE_PRESSURE</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Measures air pressure</p>
</td><td style="text-align: left" valign="top">
<p>Used for barometer</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TYPE_PROXIMITY</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Measures object relative to the screen</p>
</td><td style="text-align: left" valign="top">
<p>Used to determine whether the device is being held against the ear during a phone call</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TYPE_RELATIVE_HUMIDITY</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Measures relative humidity</p>
</td><td style="text-align: left" valign="top">
<p>Used to determine dew point and humidity</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TYPE_ROTATION_VECTOR</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Measures device orientation</p>
</td><td style="text-align: left" valign="top">
<p>Used to detect motion and rotation</p>
</td></tr></tbody></table></div><p>There are two <a id="id492" class="indexterm"/>additional sensors: <code class="literal">TYPE_ORIENTATION</code> and <code class="literal">TYPE_TEMPERATURE</code>, that have been deprecated as they have been replaced by newer sensors.</p><p>This recipe will demonstrate retrieving a list of available sensors. Here is a screenshot from a physical device:</p><div class="mediaobject"><img src="graphics/B05057_08_04.jpg" alt="Listing available sensors – an introduction to the Android Sensor Framework"/></div><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec238"/>Getting ready</h2></div></div></div><p>Create a new project in Android Studio and call it: <code class="literal">ListDeviceSensors</code>. Use the default <span class="strong"><strong>Phone &amp; Tablet </strong></span>options and select <span class="strong"><strong>Empty Activity</strong></span> when prompted for the <span class="strong"><strong>Activity Type</strong></span>.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec239"/>How to do it...</h2></div></div></div><p>First, we'll query the<a id="id493" class="indexterm"/> list of sensors available, then display the results in a <code class="literal">ListView</code>. Here are the detailed steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">activity_main.xml</code> and replace the existing <code class="literal">TextView</code> with the following:<div class="informalexample"><pre class="programlisting">&lt;ListView
    android:id="@+id/list"
    android:layout_width="match_parent"
    android:layout_height="match_parent" /&gt;</pre></div></li><li class="listitem">Next, open <code class="literal">ActivityMain.java</code> and add the following code to the existing <code class="literal">onCreate()</code> method:<div class="informalexample"><pre class="programlisting">ListView listView = (ListView)findViewById(R.id.list);
List sensorList = new ArrayList&lt;String&gt;();

List&lt;Sensor&gt; sensors = ((SensorManager) getSystemService(Context.SENSOR_SERVICE)).getSensorList(Sensor.TYPE_ALL);
for (Sensor sensor : sensors ) {
    sensorList.add(sensor.getName());
}
ListAdapter sensorAdapter = new ArrayAdapter&lt;String&gt;(this, android.R.layout.simple_list_item_1, sensorList);
listView.setAdapter(sensorAdapter);</pre></div></li><li class="listitem">Run the program on a device or emulator.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec240"/>How it works...</h2></div></div></div><p>The following<a id="id494" class="indexterm"/> line of code is responsible for getting the list of available sensors; the rest of the code is to populate the <code class="literal">ListView</code>:</p><div class="informalexample"><pre class="programlisting">List&lt;Sensor&gt; sensors = ((SensorManager) getSystemService(Context.SENSOR_SERVICE)).getSensorList(Sensor.TYPE_ALL);</pre></div><p>Notice that we get back a list of <code class="literal">Sensor</code> objects. We only get the sensor name to display in the <code class="literal">ListView</code>, but there are other properties available as well. See the link provided in the <span class="emphasis"><em>See also</em></span> section for a complete list.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec241"/>There's more...</h2></div></div></div><p>As shown in the introduction screenshot from a Nexus 9, a device can have multiple sensors of the same type. If you are looking for a specific sensor, you can pass in one of the constants from the table shown in the introduction. In this case, if you wanted to see all the Accelerometer sensors available, you could use this call:</p><div class="informalexample"><pre class="programlisting">List&lt;Sensor&gt; sensors = sensorManager.getSensorList(Sensor.TYPE_ACCELEROMETER);</pre></div><p>If you're not looking for a list of sensors, but need to work with a specific sensor, you can check for a default sensor using this code:</p><div class="informalexample"><pre class="programlisting">if (sensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER) != null){
    //Sensor is available - do something here
}</pre></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec242"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Android Developer Sensor</strong></span> <a id="id495" class="indexterm"/>website at <a class="ulink" href="http://developer.android.com/reference/android/hardware/Sensor.html">http://developer.android.com/reference/android/hardware/Sensor.html</a></li></ul></div></div></div>
<div class="section" title="Reading sensor data &#x2013; using the Android Sensor Framework events"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec69"/>Reading sensor data – using the Android Sensor Framework events</h1></div></div></div><p>The previous recipe, <span class="emphasis"><em>Listing available sensors – an introduction to the Android Sensor Framework</em></span>, provided<a id="id496" class="indexterm"/> an introduction to the Android Sensor Framework. Now we'll <a id="id497" class="indexterm"/>look at reading the sensor data using the <code class="literal">SensorEventListener</code>. The <code class="literal">SensorEventListener</code> interface only has two callbacks:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">onSensorChanged</code>()</li><li class="listitem" style="list-style-type: disc"><code class="literal">onAccuracyChanged</code>()</li></ul></div><p>When the sensor has new data to report, it calls the <code class="literal">onSensorChanged()</code> with a <code class="literal">SensorEvent</code> object. This recipe will demonstrate reading the Light sensor, but since all the sensors use the same framework, it's very easy to adapt this example to any of the other sensors. (See the list of sensor types available in the previous recipe's introduction.)</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec243"/>Getting ready</h2></div></div></div><p>Create a new project in Android Studio and call it: <code class="literal">ReadingSensorData</code>. Use the default <span class="strong"><strong>Phone &amp; Tablet </strong></span>options and select <span class="strong"><strong>Empty Activity</strong></span> when prompted for the <span class="strong"><strong>Activity Type</strong></span>.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec244"/>How to do it...</h2></div></div></div><p>We'll add a <code class="literal">TextView</code> to the activity layout to display the sensor data, then we'll add the <code class="literal">SensorEventListener</code> to the java code. We'll use the <code class="literal">onResume()</code> and <code class="literal">onPause()</code> events to start and stop our Event Listener. To get started, open <code class="literal">activity_main.xml</code> and follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Modify the existing <code class="literal">TextView</code> as follows:<div class="informalexample"><pre class="programlisting">&lt;TextView
    android:id="@+id/textView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text="0"/&gt;</pre></div></li><li class="listitem">Now open <code class="literal">MainActivity.java</code> and add the following global variable declarations:<div class="informalexample"><pre class="programlisting">private SensorManager mSensorManager;
private Sensor mSensor;
private TextView mTextView;</pre></div></li><li class="listitem">Add <a id="id498" class="indexterm"/>the <code class="literal">SensorListener</code> class to the <code class="literal">MainActivity</code> class <a id="id499" class="indexterm"/>as follows:<div class="informalexample"><pre class="programlisting">private SensorEventListener mSensorListener = new SensorEventListener() {
    @Override
    public void onSensorChanged(SensorEvent event) {
        mTextView.setText(String.valueOf(event.values[0]));
    }
    @Override
    public void onAccuracyChanged(Sensor sensor, int accuracy) {
        //Nothing to do
    }
};</pre></div></li><li class="listitem">We'll register and unregister the sensor events in the <code class="literal">onResume()</code> and <code class="literal">onPause()</code> as follows:<div class="informalexample"><pre class="programlisting">@Override
protected void onResume() {
    super.onResume();
    mSensorManager.registerListener(mSensorListener, mSensor, SensorManager.SENSOR_DELAY_NORMAL);
}

@Override
protected void onPause() {
    super.onPause();
    mSensorManager.unregisterListener(mSensorListener);
}</pre></div></li><li class="listitem">Add the following code to the <code class="literal">onCreate()</code>:<div class="informalexample"><pre class="programlisting">mTextView = (TextView)findViewById(R.id.textView);
mSensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
mSensor = mSensorManager.getDefaultSensor(Sensor.TYPE_LIGHT);</pre></div></li><li class="listitem">You can now run the application on a physical device to see the raw data from the light sensor.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec245"/>How it works...</h2></div></div></div><p>Using the Android<a id="id500" class="indexterm"/> Sensor Framework starts with obtaining the Sensor, which we <a id="id501" class="indexterm"/>do in  <code class="literal">onCreate()</code>. Here, we call <code class="literal">getDefaultSensor(),</code> requesting <code class="literal">TYPE_LIGHT</code>. We register the listener in <code class="literal">onResume()</code> and unregister again in <code class="literal">onPause()</code> to reduce battery consumption. We pass in our <code class="literal">mSensorListener</code> object when we call <code class="literal">registerListener()</code>.</p><p>In our case, we are only looking for the sensor data, which is sent in the <code class="literal">onSensorChanged()</code> callback. When the sensor changes, we update the <code class="literal">TextView</code> with the sensor data.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec246"/>There's more...</h2></div></div></div><p>Now that you've worked with one sensor, you know how to work with all the sensors, as they all use the same framework. Of course, what you do with the data will vary greatly, depending on the type of data you're reading. The Environment sensors, as shown here, return a single value, but the Position and Motion sensors can also return additional elements, indicated as follows.</p><div class="section" title="Environment sensors"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl3sec24"/>Environment sensors</h3></div></div></div><p>Android supports the following four<a id="id502" class="indexterm"/> environment sensors:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Humidity</li><li class="listitem" style="list-style-type: disc">Light</li><li class="listitem" style="list-style-type: disc">Pressure</li><li class="listitem" style="list-style-type: disc">Temperature</li></ul></div><p>The environment sensors are generally easier to work with since the data returned is in a single element and doesn't usually require calibration or filtering. We used the Light sensor for this demonstration since most devices include a light sensor to control the screen brightness.</p></div><div class="section" title="Position sensors"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl3sec25"/>Position sensors</h3></div></div></div><p>The Position sensors<a id="id503" class="indexterm"/> include:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Geomagnetic Field</li><li class="listitem" style="list-style-type: disc">Proximity</li></ul></div><p>The following sensor types use the Geomagnetic field:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">TYPE_GAME_ROTATION_VECTOR</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">TYPE_GEOMAGNETIC_ROTATION_VECTOR</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">TYPE_MAGNETIC_FIELD</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">TYPE_MAGNETIC_FIELD_UNCALIBRATED</code></li></ul></div><p>These sensors return three <a id="id504" class="indexterm"/>values in the <code class="literal">onSensorChanged()</code> event, except for the <code class="literal">TYPE_MAGNETIC_FIELD_UNCALIBRATED</code>, which sends six values.</p><p>A third sensor, the Orientation sensor, has been deprecated, and it is now recommended to use <code class="literal">getRotation()</code> and <code class="literal">getRotationMatrix()</code> to calculate the orientation changes. (For device orientation, such as Portrait and Landscape modes, see the next recipe: <span class="emphasis"><em>Reading device orientation</em></span>.)</p></div><div class="section" title="Motion sensors"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl3sec26"/>Motion sensors</h3></div></div></div><p>The Motion sensors <a id="id505" class="indexterm"/>include the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Accelerometer</li><li class="listitem" style="list-style-type: disc">Gyroscope</li><li class="listitem" style="list-style-type: disc">Gravity</li><li class="listitem" style="list-style-type: disc">Linear acceleration</li><li class="listitem" style="list-style-type: disc">Rotation vector</li></ul></div><p>These include the following sensor types:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">TYPE_ACCELEROMETE</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">TYPE_GRAVITY</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">TYPE_GYROSCOPE</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">TYPE_GYROSCOPE_UNCALIBRATED</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">TYPE_LINEAR_ACCELERATION</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">TYPE_ROTATION_VECTOR</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">TYPE_SIGNIFICANT_MOTION</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">TYPE_STEP_COUNTER</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">TYPE_STEP_DETECTOR</code></li></ul></div><p>These sensors also include three data elements, with the exception of the last three. The <code class="literal">TYPE_SIGNIFICANT_MOTION</code> and <code class="literal">TYPE_STEP_DETECTOR</code> indicate an event, while the <code class="literal">TYPE_STEP_COUNTER</code> returns the number of steps since last boot (while the sensor was active).</p></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec247"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Listing available sensors – an introduction to the Android Sensor Framework</em></span> recipe</li><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Creating a Compass using sensor data and RotateAnimation</em></span> recipe in <a class="link" href="ch09.html" title="Chapter 9. Graphics and Animation">Chapter 9</a>, <span class="emphasis"><em>Graphics and Animation</em></span></li><li class="listitem" style="list-style-type: disc">For device orientation, see the <span class="emphasis"><em>Reading device orientation</em></span> recipe</li><li class="listitem" style="list-style-type: disc"><a class="link" href="ch13.html" title="Chapter 13. Getting Location and Using Geofencing">Chapter 13</a>, <span class="emphasis"><em>Getting Location and Using Geofencing</em></span>, covers the <span class="emphasis"><em>GPS and Location</em></span> recipe</li></ul></div></div></div>
<div class="section" title="Reading device orientation"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec70"/>Reading device orientation</h1></div></div></div><p>Although the Android <a id="id506" class="indexterm"/>framework will automatically load a new resource (such as the layout) upon orientation changes, there are times when you may wish to disable this behavior. If you wish to be notified of the orientation change instead of Android handling it automatically, add the following attribute to the Activity in the Android Manifest:</p><div class="informalexample"><pre class="programlisting">android:configChanges="keyboardHidden|orientation|screenSize"</pre></div><p>When any of the following configuration changes occur, the system will notify you through the <code class="literal">onConfigurationChanged()</code> method instead of handling it automatically:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">keyboardHidden</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">orientation</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">screenSize</code></li></ul></div><p>The <code class="literal">onConfigurationChanged()</code> signature is as follows:</p><div class="informalexample"><pre class="programlisting">onConfigurationChanged (Configuration newConfig)</pre></div><p>You'll find the new orientation in <code class="literal">newConfig.orientation</code>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip26"/>Tip</h3><p>Disabling the automatic configuration change (which causes the layout to be reloaded and state information to be reset) should not be used as a replacement for properly saving state information. Your application can still be interrupted or stopped altogether at any time and killed by the system. (See <span class="emphasis"><em>Saving an activity's state</em></span> in <a class="link" href="ch01.html" title="Chapter 1. Activities">Chapter 1</a>, <span class="emphasis"><em>Activities</em></span>, for properly saving a state.)</p></div></div><p>This recipe will demonstrate how to determine the current device orientation.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec248"/>Getting ready</h2></div></div></div><p>Create a new project in Android Studio and call it: <code class="literal">GetDeviceOrientation</code>. Use the default <span class="strong"><strong>Phone &amp; Tablet </strong></span>options and select <span class="strong"><strong>Empty Activity</strong></span> when prompted for the <span class="strong"><strong>Activity Type</strong></span>.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec249"/>How to do it...</h2></div></div></div><p>We'll add a button to the<a id="id507" class="indexterm"/> layout to check the orientation on demand. Start by opening <code class="literal">activity_main.xml</code> and follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Replace the existing <code class="literal">TextView</code> with the following <code class="literal">Button</code>:<div class="informalexample"><pre class="programlisting">&lt;Button
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Check Orientation"
    android:id="@+id/button"
    android:layout_centerVertical="true"
    android:layout_centerHorizontal="true"
    android:onClick="checkOrientation"/&gt;</pre></div></li><li class="listitem">Add the following method to handle the button click:<div class="informalexample"><pre class="programlisting">public void checkOrientation(View view){
    int orientation = getResources().getConfiguration().orientation;
    switch (orientation) {
        case Configuration.ORIENTATION_LANDSCAPE:
            Toast.makeText(MainActivity.this, "ORIENTATION_LANDSCAPE", Toast.LENGTH_SHORT).show();
            break;
        case Configuration.ORIENTATION_PORTRAIT:
            Toast.makeText(MainActivity.this, "ORIENTATION_PORTRAIT", Toast.LENGTH_SHORT).show();
            break;
        case Configuration.ORIENTATION_UNDEFINED:
            Toast.makeText(MainActivity.this, "ORIENTATION_UNDEFINED", Toast.LENGTH_SHORT).show();
            break;
    }
}</pre></div></li><li class="listitem">Run the application on a device or emulator.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip27"/>Tip</h3><p>Use <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>F11</em></span> to rotate the emulator.</p></div></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec250"/>How it works...</h2></div></div></div><p>All we need to do to<a id="id508" class="indexterm"/> get the current orientation is call this line of code:</p><div class="informalexample"><pre class="programlisting">getResources().getConfiguration().orientation</pre></div><p>The orientation is returned as an <code class="literal">int</code>, which we compare to one of three possible values, as demonstrated.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec251"/>There's more...</h2></div></div></div><div class="section" title="Getting current device rotation"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl3sec27"/>Getting current device rotation</h3></div></div></div><p>Another scenario where<a id="id509" class="indexterm"/> you may need to know the current orientation is when working with camera data—pictures and/or videos. Often, the image may be rotated according to the device orientation or to compensate for the current orientation. In this scenario, there's another option available to get the rotation:</p><div class="informalexample"><pre class="programlisting">int rotation = getWindowManager().getDefaultDisplay().getRotation();</pre></div><p>In the preceding line of code, <code class="literal">rotation</code> will be one of the following values:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">Surface.ROTATION_0</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">Surface.ROTATION_90</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">Surface.ROTATION_180</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">Surface.ROTATION_270</code></li></ul></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip28"/>Tip</h3><p>The rotation value will be from its normal orientation. For example, when using a table with a normal orientation of landscape, if a picture is taken in portrait orientation, the value will be <code class="literal">ROTATION_90</code> or <code class="literal">ROTATION_270</code>.</p></div></div></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec252"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Saving an activity's state</em></span> recipe in <a class="link" href="ch01.html" title="Chapter 1. Activities">Chapter 1</a>, <span class="emphasis"><em>Activities</em></span></li><li class="listitem" style="list-style-type: disc">Refer to <span class="strong"><strong>Configuration Developer Link</strong></span> <a id="id510" class="indexterm"/>at <a class="ulink" href="http://developer.android.com/reference/android/content/res/Configuration.html">http://developer.android.com/reference/android/content/res/Configuration.html</a></li><li class="listitem" style="list-style-type: disc">Refer to <span class="strong"><strong>Display Developer Link</strong></span> <a id="id511" class="indexterm"/>at <a class="ulink" href="http://developer.android.com/reference/android/view/Display.html#getRotation()">http://developer.android.com/reference/android/view/Display.html#getRotation()</a></li></ul></div></div></div></body></html>