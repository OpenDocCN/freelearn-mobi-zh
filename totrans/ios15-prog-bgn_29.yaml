- en: '*Chapter 25*: Getting Started with SharePlay'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第 25 章*：SharePlay 入门'
- en: Apple introduced **SharePlay** during WWDC 2021, which allows users to share
    experiences by integrating your apps into FaceTime using the **Group Activities**
    framework.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 苹果公司在 2021 年的 WWDC 上推出了 **SharePlay**，该功能允许用户通过将您的应用集成到 FaceTime 中使用 **Group
    Activities** 框架来共享体验。
- en: In this chapter, you'll implement SharePlay for a sample app by adding Group
    Activities support to it. You'll begin by learning how SharePlay works. Next,
    you'll explore the app you'll be adding SharePlay support to using the Group Activities
    framework. After that, you'll learn how to create a custom group activity for
    this app, and how to manage a group activity session. Finally, you will test the
    SharePlay experience in the app using two iOS devices.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您将通过向其中添加 Group Activities 支持来实现 SharePlay 的示例应用。您将从学习 SharePlay 的工作原理开始。接下来，您将使用
    Group Activities 框架探索您将添加 SharePlay 支持的应用。然后，您将学习如何为该应用创建自定义群组活动以及如何管理群组活动会话。最后，您将使用两台
    iOS 设备在应用中测试 SharePlay 体验。
- en: By the end of this chapter, you'll have learned how SharePlay works, and how
    to update your own apps to use it.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，您将了解 SharePlay 的工作原理以及如何更新您的应用以使用它。
- en: 'The following topics will be covered:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 将涵盖以下主题：
- en: Understanding SharePlay
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解 SharePlay
- en: Exploring the *ShareOrder* app
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 探索 *ShareOrder* 应用
- en: Creating a custom Group Activity
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建自定义群组活动
- en: Managing a group activity session
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理群组活动会话
- en: Testing SharePlay in the *ShareOrder* app
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 *ShareOrder* 应用中测试 SharePlay
- en: Technical requirements
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: You will implement and test the Group Activities framework in a sample app named
    *ShareOrder*. A paid Apple developer account and at least two iOS devices running
    iOS 15.1 or later with the *ShareOrder* app installed will be required. You can
    also use one Mac with macOS 12.1 or later installed and one iOS device with iOS
    15.1 or later installed.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 您将在名为 *ShareOrder* 的示例应用中实现和测试 Group Activities 框架。您将需要一个付费的 Apple 开发者账户，以及至少两台安装了
    iOS 15.1 或更高版本的 iOS 设备，并安装了 *ShareOrder* 应用。您还可以使用一台安装了 macOS 12.1 或更高版本的 Mac
    和一台安装了 iOS 15.1 或更高版本的 iOS 设备。
- en: 'The completed Xcode project for this chapter is in the `Chapter25` folder of
    the code bundle for this book, which can be downloaded here:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的完成 Xcode 项目位于本书代码包的 `Chapter25` 文件夹中，可以在此处下载：
- en: '[https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition](https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition)'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition](https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition)'
- en: 'Check out the following video to see the code in action:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 查看以下视频以查看代码的实际运行情况：
- en: '[https://bit.ly/3I9zb6Y](https://bit.ly/3I9zb6Y)'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://bit.ly/3I9zb6Y](https://bit.ly/3I9zb6Y)'
- en: Let's start by learning about SharePlay in the next section.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从下一节开始学习 SharePlay。
- en: Understanding SharePlay
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解 SharePlay
- en: SharePlay was introduced by Apple during WWDC 2021\. It enables shared user
    experiences for participants in a FaceTime session. For example, a user may wish
    to watch a video together with another user. All the user needs to do is to FaceTime
    with the other user, launch the video app, and initiate SharePlay. The same app
    will launch for the other user and play the same video, and SharePlay ensures
    that the video stays in sync between both users.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: SharePlay 是苹果公司在 2021 年的 WWDC 上推出的。它允许 FaceTime 会话中的参与者共享用户体验。例如，一个用户可能希望与另一个用户一起观看视频。用户需要做的只是与另一个用户进行
    FaceTime 通话，启动视频应用，并启动 SharePlay。相同的应用将为另一个用户启动并播放相同的视频，SharePlay 确保视频在两个用户之间保持同步。
- en: You can also create custom SharePlay experiences. An example of this is the
    *DrawTogether* app demonstrated during WWDC 2021\. In the demonstration, three
    users initially joined a FaceTime session. One user launched the *DrawTogether*
    app, and initiated the SharePlay session in the app. The other users were presented
    with a SharePlay prompt containing a **Join** button. When the **Join** button
    was tapped, the *DrawTogether* app was launched for the other users, and whatever
    a user drew on their screen appeared on the screens of the other users.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以创建自定义 SharePlay 体验。一个例子是在 2021 年的 WWDC 上展示的 *DrawTogether* 应用。在演示中，三个用户最初加入了一个
    FaceTime 会话。一个用户启动了 *DrawTogether* 应用，并在应用中启动了 SharePlay 会话。其他用户看到了一个包含 **加入**
    按钮的 SharePlay 提示。当按下 **加入** 按钮时，*DrawTogether* 应用将为其他用户启动，用户在屏幕上绘制的任何内容都会出现在其他用户的屏幕上。
- en: Important Information
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 重要信息
- en: 'You can see how the *DrawTogether* app works and how it is implemented here:
    [https://developer.apple.com/videos/play/wwdc2021/10187](https://developer.apple.com/videos/play/wwdc2021/10187).'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在此处查看`*DrawTogether*`应用程序的工作原理及其实现方式：[https://developer.apple.com/videos/play/wwdc2021/10187](https://developer.apple.com/videos/play/wwdc2021/10187).
- en: 'You can download the *DrawTogether* app here: [https://developer.apple.com/documentation/groupactivities/drawing_content_in_a_group_session](https://developer.apple.com/documentation/groupactivities/drawing_content_in_a_group_session).'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在此处下载`*DrawTogether*`应用程序：[https://developer.apple.com/documentation/groupactivities/drawing_content_in_a_group_session](https://developer.apple.com/documentation/groupactivities/drawing_content_in_a_group_session).
- en: SharePlay is powered by the Group Activities framework. This framework uses
    FaceTime to synchronize your app's activities and to invite other participants
    to join those activities. Objects representing shared activities must conform
    to the `GroupActivity` protocol. After a group activity has started, a `GroupSession`
    object is used to synchronize app behavior between all participants.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: SharePlay由Group Activities框架提供支持。此框架使用FaceTime来同步应用程序的活动，并邀请其他参与者加入这些活动。表示共享活动的对象必须遵守`GroupActivity`协议。在群组活动开始后，使用`GroupSession`对象在所有参与者之间同步应用程序行为。
- en: Important Information
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 重要信息
- en: 'You can find links to all of Apple''s Group Activities-related videos during
    WWDC 2021 here:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在此处找到WWDC 2021期间所有与Apple的Group Activities相关的视频链接：
- en: '[https://developer.apple.com/videos/wwdc2021/?q=group%20activities](https://developer.apple.com/videos/wwdc2021/?q=group%20activities)'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://developer.apple.com/videos/wwdc2021/?q=group%20activities](https://developer.apple.com/videos/wwdc2021/?q=group%20activities)'
- en: 'You can read Apple''s Group Activities documentation here:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在此处阅读Apple的Group Activities文档：
- en: '[https://developer.apple.com/documentation/GroupActivities](https://developer.apple.com/documentation/GroupActivities)'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://developer.apple.com/documentation/GroupActivities](https://developer.apple.com/documentation/GroupActivities)'
- en: 'In this chapter, you will implement the Group Activities framework in a sample
    app named *ShareOrder* by following these steps:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您将通过以下步骤在名为`*ShareOrder*`的示例应用程序中实现Group Activities框架：
- en: Add the Group Activities capability to the *ShareOrder* app.
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Group Activities功能添加到`*ShareOrder*`应用程序中。
- en: Create and configure a *ShareOrder* structure conforming to the `GroupActivity`
    protocol. This structure will contain metadata that describes the group activity.
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建并配置一个遵守`GroupActivity`协议的`*ShareOrder*`结构。此结构将包含描述群组活动的元数据。
- en: Configure the *ShareOrder* app's user interface with a button to activate the
    group activity.
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用一个按钮配置`*ShareOrder*`应用程序的用户界面以激活群组活动。
- en: Implement a `GroupSession` object that allows your app to join a group activity
    session.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 实现一个允许您的应用程序加入群组活动会话的`GroupSession`对象。
- en: Implement a `GroupSessionMessenger` object that allows your app to send and
    receive messages. These messages are used to synchronize what the users do in
    the app.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 实现一个允许您的应用程序发送和接收消息的`GroupSessionMessenger`对象。这些消息用于同步用户在应用程序中的操作。
- en: Before you do so, let's see how the *ShareOrder* app works in the next section.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在这样做之前，让我们看看下一节中`*ShareOrder*`应用程序是如何工作的。
- en: Exploring the ShareOrder app
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 探索`ShareOrder`应用程序
- en: 'The app you will be working on, *ShareOrder*, is a simple app that records
    and displays what you want to order at a restaurant. Let''s build and run this
    app to see how it works. Follow these steps:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 您将要工作的应用程序`*ShareOrder*`是一个简单的应用程序，用于记录和显示您在餐厅想要订购的内容。让我们构建并运行此应用程序以查看其工作原理。请按照以下步骤操作：
- en: 'If you have not already done so, download the `Chapter25` folder of the code
    bundle for this book at this link: [https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition](https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition).'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您还没有这样做，请在此链接下载本书的代码包中的`Chapter25`文件夹：[https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition](https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition).
- en: Open the `Chapter25` folder, and you'll see two folders, `ShareOrder-start`
    and `ShareOrder-complete`. The first folder contains the app that you will be
    modifying for this lesson, and the second contains the completed app.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开`Chapter25`文件夹，您将看到两个文件夹，`ShareOrder-start`和`ShareOrder-complete`。第一个文件夹包含您在本课中将要修改的应用程序，第二个文件夹包含完成的应用程序。
- en: 'Open the `ShareOrder-start` folder and open the `ShareOrder` Xcode project.
    Click on the `Main` storyboard file in the Project navigator. You should see a
    **+** button in the navigation bar and a table view filling the rest of the screen.![Figure
    25.1: ShareOrder app with Main storyboard file displayed'
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 `ShareOrder-start` 文件夹并打开 `ShareOrder` Xcode项目。在项目导航器中点击 `Main` 故事板文件。你应该在导航栏中看到一个
    **+** 按钮，以及填充其余屏幕的表格视图。![图25.1：显示Main故事板文件的ShareOrder应用
- en: '](img/Figure_25.01_B17469.jpg)'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_25.01_B17469.jpg)'
- en: 'Figure 25.1: ShareOrder app with Main storyboard file displayed'
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图25.1：显示Main故事板文件的ShareOrder应用
- en: The app will display a screen showing an empty table view upon launch. Tapping
    on the **+** button will present a dialog box, which allows you to enter an order,
    which will then appear in the table view.
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 应用启动时将显示一个显示空表格视图的屏幕。点击 **+** 按钮将弹出一个对话框，允许你输入一个订单，然后该订单将出现在表格视图中。
- en: 'Click the `ViewController` file in the Project navigator. You should see the
    following code in the Editor area:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在项目导航器中点击 `ViewController` 文件。你应该在编辑器区域看到以下代码：
- en: '[PRE0]'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Let''s break this down:'
  id: totrans-46
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 让我们分解一下：
- en: '[PRE1]'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: This property holds an array of orders, which are of type `String`. This array
    will be the data source for the table view in the app.
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此属性包含一个订单数组，其类型为 `String`。此数组将是应用中表格视图的数据源。
- en: '[PRE2]'
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This outlet is connected to the table view in the view controller scene inside
    the `Main` storyboard file.
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此出口连接到 `Main` 故事板文件中视图控制器场景中的表格视图。
- en: '`viewDidLoad()` method:'
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`viewDidLoad()` 方法：'
- en: The code in this method sets the title in the navigation bar to `ShareOrder`,
    and registers the reuse identifier `orderCell` for the table view cells.
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此方法中的代码将导航栏的标题设置为 `ShareOrder`，并为表格视图单元格注册重用标识符 `orderCell`。
- en: '`addOrder(_:)` method:'
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`addOrder(_:)` 方法：'
- en: This method is connected to the `orders` array and reload the table view. Tapping
    `orders` array. Each cell in the table view will display the corresponding string
    in the `orders` array.
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此方法连接到 `orders` 数组并重新加载表格视图。点击 `orders` 数组。表格视图中的每个单元格将显示 `orders` 数组中的对应字符串。
- en: Tip
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 小贴士
- en: You may wish to review [*Chapter 15*](B17469_15_Final_VK_ePub.xhtml#_idTextAnchor213)*,
    Getting Started with Table Views*, which covers the table view data source methods
    in more detail.
  id: totrans-56
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你可能希望回顾 [*第15章*](B17469_15_Final_VK_ePub.xhtml#_idTextAnchor213)*，开始使用表格视图，*，它更详细地介绍了表格视图数据源方法。
- en: 'Build and run the app. Tap the **+** button, enter some text in the alert''s
    text field, and tap **Save**. It will appear in the table view, as shown below:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 构建并运行应用。点击 **+** 按钮，在警告框的文本字段中输入一些文本，然后点击 **保存**。它将出现在表格视图中，如下所示：
- en: '![Figure 25.2: iOS Simulator running the ShareOrder app'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '![图25.2：iOS模拟器运行ShareOrder应用'
- en: '](img/Figure_25.02_B17469.jpg)'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_25.02_B17469.jpg)'
- en: 'Figure 25.2: iOS Simulator running the ShareOrder app'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 图25.2：运行ShareOrder应用的iOS模拟器
- en: Now that you are familiar with the *ShareOrder* app and how it works, you will
    add Group Activities support for it. After you have done so, adding an order during
    a SharePlay session will make the order appear on the screen of all participants.
    You'll start by creating a custom Group Activity for the *ShareOrder* app in the
    next section.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经熟悉了 *ShareOrder* 应用及其工作原理，你将为它添加群组活动支持。完成此操作后，在 SharePlay 会话中添加订单将使订单出现在所有参与者的屏幕上。你将在下一节中创建一个用于
    *ShareOrder* 应用的自定义群组活动。
- en: Creating a custom Group Activity
  id: totrans-62
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建自定义群组活动
- en: 'You have seen that the *ShareOrder* app lets you add orders which will be displayed
    on the screen. You will add a group activity for this app that lets participants
    add orders during a SharePlay session which will appear on every participant''s
    screen. A custom object is required to represent this activity. The steps required
    to implement this are as follows:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经看到 *ShareOrder* 应用允许你添加将在屏幕上显示的订单。你将为该应用添加一个群组活动，允许参与者在 SharePlay 会话中添加订单，这些订单将出现在每个参与者的屏幕上。需要一个自定义对象来表示此活动。实现此功能所需的步骤如下：
- en: Add the Group Activities entitlement to the *ShareOrder* app.
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将群组活动权限添加到 *ShareOrder* 应用中。
- en: Create a new structure named `ShareOrder` that conforms to the `GroupActivity`
    protocol, and configure the group activity metadata.
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个名为 `ShareOrder` 的新结构，使其符合 `GroupActivity` 协议，并配置群组活动元数据。
- en: Add a button to the *ShareOrder* app's user interface and add an action for
    this button to activate the group activity.
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 *ShareOrder* 应用的用户界面中添加一个按钮，并为该按钮添加一个动作以激活群组活动。
- en: Important Information
  id: totrans-67
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 重要信息
- en: 'You can learn more about creating a custom Group Activity at this link: [https://developer.apple.com/documentation/groupactivities/inviting-participants-to-share-an-activity](https://developer.apple.com/documentation/groupactivities/inviting-participants-to-share-an-activity).'
  id: totrans-68
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您可以通过此链接了解有关创建自定义组活动的更多信息：[https://developer.apple.com/documentation/groupactivities/inviting-participants-to-share-an-activity](https://developer.apple.com/documentation/groupactivities/inviting-participants-to-share-an-activity).
- en: Let's start by adding the Group Activities entitlement to the *ShareOrder* app
    in the next section.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从将组活动权限添加到 *ShareOrder* 应用程序开始。
- en: Adding the Group Activities entitlement
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 添加组活动权限
- en: 'Because your app will have interactions between different devices, it must
    have the `com.apple.developer.group-session` entitlement. You''ll use Xcode to
    add this entitlement to your app. Note that you need a paid Apple developer account
    for this. Follow these steps:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 因为您的应用将在不同设备之间进行交互，所以它必须具有 `com.apple.developer.group-session` 权限。您将使用 Xcode
    将此权限添加到您的应用中。请注意，您需要付费的 Apple 开发者账户才能完成此操作。请按照以下步骤操作：
- en: 'Click the `ShareOrder` project (the topmost item in the Project navigator)
    and click the `ShareOrder` target. Select the **Signing & Capabilities** pane
    in the Editor area. Verify that **Team** has been set to a paid Apple developer
    account.![Figure 25.3: Xcode Signing & Capabilities pane with account set'
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在项目导航器中单击 `ShareOrder` 项目（项目导航器中最顶部的项目）并单击 `ShareOrder` 目标。在编辑区域中选择 **签名与能力**
    选项卡。验证是否已将 **团队** 设置为付费的 Apple 开发者账户。![图 25.3：Xcode 签名与能力选项卡，已设置账户
- en: '](img/Figure_25.03_B17469.jpg)'
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_25.03_B17469.jpg)'
- en: 'Figure 25.3: Xcode Signing & Capabilities pane with account set'
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 25.3：Xcode 签名与能力选项卡，已设置账户
- en: Tip
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 小贴士
- en: Instructions on how to set a development team and how to run your app on an
    iOS device are provided in [*Chapter 1*](B17469_01_Final_VK_ePub.xhtml#_idTextAnchor016)*,
    Getting Familiar with Xcode*.
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在 [*第 1 章*](B17469_01_Final_VK_ePub.xhtml#_idTextAnchor016)*，熟悉 Xcode* 中提供了如何设置开发团队以及在
    iOS 设备上运行您的应用的说明。
- en: Instructions on how to get a paid Apple Developer account are provided in [*Chapter
    26*](B17469_26_Final_VK_ePub.xhtml#_idTextAnchor496)*, Testing and Submitting
    Your App to the App Store*.
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在 [*第 26 章*](B17469_26_Final_VK_ePub.xhtml#_idTextAnchor496)*，测试并将您的应用提交到 App
    Store* 中提供了如何获取付费 Apple 开发者账户的说明。
- en: Plug in one of your iOS devices running iOS 15 and verify that the *ShareOrder*
    app can run on your device.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将运行 iOS 15 的 iOS 设备连接到您的计算机，并验证 *ShareOrder* 应用程序是否可以在您的设备上运行。
- en: 'In the **Signing and Capabilities** pane, click the **+** button to add a capability
    to the *ShareOrder* app.![Figure 25.4: Xcode Signing and Capabilities pane with
    + button highlighted'
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 **签名和能力** 选项卡中，单击 **+** 按钮以向 *ShareOrder* 应用程序添加能力。![图 25.4：Xcode 签名和能力选项卡，突出显示
    + 按钮
- en: '](img/Figure_25.04_B17469.jpg)'
  id: totrans-80
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_25.04_B17469.jpg)'
- en: 'Figure 25.4: Xcode Signing and Capabilities pane with + button highlighted'
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 25.4：Xcode 签名和能力选项卡，突出显示 + 按钮
- en: 'In the window that appears, search for and double-click the Group Activities
    capability to add it to the *ShareOrder* app:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在出现的窗口中，搜索并双击组活动功能以将其添加到 *ShareOrder* 应用程序：
- en: '![Figure 25.5: Group Activities capability added to ShareOrder app'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 25.5：将组活动功能添加到 ShareOrder 应用程序'
- en: '](img/Figure_25.05_B17469.jpg)'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_25.05_B17469.jpg)'
- en: 'Figure 25.5: Group Activities capability added to ShareOrder app'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 图 25.5：将组活动功能添加到 ShareOrder 应用程序
- en: You have added the Group Activities entitlement to the *ShareOrder* app. Next,
    you will create a `ShareOrder` structure to represent a group activity in the
    next section.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 您已将组活动权限添加到 *ShareOrder* 应用程序。接下来，您将在下一节中创建一个 `ShareOrder` 结构来表示组活动。
- en: Creating the ShareOrder structure
  id: totrans-87
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建 ShareOrder 结构
- en: 'The activity that you will implement for the *ShareOrder* app will let orders
    added during a SharePlay session appear on the screen of all participants. You
    need an object to represent this activity. You will implement this object by creating
    a `ShareOrder` structure. This structure will conform the `GroupActivity` protocol,
    and will contain metadata describing the activity. To create and configure the
    `ShareOrder` structure, follow these steps:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 您将为 *ShareOrder* 应用程序实现的活动将使在 SharePlay 会话期间添加的订单出现在所有参与者的屏幕上。您需要一个对象来表示此活动。您将通过创建一个
    `ShareOrder` 结构来实现此对象。此结构将遵循 `GroupActivity` 协议，并包含描述活动的元数据。要创建和配置 `ShareOrder`
    结构，请按照以下步骤操作：
- en: 'Click the `ViewController` file in the Project navigator and import the `GroupActivities`
    framework as shown:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在项目导航器中单击 `ViewController` 文件，并按如下所示导入 `GroupActivities` 框架：
- en: '[PRE3]'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Add the following extension after the last curly brace to create and configure
    the `ShareOrder` structure:'
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在最后一个花括号之后添加以下扩展来创建和配置`ShareOrder`结构：
- en: '[PRE4]'
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: This structure represents the *ShareOrder* app's shareable experience. It conforms
    to the `GroupActivity` protocol, which provides context and metadata to start
    an activity-related session. Here, you use a computed property named `metadata`
    to set the metadata title and the comment. For custom activities, the metadata
    type is set to `.generic`.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 此结构表示*ShareOrder*应用的共享体验。它符合`GroupActivity`协议，该协议提供上下文和元数据以启动活动相关的会话。在此，您使用名为`metadata`的计算属性来设置元数据标题和注释。对于自定义活动，元数据类型设置为`.generic`。
- en: You have created and configured the `ShareOrder` structure. In the next section,
    you will add a button to the *ShareOrder* app's user interface and configure this
    button to activate the group activity during a FaceTime session.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 您已创建并配置了`ShareOrder`结构。在下一节中，您将在*ShareOrder*应用的用户界面中添加一个按钮，并配置此按钮以便在FaceTime会话期间激活群组活动。
- en: Activating a custom group activity
  id: totrans-95
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 激活自定义群组活动
- en: 'You have created and configured the `ShareOrder` structure used to represent
    a custom group activity for the *ShareOrder* app. Now you will add a button to
    the *ShareOrder* app''s navigation bar to activate this group activity while you
    are in a FaceTime session with other participants. Follow these steps:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 您已创建并配置了用于表示*ShareOrder*应用自定义群组活动的`ShareOrder`结构。现在，您将在*ShareOrder*应用的导航栏中添加一个按钮，以便在与其他参与者进行FaceTime会话时激活此群组活动。按照以下步骤操作：
- en: Click the `Main` storyboard file in the Project navigator and click the Library
    button.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在项目导航器中点击`Main`故事板文件，然后点击图书馆按钮。
- en: 'In the Library''s filter field, search for a **Bar Button Item** object and
    drag it to the navigation bar next to the **+** button:![Figure 25.6: Library
    with Bar Button Item selected'
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在图书馆的筛选字段中，搜索一个**栏按钮项**对象并将其拖动到**+**按钮旁边的导航栏中：![图25.6：选择栏按钮项的图书馆
- en: '](img/Figure_25.06_B17469.jpg)'
  id: totrans-99
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_25.06_B17469.jpg)'
- en: 'Figure 25.6: Library with Bar Button Item selected'
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图25.6：选择栏按钮项的图书馆
- en: 'With the bar button item selected, click the Attributes inspector button. Under
    `person.2.fill`:![Figure 25.7: Attributes inspector showing bar button item with
    Image set to person.2.fill'
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在选择栏按钮项后，点击属性检查器按钮。在`person.2.fill`下：![图25.7：属性检查器显示设置为person.2.fill的栏按钮项
- en: '](img/Figure_25.07_B17469.jpg)'
  id: totrans-102
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_25.07_B17469.jpg)'
- en: 'Figure 25.7: Attributes inspector showing bar button item with Image set to
    person.2.fill'
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图25.7：属性检查器显示设置为person.2.fill的栏按钮项
- en: This sets the icon for the bar button item.
  id: totrans-104
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这设置了栏按钮项的图标。
- en: Click the Adjust Editor Options button and choose `ViewController` file will
    appear in the assistant editor.
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击调整编辑器选项按钮并选择`ViewController`文件将出现在辅助编辑器中。
- en: '*Control + Drag* from the bar button item you just added to just before the
    `addOrder(_:)` method in the assistant editor.'
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从您刚刚添加的栏按钮项**控制+拖动**到辅助编辑器中`addOrder(_:)`方法之前。
- en: A pop-up dialog box will appear.
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将会出现一个弹出对话框。
- en: 'In the `activateGroupActivity` and click **Connect**:![Figure 25.8: Pop-up
    dialog box with Name set to activateGroupActivity'
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`activateGroupActivity`中点击**连接**：![图25.8：名称设置为activateGroupActivity的弹出对话框
- en: '](img/Figure_25.08_B17469.jpg)'
  id: totrans-109
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_25.08_B17469.jpg)'
- en: 'Figure 25.8: Pop-up dialog box with Name set to activateGroupActivity'
  id: totrans-110
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图25.8：名称设置为activateGroupActivity的弹出对话框
- en: 'Add the following code to the `activateGroupActivity(_:)` method to activate
    the group activity when the bar button item is tapped:'
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下代码添加到`activateGroupActivity(_:)`方法中，以便在点击栏按钮项时激活群组活动：
- en: '[PRE5]'
  id: totrans-112
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: This will display a SharePlay prompt with a **Join** button to all participants
    in the FaceTime session.
  id: totrans-113
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这将向FaceTime会话中的所有参与者显示一个带有**加入**按钮的SharePlay提示。
- en: Click the **x** button to close the assistant editor.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**x**按钮关闭辅助编辑器。
- en: You have just added a button that will activate your group activity when tapped.
    In the next section, you'll learn how to manage a group activity session in the
    *ShareOrder* app.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 您刚刚添加了一个按钮，当点击时将激活您的群组活动。在下一节中，您将学习如何在*ShareOrder*应用中管理群组活动会话。
- en: Managing a group activity session
  id: totrans-116
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 管理群组活动会话
- en: 'You have created the `ShareOrder` structure to represent a group activity for
    the *ShareOrder* app, and you have added a button to the app''s navigation bar
    to activate the group activity during a FaceTime session. Now you need to add
    code to allow participants to join this group activity session and keep all participants
    in sync with one another. The steps required to implement this are as follows:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经创建了`ShareOrder`结构来表示`*ShareOrder*`应用的组活动，并且你已经在应用的导航栏中添加了一个按钮，用于在FaceTime会话期间激活组活动。现在你需要添加代码以允许参与者加入这个组活动会话，并使所有参与者保持同步。实现此功能所需的步骤如下：
- en: Create a `GroupSession` object that lets the app join a group activity session.
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个允许应用加入组活动会话的`GroupSession`对象。
- en: Create a `GroupSessionMessenger` object that lets the app send and receive messages
    to synchronize content.
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个允许应用发送和接收消息以同步内容的`GroupSessionMessenger`对象。
- en: Important Information
  id: totrans-120
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 重要信息
- en: 'You can learn more about session management at this link: [https://developer.apple.com/documentation/groupactivities/joining-your-app-to-a-shared-activity](https://developer.apple.com/documentation/groupactivities/joining-your-app-to-a-shared-activity).'
  id: totrans-121
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你可以通过此链接了解更多关于会话管理的信息：[https://developer.apple.com/documentation/groupactivities/joining-your-app-to-a-shared-activity](https://developer.apple.com/documentation/groupactivities/joining-your-app-to-a-shared-activity)。
- en: Let's see how to implement and configure a `GroupSession` object for the *ShareOrder*
    app in the next section.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看如何在下一节中实现和配置`*ShareOrder*`应用的`GroupSession`对象。
- en: Implementing a GroupSession object
  id: totrans-123
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 实现一个`GroupSession`对象
- en: 'The *ShareOrder* app currently has an object to represent the group activity,
    and a button that is used to activate the group activity during a FaceTime session.
    You''ll add code to your app to implement a `GroupSession` object, which will
    allow participants to join the group activity session. To implement and configure
    the `GroupSession` object for the *ShareOrder* app, follow these steps:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 当前`*ShareOrder*`应用中有一个表示组活动的对象，以及一个在FaceTime会话期间激活组活动的按钮。你将在你的应用中添加代码以实现一个`GroupSession`对象，这将允许参与者加入组活动会话。为了为`*ShareOrder*`应用实现和配置`GroupSession`对象，请按照以下步骤操作：
- en: 'Click the `ViewController` file in the Project navigator. Add an optional property
    after the `orders` property to hold an instance of the group activity session:'
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在项目导航器中点击`ViewController`文件。在`orders`属性之后添加一个可选属性来保存组活动会话的实例：
- en: '[PRE6]'
  id: totrans-126
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Add the following code to `viewDidLoad()` to create an asynchronous task to
    receive a group session:'
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下代码添加到`viewDidLoad()`中，以创建一个异步任务来接收一个组会话：
- en: '[PRE7]'
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Add the following code to the extension after the `ShareOrder` structure definition
    to implement the `configureGroupSession(_:)` method:'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下代码添加到`ShareOrder`结构定义之后的扩展中，以实现`configureGroupSession(_:)`方法：
- en: '[PRE8]'
  id: totrans-130
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: This method removes all the orders in the `orders` array, then assigns the received
    group activity session to the `groupSession` property.
  id: totrans-131
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此方法会移除`orders`数组中的所有订单，然后将接收到的组活动会话分配给`groupSession`属性。
- en: 'Modify the `configureGroupSession(_:)` method by adding code to join the group
    activity session:'
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过添加代码来修改`configureGroupSession(_:)`方法，以便加入组活动会话：
- en: '[PRE9]'
  id: totrans-133
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Now that you've implemented and configured the `GroupSession` object, you'll
    implement and configure a `GroupSessionMessenger` object for the *ShareOrder*
    app in the next section.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经实现和配置了`GroupSession`对象，你将在下一节中实现和配置`*ShareOrder*`应用的`GroupSessionMessenger`对象。
- en: Implementing a GroupSessionMessenger object
  id: totrans-135
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 实现一个`GroupSessionMessenger`对象
- en: 'Once the users of the *ShareOrder* app have joined the SharePlay session, any
    orders they add to the app will appear on everyone''s screen. This synchronization
    is handled by a `GroupSessionMessenger` object, which can send messages to and
    receive messages from other devices in the group activity session. Do note that
    it is important to keep the size of the messages small, as large message sizes
    may cause apps to crash. For this app, the messages will just hold the strings
    containing the orders submitted, which will be quite small. To implement the `GroupSessionMessenger`
    object for the *ShareOrder* app, follow these steps:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 当`*ShareOrder*`应用的用户加入SharePlay会话后，他们添加到应用中的任何订单都会出现在每个人的屏幕上。这种同步由一个`GroupSessionMessenger`对象处理，该对象可以向组活动会话中的其他设备发送和接收消息。请注意，保持消息大小较小非常重要，因为大的消息大小可能会导致应用崩溃。对于此应用，消息将仅包含提交的订单的字符串，这将相当小。为了为`*ShareOrder*`应用实现`GroupSessionMessenger`对象，请按照以下步骤操作：
- en: 'In the `ViewController` file, add a new optional property after the `groupSession`
    property to hold an instance of `GroupSessionMessenger`:'
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`ViewController`文件中，在`groupSession`属性之后添加一个新的可选属性以保存`GroupSessionMessenger`的一个实例：
- en: '[PRE10]'
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Modify the `configureGroupSession(_:)` method to create an instance of `GroupSessionMessenger`
    and assign it to the `messenger` property:'
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改`configureGroupSession(_:)`方法以创建`GroupSessionMessenger`的一个实例并将其分配给`messenger`属性：
- en: '[PRE11]'
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Add an asynchronous task to receive `GroupSessionMessenger` messages after
    the `messenger` property assignment:'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`messenger`属性赋值后添加一个异步任务以接收`GroupSessionMessenger`消息：
- en: '[PRE12]'
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Implement the `handle(_:)` method after the `configureGroupSession(_:)` method
    as shown:'
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`configureGroupSession(_:)`方法之后实现`handle(_:)`方法，如下所示：
- en: '[PRE13]'
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: This method appends the string from the message to the `orders` array, and reloads
    the table view.
  id: totrans-145
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此方法将消息中的字符串追加到`orders`数组中，并重新加载表格视图。
- en: 'Modify the `addOrder(_:)` method as follows to send a `GroupSessionMessenger`
    message when a participant taps the **+** button:'
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改`addOrder(_:)`方法如下，以便在参与者点击**+**按钮时发送`GroupSessionMessenger`消息：
- en: '[PRE14]'
  id: totrans-147
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: The code you added to the `addOrder(_:)` method creates an asynchronous task
    that sends the message containing the order to all other participants in the FaceTime
    session. When the message is received, it will be processed by the `handle(_:)`
    method, which adds the order to the `orders` array and reloads the table view.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 您添加到`addOrder(_:)`方法中的代码创建了一个异步任务，该任务将包含订单的消息发送给FaceTime会话中的所有其他参与者。当消息被接收时，它将由`handle(_:)`方法处理，该方法将订单添加到`orders`数组中并重新加载表格视图。
- en: Build and run the *ShareOrder* app on your iOS 15 device. It should work as
    it did before. In the next section, you'll test SharePlay in the *ShareOrder*
    app by using two iOS devices in a FaceTime session.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 在您的iOS 15设备上构建和运行*ShareOrder*应用。它应该像之前一样工作。在下一节中，您将通过使用FaceTime会话中的两台iOS设备来测试*ShareOrder*应用中的SharePlay功能。
- en: Testing SharePlay in the ShareOrder app
  id: totrans-150
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在ShareOrder应用中测试SharePlay
- en: 'You have added all the code required to implement SharePlay in the *ShareOrder*
    app. In order to test it, you''ll need two iOS devices running iOS 15.1 or later
    with the *ShareOrder* app installed. You could also use a Mac running macOS 12.1
    Monterey or later as one of the devices. You''ll initiate a FaceTime session between
    both devices and initiate a SharePlay session. You should be able to add orders
    from either device, and any orders you add will appear on both screens. Follow
    these steps:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 您已经添加了实现SharePlay所需的所有代码。为了测试它，您需要两台运行iOS 15.1或更高版本的iOS设备，并且已安装*ShareOrder*应用。您也可以使用运行macOS
    12.1 Monterey或更高版本的Mac作为其中一台设备。您将在两台设备之间启动FaceTime会话并启动SharePlay会话。您应该能够从任何设备添加订单，并且您添加的任何订单都将出现在两个屏幕上。按照以下步骤操作：
- en: Install the *ShareOrder* app on your second iOS device.
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您的第二台iOS设备上安装*ShareOrder*应用。
- en: 'Start a FaceTime call between the two devices and launch the *ShareOrder* app
    on the first device.![Figure 25.9: ShareOrder running on first device during FaceTime
    call'
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在两台设备之间启动FaceTime通话并在第一台设备上启动*ShareOrder*应用。![图25.9：在FaceTime通话期间在第一台设备上运行ShareOrder
- en: '](img/Figure_25.09_B17469.jpg)'
  id: totrans-154
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图片](img/Figure_25.09_B17469.jpg)'
- en: 'Figure 25.9: ShareOrder running on first device during FaceTime call'
  id: totrans-155
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图25.9：在FaceTime通话期间在第一台设备上运行ShareOrder
- en: 'Tap the button to activate the group activity. You should see a SharePlay prompt
    on the second device.![Figure 25.10: Tapping button on first device triggers SharePlay
    prompt on second device'
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击按钮以激活群组活动。您应该在第二台设备上看到一个SharePlay提示。![图25.10：在第一台设备上点击按钮触发第二台设备上的SharePlay提示
- en: '](img/Figure_25.10_B17469.jpg)'
  id: totrans-157
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图片](img/Figure_25.10_B17469.jpg)'
- en: 'Figure 25.10: Tapping button on first device triggers SharePlay prompt on second
    device'
  id: totrans-158
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图25.10：在第一台设备上点击按钮会在第二台设备上触发SharePlay提示
- en: Tap the **Join** button in the SharePlay prompt, and the *ShareOrder* app will
    launch on the second device. Add an order using the **+** button, and it will
    appear on the screen of both devices.
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在SharePlay提示中点击**加入**按钮，*ShareOrder*应用将在第二台设备上启动。使用**+**按钮添加一个订单，它将出现在两台设备的屏幕上。
- en: '![Figure 25.11: Same orders appear on both devices'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '![图25.11：相同的订单出现在两台设备上'
- en: '](img/Figure_25.11_B17469.jpg)'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '![图片](img/Figure_25.11_B17469.jpg)'
- en: 'Figure 25.11: Same orders appear on both devices'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 图25.11：相同的订单出现在两台设备上
- en: Congratulations! You've just implemented SharePlay in the *ShareOrder* app!
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！您已经在*ShareOrder*应用中实现了SharePlay功能！
- en: Summary
  id: totrans-164
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, you implemented SharePlay for the *ShareOrder* app by adding
    Group Activities support to it.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您通过向*ShareOrder*应用添加群组活动支持来实现SharePlay功能。
- en: You started by learning how SharePlay works. Next, you explored the *ShareOrder*
    app to see how it works. After that, you created a custom group activity for this
    app, and added code to manage a group activity session. Finally, you tested the
    SharePlay experience in the app using two iOS devices.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 你首先学习了 SharePlay 的工作原理。接下来，你探索了 *ShareOrder* 应用程序以了解其工作方式。之后，你为该应用程序创建了一个自定义的群组活动，并添加了代码来管理群组活动会话。最后，你使用两台
    iOS 设备在应用程序中测试了 SharePlay 体验。
- en: You now understand the basics of SharePlay and will now be able to add custom
    group activities into your own apps.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你已经了解了 SharePlay 的基础知识，并将能够将自定义群组活动添加到自己的应用程序中。
- en: In the next chapter, you will learn how to test and submit your app to the App
    Store.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，你将学习如何测试并将你的应用程序提交到 App Store。
