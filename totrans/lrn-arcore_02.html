<html><head></head><body>
        

                            
                    <h1 class="header-title">ARCore on Android</h1>
                
            
            
                
<p>Google developed ARCore to be accessible from multiple development platforms (Android [Java], Web [JavaScript], Unreal [C++], and Unity [C#]), thus giving developers plenty of flexibility and options to build applications on various platforms. While each platform has its strengths and weaknesses, which we will get to later, all the platforms essentially extend from the native Android SDK that was originally built as Tango. This means that regardless of your choice of platform, you will need to install and be somewhat comfortable working with the Android development tools.</p>
<p>In this chapter, we will focus on setting up the Android development tools and building an ARCore application for Android. The following is a summary of the major topics we will cover in this chapter:</p>
<ul>
<li>Installing Android Studio</li>
<li>Installing ARCore</li>
<li>Build and deploy</li>
<li>Exploring the code</li>
</ul>
<p>If you have experience working with the Android tools and already have the SDK installed, you may want to just skim over the first three sections. Otherwise, be sure to follow along with the exercises in this chapter, as these steps will be required to undertake exercises in many other areas of this book.</p>
<p>At the time of writing, in order to perform any of the exercises in this book, you will need an ARCore-supported device. The list of supported devices can be found at <a href="https://developers.google.com/ar/discover/#supported_devices" target="_blank">https://developers.google.com/ar/discover/#supported_devices</a>. There has been some work done by others to add support for earlier devices, so if you have an unsupported device, that may be an option. You can find more details about the <kbd>ARCore for All</kbd> project at <a href="https://github.com/tomthecarrot/arcore-for-all">https://github.com/tomthecarrot/arcore-for-all</a>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Installing Android Studio</h1>
                
            
            
                
<p>Android Studio is a development environment for coding and deploying Android applications. As such, it contains the core set of tools we will need for building and deploying our applications to an Android device. After all, ARCore needs to be installed to a physical device in order to test. Follow the given instructions to install Android Studio for your development environment:</p>
<ol>
<li>Open a browser on your development computer to <a href="https://developer.android.com/studio">https://developer.android.com/studio</a>.</li>
<li>Click on the green DOWNLOAD ANDROID STUDIO button.</li>
<li>Agree to the Terms and Conditions<strong> </strong>and follow the instructions to download.</li>
<li>After the file has finished downloading, run the installer for your system.</li>
<li>Follow the instructions on the installation dialog to proceed. If you are installing on Windows, ensure that you set a memorable installation path that you can easily find later, as shown in the following example:</li>
</ol>
<div><img src="img/456d1ec8-849f-4fbf-bfb2-5a40b076c018.png" style="font-family: 'Times New Roman', times, serif;font-size: 10pt;text-align: center;width:33.92em;height:26.33em;"/></div>
<p>Setting the install path for Windows</p>
<ol start="6">
<li>Click through the remaining dialogs to complete the installation.</li>
</ol>
<ol start="7">
<li>When the installation is complete, you will have the option to launch the program. Ensure that the option to launch Android Studio is selected and click on Finish.</li>
</ol>
<p>Android Studio comes embedded with OpenJDK. This means we can omit the steps to installing Java, on Windows at least. If you are doing any serious Android development, again on Windows, then you should go through the steps on your own to install the full Java JDK 1.7 and/or 1.8, especially if you plan to work with older versions of Android.</p>
<p>On Windows, we will install everything to <kbd>C:\Android</kbd>; that way, we can have all the Android tools in one place. If you are using another OS, use a similar well-known path.</p>
<p>Now that we have Android Studio installed, we are not quite done. We still need to install the SDK tools that will be essential for building and deployment. Follow the instructions in the next exercise to complete the installation:</p>
<ol>
<li>If you have not installed the Android SDK before, you will be prompted to install the SDK when Android Studio first launches, as shown:</li>
</ol>
<div><img src="img/ec9364dd-45ba-4320-9c48-7c2a7bc91582.png" style="font-family: 'Times New Roman', times, serif;font-size: 10pt;text-align: center;width:33.75em;height:25.50em;"/></div>
<p>Setting the SDK installation path for Windows</p>
<ol start="2">
<li>Select the SDK components and ensure that you set the installation path to a well-known location, again, as shown in the preceding screenshot.</li>
<li>Leave the Welcome to Android Studio dialog open for now. We will come back to it in a later exercise.</li>
</ol>
<p>That completes the installation of Android Studio. In the next section, we will get into installing ARCore.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Installing ARCore</h1>
                
            
            
                
<p>Of course, in order to work with or build any ARCore applications, we will need to install the SDK for our chosen platform. Follow the given instructions to install the ARCore SDK:</p>
<p>We will use Git to pull down the code we need directly from the source. You can learn more about Git and how to install it on your platform at <a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">https://git-scm.com/book/en/v2/Getting-Started-Installing-Git</a> or use Google to search: getting started installing Git. Ensure that when you install on Windows, you select the defaults and let the installer set the <kbd>PATH</kbd> environment variables.</p>
<ol>
<li>Open Command Prompt or Windows shell and navigate to the Android (<kbd>C:\Android</kbd> on Windows) installation folder.</li>
<li>Enter the following command:</li>
</ol>
<pre style="padding-left: 60px"><strong>git clone https://github.com/google-ar/arcore-android-sdk.git</strong></pre>
<ol start="3">
<li>This will download and install the ARCore SDK into a new folder called <kbd>arcore-android-sdk</kbd>, as illustrated in the following screenshot:</li>
</ol>
<div><img src="img/a1d8b719-9fd2-4611-954a-498f9313e07a.png" style="font-family: 'Times New Roman', times, serif;font-size: 10pt;text-align: center;width:37.25em;height:20.92em;"/></div>
<p>Command window showing the installation of ARCore</p>
<ol start="4">
<li>Ensure that you leave the command window open. We will be using it again later.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">Installing the ARCore service on a device</h1>
                
            
            
                
<p>Now, with the ARCore SDK installed on our development environment, we can proceed with installing the ARCore service on our test device. Use the following steps to install the ARCore service on your device:</p>
<p>NOTE: this step is only required when working with the Preview SDK of ARCore. When Google ARCore 1.0 is released you will not need to perform this step.</p>
<ol>
<li>Grab your mobile device and enable the developer and debugging options by doing the following:
<ol>
<li>Opening the Settings app</li>
<li>Selecting the System</li>
<li>Scrolling to the bottom and selecting About phone</li>
<li>Scrolling again to the bottom and tapping on Build number seven times</li>
<li>Going back to the previous screen and selecting Developer options near the bottom</li>
<li>Selecting USB debugging</li>
</ol>
</li>
<li>Download the ARCore service APK from <a href="https://github.com/google-ar/arcore-android-sdk/releases/download/sdk-preview/arcore-preview.apk">https://github.com/google-ar/arcore-android-sdk/releases/download/sdk-preview/arcore-preview.apk</a> to the Android installation folder (<kbd>C:\Android</kbd>). Also note that this URL will likely change in the future.</li>
<li>Connect your mobile device with a USB cable. If this is your first time connecting, you may have to wait several minutes for drivers to install. You will then be prompted to switch on the device to allow the connection. Select Allow to enable the connection.</li>
<li>Go back to your Command Prompt or Windows shell and run the following command:</li>
</ol>
<pre class="devsite-terminal devsite-click-to-copy" style="padding-left: 120px"><strong>adb install -r -d arcore-preview.apk</strong><br/>//ON WINDOWS USE:<br/><strong>sdk\platform-tools\adb install -r -d arcore-preview.apk </strong></pre>
<p>After the command is run, you will see the word <kbd>Success</kbd>. If you have encountered an error at this stage, ensure that you consult <a href="e7c0bdd1-e380-4498-af5a-fe9e627eb6cb.xhtml" target="_blank">Chapter 11</a>, <em>Performance Tips and Troubleshooting</em>, for more help.</p>
<p>This completes the installation of ARCore for the Android platform. In the next section, we will build our first sample ARCore application.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Build and deploy</h1>
                
            
            
                
<p>Now that we have all the tedious installation stuff out of the way, it's time to build and deploy a sample app to your Android device. Let's begin by jumping back to Android Studio and following the given steps:</p>
<ol>
<li>Select the Open an existing Android Studio project option from the Welcome to Android Studio window. If you accidentally closed Android Studio, just launch it again.</li>
<li>Navigate and select the <kbd>Android\arcore-android-sdk\samples\java_arcore_hello_ar</kbd> folder, as follows:</li>
</ol>
<div><img src="img/e8c3f8a9-e093-482f-b6aa-54ce1f658c46.png" style="font-family: 'Times New Roman', times, serif;font-size: 10pt;text-align: center;width:27.92em;height:32.50em;"/></div>
<p>Selecting the ARCore sample project folder</p>
<ol start="3">
<li>Click on OK. If this is your first time running this project, you will encounter some dependency errors, such as the one here:</li>
</ol>
<div><img src="img/5b68523d-de1c-406a-b0c9-7f0ab6bf80db.png" style="width:34.33em;height:5.92em;"/></div>
<p>Dependency error message</p>
<ol start="4">
<li>In order to resolve the errors, just click on the link at the bottom of the error message. This will open a dialog, and you will be prompted to accept and then download the required dependencies. Keep clicking on the links until you see no more errors.</li>
<li>Ensure that your mobile device is connected and then, from the menu, choose Run - Run. This should start the app on your device, but you may still need to resolve some dependency errors. Just remember to click on the links to resolve the errors. </li>
<li>This will open a small dialog. Select the app option. If you do not see the app option, select Build - Make Project from the menu. Again, resolve any dependency errors by clicking on the links.</li>
</ol>
<p>"Your patience will be rewarded."<br/>
                                                      - Alton Brown</p>
<ol start="7">
<li>Select your device from the next dialog and click on OK. This will launch the app on your device. Ensure that you allow the app to access the device's camera. The following is a screenshot showing the app in action:</li>
</ol>
<div><img src="img/d780081c-2bb6-4794-bf20-ff461c31bb5a.png" style="width:36.00em;height:18.50em;"/></div>
<p>Sample Android ARCore app running; the dog is real</p>
<p class="mce-root CDPAlignLeft CDPAlign">Great, we have built and deployed our first Android ARCore app together. In the next section, we will take a quick look at the Java source code.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Exploring the code</h1>
                
            
            
                
<p>Now, let's take a closer look at the main pieces of the app by digging into the source code. Follow the given steps to open the app's code in Android Studio:</p>
<ol>
<li>From the Project window, find and double-click on the <kbd>HelloArActivity</kbd>, as shown:</li>
</ol>
<div><img src="img/f01603f2-f3bb-447d-a53f-172d55280efb.png" style="font-family: 'Times New Roman', times, serif;font-size: 10pt;text-align: center;width:19.67em;height:13.58em;"/></div>
<p>HelloArActivity shown in the Project window</p>
<ol start="2">
<li>After the source is loaded, scroll through the code to the following section:</li>
</ol>
<pre style="padding-left: 60px">private void showLoadingMessage() {<br/> runOnUiThread(new Runnable() {<br/>  @Override<br/>  public void run() {<br/>   mLoadingMessageSnackbar = Snackbar.make(<br/>    HelloArActivity.this.findViewById(android.R.id.content),<br/>    "Searching for surfaces...",<br/>    Snackbar.LENGTH_INDEFINITE);<br/>   mLoadingMessageSnackbar.getView().setBackgroundColor(0xbf323232);<br/>   mLoadingMessageSnackbar.show();<br/>  }<br/> });<br/>}</pre>
<ol start="3">
<li>Note the highlighted text—<strong><kbd>"Searching for surfaces.."</kbd></strong>. Select this text and change it to <strong><kbd>"Searching for ARCore surfaces.."</kbd></strong>. The <kbd>showLoadingMessage</kbd> function is a helper for displaying the loading message. Internally, this function calls <kbd>runOnUIThread</kbd>, which in turn creates a new instance of <kbd>Runnable</kbd> and then adds an internal <kbd>run</kbd> function. We do this to avoid thread blocking on the UI, a major no-no. Inside the <kbd>run</kbd> function is where the messaging is set and the message <kbd>Snackbar</kbd> is displayed.</li>
<li>From the menu, select Run - Run 'app' to start the app on your device. Of course, ensure that your device is connected by USB.</li>
<li>Run the app on your device and confirm that the message has changed.</li>
</ol>
<p>Great, now we have a working app with some of our own code. This certainly isn't a leap, but it's helpful to walk before we run. At this point, go back and review the code, paying special attention to the comments and flow. If you have never developed an Android app, the code may look quite intimidating, and it is. Not to worry, we will deconstruct and reuse several elements of this sample app in <a href="3bd45362-4747-4f1c-a313-d6ccf5f6b8fc.xhtml" target="_blank">Chapter 5</a>, <em>Real-World Motion Tracking</em>, and <a href="8390414c-80b0-413c-bcec-cfdad3f7ad5d.xhtml" target="_blank">Chapter 6</a>, <em>Understanding the Environment.</em></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Summary</h1>
                
            
            
                
<p>In this chapter, we started our exploration of ARCore by building and deploying an AR app for the Android platform. We did this by first installing Android Studio, which will be our go-to <strong>Integrated Development Environment</strong> (<strong>IDE</strong>) for Android development. Then, we installed the ARCore SDK and ARCore service onto our test mobile device. Next, we loaded up the sample ARCore app and patiently installed the various required build and deploy dependencies. After a successful build, we deployed the app to our device and tested. Finally, we tested making a minor code change and then deployed another version of the app. Doing this assured us that our Android development environment was fully functional, and we are now ready to proceed to the rest of the book.</p>
<p>Our journey continues in the next chapter, where we will build and deploy an ARCore app with the Unity platform. Unity is a leading free/commercial game engine we will use for our final project in <a href="6a8f64fb-080f-47a2-9565-4099269831b1.xhtml" target="_blank">Chapter 10</a>, <em>Mixing in Mixed Reality</em>.</p>


            

            
        
    </body></html>