<html><head></head><body>
		<div id="_idContainer539">
			<h1 id="_idParaDest-301"><em class="italic"><a id="_idTextAnchor431"/>Chapter 22</em>: Getting Started with Mac Catalyst </h1>
			<p>Apple's Mac Catalyst feature allows you to make a Mac version of an iPad app. This allows you to share the same project and source code for both platforms, making it easier to maintain. During WWDC2021, Apple announced updates to Mac Catalyst that allow you to add more features just for Mac, such as keyboard navigation and printing using <em class="italic">Command + P</em>. This chapter will focus on how to make your existing iPhone app run on iPad, so you can make a Mac version of it. By doing so, you will be able to reach an audience of over 100 million active Mac users.</p>
			<p>In this chapter, you'll modify your app to make it run on iPads and Macs. First, you'll fix some user interface issues in your app. Next, you'll learn how to make your app's user interface work on the iPad, taking advantage of the iPad's larger screen size. After that, you'll use the iPad version of your app to create the Mac version.</p>
			<p>By the end of this chapter, you'll be able to make your existing iOS apps run well on all iOS devices, and also be able to make Mac apps from your iPad apps.</p>
			<p>The following topics will be covered: </p>
			<ul>
				<li>Fixing user interface issues</li>
				<li>Making your app run on all iOS devices</li>
				<li>Making your app run on the Mac</li>
			</ul>
			<h1 id="_idParaDest-302"><a id="_idTextAnchor432"/>Technical requirements</h1>
			<p>You will continue working on the <strong class="source-inline">LetsEat</strong> project that you modified in the previous chapter.</p>
			<p>The completed Xcode project for this chapter is in the <strong class="source-inline">Chapter22</strong> folder of the code bundle for this book, which can be downloaded here:</p>
			<p><a href="https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition">https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition</a></p>
			<p>Check out the following video to see the code in action:</p>
			<p><a href="https://bit.ly/3IbY41R">https://bit.ly/3IbY41R</a></p>
			<p>Let's start by making some changes to the user interface to make it look better.</p>
			<h1 id="_idParaDest-303"><a id="_idTextAnchor433"/>Fixing user interface issues</h1>
			<p>One of the<a id="_idIndexMarker1233"/> things that you will find is that an iOS app is never really done. You'll always find ways to improve and refine your app. Build and run your app, and compare it with the design shown in the app tour (in <a href="B17469_09_Final_VK_ePub.xhtml#_idTextAnchor133"><em class="italic">Chapter 9</em></a>, <em class="italic">Setting Up the User Interface</em>). You will notice upon close inspection that your app's screens have minor differences when compared to the screens shown in the app tour, and require changes. Let's start with the <strong class="bold">Explore</strong> screen for your app:</p>
			<div>
				<div id="_idContainer517" class="IMG---Figure">
					<img src="image/Figure_22.01_B17469.jpg" alt="Figure 22.1: iOS Simulator showing Explore screen &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 22.1: iOS Simulator showing Explore screen </p>
			<p>The changes <a id="_idIndexMarker1234"/>required for the <strong class="bold">Explore</strong> screen are as follows. Refer to the numbers to see the part that needs to be changed:</p>
			<ul>
				<li>The navigation bar (<strong class="bold">1</strong>) is not present on the app tour and will have to be removed.</li>
				<li>The collection view cells (<strong class="bold">2</strong>) have sharp edges. You'll implement rounded corners for the cells to match the cells shown in the app tour.</li>
				<li>The tab bar buttons are blue (<strong class="bold">3</strong>). You'll change the tab bar button color to red to match the app tour.</li>
			</ul>
			<p>Now let's see the <strong class="bold">Locations</strong> screen for your app:</p>
			<div>
				<div id="_idContainer518" class="IMG---Figure">
					<img src="image/Figure_22.02_B17469.jpg" alt="Figure 22.2: iOS Simulator showing Locations screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 22.2: iOS Simulator showing Locations screen</p>
			<p>The large title at<a id="_idIndexMarker1235"/> the top of the <strong class="bold">Locations</strong> screen shown in the app tour is missing, and you will have to add it.</p>
			<p>As you can see, there are only four minor changes that need to be made, and these changes are easy to implement. You'll start by modifying the <strong class="bold">Explore</strong> screen. Follow these steps:</p>
			<ol>
				<li>Click the <strong class="source-inline">ExploreViewController</strong> file inside the <strong class="source-inline">Explore</strong> folder in the Project navigator.</li>
				<li>Add a <strong class="source-inline">viewWillAppear()</strong> method after the <strong class="source-inline">viewDidLoad()</strong> method, and add code inside this method to hide the navigation controller's navigation bar:<a id="_idTextAnchor434"/><a id="_idTextAnchor435"/><p class="source-code">override func viewWillAppear(_ animated: Bool) { </p><p class="source-code">   super.viewWillAppear(animated)</p><p class="source-code">   navigationController?.setNavigationBarHidden(true, </p><p class="source-code">   animated: false)</p><p class="source-code">}</p><p>Note that if you add this code to <strong class="source-inline">viewDidLoad()</strong>, the navigation bar will be hidden <a id="_idIndexMarker1236"/>only when the <strong class="bold">Explore</strong> screen first appears, and will reappear when you transition from either the <strong class="bold">Locations</strong> screen or the <strong class="bold">Restaurant List</strong> screen back to the <strong class="bold">Explore</strong> screen.</p></li>
				<li>To round the corners of the collection view cells on the <strong class="bold">Explore</strong> screen, click the <strong class="source-inline">ExploreCell</strong> file (inside the <strong class="source-inline">View</strong> folder in the <strong class="source-inline">Explore</strong> folder) in the Project navigator, and add the following method after the outlet declarations:<a id="_idTextAnchor436"/><a id="_idTextAnchor437"/> <p class="source-code">override func awakeFromNib() {</p><p class="source-code">   super.awakeFromNib() </p><p class="source-code">   exploreImageView.layer.cornerRadius = 9 </p><p class="source-code">   exploreImageView.layer.masksToBounds = true</p><p class="source-code">} </p></li>
				<li>To change the colors of the tab bar buttons, click the <strong class="source-inline">AppDelegate</strong> file in the Project navigator and add a <strong class="source-inline">private</strong> extension containing the following methods after the last curly brace<a id="_idTextAnchor438"/><a id="_idTextAnchor439"/>:<p class="source-code">private extension AppDelegate {</p><p class="source-code">   func initialize() {</p><p class="source-code">      setupDefaultColors()</p><p class="source-code">   }</p><p class="source-code">   func setupDefaultColors() { </p><p class="source-code">      UITabBar.appearance().tintColor = .systemRed</p><p class="source-code">      UITabBarItem.appearance().</p><p class="source-code">      setTitleTextAttributes(</p><p class="source-code">      [NSAttributedString.Key.foregroundColor: </p><p class="source-code">      UIColor.systemRed], for: </p><p class="source-code">      UIControl.State.selected)</p><p class="source-code">      UINavigationBar.appearance().tintColor = </p><p class="source-code">      .systemRed </p><p class="source-code">   }</p><p class="source-code">}</p><p>The <strong class="source-inline">AppDelegate</strong> file <a id="_idIndexMarker1237"/>contains the declaration and the definition of the <strong class="source-inline">AppDelegate</strong> class. This class handles application events, for example, what happens when an application is launched, sent to the background, terminated, and so on. You can add code here to configure your app as it is starting up. </p><p>As you have done before, you'll use an <strong class="source-inline">initialize()</strong> method to call all other setup methods. In this case, the <strong class="source-inline">initialize()</strong> method calls the <strong class="source-inline">setupDefaultColors()</strong> method.</p><p>The <strong class="source-inline">setupDefaultColors()</strong> method will change the tint colors for items in the tab bar and navigation bar to red. It makes use of the <strong class="source-inline">appearance()</strong> method, which sets attributes globally for every tab and nav bar that has been or will be created. </p><p class="callout-heading">Important Information</p><p class="callout">More information<a id="_idIndexMarker1238"/> about the <strong class="source-inline">appearance()</strong> method can be found here: <a href="https://developer.apple.com/documentation/uikit/uiappearance">https://developer.apple.com/documentation/uikit/uiappearance</a>.</p></li>
				<li>You have to call the <strong class="source-inline">initialize()</strong> method as the app is starting up, so modify the <strong class="source-inline">application(_:didFinishLaunchingWithOptions:)</strong> method as follows:<p class="source-code">func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions:[UIApplication.LaunchOptionsKey: Any]?) -&gt; Bool {</p><p class="source-code">   <strong class="bold">initialize()</strong></p><p class="source-code">   return true</p><p class="source-code">}</p></li>
				<li>Click the <strong class="source-inline">Main</strong> storyboard<a id="_idIndexMarker1239"/> file in the Project navigator. Under the <strong class="bold">Explore View Controller Scene</strong>, click <strong class="bold">Explore Image View</strong>. Select the Attributes inspector and under <strong class="bold">View</strong>, change the <strong class="bold">Content Mode</strong> to <strong class="bold">Aspect Fill</strong>: <div id="_idContainer519" class="IMG---Figure"><img src="image/Figure_22.03_B17469.jpg" alt="Figure 22.3: Main storyboard file showing Explore Image View set to Aspect Fill&#13;&#10;"/></div><p class="figure-caption">Figure 22.3: Main storyboard file showing Explore Image View set to Aspect Fill</p><p>This allows images to take up the full image view frame and display the rounded corners you coded in <em class="italic">Step 3</em>.</p><p>Build and run <a id="_idIndexMarker1240"/>your app. The <strong class="bold">Explore</strong> screen should look like this:</p><div id="_idContainer520" class="IMG---Figure"><img src="image/Figure_22.04_B17469.jpg" alt="Figure 22.4: iOS Simulator showing updated Explore screen&#13;&#10;"/></div><p class="figure-caption">Figure 22.4: iOS Simulator showing updated Explore screen</p><p>You'll see that the navigation bar is gone, the corners of each cell are rounded, and the <strong class="bold">Explore</strong> and <strong class="bold">Map</strong> button icons and titles are now red when selected.</p></li>
				<li>Next, you'll update the <strong class="source-inline">LocationViewController</strong> class. Click the <strong class="source-inline">LocationViewController</strong> file inside the <strong class="source-inline">Location</strong> folder in the Project navigator and modify the <strong class="source-inline">initialize()</strong> method to set a title for the <strong class="bold">Locations</strong> screen:<p class="source-code">func initialize() {</p><p class="source-code">   manager.fetch()</p><p class="source-code"><strong class="bold">   title = "Select a location"<a id="_idTextAnchor440"/><a id="_idTextAnchor441"/></strong></p><p class="source-code"><strong class="bold">   navigationController?.navigationBar.</strong></p><p class="source-code"><strong class="bold">   prefersLargeTitles = true</strong></p><p class="source-code">}</p><p>Each view <a id="_idIndexMarker1241"/>controller has a <strong class="source-inline">title</strong> property that can be displayed in the navigation bar. This code sets the title to <strong class="source-inline">Select a location</strong> and displays it in large letters at the top of the screen.</p><p>Build and run your app, and tap the <strong class="bold">LOCATION</strong> button. The <strong class="bold">Locations</strong> screen should look like this:</p></li>
			</ol>
			<div>
				<div id="_idContainer521" class="IMG---Figure">
					<img src="image/Figure_22.05_B17469.jpg" alt="Figure 22.5: iOS Simulator showing updated Locations screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 22.5: iOS Simulator showing updated Locations screen</p>
			<p>You'll <a id="_idIndexMarker1242"/>see <strong class="bold">Select a location</strong> in large letters at the top of the screen, and the <strong class="bold">Cancel</strong> and <strong class="bold">Done</strong> buttons are now red.</p>
			<p>Great! You've finished cleaning up the design for the app on the iPhone. The four issues mentioned earlier have been addressed, and your app's screens now look exactly like the screens shown in the app tour. As you can see, even minor changes can make your app more visually appealing.</p>
			<p>So far, you've been running your app in the iPhone simulator. In the next section, you'll run your app in the iPad simulator to see what changes are required. You'll then modify your app so that<a id="_idIndexMarker1243"/> the user interface will take advantage of the iPad's larger screen.</p>
			<h1 id="_idParaDest-304"><a id="_idTextAnchor442"/>Making your app run on all iOS devices</h1>
			<p>Before <a id="_idIndexMarker1244"/>you can <a id="_idIndexMarker1245"/>make a Mac app from your existing iOS app, you need to modify the user interface to work with iPad. To see what changes you will need to make, you'll build and run your app on the iPad simulator. Follow these steps:</p>
			<ol>
				<li value="1">Close the simulator if it is running. Choose <strong class="bold">iPad Pro (9.7-inch)</strong> from the list of simulators in the <strong class="bold">Scheme</strong> menu and run your app:<div id="_idContainer522" class="IMG---Figure"><img src="image/Figure_22.06_B17469.jpg" alt="Figure 22.6: Scheme menu with iPad Pro (9.7-inch) selected&#13;&#10;"/></div><p class="figure-caption">Figure 22.6: Scheme menu with iPad Pro (9.7-inch) selected</p></li>
				<li>The iPad simulator will launch and appear as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer523" class="IMG---Figure">
					<img src="image/Figure_22.07_B17469.jpg" alt=" Figure 22.7: iPad simulator showing Explore screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption"> Figure 22.7: iPad simulator showing Explore screen</p>
			<p>As you<a id="_idIndexMarker1246"/> can <a id="_idIndexMarker1247"/>see, the collection view on the <strong class="bold">Explore</strong> screen automatically takes up the whole width of the screen, and the collection view cells are the same size that they were on the iPhone. Even though you can use exactly the same user interface for both iPhone and iPad, it would be better if you could customize it to suit each device. </p>
			<p>To do this, you'll add some code so your app can identify the type of device it's running on. Next, you'll update your app's user interface to suit the iPad's larger screen and make your app automatically switch the user interface based on the device type.</p>
			<p>Let's see how to make your app detect the type of device it is running on in the next section.</p>
			<h2 id="_idParaDest-305"><a id="_idTextAnchor443"/>Identifying device type</h2>
			<p>You need to <a id="_idIndexMarker1248"/>add some code to your app so that it knows the device it is running on. Follow these steps:</p>
			<ol>
				<li value="1">Right-click the <strong class="source-inline">Misc</strong> folder and select <strong class="bold">New File</strong>.</li>
				<li><strong class="bold">iOS</strong> should already be selected. Choose <strong class="bold">Swift File</strong> and then click <strong class="bold">Next</strong>.</li>
				<li>Name this file <strong class="source-inline">Device</strong>. Click <strong class="bold">Create</strong>. The <strong class="source-inline">Device</strong> file appears in the Project navigator.</li>
				<li>Modify the file as shown to create a <strong class="source-inline">Device</strong> enume<a id="_idTextAnchor444"/><a id="_idTextAnchor445"/>ration: <p class="source-code">import <strong class="bold">UIKit</strong></p><p class="source-code"><strong class="bold">enum Device {</strong></p><p class="source-code"><strong class="bold">   static var isPhone: Bool {</strong></p><p class="source-code"><strong class="bold">      UIDevice.current.userInterfaceIdiom == </strong></p><p class="source-code"><strong class="bold">      .phone</strong></p><p class="source-code"><strong class="bold">   }</strong></p><p class="source-code"><strong class="bold">   static var isPad: Bool {</strong></p><p class="source-code"><strong class="bold">      UIDevice.current.userInterfaceIdiom == </strong></p><p class="source-code"><strong class="bold">      .pad</strong></p><p class="source-code"><strong class="bold">   }</strong></p><p class="source-code"><strong class="bold">}</strong></p></li>
			</ol>
			<p>Here, an enumeration is used instead of a class or structure because you can't accidentally make an instance of it. The <strong class="source-inline">UIDevice</strong> class represents the device the app is running on. <strong class="source-inline">UIDevice.current.userInterfaceIdiom</strong> returns <strong class="source-inline">.phone</strong> if the app is running on an iPhone, and returns <strong class="source-inline">.pad</strong> if the app is running on an iPad. So <strong class="source-inline">isPhone</strong> returns <strong class="source-inline">true</strong> when the app is running on the iPhone, and <strong class="source-inline">isPad</strong> returns <strong class="source-inline">true</strong> when the app is running on the iPad.</p>
			<p>In addition to device type, you also have to consider device orientation. For example, an iPhone in landscape orientation is wider than an iPhone in portrait orientation even though it is the<a id="_idIndexMarker1249"/> same iPhone. Let's learn how to handle device orientation using <strong class="bold">size classes</strong> in the next section. </p>
			<h2 id="_idParaDest-306"><a id="_idTextAnchor446"/>Understanding size classes</h2>
			<p>Although<a id="_idIndexMarker1250"/> you can <a id="_idIndexMarker1251"/>now identify what kind of device your app is running on, you also have to consider the effects of device orientation on your user interface. It can be challenging to do this as there is a wide variety of screen sizes, in both portrait and landscape orientation. To make this easier, instead of using the physical resolution of the device, you will use size classes.</p>
			<p class="callout-heading">Important Information</p>
			<p class="callout">For more<a id="_idIndexMarker1252"/> information on size classes, see this link: <a href="https://developer.apple.com/design/human-interface-guidelines/ios/visual-design/adaptivity-and-layout/">https://developer.apple.com/design/human-interface-guidelines/ios/visual-design/adaptivity-and-layout/</a>.</p>
			<p>Size classes are traits which are automatically assigned to a view. Two classes are defined which describe the height and width of a view; regular (expansive space) and compact (constrained space). Let's look at size classes for a full-screen view on different devices:</p>
			<div>
				<div id="_idContainer524" class="IMG---Figure">
					<img src="image/Figure_22.08_B17469.jpg" alt="Figure 22.8: Size classes for different iOS devices&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 22.8: Size classes for different iOS devices</p>
			<p>You'll have to consider not only the device type, but also the size class when you're designing the user interface. In the next section, you'll learn how to set the collection view cell<a id="_idIndexMarker1253"/> size<a id="_idIndexMarker1254"/> based on device and size class.</p>
			<h2 id="_idParaDest-307"><a id="_idTextAnchor447"/>Updating the Explore screen</h2>
			<p>For the <strong class="bold">Explore</strong> screen, let's <a id="_idIndexMarker1255"/>say you <a id="_idIndexMarker1256"/>have decided to display three columns on the iPad, two columns for the compact width size class and three columns for the regular width size class. You'll add methods to set the size of the collection view cell depending on the device and orientation. Follow these steps:</p>
			<ol>
				<li value="1">Click the <strong class="source-inline">ExploreViewController</strong> file in the Project navigator and modify the <strong class="source-inline">initialize()</strong> method inside the <strong class="source-inline">private</strong> extension as follows:<p class="source-code">func initialize() { </p><p class="source-code">   manager.fetch() </p><p class="source-code">   <strong class="bold">setupCollectionView()</strong></p><p class="source-code">}</p><p>You'll see an error because <strong class="source-inline">setupCollectionView()</strong> is not declared or defined yet. You'll do that next.</p></li>
				<li>The <strong class="source-inline">setupCollectionView()</strong> method will be used to add a <strong class="source-inline">UICollectionViewFlowLayout</strong> instance to the collection view in the <strong class="bold">Explore</strong> screen. Declare and define this method after the <strong class="source-inline">initi<a id="_idTextAnchor448"/><a id="_idTextAnchor449"/>alize()</strong> method:<p class="source-code">func setupCollectionView() {</p><p class="source-code">   let flow = UICollectionViewFlowLayout()</p><p class="source-code">   flow.sectionInset = UIEdgeInsets(top: 7, left: 7, </p><p class="source-code">   bottom: 7, right: 7)</p><p class="source-code">   flow.minimumInteritemSpacing = 0</p><p class="source-code">   flow.minimumLineSpacing = 7</p><p class="source-code">   collectionView.collectionViewLayout = flow</p><p class="source-code">}</p><p>This method creates an instance of the <strong class="source-inline">UICollectionViewFlowLayout</strong> class, sets all the edge insets for the collection view to <strong class="source-inline">7</strong> points, sets the minimum interitem spacing to <strong class="source-inline">0</strong> points, sets the minimum line spacing to <strong class="source-inline">7</strong> points, and assigns it to the collection view. Remember that you initially set these values for the collection view using the Size inspector in <a href="B17469_10_Final_VK_ePub.xhtml#_idTextAnchor155"><em class="italic">Chapter 10</em></a><em class="italic">, Building Your User Interface</em>.</p></li>
				<li>Add an <a id="_idIndexMarker1257"/>extension containing the <a id="_idIndexMarker1258"/>methods that will set the size of the collection view cells and the collection view section header after the clo<a id="_idTextAnchor450"/><a id="_idTextAnchor451"/>sing curly brace:<p class="source-code">extension ExploreViewController: UICollectionViewDelegateFlowLayout {</p><p class="source-code">   func collectionView(_ collectionView: </p><p class="source-code">   UICollectionView, layout collectionViewLayout: </p><p class="source-code">   UICollectionViewLayout, sizeForItemAt indexPath: </p><p class="source-code">   IndexPath) -&gt; CGSize {</p><p class="source-code">      var columns: CGFloat = 2 </p><p class="source-code">      if Device.isPad ||</p><p class="source-code">      (traitCollection.horizontalSizeClass !=  </p><p class="source-code">      .compact) {</p><p class="source-code">         columns = 3</p><p class="source-code">      } </p><p class="source-code">      let viewWidth = collectionView.frame.size.width</p><p class="source-code">      let inset = 7.0 </p><p class="source-code">      let contentWidth = viewWidth - inset * </p><p class="source-code">      (columns + 1)</p><p class="source-code">      let cellWidth = contentWidth / columns</p><p class="source-code">      let cellHeight = cellWidth</p><p class="source-code">      return CGSize(width: cellWidth, height: </p><p class="source-code">      cellHeight)</p><p class="source-code">   }</p><p class="source-code">   func collectionView(_ collectionView: </p><p class="source-code">   UICollectionView, layout collectionViewLayout: </p><p class="source-code">   UICollectionViewLayout, </p><p class="source-code">   referenceSizeForHeaderInSection section: Int) -&gt; </p><p class="source-code">   CGSize {</p><p class="source-code">      return CGSize(width: collectionView.frame.width,</p><p class="source-code">      height: 100)</p><p class="source-code">   }</p><p class="source-code">}</p><p>These<a id="_idIndexMarker1259"/> methods are declared <a id="_idIndexMarker1260"/>in the <strong class="source-inline">UICollectionViewDelegateFlowLayout</strong> protocol, and they define item size and spacing in the collection view. They will override the settings in the Size inspector. Let's break them down:</p><p class="source-code">func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, sizeForItemAt indexPath: IndexPath) -&gt; CGSize {</p><p>This method returns a <strong class="source-inline">CGSize</strong> instance that the collection view cell size should be set to.</p><p class="source-code">var columns: CGFloat = 2</p><p>The <strong class="source-inline">columns</strong> variable determines how many columns appear on screen, and is initially set to <strong class="source-inline">2</strong>.</p><p class="source-code">if Device.isPad || (traitCollection.horizontalSizeClass != .compact) {</p><p>Checks to see whether the app is running on an iPad or the <strong class="source-inline">horizontalSizeClass</strong> property is not <strong class="source-inline">.compact</strong>.</p><p class="source-code">columns = 3</p><p>If the app is running on an iPad or the horizontal size class is not <strong class="source-inline">.compact</strong>, set <strong class="source-inline">columns</strong> to <strong class="source-inline">3</strong>.</p><p class="source-code">let viewWidth = collectionView.frame.size.width</p><p>Gets the width of the screen and assigns it to <strong class="source-inline">viewWidth</strong>.</p><p class="source-code">let inset = 7.0</p><p class="source-code">let contentWidth = viewWidth - inset * (columns + 1)</p><p>Subtracts<a id="_idIndexMarker1261"/> the<a id="_idIndexMarker1262"/> space used for the edge insets so the cell size can be determined.</p><p class="source-code">let cellWidth = contentWidth / columns </p><p>Gets the width of the cell by dividing <strong class="source-inline">contentWidth</strong> by <strong class="source-inline">columns</strong>, and assigns it to <strong class="source-inline">cellWidth</strong>.</p><p class="source-code">let cellHeight = cellWidth</p><p>Sets the height of the cell to be the same as the width of the cell.</p><p class="source-code">return CGSize(width: cellWidth, height: cellHeight)</p><p class="source-code">}</p><p>Returns the cell size.</p></li>
			</ol>
			<p>Assume you're running on iPhone 13 Pro Max in portrait mode. <strong class="source-inline">columns</strong> is set to <strong class="source-inline">2</strong>. <strong class="source-inline">viewWidth</strong> would be assigned the width of the iPhone screen, which is <strong class="source-inline">414</strong> points. <strong class="source-inline">contentWidth</strong> is set to 414 - (7 x 3) = <strong class="source-inline">393</strong>. <strong class="source-inline">cellWidth</strong> is set to <strong class="source-inline">contentWidth</strong> / <strong class="source-inline">columns</strong> = <strong class="source-inline">196.5</strong>, and <strong class="source-inline">cellHeight</strong> is set to <strong class="source-inline">cellWidth</strong>, so the <strong class="source-inline">CGSize</strong> returned would be <strong class="source-inline">(196.5, 196.5)</strong>, enabling two cells to fit in a row.</p>
			<p>When you rotate the same iPhone to landscape mode, <strong class="source-inline">columns</strong> is set to <strong class="source-inline">3</strong>. <strong class="source-inline">viewWidth</strong> would be assigned the height of the iPhone screen, which is <strong class="source-inline">896</strong> points. <strong class="source-inline">contentWidth</strong> is set to 896 - (7 x 4) = <strong class="source-inline">868</strong>. <strong class="source-inline">cellWidth</strong> is set to <strong class="source-inline">contentWidth</strong> / <strong class="source-inline">columns</strong> = <strong class="source-inline">289.3</strong>, and <strong class="source-inline">cellHeight</strong> is set to <strong class="source-inline">cellWidth</strong>, so the <strong class="source-inline">CGSize</strong> returned <a id="_idIndexMarker1263"/>would be <strong class="source-inline">(289.3, 289.3)</strong>, enabling<a id="_idIndexMarker1264"/> three cells to fit in a row.</p>
			<p class="source-code">func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, referenceSizeForHeaderInSection section: Int) -&gt; CGSize { </p>
			<p>This method returns the size the collection view section header should be set to.</p>
			<p class="source-code">return CGSize(width: collectionView.frame.width, height: 100)</p>
			<p>The width of the collection view section header will depend on device orientation but the height will always be <strong class="source-inline">100</strong>.</p>
			<p>Build and run your app on the iPad simulator. You should see three columns displayed:</p>
			<div>
				<div id="_idContainer525" class="IMG---Figure">
					<img src="image/Figure_22.09_B17469.jpg" alt="Figure 22.9: iPad simulator showing updated Explore screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 22.9: iPad simulator showing updated Explore screen</p>
			<p>Build <a id="_idIndexMarker1265"/>and <a id="_idIndexMarker1266"/>run your app on the iPhone 13 Pro Max simulator, you should see two columns displayed:</p>
			<div>
				<div id="_idContainer526" class="IMG---Figure">
					<img src="image/Figure_22.10_B17469.jpg" alt="Figure 22.10: iPhone 13 Pro Max Simulator showing updated Explore screen in portrait mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 22.10: iPhone 13 Pro Max Simulator showing updated Explore screen in portrait mode</p>
			<p>Choose <strong class="bold">Device</strong> | <strong class="bold">Rotate Left</strong> in the<a id="_idIndexMarker1267"/> simulator <a id="_idIndexMarker1268"/>menu, you will see three columns displayed:</p>
			<div>
				<div id="_idContainer527" class="IMG---Figure">
					<img src="image/Figure_22.11_B17469.jpg" alt="Figure 22.11: iPhone 13 Pro Max Simulator showing updated Explore screen in landscape mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 22.11: iPhone 13 Pro Max Simulator showing updated Explore screen in landscape mode</p>
			<p>Choose <strong class="bold">Device</strong> | <strong class="bold">Rotate Right</strong> in the simulator menu to return to a vertical orientation.</p>
			<p>You have <a id="_idIndexMarker1269"/>completed modifying<a id="_idIndexMarker1270"/> the <strong class="bold">Explore</strong> screen. Now, let's see how to make the <strong class="bold">Restaurant List</strong> screen adapt to different device types and orientations as well. You'll modify the <strong class="source-inline">RestaurantListViewController</strong> class in the next section.</p>
			<h2 id="_idParaDest-308"><a id="_idTextAnchor452"/>Updating the Restaurant List screen</h2>
			<p>You have<a id="_idIndexMarker1271"/> already modified <a id="_idIndexMarker1272"/>the <strong class="bold">Explore</strong> screen to automatically adapt to the device your app is running on. You'll now do the same for the <strong class="bold">Restaurant List</strong> screen. If you build and run on the iPad simulator, this is what the <strong class="bold">Restaurant List</strong> screen looks like:</p>
			<div>
				<div id="_idContainer528" class="IMG---Figure">
					<img src="image/Figure_22.12_B17469.jpg" alt="Figure 22.12: iPad Simulator showing Restaurant List screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 22.12: iPad Simulator showing Restaurant List screen</p>
			<p>As you can<a id="_idIndexMarker1273"/> see, there are only two<a id="_idIndexMarker1274"/> columns, and there is a large white space between them. Let's say you want three columns on the iPad, one column for the compact width size class and two columns for the regular width size class. Follow these steps:</p>
			<ol>
				<li value="1">Click the <strong class="source-inline">RestaurantListViewController</strong> file inside the <strong class="source-inline">Restaurants</strong> folder in the Project navigator. Create an <strong class="source-inline">initialize()</strong> method inside the <strong class="source-inline">private</strong> extension before all other c<a id="_idTextAnchor453"/><a id="_idTextAnchor454"/>ode already in the extension:<p class="source-code">func initialize() { </p><p class="source-code">   createData() </p><p class="source-code">   setupTitle() </p><p class="source-code">   setupCollectionView()</p><p class="source-code">}</p><p>The <strong class="source-inline">createData()</strong> and <strong class="source-inline">setupTitle()</strong> methods are both called in <strong class="source-inline">viewDidAppear()</strong>, but you'll modify <strong class="source-inline">viewDidAppear()</strong> to call <strong class="source-inline">initialize()</strong> instead later. You'll see an error because the <strong class="source-inline">setupCollectionView()</strong> method is not declared or defined yet.</p></li>
				<li>Declare and<a id="_idIndexMarker1275"/> define the <strong class="source-inline">setupCollectionView()</strong> method in the <strong class="source-inline">private </strong>extension<a id="_idIndexMarker1276"/><a id="_idTextAnchor455"/><a id="_idTextAnchor456"/> after the <strong class="source-inline">initialize()</strong> method:<p class="source-code">func setupCollectionView() {</p><p class="source-code">   let flow = UICollectionViewFlowLayout()</p><p class="source-code">   flow.sectionInset = UIEdgeInsets(top: 7, left: 7, </p><p class="source-code">   bottom: 7, right: 7)</p><p class="source-code">   flow.minimumInteritemSpacing = 0</p><p class="source-code">   flow.minimumLineSpacing = 7</p><p class="source-code">   collectionView.collectionViewLayout = flow</p><p class="source-code">}</p><p>Just like before, <strong class="source-inline">setupCollectionView()</strong> creates an instance of the <strong class="source-inline">UICollectionViewFlowLayout</strong> class, configures it, and assigns it to the collection view.</p></li>
				<li>Add an extension containing <strong class="source-inline">UICollectionViewDelegateFlowLayout</strong> methods<a id="_idTextAnchor457"/><a id="_idTextAnchor458"/> after the closing curly brace:<p class="source-code">extension RestaurantListViewController: </p><p class="source-code">UICollectionViewDelegateFlowLayout {</p><p class="source-code">   func collectionView(_ collectionView: </p><p class="source-code">   UICollectionView, layout collectionViewLayout: </p><p class="source-code">   UICollectionViewLayout, sizeForItemAt indexPath: </p><p class="source-code">   IndexPath) -&gt; CGSize {</p><p class="source-code">      var columns: CGFloat = 0 </p><p class="source-code">      if Device.isPad { </p><p class="source-code">         columns = 3</p><p class="source-code">      } else {</p><p class="source-code">         columns = </p><p class="source-code">         traitCollection.horizontalSizeClass </p><p class="source-code">         == .compact ? 1 : 2 </p><p class="source-code">      }</p><p class="source-code">      let viewWidth = collectionView.frame.size.width </p><p class="source-code">      let inset = 7.0</p><p class="source-code">      let contentWidth = viewWidth - inset * </p><p class="source-code">      (columns + 1)</p><p class="source-code">      let cellWidth = contentWidth / columns</p><p class="source-code">      let cellHeight = 312.0</p><p class="source-code">      return CGSize(width: cellWidth, height: </p><p class="source-code">      cellHeight)</p><p class="source-code">   }</p><p class="source-code">}</p><p>The <strong class="source-inline">collectionView(_:layout:sizeForItemAt:)</strong> method implemented<a id="_idIndexMarker1277"/> here works almost exactly the same as the implementation in the <strong class="source-inline">ExploreViewController</strong> class, but <strong class="source-inline">cellHeight</strong> is set to <strong class="source-inline">312</strong> points instead of being set to <strong class="source-inline">cellWidth</strong>. Note that if you're not running your app on an iPad, <strong class="source-inline">columns</strong> will be set to <strong class="source-inline">1</strong> for the compact width size class and to <strong class="source-inline">2</strong> for the<a id="_idIndexMarker1278"/> regular width<a id="_idIndexMarker1279"/> size class.</p></li>
				<li>Update <strong class="source-inline">viewDidAppear()</strong> by removing calls to the <strong class="source-inline">createData()</strong> and <strong class="source-inline">setupTitle()</strong> methods and adding a call for the <strong class="source-inline">initialize()</strong> method:<p class="source-code">override func viewDidAppear(_ animated: Bool) {</p><p class="source-code">   super.viewDidAppear(animated)</p><p class="source-code">   <strong class="bold">initialize()</strong></p><p class="source-code">}</p><p>Build and run your app on the iPad simulator, and go to the <strong class="bold">Restaurant List</strong> screen, as shown:</p></li>
			</ol>
			<div>
				<div id="_idContainer529" class="IMG---Figure">
					<img src="image/Figure_22.13_B17469.jpg" alt="Figure 22.13: iPad Simulator showing updated Restaurant List screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 22.13: iPad Simulator showing updated Restaurant List screen</p>
			<p>There are <a id="_idIndexMarker1280"/>three columns<a id="_idIndexMarker1281"/> now, and the wide white gap is gone. Now build and run your app on the iPhone 13 Pro Max simulator. The <strong class="bold">Restaurant List </strong>screen  should display a single column:</p>
			<div>
				<div id="_idContainer530" class="IMG---Figure">
					<img src="image/Figure_22.14_B17469.jpg" alt="Figure 22.14: iPhone 13 Pro Max Simulator showing updated Restaurant List screen in portrait mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 22.14: iPhone 13 Pro Max Simulator showing updated Restaurant List screen in portrait mode</p>
			<p>Choose<strong class="bold"> Device</strong> | <strong class="bold">Rotate Left</strong> in <a id="_idIndexMarker1282"/>the <a id="_idIndexMarker1283"/>simulator menu, and you should see two columns:</p>
			<div>
				<div id="_idContainer531" class="IMG---Figure">
					<img src="image/Figure_22.15_B17469.jpg" alt="Figure 22.15: iPhone 13 Pro Max Simulator showing updated Restaurant List screen in landscape mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 22.15: iPhone 13 Pro Max Simulator showing updated Restaurant List screen in landscape mode</p>
			<p>Choose <strong class="bold">Device</strong> | <strong class="bold">Rotate Right</strong> in the simulator menu, and quit the simulator.</p>
			<p>The <strong class="bold">Explore</strong> screen and the <strong class="bold">Restaurant List</strong> screen have been updated and now your app looks good on the iPad. It's now a perfect candidate to be made into a Mac app. Let's see<a id="_idIndexMarker1284"/> how you can build a Mac<a id="_idIndexMarker1285"/> app from your existing iPad app in the next section.</p>
			<h1 id="_idParaDest-309"><a id="_idTextAnchor459"/>Updating the app to work on macOS</h1>
			<p>You have <a id="_idIndexMarker1286"/>modified <a id="_idIndexMarker1287"/>your app's screens to work well on all iOS devices. Now you'll learn how to make your app run on a Mac.</p>
			<p>Apple have updated Mac Catalyst during WWDC2021, which makes it possible to build a Mac app from an existing iPad app with Mac-specific optimizations. As you will see, both apps will share the same project and source code.</p>
			<p class="callout-heading">Important Information</p>
			<p class="callout">Watch the video at the following link to see the latest updates to Mac Catalyst announced by Apple during WWDC2021: <a href="https://developer.apple.com/videos/play/wwdc2021/10052/">https://developer.apple.com/videos/play/wwdc2021/10052/</a>.</p>
			<p class="callout">More information about Mac Catalyst is available at <a href="https://developer.apple.com/mac-catalyst/">https://developer.apple.com/mac-catalyst/</a>.</p>
			<p>Before you begin, note that this only works if have a free or paid Apple developer account. If you use the project files in the <strong class="source-inline">Chapter24</strong> folder downloaded from GitHub at <a href="https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition">https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition</a>, you have to set the development team for your app to make it run on your Mac. Follow <a id="_idIndexMarker1288"/>these<a id="_idIndexMarker1289"/> steps:</p>
			<ol>
				<li value="1">Select your project in the Project navigator:<div id="_idContainer532" class="IMG---Figure"><img src="image/Figure_22.16_B17469.jpg" alt="Figure 22.16: Project navigator showing LetsEat project selected&#13;&#10;"/></div><p class="figure-caption">Figure 22.16: Project navigator showing LetsEat project selected</p></li>
				<li>In the <strong class="bold">General</strong> tab, tick the <strong class="bold">Mac</strong> checkbox:<div id="_idContainer533" class="IMG---Figure"><img src="image/Figure_22.17_B17469.jpg" alt="Figure 22.17: Editor area showing Mac checkbox in General pane&#13;&#10;"/></div><p class="figure-caption">Figure 22.17: Editor area showing Mac checkbox in General pane</p></li>
				<li>In<a id="_idIndexMarker1290"/> the<a id="_idIndexMarker1291"/> <strong class="bold">Enable Mac support?</strong> dialog box, click <strong class="bold">Enable</strong>:<div id="_idContainer534" class="IMG---Figure"><img src="image/Figure_22.18_B17469.jpg" alt="Figure 22.18: Enable Mac support? dialog box&#13;&#10;"/></div><p class="figure-caption">Figure 22.18: Enable Mac support? dialog box</p></li>
				<li>Note<a id="_idIndexMarker1292"/> the <strong class="bold">Mac</strong> checkbox<a id="_idIndexMarker1293"/> is now ticked:<div id="_idContainer535" class="IMG---Figure"><img src="image/Figure_22.19_B17469.jpg" alt="Figure 22.19: Editor area showing Mac checkbox ticked&#13;&#10;"/></div><p class="figure-caption">Figure 22.19: Editor area showing Mac checkbox ticked</p><p>Your app will be recompiled to run on your Mac. Note the <strong class="bold">Show "Designed for iPad" Run Destination</strong> checkbox. If you have an Apple Silicon Mac, you can select this destination to run your unmodified iPad apps natively on your Mac. </p></li>
				<li>Your Mac has been set as the run destination. Build and run your app.</li>
				<li>If your <a id="_idIndexMarker1294"/>project <a id="_idIndexMarker1295"/>fails to build, click the Issue navigator button and check the error message: <div id="_idContainer536" class="IMG---Figure"><img src="image/Figure_22.20_B17469.jpg" alt="Figure 22.20: Issue navigator showing error message&#13;&#10;"/></div><p class="figure-caption">Figure 22.20: Issue navigator showing error message</p><p>If you <a id="_idIndexMarker1296"/>see <a id="_idIndexMarker1297"/>the error shown here, this is because you need a free or paid developer account to run your app on actual hardware.</p></li>
				<li>Check to see that your developer account has been added to Xcode in <strong class="bold">Xcode</strong> | <strong class="bold">Preferences</strong> | <strong class="bold">Accounts</strong>.<strong class="bold"> </strong><p class="callout-heading">Tip</p><p class="callout">Adding your developer account to Xcode is covered in <em class="italic">Chapter 1, Getting Familiar with Xcode</em>.</p></li>
				<li>Click the <strong class="bold">Signing &amp; Capabilities</strong> tab. Select your paid or free developer account <a id="_idIndexMarker1298"/>in<a id="_idIndexMarker1299"/> the <strong class="bold">Team</strong> drop-down menu:<div id="_idContainer537" class="IMG---Figure"><img src="image/Figure_22.21_B17469.jpg" alt="Figure 22.21: Editor area showing Team drop-down menu in Signing &amp; Capabilities tab&#13;&#10;"/></div><p class="figure-caption">Figure 22.21: Editor area showing Team drop-down menu in Signing &amp; Capabilities tab</p></li>
				<li>Build and run again, and you should see your app running on your Mac:</li>
			</ol>
			<div>
				<div id="_idContainer538" class="IMG---Figure">
					<img src="image/Figure_22.22_B17469.jpg" alt="Figure 22.22: LetsEat Mac app&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 22.22: LetsEat Mac app</p>
			<p>Your app is now running on your Mac! Awesome!</p>
			<p>If you still see errors, try changing the <strong class="bold">Bundle Identifier</strong> value to a unique value, and try running your app on your iOS device first.</p>
			<p>You'll<a id="_idIndexMarker1300"/> need <a id="_idIndexMarker1301"/>to do some more work to make it a really nice Mac app, but that is beyond the scope of this book. Apple has a great tutorial on how to do so at this link: <a href="https://developer.apple.com/tutorials/mac-catalyst">https://developer.apple.com/tutorials/mac-catalyst</a>.</p>
			<h1 id="_idParaDest-310"><a id="_idTextAnchor460"/>Summary</h1>
			<p>In this chapter, you learned how to build a Mac app from an existing iOS app.</p>
			<p>You started by refining your app's user interface when running on the iPhone. Next, you added some code to make your app detect the device that it's running on, and modified your app's screens to work on all iOS devices. Finally, you used Mac Catalyst to build a Mac app from your iPad app. Your app now works great on iPhone, iPad, and Mac.</p>
			<p>You're now able to make your existing iPhone apps run well on iPad, and also to make Mac apps from your iPad apps. As you have seen, once you have an iPhone app, you can make it work on iPad and Mac with relatively little effort.</p>
			<p>In the next chapter, you'll learn a completely new way to build apps using <strong class="bold">SwiftUI</strong>, a modern way to write apps for any Apple platform.</p>
			<p> </p>
		</div>
	</body></html>