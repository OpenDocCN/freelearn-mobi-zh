<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Lua Crash Course and the Corona Framework</h1></div></div></div><div><blockquote class="blockquote"><p>
<strong>Lua</strong> is the programming language used to develop the Corona SDK. Up until now, we have learned how to use the major resources to run the SDK and other development tools to create an application for mobile devices. Now that we have dabbled into creating a couple of lines of code that make a program work, let's jump into the fundamentals that will give you a better understanding of what Lua is capable of.<a id="id70" class="indexterm"/>
</p></blockquote></div><p>In this chapter, you will learn how to:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Apply variables to a script</li><li class="listitem" style="list-style-type: disc">Use data structures to form tables</li><li class="listitem" style="list-style-type: disc">Work with display objects</li><li class="listitem" style="list-style-type: disc">Implement functions using object methods and arguments</li><li class="listitem" style="list-style-type: disc">Optimize your workflow</li></ul></div><p>So let's get right to it.</p><div><div><div><div><h1 class="title"><a id="ch02lvl1sec01"/>Lua to the rescue</h1></div></div></div><p>Lua is the industry standard for game programming. It is similar to JavaScript and Flash's ActionScript. Anyone who's done any scripting in these languages will make the transition to Lua almost immediately.</p><p>Lua has been useful in creating various applications and games. Many game programmers have found Lua to be a convenient scripting language due to how easy it is to embed, its fast execution, and its small learning curve. It is ubiquitous in World of Warcraft. It is also used by Electronic Arts, Rovio, ngmoco, and Tapulous in games such as Angry Birds, Tap Tap Revenge, Diner Dash, and so on.<a id="id71" class="indexterm"/>
</p><p>For more information on Lua, refer to<a class="ulink" href="http://www.lua.org"> http://www.lua.org</a>.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec02"/>Valuable variables</h1></div></div></div><p>Like in many scripting languages, Lua has variables. You can think of it as something that stores values. When you apply a value to a variable, you can refer to it using the same variable.</p><p>An application consists of statements and variables.<strong> Statements</strong> provide instructions on what operations and computations need to be done.<strong> Variables</strong> store the values of these computations. Setting a value into a variable is called an<strong> assignment</strong>.<a id="id72" class="indexterm"/>
</p><p>Lua uses three kinds of variables:<strong> global, local</strong>, and<strong> table fields</strong>.</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec01"/>Global variables</h2></div></div></div><p>A<strong> global variable</strong> can be accessed in every scope and can be modified from anywhere. The term scope is used to describe the area in which a set of variables live. You don't have to declare a global variable. It is created as soon as you assign a value to it.<a id="id73" class="indexterm"/>
</p><div><pre class="programlisting">myVariable = 10
print( myVariable ) -- prints the number 10
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec02"/>Local variables</h2></div></div></div><p>A<strong> local variable</strong> is accessed from a local scope and usually called from a<strong> function</strong> or block of code. When we create a block, we are creating a scope in which variables can live or a list of statements, which are executed sequentially. When referencing a variable, Lua must find the variable. Localizing variables helps speed up the look-up process and improves the performance of your code. By using the local statement, it declares a local variable.<a id="id74" class="indexterm"/>
</p><div><pre class="programlisting">local i = 5 -- local variable
</pre></div><p>The following is how to declare a local variable in a block:</p><div><pre class="programlisting">x = 10 -- global 'x' variable
local i = 1
while i &lt;= 10 do
local x = i * 2 -- a local 'x' variable for the while block
print( x ) -- 2, 4, 6, 8, 10 ... 20
i = i + 1
end
print( x ) -- prints 10 from global x
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec03"/>Table fields (properties)</h2></div></div></div><p>Table fields are elements of the table themselves. Arrays can be indexed with numbers and strings or any value pertaining to Lua except nil. You index into the array to assign the values to a field using integers. When the index is a string, the field is known as a<strong> property</strong>. All properties can be accessed using the dot operator (<code class="literal">x.y</code>) or a string (<code class="literal">x["y"]</code>) to index into a table. The result is the same.<a id="id75" class="indexterm"/>
</p><div><pre class="programlisting">x = { y="Monday" } -- create table
print( x.y ) -- "Monday"
z = "Tuesday" -- assign a new value to property "Tuesday"
print( z ) -- "Tuesday"
x.z = 20 -- create a new property
print( x.z ) -- 20
print( x["z"] ) -- 20
</pre></div><p>More information relating to tables will be discussed later in the section called<em> Tables</em>.</p><p>You may have noticed the additional text on certain lines of code in the preceding examples. Those are what you call comments. Comments begin anywhere with a double hyphen <code class="literal">--</code> , except inside a string. They run until the end of the line. Block comments are available as well. A common trick to comment out a block is to surround it with <code class="literal">--[[</code>.</p><p>Here is how to comment one line:</p><div><pre class="programlisting">a = 2
<strong>--print(a) -- 2
</strong>
</pre></div><p>The following is a block comment:</p><div><pre class="programlisting"><strong>--[[</strong>
k = 50
print(k) -- 50
<strong>]]--</strong>
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec04"/>Assignment conventions</h2></div></div></div><p>There are rules for variable names. A variable starts with a letter or an underscore. It can't contain anything other than letters, underscores, or digits. It also can't be one of the following words reserved by Lua:<a id="id76" class="indexterm"/>
</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">which</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">are</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">and</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">break</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">do</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">else</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">elseif</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">end</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">false</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">for</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">function</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">if</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">in</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">local</code><a id="id77" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">nil</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">not</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">or</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">repeat</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">return</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">then</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">true</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">until</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">while</code></li></ul></div><p>The following are valid variables:<a id="id78" class="indexterm"/>
</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">x</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">X</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">ABC</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">_abc</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">test_01</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">myGroup</code></li></ul></div><p>The following are invalid variables:<a id="id79" class="indexterm"/>
</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">function</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">my-variable</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">123</code></li></ul></div><div><h3 class="title"><a id="note10"/>Note</h3><p>
<em>Lua is also a case-sensitive language</em>. For example, using <code class="literal">else</code> is a reserved word, but<em> Else</em> and<em> ELSE</em> are two different, valid names.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec03"/>Types of values</h1></div></div></div><p>Lua is a dynamically typed language. There is no defined type in the language. Each value carries its own type.</p><p>As you have noticed, values can be stored in variables. They can be manipulated to give a value of any type. This also allows you to pass arguments to other functions and return as results.<a id="id80" class="indexterm"/>
</p><p>The basic types of values that you'll deal with are the following:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">nil</code>—It is the only type whose value is <code class="literal">nil</code>. Any uninitialized variable has <code class="literal">nil</code> as its value. Like global variables, it is <code class="literal">nil</code> by default and can be assigned <code class="literal">nil</code> to delete it.<a id="id81" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">Boolean</code>—The Boolean type has two values, <code class="literal">false</code> and <code class="literal">true</code>. You will notice that conditional expressions consider <code class="literal">false</code> and <code class="literal">nil</code> as false and anything else as true.<a id="id82" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">Numbers</code>—Represents real (double-precision floating-point) numbers.</li><li class="listitem" style="list-style-type: disc"><code class="literal">String</code>—A String is a sequence of characters. 8-bit characters and embedded zeros are allowed.<a id="id83" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">Tables</code>—A data structure in Lua. It is implemented by an associative array, which is an array that can be indexed not only with numbers, but also with strings or any other value, except <code class="literal">nil</code>. (We will discuss more about this in the section<em> Tables</em> later in this chapter).<a id="id84" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">Functions</code>—Known as first-class values of Lua. Typically, functions can be stored in variables, passed as arguments to other functions and returned as results.<a id="id85" class="indexterm"/></li></ul></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec04"/>Time for action—printing values using blocks</h1></div></div></div><p>Let's give it a shot and see how powerful a language Lua is. We're starting to get an idea of how variables work and what happens when you assign a value to it. What if you have a variable that has multiple values attached to it? How does Lua differentiate them? We'll be using the <code class="literal">Corona Terminal</code> so we can see the values outputted in the terminal box. Along the way, you'll pick up other programming techniques as you progress through this section. We will also be referring to chunks in this exercise. The unit of execution of Lua is called a<strong> chunk</strong>. A chunk is a sequence of statements, which are executed sequentially.<a id="id86" class="indexterm"/>
</p><p>If you remember from the previous chapter, we learned how to create our own project folder and <code class="literal">main.lua</code> file for the Hello World application.<a id="id87" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem">Create a new project folder on your desktop and name it <code class="literal">Variables</code>.</li><li class="listitem">Open up your preferred text editor and save it as <code class="literal">main.lua</code> in your <code class="literal">Variables</code> project folder.</li><li class="listitem">Create the following variables:<div><pre class="programlisting">local x = 10 -- Local to the chunk
local i = 1 -- Local to the chunk
</pre></div></li><li class="listitem">In the <code class="literal">while</code> loop, add the following code:<div><pre class="programlisting">while i&lt;=x do
local x = i -- Local to the "do" body
print(x) -- Will print out numbers 1 through 10
i = i + 1
end
</pre></div></li><li class="listitem">Create an <code class="literal">if</code> statement that will represent another local body:<div><pre class="programlisting">if i &lt; 20 then
local x -- Local to the "then" body
x = 20
print(x + 5) -- 25
else
print(x) -- This line will never execute since the above "then" body is already true
end
print(x) -- 10
</pre></div></li><li class="listitem">Save your script.</li><li class="listitem">Launch the <code class="literal">Corona Terminal</code>. Make sure you see the<strong> Corona SDK</strong> screen and a terminal window pop up.</li><li class="listitem">Navigate to your <code class="literal">Variables</code> project folder and open your <code class="literal">main.lua</code> file in the simulator. You will notice that the device in the simulator is blank, but if you look at your terminal window, there are some results from the code printed out as follows:<div><pre class="programlisting">1
2
3
4
5
6
7
8
9
10
25
10
</pre></div></li></ol></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec05"/>What just happened?</h2></div></div></div><p>The first two variables that were created are local outside of each block of code. Notice in the beginning of the <code class="literal">while</code> loop, <code class="literal">i &lt;= x</code> refers to the variables in lines 1 and 2. The statement <code class="literal">local x = i</code> inside the <code class="literal">while</code> loop is only local to the <code class="literal">do</code> body and is not the same as <code class="literal">local x = 10</code>. The <code class="literal">while</code> loop runs ten times and prints out a value that is incremented by 1 each time.<a id="id88" class="indexterm"/>
</p><p>The <code class="literal">if</code> statement compares <code class="literal">i &lt; 20</code>, where <code class="literal">i</code> equals 1 and uses another <code class="literal">local x</code> that is local to the <code class="literal">then</code> body. Since the statement is true, <code class="literal">x</code> equals 20 and prints out the value of <code class="literal">x + 5</code> which is 25.</p><p>The very last line, <code class="literal">print(x)</code> is not attached to any of the blocks of code in the <code class="literal">while</code> loop or the <code class="literal">if</code> statement. Therefore, it refers to <code class="literal">local x = 10</code> and prints out the value of <code class="literal">10</code> in the terminal window. This may seem confusing, but it's important to understand how local and global variables work in Lua.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec05"/>Expressions</h1></div></div></div><p>An<strong> expression</strong> is something that has a value. It can include numeric constants, quoted strings, variable names, unary and binary operations, and function calls.<a id="id89" class="indexterm"/>
</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec06"/>Arithmetic operators</h2></div></div></div><p>
<code class="literal">+, -, *, /, %</code>, and <code class="literal">^</code> are called<strong> arithmetic operators.</strong>
<a id="id90" class="indexterm"/>
</p><p>The following is an example using<em> Binary arithmetic</em> operators:</p><div><pre class="programlisting">t = 2*(2-5.5)/13+26
print(t) -- 25.461538461538
</pre></div><p>The following is an example using the<em> Modulo</em> (division remainder) operator:</p><div><pre class="programlisting">m = 18%4
print(m) -- 2
</pre></div><p>The following is an example using the<em> Power of</em> operator:<a id="id91" class="indexterm"/>
</p><div><pre class="programlisting">n = 7^2
print(n) --49
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec07"/>Relational operators</h2></div></div></div><p>
<strong>Relational operators</strong> always result in <code class="literal">false</code> or <code class="literal">true</code> and ask yes-or-no questions.<a id="id92" class="indexterm"/>
</p><p>
<code class="literal">&lt;, &gt;, &lt;=, &gt;=, ==</code>, and <code class="literal">~=</code> are some of the relational operators.</p><p>The operator <code class="literal">==</code> tests for equality and the operator <code class="literal">~=</code> is the negation of equality. If the value types are different, then the result is false. Otherwise, Lua compares the values to their types. Numbers and strings are compared in the usual way. Tables and functions are compared by reference, as long as two such values are considered equal only if they are the same object. When a new object is created, the new object is different from the previously existing one.</p><p>The following are the examples of relational operators. It will display a <code class="literal">Boolean</code> result and can't be concatenated with a string:</p><div><pre class="programlisting">print(0 &gt; 1) --false
print(4 &gt; 2) --true
print(1 &gt;= 1) --true
print(1 &gt;= 1.5) --false
print(0 == 0) --true
print(3 == 2) --false
print(2 ~= 2) --false
print(0 ~= 2) --true
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec08"/>Logical operators</h2></div></div></div><p>The<strong> logical operators</strong> in Lua are <code class="literal">and, or</code>, and <code class="literal">not</code>. All logical operators consider both <code class="literal">false</code> and <code class="literal">nil</code> as false and anything else as true.<a id="id93" class="indexterm"/>
</p><p>The operator <code class="literal">and</code> returns its first argument if the value is <code class="literal">false</code> or <code class="literal">nil</code>; otherwise it returns its second argument. The operator <code class="literal">or</code> returns its first argument if the value is different from <code class="literal">nil</code> and <code class="literal">false</code>; otherwise, it returns its second argument. Both <code class="literal">and</code> and <code class="literal">or</code> use short-cut evaluation, which means, the second operand is evaluated only when necessary.</p><div><pre class="programlisting">print(10 and 20) -- 20
print(nil and 1) -- nil
print(false and 1) -- false
print(10 or 20) -- 10
print(false or 1) -- 1
</pre></div><p>The operator <code class="literal">not</code> always returns <code class="literal">true</code> or <code class="literal">false:</code>
</p><div><pre class="programlisting">print(not nil) -- true
print(not true) -- false
print(not 2) -- false
<a id="id94" class="indexterm"/>
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec09"/>Concatenation</h2></div></div></div><p>The<strong> string concatenation operator</strong> in Lua is denoted by two dots <code class="literal">...</code> It takes two strings as operands and splices them together. If any of its operands are numbers, then they are also converted to a string.<a id="id95" class="indexterm"/>
</p><div><pre class="programlisting">print("Hello " .. "World") -- Hello World
myString = "Hello"
print(myString .. " World") -- Hello World
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec10"/>Length operator</h2></div></div></div><p>The<strong> length operator</strong>
 <code class="literal">#</code>, measures the length of a string. The length of a string is simply the number of characters in it. A character is considered as 1 byte.<a id="id96" class="indexterm"/>
</p><div><pre class="programlisting">print(#"*") --1
print(#"\n") --1
print(#"hello") --5
myName = "Jane Doe"
print(#myName) --8
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec11"/>Precedence</h2></div></div></div><p>Operator precedence in Lua is as follows, from higher to lower priority:<a id="id97" class="indexterm"/>
</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">^</code><a id="id98" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">not # -</code> (unary)<a id="id99" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">* /</code><a id="id100" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">+ -</code><a id="id101" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">..</code><a id="id102" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">&lt; &gt; &lt;= &gt;= ~= ==</code><a id="id103" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">and</code><a id="id104" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">or</code><a id="id105" class="indexterm"/></li></ul></div><p>All binary operators are left associative, except for <code class="literal">^</code> exponentiation and <code class="literal">..</code> concatenation, which are right associative. You can use parentheses to change the precedence of an expression.<a id="id106" class="indexterm"/>
</p><p>In cases where two operands of the same precedence compete for operands, the operand belongs to the operator on the left:</p><div><pre class="programlisting">print(5 + 4 - 2) -- This returns the number 7
</pre></div><p>The preceding expression shows both the addition and subtraction operators, which have equal precedence. The second element (the number 4) belongs to the addition operator, so the expression is evaluated mathematically as follows:</p><div><pre class="programlisting">print((5 + 4) - 2) -- This returns the number 7
</pre></div><p>Let's focus on the rules of precedence based on priority. For example:</p><div><pre class="programlisting">print (7 + 3 * 9) -- This returns the number 34
</pre></div><p>An inexperienced programmer might think that the value of the preceding example is 90, if it were evaluated from left to right. The correct value is 34 because multiplication has a higher precedence over addition, so it is performed first. Adding parentheses to the same expression will make it easier to read:</p><div><pre class="programlisting">print (7 + (3 * 9)) -- This returns the number 34
</pre></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec06"/>Strings</h1></div></div></div><p>Earlier in this chapter, you saw some code examples using sequences of characters. Those sequences of characters are called<strong> strings</strong>. Strings may contain characters with any numeric value, including embedded zeros. This also means that binary data can be stored in a string.<a id="id107" class="indexterm"/>
</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec12"/>Quoting strings</h2></div></div></div><p>There are three ways to quote strings: with double quotes, with single quotes and with square brackets.<a id="id108" class="indexterm"/>
</p><div><h3 class="title"><a id="tip05"/>Tip</h3><p>When quoting strings, make sure that only straight up and down quotation characters are used in your code or else it will not compile.</p></div><p>Using double quote characters<code class="literal">"</code> mark the beginning and end of the string. For example:</p><div><pre class="programlisting">print("This is my string.") -- This is my string.
</pre></div><p>You can also quote strings by using the single quote character<code class="literal">'</code>. Single quotes work the same as double quotes except that single-quoted strings can contain a double quote.</p><div><pre class="programlisting">print('This is another string.') -- This is another string.
print('She said, "Hello!" ') -- She said, "Hello!"
</pre></div><p>Lastly, using a pairs of square brackets will also quote strings. They are used mainly for strings when double or single quotes cannot be used. There are not many cases that this occurs, but they will do the job.</p><div><pre class="programlisting">print([[Is it 'this' or "that?"]]) -- Is it 'this' or "that?"
</pre></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec07"/>Time for action—getting our hands full of strings</h1></div></div></div><p>We're starting to familiarize ourselves with several blocks of code and how they interact with each other. Let's see what happens when we add in some expressions using strings and how different they are in comparison to just regular strings you print out in the terminal.<a id="id109" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem">Create a new project folder on your desktop and name it <code class="literal">Working With Strings</code>.</li><li class="listitem">Make a new <code class="literal">main.lua</code> file in your text editor and save it in your folder.</li><li class="listitem">Type the following lines (Do not include the line numbers in the code, it is only used for line reference):<div><pre class="programlisting">1 print("This is a string!") -- This is a string!
2 print("15" + 1) -- Returns the value 16
</pre></div></li><li class="listitem">Add in the following variables. Notice that it uses the same variable name:<div><pre class="programlisting">3 myVar = 28
4 print(myVar) -- Returns 28
5 myVar = "twenty-eight"
6 print(myVar) -- Returns twenty-eight
</pre></div></li><li class="listitem">Let's add in more variables with some string values and compare them using different operators.<a id="id110" class="indexterm"/><div><pre class="programlisting">7 Name1, Phone = "John Doe", "123-456-7890"
8 Name2 = "John Doe"
9 print(Name1, Phone) -- John Doe 123-456-7890
10 print(Name1 == Phone) -- false
11 print(Name1 &lt;= Phone) -- false
12 print(Name1 == Name2) -- true
</pre></div></li><li class="listitem">Save your script and launch your project in Corona. Observe the results in the terminal window.<div><pre class="programlisting"><strong>This is a string!
16
28
twenty-eight
John Doe 123-456-7890
false
false
true</strong>
</pre></div></li></ol></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec13"/>What just happened?</h2></div></div></div><p>You can see that line 1 is just a plain string with characters printed out. In line 2, notice that the number 15 is inside the string and then added to the number 1 which is outside the string. Lua provides automatic conversions between number and strings at runtime. Numeric operations applied to a string will try to convert the string to a number.</p><p>When working with variables, you can use the same one and have them contain a string and a number at different times as in lines 3 and 5 ( <code class="literal">myVar = 28</code> and <code class="literal">myVar = "twenty-eight")</code>.</p><p>In the last chunk of code (lines 7-12), we compared different variable names using relational operators. First, we printed the strings of <code class="literal">Name1</code> and <code class="literal">Phone</code>. The next lines following the comparison between <code class="literal">Name1, Name2</code>, and <code class="literal">Phone</code>. When two strings have the same characters in the exact order, then they are considered as the same string and are equal to each other. When you look at <code class="literal">print(Name1 == Phone)</code> and <code class="literal">print(Name1 &lt;= Phone)</code>, the characters do not correlate with each other so they return <code class="literal">false</code>. In <code class="literal">print(Name1 == Name2)</code>, both variables contain the same characters and therefore returns <code class="literal">true.</code>
<a id="id111" class="indexterm"/>
</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec14"/>Have a go hero—pulling some more strings</h2></div></div></div><p>Strings are pretty simple to work with since they are just sequences of characters. Try making your own expressions similar to the preceding example with the following modifications:<a id="id112" class="indexterm"/>
</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Create some variables with numerical values and another set of variables with numerical string values. Use relational operators to compare the values and then print out the results.</li><li class="listitem" style="list-style-type: disc">Use the concatenation operator and combine several strings or numbers together and space them out equally. Print out the result in the terminal window.</li></ul></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec08"/>Tables</h1></div></div></div><p>
<strong>Tables</strong> are the proprietary data structure in Lua. They represent arrays, lists, sets, records, graphs, an so on. A table in Lua is similar to an associative array. Associative arrays can be indexed with values of any type, not just numbers. Tables implement all these structures efficiently. For example, arrays can be implemented by indexing tables with integers. Arrays do not have a fixed size, but grow as needed. When initializing an array, its size is defined indirectly.<a id="id113" class="indexterm"/>
</p><p>The following is an example of how tables can be constructed:<a id="id114" class="indexterm"/>
</p><div><pre class="programlisting">1 a = {} -- create a table with reference to "a"
2 b = "y"
3 a[b] = 10 -- new entry, with key="b" and value=10
4 a[20] = "Monday" -- new entry, with key=20 and value="Monday"
5 print(a["y"]) -- 10
6 b = 20
7 print(a[b]) -- "Monday"
8 c = "hello" -- new value assigned to "hello" property
9 print( c ) -- "hello"
</pre></div><p>You will notice in line 5 that <code class="literal">a["y"]</code> is indexing the value from line 3. In line 7, <code class="literal">a[b]</code> uses a new value of variable <code class="literal">b</code> and indexes the value of 20 to the string,<code class="literal">"Monday"</code>. The last line, <code class="literal">c</code> is different from the previous variables and its only value is the string,<code class="literal">"hello"</code>.</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec15"/>Passing a table as an array</h2></div></div></div><p>Keys of a table can be consecutive integers, starting at 1. They can be made into an array (or a list).<a id="id115" class="indexterm"/>
</p><div><pre class="programlisting">colors = {
[1] = "Green",
[2] = "Blue",
[3] = "Yellow",
[4] ="Orange",
[5] = "Red"
}
print(colors[4]) -- Orange
</pre></div><p>Another way of writing table constructors to build arrays in a faster and convenient way that doesn't require writing out each integer key is as follows:</p><div><pre class="programlisting">colors = {"Green", "Blue", "Yellow", "Orange", "Red"}
print(colors[4]) -- Orange
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec16"/>Altering contents in a table</h2></div></div></div><p>While working with tables, you can modify or remove the values already in it, and also add new values to it. This can be accomplished using the assignment statement. The following example creates a table with three people and their favorite type of drink. You can make an assignment to change one person's drink, add a new person-drink pair to the table, and remove an existing person-drink pair.<a id="id116" class="indexterm"/>
</p><div><pre class="programlisting">drinks = {Jim = "orange juice", Matt = "soda", Jackie = "milk"}
drinks.Jackie = "lemonade" -- A change.
drinks.Anne = "water" -- An addition.
drinks.Jim = nil -- A removal.
print(drinks.Jackie, drinks.Anne, drinks.Matt, drinks.Jim)
-- lemonade water soda nil
</pre></div><p>
<code class="literal">drinks.Jackie = "lemonade"</code> overwrites the original value of <code class="literal">drinks.Jackie = "milk"</code>.</p><p>
<code class="literal">drinks.Anne = "water"</code> adds a new key and value to the table. The value of <code class="literal">drinks.Anne</code> before this line would have been <code class="literal">nil</code>.</p><p>
<code class="literal">drinks.Matt = "soda"</code> stays the same since there were no alterations to it.</p><p>
<code class="literal">drinks.Jim = nil</code> overwrites the original value of <code class="literal">drinks.Jim = "orange juice"</code> with <code class="literal">nil</code>. It removes the key <code class="literal">Jim</code> from the table.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec17"/>Populating a table</h2></div></div></div><p>Ways to populate a table is to start with an empty table and add things to it one at a time. We'll be using constructors, which are expressions that create and initialize tables. The simplest constructor is the empty constructor, <code class="literal">{}</code>.<a id="id117" class="indexterm"/>
</p><div><pre class="programlisting">myNumbers = {} -- Empty table constructor
for i = 1, 5 do
myNumbers[i] = i
end
for i = 1, 5 do
print("This is number " .. myNumbers[i])
end
</pre></div><p>The following is the result from the terminal:</p><div><pre class="programlisting"><strong>--This is number 1
--This is number 2
--This is number 3
--This is number 4
--This is number 5</strong>
</pre></div><p>The preceding example shows that <code class="literal">myNumbers = {}</code> is an empty table constructor. A <code class="literal">for</code> loop is created and calls <code class="literal">myNumbers[i]</code> five times starting from the number 1. Each time it is called, it is incremented by 1 and then printed out.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec09"/>Objects</h1></div></div></div><p>Tables and functions are objects. Variables do not actually contain these values, only references to them. Tables are also used in what is known as<strong> object-oriented programming</strong>. Functions that deal with a particular type of value are part of that value. Such a value is called an<strong> object</strong> and its functions are called<strong> methods</strong>. In Corona, we'll be focusing more on display objects since they are essential for game development.<a id="id118" class="indexterm"/>
</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec18"/>Display objects</h2></div></div></div><p>Anything drawn to the screen is made by<strong> display objects</strong>. In Corona, the assets you see displayed in the simulator are instances of display objects. You have probably seen shapes, images, and text, which are all forms of display objects. When you create these objects, you'll be able to animate them, turn them into backgrounds, interact with them using touch events, and so on.<a id="id119" class="indexterm"/>
</p><p>Display objects are created by calling a function known as a<strong> factory function</strong>. There is a specific kind of factory function for each type of display object. For example, <code class="literal">display.newCircle()</code> creates a vector object.<a id="id120" class="indexterm"/>
</p><p>Instances of display objects behave similar to Lua tables. This enables you to add your own properties to an object as long as they do not conflict with the system assigned properties and method names.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec19"/>Display properties</h2></div></div></div><p>The dot operator is used to access properties. Display objects share the following properties:<a id="id121" class="indexterm"/>
</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">object.alpha</code> is the object's opacity. A value of <code class="literal">0</code> is transparent and <code class="literal">1.0</code> is opaque. The default value is <code class="literal">1.0.</code><a id="id122" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.height</code> is in local coordinates.<a id="id123" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.isVisible</code> controls whether the object is visible on the screen. <code class="literal">true</code> is visible and <code class="literal">false</code> is not. The default is <code class="literal">true.</code><a id="id124" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.isHitTestable</code> allows an object to continue to receive hit events even if it is not visible. If <code class="literal">true</code>, objects will receive hit events regardless of visibility; if <code class="literal">false</code>, events are only sent to visible objects. Defaults to <code class="literal">false</code>.<a id="id125" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.parent</code> is a read-only property that returns the object's parent.<a id="id126" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.rotation</code> is the current rotation angle (in degrees). Can be a negative or positive number. Default is <code class="literal">0.</code><a id="id127" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.contentBounds</code> is a table with properties <code class="literal">xMin, xMax, yMin</code>, and <code class="literal">yMax</code> in screen coordinates. Generally used to map the object in a group to the screen coordinates.<a id="id128" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.contentHeight</code> is the height in screen coordinates.<a id="id129" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.contentWidth</code> is the width in screen coordinates.<a id="id130" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.width</code> is in local coordinates.<a id="id131" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.x</code> specifies the x-position (in local coordinates) of the object relative to the parent—the parent's origin to be precise. It provides the x-position of the object's reference point relative to the parent. Changing the value will move the object in the x-direction.<a id="id132" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.xOrigin</code> specifies the x-position of the object's origin relative to the parent's origin. It is in the object's local coordinates. Changing the value of this property will move the object in the x-direction.<a id="id133" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.xReference</code> defines the x-position of the reference point relative to the object's local origin. For most display objects, the value defaults to 0, meaning the x-position of the origin and the reference point are the same.<a id="id134" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.xScale</code> gets or sets the X scaling factor. A value of 0.5 will scale the object to 50 percent in the X direction. The scaling occurs around the object's reference point. The default reference point for most display objects is center.<a id="id135" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.y</code> specifies the y-position (in local coordinates) of the object relative to the parent—the parent's origin to be precise.<a id="id136" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.yOrigin</code> specifies the y-position of the object's origin relative to the parent's origin. It is in the object's local coordinates. Changing the value of this property will move the object in the y-direction.<a id="id137" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.yReference</code> defines the y-position of the reference point relative to the object's local origin. For most display objects, the value defaults to 0, meaning the y-position of the origin and the reference point are the same.<a id="id138" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object.yScale</code> gets or sets the Y scaling factor. A value of 0.5 will scale the object to 50 percent in the Y direction. The scaling occurs around the object's reference point. The default reference point for most display objects is center.<a id="id139" class="indexterm"/></li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec20"/>Object methods</h2></div></div></div><p>Corona can create display objects to store object methods as properties. There are two ways this can be done, the dot operator (.) and the colon operator (:). Both are valid ways to create object methods.<a id="id140" class="indexterm"/>
</p><p>The call to an object method using the dot operator is passed to the object if it's the first argument:</p><div><pre class="programlisting">object = display.newRect(110, 100, 50, 50)
object:setFillColor(255, 255, 255)
<strong>object.translate( object, 10, 10 )</strong>
</pre></div><p>The colon operator method is merely a shortcut with less typing involved to create the function:</p><div><pre class="programlisting">object = display.newRect(110, 100, 50, 50)
object:setFillColor(255, 255, 255)
<strong>object:translate( 10, 10 )</strong>
</pre></div><p>The display objects share the following methods:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">object:rotate( deltaAngle )</code> or <code class="literal">object.rotate( object, deltaAngle )</code>—Effectively adds <code class="literal">deltaAngle</code> (in degrees) to the current rotation property.<a id="id141" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object:scale( sx, sy )</code> or <code class="literal">object.scale(object, sx, sy )</code>—Effectively multiplies <code class="literal">xScale</code> and <code class="literal">yScale</code> properties by <code class="literal">sx</code> and <code class="literal">sy</code> respectively. If the current <code class="literal">xScale</code> and <code class="literal">yScale</code> values are 0.5 and <code class="literal">sx</code> and <code class="literal">sy</code> are also 0.5, the resulting scale will be 0.25 for <code class="literal">xScale</code> and <code class="literal">yScale</code>. This scales the object from 50 percent of its original size to 25 percent.<a id="id142" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object:setReferencePoint( referencePoint )</code> or <code class="literal">object.setReferencePoint( object, referencePoint )</code>—Sets the reference point either to the center of the object (default) or to one of several convenient points along the bounding box of the object. The argument <code class="literal">referencePoint</code> should be one of the following:<a id="id143" class="indexterm"/><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">display.CenterReferencePoint</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.TopLeftReferencePoint</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.TopCenterReferencePoint</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.TopRightReferencePoint</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.CenterRightReferencePoint</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.BottomRightReferencePoint</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.BottomCenterReferencePoint</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.BottomLeftReferencePoint</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.CenterLeftReferencePoint</code></li></ul></div></li><li class="listitem" style="list-style-type: disc"><code class="literal">object:translate( deltaX, deltaY )</code> or <code class="literal">object.translate( object, deltaX, deltaY )</code>—Effectively adds <code class="literal">deltaX</code> and <code class="literal">deltaY</code> to the <code class="literal">x</code> and <code class="literal">y</code> properties respectively. This will move the object from its current position.<a id="id144" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">object:removeSelf( )</code> or <code class="literal">object.removeSelf( object )</code>—Removes the display object and frees its memory, assuming there are no other references to it. This is equivalent to calling <code class="literal">group:remove(IndexOrChild)</code> on the same display object, but is syntactically simpler. The <code class="literal">removeSelf()</code> syntax is also supported in other cases such as removing physics' joints in Physics.<a id="id145" class="indexterm"/></li></ul></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec10"/>Images</h1></div></div></div><p>Many art assets used in Corona applications are sets of images. You will notice that bitmap image objects are types of display objects.<a id="id146" class="indexterm"/>
</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec21"/>Loading an image</h2></div></div></div><p>By using <code class="literal">display.newImage( filename [, baseDirectory] [, left, top] )</code>, an image object is returned. The image data is loaded from a filename you specified to your image and looks in the <code class="literal">system.ResourceDirectory</code> for that file. The acceptable types of image files that are supported are <code class="literal">.png</code> (PNG-24 or higher only) and <code class="literal">.jpg</code> files. Avoid high <code class="literal">.jpg</code> compression as it may take longer to load on a device. <code class="literal">.png</code> files have better quality over <code class="literal">.jpg</code> files and are used to display transparent images. <code class="literal">.jpg</code> files do not save transparent images.<a id="id147" class="indexterm"/>
</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec22"/>Image autoscaling</h2></div></div></div><p>The default behavior of <code class="literal">display.newImage()</code> is to autoscale large images. This is to conserve texture memory. However, there are times when you do not want to have images autoscaled and there is an optional Boolean flag in the parameter list to control this manually.<a id="id148" class="indexterm"/>
</p><p>To override autoscaling and show the image at its full resolution, use the optional <code class="literal">isFullResolution</code> parameter. By default, it is <code class="literal">false</code>, but if you specify <code class="literal">true</code>, then the new image is loaded at its full resolution:</p><div><pre class="programlisting">display.newImage( [parentGroup,] filename [, baseDirectory] [, x, y] [,isFullResolution] )
</pre></div><p>The following are the limitations and known issues:<a id="id149" class="indexterm"/>
</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Indexed PNG image files are not supported.</li><li class="listitem" style="list-style-type: disc">Grayscale images are currently not supported; images must be RGB.</li><li class="listitem" style="list-style-type: disc">Images will still be autoscaled if they are larger than the maximum possible texture dimensions of the device. This is usually 1024x1024 (iPhone 3G) or 2048x2048 (iPhone 3GS and iPad).</li><li class="listitem" style="list-style-type: disc">If you reload the same image multiple times, the subsequent calls to <code class="literal">display.newImage</code> ignores the <code class="literal">isFullResolution</code> parameter and takes on the value passed the first time. In other words, the way you load an image file the first time affects the autoscaling setting the next time you load that same file. This is because Corona conserves texture memory by automatically re-using a texture that has already been loaded. As a result, you can use the same images as many times as you want without consuming additional texture memory.</li></ul></div><p>More information on Corona SDK's documentation is located on Ansca's website:<a class="ulink" href="http://www.anscamobile.com"> http://www.anscamobile.com</a>.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec11"/>Time for action—placing images on screen</h1></div></div></div><p>We're finally getting into the visually appealing part of this chapter by starting to add in display objects using images. We don't have to refer to the terminal window for now. So let's focus on the simulator screen. We'll begin by creating a background image and some art assets.<a id="id150" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem">First off, create a new project folder to your desktop and name it<code class="literal"> Display Objects</code>.</li><li class="listitem">In the <code class="literal">Chapter 2 Resources</code> folder, copy the <code class="literal">glassbg.png</code> and <code class="literal">moon.png</code> image files into your <code class="literal">Display Objects</code> project folder. You can download the project files accompanying this book from the Packt website.<a id="id151" class="indexterm"/></li><li class="listitem">Launch your text editor and create a new <code class="literal">main.lua</code> file for your current project.</li><li class="listitem">Write out the following lines of code:<div><pre class="programlisting">local background = display.newImage( "glassbg.png", true )
local image01 = display.newImage( "moon.png", 110, 30 )
local image02 = display.newImage( "moon.png" )
image02.x = 160; image02.y = 200
image03 = display.newImage( "moon.png" )
image03.x = 160; image03.y = 320
</pre></div><p>The display object for your background variable should contain the filename of the background image in your project folder. For example, if the background image filename is called <code class="literal">glassbg.png</code>, then you would display the image as follows:
</p><div><pre class="programlisting">local background = display.newImage( "glassbg.png", true )
</pre></div><p>Using<code class="literal"> image02.x = 160; image02.y = 200</code> is the same as follows:
</p><div><pre class="programlisting">image02.x = 160
image02.y = 200
</pre></div><p>The semicolon (;) indicates the end of a statement and is optional. It makes it easier to separate two or more statements in one line and saves adding extra lines to your code.
</p></li><li class="listitem">Save your script and launch your project in the simulator.<div><h3 class="title"><a id="note11"/>Note</h3><p>If you're using Corona SDK on a Mac OSX, the default device is the iPhone. If you're using Windows, the default device is the Droid.</p></div></li><li class="listitem">You should see a background image and three other display objects that are the same as the image shown in as shown in the following screenshot. The display results will vary depending on which device you use to simulate.<div><img src="img/1888_02_01.jpg" alt="Time for action—placing images on screen"/></div></li></ol></div><p>The display objects for variables <code class="literal">image01, image02</code>, and <code class="literal">image03</code> should contain the <code class="literal">moon.png</code> filename. The filenames in your code are case-sensitive, so make sure that you write it exactly how it displays in your project folder.<a id="id152" class="indexterm"/>
</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec23"/>What just happened?</h2></div></div></div><p>Currently, <code class="literal">background</code> is set to full resolution because we specified <code class="literal">true</code> in the display object. We also have the image centered about its local origin since no <code class="literal">top</code> or <code class="literal">left</code> coordinates were applied.</p><p>When you observe the placement of <code class="literal">image01, image02</code>, and <code class="literal">image03</code> in the simulator, they're practically in line with each other vertically, though the script style for <code class="literal">image01</code> versus <code class="literal">image02/image03</code> are written differently. This is because the coordinates for <code class="literal">image01</code> are based on <code class="literal">(left, top)</code> of the display object. You can optionally specify that the image's top-left corner be located at the coordinate <code class="literal">(left, top)</code>; if you don't supply both coordinates, the image will be centered about its local origin.</p><p>Placement for <code class="literal">image02</code> and <code class="literal">image03</code> are specified from their local origin of the display object and positioned by local values of x and y properties of the device screen. The local origin is at the center of the image; the reference point is initialized at this point. Since we didn't apply <code class="literal">(left, top)</code> values to <code class="literal">image02</code> and <code class="literal">image03</code>, further access to x or y properties are referred to the center of the image.<a id="id153" class="indexterm"/>
</p><p>Now, you've probably noticed that the output from the iPhone 3G looks fine and dandy, but the output from the Droid shows that the display objects are not centered and the background image doesn't even fill the entire screen. We see that all the objects we specified are there but the scaling is off. That is because each iOS and Android device has different screen resolutions. The iPhone 3G has a screen resolution of 320 x 480 pixels and the Droid has a screen resolution of 480 x 854 pixels. What may look fine on one type of device may not look exactly the same on a different one. Don't worry, there is a simple solution to fix all that by using a <code class="literal">config.lua</code> file that we will discuss in the next couple of sections.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec24"/>Have a go hero—adjusting display object properties</h2></div></div></div><p>Now that you know how to add images onto the device screen, try testing out the other display properties. Try doing any of the following:<a id="id154" class="indexterm"/>
</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Change all the x and y coordinates of <code class="literal">image01, image02</code>, and <code class="literal">image03</code> display objects</li><li class="listitem" style="list-style-type: disc">Choose any display object and change its rotation</li><li class="listitem" style="list-style-type: disc">Change the visibility of a single display object</li></ul></div><p>Refer to the display properties mentioned earlier in this chapter in case you're unsure how to do any of the preceding adjustments.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec12"/>Runtime configuration</h1></div></div></div><p>All project files not only contain a <code class="literal">main.lua</code> file but other <code class="literal">.lua</code> and related assets as needed for your project. Some Corona projects are configured using a <code class="literal">config.lua</code> file that is compiled into your project and accessed at runtime. This allows you to specify dynamic content scaling, dynamic content alignment, dynamic image resolution, frame rate control, and anti-aliasing all at the same time so that the output on every type of device is displayed similarly.<a id="id155" class="indexterm"/>
</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec25"/>Dynamic content scaling</h2></div></div></div><p>You can specify to Corona what the original screen size for your content is. Then allow it to scale your app to run on a device that has a different screen size to the original.<a id="id156" class="indexterm"/>
</p><p>The following values should be used to scale content:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">width</code> (number)—Screen resolution width of the original target device (in portrait orientation)</li><li class="listitem" style="list-style-type: disc"><code class="literal">height</code> (number)—Screen resolution height of the original target device (in portrait orientation)</li><li class="listitem" style="list-style-type: disc"><code class="literal">scale</code> (string)—Type of autoscaling from the following:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">none</code>—Dynamic content scaling turned off</li><li class="listitem" style="list-style-type: disc"><code class="literal">letterbox</code>—Uniformly scales up content as much as possible</li><li class="listitem" style="list-style-type: disc"><code class="literal">zoomEven</code>—Scales up content uniformly to fill the screen, while keeping the aspect ratio</li><li class="listitem" style="list-style-type: disc"><code class="literal">zoomStretch</code>—Scales up content non-uniformly to fill the screen and will stretch it vertically or horizontally</li></ul></div><div><h3 class="title"><a id="note12"/>Note</h3><p>
<code class="literal">zoomStretch</code> works well with Android device scaling since many of them have different screen resolutions.</p></div></li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec26"/>Dynamic content alignment</h2></div></div></div><p>Content that is dynamically scaled is already centered by default. You may find cases where you don't want the content to be centered. Devices such as the iPhone 3G and the Droid have completely different screen resolutions. In order for the content displayed on the Droid to match the iPhone 3G, the alignment needs to be adjusted so the content fills the entire screen without leaving any empty black screen space.<a id="id157" class="indexterm"/>
</p><p>
<code class="literal">xAlign:</code> A string that specifies the alignment in the x-direction. The following values can be used:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">left</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">center</code> (Default)</li><li class="listitem" style="list-style-type: disc"><code class="literal">right</code></li></ul></div><p>
<code class="literal">yAlign:</code> A string that specifies the alignment in the y-direction. The following values can be used:<a id="id158" class="indexterm"/>
</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">top</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">center</code> (Default)</li><li class="listitem" style="list-style-type: disc"><code class="literal">bottom</code></li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec27"/>Dynamic image resolution</h2></div></div></div><p>Corona allows you to swap in higher-resolution versions of your images to higher-resolution devices, without having to change your layout code. This is a case to consider if building for multiple devices with different screen resolutions.<a id="id159" class="indexterm"/>
</p><p>An example where you want to display high-resolution images is on an iPhone 4 where the resolution is 640 x 960 pixels. It is double the resolution of the earlier iOS devices such as the iPod Touch 2G or the iPhone 3GS which both are 320 x 480 pixels. Scaling up the content from the iPhone 3GS to fit the iPhone 4 screen works, but the images will not be as crisp and will look a little fuzzy on the device.</p><p>Images of higher resolution can be swapped in for the iPhone 4 by adding a <code class="literal">@2x</code> suffix to the end of filenames. For example, if your image filename is <code class="literal">myImage.png</code> then your higher resolution filename should be <code class="literal">myImage@2x.png</code>.</p><p>In your <code class="literal">config.lua</code> file, a table named <code class="literal">imageSuffix</code> needs to be added for the image naming convention and image resolutions to take effect. The <code class="literal">config.lua</code> file resides in your project folder where all your other <code class="literal">.lua</code> files and image files are stored. Look at the following example:</p><div><pre class="programlisting">application =
{
content =
{
width = 320,
height = 480,
scale = "letterbox",
imageSuffix =
{
["@2x"] = 2,
},
},
}
</pre></div><p>When calling your display objects, use <code class="literal">display.newImageRect( [parentGroup,] filename [, baseDirectory] w, h )</code> instead of <code class="literal">display.newImage()</code>. The target height and width need to be set to the dimensions of your base image.<a id="id160" class="indexterm"/>
</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec28"/>Frame rate control and anti-aliasing</h2></div></div></div><p>The frame rate is 30 fps (frames per second) by default. FPS refers to the speed at which the image is refreshed in games. 30 fps is the standard in mobile games, especially for older devices. You can set it to 60 fps when you add in the fps key. Using 60 fps makes your app run smoother. You can easily detect a life-like fluidity in the motion when it comes to running animations or collision detections.<a id="id161" class="indexterm"/>
</p><p>Corona uses software anti-aliasing for vector objects. By default, it is turned off to improve the performance of the vector objects. You can turn it on by setting the <code class="literal">antialias</code> key to <code class="literal">true</code>.</p><p>See the following example:</p><div><pre class="programlisting">application =
{
content =
{
fps = 60,
antialias = true,
},
}
</pre></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec13"/>Time for action—scaling display objects on multiple devices</h1></div></div></div><p>In our <code class="literal">Display Objects</code> project, we left off displaying a background image and three similar display objects in the simulator. When running the project on different devices, the coordinates and resolution size were most compatible with the iPhone only. When building applications for multiple devices across iOS and Android platforms, we can configure it using a <code class="literal">config.lua</code> file that is compiled into the project and accessed at runtime. So let's get to it!<a id="id162" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem">In your text editor, create a new file and write out the following lines:<div><pre class="programlisting">application =
{
content =
{
width = 320,
height = 480,
scale = "letterbox",
xAlign = "left",
yAlign = "top"
},
}
</pre></div></li><li class="listitem">Save your script as <code class="literal">config.lua</code> in your <code class="literal">Display Objects</code> project folder.</li><li class="listitem">Mac users, launch your application in Corona under the iPhone device. Once you have done so, under the<strong> Corona Simulator</strong> menu bar, select<strong> Window</strong> |<strong> View As</strong> |<strong> iPhone 4</strong>. You will notice that the display objects fit perfectly on the screen and that there are no empty black spaces showing either.<a id="id163" class="indexterm"/></li><li class="listitem">Windows users, launch your application in Corona under the Droid device. You will notice that all the content is scaled and aligned properly. Under the<strong> Corona Simulator</strong> menu bar, select<strong> Window</strong> |<strong> View As</strong> |<strong> NexusOne</strong>. Observe the similarities of content placement to that of the Droid. From left to right: iPhone 3G, iPhone 4, Droid, and NexusOne.<div><img src="img/1888_02_02.jpg" alt="Time for action—scaling display objects on multiple devices"/></div></li></ol></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec29"/>What just happened?</h2></div></div></div><p>We have now learned a way to implement easy configuration to display our content across a variety of devices on iOS and Android. Content scaling features are useful for multiscreen development. If you look at the <code class="literal">config.lua</code> file we created, the content <code class="literal">width = 320</code> and <code class="literal">height = 480</code>. This is the resolution size that the content is originally authored for. In this case, it is the iPhone 3G. Since we used <code class="literal">scale = "letterbox"</code>, it enabled the content to uniformly scale up as much as possible, while still showing all content on the screen.<a id="id164" class="indexterm"/>
</p><p>We also set <code class="literal">xAlign = "left"</code> and <code class="literal">yAlign = "top"</code>. This fills in the empty black screen space that shows on the Droid specifically. The content scaling is in the center by default so by aligning the content to the left and top of the screen the additional screen space will be taken away.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec30"/>Dynamic resolution images</h2></div></div></div><p>Earlier, we touched base with dynamic image resolution. iOS devices are a perfect example in this case. Corona has the capability to use base images (for devices on the 3GS and lower) and double-resolution images (for the iPhone 4 that has<strong> retina display)</strong> all within the same project file. Any of your double-resolution images can be swapped to your high-end iOS device without having to alter your code. This will allow your build to coincide with older devices and let you handle more complex multiscreen deployment cases. You will notice that dynamic image resolution works in conjunction with dynamic content scaling.<a id="id165" class="indexterm"/>
</p><p>Using the line <code class="literal">display.newImageRect( [parentGroup,] filename [, baseDirectory] w, h )</code> will call out your dynamic resolution images.</p><p>
<code class="literal">w</code> refers to the content<em> width</em> of the image and <code class="literal">h</code> refers to the content<em> height</em> of the image.</p><p>For example:</p><div><pre class="programlisting">myImage = display.newImageRect( "image.png", 128, 128 )
</pre></div><p>Remember that the two values represent the base image size,<em> not</em> the onscreen position of the image. You must define the base size in your code so that Corona knows how to render the higher-resolution alternative images. The contents of your project folder will be set up similarly as follows:</p><div><pre class="programlisting">My New Project/ name of your project folder
Icon.png required for iPhone/iPod/iPad
Icon@2x.png required for iPhone/iPod with Retina display
main.lua
config.lua
myImage.png Base image (Ex. Resolution 128 x 128 pixels)
myImage@2x.png Double resolution image (Ex. Resolution 256 x 256 pixels)
</pre></div><p>When creating your double resolution image, make sure that it is twice the size of the base image. It's best when creating your display assets that you start with the double resolution image. Corona lets you select your own image naming patterns. The <code class="literal">@2x</code> convention is one example that can be used but you have the option of naming suffixes to your personal preference. For now, we'll use the <code class="literal">@2x</code> suffix since it distinguishes the double resolution reference. When you create your double resolution image, name it with the <code class="literal">@2x</code> suffix included. Take the same image and resize it to 50 percent of the original size and then use the same filename without the <code class="literal">@2x</code> included.<a id="id166" class="indexterm"/>
</p><p>Other examples on naming suffixes can be:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">@2</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">-2</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">-two</code></li></ul></div><p>As mentioned earlier in the chapter, you have to define your image suffix for your double-resolution images in the <code class="literal">imageSuffix</code> table in your <code class="literal">config.lua</code> file. The content scale you set will allow Corona to determine the ratio between the current screen and base content dimensions. The following example uses the suffix <code class="literal">@2x</code> to define double-resolution images:</p><div><pre class="programlisting">application =
{
content =
{
width = 320,
height = 480,
scale = "letterbox",
imageSuffix =
<strong>{
["@2x"] = 2,
},</strong>
},
}
</pre></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec14"/>Time for some shapes</h1></div></div></div><p>Another way of creating display objects is using<strong> vector objects</strong>. You can use vector objects to create shapes, such as a rectangle, rounded rectangle, and circle by using the following:<a id="id167" class="indexterm"/>
</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">display.newRect( [parentGroup,] left, top, width, height )</code> creates a rectangle using <code class="literal">width</code> by <code class="literal">height</code>. Location starts from the top-left corner of the device screen using <code class="literal">left</code> and <code class="literal">top</code> as your coordinates of placement.</li><li class="listitem" style="list-style-type: disc"><code class="literal">display.newRoundedRect( [parentGroup,] left, top, width, height, cornerRadius )</code> creates a rounded rectangle using <code class="literal">width</code> by <code class="literal">height</code>. Location starts from the top-left corner of the device screen using <code class="literal">left</code> and <code class="literal">top</code> as your coordinates of placement. Rounding off the corners uses <code class="literal">cornerRadius.</code><a id="id168" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.newCircle( [parentGroup,] xCenter, yCenter, radius )</code> creates a circle using <code class="literal">radius</code> centered at <code class="literal">xCenter, yCenter</code>.</li></ul></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec31"/>Applying stroke width, fill color, and stroke color</h2></div></div></div><p>All vector objects can be outlined using strokes. You can set the stroke width, fill color and stroke color.<a id="id169" class="indexterm"/>
</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">object.strokeWidth</code>—Creates the stroke width in pixels.</li><li class="listitem" style="list-style-type: disc"><code class="literal">object:setFillColor( r, g, b [, a] )</code>—Using the <code class="literal">r,g,b</code> codes between 0 and 255. <code class="literal">a</code> refers to the<strong> alpha</strong>, which is optional and defaulted at 255.</li><li class="listitem" style="list-style-type: disc"><code class="literal">object:setStrokeColor( r, g, b [, a] )</code>—Using the <code class="literal">r,g,b</code> codes between 0 and 255. <code class="literal">a</code> refers to the alpha, which is optional and defaulted at 255.</li></ul></div><p>The following is an example of displaying vector objects using strokes:</p><div><pre class="programlisting">local rect = display.newRect(110, 100, 250, 250)
rect:setFillColor(255, 255, 255)
rect:setStrokeColor(45, 180, 100)
rect.strokeWidth = 10
</pre></div><div><img src="img/1888_02_03.jpg" alt="Applying stroke width, fill color, and stroke color"/></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec32"/>Text, text, text</h2></div></div></div><p>In<a class="link" href="ch01.html" title="Chapter 1. Getting Started With Corona SDK"> Chapter 1</a>,<em> Getting Started With Corona SDK</em>, we created the Hello World application using a text display object. Let's go in detail on how text is implemented onscreen.<a id="id170" class="indexterm"/>
</p><p>
<code class="literal">display.newText( [parentGroup,] string, x, y, font, size )</code> creates a text object using <code class="literal">x</code> and <code class="literal">y</code> values. There is no text color by default. In the <code class="literal">font</code> parameter, apply any of the font names in the library. The <code class="literal">size</code> parameter displays the size of the text. Some of the default constants can be used if you don't want to apply a font name:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">native.systemFont</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">native.systemFontBold</code></li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec33"/>Applying color and string value</h2></div></div></div><p>The size, color, and text fields can be set or retrieved in text display objects.<a id="id171" class="indexterm"/>
</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">object.size</code>—The size of the text</li><li class="listitem" style="list-style-type: disc"><code class="literal">object:setTextColor( r, g, b [, a] )</code>—Using the <code class="literal">r,g,b</code> codes between 0 and 255. <code class="literal">a</code> refers to the alpha, which is optional and defaulted at 255</li><li class="listitem" style="list-style-type: disc"><code class="literal">object.text</code>—Contains the text of the textfield. It allows you to update a string value for a test object</li></ul></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec15"/>Functions</h1></div></div></div><p>Functions can carry out a procedure or compute and return values. We can make a function call as a statement or we can use it as an expression. We have learned that functions can be variables. A table can use those variables to store them as properties.<a id="id172" class="indexterm"/>
</p><p>Functions are the most important means of abstraction in Lua. One function that we have used many times is: <code class="literal">print</code>. In the following example, the <code class="literal">print</code> function is being told to execute one piece of data—the string,<code class="literal">"My favorite number is 8":</code>
</p><div><pre class="programlisting">print("My favorite number is 8") -- My favorite number is 8
</pre></div><p>Another way of saying this is that <code class="literal">print</code> is being called with one argument. <code class="literal">print</code> is only one of the many built-in functions that Lua has, but almost any program you write will involve you defining your own functions.</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec34"/>Defining a function</h2></div></div></div><p>When trying to define a function, you have to give it a name that you can call out to when you want to return a value. You then have to create a statement of what the value will output and then apply <code class="literal">end</code> to your function after you have finished defining it. For example:<a id="id173" class="indexterm"/>
</p><div><pre class="programlisting">function myName()
print("My name is Jane.")
end
myName() -- My name is Jane.
</pre></div><p>Notice that the function name is <code class="literal">myName</code> and is used to call out what's inside the function definition <code class="literal">print("My name is Jane.")</code>.</p><p>An alternative to defining a function is as follows:</p><div><pre class="programlisting">function myName(Name)
print("My name is " .. Name .. ".")
end
myName("Jane") -- My name is Jane.
myName("Cory") -- My name is Cory.
myName("Diane") -- My name is Diane.
</pre></div><p>The new <code class="literal">myName</code> function has one argument using the variable <code class="literal">Name</code>. The string,<code class="literal">"My name is "</code> is concatenated with <code class="literal">Name</code> and then a period as the printed result. When the function is called, we used three different names as an argument and the result is printed with a new customized name for each line.<a id="id174" class="indexterm"/>
</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec35"/>More display functions</h2></div></div></div><p>In Corona, you can change the appearance of the status bar on your device. This is a one-line setting in your code that takes effect once you launch your application.<a id="id175" class="indexterm"/>
</p><p>
<code class="literal">display.setStatusBar( mode )</code>—Hides or changes the appearance of the status bar on iOS devices (iPad, iPhone, and iPod Touch) and Android 2.x devices. Android 3.x devices are not supported.</p><p>The argument mode should be one of the following:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">display.HiddenStatusBar:</code> To hide the status bar, you can use the following line at the beginning of your code:<a id="id176" class="indexterm"/><div><pre class="programlisting">display.setStatusBar( display.HiddenStatusBar )
</pre><div><img src="img/1888_02_04.jpg" alt="More display functions"/></div></div></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.DefaultStatusBar:</code> To show the default status bar, you can use the following line at the beginning of your code:<a id="id178" class="indexterm"/><div><pre class="programlisting">display.setStatusBar(display.DefaultStatusBar)
</pre><div><img src="img/1888_02_05.jpg" alt="More display functions"/></div></div></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.TranslucentStatusBar:</code> To show the translucent status bar, you can use the following line at the beginning of your code:<a id="id179" class="indexterm"/><div><pre class="programlisting">display.setStatusBar(display.TranslucentStatusBar)
</pre><div><img src="img/1888_02_06.jpg" alt="More display functions"/></div></div></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.DarkStatusBar:</code> To show the dark status bar, you can use the following line at the beginning of your code:<a id="id180" class="indexterm"/><div><pre class="programlisting">display.setStatusBar(display.DarkStatusBar)
</pre><div><img src="img/1888_02_07.jpg" alt="More display functions"/></div></div></li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec36"/>Content size properties</h2></div></div></div><p>When you want to obtain display information on your device, you can use the content size properties to return the values.<a id="id182" class="indexterm"/>
</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">display.contentWidth</code>—Returns the original width of the content in pixels. This will default to the screen width.<a id="id183" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.contentHeight</code>—Returns the original height of the content in pixels. This will default to the screen height.<a id="id184" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.viewableContentWidth</code>—A read-only property that contains the width of the viewable screen area in pixels, within the coordinate system of the original content. Accessing this property will display how the content is viewed, whether you're in portrait or landscape mode. For example:<a id="id185" class="indexterm"/><div><pre class="programlisting">print( display.viewableContentWidth )
</pre></div></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.viewableContentHeight</code>—A read-only property that contains the height of the viewable screen area in pixels within the coordinate system of the original content. Accessing this property will display how the content is viewed, whether you're in portrait or landscape mode. For example:<a id="id186" class="indexterm"/><div><pre class="programlisting">print( display.viewableContentHeight )
</pre></div></li><li class="listitem" style="list-style-type: disc"><code class="literal">display.statusBarHeight</code>—A read-only property representing the height of the status bar in pixels (only valid on iOS devices). For example:<a id="id187" class="indexterm"/><div><pre class="programlisting">print(display.statusBarHeight)
</pre></div></li></ul></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec16"/>Optimizing your workflow</h1></div></div></div><p>So far, we have touched on the vital basics of programming in Lua and terminology used in Corona SDK. Once you start developing interactive applications to sell in the App Store or Google Play Store, you need to be aware of your design choices and how they affect the performance of your application. This means taking into consideration how much memory your mobile device is using to process the application. Here are some things to look for if you're just starting out on Corona SDK.<a id="id188" class="indexterm"/>
</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec37"/>Using memory efficiently</h2></div></div></div><p>In some of our earlier examples, we used global variables in our code. Cases like those are an exception since the examples did not contain a high volume of functions, loops to call out to or display objects. Once you start building a game that is heavily involved with function calls and numerous display objects, local variables will increase performance within your application and will be placed on the stack so Lua can interface with them faster.<a id="id189" class="indexterm"/>
</p><p>The following code will cause memory leaks:</p><div><pre class="programlisting">-- myImage is a global variable
<strong>myImage = display.newImage( "image.png" )
</strong>
myImage.x = 160; myImage.y = 240
-- A touch listener to remove object
local removeBody = function( event )
local t = event.target
local phase = event.phase
if "began" == phase then
-- variable "myImage" still exists even if it's not displayed
t:removeSelf() -- Destroy object
end
-- Stop further propagation of touch event
return true
end
myImage:addEventListener( "touch", removeBody )
</pre></div><p>The preceding code removes <code class="literal">myImage</code> from the display hierarchy once it is touched. The only problem is that the memory used by <code class="literal">myImage</code> leaks because the variable <code class="literal">myImage</code> still refers to it. Since <code class="literal">myImage</code> is a global variable, the display object it references will not be freed even though <code class="literal">myImage</code> does not display on the screen.<a id="id190" class="indexterm"/>
</p><p>Unlike global variables, localizing variables help speed up the look-up process for your display object. Also, it only exists within the block or chunk of code that it's defined in. Using a local variable in the following code will remove the object completely and free up memory:</p><div><pre class="programlisting">-- myImage is a local variable
<strong>local myImage = display.newImage( "image.png" )
</strong>
myImage.x = 160; myImage.y = 240
-- A touch listener to remove object
local removeBody = function( event )
local t = event.target
local phase = event.phase
if "began" == phase then
t:removeSelf() -- Destroy object
end
-- Stop further propagation of touch event
return true
end
myImage:addEventListener( "touch", removeBody )
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec38"/>Optimizing your display images</h2></div></div></div><p>It's important to optimize your image file size as much as you can. Using full-screen images can impact the performance of your application. They require more time to load on a device and consume a lot of texture memory. When a lot of memory is consumed in an application, in most cases it'll be forced to quit.<a id="id191" class="indexterm"/>
</p><p>iOS devices vary in available memory, depending which one you have:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">iPhone 3G, iTouch 2G—128 MB RAM</li><li class="listitem" style="list-style-type: disc">iPhone 3GS, iPad, iTouch 3G/4G—256 MB RAM</li><li class="listitem" style="list-style-type: disc">iPhone 4/4S, iPad 2—512 MB RAM</li></ul></div><p>For example, texture memory on the iPhone 3GS should be kept under 25 MB before performance issues start occurring by slowing down your app or even forcing it to quit. An iPad 2 would have no problem going further down that boundary since it has more memory available.<a id="id192" class="indexterm"/>
</p><p>Refer to the following link to apply memory warnings for iOS devices:<a class="ulink" href="http://developer.anscamobile.com/reference/index/memorywarning-ios"> http://developer.anscamobile.com/reference/index/memorywarning-ios</a>.</p><p>For Android devices, there is around a 24 MB memory limit. So it's important to be aware of how many display objects you have in your scene and how to manage them when they are not needed anymore in your app.</p><p>In cases where you no longer need an image to be displayed on screen use the following code:</p><div><pre class="programlisting">image.parent:remove( image ) -- remove image from hierarchy
-- or --
image:removeSelf( ) -- same as above
</pre></div><p>If you want to remove an image from the scene completely throughout the lifetime of your app, include the following line after your <code class="literal">image.parent:remove( image )</code> or <code class="literal">image:removeSelf()</code> code:</p><div><pre class="programlisting">image = nil
</pre></div><p>Keeping memory usage low within your application will prevent crashes and improve performance. For more information on optimization, go to the following URL:<a class="ulink" href="http://developer.anscamobile.com/content/performance-and-optimization"> http://developer.anscamobile.com/content/performance-and-optimization</a>.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec39"/>Pop quiz—basics of Lua</h2></div></div></div><div><ol class="orderedlist"><li class="listitem">Which of the following are values?<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: none">a. Numbers</li><li class="listitem" style="list-style-type: none">b. nil</li><li class="listitem" style="list-style-type: none">c. Strings</li><li class="listitem" style="list-style-type: none">d. All of the above</li></ul></div></li><li class="listitem">Which relational operator is false?<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: none">a. <code class="literal">print(0 == 0)</code></li><li class="listitem" style="list-style-type: none">b. <code class="literal">print(3 &gt;= 2)</code></li><li class="listitem" style="list-style-type: none">c. <code class="literal">print(2 ~= 2)</code></li><li class="listitem" style="list-style-type: none">d. <code class="literal">print(0 ~= 2)</code></li></ul></div></li><li class="listitem">What is the correct way to scale an object in the x direction?<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: none">a. <code class="literal">object.scaleX</code></li><li class="listitem" style="list-style-type: none">b. <code class="literal">object.xscale</code></li><li class="listitem" style="list-style-type: none">c. <code class="literal">object.Xscale</code></li><li class="listitem" style="list-style-type: none">d. <code class="literal">object.xScale</code></li></ul></div></li></ol></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec17"/>Summary</h1></div></div></div><p>This chapter discussed parts of Lua programming that will send you on your way to start creating your own apps in Corona. As you continue working with Lua, you'll start understanding the terminology better. Eventually you'll find new programming solutions that will benefit your development process.</p><p>The following are some skills you learned so far:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Creating variables and assigning values to them</li><li class="listitem" style="list-style-type: disc">Establishing expressions by using operators</li><li class="listitem" style="list-style-type: disc">How to use the Corona Terminal to output or print results</li><li class="listitem" style="list-style-type: disc">Use tables to structure lists, arrays, sets, and so on</li><li class="listitem" style="list-style-type: disc">Adding display objects in the simulator</li><li class="listitem" style="list-style-type: disc">Configuring your application build to work on different mobile devices</li><li class="listitem" style="list-style-type: disc">Implementing dynamic resolution images</li><li class="listitem" style="list-style-type: disc">Creating functions to run a block of code</li></ul></div><p>There was definitely a lot to take in in this section. There is still a handful of information on Lua that we didn't get to touch base on but you have learned enough to get you started. For more information on programming in Lua, you can refer to<a class="ulink" href="http://www.lua.org/pil/index.html"> http://www.lua.org/pil/index.html</a> or the resources section on the Corona website at<a class="ulink" href="http://www.anscamobile.com/resources/"> http://www.anscamobile.com/resources/</a>.</p><p>In the next chapter, we'll start making our very first game called Breakout! You'll get some hands-on experience of creating a game framework in Corona and applying all the necessary assets to develop a mobile game. You'll be surprised at how fast and simple it is to create one.</p></div></body></html>