<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch10"/>Chapter 10. Integrating with Game Center</h1></div></div></div><p>Apple provides an online social gaming network called <strong>Game Center</strong>. Your players can share high scores, track achievements, challenge friends, and start matchmaking for multiplayer games with Game Center. In this chapter, we will use Apple's iTunes Connect website to register our app with Apple. Then, we can integrate with Game Center to add leaderboards and achievements in our game.</p><div><div><h3 class="title"><a id="tip14"/>Tip</h3><p>You will need an active Apple developer account (which costs $99 per year) to register your app with Apple, access the iTunes Connect website with Game Center, and publish your game to the App Store.</p></div></div><p>The topics in this chapter include:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Registering an app with iTunes Connect</li><li class="listitem" style="list-style-type: disc">Authenticating the player's Game Center account in our app</li><li class="listitem" style="list-style-type: disc">Opening Game Center from the <code class="literal">MenuScene</code> class</li><li class="listitem" style="list-style-type: disc">Adding a leaderboard</li><li class="listitem" style="list-style-type: disc">Creating and awarding achievements</li></ul></div><div><div><div><div><h1 class="title"><a id="ch10lvl1sec76"/>Registering an app with iTunes Connect</h1></div></div></div><p>Since Apple <a id="id336" class="indexterm"/>will be storing our high scores and achievements on their centralized servers, we need to communicate to Apple that we need Game<a id="id337" class="indexterm"/> Center for our app. The first step is to create a record for our app on the <a id="id338" class="indexterm"/>iTunes Connect website. Follow these steps to create an iTunes Connect record:</p><div><ol class="orderedlist arabic"><li class="listitem">In a web browser, navigate to <a class="ulink" href="http://itunesconnect.apple.com">http://itunesconnect.apple.com</a>.</li><li class="listitem">Sign in with your Apple developer account information.</li><li class="listitem">When you reach the <strong>iTunes Connect</strong> dashboard, click on the <strong>My Apps</strong> icon.</li><li class="listitem">Towards the upper left, click on the <strong>+</strong> symbol and select <strong>New iOS App</strong>, as shown here:<div><img src="img/Image_B04532_10_01.jpg" alt="Registering an app with iTunes Connect"/></div></li><li class="listitem">In the <a id="id339" class="indexterm"/>subsequent dialogue, locate the link at the bottom that says <strong>Register a new bundle ID on the Developer Portal</strong>. Click this link to create a bundle ID for your app.</li><li class="listitem">You <a id="id340" class="indexterm"/>will arrive on a page titled <strong>Registering an App ID</strong>. This page may appear overwhelming at first, but you only need to fill out two fields. First, enter the name of your app in the <strong>App Description</strong> section.</li><li class="listitem">Scroll down to the <strong>App ID Suffix</strong> section. Make sure to select <strong>Explicit App ID</strong> and then enter the <strong>Bundle ID</strong> field from your Xcode project settings, as shown here:<div><img src="img/Image_B04532_10_02.jpg" alt="Registering an app with iTunes Connect"/></div></li><li class="listitem">Scroll <a id="id341" class="indexterm"/>down to the <strong>App Services</strong> section and double-check that the Game Center option is already checked.</li><li class="listitem">At the bottom of the page, click <strong>Continue</strong>. Then click <strong>Submit</strong> on the subsequent confirmation page.</li><li class="listitem">You<a id="id342" class="indexterm"/> can now close this tab and return to iTunes Connect, picking up where you left off on the new iOS app screen.<div><div><h3 class="title"><a id="tip15"/>Tip</h3><p>It can take some time before the bundle ID you just created shows up in iTunes Connect. If this happens, take a break and try again after a few moments.</p></div></div></li><li class="listitem">Enter the <strong>Name</strong> of your app, the <strong>Primary Language</strong>, the <strong>Version</strong>, and <strong>SKU</strong> (which is not visible to the public). Then select the <strong>Bundle ID</strong> you just created, as shown in this screenshot:<div><img src="img/Image_B04532_10_03.jpg" alt="Registering an app with iTunes Connect"/></div></li><li class="listitem">Click <strong>Create</strong> in<a id="id343" class="indexterm"/> the lower right. You should now see an overview for your app in iTunes Connect, which will look something like this screenshot:<div><img src="img/Image_B04532_10_05.jpg" alt="Registering an app with iTunes Connect"/></div></li></ol></div><p>Congratulations, not <a id="id344" class="indexterm"/>only are we closer to configuring Game Center, we have also taken the first step towards preparing our app for submission to the app store!</p><div><div><div><div><h2 class="title"><a id="ch10lvl2sec96"/>Configuring Game Center</h2></div></div></div><p>Now that we <a id="id345" class="indexterm"/>have an iTunes Connect app record, we can tell Apple more about how we want to use Game Center in our game. Follow these steps to configure Game Center:</p><div><ol class="orderedlist arabic"><li class="listitem">On your app page, click the link for Game Center in the top navigation.</li><li class="listitem">Choose <strong>Enable for Single Game</strong>, as shown here:<div><img src="img/Image_B04532_10_06.jpg" alt="Configuring Game Center"/></div></li><li class="listitem">You will<a id="id346" class="indexterm"/> see a screen allowing you to create new leaderboards and achievements for your game. Perfect! We will use this page later in the chapter.</li></ol></div><p>We have informed Apple that we want to use Game Center in our game. Next, we need to create a sandbox user account for testing purposes.</p></div><div><div><div><div><h2 class="title"><a id="ch10lvl2sec97"/>Creating a test user</h2></div></div></div><p>Game Center uses <a id="id347" class="indexterm"/>separate test servers during app development, so we will not be able to use our real Apple ID to log in to Game Center while we are testing. Instead, we will create a sandbox account in iTunes Connect.</p><div><blockquote class="blockquote"><p><em>The website of iOS Developer Library states "Always create new test accounts to test your game in Game Center. Never use an existing Apple ID."</em></p></blockquote></div><p>Follow these steps to create a Game Center sandbox account for testing:</p><div><ol class="orderedlist arabic"><li class="listitem">In <strong>iTunes Connect</strong>, use the dropdown menu in the upper left to select <strong>Users and Roles</strong>, as shown here:<div><img src="img/Image_B04532_10_07.jpg" alt="Creating a test user"/></div></li><li class="listitem">Once <a id="id348" class="indexterm"/>you are on the <strong>Users and Roles</strong> page, click on <strong>Sandbox Testers</strong> in the navigation bar at the top of the screen.</li><li class="listitem">As directed on the <strong>Sandbox Testers</strong> page, click the <strong>+</strong> icon to add a new user.</li><li class="listitem">Fill out the test user's information to your liking. Here is how I filled out my test user's information:<div><img src="img/Image_B04532_10_08.jpg" alt="Creating a test user"/></div></li><li class="listitem">Click <a id="id349" class="indexterm"/>the <strong>Save</strong> button to create the new user.</li></ol></div><div><div><h3 class="title"><a id="tip16"/>Tip</h3><p>Make sure to keep your live Apple ID and your sandbox account separate. The sandbox account will become invalid if you use it to log in to a live Game Center app.</p></div></div><p>Great! That is all we need to begin implementing Game Center into our game. The next step is to integrate Game Center with our game code. We will start by authenticating the player's Game Center account when they open our app.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch10lvl1sec77"/>Authenticating the player's Game Center account</h1></div></div></div><p>As soon as<a id="id350" class="indexterm"/> our app starts, we will check if the player is already logged in to their Game Center account. If not, we will give them a chance to log in. Later, when we want to submit high scores or achievements, we can use the authentication information we gathered when the app launched, instead of interrupting their gaming session to collect their Game Center information.</p><p>Follow these steps to authenticate the player's Game Center account when the app starts:</p><div><ol class="orderedlist arabic"><li class="listitem">We will be working in the <code class="literal">GameViewController</code> class, so open <code class="literal">GameViewController.swift</code> in Xcode.</li><li class="listitem">Add a new <code class="literal">import</code> statement at the top of the file so we can use the <code class="literal">GameKit</code> framework:<div><pre class="programlisting">import GameKit</pre></div></li><li class="listitem">In <a id="id351" class="indexterm"/>the <code class="literal">GameViewController</code> class, add a new function called <code class="literal">authenticateLocalPlayer</code> with this code:<div><pre class="programlisting">// (We pass in the menuScene instance so we can create a  
// leaderboard button in the menu when the player is
// authenticated with Game Center)
func authenticateLocalPlayer(menuScene:MenuScene) {
    // Create a new Game Center localPlayer instance:
    let localPlayer = GKLocalPlayer.localPlayer();
    // Create a function to check if they authenticated
    // or show them the log in screen:
    localPlayer.authenticateHandler = {
        (viewController : UIViewController!,error : NSError!) -&gt; Void in
        if viewController != nil {
            // They are not logged in, show the log in: self.presentViewController(viewController, animated: true, completion: nil)
        }
        else if localPlayer.authenticated {
            // They authenticated successfully!
            // We will be back later to create a // leaderboard button in the MenuScene
        }
        else {
            // Not able to authenticate, skip Game Center 
        }
    }
}</pre></div></li><li class="listitem">At the bottom of the <code class="literal">GameViewController</code> class <code class="literal">viewWillLayoutSubviews</code> function, add a call to the new <code class="literal">authenticateLocalPlayer</code> function you just created:<div><pre class="programlisting">authenticateLocalPlayer(menuScene)</pre></div></li></ol></div><p>Run your project. You should see Game Center animate in, asking for your credentials, as seen here:</p><div><img src="img/Image_B04532_10_13.jpg" alt="Authenticating the player's Game Center account"/></div><p>Great! Remember to use your sandbox account. The first time you log in, Game Center will ask a few extra questions to set up your account. Once you finish with the Game Center form, you <a id="id352" class="indexterm"/>should return to the main menu, with a small banner animating in and out from the top of the screen, letting you know you are signed in. The banner looks something like this:</p><div><img src="img/Image_B04532_10_14.jpg" alt="Authenticating the player's Game Center account"/></div><p>If you see this welcome back banner, you have successfully implemented the Game Center authentication code. Next, we will add a leaderboard button to the menu so the player can see their progress within our app.</p></div>
<div><div><div><div><h1 class="title"><a id="ch10lvl1sec78"/>Opening Game Center in our game</h1></div></div></div><p>If the user is <a id="id353" class="indexterm"/>authenticated, we will add a button to the <code class="literal">MenuScene</code> class so they can open the leaderboard and view achievements from within our game. Alternatively, players can always use the Game Center app in iOS to view their progress.</p><p>Follow these steps to create a leaderboard button in the menu scene:</p><div><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">MenuScene.swift</code> in Xcode.</li><li class="listitem">Add a new <code class="literal">import</code> statement at the top of the file so we can use the <code class="literal">GameKit</code> framework:<div><pre class="programlisting">import GameKit</pre></div></li><li class="listitem">Update <a id="id354" class="indexterm"/>the line that declares the <code class="literal">MenuScene</code> class so that our class adopts the <code class="literal">GKGameCenterControllerDelegate</code> protocol. This allows the Game Center screen to inform our scene when the player closes the Game Center:<div><pre class="programlisting">class MenuScene: SKScene<strong>, GKGameCenterControllerDelegate </strong>{</pre></div></li><li class="listitem">We need a function that will create the leaderboard button and add it to the scene. We will call this function once the Game Center authenticates the player. Add a new function to the <code class="literal">MenuScene</code> class named <code class="literal">createLeaderboardButton</code> as shown here:<div><pre class="programlisting">func createLeaderboardButton() {
    // Add some text to open the leaderboard
    let leaderboardText = SKLabelNode(fontNamed: "AvenirNext")
    leaderboardText.text = "Leaderboard"
    leaderboardText.name = "LeaderboardBtn"
    leaderboardText.position = CGPoint(x: 0, y: -100)
    leaderboardText.fontSize = 20
    self.addChild(leaderboardText)
}</pre></div></li><li class="listitem">We will call our <code class="literal">createLeaderboardButton</code> function from the <code class="literal">didMoveToView</code> function if the player is already authenticated with Game Center. This creates the button for players who return to the main menu after playing a game. Add the following code to the bottom of the <code class="literal">didMoveToView</code> function:<div><pre class="programlisting">// If they're logged in, create the leaderboard button
// (This will only apply to players returning to the menu)
if GKLocalPlayer.localPlayer().authenticated {
    createLeaderboardButton()
}</pre></div></li><li class="listitem">Next, we will create the function that actually opens the Game Center. Add a new function named <code class="literal">showLeaderboard</code>, as shown here:<div><pre class="programlisting">func showLeaderboard() {
    // A new instance of a game center view controller:
    let gameCenter = GKGameCenterViewController()
    // Set this scene as the delegate (helps enable the // done button in the game center)
    gameCenter.gameCenterDelegate = self
    // Show the leaderboards when the game center opens:
    gameCenter.viewState = 
        GKGameCenterViewControllerState.Leaderboards
    // Find the current view controller:
    if let gameViewController = 
        self.view?.window?.rootViewController {
        // Display the new Game Center view controller:
        gameViewController.showViewController(gameCenter, sender: self)
        gameViewController.navigationController?
           .pushViewController(gameCenter, animated: true)
    }
}</pre></div></li><li class="listitem">We need <a id="id355" class="indexterm"/>to add another function to adhere to the <code class="literal">GKGameCenterControllerDelegate</code> protocol. This function is named <code class="literal">gameCenterViewDidFinish</code>, and the Game Center will invoke it when the player clicks the <strong>Done</strong> button in Game Center. Add the function to the <code class="literal">MenuScene</code> class, as shown here:<div><pre class="programlisting">// This hides the game center when the user taps 'done'
func gameCenterViewControllerDidFinish (gameCenterViewController: 
        GKGameCenterViewController!) {
    gameCenterViewController.dismissViewControllerAnimated( true, completion: nil)
}</pre></div></li><li class="listitem">To wrap up the <code class="literal">MenuScene</code> code, we need to check for taps on our leaderboard button in the <code class="literal">touchesBegan</code> function to invoke <code class="literal">showLeaderboard</code>. Update the <code class="literal">touchesBegan</code> function <code class="literal">if</code> block as shown in the following (new code in bold):<div><pre class="programlisting">if nodeTouched.name == "StartBtn" { 
    self.view?.presentScene(GameScene(size: self.size))
}
<strong>else if nodeTouched.name == "LeaderboardBtn" {</strong>
<strong>    showLeaderboard()</strong>
<strong>}</strong>
</pre></div></li><li class="listitem">Next, open <code class="literal">GameViewController.swift</code> and locate the <code class="literal">authenticateLocalPlayer</code> function.</li><li class="listitem">Update the block where the player authenticated successfully to call our new <code class="literal">createLeaderboardButton</code> function in the <code class="literal">MenuScene</code> class. This creates the leaderboard button for newly authenticated people as they start the app. The code is shown here (new code in bold):<div><pre class="programlisting">else if localPlayer.authenticated {
    // They authenticated successfully
<strong>    menuScene.createLeaderboardButton()</strong>
}</pre></div></li></ol></div><p>Good work. Run<a id="id356" class="indexterm"/> the project and you should see a leaderboard button appear in the menu after Game Center authenticates, as shown here:</p><div><img src="img/Image_B04532_10_15.jpg" alt="Opening Game Center in our game"/></div><p>Terrific – if you tap on the <strong>Leaderboard</strong> text, Game Center will open within the game. Now your players will be able to view leaderboards and achievements directly from your game. Next, we will create a leaderboard and an achievement in iTunes Connect to populate Game Center.</p></div>
<div><div><div><div><h1 class="title"><a id="ch10lvl1sec79"/>Checkpoint 10-A</h1></div></div></div><p>To download my project to this point, visit this URL:</p><p>
<a class="ulink" href="http://www.thinkingswiftly.com/game-development-with-swift/chapter-10">http://www.thinkingswiftly.com/game-development-with-swift/chapter-10</a>
</p></div>
<div><div><div><div><h1 class="title"><a id="ch10lvl1sec80"/>Adding a leaderboard of high scores</h1></div></div></div><p>We will submit the <a id="id357" class="indexterm"/>player's scores to the Game Center servers every time they finish a game. The first step is to register a new leaderboard on iTunes Connect.</p><div><div><div><div><h2 class="title"><a id="ch10lvl2sec98"/>Creating a new leaderboard in iTunes Connect</h2></div></div></div><p>First, we <a id="id358" class="indexterm"/>will create our leaderboard in iTunes Connect. We can then connect to this leaderboard from our code and send new scores. Follow these steps to create the leaderboard record in iTunes Connect:</p><div><ol class="orderedlist arabic"><li class="listitem">Log <a id="id359" class="indexterm"/>back in to iTunes Connect and navigate into the Game Center page for your app.</li><li class="listitem">Locate and click the button that says <strong>Add Leaderboard</strong>.</li><li class="listitem">The next page asks you what type of leaderboard you want to create. Choose <strong>Single Leaderboard</strong>.</li><li class="listitem">Fill out the information for your leaderboard. You can reference my example here:<div><img src="img/Image_B04532_10_09.jpg" alt="Creating a new leaderboard in iTunes Connect"/></div><p>Let's take a look at each field:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Reference Name</strong> is an internal use name for leaderboard listings in iTunes Connect</li><li class="listitem" style="list-style-type: disc"><strong>Leaderboard ID</strong> is a unique identifier we will reference from our code</li><li class="listitem" style="list-style-type: disc"><strong>Score Format Type</strong> describes the type of data you will be passing in (most commonly integer data for high scores)</li><li class="listitem" style="list-style-type: disc">Normal leaderboards use a <strong>Score Submission Type</strong> of <strong>Best Score</strong>, with a <strong>Sort Order</strong> of <strong>High to Low</strong></li><li class="listitem" style="list-style-type: disc"><strong>Score Range</strong> is an anti-cheating measure you can use to block obviously false scores from showing up on the leaderboard</li></ul></div></li><li class="listitem">Next, click the <strong>Add Language</strong> button. You will choose a name and score formatting for your leaderboard on this screen. These fields are largely self-explanatory, but you can reference my example here:<div><img src="img/Image_B04532_10_10.jpg" alt="Creating a new leaderboard in iTunes Connect"/></div></li><li class="listitem">Click <strong>Save</strong> twice (once for the language dialogue and once on the leaderboard screen).</li></ol></div><p>You should be <a id="id360" class="indexterm"/>back on the Game Center page with your new leaderboard listed in the leaderboards section. Next, we will push new scores into the leaderboard from our game code.</p></div><div><div><div><div><h2 class="title"><a id="ch10lvl2sec99"/>Updating the leaderboard from the code</h2></div></div></div><p>It is simple to <a id="id361" class="indexterm"/>send a new score to the leaderboard from the code. Follow these steps to send the number of coins collected to the leaderboard every time a game ends:</p><div><ol class="orderedlist arabic"><li class="listitem">In Xcode, open <code class="literal">GameScene.swift</code>.</li><li class="listitem">Add an <code class="literal">import</code> statement at the top so we can use the <code class="literal">GameKit</code> framework in this file:<div><pre class="programlisting">import GameKit</pre></div></li><li class="listitem">Add a new function in the <code class="literal">GameScene</code> class named <code class="literal">updateLeaderboard</code>, as shown here:<div><pre class="programlisting">func updateLeaderboard() {
    if GKLocalPlayer.localPlayer().authenticated {
        // Create a new score object, with our leaderboard: 
        let score = GKScore(leaderboardIdentifier: 
            "pierre_penguin_coins")
        // Set the score value to our coin score:
        score.value = Int64(self.coinsCollected)
        // Report the score (wrap the score in an array)
        GKScore.reportScores([score], withCompletionHandler: 
            {(error : NSError!) -&gt; Void in
            // The error handler was used more in previous 
            // versions of iOS, it would be unusual to // receive an error now:
                if error != nil {
                    println(error)
                }
        })
    }
}</pre></div></li><li class="listitem">In the <code class="literal">GameScene</code> class <code class="literal">GameOver</code> function, call the new <code class="literal">updateLeaderboard</code> function:<div><pre class="programlisting">// Push their score to the leaderboard:
updateLeaderboard()</pre></div></li></ol></div><p>Run the project <a id="id362" class="indexterm"/>and play through a game to send a test coin score to the leaderboard. Then, tap back to the menu scene and click the <strong>Leaderboard</strong> button to open Game Center within your game. You should see your first score appear in the leaderboard! It will look something like this:</p><div><img src="img/Image_B04532_10_16.jpg" alt="Updating the leaderboard from the code"/></div><p>Great work – you have implemented your first Game Center leaderboard. Next, we will follow a similar series of steps to create an achievement for collecting 500 coins in one game.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch10lvl1sec81"/>Adding an achievement</h1></div></div></div><p>Achievements <a id="id363" class="indexterm"/>add a second layer of fun to your game and create replay value. To <a id="id364" class="indexterm"/>demonstrate a Game Center achievement, we will add a reward for collecting 500 coins without dying.</p><div><div><div><div><h2 class="title"><a id="ch10lvl2sec100"/>Creating a new achievement in iTunes Connect</h2></div></div></div><p>Just like the<a id="id365" class="indexterm"/> leaderboard, we first need to create an iTunes Connect record for our achievement. Follow these steps to create the record:</p><div><ol class="orderedlist arabic"><li class="listitem">Log into iTunes Connect and navigate to the Game Center page for your app.</li><li class="listitem">Underneath the leaderboards list, locate and click the <strong>Add Achievement</strong> button.</li><li class="listitem">Fill out the information for your achievement. Here are my values:<div><img src="img/Image_B04532_10_11.jpg" alt="Creating a new achievement in iTunes Connect"/></div><p>Let’s take a look at each field:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Reference Name</strong> is the name iTunes Connect will use internally to refer to the achievement</li><li class="listitem" style="list-style-type: disc"><strong>Achievement ID</strong> is the unique identifier we will use to reference this achievement in our code</li><li class="listitem" style="list-style-type: disc">You can assign a <strong>Point Value</strong> to each achievement so players can earn more achievement points as they collect new achievements</li><li class="listitem" style="list-style-type: disc"><strong>Hidden</strong> and <strong>Achievable More Than Once</strong> are self-explanatory, but you can use the question mark buttons on the right for additional information from Apple</li></ul></div></li><li class="listitem">Click the <strong>Add Language</strong> button. We will name the achievement and give it a description, as in the leaderboard process. Additionally, an image is required for <a id="id366" class="indexterm"/>achievements. The image dimensions can be 512x512 or 1024x1024. You can find the one I used in our <strong>Assets</strong> bundle download, in the <code class="literal">Extras</code> folder, <code class="literal">gold-medal.png</code>. Here are my values:<div><img src="img/Image_B04532_10_12.jpg" alt="Creating a new achievement in iTunes Connect"/></div></li><li class="listitem">Click <strong>Save</strong> twice (once for the language dialogue and once on the achievement screen).</li></ol></div><p>Terrific, you should be back on the main iTunes Connect Game Center page for your app with your new achievement listed in the <strong>Achievements</strong> section. Next, we will integrate this achievement into the game.</p></div><div><div><div><div><h2 class="title"><a id="ch10lvl2sec101"/>Updating achievements from the code</h2></div></div></div><p>Much like <a id="id367" class="indexterm"/>sending leaderboard updates, we can send achievement updates to Game Center from <code class="literal">GameScene</code>. Follow these steps to integrate our 500 coin achievement:</p><div><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">GameScene.swift</code> in Xcode.</li><li class="listitem">If you skipped over the leaderboard section, you will need to add a new <code class="literal">import</code> statement at the top of the file so we can use <code class="literal">GameKit</code>. If you have already implemented the leaderboard, you can skip this:<div><pre class="programlisting">import GameKit</pre></div></li><li class="listitem">Add a <a id="id368" class="indexterm"/>new function to the <code class="literal">GameScene</code> class named <code class="literal">checkForAchievements</code>, as shown here:<div><pre class="programlisting">func checkForAchievements() {
    if GKLocalPlayer.localPlayer().authenticated {
        // Check if they earned 500 coins in this game:
        if self.coinsCollected &gt;= 500 {
            let achieve = GKAchievement(identifier: "500_coins")
            // Show a notification that they earned it:
            achieve.showsCompletionBanner = true
            achieve.percentComplete = 100
            // Report the achievement! GKAchievement.reportAchievements([achieve], withCompletionHandler: 
                    {(error:NSError!) -&gt; Void in
                        if error != nil {
                            println(error)
                        }
            })
        }
    }
}</pre></div></li><li class="listitem">At the bottom of the <code class="literal">gameOver</code> function, invoke the new <code class="literal">checkForAchievements</code> function:<div><pre class="programlisting">// Check if they earned the achievement:
checkForAchievements()</pre></div></li></ol></div><p>Run the project and, if you dare, complete a 500 coin fly through. When your game ends, you should see a banner proclaiming your new achievement conquest, as shown here:</p><div><img src="img/Image_B04532_10_17.jpg" alt="Updating achievements from the code"/></div><p>Great work! You <a id="id369" class="indexterm"/>have implemented Game Center leaderboards and achievements into your game.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch10lvl1sec82"/>Checkpoint 10-B</h1></div></div></div><p>To download my project to this point, visit this URL:</p><p>
<a class="ulink" href="http://www.thinkingswiftly.com/game-development-with-swift/chapter-10">http://www.thinkingswiftly.com/game-development-with-swift/chapter-10</a>
</p></div>
<div><div><div><div><h1 class="title"><a id="ch10lvl1sec83"/>Summary</h1></div></div></div><p>Integrating with Game Center is a great feature for your players. In this chapter, we learned how to create an iTunes Connect record for our app, authenticate Game Center users in our code, create new leaderboards and achievements on iTunes Connect, and then integrate those leaderboards and achievements within our game. We have made a lot of progress!</p><p>We are officially finished working on the game itself. In the next chapter, we will prepare our app for publication, upload the code for Apple to review, and revisit what we have learned while creating our great game. Everything is coming together and we are ready to take the final step to publish our game. Congratulations!</p></div></body></html>