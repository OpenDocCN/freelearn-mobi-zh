<html><head></head><body><div><div><div><h1 class="chapterNumber">25</h1>
    <h1 id="_idParaDest-307" class="chapterTitle">Getting Started with Swift Testing</h1>
    <p class="normal">Apple introduced <strong class="keyWord">Swift Testing</strong> during WWDC24. It is a new framework that makes it easy for you to test <a id="_idIndexMarker1046"/>your Swift code using expressive and intuitive APIs. </p>
    <p class="normal">In this chapter, you’ll create and run tests for the <code class="inlineCode">JournalEntry</code> class to make sure it works as intended.</p>
    <p class="normal">You’ll start by <a id="_idIndexMarker1047"/>adding a new <strong class="keyWord">Unit Testing</strong> target to your app. Next, you’ll write some tests for the <code class="inlineCode">JournalEntry</code> class, and finally, you’ll run the tests on your <code class="inlineCode">JournalEntry</code> class to make sure it works as it should.</p>
    <p class="normal">By the end of this chapter, you’ll have learned how to write tests for the classes in your app to make sure that they work as intended. This will be useful for larger projects involving many people, where you are not able to view the source code for all the classes in your project.</p>
    <p class="normal">The following topics will be covered:</p>
    <ul>
      <li class="bulletList">Introducing Swift Testing</li>
      <li class="bulletList">Adding a Unit Testing target to your app</li>
      <li class="bulletList">Writing tests for the <code class="inlineCode">JournalEntry</code> class</li>
      <li class="bulletList">Testing the <code class="inlineCode">JournalEntry</code> class</li>
    </ul>
    <h1 id="_idParaDest-308" class="heading-1">Technical requirements</h1>
    <p class="normal">You will continue working on the <code class="inlineCode">JRNL</code> project that you modified in <em class="chapterRef">Chapter 23</em>, <em class="italic">Getting Started with SwiftData</em>.</p>
    <p class="normal">The completed Xcode project for this chapter is in the <code class="inlineCode">Chapter25</code> folder of the code bundle for this book, which can be downloaded here:</p>
    <p class="normal"><a href="https://github.com/PacktPublishing/iOS-18-Programming-for-Beginners-Ninth-Edition%0D">https://github.com/PacktPublishing/iOS-18-Programming-for-Beginners-Ninth-Edition</a></p>
    <p class="normal">Check out the following video to see the code in action:</p>
    <p class="normal"><a href="https://youtu.be/se9ae9wrYC8%0D">https://youtu.be/se9ae9wrYC8</a></p>
    <p class="normal">Let’s start by learning about Swift Testing and how it works.</p>
    <h1 id="_idParaDest-309" class="heading-1">Introducing Swift Testing</h1>
    <p class="normal">If you are the lead developer of a large project involving many developers, it would not be practical for <a id="_idIndexMarker1048"/>you to review everyone’s source code in detail, and in some cases, you would not be able to view the source code at all. Instead, you would issue specifications on what a class is supposed to do, and it would be the developer’s job to write the class for you. </p>
    <p class="normal">As an example, let’s look at the initializer code for the <code class="inlineCode">JournalEntry</code> class in the <em class="italic">JRNL</em> app:</p>
    <pre class="programlisting code"><code class="hljs-code">init?(rating: Int, title: String, body: String, photo: UIImage? = nil, latitude: Double? = nil, longitude: Double? = nil) {
  if title.isEmpty || body.isEmpty || rating &lt; 0 ||    rating &gt; 5 {
    return nil
  }
  self.date = Date()
  self.rating = rating
  self.title = title
  self.body = body
  self.photoData = photo?.jpegData(compressionQuality: 1.0)
  self.latitude = latitude
  self.longitude = longitude
}
</code></pre>
    <p class="normal">As you can see, you can only create valid <code class="inlineCode">JournalEntry</code> instances if <code class="inlineCode">entryTitle</code> and <code class="inlineCode">entryBody</code> are not empty and <code class="inlineCode">rating</code> is between 0 and 5 inclusive. If these requirements are not met, the initializer will return <code class="inlineCode">nil</code>.</p>
    <p class="normal">Assume that you’re not able to view the source code for the <code class="inlineCode">JournalEntry</code> class. How would you know that this class works as intended? This is where Swift Testing comes in.</p>
    <p class="normal">Swift Testing has <a id="_idIndexMarker1049"/>a clear and expressive API built using macros, which makes it easy to write tests to determine that your code is working properly. It works on all major platforms supported by Swift, and it is open source.</p>
    <div><p class="normal">For more <a id="_idIndexMarker1050"/>information on Swift Testing, you can watch Apple’s WWDC24 video on it here: <a href="https://developer.apple.com/videos/play/wwdc2024/10179/">https://developer.apple.com/videos/play/wwdc2024/10179/</a>.</p>
    </div>
    <p class="normal">In the next section, you’ll see how to add a Unit Testing target to your project.</p>
    <h1 id="_idParaDest-310" class="heading-1">Adding a Unit Testing target to your app</h1>
    <p class="normal">In order to <a id="_idIndexMarker1051"/>be able to test the <code class="inlineCode">JournalEntry</code> class, you’ll add a Unit Testing target to your app. You will be able to write all the tests for classes in your app here. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">In Xcode, choose <strong class="screenText">File</strong> | <strong class="screenText">New</strong> | <strong class="screenText">Target</strong> to open the template selector.</li>
      <li class="numberedList"><strong class="screenText">iOS</strong> should already be selected. In the <strong class="screenText">Test</strong> section, click <strong class="screenText">Unit Testing Bundle</strong> and click <strong class="screenText">Next</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B31371_25_01.png" alt="" width="812" height="578"/></figure>
    <p class="packt_figref">Figure 25.1: Template chooser window</p>
    <ol>
      <li class="numberedList" value="3">In <a id="_idIndexMarker1052"/>the <strong class="screenText">Choose options for your new target:</strong> window, leave all the options at their default values and click <strong class="screenText">Finish</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B31371_25_02.png" alt="" width="752" height="474"/></figure>
    <p class="packt_figref">Figure 25.2: Options window</p>
    <ol>
      <li class="numberedList" value="4">Verify <a id="_idIndexMarker1053"/>that the <strong class="screenText">JRNLTests</strong> folder is visible in the Project navigator:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B31371_25_03.png" alt="" width="318" height="426"/></figure>
    <p class="packt_figref">Figure 25.3: Project navigator showing JRNLTests folder</p>
    <p class="normal">You have <a id="_idIndexMarker1054"/>successfully added the Unit Testing target to your app! In the next section, you’ll write some tests to ensure that the <code class="inlineCode">JournalEntry</code> class works as it should.</p>
    <h1 id="_idParaDest-311" class="heading-1">Writing tests for the JournalEntry class</h1>
    <p class="normal">As you have seen, the initializer for the <code class="inlineCode">JournalEntry</code> class will only return a <code class="inlineCode">JournalEntry</code> instance if <code class="inlineCode">title</code> and <code class="inlineCode">body</code> are not empty, and <code class="inlineCode">rating</code> is between 0 and 5 inclusive. If these <a id="_idIndexMarker1055"/>conditions are not met, the initializer will return <code class="inlineCode">nil</code>. To test this, you will <a id="_idIndexMarker1056"/>write tests to confirm that a valid <code class="inlineCode">JournalEntry</code> instance is created when the above conditions are met, and <code class="inlineCode">nil</code> is returned when they are not. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">Click the <strong class="screenText">JRNLTests</strong> file inside the <strong class="screenText">JRNLTests</strong> folder in the Project navigator.</li>
      <li class="numberedList">Modify the contents of this file as follows:
        <pre class="programlisting code-one"><code class="hljs-code">import Testing
<strong class="hljs-keyword-slc">@testable</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> JRNL</strong>
 
struct JRNLTests {
 
 <strong class="hljs-slc"> </strong><strong class="hljs-meta-slc">@Test</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">func</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">JournalEntryInitializationSucceeds</strong><strong class="hljs-slc">()</strong> {
    let zeroRatingJournalEntry = JournalEntry(rating: 0,    title: "Zero", body: "Zero rating entry")
    #expect(zeroRatingJournalEntry != nil)
        
    let positiveRatingJournalEntry = JournalEntry(    rating: 5, title: "Highest", body:     "Highest rating entry")
    #expect(positiveRatingJournalEntry != nil)
  }
    
  @Test func JournalEntryInitializationFails() {
    let entryTitleEmptyJournalEntry = JournalEntry(    rating: 3, title: "", body: "No title")
    #expect(entryTitleEmptyJournalEntry == nil)
        
    let entryBodyEmptyJournalEntry = JournalEntry(    rating: 3, title: "No body", body: "")
    #expect(entryBodyEmptyJournalEntry == nil)
        
    let negativeRatingJournalEntry = JournalEntry(    rating: -1, title: "Negative", body:     "Negative rating entry")
    #expect(negativeRatingJournalEntry == nil)
        
    let invalidRatingJournalEntry = JournalEntry(    rating: 6, title: "Invalid", body: 
    "Invalid rating entry")
    #expect(invalidRatingJournalEntry == nil)
  }
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">Let’s break this down:</p>
    <pre class="programlisting code-one"><code class="hljs-code">import Testing
</code></pre>
    <p class="normal-one">This <a id="_idIndexMarker1057"/>imports the Swift Testing framework.</p>
    <pre class="programlisting code-one"><code class="hljs-code">@testable import JRNL
</code></pre>
    <p class="normal-one">This <a id="_idIndexMarker1058"/>makes all the code inside the <code class="inlineCode">JRNL</code> project available for testing.</p>
    <pre class="programlisting code-one"><code class="hljs-code">  @Test func JournalEntryInitializationSucceeds() {
    let zeroRatingJournalEntry = JournalEntry(rating: 0,    title: "Zero", body: "Zero rating entry")
    #expect(zeroRatingJournalEntry != nil)
        
    let positiveRatingJournalEntry = JournalEntry(    rating: 5, title: "Highest", body:     "Highest rating entry")
    #expect(positiveRatingJournalEntry != nil)
  }
</code></pre>
    <p class="normal-one">This function is used to confirm that valid instances of the <code class="inlineCode">JournalEntry</code> class are created when <code class="inlineCode">entryTitle</code> has a value, <code class="inlineCode">entryBody</code> has a value, and <code class="inlineCode">rating</code> is between 0 and 5 inclusive. The <code class="inlineCode">#expect</code> macro checks that both <code class="inlineCode">zeroRatingJournalEntry</code> and <code class="inlineCode">positiveRatingJournalEntry </code>are not <code class="inlineCode">nil</code>, therefore confirming that a valid <code class="inlineCode">JournalEntry</code> instance has been created. </p>
    <pre class="programlisting code-one"><code class="hljs-code">  @Test func JournalEntryInitializationFails() {
    let entryTitleEmptyJournalEntry = JournalEntry(    rating: 3, title: "", body: "No title")
    #expect(entryTitleEmptyJournalEntry == nil)
        
    let entryBodyEmptyJournalEntry = JournalEntry(    rating: 3, title: "No body", body: "")
    #expect(entryBodyEmptyJournalEntry == nil)
        
    let negativeRatingJournalEntry = JournalEntry(    rating: -1, title: "Negative", body:     "Negative rating entry")
    #expect(negativeRatingJournalEntry == nil)
        
    let invalidRatingJournalEntry = JournalEntry(
    rating: 6, title: "Invalid", body:
    "Invalid rating entry")
    #expect(invalidRatingJournalEntry == nil)
  }
</code></pre>
    <p class="normal-one">This <a id="_idIndexMarker1059"/>function is used to confirm that <code class="inlineCode">nil</code> will be <a id="_idIndexMarker1060"/>returned when <code class="inlineCode">entryTitle</code> is empty, <code class="inlineCode">entryBody</code> is empty, and <code class="inlineCode">rating</code> is not between 0 and 5 inclusive. The <code class="inlineCode">#expect</code> macro will determine if <code class="inlineCode">entryTitleEmptyJournalEntry</code>, <code class="inlineCode">entryBodyEmptyJournalEntry</code>, <code class="inlineCode">negativeRatingJournalEntry</code>, and <code class="inlineCode">invalidRatingJournalEntry</code> are all <code class="inlineCode">nil</code>, therefore confirming that a <code class="inlineCode">JournalEntry</code> instance has not been created.</p>
    <div><p class="normal">Since this is a brief introduction to Swift Testing, multiple conditions are checked in a single function, but for clarity, professional programmers typically use one function to perform one test.</p>
    </div>
    <p class="normal">You’ve completed writing all the tests for the <code class="inlineCode">JournalEntry</code> class. In the next section, you’ll run the tests to confirm that the <code class="inlineCode">JournalEntry</code> class works as it should.</p>
    <h1 id="_idParaDest-312" class="heading-1">Testing the JournalEntry class</h1>
    <p class="normal">Since you have completed writing all the tests for the <code class="inlineCode">JournalEntry</code> class in the previous section, you will <a id="_idIndexMarker1061"/>now run the test to see if the <code class="inlineCode">JournalEntry</code> class works as expected. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">In Xcode, choose <strong class="screenText">Test</strong> from the <strong class="screenText">Product</strong> menu.</li>
      <li class="numberedList">Xcode will automatically run all your tests. Upon completion, you will see the following results:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B31371_25_04.png" alt="" width="812" height="369"/></figure>
    <p class="packt_figref">Figure 25.4: Canvas showing widget preview</p>
    <p class="normal">The green <a id="_idIndexMarker1062"/>squares with tick marks show that all the tests have been completed successfully and the <code class="inlineCode">JournalEntry</code> class works as expected. Great job! </p>
    <h1 id="_idParaDest-313" class="heading-1">Summary</h1>
    <p class="normal">In this chapter, you tested the JournalEntry class to determine if it works as expected.</p>
    <p class="normal">First, you added a new <strong class="keyWord">Unit Testing</strong> target to your app. Next, you wrote some tests for the <code class="inlineCode">JournalEntry</code> class, and finally, you ran tests on your <code class="inlineCode">JournalEntry</code> class to make sure it works as it should.</p>
    <p class="normal">You have now learned how to write tests for the classes in your app to make sure that they work as intended. This will be useful for larger projects involving many people, where you are not able to view the source code for all the classes in your project, and also ensure that changes made anywhere in the app do not break existing functionality.</p>
    <p class="normal">In the next chapter, you’ll learn about <strong class="keyWord">Apple Intelligence</strong>, Apple’s implementation of AI technology introduced during WWDC24.</p>
    <h1 id="_idParaDest-314" class="heading-1">Join us on Discord!</h1>
    <p class="normal">Read this book alongside other users, experts, and the author himself. Ask questions, provide solutions to other readers, chat with the author via Ask Me Anything sessions, and much more. Scan the QR code or visit the link to join the community.</p>
    <p class="normal"><a href="https://packt.link/ios-Swift%0D">https://packt.link/ios-Swift</a></p>
    <p class="normal"><a href="https://packt.link/ios-Swift%0D"><img src="img/QR_Code2370024260177612484.png" alt="" width="177" height="177"/></a></p>
  </div>
</div></div></body></html>