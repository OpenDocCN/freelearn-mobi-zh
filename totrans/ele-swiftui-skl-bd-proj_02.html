<html><head></head><body>
<div><h1 class="chapter-number" id="_idParaDest-40"><a id="_idTextAnchor246"/>2</h1>
<h1 id="_idParaDest-41"><a id="_idTextAnchor247"/>iPhone Project – Tax Calculator Design</h1>
<p>In the previous chapter, we did a recap of Swift and SwiftUI. We looked at the requirements, the coding standards used, and the basics of SwiftUI components. We will use these in the following chapters.</p>
<p>In this chapter, we will work on the design of our first project, a tax calculator. We will assess the requirements for designing such an application and discuss the design specifications, allowing us to get a better understanding of what is required and how it will all fit together. Then, we will start our application’s coding process to build out the UI, which will be connected together allowing the application to fully function in the next chapter. This project will teach us the foundations of SwiftUI components and how to interact with external code bases. We will discuss all of this in the following sections:</p>
<ul>
<li>Technical Requirements</li>
<li>Understanding the Design Specifications</li>
<li>Building the Calculator UI</li>
</ul>
<p><a id="_idTextAnchor248"/>By the end of this chapter, you will have a better understanding of what is required and the design of our application. You will also have a skeleton UI that will be used as the foundation for making the calculator work in the next chapter.</p>
<p>In the next section, we will provide clarity on the specifications of our application’s design and look at mockups of what the app will look like.</p>
<h1 id="_idParaDest-42"><a id="_idTextAnchor249"/>Technical requirements</h1>
<p>This chapter requires you to download Xcode version 14 or above from Apple’s App Store.</p>
<p>To install Xcode, just search for <code>Xcode</code> in the App Store, then select and download the latest version. Open Xcode and follow any additional installation instructions. Once Xcode has opened and launched, you’re ready to go.</p>
<p>Version 14 of Xcode has the following features/requirements:</p>
<ul>
<li>Includes SDKs for iOS 16, iPadOS 16, macOS 12.3, tvOS 16, and watchOS 9.</li>
<li>Supports on-device debugging in iOS 11 or later, tvOS 11 or later, and watchOS 4 or later.</li>
<li>Requires a Mac running macOS Monterey 12.5 or later.</li>
</ul>
<p>Download the sample code from the following GitHub link:</p>
<p><a href="https://github.com/PacktPublishing/Elevate-SwiftUI-Skills-by-Building-Projects">https://github.com/PacktPublishing/Elevate-SwiftUI-Skills-by-Building-Projects</a></p>
<p>In the next section, we will provide clarity on the specifications of our application’s design and look at mockups of what the app will look like.</p>
<h1 id="_idParaDest-43"><a id="_idTextAnchor250"/>Understanding the Design Specifications</h1>
<p><a id="_idTextAnchor251"/>In this section, we will look at the design specifications<a id="_idIndexMarker086"/> of our tax calculator application. This section describes the features we are going to <a id="_idIndexMarker087"/>implement in our tax calculator app. The best method for figuring out the features required is to put yourself in the user’s shoes to determine how they will use the app and break it into individual steps.</p>
<p>The features<a id="_idIndexMarker088"/> of our app are as follows:</p>
<ul>
<li>Income entry – the ability to enter an income.</li>
<li>Salary summary – a summary of how much is going to be taxed and how much is left as income.</li>
<li>Tax breakdown – a breakdown of how much tax is paid on a given salary, that is, tax brackets.</li>
<li>Different taxes – the ability to calculate a breakdown for different types of taxes, such as income, property flipping, inheritance, and stamp duty.</li>
<li>Tax geography – the ability to calculate a breakdown for taxes in different geographies, including countries and states.</li>
<li>Combination of the previous two – the ability to calculate a breakdown for different taxes in different geographies.</li>
<li>User system – allows users to create an account to store tax calculations, see how the tax has<a id="_idIndexMarker089"/> changed over time relative to new tax laws, and so on.</li>
</ul>
<p>Now that we have listed the ideal features we would like, next, it is important for us to determine which features are absolutely crucial. To do this, we must understand the end use of our product. For me, the purpose of creating this tax calculator is not to release it and have it serve millions of people but to be a personal project for our use. It is to demonstrate a basic implementation of SwiftUI within the context of this book. Based on that, I know that all the features are not required; actually, it would be useful if some were omitted and assigned as extra tasks for you as the developer to undertake. Based on all of this, the following are the core features we will be implementing:</p>
<ul>
<li>Income entry</li>
<li>Salary summary</li>
<li>Tax breakdown</li>
</ul>
<p>The rest of the features will be left for you to implement as an exercise once you have completed this and the next chapter. The next section will cover the acceptance criteria for our applicat<a id="_idTextAnchor252"/>ion.</p>
<h2 id="_idParaDest-44"><a id="_idTextAnchor253"/>Acceptance criteria</h2>
<p>We will discuss the mandatory<a id="_idIndexMarker090"/> requirements for our application that we absolutely want to see in the end product at the end of the next chapter. If possible, we should try to make them measurable. Let’s do this right now:</p>
<ul>
<li>Error detection:<ul><li><strong class="bold">Not a Number</strong> (<strong class="bold">NaN</strong>) values</li><li>Values that are equal to or less than 0</li></ul></li>
<li>Provides the before- and after-tax salaries</li>
<li>A pie chart to illustrate the breakdown visually</li>
<li>Progress bars to further expand upon the breakdown</li>
<li>Navigation to allow users to switch between the pages effortle<a id="_idTextAnchor254"/>ssly</li>
</ul>
<p>Develop test cases<a id="_idIndexMarker091"/> in which the application’s acceptance criteria will be tested. Using this method allows you to see the conditions in which the application will be used by the end user and the level of functionality that needs to be attained for it to be considered succes<a id="_idTextAnchor255"/>sful.</p>
<h3>Wireframe</h3>
<p>One of the most useful tools for<a id="_idIndexMarker092"/> designing layouts is wireframing. A wireframe <a id="_idIndexMarker093"/>is an overview of how the layout will look. The following figure shows what the front page of our app would look like using a wireframe:</p>
<p class="IMG---Figure"/>
<div><div><img alt="Figure 2.1 – Front page wireframe preview" src="img/Figure_2.01_B18783.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.1 – Front page wireframe preview</p>
<p>The <a id="_idIndexMarker094"/>following figure shows the wireframe of what our results page would look like:</p>
<div><div><img alt="Figure 2.2 – Results page wireframe preview" src="img/Figure_2.02_B18783.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.2 – Results page wireframe preview</p>
<p>In the next section, we will build the interface for our application and make sure it looks the way we designed it in the wireframes. Though we will build it the same way, there can be small differences. This will serve as the foundation for connecting it all together in the next cha<a id="_idTextAnchor256"/>pter.</p>
<h2 id="_idParaDest-45">Building the calcula<a id="_idTextAnchor257"/>tor UI</h2>
<p>We will now build the<a id="_idIndexMarker095"/> UI for the calculator app. There are two main parts to the calculator, the first being the front page, which is loaded on launch. Once the user inputs an income and hits <strong class="bold">Calculate Tax</strong>, they are taken to the results page, which is the second part. On this page, the results of the tax calculation and a breakdown of it will be displayed. Naturally, we will start off with the first part, the front page, but before even that, we will create our project. Follow these steps:</p>
<ol>
<li>Open Xcode and select <strong class="bold">Create a new </strong><strong class="bold">Xcode project</strong>:</li>
</ol>
<div><div><img alt="Figure 2.3 – Create a new Xcode project" src="img/Figure_2.03_B18783.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.3 – Create a new Xcode project</p>
<ol>
<li value="2">Now, we will choose the template for our application. As we are creating an iPhone application, we will select <strong class="bold">iOS</strong> from the top and then select <strong class="bold">App</strong> and click <strong class="bold">Next</strong>:</li>
</ol>
<div><div><img alt="Figure 2.4 – Xcode project template selection" src="img/Figure_2.04_B18783.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.4 – Xcode project template selection</p>
<ol>
<li value="3">We will now <a id="_idIndexMarker096"/>choose the options for our project. Here, there are only two crucial things to select/set. Make sure <strong class="bold">Interface</strong> is set to <strong class="bold">SwiftUI</strong>; this will be the UI our system will use. Set <strong class="bold">Language</strong> to <strong class="bold">Swift</strong>; this is the programming language used for our application:</li>
</ol>
<div><div><img alt="Figure 2.5 – Xcode project options" src="img/B18783_02_5.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.5 – Xcode project options</p>
<ol>
<li value="4">Once you <a id="_idIndexMarker097"/>press <strong class="bold">Next</strong>, you can choose where to create your project, as seen in the following screenshot:</li>
</ol>
<div><div><img alt="Figure 2.6 – Xcode project save directory" src="img/B18783_02_6.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.6 – Xcode project save directory</p>
<ol>
<li value="5">Once you have <a id="_idIndexMarker098"/>found the location you would like to create the project in, click on <strong class="bold">Create</strong> at the bottom right. Xcode shows your project in all its glory, as seen in the following screenshot:</li>
</ol>
<div><div><img alt="Figure 2.7 – New Xcode project overview" src="img/B18783_02_7.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.7 – New Xcode project overview</p>
<p>In the next section, we<a id="_idIndexMarker099"/> will implement the front page of our application using SwiftUI and further look at the Xcode IDE as we d<a id="_idTextAnchor258"/>o so.</p>
<h3>Front page</h3>
<p>In this section, we<a id="_idIndexMarker100"/> will implement<a id="_idIndexMarker101"/> the front page’s UI. As a reminder, here is what it will look like:</p>
<div><div><img alt="Figure 2.8 – Front page wireframe p﻿review" src="img/B18783_02_8.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.8 – Front page wireframe p<a id="_idTextAnchor259"/>review</p>
<p>There<a id="_idIndexMarker102"/> are three main elements on the front page. As a little task, see<a id="_idIndexMarker103"/> whether you can figure out what they are. Don’t worry if you don’t know the exact UI component names; we will look at these components in the following sections.</p>
<h3>Text</h3>
<p>A Text component<a id="_idIndexMarker104"/> is one of the simplest <a id="_idIndexMarker105"/>components offered by SwiftUI. It allows you to display a string of characters/numbers, which is very useful for headings and providing information. We will use it to provide context to the next component, which is <code>TextField</code>. Without the Text component, the user doesn’t know the purpose of the <code>TextField</code>. The following figure shows the label on the front page, telling the user what the following text input field is used for:</p>
<div><div><img alt="Figure 2.9 – Front ﻿page label" src="img/Figure_2.09_B18783.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.9 – Front <a id="_idTextAnchor260"/>page label</p>
<h3>TextField</h3>
<p>TextFields allow<a id="_idIndexMarker106"/> the <a id="_idIndexMarker107"/>user to input text that can consist of numbers and any character. Our TextField will be used to input a number, hence it will only accept numbers. This is a feature we will configure. Some applications put background text in the text field providing context to the purpose of the <code>TextField</code>; however, we have opted for a label component to provide context and do not require this. The following figure shows the <code>TextField</code> that the user can use to input their salary:</p>
<div><div><img alt="Figure 2.10 – Front pag﻿e TextField" src="img/Figure_2.10_B18783.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.10 – Front pag<a id="_idTextAnchor261"/>e TextField</p>
<h3>Button</h3>
<p>Buttons<a id="_idIndexMarker108"/> are used when<a id="_idIndexMarker109"/> you want the user to explicitly trigger some functionality. In our case, we want the user to press the button when they are ready to calculate their tax calculation. Naturally, we as developers must error-check this to check whether the button can be pressed when the <code>TextField</code> is empty or if the wrong type of data has been inputted in the <code>TextField</code>. We will handle that with an error message instead of displaying the tax calculation. If you take a look at the following screenshot, you will see what this button looks like:</p>
<div><div><img alt="Figure 2.11 – Front page button" src="img/Figure_2.11_B18783.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.11 – Front page button</p>
<p>In the next section, we will add the elements we discussed previously using SwiftUI into our <a id="_idTextAnchor262"/>application.</p>
<h3>Adding Front Page Components</h3>
<p>In this section, we will add the <a id="_idIndexMarker110"/>components we <a id="_idIndexMarker111"/>listed previously to create our front page. Look for the <code>ContentView</code> file, which can be found in the <strong class="bold">Project navigator</strong>, usually on the left, as shown in the following screenshot:</p>
<div><div><img alt="Figure 2.12 – Project navigator" src="img/B18783_02_12.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.12 – Project navigator</p>
<p>See the following code and add it to the <code>ContentView</code> file:</p>
<pre class="source-code">
import SwiftUIstruct ContentView: View
{
    @State private var salary: String = ""
    var body: some View
    {
        VStack
        {
            Text( "Annual Salary" )
            TextField( "Salary", text: $salary )
            Button
            { }
            label:
            { Text("Calculate Tax") }
        }
        .padding( )
    }
}
struct ContentView_Previews: PreviewProvider
{
    static var previews: some View
    {
        ContentView( )
    }
}</pre>
<p>Using the<a id="_idIndexMarker112"/> preceding code, we are able to <a id="_idIndexMarker113"/>render a <code>Text</code>, <code>TextField</code>, and <code>Button</code>. This will form the basis of allowing the user to enter their salary and click the button to calculate the tax breakdown. We use a variable called <code>salary</code> to store TextField’s data. Let’s take a look at the end result:</p>
<div><div><img alt="Figure 2.13 – Elements without styling preview" src="img/B18783_02_13.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.13 – Elements without styling preview</p>
<p>As you can see, the <a id="_idIndexMarker114"/><code>Text</code> component looks pretty<a id="_idIndexMarker115"/> good, but the <code>TextField</code> has no obvious boundaries. I put a placeholder inside it as without it, the user wouldn’t even know where the <code>TextField</code> is. Next, the <code>Button</code> has the wrong styling. Let’s fix both of these with the following updated code:</p>
<pre class="source-code">
VStack{
    Text( "Annual Salary" )
    TextField( "", text: $salary )
        .border( Color.black, width: 1 )
    Button
    { }
    label:
    { Text("Calculate Tax") }
        .buttonStyle( .borderedProminent )
}
.padding( )</pre>
<p>Using the preceding <a id="_idIndexMarker116"/>code, we added a black border with <a id="_idIndexMarker117"/>a width of <code>1</code> to the <code>TextField</code> and removed the placeholder text. Next, we added a button style to the <code>Text</code> component of the button. We used the <code>borderedProminent</code> style, which is exactly what we need. All these changes result in the following:</p>
<div><div><img alt="Figure 2.14 – Updated code preview" src="img/B18783_02_14.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.14 – Updated code preview</p>
<p>The <a id="_idIndexMarker118"/>preview shows we are very close. For the<a id="_idIndexMarker119"/> type of data we are inserting into <code>TextField</code>, it doesn’t need to be this wide. Let’s make it smaller. Modify <code>TextField</code> as follows:</p>
<pre class="source-code">
TextField( "", text: $salary )                .frame( width: 200.0 )
                .border( Color.black, width: 1 )</pre>
<p>We have added a width of <code>200</code> to make the <code>TextField</code> look better suited for what we need. Thus far, we have changed the properties of our app’s components programmatically. However, you can use the Xcode UI to tweak the properties as well. Doing this is simple: select a component in the code by hovering the mouse cursor over it and clicking <a id="_idIndexMarker120"/>the code as if you are going to edit it. Now, on the right, a pane including the <strong class="bold">Attributes Inspector</strong> will appear.</p>
<div><div><img alt="Figure 2.15 – Attributes Inspector" src="img/B18783_02_15.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.15 – Attributes Inspector</p>
<p>If the <strong class="bold">Attributes Inspector</strong> pane<a id="_idIndexMarker121"/> doesn’t <a id="_idIndexMarker122"/>appear, go to <strong class="bold">View</strong> | <strong class="bold">Inspectors</strong> | <strong class="bold">Attributes</strong>.</p>
<div><div><img alt="Figure 2.16 – Opening Attributes Inspector manually" src="img/B18783_02_16.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.16 – Opening Attributes Inspector manually</p>
<p>We are <a id="_idIndexMarker123"/>almost done; we only have three UI<a id="_idIndexMarker124"/> components. The interface is currently quite compact. Let’s spread out the components to make it look nicer. Add the following code to space out the components:</p>
<pre class="source-code">
VStack{
    Text( "Annual Salary" )
        .padding(.bottom, 75.0)
    TextField( "", text: $salary )
        .frame( width: 200.0 )
        .border( Color.black, width: 1 )
        .padding( .bottom, 75.0 )
    Button
    { }
    label:
    { Text( "Calculate Tax" ) }
        .buttonStyle( .borderedProminent )
}
.padding( )</pre>
<p>In the preceding code, we added<a id="_idIndexMarker125"/> padding at the bottom <a id="_idIndexMarker126"/>of the <code>Text</code> and <code>TextField</code> components to evenly spread all three items out. Feel free to experiment with the padding values to get the UI to feel like what you are looking for.</p>
<p class="callout-heading">Important note</p>
<p class="callout">If you have four components and want to add padding to the top three, the formula would be <code>n - 1</code> in terms of the number of components that need padding to be evenly spread out. <code>n</code> is the total number of components.</p>
<p>Our front page now looks like the following:</p>
<div><div><img alt="Figure 2.17 – Preview with padding" src="img/B18783_02_17.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.17 – Preview with padding</p>
<p>Right now, if we<a id="_idIndexMarker127"/> launch our app and click <a id="_idIndexMarker128"/>the <code>TextField</code>, a regular keyboard appears, as shown in the following screenshot:</p>
<div><div><img alt="Figure 2.18 – Front page of the regular keyboard preview" src="img/B18783_02_18.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.18 – Front page of the regular keyboard preview</p>
<p>This is fine for a <a id="_idIndexMarker129"/>field that requires text input <a id="_idIndexMarker130"/>for names or addresses, but this field only requires a salary and therefore only needs numerical input. Let’s update our code to set the keyboard type to <code>decimalPad</code>:</p>
<pre class="source-code">
TextField( "", text: $salary )    .frame( width: 200.0 )
    .border( Color.black, width: 1 )
    .padding( .bottom, 75.0 )
    .keyboardType( .decimalPad )</pre>
<p class="callout-heading">Important note</p>
<p class="callout">There is a <code>numberPad</code> option but it doesn’t allow the input of decimal numbers, so we will go ahead and use the <code>decimalPad</code> type.</p>
<p>If you <a id="_idIndexMarker131"/>run the app now, it will show the <a id="_idIndexMarker132"/>following:</p>
<div><div><img alt="Figure 2.19 – Front page decimal pad preview" src="img/B18783_02_19.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.19 – Front page decimal pad preview</p>
<p>The keyboard type can also be changed in the <strong class="bold">Attributes Inspector</strong>. This is a great place to quickly see all the available keyboard types:</p>
<div><div><img alt="Figure 2.20 – Keyboard Type" src="img/B18783_02_20.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.20 – Keyboard Type</p>
<p class="callout-heading">Important note</p>
<p class="callout">For more information on keyboard types, check out <a href="https://developer.apple.com/documentation/swiftui/view/keyboardtype(_:)">https://developer.apple.com/documentation/swiftui/view/keyboardtype(_:)</a>.</p>
<p>If the keyboard <a id="_idIndexMarker133"/>doesn’t show in the simulator, this <a id="_idIndexMarker134"/>is due to the fact your Mac already has a keyboard and the simulator decides you don’t need it displayed. But this can be overridden. Either use the  <em class="italic"></em><em class="italic"> + K</em> keyboard shortcut to open and <em class="italic"></em><em class="italic">+ </em><em class="italic"></em><em class="italic"> + K</em> to close it, or go to <strong class="bold">I/O</strong> | <strong class="bold">Keyboard</strong> | <strong class="bold">Toggle </strong><strong class="bold">Software Keyboard</strong>:</p>
<div><div><img alt="Figure 2.21 – Toggle Software Keyboard" src="img/B18783_02_21.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.21 – Toggle Software Keyboard</p>
<p>Now the software<a id="_idIndexMarker135"/> keyboard in the simulator <a id="_idIndexMarker136"/>will appear. This should only need to be done once. We have now completed the design for the front page. Currently, there is no functionality, but this will be implemented in the following chapter. But we are not done with the design. We will now implement the<a id="_idTextAnchor263"/> design for the results page.</p>
<h3>Implementing the results page</h3>
<p>In this section, we will<a id="_idIndexMarker137"/> implement the results page’s UI. As a reminder, here is what it will look like:</p>
<div><div><img alt="Figure 2.22 – Results page wireframe preview" src="img/B18783_02_22.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.22 – Results page wireframe preview</p>
<p>There are three <a id="_idIndexMarker138"/>main sections on the results page. Each section is composed of two or more components. As a little task, see whether you can figure out what they are. Don’t worry if you don’t know the exact UI component names as we will take a look at th<a id="_idTextAnchor264"/>em in the following sections.</p>
<h3>Graph Summary Section</h3>
<p>The graph summary section<a id="_idIndexMarker139"/> comprises two main components, a Text component and a pie chart. SwiftUI doesn’t provide a pie chart, so we will use an external library. We will use the <code>ChartView</code> library created by <em class="italic">Andras Samu</em>, which can be found here: <a href="https://github.com/AppPear/ChartView">https://github.com/AppPear/ChartView</a>.</p>
<p>This section will visually showcase a simple break<a id="_idTextAnchor265"/>down of the tax calculation.</p>
<div><div><img alt="Figure ﻿2.23 – Graph summary wireframe" src="img/B18783_02_23.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure <a id="_idTextAnchor266"/>2.23 – Graph summary wireframe</p>
<h3>Text Summary Section</h3>
<p>In the text summary section, there are <a id="_idIndexMarker140"/>four text components. The first component informs the user that the following <code>Text</code> component is used to display the <strong class="bold">Before Tax</strong> salary title. The second component tells the user that the following text component is used to display the <strong class="bold">After Tax</strong> salary title. This does not include a breakdown of how the tax is split. This will come in the next section:</p>
<div><div><img alt="Figure﻿ 2.24 – Text summary wireframe" src="img/B18783_02_24.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure<a id="_idTextAnchor267"/> 2.24 – Text summary wireframe</p>
<h3>Individual breakdown section</h3>
<p>The individual breakdown section<a id="_idIndexMarker141"/> displays how the tax and salary are broken down. There are six components, three <code>Text</code> components and three <code>ProgressView</code> components. Each is paired together to make three subsections, <strong class="bold">Base Salary</strong>, <strong class="bold">Tax</strong>, and <strong class="bold">National Insurance</strong>. This design is simple but extendible. Once it is created, I give you the task of adding further breakdowns of the tax, such as student loans and pension:</p>
<div><div><img alt="Figure 2.25 – Individual breakdown wireframe" src="img/B18783_02_25.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.25 – Individual breakdown wireframe</p>
<p>In the next section, we will add the elements that make up the results page be<a id="_idTextAnchor268"/>fore wrapping up this chapter.</p>
<h3>Adding results page components</h3>
<p>In this section, we will<a id="_idIndexMarker142"/> add the previously discussed components to our results page. However, firstly we must integrate the <code>ChartView</code> framework by <em class="italic">Andras Samu</em>. Follow these steps:</p>
<ol>
<li>Go to <strong class="bold">File | </strong><strong class="bold">Add Packages…</strong>:</li>
</ol>
<div><div><img alt="Figure 2.26 – Xcode Add Packages… option" src="img/B18783_02_26.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.26 – Xcode Add Packages… option</p>
<ol>
<li value="2">Search for the <code>ChartView</code> framework using the following URL: <a href="https://github.com/AppPear/ChartView">https://github.com/AppPear/ChartView</a>.</li>
<li>Select <code>2.0.0-beta.2</code>, or whatever the latest version is for you. Then, click <strong class="bold">Add Package</strong> at the bottom right. It is grayed out in mine as I have already added it:</li>
</ol>
<div><div><img alt="Figure 2.27 – Search for the ChartView package" src="img/B18783_02_27.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.27 – Search for the ChartView package</p>
<ol>
<li value="4">Clicking on <strong class="bold">Add Package</strong> will add the package to the project successfully.</li>
<li>We will now <a id="_idIndexMarker143"/>create a new SwiftUI View for the results page. Right-click the calculator folder inside of your <strong class="bold">Project Navigator</strong> pane and select <strong class="bold">New File…</strong>:</li>
</ol>
<div><div><img alt="Figure 2.28 – New File…" src="img/B18783_02_28.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.28 – New File…</p>
<ol>
<li value="6">Next, we will <a id="_idIndexMarker144"/>select the type of file we want to add, which for us is a SwiftUI View (selecting this provides a SwiftUI template, which saves us time and effort retyping the SwiftUI file structure every time), under the <strong class="bold">User </strong><strong class="bold">Interface</strong> section:</li>
</ol>
<div><div><img alt="Figure 2.29 – SwiftUI View selection" src="img/B18783_02_29.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.29 – SwiftUI View selection</p>
<ol>
<li value="7">Finally, we<a id="_idIndexMarker145"/> must rename our <code>ResultsView</code> and press <strong class="bold">Create</strong>:</li>
</ol>
<div><div><img alt="Figure 2.30 – View naming" src="img/B18783_02_30.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.30 – View naming</p>
<ol>
<li value="8">Open the <code>ResultsView</code> file and import the <code>SwiftUICharts</code> framework by adding the following code to the top of the file:<pre class="source-code">
import SwiftUICharts</pre></li> <li>Next, we need to<a id="_idIndexMarker146"/> create the chart itself. Doing so is very simple, thanks to the <code>ChartView</code> library. First, add the data the chart will be using. For now, we will add some dummy hardcoded data for testing:<pre class="source-code">
struct ResultsView: View{    var taxBreakdown: [Double] = [5, 10, 15]    var body: some View    {    }}</pre></li> </ol>
<p>The values in the array will represent the base salary, tax, and national insurance.</p>
<ol>
<li value="10">Next, we <a id="_idIndexMarker147"/>will implement our pie chart using <code>ChartView</code>:<pre class="source-code">
struct ResultsView: View{    var taxBreakdown: [Double] = [5, 10, 15]    var body: some View    {        PieChart( )            .data( taxBreakdown )            .chartStyle( ChartStyle( backgroundColor: .white,                                     foregroundColor: ColorGradient( .blue, .purple) ) )    }}</pre></li> </ol>
<p>The preceding code will result in the following:</p>
<div><div><img alt="Figure 2.31 – Pie chart added" src="img/B18783_02_31.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.31 – Pie chart added</p>
<ol>
<li value="11">To view the <code>ResultsView</code>, you <a id="_idIndexMarker148"/>will need to use the <strong class="bold">Live Preview Window</strong>. By default, it should appear. If it doesn’t, use the following keyboard shortcut: <em class="italic">       +      + Return</em>. Now, Xcode will look like the following screenshot:<div><img alt="" role="presentation" src="img/03.jpg"/></div><div><img alt="" role="presentation" src="img/01.jpg"/></div></li>
</ol>
<div><div><img alt="Figure 2.32 – Live preview window location" src="img/B18783_02_32.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.32 – Live preview window location</p>
<ol>
<li value="12">Right now, the pie<a id="_idIndexMarker149"/> chart goes up to the edges. Let’s put the pie chart inside a VStack with padding. Edit the code as follows:<pre class="source-code">
struct ResultsView: View{    var taxBreakdown: [Double] = [5, 10, 15]    var body: some View    {        VStack        {            PieChart( )                .data( taxBreakdown )                .chartStyle( ChartStyle( backgroundColor: .white,                                         foregroundColor: ColorGradient( .blue, .purple ) ) )        }.padding( )    }}</pre></li> </ol>
<p>The changes in the <a id="_idIndexMarker150"/>preceding code will now make the chart look like the following:</p>
<div><div><img alt="Figure 2.33 – Pie chart with padding" src="img/B18783_02_33.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.33 – Pie chart with padding</p>
<ol>
<li value="13">Let’s add a<a id="_idIndexMarker151"/> <code>Text</code> component that says <code>36</code>. Add the following code to the body:<pre class="source-code">
var body: some View{    VStack    {        Text( "Summary" )            .font( .system( size: 36 ) )            .fontWeight( .bold )        PieChart( )            .data( taxBreakdown )            .chartStyle( ChartStyle( backgroundColor: .white,                                     foregroundColor: ColorGradient(.blue, .purple ) ) )    }.padding( )}</pre></li> </ol>
<p>The following output shows the new summary text above the pie chart that we added previously.</p>
<div><div><img alt="Figure 2.34 – Summary header" src="img/B18783_02_34.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.34 – Summary header</p>
<ol>
<li value="14">Below the <a id="_idIndexMarker152"/>pie chart, we will add four more text components, for <strong class="bold">Before Tax</strong> and <strong class="bold">After Tax</strong>: one for the heading of each subsection and one for the actual figure. For now, we will hardcode the values. Update the code as follows:<pre class="source-code">
var body: some View{    VStack    {        Text( "Summary" )            .font( .system( size: 36 ) )            .fontWeight( .bold )        PieChart( )            .data( taxBreakdown )            .chartStyle( ChartStyle( backgroundColor: .white,                                     foregroundColor: ColorGradient(.blue, .purple ) ) )        Text( "Before Tax" )            .font( .system( size: 32 ) )        Text( "£100,000.00" )            .font( .system( size: 32 ) )        Text( "After Tax" )            .font( .system( size: 32 ) )        Text( "£65,000.00" )            .font( .system( size: 32 ) )    }.padding( )}</pre></li> </ol>
<p>The <a id="_idIndexMarker153"/>preceding code will display the following:</p>
<div><div><img alt="Figure 2.35 – Before Tax and After Tax text" src="img/B18783_02_35.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.35 – Before Tax and After Tax text</p>
<ol>
<li value="15">Right now, the <a id="_idIndexMarker154"/>text components on the bottom of the page are crammed together. Let’s add padding to the top and bottom of each text component to spread them out. You can obviously use the <strong class="bold">Attributes Inspector</strong> to do this, but we will do it programmatically:<pre class="source-code">
Text( "Before Tax" )    .font( .system( size: 32 ) )    .padding(.vertical)Text( "£100,000.00" )    .font( .system( size: 32 ) )    .padding(.vertical)Text( "After Tax" )    .font( .system( size: 32 ) )    .padding(.vertical)Text( "£65,000.00" )    .font( .system( size: 32 ) )    .padding(.vertical)</pre></li> </ol>
<p>After adding the <a id="_idIndexMarker155"/>padding in the preceding code, we will have a results page that looks like this:</p>
<div><div><img alt="Figure 2.36 – Results after padding" src="img/B18783_02_36.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.36 – Results after padding</p>
<ol>
<li value="16">Next, we need to<a id="_idIndexMarker156"/> add the progress bars, which will represent the salary, tax, and national insurance. We will use the <code>ProgressView</code> component combined with a <code>Text</code> component to display the tax breakdown. After the previously added <code>Text</code> components, add the following code:<pre class="source-code">
Text( "Post Tax Salary" )ProgressView( "", value: 20, total: 100 )Text( "Tax" )ProgressView( "", value: 20, total: 100 )</pre></li> </ol>
<p>The preceding<a id="_idIndexMarker157"/> code adds the two <code>ProgressView</code> and <code>Text</code> component pairs, which shows the post-tax salary and tax. This will result in the following:</p>
<div><div><img alt="Figure 2.37 – Breakdown components added" src="img/B18783_02_37.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.37 – Breakdown components added</p>
<ol>
<li value="17">You have probably noticed that we only added two of the three <code>ProgressView</code> components. The reason for this is to showcase an error that occurs. So, now add the following code after the previously added code:<pre class="source-code">
Text( "National Insurance" )ProgressView( "", value: 20, total: 100 )</pre></li> </ol>
<p>This will result in the following error: <code>Group</code> component, which will make the <a id="_idIndexMarker158"/>view detect it as one.</p>
<ol>
<li value="18">We will group the three <code>ProgressView</code> and <code>Text</code> components as follows:<pre class="source-code">
Group{    Text( "Post Tax Salary" )    ProgressView( "", value: 20, total: 100 )    Text( "Tax" )    ProgressView( "", value: 20, total: 100 )    Text( "National Insurance" )    ProgressView( "", value: 20, total: 100 )}</pre></li> </ol>
<p>This will solve the annoying 10-limit error and result in the following:</p>
<div><div><img alt="Figure 2.38 – Components grouped" src="img/B18783_02_38.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.38 – Components grouped</p>
<p>Here is a look at <a id="_idIndexMarker159"/>the whole code now that we are finished with this section:</p>
<pre class="source-code">
import SwiftUIimport SwiftUICharts
struct ResultsView: View
{
    var taxBreakdown: [Double] = [5, 10, 15]
    var body: some View
    {
        VStack
        {
            Text( "Summary" )
                .font( .system( size: 36 ) )
                .fontWeight( .bold )
            PieChart( )
                .data( taxBreakdown )
                .chartStyle( ChartStyle( backgroundColor: .white,
                                         foregroundColor: ColorGradient( .blue, .purple ) ) )
            Text( "Before Tax" )
                .font( .system( size: 32 ) )
                .padding(.vertical)
            Text( "£100,000.00" )
                .font( .system( size: 32 ) )
                .padding(.vertical)
            Text( "After Tax" )
                .font( .system( size: 32 ) )
                .padding(.vertical)
            Text( "£65,000.00" )
                .font( .system( size: 32 ) )
                .padding(.vertical)
            Group
            {
                Text( "Post Tax Salary" )
                ProgressView( "", value: 20, total: 100 )
                Text( "Tax" )
                ProgressView( "", value: 20, total: 100 )
                Text( "National Insurance" )
                ProgressView( "", value: 20, total: 100 )
            }
        }.padding( )
    }
}
struct ResultsView_Previews: PreviewProvider
{
    static var previews: some View<a id="_idTextAnchor269"/>
    {
        ResultsView( )
    }
}</pre>
<p>We have covered a lot in this vast section. We started off by adding an external framework, which we saw is very easy to integrate and extremely powerful. The framework allowed us to easily implement a pie chart. This is very useful as not all basic features are provided by Apple in Swift and SwiftUI, so being able to add external code bases makes the development process less painful. After that, we implemented the pie chart, text summaries, and progress views to fu<a id="_idTextAnchor270"/>rther illustrate the tax breakdown.</p>
<h1 id="_idParaDest-46"><a id="_idTextAnchor271"/>Summary</h1>
<p>In this chapter, we covered the design of our tax calculator application. We looked at wireframes and broke down each element into SwiftUI components. We then implemented the SwiftUI components to match the design from the wireframes. We also took a look at the requirements for building this application, and the design specifications, which looked at the features a tax calculator app can have. Then, we simplified it to the core features our app will provide. We further advanced in the design specifications with acceptance criteria for what we would like our app to do. We also looked at how external libraries can be integrated to provide additional functionality.</p>
<p>In the next chapter, we’ll take a look at implementing the tax calculation backend functionality and tying the two views together.</p>
</div>
</body></html>