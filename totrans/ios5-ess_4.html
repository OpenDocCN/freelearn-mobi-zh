<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch04"/>Chapter 4. Using Storyboards</h1></div></div></div><p>Starting with the release of Xcode 4.2, developers and designers now have the ability to layout the workflow of their applications, using the new<strong> Storyboards</strong> feature that has been incorporated as part of Interface Builder. Storyboards can be used to build an in-game menu system for moving between different screens, or they can be used to build business applications that use the navigation and tab bars controls to transition between each of the different views, as they manage the view controllers created by the developer.<a id="id151" class="indexterm"/>
</p><p>Previously, instead of creating numerous interface files, you can now start dragging and editing all your views in one place, with the ability to specify transitions between screens and the associated actions that trigger them. Storyboards also include a design pattern that can be implemented to send and receive data between controllers. In the previous instances, you would have had to implement protocols, delegates, notifications, or some other custom way to maintain state between screens.</p><p>In this chapter, we will be gaining an understanding into what Storyboards actually are, as well as familiarizing ourselves with the new workflow that has been implemented within Interface Builder. We will look at the steps involved to create storyboards and how to apply different transition techniques between each view, to create a Twitter application to post messages and photos.</p><p>In this chapter, we will:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Gain an understanding into what Storyboards are</li><li class="listitem" style="list-style-type: disc">Learn how to use Storyboards to create and configure transitions to scenes</li><li class="listitem" style="list-style-type: disc">Create a simple storyboard application with Twitter integration</li><li class="listitem" style="list-style-type: disc">Learn about the process involved to create storyboard files</li><li class="listitem" style="list-style-type: disc">Post a tweet message and add a photo</li><li class="listitem" style="list-style-type: disc">Programmatically transition to a new storyboard view-controller</li></ul></div><p>We have some fantastic stuff to cover in this chapter, so let's get started.</p><div><div><div><div><h1 class="title"><a id="ch04lvl1sec01"/>Understanding Storyboards</h1></div></div></div><p>In the past, when you needed to create a new view for your application, you would have had to create a new xib file for each of the views. This became very cumbersome when dealing with complex applications, as they contained a number of different views and became hard transitioning from one view controller to the next.</p><p>Apple decided to improve this in a big way, by substantially making improvements in this area regarding the user interface design process, by introducing a technique called<strong> Storyboarding</strong>.<a id="id152" class="indexterm"/>
</p><p>Storyboarding is a feature that is built into Xcode 4.2, and later that allows both the various screens that comprise an iOS application and the navigation path through those screens to be visually assembled. When you use Storyboards, they enable you to design the application workflow of your screens, similarly to the way a movie director prepares storyboard sketches for every scene of a shoot.<a id="id153" class="indexterm"/>
</p><p>You can then use Interface Builder to layout the parts for each of the screens graphically, as well as the transitions between them, and the controls used to trigger the transitions.</p><p>The following screenshot shows a simple storyboard application containing two view controllers with linkage between them.</p><div><img src="img/2267EXP_04_01.jpg" alt="Understanding Storyboards"/></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec01"/>Transitions</h2></div></div></div><p>Xcode provides the option to change the visual appearance of the transition that takes place from one scene to another within a storyboard, referred to as a<strong> segue</strong>. Using transitions enables you to apply a variety of different styles to each of your view controllers that are to be rendered and displayed to the view, and are represented by arrows between each of the view controllers. By default, a<strong> Cover Vertical</strong> transition is performed whereby the new scene slides vertically upwards from the bottom of the view to cover the currently displayed scene.<a id="id154" class="indexterm"/>
</p><p>You may have seen such transitions in applications, such as the Photos app that comes part of the iPhone and iPad, where you can apply a transition and start a slideshow.<a id="id155" class="indexterm"/>
</p><p>You also have the ability to define custom transitions that enable you to provide a custom segue class method to handle the transition. This can be achieved by selecting<strong> Custom</strong> for the style of the segue, and fill in the name of the custom segue class to use. To use any of the standard segue classes, these are located within the<code class="literal"> UIKit</code> class.<a id="id156" class="indexterm"/>
</p><div><h3 class="title"><a id="note18"/>Note</h3><p>For information relating to the standard segue classes, refer to the<code class="literal"> UIKit</code> framework reference, located at the Apple developer connection website, using the following link:<a class="ulink" href="http://developer.apple.com/library/ios/#documentation/uikit/reference/UIKit_Framework/_index.html"> http://developer.apple.com/library/ios/#documentation/uikit/reference/UIKit_Framework/_index.html</a>.</p></div><p>In order to configure a segue to specify a kind of transition to use between the different scenes, click on the segue and open the<strong> Attributes</strong> inspector, as shown in the following screenshot:<a id="id157" class="indexterm"/>
</p><div><img src="img/2267EXP_04_02.jpg" alt="Transitions"/></div><p>You have the ability to choose from the various transition types that are only applicable to the<strong> Modal</strong> style; these are explained within the following table:<a id="id158" class="indexterm"/>
</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p><strong>Transition name</strong></p>
</th><th style="text-align: left" valign="bottom">
<p><strong>Description</strong></p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<strong>Default</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>When this transition is selected, it uses the<strong> Cover Vertical</strong> transition style.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Cover Vertical</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>When the view controller is presented, its view slides up from the bottom of the screen. When the view is dismissed, it slides back down.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Flip Horizontal</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>When the view controller is presented, the current view initiates a horizontal 3D flip from right-to-left, resulting in the revealing of the new view as if it were on the back of the previous view. When this view is dismissed, the flip occurs from left-to-right, returning to the original view.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Cross Dissolve</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>When the view controller is presented, the current view fades-out while the new view fades-in at the same time. When the view is dismissed, a similar type of cross-fade is used to return to the original view.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Partial Curl</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>When the view controller is presented, one corner of the current view curls up to reveal the modal view underneath. When the view is dismissed, the curled up page uncurls itself back on top of the modal view. A modal view presented using this transition is itself prevented from presenting any additional modal views.</p>
<p>This transition style is supported only if the parent view controller is presenting a full-screen view and you use the<code class="literal"> UIModalPresentationFullScreen</code> modal presentation style. Attempting to use a different form factor for the parent view or a different presentation style triggers an exception.</p>
</td></tr></tbody></table></div><div><h3 class="title"><a id="note19"/>Note</h3><p>For more information on the above transition types, refer to the<code class="literal"> UIViewController</code> framework reference located on the Apple developer website, using the following link:<a class="ulink" href="http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html"> http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html</a>.</p></div><p>Now that we have an understanding of how to go about creating transitions for a view, our next step is to take a look at how we can create storyboards and how to configure scenes for our storyboard application.</p></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec02"/>How to go about creating Storyboard files</h2></div></div></div><p>In the next section, we will take a look at how to go about creating a storyboard application. When you create a new storyboard file, this will give you a view controller object that represents your scene, which is the initial view controller.<a id="id159" class="indexterm"/>
</p><p>Each view controller represents the contents of a single screen. When creating applications for the iPad, a screen can be composed of the contents of more than one scene and you link each object that is contained within a view controller, to another view controller that implements another scene.</p><div><img src="img/2267EXP_04_03.jpg" alt="How to go about creating Storyboard files"/></div><p>As you can see from this screenshot, the initial view controller contains a green outline. You link the various view controllers using Interface Builder by<em> Control</em> + dragging between controls and view controllers. You have the ability to add controls and views to each view controller's view, just as you would add objects to a window or a view in an XIB file.<a id="id160" class="indexterm"/>
</p></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec03"/>Creating a simple Storyboard (Twitter) application</h2></div></div></div><p>Before we can proceed, we first need to create our<code class="literal"> TwitterExample</code> project. To refresh your memory, you can refer to the section that we covered in<a class="link" href="ch02.html" title="Chapter 2. Using iCloud and the Storage APIs"> Chapter 2</a>,<a id="id161" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem"> Launch Xcode from the<code class="literal"> /Developer/Applications</code> folder.</li><li class="listitem"> Choose<strong> Create a new Xcode project</strong>, or<strong> File | New Project</strong>.</li><li class="listitem"> Select the<strong> Single View Application</strong> template from the<strong> Project template</strong> dialog box.<div><img src="img/2267EXP_04_04.jpg" alt="Creating a simple Storyboard (Twitter) application"/></div></li><li class="listitem"> Then, click on the<strong> Next</strong> button to proceed to the next step in the Wizard. This will allow you to enter in the<strong> Product Name</strong> and your<strong> Company Identifier</strong>.<a id="id162" class="indexterm"/><div><img src="img/2267EXP_04_05.jpg" alt="Creating a simple Storyboard (Twitter) application"/></div></li><li class="listitem"> Enter in<code class="literal"> TwitterExample</code> for the<strong> Product Name</strong>, and ensure that you have selected<strong> iPhone</strong> from the<strong> Device Family</strong> drop-down box, and that you have checked the<strong> Use Storyboard</strong> option.<a id="id163" class="indexterm"/></li><li class="listitem"> Next, click on the<strong> Next</strong> button to proceed to the final step in the wizard.</li><li class="listitem"> Choose the folder location where you would like to save your project.</li><li class="listitem"> Then, click on the<strong> Create</strong> button to save your project at the location specified.</li></ol></div><p>Once your project has been created, you will be presented with the Xcode development interface, along with the project files that the template created for you within the<strong> Project Navigator</strong> window. Our next step is to start building the user interface for our Twitter application.</p></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec04"/>Creating scenes</h2></div></div></div><p>The process of creating scenes involves adding a new view controller to the storyboard, which is referred to as a<strong> scene</strong>. Each view controller is responsible for managing a single scene. A better way to describe scenes would be to think of the collection of scenes as a movie, where each frame that is being displayed is the actual scene that connects onto the next part.<a id="id164" class="indexterm"/>
</p><p>When adding scenes to your storyboard file, you can add controls and views to the view controller's view, just as you would do for an XIB file, and have the ability to configure outlets and actions between your view controllers and its views.<a id="id165" class="indexterm"/>
</p><p>To add a new scene into your storyboard file, follow these simple steps:</p><div><ol class="orderedlist"><li class="listitem"> From the<strong> Project Navigator</strong>, select the file named<code class="literal"> MainStoryboard.storyboard</code>.</li><li class="listitem"> From the<strong> Object</strong> library, select and drag a new view-controller on to the storyboard canvas. This is shown in the following screenshot:<div><img src="img/2267EXP_04_06.jpg" alt="Creating scenes"/></div></li><li class="listitem"> Next, drag a<code class="literal"> UIButton</code> control on to the view that we will use in a later section to call the calling view. In the button's attributes, change the text to read<code class="literal"> Go Back</code>.</li><li class="listitem"> Finally, on the first view controller, drag a<code class="literal"> UIButton</code> control on to the view, just above the<strong> Tweet Message</strong> button. In the button's attributes, change the text to read<code class="literal"> About App</code>. This will be used to call the new view that we added in the previous step.<a id="id166" class="indexterm"/><p>Once you have added the controls to each of the views, your final interface should look something like what is shown in the following screenshot.
</p><div><img src="img/2267EXP_04_07.jpg" alt="Creating scenes"/></div></li><li class="listitem"> Next, create the action event for the<strong> About App</strong> button; hold down the control key on your keyboard and drag the mouse from the<strong> About App</strong> button to the<code class="literal"> ViewController.h</code> interface file.<a id="id167" class="indexterm"/></li><li class="listitem"> Select<strong> Action</strong> from the<strong> Connection</strong> type drop-down, then enter in<code class="literal"> showAbout</code> for the name of the<code class="literal"> IBAction</code> method to create, and then click on the<strong> Connect</strong> button to accept the changes, as shown in the following screenshot:<a id="id168" class="indexterm"/></li></ol></div><div><img src="img/2267EXP_04_08.jpg" alt="Creating scenes"/></div><p>Now that we have created our scene, buttons, and actions, our next step is to configure the scene, which is shown in the next section.<a id="id169" class="indexterm"/>
</p></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec05"/>Configuring scenes</h2></div></div></div><p>When you want to transition from one view controller to another, you can hold down the<em> Control</em> key and click a button, table view cell, or any other object from one view controller, and then drag it to the new view controller for a different scene. This technique of dragging between view controllers creates what is known as a<strong> Segue</strong>.<a id="id170" class="indexterm"/>
</p><p>A segue is a configurable object that supports all of the same types of transitions made available to you within the<code class="literal"> UIKit</code> class reference, such as modal transitions and navigation transitions.</p><p>You also have the ability to define custom transitions that replace one view controller with another. To create a segue and configure a scene, follow these simple steps:</p><div><ol class="orderedlist"><li class="listitem"> Select the<strong> About App</strong> button with your mouse, and hold down the<em> Control</em> key while dragging it to the view controller for the scene that you would like to load when the button is selected.</li><li class="listitem"> Release the mouse button, and then choose the<strong> Modal</strong> option from the pop-up menu selection.<div><img src="img/2267EXP_04_09.jpg" alt="Configuring scenes"/></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: none">You will notice that a gray arrow connects both of your view controllers. When the <strong>About App</strong> button is pressed, it will display the page containing the <strong>Go Back</strong> button.<a id="id171" class="indexterm"/></li></ul></div></li><li class="listitem"> Next, we need to do the same for our second view, so that when the<strong> Go Back</strong> button is pressed, it will return back to our first view.</li><li class="listitem"> Repeat<em> steps 1</em> to<em> 2</em>, but substitute the<strong> Go Back</strong> button for the<strong> About App</strong> button.<p>Explanations of the Storyboard Segues that come part of Xcode 4 are included in the following table:
</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p><strong>Segue name</strong></p>
</th><th style="text-align: left" valign="bottom">
<p><strong>Description</strong></p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<strong>Modal</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>A modal view controller is not a specific subclass of the<code class="literal"> UIViewController</code> class, as any type of view controller can be presented modally by your application. However, like the tab bar and navigation view controllers, you can present your view controllers modally when you want to convey a specific meaning about the relationship between the previous view hierarchy and the newly presented view hierarchy.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Push</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>
<strong>Push</strong> segues allow you to push a new view controller onto the navigation stack, just as if you were stacking plates. The view at the top of the stack being the one that gets rendered.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Custom</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>These allow you to customize and call a view controller from code using the<code class="literal"> prepareForSegue</code> method, and are what you use to present the content of your application.</p>
<p>The job of the view controller is to manage the presentation of some content and coordinate the update and the synchronization of that content with the application's underlying data objects.</p>
<p>In the case of a custom view controller, this involves creating a view to present the content and implementing the infrastructure needed to synchronize the contents of that view with your application's data structures.</p>
</td></tr></tbody></table></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: none">Once you have done this, your view controllers should look like something shown in the next screenshot. You can apply a number of transitions to each of your view controllers, so that they can perform animation when they get displayed to the view.</li></ul></div><div><img src="img/2267EXP_04_10.jpg" alt="Configuring scenes"/></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: none">To learn how to apply transitions to your view controller, please refer to the section on <em>Transitions</em> in this chapter.<a id="id172" class="indexterm"/></li></ul></div></li><li class="listitem"> Now that you have applied each of the segues to both view controller, our final step is to compile, build, and run our application.</li><li class="listitem"> From the<strong> Product</strong> menu, select<strong> Run</strong>. Alternatively, press the<strong> Command | R</strong> keys to compile, build, and run the application.<p>The following screenshot shows our application running within the iOS simulator, with each of their associated screens displayed.
</p></li></ol></div><div><img src="img/2267EXP_04_11.jpg" alt="Configuring scenes"/></div><p>So there you have it. In this section, we have learned how to create and add new scenes into our main storyboard, as well as the process on how we are able to link-up and configure each scene when a button has been pressed.<a id="id173" class="indexterm"/>
</p><p>There is also another way in which we can transition to scenes within our storyboard through a programmatic approach. We will be taking a closer look into this, when we embark on the section<em> Presenting storyboard view-controllers programmatically</em>, in this chapter.</p></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec06"/>Building a Twitter application</h2></div></div></div><p>Twitter has provided us with some very simple API's to follow, making it a snap to interact with them. In this section, we will look at how we can use these to post a tweet message and add an image.<a id="id174" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem"> Open the<code class="literal"> MainStoryboard.storyboard</code> file that is located inside the<code class="literal"> TwitterExample</code> folder from the<strong> Project Navigator</strong>.</li><li class="listitem"> Next, drag a<code class="literal"> UITextView</code> onto your view, and resize it to accommodate a reasonable amount of text to be entered, and make sure to delete the default text that is displayed within this control.</li><li class="listitem"> Lastly, we need to drag a<code class="literal"> UIButton</code> on to the view to handle the posting of the message. In the button's attributes, change the text to read<code class="literal"> Tweet Message</code>. Your final interface should look like this:<div><img src="img/2267EXP_04_12.jpg" alt="Building a Twitter application"/></div></li><li class="listitem"> Next, open the<code class="literal"> ViewController.h</code> interface file, and create the following highlighted entries as shown in the following code snippet:<div><pre class="programlisting">
#import &lt;UIKit/UIKit.h&gt;
@interface ViewController :UIViewController {<strong>
UIButton *postTweet;</strong>
}<strong>
@property (nonatomic, retain) IBOutlet UIButton *postTweet;</strong>
@end
</pre></div></li><li class="listitem"> Next, we need to connect up our<strong> Tweet Message</strong> button control, and create the<code class="literal"> IBAction</code> event that will be used to post our tweet message. We will need to ensure that the type of event to use is the<code class="literal"> TouchUpInside</code> method of the<code class="literal"> UIButton</code>.<a id="id176" class="indexterm"/></li><li class="listitem"> To create an action event, hold down the<em> Control</em> key on your keyboard, and drag the mouse to the<code class="literal"> ViewController.h</code> interface file, as shown in the following screenshot.<a id="id177" class="indexterm"/></li><li class="listitem"> Enter in<code class="literal"> postTweet</code> for the name of the<code class="literal"> IBAction</code> method to create, and then click on the<code class="literal"> Connect</code> button to accept the changes.</li></ol></div><div><img src="img/2267EXP_04_13.jpg" alt="Building a Twitter application"/></div><p>Now that we have connected up our<code class="literal"> IBAction</code> event to our method call that will be used to post the tweet, our next step is to add the Twitter framework to our project before we can take a look at how to implement the code to do this.<a id="id178" class="indexterm"/>
</p><p>To add the Twitter framework to your project, select the<strong> Project Navigator Group</strong>, and then follow these simple steps:<a id="id179" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem"> Select your project from within the<strong> Project Navigator</strong>.</li><li class="listitem"> Then, select your project target from under the<strong> TARGETS</strong> group.</li><li class="listitem"> Select the<strong> Build Phases</strong> tab.</li><li class="listitem"> Expand the<strong> Link binary with Libraries</strong> disclosure triangle.</li><li class="listitem"> Finally, use the<strong> +</strong> to add the library that you want. You can also search if you can't find the Twitter framework within the list.</li></ol></div><p>If you are still confused as to how to go about adding the frameworks, follow this screenshot, which highlights the areas that you need to select:</p><div><img src="img/2267EXP_04_14.jpg" alt="Building a Twitter application"/></div><p>Now that we have added our<code class="literal"> Twitter.framework</code> into our project, we can take a look at how to implement the code to post a tweet message using this framework.</p></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec07"/>Composing a Tweet message</h2></div></div></div><p>Whenever you want to compose a Twitter message for submission, you will need to use the<code class="literal"> TWTweetComposeViewController</code> class instance. This class handles everything required, and presents us with a tweet composition sheet, so that we can begin to type in our tweet message. This class also enables you to set the initial twitter text information to use, as well as how to go about adding images and URLs.<a id="id180" class="indexterm"/>
</p><div><h3 class="title"><a id="note20"/>Note</h3><p>For more information on the<code class="literal"> TWTweetComposeViewController</code> class, you can refer to the Twitter framework reference documentation located at the following location:<code class="literal"> http://developer.apple.com/library/ios/#documentation/Twitter/Reference/TWTweetSheetViewControllerClassRef/Reference/Reference.html</code>.</p></div><p>In the following code snippet, we look at how we can compose a Twitter message using the<code class="literal"> TWTweetComposeViewController</code> class.<a id="id181" class="indexterm"/>
</p><p>Before we can use the features of Twitter in our application, we need to include the Twitter framework header files.</p><div><ol class="orderedlist"><li class="listitem"> From the<strong> Project Navigator</strong>, open the<code class="literal"> ViewController.m</code> implementation file, and enter in the following<code class="literal"> import</code> statements as shown:<div><pre class="programlisting">#import &lt;Twitter/Twitter.h&gt;
#import &lt;Twitter/TWTweetComposeViewController.h&gt;
</pre></div></li><li class="listitem"> Next, we need to implement the code to display the Twitter tweet sheet to which we can compose, and then post our message. Open the<code class="literal"> ViewController.m</code> implementation file, and enter in the following code snippet:<div><pre class="programlisting">- (IBAction) postTweet: (id) sender {
TWTweetComposeViewController *myTwitter = [[TWTweetComposeViewController alloc] init];
[myTwitter setInitialText:@"Welcome to iOS 5 and Xcode 4.2, using the Twitter API."];
[self presentModalViewController:myTwitter animated:YES];
// Retrieve the result of the Twitter handler to
// determine if the message was successfully sent.
myTwitter.completionHandler = ^(TWTweetComposeViewControllerResult res){
if (res == TWTweetComposeViewControllerResultDone) {
UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"Success" message:@"Your Tweet was posted successfully." delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
[alertView show];
[self dismissModalViewControllerAnimated:YES];
}
else if (res == TWTweetComposeViewControllerResultCancelled) {
UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"Error" message:@"Your Tweet was not posted." delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
[alertView show];
[self dismissModalViewControllerAnimated:YES];
}
};
}
</pre></div></li><li class="listitem">In this code snippet, we declared a variable <code class="literal">myTwitter</code> to be an instance of our <code class="literal">TWTweetComposeViewController</code> class. We then assigned some text to appear on our composition sheet, by setting the <code class="literal">setInitialText</code> method, and then displaying this to the view. We then set up a handler, using the <code class="literal">completionHandler</code> method, to notify us when the user has done composing the tweet, and we displayed the relevant alert based on the outcome that is returned by the method.<a id="id182" class="indexterm"/></li><li class="listitem"> Optionally, you can use the<code class="literal"> canSendTweet</code> class method to check if Twitter has been set up and is reachable, before presenting the view to the user. This is shown in the following code snippet:<a id="id183" class="indexterm"/><div><pre class="programlisting">BOOL isSUCCESS = TWTweetComposeViewController.canSendTweet;
if (isSUCCESS== YES){
Do something…
}
// Twitter account credentials have not been set up correctly.
else{
UIAlertView *alertView = [[UIAlertViewalloc] initWithTitle:@"Twitter Error" message:@"Your Twitter account has not been set up correctly." delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
[alertView show];
}
</pre></div></li></ol></div><p>What we have accomplished in this above code snippet is using the<code class="literal"> canSendTweet</code> class method of the<code class="literal"> TWTweetComposeViewController</code> class. This method then checks to see if the user has correctly installed and set up Twitter properly. If this has not been done, this statement will fail, and a value of<code class="literal"> NO</code> (or<code class="literal"> FALSE)</code> will be returned to the<code class="literal"> isSuccess</code> variable.<a id="id184" class="indexterm"/>
</p></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec08"/>Adding photos to a Tweet</h2></div></div></div><p>Whenever you want to add images to a twitter message for submission, you will need to use the<code class="literal"> TWTweetComposeViewController</code> class instance. This class handles everything required, and presents us with a tweet composition sheet, so that we can add images and URLs.<a id="id185" class="indexterm"/>
</p><p>In the next code snippet, we look at how simple it is to add images to an existing Twitter message using the<code class="literal"> TWTweetComposeViewController</code> class.</p><p>Open the<code class="literal"> ViewController.m</code> implementation file located within the<code class="literal"> TwitterExample</code> folder within the<strong> Project Navigator</strong>, locate the<code class="literal"> postTweet</code> method, and enter in the following piece of highlighted code, shown as follows:<a id="id186" class="indexterm"/>
</p><div><pre class="programlisting">
- (IBAction) postTweet: (id) sender {

// Attach an image to our Tweet message
TWTweetComposeViewController *myTwitter = [[TWTweetComposeViewControlleralloc] init];

<strong>[myTwitter addImage:[UIImage imageNamed:@"Blue-Aqua-Apple.png"]];</strong>
[self presentModalViewController:myTwitteranimated:YES];
}
</pre></div><p>In this code snippet, we declare a variable<code class="literal"> myTwitter</code> to an instance of our<code class="literal"> TWTweetComposeViewController</code> class. We then use the<code class="literal"> addImageinstance</code> method to add an image to the tweet message, and then present the view along with the image to the user.<a id="id187" class="indexterm"/>
</p><p>Now that we have added in the final piece of code to our<code class="literal"> TwitterExample</code> application, we need to first configure our Twitter account information prior to building and running the application. Follow these steps to set up and configure Twitter.</p><div><ol class="orderedlist"><li class="listitem"> Open the<strong> Settings</strong> application from the iOS home screen.</li><li class="listitem"> Select the<strong> Twitter</strong> option from the<strong> Settings</strong> menu.</li><li class="listitem"> Enter in your<strong> User Name</strong> and<strong> Password</strong> credential information, and click on the<strong> Sign In</strong> button. If you do not have a Twitter account, you can create one from this screen by selecting the<strong> Create New Account</strong> option.<div><img src="img/2267EXP_04_15.jpg" alt="Adding photos to a Tweet"/></div></li><li class="listitem"> Our final step is to compile, build, and run our<code class="literal"> TwitterExample</code> application, by either clicking on the<strong> Play</strong> button within the Xcode IDE or<em> Command</em> +<em> R</em>.<a id="id188" class="indexterm"/><p>The following screenshot shows our TwitterExample application when it is run on the iOS simulator.
</p></li></ol></div><div><img src="img/2267EXP_04_16.jpg" alt="Adding photos to a Tweet"/></div><p>When you start composing your tweet message, you can choose to have your current geographical location added to your message. This feature basically uses the Google Maps API to map the tweets and gives Twitter users the option of tweeting their location on<a class="ulink" href="http://twitter.com/"> http://twitter.com/</a>, and then allowing others to view the precise location on Google Maps.<a id="id189" class="indexterm"/>
</p><p>Attachments can also be added to the composed message, and this can be any valid image (PNG, JPG, and so on). Clicking on the<strong> Send</strong> button will submit the message to your Twitter account, and you will receive a message stating that the Tweet has been successfully posted.</p><p>The following screenshot displays the posted Twitter entry that was submitted by the previous screenshot, as it would look like when displayed on<a class="ulink" href="http://twitter.com/"> http://twitter.com/:</a>
</p><div><img src="img/2267EXP_04_17.jpg" alt="Adding photos to a Tweet"/></div><p>In this section, we looked at how we can integrate Twitter-like functionality into our applications. There are many ways in which applications can be more social, by including Twitter. For example, you could make the application auto-tweet, when you unlock a special item within your game, or when you finish the game, or just want to upload your high-score achievements.<a id="id190" class="indexterm"/>
</p><p>This lets all of their friends know they are playing your game, which in turn, gets you more exposure. Another example could be a business application, which could allow the user to tweet the number of successful projects that they have completed. With Twitter getting so much attention lately, you would be crazy to not include some sort of Twitter integration into your own iOS applications.</p></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec09"/>Preparing to transition to a new view-controller</h2></div></div></div><p>Whenever a user triggers a segue in the current scene, the storyboard runtime calls the<code class="literal"> prepareForSegue:sender:</code> method for the current view controller. This method gives the current view controller an opportunity to pass any needed data to the view controller that is about to be displayed.<a id="id191" class="indexterm"/>
</p><p>In order to programmatically perform a segue, follow these simple steps:<a id="id192" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem"> Ensure that you have drawn a segue between two the<code class="literal"> UIViewControllers</code>.</li><li class="listitem"> Next, click on the segue and fill in the identifier field by using a unique name, as shown in the following screenshot:<div><img src="img/2267EXP_04_18.jpg" alt="Preparing to transition to a new view-controller"/></div></li><li class="listitem"> Now, run the<code class="literal"> prepareForSegue:segue:sender:</code> method call from the<code class="literal"> IBActionlevel</code> of the<code class="literal"> UIButton</code>, as shown in the following code snippet:<a id="id193" class="indexterm"/><div><pre class="programlisting">- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
// Check to see that we are processing the correct
// segue, before processing the alert.
if ([segue.identifierisEqualToString: @"secondViewController"]) {
UIAlertView *alert = [[UIAlertView alloc]initWithTitle: @"TwitterExample" message:@"Currently displaying View #2" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
[alert show];
}
}
</pre></div></li></ol></div><p>In this code snippet, we perform a segue call associated with a control using its identifier. We first check to ensure that we are processing the correct segue, before displaying an alert when the view is displayed.</p><p>Handling it this way allows us to customize segues, and applies any transition to the scene that is located within your storyboard as long as the identifier is unique.<a id="id194" class="indexterm"/>
</p><div><h3 class="title"><a id="note21"/>Note</h3><p>For information on how to implement the methods of the<code class="literal"> UIViewController</code> class, you can refer to the<code class="literal"> UIViewController</code> class reference at the following location:<code class="literal"> http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/cl/UIViewController</code>.</p></div></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec10"/>Presenting storyboard view-controllers programmatically</h2></div></div></div><p>Although the storyboard runtime usually handles transitions between view controllers, you can also trigger segues programmatically, directly from within your code. You may choose to do this when setting up the segue from within Interface Builder, or you may want to use the accelerometer events to trigger a transition and display a graphic animation.<a id="id195" class="indexterm"/>
</p><p>If you take a look at the following example code snippet, you will be able to see that we first load the view controller programmatically using the<code class="literal"> instantiateViewControllerWithIdentifier</code> method of the<code class="literal"> UIStoryboard</code>. Finally, we then present the view controller by pushing it onto the navigation stack.<a id="id196" class="indexterm"/>
</p><div><pre class="programlisting">// SampleViewController
- (void)viewDidLoad{
[super viewDidLoad];
// Instantiate the Samplesubview controller
// from the storyboard.
SampleViewController *subviewController = [self.mainStoryboard instantiateViewControllerWithIdentifier:@"subviewController"];
// Note: the "subviewController" Identifier value must
// be set in the Attributes Inspector on the
// subviewController scene.
// Add to self as child controller
[self addChildViewController:subviewController];
[self mainSubviewaddSubview:subviewController.view];
}
</pre></div><p>In this example, we will look at how we can add an additional view controller subclass to our storyboard, and programmatically determine what view we are in by using the<code class="literal"> performSegueWithIdentifier</code> method call. So, lets get started.<a id="id197" class="indexterm"/>
</p><p>We need to create a new<code class="literal"> UIViewController</code> subclass file that will be used for our second view controller. To create a<code class="literal"> UIViewController</code> subclass file, follow these simple steps:<a id="id198" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem"> From the<strong> Xcode IDE</strong> menu, select<strong> File | New | New File</strong>.</li><li class="listitem"> Next, select the<strong> UIViewController subclass</strong> template to use from the list of available templates, as shown in the following screenshot.<div><img src="img/2267EXP_04_19.jpg" alt="Presenting storyboard view-controllers programmatically"/></div></li><li class="listitem"> Enter in<code class="literal"> secondViewController</code> as the name of the class to create, as shown in the following screenshot:<div><img src="img/2267EXP_04_20.jpg" alt="Presenting storyboard view-controllers programmatically"/></div></li><li class="listitem"> Ensure that you choose<code class="literal"> UIViewController</code> as the name of the subclass to create.</li><li class="listitem"> Ensure that you have unchecked both the<strong> Targeted for iPad</strong> and<strong> With XIB for user interface</strong> checkboxes.<a id="id199" class="indexterm"/></li><li class="listitem"> Specify the location to save the class file, and then click on the<strong> Create</strong> button.<p>Once you have done that, you will be returned back to the Xcode IDE. Both of your interface and implementation files for the <code class="literal">secondViewController</code> will appear within the <strong>Project Navigator</strong> window.
</p></li><li class="listitem"> Open the<strong> ViewController.h</strong> interface file, located under the<code class="literal"> TwitterExample</code> folder, from within the<strong> Project Navigator</strong>.</li><li class="listitem"> Modify the file and include the highlighted code sections, as specified in the following code snippet:<div><pre class="programlisting">//
// ViewController.h
// TwitterExample
//
#import &lt;UIKit/UIKit.h&gt;<strong>
@interface ViewController : UIViewController &lt;UIActionSheetDelegate, UIAlertViewDelegate&gt;{</strong>
UIButton *postTweet;
UIButton *aboutApp;
}
@property (nonatomic, retain) IBOutlet UIButton *postTweet;
@property (nonatomic, retain) IBOutlet UIButton *showAbout;
- (IBAction)postTweet:(id)sender;
- (IBAction)showAbout:(id)sender;
@end
</pre></div></li><li class="listitem">In this code snippet, we are setting up our delegate objects in order to pass information to and from the view controller.<a id="id200" class="indexterm"/></li><li class="listitem"> Open the<code class="literal"> ViewController.m</code> implementation file located under the<code class="literal"> TwitterExample</code> folder, from within the<strong> Project Navigator</strong>.</li><li class="listitem"> Modify the file, and include the highlighted code sections, as specified in the following code snippet:<div><pre class="programlisting"><strong>- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{</strong>
// Check to see that we are processing the correct segue,
//before processing the alert.<strong>
if ([segue.identifierisEqualToString: @"firstViewController"]) {
UIAlertView *alert = [[UIAlertView alloc]initWithTitle: @"TwitterExample" message:@"Currently displaying View #2" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
[alert show];
}</strong>
}
</pre></div></li></ol></div><p>What we are doing in this code snippet, is determining the current view of our view controller and ensuring that we are in our<code class="literal"> firstViewController</code>. We do this by checking the<code class="literal"> segue</code> property, and obtaining the identifier value that we declared previously. If we are in the correct view, a pop-up alert is then displayed to the current view.<a id="id201" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem"> Open the<code class="literal"> secondViewController.h</code> interface file located under the<code class="literal"> TwitterExample</code> folder, from within the<strong> Project Navigator</strong>.</li><li class="listitem"> Modify the file and include the highlighted code sections as specified in the following code snippet:<div><pre class="programlisting">//
// secondViewController.h
// TwitterExample
//
#import &lt;UIKit/UIKit.h&gt;<strong>
@interface secondViewController :UIViewController &lt;UIActionSheetDelegate, UIAlertViewDelegate&gt;</strong>
- (IBAction)GoBack:(id)sender;
@property (strong, nonatomic) IBOutlet UIButton *GoBack;
@end
</pre></div></li><li class="listitem">What we are doing in this code snippet, is setting up our delegate objects in order to pass information to and from the view controller.</li><li class="listitem"> Open the<code class="literal"> secondViewController.m</code> implementation file located under the<code class="literal"> TwitterExample</code> folder, from within the<strong> Project Navigator</strong>.</li><li class="listitem"> Modify the file, and include the highlighted code sections as specified in the following code snippet:<div><pre class="programlisting">- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
// Check to see that we are processing the correct segue,
// before processing the alert.
if ([segue.identifierisEqualToString: @"secondViewController"]) {
UIAlertView *alert = [[UIAlertView alloc]initWithTitle: @"TwitterExample" message:@"Currently displaying View #1" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
[alert show];
}
}
</pre></div></li><li class="listitem">Here we are determining the current view of our view controller, and ensuring that we are in our <code class="literal">secondViewController</code>. We do this by checking the segue property and obtain the identifier value that we declared previously. If we are in the correct view, a pop-up alert is then displayed to the current view.</li><li class="listitem"> Select the second view controller we just created, then under the identity inspector section, click on the<strong> Custom Class</strong> title bar, and change the<strong> Class</strong> to read<code class="literal"> secondViewController</code> as shown in the following screenshot:<a id="id202" class="indexterm"/><div><img src="img/2267EXP_04_21.jpg" alt="Presenting storyboard view-controllers programmatically"/></div></li><li class="listitem"> Under the attributes<strong> Inspector</strong> section, under the<strong> Storyboard Segue</strong> section, enter in<code class="literal"> secondViewController</code> as the identifier to use when moving between views, as shown in the following screenshot:<a id="id203" class="indexterm"/><div><img src="img/2267EXP_04_22.jpg" alt="Presenting storyboard view-controllers programmatically"/></div></li><li class="listitem"> Next, we need to apply the same Storyboard Segues for our first view controller.<a id="id204" class="indexterm"/></li><li class="listitem"> Select the attributes<strong> Inspector</strong> section, and then under the<strong> Storyboard Segue</strong> section, enter in<code class="literal"> firstViewController</code> as the unique identifier to use.</li><li class="listitem"> Repeat the same steps as we did for the<code class="literal"> secondViewController</code>.</li><li class="listitem"> Our final step is to compile, build, and run our<code class="literal"> TwitterExample</code> application, by either clicking on the<strong> Play</strong> button within the Xcode IDE or<em> Command</em> +<em> R</em>.<p>The following screenshot shows our <code class="literal">TwitterExample</code> application running within the iOS simulator, showing the programmatic transitions between each of the view controllers that are defined within our storyboard.
<a id="id205" class="indexterm"/>
</p></li></ol></div><div><img src="img/2267EXP_04_23.jpg" alt="Presenting storyboard view-controllers programmatically"/></div><p>When you click on the<strong> About App</strong> button, it transitions over to the second view controller and then displays the message based on the<code class="literal"> prepareForSegue:(UIStoryboardSegue*)segue</code> method call, determining the identifier of the current view controller that is being displayed within the view.<a id="id206" class="indexterm"/>
</p><p>When you click on the<strong> Go Back</strong> button, this will transfer control over to the first view controller, a call is made to the<code class="literal"> prepareForSegue</code> method, to determine the current identifier of the current view.<a id="id207" class="indexterm"/>
</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch04lvl1sec02"/>Summary</h1></div></div></div><p>In this chapter, we learned the fundamentals of what storyboards actually are, how they work, how to go about adding scenes and configure these within the storyboard, and how to apply the different types of transition methods available.</p><p>We learnt about the Twitter framework and how we can use the collection of Twitter APIs available to successfully post a message and image to a twitter account. To end the chapter, we looked at how we can use the various methods to transition between each view controller within the main storyboard, programmatically, and using the storyboard transitions.</p><p>In the next chapter, we will learn about the<strong> AirPlay</strong> and<strong> Core Image</strong> frameworks, and look at how we use and implement these into our applications. We will learn about the different image filter effects and how to present these within our application to output this to an external device, such as Apple TV.</p></div></body></html>