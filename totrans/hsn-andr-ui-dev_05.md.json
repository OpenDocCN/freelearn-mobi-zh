["```kt\nandroid {\n  compileSdkVersion 26\n  // ...\n}\n```", "```kt\nandroid {\n compileSdkVersion 26\n   // ...\n dataBinding {\n enabled = true\n }\n}\n```", "```kt\nprivate int amountPerDay;\nprivate final List<ClaimItem> items = new ArrayList<>();\n\npublic Allowance(final int amountPerDay) {\n    this.amountPerDay = amountPerDay;\n}\n\nprotected Allowance(final Parcel in) {\n    amountPerDay = in.readInt();\n    in.readTypedList(items, ClaimItem.CREATOR);\n}\n\npublic int getAmountPerDay() { return amountPerDay; }\n```", "```kt\npublic void setAmountPerDay(final int amountPerDay) {\n    this.amountPerDay = amountPerDay;\n    notifyChange();\n}\n```", "```kt\npublic Date getStartDate() {\n  return items.get(items.size() - 1).getTimestamp();\n}\npublic Date getEndDate() {\n  return items.get(0).getTimestamp();\n}\n```", "```kt\npublic double getTotalSpent() {\n    double total = 0;\n\n    for (final ClaimItem item : items)\n        total += item.getAmount();\n\n    return total;\n}\n```", "```kt\npublic double getAmountSpent(final Date from, final Date to) {\n   double spent = 0;\n    for (int i = 0; i < items.size(); i++) {\n        final ClaimItem item = items.get(i);\n        if (item.getTimestamp().compareTo(from) >= 0\n                && item.getTimestamp().compareTo(to) <= 0) {\n            spent += item.getAmount();\n        }\n    }\n\n    return spent;\n}\n```", "```kt\npublic void addClaimItem(final ClaimItem item) {\n   items.add(item);\n   Collections.sort(\n     items,\n     Collections.reverseOrder(new Comparator<ClaimItem>() {\n       @Override\n       public int compare(final ClaimItem o1, final ClaimItem o2) {\n         return o1.getTimestamp().compareTo(o2.getTimestamp());\n       }\n     })\n   );\n\n   notifyChange();\n}\n```", "```kt\npublic void removeClaimItem(final ClaimItem item) {\n  items.remove(item);\n  notifyChange()\n}\n```", "```kt\npublic int getClaimItemCount() {\n  return items.size();\n}\npublic ClaimItem getClaimItem(final int index) {\n  return items.get(index);\n}\npublic boolean isEmpty() {\n  return items.isEmpty();\n}\n```", "```kt\n@Override\npublic void writeToParcel(Parcel dest, int flags) {\n  dest.writeInt(amountPerDay);\n  dest.writeTypedList(items);\n}\n\n@Override\npublic int describeContents() { return 0; }\n\npublic static final Creator<Allowance> CREATOR = new Creator<Allowance>() {\n  @Override\n  public Allowance createFromParcel(Parcel in) {\n    return new Allowance(in);\n  }\n\n  @Override\n  public Allowance[] newArray(int size) {\n    return new Allowance[size];\n  }\n};\n```", "```kt\npublic static class SpendingStats {\n   public final int total;\n   public final int today;\n   public final int thisWeek;\n   SpendingStats(\n           final int total,\n           final int today,\n           final int thisWeek) {\n       this.total = total;\n       this.today = today;\n       this.thisWeek = thisWeek;\n   }\n}\n```", "```kt\npublic final ObservableField<SpendingStats> spendingStats = new ObservableField<>();\n```", "```kt\npublic final Allowance allowance;\npublic AllowanceOverviewPresenter(final Allowance allowance) {\n   this.allowance = allowance;\n}\n```", "```kt\npublic void updateAllowance(final CharSequence newAllowance) {\n  try {\n    allowance.setAmountPerDay(\n        Integer.parseInt(newAllowance.toString()));\n  } catch (final RuntimeException ex) {\n    //ignore\n    allowance.setAmountPerDay(0);\n  }\n}\n```", "```kt\n<layout \n\n   android:layout_width=\"match_parent\"\n   android:layout_height=\"match_parent\"\n   tools:context=\"com.packtpub.claim.ui.AllowanceOverviewFragment\">\n</layout>\n```", "```kt\n<layout \n\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    tools:context=\"com.packtpub.claim.ui.AllowanceOverviewFragment\">\n\n  <data>\n <variable\n name=\"presenter\"\n type=\"com.packtpub.claim.ui.\n              presenters.AllowanceOverviewPresenter\" />\n </data>\n</layout>\n```", "```kt\n<android.support.constraint.ConstraintLayout\n   android:layout_width=\"match_parent\"\n   android:layout_height=\"match_parent\">\n</android.support.constraint.ConstraintLayout>\n```", "```kt\n<TextView\n   android:id=\"@+id/totalLabel\"\n   android:layout_width=\"0dp\"\n   android:layout_height=\"wrap_content\"\n   android:layout_marginTop=\"@dimen/grid_spacer1\"\n   android:gravity=\"center\"\n   android:text=\"@string/label_total\"\n android:minWidth=\"@dimen/allowance_overview_label_min_width\"\n   android:textAppearance=\"@style/TextAppearance.AppCompat.Caption\"\n   app:layout_constraintEnd_toEndOf=\"@+id/total\"\n   app:layout_constraintStart_toStartOf=\"@+id/total\"\n   app:layout_constraintTop_toTopOf=\"parent\" />\n```", "```kt\n<TextView\n   android:id=\"@+id/total\"\n   android:layout_width=\"wrap_content\"\n   android:layout_height=\"wrap_content\"\n   android:layout_marginEnd=\"@dimen/grid_spacer1\"\n   android:layout_marginTop=\"@dimen/grid_spacer1\"\n   android:gravity=\"center\"\n   android:minWidth=\"@dimen/allowance_overview_label_min_width\"\n   android:textAppearance=\"@style/TextAppearance.AppCompat.Display1\"\n   app:layout_constraintEnd_toEndOf=\"parent\"\n   app:layout_constraintTop_toBottomOf=\"@+id/totalLabel\" />\n```", "```kt\nandroid:text='@{Integer.toString(presenter.spendingStats.total) ?? \"0\"}'\n```", "```kt\n<TextView\n   android:id=\"@+id/weekLabel\"\n   android:layout_width=\"wrap_content\"\n   android:layout_height=\"wrap_content\"\n   android:layout_marginEnd=\"0dp\"\n   android:layout_marginTop=\"@dimen/grid_spacer1\"\n   android:gravity=\"center\"\n   android:minWidth=\"@dimen/allowance_overview_label_min_width\"\n   android:text=\"@string/label_week\"\n   android:textAppearance=\"@style/TextAppearance.AppCompat.Caption\"\n   app:layout_constraintEnd_toEndOf=\"@+id/week\"\n app:layout_constraintStart_toStartOf=\"@+id/week\"\n   app:layout_constraintTop_toTopOf=\"parent\" />\n\n<TextView\n   android:id=\"@+id/week\"\n   android:layout_width=\"wrap_content\"\n   android:layout_height=\"wrap_content\"\n   android:layout_marginEnd=\"@dimen/grid_spacer1\"\n   android:layout_marginTop=\"@dimen/grid_spacer1\"\n   android:gravity=\"center\"\n   android:minWidth=\"@dimen/allowance_overview_label_min_width\"\n   android:text='@{Integer.toString(presenter.spendingStats.thisWeek) ?? \"0\"}'\n   android:textAppearance=\"@style/TextAppearance.AppCompat.Display1\"\n   app:layout_constraintEnd_toStartOf=\"@+id/total\"\n app:layout_constraintTop_toBottomOf=\"@+id/weekLabel\" />\n```", "```kt\n<TextView\n   android:id=\"@+id/todayLabel\"\n   android:layout_width=\"wrap_content\"\n   android:layout_height=\"wrap_content\"\n   android:layout_marginEnd=\"0dp\"\n   android:layout_marginTop=\"@dimen/grid_spacer1\"\n   android:gravity=\"center\"\n   android:minWidth=\"@dimen/allowance_overview_label_min_width\"\n   android:text=\"@string/label_today\"\n   android:textAppearance=\"@style/TextAppearance.AppCompat.Caption\"\n   app:layout_constraintEnd_toEndOf=\"@+id/today\"\n app:layout_constraintStart_toStartOf=\"@+id/today\"\n   app:layout_constraintTop_toTopOf=\"parent\" />\n\n<TextView\n   android:id=\"@+id/today\"\n   android:layout_width=\"wrap_content\"\n   android:layout_height=\"wrap_content\"\n   android:layout_marginEnd=\"@dimen/grid_spacer1\"\n   android:layout_marginTop=\"@dimen/grid_spacer1\"\n   android:gravity=\"center\"\n   android:minWidth=\"@dimen/allowance_overview_label_min_width\"\n   android:text='@{Integer.toString(presenter.spendingStats.today) ?? \"0\"}'\n   android:textAppearance=\"@style/TextAppearance.AppCompat.Display1\"\n   app:layout_constraintEnd_toStartOf=\"@+id/week\"\n app:layout_constraintTop_toBottomOf=\"@+id/todayLabel\" />\n```", "```kt\n<android.support.design.widget.TextInputLayout\n  android:id=\"@+id/textInputLayout\"\n  android:layout_width=\"0dp\"\n  android:layout_height=\"0dp\"\n  android:layout_marginEnd=\"@dimen/grid_spacer1\"\n  android:layout_marginStart=\"@dimen/grid_spacer1\"\n  android:layout_marginTop=\"@dimen/grid_spacer1\"\n  app:layout_constraintBottom_toBottomOf=\"@+id/today\"\n  app:layout_constraintEnd_toStartOf=\"@+id/today\"\n  app:layout_constraintStart_toStartOf=\"parent\"\n  app:layout_constraintTop_toTopOf=\"parent\">\n\n  <android.support.design.widget.TextInputEditText\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"wrap_content\"\n    android:hint=\"@string/label_daily_allowance\"\n    android:inputType=\"number\"\n    android:onTextChanged=\n           \"@{(text, start, before, end)\n              -> presenter.updateAllowance(text)}\"\n    android:text='@{presenter.allowance.amountPerDay > 0 ?\n Integer.toString(presenter.allowance.amountPerDay) : \"\"}' />\n\n  </android.support.design.widget.TextInputLayout>\n</android.support.constraint.ConstraintLayout>\n```", "```kt\nprivate class UpdateSpendingStatsCommand\n    extends ActionCommand<Allowance, SpendingStats> {\n```", "```kt\nPair<Date, Date> getThisWeek() {\n  final GregorianCalendar today = new GregorianCalendar();\n  today.set(\n      Calendar.HOUR_OF_DAY,\n      today.getActualMaximum(Calendar.HOUR_OF_DAY));\n  today.set(\n      Calendar.MINUTE,\n      today.getActualMaximum(Calendar.MINUTE));\n  today.set(\n      Calendar.SECOND,\n      today.getActualMaximum(Calendar.SECOND));\n  today.set(\n      Calendar.MILLISECOND,\n      today.getActualMaximum(Calendar.MILLISECOND));\n\n  final Date end = today.getTime();\n\n  today.add(\n      Calendar.DATE,\n      -(today.get(Calendar.DAY_OF_WEEK) - Calendar.SUNDAY));\n\n  today.set(Calendar.HOUR_OF_DAY, 0);\n  today.set(Calendar.MINUTE, 0);\n  today.set(Calendar.SECOND, 0);\n  today.set(Calendar.MILLISECOND, 0);\n\n  return new Pair<>(today.getTime(), end);\n}\n\nPair<Date, Date> getToday() {\n  final GregorianCalendar today = new GregorianCalendar();\n  today.set(\n      Calendar.HOUR_OF_DAY,\n      today.getActualMaximum(Calendar.HOUR_OF_DAY));\n  today.set(\n      Calendar.MINUTE,\n      today.getActualMaximum(Calendar.MINUTE));\n  today.set(\n      Calendar.SECOND,\n      today.getActualMaximum(Calendar.SECOND));\n  today.set(\n      Calendar.MILLISECOND,\n      today.getActualMaximum(Calendar.MILLISECOND));\n\n  final Date end = today.getTime();\n\n  today.add(Calendar.DATE, -1);\n  today.set(Calendar.HOUR_OF_DAY, 0);\n  today.set(Calendar.MINUTE, 0);\n  today.set(Calendar.SECOND, 0);\n  today.set(Calendar.MILLISECOND, 0);\n\n  return new Pair<>(today.getTime(), end);\n}\n```", "```kt\npublic SpendingStats onBackground(final Allowance allowance)\n      throws Exception {\n  final Pair<Date, Date> today = getToday();\n  final Pair<Date, Date> thisWeek = getThisWeek();\n  // for stats we round everything to integers\n  return new SpendingStats(\n      (int) allowance.getTotalSpent(),\n      (int) allowance.getAmountSpent(today.first, today.second),\n      (int) allowance.getAmountSpent(thisWeek.first, thisWeek.second)\n  );\n}\n```", "```kt\npublic void onForeground(final SpendingStats newStats) {\n   spendingStats.set(newStats);\n}\n```", "```kt\nprivate final UpdateSpendingStatsCommand updateSpendStatsCommand\n                                = new UpdateSpendingStatsCommand();\n```", "```kt\nprivate final Observable.OnPropertyChangedCallback\n    allowanceObserver = new Observable.OnPropertyChangedCallback() {\n\n   public void onPropertyChanged(\n       final Observable observable,\n       final int propertyId) {\n     updateSpendStatsCommand.exec(allowance);\n   }\n};\n```", "```kt\npublic AllowanceOverviewPresenter(final Allowance allowance) {\n   this.allowance = allowance;\n   this.allowance.addOnPropertyChangedCallback(allowanceObserver);\n}\n```", "```kt\npublic void detach() {\n   allowance.removeOnPropertyChangedCallback(allowanceObserver);\n}\n```", "```kt\n<include layout=\"@layout/merge_date_picker\"\n         app:date=\"@{user.dateOfBirth}\"\n         android:layout_width=\"match_parent\"\n         android:layout_height=\"wrap_content\"/>\n```"]