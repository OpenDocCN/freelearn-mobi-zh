<html><head></head><body>
		<div><h1 id="_idParaDest-124" class="chapter-number"><a id="_idTextAnchor339"/>11</h1>
			<h1 id="_idParaDest-125"><a id="_idTextAnchor340"/>Remote Config</h1>
			<p>Getting a new build of your game exported can take quite a bit of time. It takes time to actually make the changes in the Unity Editor, and then you have to export the game and upload a new version on each of the app stores you are targeting. Then, you have to spend time waiting for them to approve the app and for everyone to actually download it.<a id="_idTextAnchor341"/></p>
			<p>One of the things I talk to my students about is creating projects that can be easily changed without having to open the Unity Editor. This can be done using data-driven development practices – such as building levels or encounters using text files, AssetBundles, or Unity’s <strong class="bold">Remote Config</strong> (previously <strong class="bold">Remote Settings</strong>) menu – allowing us to instantly modify variables in copies of the game that are already out.</p>
			<p>In this chapter, we’re going to see just how easy it is to set up Unity’s Remote Config system, and how we can utilize it for a simple example, by changing the difficulty of our game by changing the speed at which the player moves.</p>
			<p>The chapter itself is a simple step-by-step process from beginning to end. Here is an outline of our tasks:</p>
			<ul>
				<li>Remote Config setup</li>
				<li>Integrating Game Overrides into gameplay</li>
			</ul>
			<h1 id="_idParaDest-126"><a id="_idTextAnchor342"/>Technical requirements</h1>
			<p>This book utilizes Unity 2022.1.0b16 and Unity Hub 3.3.1, but the steps should work with minimal changes in future versions of the editor. If you would like to download the exact version used in this book, you can visit Unity’s download archive at <a href="https://unity3d.com/get-unity/download/archive">https://unity3d.com/get-unity/download/archive</a>. You can also find the system requirements for Unity at <a href="https://docs.unity3d.com/2022.1/Documentation/Manual/system-requirements.html">https://docs.unity3d.com/2022.1/Documentation/Manual/system-requirements.html</a> in the <strong class="bold">Unity Editor system requirements</strong> section. To deploy your project, you will need an Android or iOS device.</p>
			<p>You can find the code files present in this chapter on GitHub at <a href="https://github.com/PacktPublishing/Unity-2022-Mobile-Game-Development-3rd-Edition/tree/main/Chapter11">https://github.com/PacktPublishing/Unity-2022-Mobile-Game-Development-3rd-Edition/tree/main/Chapter11</a>.</p>
			<h1 id="_idParaDest-127"><a id="_idTextAnchor343"/>Remote Config setup</h1>
			<p>In order for us to use <a id="_idIndexMarker647"/>Remote Config, the first thing we’re going to need to do is add the Remote Config package to our project. So, let’s take a look at how we can do that using the following steps:</p>
			<ol>
				<li>From the Unity Editor, open the <strong class="bold">Services</strong> window of the Package Manager (shown in the top-right part of the next screenshot) by either clicking on the cloud button at the top left of the screen or going to <strong class="bold">Window</strong> | <strong class="bold">General</strong> | <strong class="bold">Services</strong>.</li>
			</ol>
			<div><div><img src="img/B18868_11_01.jpg" alt="Figure 11.1: The location of the Services button"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 11.1: The location of the Services button</p>
			<p>If all goes well, you should see something like the following screenshot:</p>
			<div><div><img src="img/B18868_11_02.jpg" alt="Figure 11.2: Package Manager | Services"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 11.2: Package Manager | Services</p>
			<ol>
				<li value="2">From there, scroll <a id="_idIndexMarker648"/>down and click on the <strong class="bold">Remote Config</strong> package, and then click on the <strong class="bold">Install</strong> button at the bottom right. If all went well, you should see something like the following screenshot:</li>
			</ol>
			<div><div><img src="img/B18868_11_03.jpg" alt="Figure 11.3: The Remote Config packages installed"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 11.3: The Remote Config packages installed</p>
			<ol>
				<li value="3">Close out of the <a id="_idIndexMarker649"/>Package Manager and open the <strong class="bold">Remote Config</strong> window by going to <strong class="bold">Window</strong> | <strong class="bold">Remote Config</strong>. This will open a separate window that I will then drag and drop next to the Console for ease of use. If all goes well, your editor should look similar to the following:</li>
			</ol>
			<div><div><img src="img/B18868_11_04.jpg" alt="Figure 11.4: The Remote Config window added"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 11.4: The Remote Config window added</p>
			<p>And with that, the <a id="_idIndexMarker650"/>Remote Config package is installed correctly!</p>
			<p>Just like how in the previous chapter we needed to create a connection between Unity Gaming Services and our <a id="_idIndexMarker651"/>project in order to use Unity Analytics, we will also need to do the same thing to tweak Remote Config values.</p>
			<h2 id="_idParaDest-128"><a id="_idTextAnchor344"/>Creating key-value pairs</h2>
			<p>The first thing we will <a id="_idIndexMarker652"/>need to do is <a id="_idIndexMarker653"/>create the variables that we would like to change:</p>
			<ol>
				<li>From the Unity Editor, if the <strong class="bold">Remote Config</strong> window is open, click on the <strong class="bold">View in </strong><strong class="bold">Dashboard</strong> option.</li>
			</ol>
			<div><div><img src="img/B18868_11_05.jpg" alt="Figure 11.5: The Remote Config page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 11.5: The Remote Config page</p>
			<p>Alternatively, for <a id="_idIndexMarker654"/>those on the Unity dashboard website, you can click on <strong class="bold">LiveOps</strong>. Once there, on the left-hand side, open up the <strong class="bold">Remote Config</strong> section, and then click on the <strong class="bold">Config</strong> tab located under it.</p>
			<p>This section is the location where we can set and modify the values. Just like working with dictionaries, the settings are key-value pairs, and while there is currently only one configuration now, <code>production</code>, it is possible to create many other environments. Generally, there are two configurations that can be used – <code>True</code> from the <strong class="bold">Build </strong><strong class="bold">Settings</strong> window.</p>
			<ol>
				<li value="2">Click on the <code>RollSpeed</code>. Under the <strong class="bold">Choose a type</strong> dropdown, select <strong class="bold">Float</strong>. Lastly, put <strong class="bold">5</strong> in <a id="_idIndexMarker655"/>the <strong class="bold">Float Value</strong> field. Finally, click on the <strong class="bold">Add</strong> button:</li>
			</ol>
			<div><div><img src="img/B18868_11_06.jpg" alt="Figure 11.6: Adding a key"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 11.6: Adding a key</p>
			<p>Then, let’s do the same thing for the <code>DodgeSpeed</code> variable with a value of <strong class="bold">5</strong>:</p>
			<div><div><img src="img/B18868_11_07.jpg" alt="Figure 11.7: The DodgeSpeed and RollSpeed keys added"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 11.7: The DodgeSpeed and RollSpeed keys added</p>
			<ol>
				<li value="3">It’s important<a id="_idIndexMarker656"/> to note <a id="_idIndexMarker657"/>that this doesn’t actually make a change. In fact, you’ll see a note above the values saying that there are unpublished changes. Note how there is a big blue button that says <strong class="bold">Publish</strong>. Click on that to deploy the changes. It’ll present a window asking whether you want to confirm the changes:</li>
			</ol>
			<div><div><img src="img/B18868_11_08.jpg" alt="Figure 11.8: Confirming our change﻿."/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 11.8: Confirming our change.</p>
			<ol>
				<li value="4">Now that we have some values to grab, let’s take a look at how we can actually do that. Head back into the Unity Editor.</li>
				<li>In the <strong class="bold">Remote Config</strong> window, click on the <strong class="bold">Pull</strong> button. If all went well, you should see the values added to our project:</li>
			</ol>
			<div><div><img src="img/B18868_11_09.jpg" alt="Figure 11.9: The values added to our Remote Config after a pull"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 11.9: The values added to our Remote Config after a pull</p>
			<p>It’s a good habit to <a id="_idIndexMarker658"/>pull every time that you are about to make changes to your remote configs from your project, ensuring that y<a id="_idIndexMarker659"/>ou always have the latest version of your properties possible. And with that, we’ve now seen how we can create different key-value pairs to add to our project.</p>
			<h1 id="_idParaDest-129"><a id="_idTextAnchor345"/>Integrating Game Overrides into gameplay</h1>
			<p>Now that we can see how<a id="_idIndexMarker660"/> to get those values and how the<a id="_idIndexMarker661"/> system works, let’s see how we can actually integrate it with our project and have it affect gameplay:</p>
			<ol>
				<li>Open up the gameplay scene if it isn’t open already, and create a new GameObject by going to <code>Remote Config Manager</code> and reset its position.</li>
				<li>Then, from the <code>Assets\Scripts</code> folder and create a new C# script called <code>RemoteConfigManager</code>.</li>
				<li>Attach the newly created <code>RemoteConfigManager</code> component to the <code>RemoteConfigManager</code> object we created in <em class="italic">step 1</em>. If all went well, your project should look similar to the following screenshot.</li>
			</ol>
			<div><div><img src="img/B18868_11_10.jpg" alt="Figure 11.10: Adding RemoteConfigManager"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 11.10: Adding RemoteConfigManager</p>
			<ol>
				<li value="4">Back in<a id="_idIndexMarker662"/> the <code>RemoteConfigManager</code> script to open it with the script editor of your choice and replace its script with the following:<pre class="source-code">
using UnityEngine;
using Unity.RemoteConfig; /* ConfigManager */
public class RemoteConfigManager : MonoBehaviour
{
    public PlayerBehaviour playerBehaviour;
    public struct userAttributes { }
    public struct appAttributes { }
    private void Awake()
    {
        ConfigManager.FetchCompleted +=
            ApplyRemoteSettings;
        ConfigManager.FetchConfigs&lt;userAttributes,
            appAttributes&gt;(new userAttributes(),
                new appAttributes());
    }
    private void ApplyRemoteSettings(ConfigResponse
        configResponse)
    {
        /* Check if new settings have been loaded */
        if (configResponse.requestOrigin ==
            ConfigOrigin.Remote)
        {
            /* There are, so values should be updated
            */
           playerBehaviour.UpdateRemoteConfigValues();
        }
    }
}</pre></li>
			</ol>
			<p>In the <code>Awake</code> function, we <a id="_idIndexMarker663"/>utilize<a id="_idIndexMarker664"/> the <code>ConfigManager.FetchConfigs</code> method in order to get the app configuration settings from the remote server. Upon completing the fetch operation successfully, the <code>ConfigManager.FetchCompleted</code> event is triggered. In this case, we added an <code>ApplyRemoteSettings</code> function, which should also be called when that event triggers, which we then implement.</p>
			<p>That method takes in a <code>ConfigResponse</code> struct that represents the response of a <code>RemoteConfig</code> fetch. Of note is the <code>requestOrigin</code> property, which is an enum representing the origin point of the last retrieved configuration settings. It can be one of three options:</p>
			<ul>
				<li><code>Cached</code>: The config settings loaded in our current session are cached from a previous session, so no new configuration settings are loaded</li>
				<li><code>Default</code>: There are no configuration settings that are loaded in the current session</li>
				<li><code>Remote</code>: There are new configuration settings that were loaded from the remote server in the current session</li>
			</ul>
			<p>In our case, we only need to do something if the value is <code>Remote</code>. If this is the case, that means that there are new settings that have been loaded, which means that we need to update the values that are currently loaded.</p>
			<ol>
				<li value="5">Then, we need to go to the <code>PlayerBehaviour</code> script and add the following to the top section with the rest of the <code>using</code> statements:<pre class="source-code">
  using Unity.RemoteConfig; /* ConfigManager */</pre></li>
				<li>Afterward, we need<a id="_idIndexMarker665"/> to add the <code>UpdateRemoteConfigValues</code> function to the <code>PlayerBehaviour</code> class because it currently doesn’t exist; otherwise, we will get a compiler error:<pre class="source-code">
/// &lt;summary&gt;
/// Will update each value for this component we are using with /// Remote Config
/// &lt;/summary&gt;
public void UpdateRemoteConfigValues()
{
    /* Get the value from the cloud and set the value
       to use */
    float newRollSpeed =
        ConfigManager.appConfig.GetFloat("RollSpeed");
    Debug.Log("Update RollSpeed to: " + newRollSpeed);
    rollSpeed = newRollSpeed;
    /* Get the value from the cloud and set the value
       to use */
    float newDodgeSpeed =
       ConfigManager.appConfig.GetFloat("DodgeSpeed");
    Debug.Log("Update DodgeSpeed to: " +
        newRollSpeed);
    dodgeSpeed = newDodgeSpeed;
}</pre></li>
			</ol>
			<p>In this case, we are using the <code>appConfig</code> property of <code>ConfigManager</code>, which is the <code>RuntimeConfig</code> object, allowing us to access the current values as they are currently set from the cloud for our environment(s). Then, we set the current values of our <code>rollSpeed</code> and <code>dodgeSpeed</code> variables to the values that<a id="_idIndexMarker666"/> we <a id="_idIndexMarker667"/>retrieved from the cloud.</p>
			<p>For more information on the <code>ConfigManager</code> class, check out the following: <a href="https://docs.unity3d.com/Packages/com.unity.remote-config@0.3/api/Unity.RemoteConfig.ConfigManager.html">https://docs.unity3d.com/Packages/com.unity.remote-config@0.3/api/Unity.RemoteConfig.ConfigManager.htm</a></p>
			<ol>
				<li value="7">Save both scripts and return to the Unity Editor. Then, go to the <strong class="bold">Hierarchy</strong> window, select <strong class="bold">Remote Config Manager</strong>, and from the <strong class="bold">Inspector</strong> window, assign the <strong class="bold">Player Behaviour</strong> value to the <strong class="bold">Player</strong> object.</li>
			</ol>
			<div><div><img src="img/B18868_11_11.jpg" alt="Figure 11.11: Adding Player Behaviour"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 11.11: Adding Player Behaviour</p>
			<ol>
				<li value="8">Upon playing the<a id="_idIndexMarker668"/> game, you <a id="_idIndexMarker669"/>should be able to see in the <code>Debug.Log</code> statement being called, telling us that the value is being updated to whatever we placed in <strong class="bold">Remote Config</strong>:</li>
			</ol>
			<div><div><img src="img/B18868_11_12.jpg" alt="Figure 11.12: Values are updating correctly"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 11.12: Values are updating correctly</p>
			<ol>
				<li value="9">Since the <code>dodgeSpeed</code> and <code>rollSpeed</code> variables are now being set via the <code>UpdateRemoteConfigValues</code> function, we can now hide them from the <code>PlayerBehaviour</code> script so that the class looks as follows:<pre class="source-code">
/// &lt;summary&gt;
/// How fast the ball moves left/right
/// &lt;/summary&gt;
[HideInInspector]
public float dodgeSpeed = 5;
/// &lt;summary&gt;
/// How fast the ball moves forwards automatically
/// &lt;/summary&gt;
[HideInInspector]
public float rollSpeed = 5;</pre></li>
			</ol>
			<p>Here, we’ve<a id="_idIndexMarker670"/> modified the two properties, adding the <code>[HideInInspector]</code> tag, which will hide the item in the <strong class="bold">Inspector</strong> window. We’ve <a id="_idIndexMarker671"/>also changed the variables to use XML comments instead of tooltips, since they are no longer being displayed in the <strong class="bold">Inspector</strong> window.</p>
			<ol>
				<li value="10">Save the script and select the <strong class="bold">Player</strong> object. From there, go to the <strong class="bold">Inspector</strong> window and note that the properties are no longer visible in the <strong class="bold">PlayerBehaviour</strong> component:</li>
			</ol>
			<div><div><img src="img/B18868_11_13.jpg" alt="Figure 11.13: Values are hidden in the Inspector window"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 11.13: Values are hidden in the Inspector window</p>
			<p>Now, the values <a id="_idIndexMarker672"/>will be set through the <strong class="bold">Remote Config</strong> component, and users won’t be confused about why their values<a id="_idIndexMarker673"/> are being replaced by what’s in <strong class="bold">Player Behaviour</strong>.</p>
			<p>Being able to tweak these values while the game is live can be incredibly useful and allows you to share changes to the game without requiring your users to download a new version!</p>
			<h1 id="_idParaDest-130"><a id="_idTextAnchor346"/>Summary</h1>
			<p>In this chapter, we learned how we can use <strong class="bold">Remote Config</strong> to make adjustments to our games on the fly.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">There’s a lot more that you can do with Remote Settings. You can learn more about <strong class="bold">Remote Config</strong> and how to use it to work with non-default parameters at <a href="https://docs.unity3d.com/Manual/UnityAnalyticsRemoteSettingsComponent.html">https://docs.unity3d.com/Manual/UnityAnalyticsRemoteSettingsComponent.html</a>.</p>
			<p>With this, we have all of the implementation details of our game complete, but our game right now is pretty bare. In the next chapter, we will look into ways to make our game more polished, using features such as particle systems and screen shake.</p>
		</div>
	</body></html>