<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch11"/>Chapter 11. Rendering Web Pages</h1></div></div></div><p>In this chapter, we will cover:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Opening a web page within Safari</li><li class="listitem" style="list-style-type: disc">Rendering a web page within an app</li><li class="listitem" style="list-style-type: disc">Navigating the browsing history</li><li class="listitem" style="list-style-type: disc">Rendering a local web page</li><li class="listitem" style="list-style-type: disc">Dynamically generating a local web page</li><li class="listitem" style="list-style-type: disc">Capturing a snapshot of a web page</li></ul></div><div><div><div><div><h1 class="title"><a id="ch11lvl1sec01"/>Introduction</h1></div></div></div><p>The web has become such an integral part of our lives that even iOS apps regularly use web browser technology to perform certain tasks. This chapter will explore the HTML capabilities of AIR for iOS; from simply launching a web page within Safari, to more integrated experiences where web content is rendered directly within the app itself.</p><p>We will primarily focus on the<code class="literal"> StageWebView</code> class introduced in AIR 2.6. However, those using Flash Professional CS5 and AIR 2.0 will find the<em> Opening a web page within Safari</em> recipe of use.<a id="id906" class="indexterm"/>
</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch11lvl1sec02"/>Opening a web page within Safari</h1></div></div></div><p>AIR for iOS makes it possible to display web pages to the user. For many situations, the simplest solution is to launch Safari (the device's native web browser) from your app. Many applications take this approach and once the user is finished with the page, they can move back to their app using the app switcher.<a id="id907" class="indexterm"/>
</p><p>Let us see how to load a web page into Safari from an AIR for iOS app.</p><div><div><div><div><h2 class="title"><a id="ch11lvl2sec01"/>Getting ready</h2></div></div></div><p>From the book's accompanying code bundle, open<code class="literal"> chapter11\recipe1\recipe.fla</code> into Flash Professional and use it as a starting point.<a id="id908" class="indexterm"/>
</p><p>Sitting on the stage is a movie clip with an instance name of<code class="literal"> twitterBtn</code>. The movie clip's library symbol is linked to a class named<code class="literal"> Button</code>, which was introduced in the<em> Handling user interaction</em> recipe from<a class="link" href="ch04.html" title="Chapter 4. Porting Flash Projects to iOS"> Chapter 4</a>.</p><p>Let us write some ActionScript to load<a class="ulink" href="http://www.twitter.com"> www.twitter.com</a> into Safari when the button is pressed.</p></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec02"/>How to do it...</h2></div></div></div><p>We will utilize the package-level<code class="literal"> navigateToURL()</code> function to launch Safari. Carry out the following steps:<a id="id909" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem">Create a new document class and name it<code class="literal"> Main</code>.</li><li class="listitem">Add the following three import statements to the class:<div><pre class="programlisting">import flash.events.MouseEvent;
import flash.net.navigateToURL;
import flash.net.URLRequest;
</pre></div></li><li class="listitem">Within the constructor, listen for the<code class="literal"> twitterBtn</code> movie clip being pressed:<div><pre class="programlisting">public function Main() {
<strong>twitterBtn.addEventListener(MouseEvent.MOUSE_UP, pressed);
</strong>
}
</pre></div></li><li class="listitem">Now add an event listener, which launches Safari and loads Twitter's website into it:<div><pre class="programlisting">private function pressed(e:MouseEvent):void {
var url:URLRequest = new URLRequest(
"http://www.twitter.com");
navigateToURL(url);
}
</pre></div></li><li class="listitem">Save the class and name the file<code class="literal"> Main.as</code> when prompted.</li><li class="listitem">Move back to the FLA and save it too.</li><li class="listitem">Publish the FLA and test it on your device. Tapping the<strong> twitter</strong> button will launch and load<a class="ulink" href="http://www.twitter.com"> www.twitter.com</a> into Safari. If you are using iOS 4 or above, then use the app switcher to find and move back to your app.</li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec03"/>How it works...</h2></div></div></div><p>The<code class="literal"> flash.net</code> package contains a package-level function named<code class="literal"> navigateToURL()</code> that can be used to open a website directly within the Safari browser.<a id="id910" class="indexterm"/>
</p><p>It accepts as an argument, a<code class="literal"> URLRequest</code> representing the URL to be loaded:</p><div><pre class="programlisting">var url:URLRequest = new URLRequest("http://www.twitter.com");
</pre></div><p>Once the request has been created, Safari can be launched and the requested URL loaded:</p><div><pre class="programlisting">navigateToURL(url);
</pre></div><p>The<code class="literal"> http</code> URI scheme within the requested URL is important. The<code class="literal"> navigateToURL()</code> function can be used to launch many external iOS applications, with Safari being just one of them. By prefixing the URL with<code class="literal"> http://</code>, AIR knows to launch Safari.</p><p>In addition, being a package-level function,<code class="literal"> navigateToURL()</code> must be explicitly added to your class' list of import statements:</p><div><pre class="programlisting">import flash.net.navigateToURL;
</pre></div><p>Your application will be suspended and moved to the background when Safari is launched from a device running iOS 4 or above. When the user is finished with the web page, it will be their responsibility to resume your app by selecting it from the home screen or app switcher. Launching Safari from an iOS 3 device, however, will close your app rather than suspend it—multitasking was not introduced until iOS 4. If you plan to support iOS 3, then save your app's state before launching Safari.<a id="id911" class="indexterm"/>
</p><p>For more information, perform a search for<code class="literal"> flash.net.navigateToURL</code> and<code class="literal"> flash.net.URLRequest</code> within Adobe Community Help.</p></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec04"/>See also</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><em>Rendering a web page within an app</em><a id="id912" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><em>Handling multitasking, <a class="link" href="ch03.html" title="Chapter 3. Writing your First App">Chapter 3</a></em></li><li class="listitem" style="list-style-type: disc"><em>Exiting gracefully from an app, <a class="link" href="ch03.html" title="Chapter 3. Writing your First App">Chapter 3</a></em></li><li class="listitem" style="list-style-type: disc"><em>Saving application state, <a class="link" href="ch04.html" title="Chapter 4. Porting Flash Projects to iOS">Chapter 4</a></em></li><li class="listitem" style="list-style-type: disc"><em>Launching system applications, <a class="link" href="ch13.html" title="Chapter 13. Connectivity, Persistence, and URI Schemes">Chapter 13</a></em></li></ul></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch11lvl1sec03"/>Rendering a web page within an app</h1></div></div></div><p>Since AIR 2.6, it has been possible to load and display HTML content directly within an AIR for iOS app. This is convenient as it prevents the user from having to leave the app to view web pages. It also provides other benefits such as tighter OAuth (Open Authorization) integration, and the ability to include HTML banner ads.<a id="id913" class="indexterm"/>
</p><p>This recipe will show you how to load a remote web page directly into your app.</p><div><div><div><div><h2 class="title"><a id="ch11lvl2sec05"/>Getting ready</h2></div></div></div><p>The steps covered here are only applicable to those using Flash Professional CS5.5 and AIR 2.6 or above. The AIR 2.0 SDK does not provide an API for loading HTML within an app.<a id="id914" class="indexterm"/>
</p><p>From the book's accompanying code bundle, open<code class="literal"> chapter11\recipe2\recipe.fla</code> into Flash Professional CS5.5. The FLA's stage is empty but its AIR for iOS settings have already been applied, saving you the effort when it comes to publishing it.</p></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec06"/>How to do it...</h2></div></div></div><p>We will be taking advantage of the<code class="literal"> StageWebView</code> class to render a web page.</p><div><ol class="orderedlist"><li class="listitem">Create a document class and name it<code class="literal"> Main</code>.</li><li class="listitem">Add the following two import statements:<div><pre class="programlisting">import flash.geom.Rectangle;
import flash.media.StageWebView;
</pre></div></li><li class="listitem">Declare a<code class="literal"> StageWebView</code> member variable:<div><pre class="programlisting">private var webView:StageWebView;
</pre></div></li><li class="listitem">Within the constructor, use a<code class="literal"> StageWebView</code> instance to load a web page:<div><pre class="programlisting">public function Main() {
<strong>
webView = new StageWebView();
webView.stage = stage;
webView.viewPort = new Rectangle(
0, 0, stage.stageWidth, stage.stageHeight);
webView.loadURL("http://www.yeahbutisitflash.com");
</strong>
}
</pre></div></li><li class="listitem">Save the class and name the file<code class="literal"> Main.as</code> when prompted.</li><li class="listitem">Now publish the FLA and deploy the<code class="literal"> .ipa</code> file to your device.</li><li class="listitem">When launched, the<a class="ulink" href="http://www.yeahbutisitflash.com"> www.yeahbutisitflash.com</a> website will be loaded and displayed within your app. You will also be able to interact with the page. Try it!<a id="id915" class="indexterm"/></li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec07"/>How it works...</h2></div></div></div><p>The<code class="literal"> StageWebView</code> class allows both local and remote HTML content to be displayed within your app using iOS's native WebKit rendering engine.<a id="id916" class="indexterm"/>
</p><p>
<code class="literal">StageWebView</code> is not actually a normal display object and, therefore, cannot be added to Flash's display list. Instead it is a window that is drawn on top of your application, with items underneath being hidden from view. Unfortunately, this means you can't place display objects on top of a region being used by a<code class="literal"> StageWebView</code> object.<a id="id917" class="indexterm"/>
</p><p>When creating a<code class="literal"> StageWebView</code> object, you must attach it directly to the stage and specify a viewport for its HTML content to be rendered within. To achieve this, set its<code class="literal"> stage</code> and<code class="literal"> viewPort</code> properties respectively. A<code class="literal"> Rectangle</code> object is used to define the size and location of the viewport.</p><p>Once the<code class="literal"> StageWebView</code> object is instantiated and set up, you can load a web page by passing a URL to its<code class="literal"> loadURL()</code> method. Use a String to define the URL and prefix it with the relevant URI scheme, which for most cases will be<code class="literal"> http://</code>. Omitting the URI scheme will prevent the page from loading.<a id="id918" class="indexterm"/>
</p><p>You can hide a<code class="literal"> StageWebView</code> object from view by setting its<code class="literal"> stage</code> property to<code class="literal"> null</code>. When you are finished with a<code class="literal"> StageWebView</code> object, call its<code class="literal"> dispose()</code> method. Doing so will help the garbage collector reclaim the memory sooner.<a id="id919" class="indexterm"/>
</p><p>For more information, perform a search for<code class="literal"> flash.media.StageWebView</code> within Adobe Community Help.</p></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec08"/>There's more...</h2></div></div></div><p>The following information provides additional detail.<a id="id920" class="indexterm"/>
</p><div><div><div><div><h3 class="title"><a id="ch11lvl3sec01"/>Page load events<a id="id921" class="indexterm"/>
</h3></div></div></div><p>You can determine the success or failure of a page load request by listening for the following two events from a<code class="literal"> StageWebView</code> object:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">Event.COMPLETE:</code> The requested page and its contents have loaded</li><li class="listitem" style="list-style-type: disc"><code class="literal">ErrorEvent.ERROR:</code> An error occurred while attempting to load the page<a id="id922" class="indexterm"/></li></ul></div><p>A load error can occur for a number of reasons, one of which is the omission of the URI scheme from the URL. Details regarding a load error can be obtained from the<code class="literal"> ErrorEvent</code> object's<code class="literal"> errorID</code> and<code class="literal"> text</code> properties.<a id="id923" class="indexterm"/>
</p></div><div><div><div><div><h3 class="title"><a id="ch11lvl3sec02"/>Multiple instances</h3></div></div></div><p>Multiple<code class="literal"> StageWebView</code> objects can be created and used simultaneously; however, you only have limited control over their depth ordering. While it is not possible to dynamically change depths, the one most recently instantiated will sit above other<code class="literal"> StageWebView</code> instances. However, Adobe recommends that you avoid overlapping instances.<a id="id924" class="indexterm"/>
</p></div><div><div><div><div><h3 class="title"><a id="ch11lvl3sec03"/>Checking for support</h3></div></div></div><p>The static<code class="literal"> StageWebView.isSupported</code> property can be used to determine whether the<code class="literal"> StageWebView</code> class is supported. Although this property returns<code class="literal"> true</code> for all iOS devices, you should query it when writing cross-platform code.<a id="id925" class="indexterm"/>
</p></div><div><div><div><div><h3 class="title"><a id="ch11lvl3sec04"/>Retina web pages within a standard screen resolution</h3></div></div></div><p>On a Retina display device, a<code class="literal"> StageWebView</code> object will exploit the device's higher resolution even if the AIR for iOS app itself is set to use the standard non-Retina resolution.<a id="id926" class="indexterm"/>
</p></div><div><div><div><div><h3 class="title"><a id="ch11lvl3sec05"/>Including banner ads</h3></div></div></div><p>Many developers include HTML banner ads directly within their applications. This allows the developer to distribute an app free of charge to the user, and generate revenue from the advertisements shown within the app instead.<a id="id927" class="indexterm"/>
</p><p>The<code class="literal"> StageWebView</code> class makes it possible to display banner ads provided by services such as AdMob. Take a look at the AdMob website for more information:<a class="ulink" href="http://www.admob.com"> www.admob.com</a>.</p></div><div><div><div><div><h3 class="title"><a id="ch11lvl3sec06"/>OAuth support</h3></div></div></div><p>Third parties such as Twitter and Google permit developers access to their server-side APIs. However, many of these APIs provide access to protected data and require the use of usernames and passwords. Many of these third parties now use the OAuth protocol, which gives users access to data while protecting their account credentials.<a id="id928" class="indexterm"/>
</p><p>For example, if you intend to create an app that allows a user to sign in to Twitter, then OAuth will be required. To make the process as secure as possible, the user will actually sign in from a web page hosted by Twitter, meaning you will need to use a<code class="literal"> StageWebView</code> object as part of your client implementation.</p><p>A two-part video tutorial by Adobe Developer Evangelist, Piotr Walczyszyn is available from Adobe TV demonstrating how to use OAuth within Adobe AIR applications:<a class="ulink" href="http://tv.adobe.com/watch/adc-presents/introduction-to-oauth-for-secure-user-and-application-authorization"> http://tv.adobe.com/watch/adc-presents/introduction-to-oauth-for-secure-user-and-application-authorization</a>. For a more specific mobile example of OAuth using<code class="literal"> StageWebView</code>, take a look at this video by Adobe Platform Evangelist, Mark Doherty:<a class="ulink" href="http://www.flashmobileblog.com/2010/07/17/air2-5-stagewebview-demo-oauth-support"> www.flashmobileblog.com/2010/07/17/air2-5-stagewebview-demo-oauth-support</a>.<a id="id929" class="indexterm"/>
</p><p>An OAuth ActionScript 3.0 library is available at:<a class="ulink" href="http://code.google.com/p/oauth-as3"> http://code.google.com/p/oauth-as3</a>.</p></div></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec09"/>See also</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><em>Navigating the browsing history</em></li><li class="listitem" style="list-style-type: disc"><em>Dynamically generating a local web page</em></li><li class="listitem" style="list-style-type: disc"><em>Opening a web page within Safari</em></li><li class="listitem" style="list-style-type: disc"><em>Capturing a snapshot of a web page</em></li></ul></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch11lvl1sec04"/>Navigating the browsing history</h1></div></div></div><p>As a user browses, visited pages are stored in the browsing history stack. The<code class="literal"> StageWebView</code> class makes it possible to move through the browsing history and also detect when location changes take place.<a id="id930" class="indexterm"/>
</p><p>This recipe will take you through the necessary steps to create a simple app that allows a user to navigate their page history as they browse.</p><div><div><div><div><h2 class="title"><a id="ch11lvl2sec10"/>Getting ready</h2></div></div></div><p>You will need Flash Professional CS5.5 for this recipe.<a id="id931" class="indexterm"/>
</p><p>An FLA has been provided as a starting point. From the book's accompanying code bundle, open<code class="literal"> chapter11\recipe3\recipe.fla</code> into Flash Professional CS5.5.</p><p>Sitting on the stage are two movie clips that represent navigation buttons. We will use these to move backwards and forwards through the user's history stack. The first has an instance name of<code class="literal"> backBtn</code>, while the second is named<code class="literal"> forwardBtn</code>.</p><p>Both movie clips are linked to a base class named<code class="literal"> Button</code>. This class was introduced in the<em> Handling user interaction</em> recipe from<a class="link" href="ch04.html" title="Chapter 4. Porting Flash Projects to iOS"> Chapter 4</a>.<a id="id932" class="indexterm"/>
</p></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec11"/>How to do it...</h2></div></div></div><p>Let us make use of various methods and events related to the<code class="literal"> StageWebView</code> class by performing the following steps:<a id="id933" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem">Create a document class and name it<code class="literal"> Main</code>.</li><li class="listitem">Add the following import statements:<div><pre class="programlisting">import flash.events.MouseEvent;
import flash.events.LocationChangeEvent;
import flash.geom.Rectangle;
import flash.media.StageWebView;
</pre></div></li><li class="listitem">Declare a<code class="literal"> StageWebView</code> member variable:<div><pre class="programlisting">private var webView:StageWebView;
</pre></div></li><li class="listitem">Within the constructor, set up the button movie clips and the<code class="literal"> StageWebView</code> object:<div><pre class="programlisting">public function Main() {
<strong>
backBtn.addEventListener(MouseEvent.MOUSE_UP, prevPage);
forwardBtn.addEventListener(MouseEvent.MOUSE_UP, nextPage);
backBtn.visible = false;
forwardBtn.visible = false;
webView = new StageWebView();
webView.stage = stage;
webView.viewPort = new Rectangle(
0, 62, stage.stageWidth, stage.stageHeight-62);
webView.addEventListener(
LocationChangeEvent.LOCATION_CHANGE, locationChanged);
webView.loadURL("http://www.yeahbutisitflash.com");
</strong>
}
</pre></div></li><li class="listitem">The StageWebView object's viewport has been positioned below the buttons, and a listener has been added for any changes to its URL. The navigation buttons have been made invisible as the user's history stack will initially be empty.</li><li class="listitem">Now add a<code class="literal"> locationChanged()</code> method that handles a change to the<code class="literal"> StageWebView</code> object's URL:<a id="id934" class="indexterm"/><div><pre class="programlisting">private function locationChanged(e:LocationChangeEvent):void {
backBtn.visible = webView.isHistoryBackEnabled;
forwardBtn.visible = webView.isHistoryForwardEnabled;
}
</pre></div></li><li class="listitem">This method sets the visibility of each button depending on the user's position within the history stack. If they can't navigate further back, then backBtn will be hidden. If they can't move forward, then forwardBtn will be hidden.<a id="id935" class="indexterm"/></li><li class="listitem">Finally add methods that handle each of the buttons being pressed:<div><pre class="programlisting">private function prevPage(e:MouseEvent):void {
webView.historyBack();
backBtn.visible = webView.isHistoryBackEnabled;
}
private function nextPage(e:MouseEvent):void {
webView.historyForward();
forwardBtn.visible = webView.isHistoryForwardEnabled;
}
</pre></div></li><li class="listitem">These two methods move the user either back or forward a page within the browsing history depending on the button that was pressed. Similar to the locationChanged() method, each button's visibility is also managed by its respective handler.</li><li class="listitem">Save the class and name it<code class="literal"> Main.as</code>.</li><li class="listitem">Now publish the FLA and deploy the app to your device.</li><li class="listitem">Launch the app and select any of the hyperlinks within the website. After visiting several pages, navigate through your history by pressing the navigation buttons.</li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec12"/>How it works...</h2></div></div></div><p>As you browse, pages you visit are stored in the browsing history stack. This includes pages you navigate to through hyperlinks or those loaded programmatically using<code class="literal"> loadURL()</code>.<a id="id936" class="indexterm"/>
</p><p>The<code class="literal"> StageWebView</code> class provides methods for navigating the browsing history. Call the<code class="literal"> historyBack()</code> method to move to the previously visited page, or<code class="literal"> historyForward()</code> to move to the next page in the stack. Before making either of these calls, you need to determine if there is actually a web page to move to. The<code class="literal"> isHistoryBackEnabled</code> property returns<code class="literal"> true</code> if you are able to move back, while<code class="literal"> isHistoryForwardEnabled</code> returns<code class="literal"> true</code> if you can move forward.</p><p>Both<code class="literal"> historyBack()</code> and<code class="literal"> historyForward()</code> were called in response to the navigation buttons being pressed by the user.<a id="id937" class="indexterm"/>
</p><p>We also listened for<code class="literal"> LocationChangeEvent.LOCATION_CHANGE</code>, which is dispatched by a<code class="literal"> StageWebView</code> object when its URL has changed. Within this event's handler, both<code class="literal"> isHistoryBackEnabled</code> and<code class="literal"> isHistoryForwardEnabled</code> were queried, with the value of each used to set the visibility of<code class="literal"> backBtn</code> and<code class="literal"> forwardBtn</code>.</p><p>For more information regarding managing the browsing history, perform a search for<code class="literal"> flash.media.StageWebView</code> and<code class="literal"> flash.events.LocationChangeEvent</code> within Adobe Community Help.</p></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec13"/>There's more...</h2></div></div></div><p>Now let us talk about some other options when dealing with the browsing history.</p><div><div><div><div><h3 class="title"><a id="ch11lvl3sec07"/>Obtaining the current location</h3></div></div></div><p>You can determine the URL of the current page by querying a<code class="literal"> StageWebView</code> object's read-only<code class="literal"> location</code> property. The URL will be returned as a string.<a id="id938" class="indexterm"/>
</p></div><div><div><div><div><h3 class="title"><a id="ch11lvl3sec08"/>Stopping and reloading pages</h3></div></div></div><p>The<code class="literal"> StageWebView</code> class provides limited control over the loading of a page. A<code class="literal"> stop()</code> method is provided for halting the current page load, while the page can be reloaded by calling<code class="literal"> reload()</code>.<a id="id939" class="indexterm"/>
</p></div><div><div><div><div><h3 class="title"><a id="ch11lvl3sec09"/>Detecting when the URL is about to change</h3></div></div></div><p>In addition to<code class="literal"> LOCATION_CHANGE</code>, there is also<code class="literal"> LOCATION_CHANGING</code>, which indicates that a page's URL is about to change. The<code class="literal"> LOCATION_CHANGING</code> event is dispatched when a hyperlink is selected or script running within the page changes the URL. This event is convenient as you can stop the new URL from loading by calling the<code class="literal"> LocationChangeEvent</code> object's<code class="literal"> preventDefault()</code> method.<a id="id940" class="indexterm"/>
</p><p>To see this in action, first add the following event listener within your constructor:</p><div><pre class="programlisting">webView.addEventListener(
LocationChangeEvent.LOCATION_CHANGING, locationChanging);
</pre></div><p>Now add a handler for the event:</p><div><pre class="programlisting">private function locationChanging(e:LocationChangeEvent):void
{
e.preventDefault();
}
</pre></div><p>Publish and test the app. Your code changes will effectively block any hyperlinks that you select.<a id="id941" class="indexterm"/>
</p><p>The<code class="literal"> LOCATION_CHANGING</code> event does not fire after calls to<code class="literal"> loadURL(), loadString(), historyBack(), historyForward()</code>, or<code class="literal"> reload()</code>.</p></div></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec14"/>See also</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><em>Rendering a web page within an app</em></li></ul></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch11lvl1sec05"/>Rendering a local web page</h1></div></div></div><p>In addition to remote web pages, it is also possible to load and display local HTML files using the<code class="literal"> StageWebView</code> class.<a id="id942" class="indexterm"/>
</p><p>Let us bundle a web page with your application and load it at runtime.</p><div><div><div><div><h2 class="title"><a id="ch11lvl2sec15"/>Getting ready</h2></div></div></div><p>This recipe requires Flash Professional CS5.5 and AIR 2.6 or above.</p><p>From the book's accompanying code bundle, open<code class="literal"> chapter11\recipe4\recipe.fla</code> and use it as a starting point.</p><p>Sitting in the same location as the FLA is a folder named<code class="literal"> html</code>, which contains the HTML page that has to be loaded by your app. Using Windows Explorer or Finder, take a look at the folder's contents. Also in the<code class="literal"> index.html</code> file, you will find a PNG image and a style sheet, which are both used by the HTML.</p></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec16"/>How to do it...</h2></div></div></div><p>We will split this recipe into two parts. First we will use the AIR for iOS Settings panel to bundle the local HTML with the app. Then we will write the ActionScript required to load and render it.<a id="id943" class="indexterm"/>
</p><div><div><div><div><h3 class="title"><a id="ch11lvl3sec10"/>Bundling the HTML</h3></div></div></div><p>Let us start by bundling the HTML content with your FLA.<a id="id944" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem">Move to the AIR for iOS Settings panel by selecting<strong> File</strong> |<strong> AIR for iOS Settings</strong> from Flash's drop-down menu.</li><li class="listitem">If it isn't already selected, click on the panel's<strong> General</strong> tab.</li><li class="listitem">At the bottom of the panel is the<strong> Included files</strong> list. Click on the folder icon above the list; browse to and select<code class="literal"> chapter11\recipe4\html</code>. You will now see<strong> html</strong> listed within the<strong> Included files</strong> list.</li><li class="listitem">Now click on<strong> OK</strong> to close the<strong> AIR for iOS Settings</strong> panel.</li></ol></div></div><div><div><div><div><h3 class="title"><a id="ch11lvl3sec11"/>Loading the bundled HTML</h3></div></div></div><p>With the HTML now included with your FLA, we can focus on writing ActionScript.<a id="id945" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem">Create a new document class and name it<code class="literal"> Main</code>.</li><li class="listitem">Add the following three additional import statements to the class:<div><pre class="programlisting">import flash.geom.Rectangle;
import flash.media.StageWebView;
import flash.filesystem.File;
</pre></div></li><li class="listitem">Declare a<code class="literal"> StageWebView</code> member variable:<div><pre class="programlisting">private var webView:StageWebView;
</pre></div></li><li class="listitem">Finally, within the constructor, set up and load the local web page:<div><pre class="programlisting">public function Main() {
<strong>
var url:String = File.applicationDirectory.resolvePath(
"html/index.html").nativePath;
webView = new StageWebView();
webView.stage = stage;
webView.viewPort = new Rectangle(
0, 0, stage.stageWidth, stage.stageHeight);
webView.loadURL(url);
</strong>
}
</pre></div></li><li class="listitem">Save the class and when prompted, name the file<code class="literal"> Main.as</code>.</li><li class="listitem">Move back to your FLA and save it too.</li><li class="listitem">Now publish the FLA and test it on your device. The HTML page will load from your device's file system.</li></ol></div></div></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec17"/>How it works...</h2></div></div></div><p>Loading a web page stored locally on your device isn't too dissimilar to loading a remote page. The only extra step required is to first obtain the native path of the local HTML file that you wish to load. Passing a relative path to<code class="literal"> StageWebView.loadURL()</code> will result in<code class="literal"> ErrorEvent.ERROR</code> being dispatched.<a id="id946" class="indexterm"/>
</p><p>All iOS apps are stored in their own home directory, and the app itself can read from and write to various sub-folders that exist within it. One such sub-folder is the Application directory, which is used to store the application and any files bundled with it. This is where you will find<code class="literal"> index.html</code> and the other files associated with it.</p><p>The AIR SDK provides the<code class="literal"> flash.filesystem.File</code> class, which lets you reference commonly used directories including the Application directory. It is then possible to refine the path using the<code class="literal"> File</code> class'<code class="literal"> resolvePath()</code> method. The following line of code obtains a reference to our<code class="literal"> index.html</code> file stored within the Application directory:<a id="id947" class="indexterm"/>
</p><div><pre class="programlisting">File.applicationDirectory.resolvePath("html/index.html")
</pre></div><p>The<code class="literal"> resolvePath()</code> method returns a<code class="literal"> File</code> object. By calling its<code class="literal"> nativePath</code> property, we can obtain a string that can be passed to the<code class="literal"> StageWebView</code> object's<code class="literal"> loadURL()</code> method. The following is the complete line of code:<a id="id948" class="indexterm"/>
</p><div><pre class="programlisting">var url:String = File.applicationDirectory.resolvePath(
"html/index.html").nativePath;
</pre></div><p>As with any content you wish to bundle locally with your app, it is important that any file you include is sitting somewhere within the FLA's root folder.</p><p>For more information, perform a search for<code class="literal"> flash.filesystem.File</code> and<code class="literal"> flash.media.StageWebView</code> within Adobe Community Help.</p></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec18"/>There's more...</h2></div></div></div><p>Web pages rendered within a<code class="literal"> StageWebView</code> instance don't have to live in perfect isolation from your app.<a id="id949" class="indexterm"/>
</p><div><div><div><div><h3 class="title"><a id="ch11lvl3sec12"/>Bi-directional ActionScript/JavaScript communication</h3></div></div></div><p>Although limited, it is possible to perform bi-directional ActionScript/JavaScript communication using the<code class="literal"> StageWebView</code> class. Doing so allows data to be passed between your app and an HTML page rendered within a<code class="literal"> StageWebView</code> instance.<a id="id950" class="indexterm"/>
</p><p>Documentation outlining the process involved can be found on the personal blog of Adobe developer, Sean Voisen:<a class="ulink" href="http://sean.voisen.org/blog/2010/10/making-the-most-of-stagewebview"> http://sean.voisen.org/blog/2010/10/making-the-most-of-stagewebview</a>.</p></div></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec19"/>See also</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><em>Rendering a web page within an app</em></li><li class="listitem" style="list-style-type: disc"><em>Dynamically generating a local web page</em></li><li class="listitem" style="list-style-type: disc"><em>Referencing an app's common directories, <a class="link" href="ch13.html" title="Chapter 13. Connectivity, Persistence, and URI Schemes">Chapter 13</a></em></li></ul></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch11lvl1sec06"/>Dynamically generating a local web page</h1></div></div></div><p>We have covered how to display both remote and local web pages using the<code class="literal"> StageWebView</code> class. It is also possible to generate HTML on the fly and render it directly within your iOS app.<a id="id951" class="indexterm"/>
</p><p>Let us see how this is done by dynamically creating a web page that makes use of a PNG image and a style sheet.</p><div><div><div><div><h2 class="title"><a id="ch11lvl2sec20"/>Getting ready</h2></div></div></div><p>The steps covered here are only applicable to those using Flash Professional CS5.5 and at least version 2.6 of the AIR SDK. AIR 2.0 does not support the<code class="literal"> StageWebView</code> class.</p><p>We will require the use of the<strong> as3corelib</strong> API. It is a library of invaluable ActionScript 3.0 classes and utilities for all kinds of things including hashing, image encoding, and string manipulation. For this recipe, we will use the library's PNG encoder.<a id="id952" class="indexterm"/>
</p><p>The as3corelib API is available from GitHub at:<a class="ulink" href="http://github.com/mikechambers/as3corelib"> http://github.com/mikechambers/as3corelib</a>. Click on the page's<strong> Downloads</strong> link and select<strong> as3corelib-.93.zip</strong> from the<strong> Download Packages</strong> section. Extract the<code class="literal"> .zip</code> file to your Documents folder at:<code class="literal"> packt\flash-ios-cookbook\</code>.</p><div><h3 class="title"><a id="note47"/>Note</h3><p>If you are using Windows, then the location of your Documents folder depends on the version of Windows you are running. For Windows Vista and Windows 7 it can be found at:<code class="literal"> C:\Users\&lt;username&gt;\Documents\</code>. If you are using Windows XP, then it is at:<code class="literal"> C:\Documents and Settings\&lt;username&gt;\My Documents\</code>.</p></div><p>Now open<code class="literal"> chapter11\recipe5\recipe.fla</code> from the book's accompanying code bundle into Flash Professional CS5.5. Sitting within the Library panel is a PNG image that has a linkage name of<code class="literal"> Image</code> assigned to it. We will include this image within our web page. For the remainder of this recipe, we will work from this FLA.</p></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec21"/>How to do it...</h2></div></div></div><p>This recipe is broken into two main steps. We will start by linking the as3corelib API to our FLA. Once that is done, we will make use of the API to write the ActionScript that generates the page.<a id="id953" class="indexterm"/>
</p><div><div><div><div><h3 class="title"><a id="ch11lvl3sec13"/>Linking to the as3corelib API</h3></div></div></div><p>The as3corelib API comes in the form of a<code class="literal"> .swc</code> file that must be statically linked to your FLA.<a id="id954" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem">Select<strong> File</strong> |<strong> ActionScript Settings</strong> from Flash Professional's drop-down menu. This will open the<strong> Advanced ActionScript 3.0 Settings</strong> panel where you can add the SWC.<div><img src="img/1383_11_01.jpg" alt="Linking to the as3corelib API"/></div></li><li class="listitem">Select the<strong> Library path</strong> tab, then click on the<strong> Add New Path</strong> icon, which is represented by a<strong> +</strong> symbol.</li><li class="listitem">Now click on the<strong> Browse to SWC file</strong> icon and select the following file from your Documents folder:<code class="literal"> packt\flash-ios-cookbook\as3corelib-.93\as3corelib-.93\lib\as3corelib.swc</code>. It will be added to a list of SWC files to be included with your app when published. Expand its entry by clicking on the icon to the left of its path and ensure that its<strong> Link Type</strong> is set to<strong> Merged into code</strong>.<a id="id955" class="indexterm"/></li><li class="listitem">Close the<strong> Advanced ActionScript 3.0 Settings</strong> panel by clicking on the<strong> OK</strong> button at the bottom.</li></ol></div></div><div><div><div><div><h3 class="title"><a id="ch11lvl3sec14"/>Generating the HTML</h3></div></div></div><p>With the SWC linked to your FLA, you can now use the API it provides. Let us write some ActionScript to generate an HTML file and display it.<a id="id956" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem">Start by creating a document class and naming it<code class="literal"> Main</code>.</li><li class="listitem">Add the following import statements, including as3corelib's PNG encoder class:<div><pre class="programlisting">import flash.display.BitmapData;
import flash.filesystem.File;
import flash.filesystem.FileStream;
import flash.filesystem.FileMode;
import flash.geom.Rectangle;
import flash.media.StageWebView;
import flash.utils.ByteArray;
import com.adobe.images.PNGEncoder;
</pre></div></li><li class="listitem">Declare a<code class="literal"> StageWebView</code> member variable:<div><pre class="programlisting">private var webView:StageWebView;
</pre></div></li><li class="listitem">Within the class' constructor, call methods that will create the HTML page and load it into a<code class="literal"> StageWebView</code> object:<div><pre class="programlisting">public function Main() {
<strong>
createHtml();
loadHtml();
</strong>
}
</pre></div></li><li class="listitem">Now add the method which creates the HTML page, including the style sheet and PNG image that is used by it:<div><pre class="programlisting">private function createHtml():void {
var cssString:String = "body" +
"{ padding:0px; border:0px; margin:0px; " +
"background-color:#cdc0af }";
var htmlString:String = "&lt;!DOCTYPE HTML&gt;" +
"&lt;html&gt;" +
"&lt;head&gt;" +
"&lt;link rel='stylesheet' type='text/css' " +
"href='styles.css' /&gt;" +
"&lt;meta name='viewport' " +
"content='width=device-width; " +
"height=device-height; initial-scale=1.0; " +
"maximum-scale=1.0; user-scalable=0;' /&gt;" +
"&lt;/head&gt;" +
"&lt;body&gt;" +
"&lt;img src='image.png' /&gt;" +
"&lt;/body&gt;" +
"&lt;/html&gt;";
var image:BitmapData = new Image();
writeFile(htmlString, "index.html");
writeFile(cssString, "styles.css");
writePng(image, "image.png");
}
</pre></div></li><li class="listitem">The<code class="literal"> createHtml()</code> method calls two support methods—writeFile() and<code class="literal"> writePng()</code>. Add both to the class:<a id="id957" class="indexterm"/><div><pre class="programlisting">private function writeFile(text:String, name:String):void {
var file:File = File.documentsDirectory.resolvePath(name);
var stream:FileStream = new FileStream();
stream.open(file, FileMode.WRITE);
stream.writeUTFBytes(text);
stream.close();
}
private function writePng(bd:BitmapData, name:String):void {
var pngBytes:ByteArray = PNGEncoder.encode(bd);
var file:File = File.documentsDirectory.resolvePath(name);
var stream:FileStream = new FileStream();
stream.open(file, FileMode.WRITE);
stream.writeBytes(pngBytes);
stream.close();
}
</pre></div></li><li class="listitem">Finally, add the method which loads and displays the generated HTML page:<div><pre class="programlisting">private function loadHtml():void {
var url:String = File.documentsDirectory.resolvePath(
"index.html").nativePath;
webView = new StageWebView();
webView.stage = stage;
webView.viewPort = new Rectangle(
0, 0, stage.stageWidth, stage.stageHeight);
webView.loadURL(url);
}
</pre></div></li><li class="listitem">Save the class and, when prompted, name the file<code class="literal"> Main.as</code>.<a id="id958" class="indexterm"/></li><li class="listitem">Move back to your FLA and save it too.</li><li class="listitem">Now publish the FLA and test it on your device. The app will dynamically generate the HTML page and display it on the screen.</li></ol></div></div></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec22"/>How it works...</h2></div></div></div><p>This recipe has made heavy use of Flash's<code class="literal"> File</code> and<code class="literal"> FileStream</code> classes. When creating an HTML page on the fly, the generated HTML must first be written to the device's file system before being loaded by a<code class="literal"> StageWebView</code> instance. Any local resources used by the HTML, such as style sheets and images, must also be written to the file system and match the relative paths used by the HTML.<a id="id959" class="indexterm"/>
</p><p>Within the<code class="literal"> createHtml()</code> method, we declared and initialized a string that contained our HTML. The following is the generated HTML:<a id="id960" class="indexterm"/>
</p><div><pre class="programlisting">&lt;html&gt;
&lt;head&gt;
&lt;link rel='stylesheet' type='text/css' href='styles.css' /&gt;
&lt;meta name='viewport' content='width=device-width;
height=device-height; initial-scale=1.0;
maximum-scale=1.0; user-scalable=0;' /&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;img src='image.png' /&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></div><p>Notice that it references a local style sheet named<code class="literal"> styles.css</code> and an image named<code class="literal"> image.png</code>. The image is the PNG from the FLA's library, while a string representing the style sheet is also generated within the<code class="literal"> createHtml()</code> method.</p><p>All three—the HTML string, style sheet string, and PNG—are written to the same directory on the device's file system. This is done by our<code class="literal"> writeFile()</code> and<code class="literal"> writePng()</code> methods.</p><p>When an iOS app is installed, a few common directories are created within the app's home directory. One such directory is the Documents directory, which can be used to store application-specific data and temporary files. A reference to this directory can be obtained from the static<code class="literal"> documentsDirectory</code> property of the<code class="literal"> flash.filesystem.File</code> class. This is where we wrote our local web page to.<a id="id961" class="indexterm"/>
</p><p>The<code class="literal"> writeFile()</code> method creates a specified file within the Documents directory and writes a string of data to it. We call this method twice. First to write the HTML file and then again to write the style sheet. The file is created by using a<code class="literal"> File</code> object to declare its location, then the object is passed to the<code class="literal"> open()</code> method of a<code class="literal"> FileStream</code> object:<a id="id962" class="indexterm"/>
</p><div><pre class="programlisting">var file:File = File.documentsDirectory.resolvePath(name);
var stream:FileStream = new FileStream();
stream.open(file, FileMode.WRITE);
</pre></div><p>Once the<code class="literal"> FileStream</code> object has been opened, the actual file is written by calling<code class="literal"> writeUTFBytes()and</code> passing the string to it. A call to<code class="literal"> close()</code> is then made to end the process:<a id="id963" class="indexterm"/>
</p><div><pre class="programlisting">stream.writeUTFBytes(htmlString);
stream.close();
</pre></div><p>Writing the PNG file to the Documents directory is performed by the<code class="literal"> writePng()</code> method and isn't too dissimilar to<code class="literal"> writeHtml()</code>. First the bitmap data from the<code class="literal"> Image</code> object is encoded in PNG format using the as3corelib library's<code class="literal"> PNGEncoder</code> class:</p><div><pre class="programlisting">var pngBytes:ByteArray = PNGEncoder.encode(bd);
</pre></div><p>A<code class="literal"> FileStream</code> object is then used to write the PNG to the file system. The HTML and style sheet were both represented by a string. The PNG's data is stored within a<code class="literal"> ByteArray</code> object. Therefore, rather than using<code class="literal"> writeUTFBytes()</code>, a call to the<code class="literal"> FileStream</code> object's<code class="literal"> writeBytes()</code> method is made instead.</p><p>The final step is to create a<code class="literal"> StageWebView</code> object and load<code class="literal"> index.html</code> from the Documents directory into it. This is taken care of by the<code class="literal"> loadHtml()</code> method.</p><p>More information regarding<code class="literal"> flash.filesystem.File, flash.filesystem.FileStream</code>, and<code class="literal"> flash.utils.ByteArray</code> can be obtained from Adobe Community Help.</p></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec23"/>There's more...</h2></div></div></div><p>The following are a few more considerations when dynamically generating HTML content.<a id="id964" class="indexterm"/>
</p><div><div><div><div><h3 class="title"><a id="ch11lvl3sec15"/>Cleaning-up</h3></div></div></div><p>If you are using the app's Documents folder to store temporary files, then remember to delete them when finished. This can be done using either the<code class="literal"> File</code> class'<code class="literal"> deleteFile()</code> or<code class="literal"> deleteFileAsync()</code> method.<a id="id965" class="indexterm"/>
</p></div><div><div><div><div><h3 class="title"><a id="ch11lvl3sec16"/>Using loadString()</h3></div></div></div><p>The<code class="literal"> StageWebView</code> class has a<code class="literal"> loadString()</code> method allowing a specified HTML string to be displayed. While this approach may seem easier than the steps outlined in this recipe, HTML content displayed using<code class="literal"> loadString()</code> cannot load local resources, such as image files or style sheets.<a id="id966" class="indexterm"/>
</p></div></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec24"/>See also</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><em>Rendering a web page within an app</em><a id="id967" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><em>Rendering a local web page</em></li></ul></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch11lvl1sec07"/>Capturing a snapshot of a web page</h1></div></div></div><p>It is possible to copy the contents of a<code class="literal"> StageWebView</code> object's viewport into a bitmap.<a id="id968" class="indexterm"/>
</p><p>In this recipe, we will capture a snapshot of a web page and display a thumbnail of the bitmap below the page's viewport.</p><div><div><div><div><h2 class="title"><a id="ch11lvl2sec25"/>Getting ready</h2></div></div></div><p>The steps covered in this recipe are only applicable to those using Flash Professional CS5.5 and AIR 2.6 or above. Flash Professional CS5 and AIR 2.0 do not provide support for the<code class="literal"> StageWebView</code> class.<a id="id969" class="indexterm"/>
</p><p>From the book's accompanying code bundle, open<code class="literal"> chapter11\recipe6\recipe.fla</code> into Flash Professional CS5.5. The FLA's stage is empty but its AIR for iOS settings have already been applied.</p></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec26"/>How to do it...</h2></div></div></div><p>In addition to<code class="literal"> StageWebView</code>, we will make use of the<code class="literal"> Bitmap</code> and<code class="literal"> BitmapData</code> classes to store and display the snapshot.<a id="id970" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem">Create a new document class and name it<code class="literal"> Main</code>.</li><li class="listitem">Add the following import statements and declare a<code class="literal"> StageWebView</code> member variable:<div><pre class="programlisting">package {
<strong>
import flash.display.Bitmap;
import flash.display.BitmapData;
</strong>
import flash.display.MovieClip;
<strong>
import flash.events.Event;
import flash.geom.Rectangle;
import flash.media.StageWebView;
</strong>
public class Main extends MovieClip {
<strong>private var webView:StageWebView;
</strong>
public function Main() {
// constructor code
}
}
}
</pre></div></li><li class="listitem">Within the constructor, set up the<code class="literal"> StageWebView</code> object and listen for its web page successfully loading:<div><pre class="programlisting">public function Main() {
<strong>
webView = new StageWebView();
webView.stage = stage;
webView.viewPort = new Rectangle(
0, 0, stage.stageWidth, stage.stageWidth);
webView.addEventListener(Event.COMPLETE, loaded);
webView.loadURL("http://www.yeahbutisitflash.com");
</strong>
}
</pre></div></li><li class="listitem">Finally, add an event handler that grabs a bitmap of the loaded page and displays a thumbnail of it:<div><pre class="programlisting">private function loaded(e:Event):void {
var bd:BitmapData = new BitmapData(
webView.viewPort.width, webView.viewPort.height);
webView.drawViewPortToBitmapData(bd);
var b:Bitmap = new Bitmap(bd);
b.x = 0;
b.y = 320;
b.width = 160;
b.height = 160;
addChild(b);
}
</pre></div></li><li class="listitem">Save the class and name its file<code class="literal"> Main.as</code> when prompted.</li><li class="listitem">Move back to your FLA and save it too.</li><li class="listitem">Now publish the FLA and test it on your device. Once the web page loads, a snapshot of it will be captured and displayed as a thumbnail at the bottom-left corner of the screen.<a id="id971" class="indexterm"/></li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec27"/>How it works...</h2></div></div></div><p>The<code class="literal"> StageWebView</code> class provides<code class="literal"> drawViewPortToBitmapData()</code>, which writes the pixel data from a<code class="literal"> StageWebView</code> object's viewport into a<code class="literal"> BitmapData</code> object.<a id="id972" class="indexterm"/>
</p><p>First a<code class="literal"> BitmapData</code> object needs to be instantiated:</p><div><pre class="programlisting">var bd:BitmapData = new BitmapData(
webView.viewPort.width, webView.viewPort.height);
</pre></div><p>Then the visible portion of the viewport can be drawn to the<code class="literal"> BitmapData</code> object by calling<code class="literal"> drawViewPortToBitmapData():</code>
<a id="id973" class="indexterm"/>
</p><div><pre class="programlisting">webView.drawViewPortToBitmapData(bd);
</pre></div><p>Care must be taken to ensure that the<code class="literal"> BitmapData</code> object's dimensions match those of the viewport's. If not, then<code class="literal"> drawViewPortToBitmapData()</code> will throw an<code class="literal"> ArgumentError</code> exception. The<code class="literal"> StageWebView.viewPort</code> property returns a<code class="literal"> Rectangle</code>, which you can use to determine the viewport's width and height.<a id="id974" class="indexterm"/>
</p><p>For additional information regarding the<code class="literal"> flash.display.Bitmap</code> and<code class="literal"> flash.display.BitmapData</code> classes, refer to Adobe Community Help.</p></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec28"/>There's more...</h2></div></div></div><p>The following is one practical use for capturing a snapshot of a web page.</p><div><div><div><div><h3 class="title"><a id="ch11lvl3sec17"/>Overlaying display objects</h3></div></div></div><p>Although the<code class="literal"> StageWebView</code> object renders on top of Flash's display list, it is possible to sit display objects above your HTML content in situations where user interaction with the HTML isn't required. This is done by capturing a bitmap image of the<code class="literal"> StageWebView</code>, and replacing it with the bitmap. You can then add display objects such as buttons, panels, and menus above the bitmap representation. To hide a<code class="literal"> StageWebView</code> object from view, set its<code class="literal"> stage</code> property to<code class="literal"> null</code>.<a id="id975" class="indexterm"/>
</p></div></div><div><div><div><div><h2 class="title"><a id="ch11lvl2sec29"/>See also</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><em>Rendering a web page within an app</em></li></ul></div></div></div></body></html>