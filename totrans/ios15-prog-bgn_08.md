# *第七章*: 类、结构和枚举

在上一章中，你已经学习了如何使用函数和闭包将指令序列分组在一起。

是时候考虑如何在代码中表示复杂对象了。例如，考虑一辆车。你可以使用一个`String`常量来存储车名，以及一个`Double`变量来存储车价，但它们之间没有关联。你已经看到你可以将指令分组在一起来创建函数和闭包。在本章中，你将学习如何使用**类**和**结构**将常量和变量组合成一个单一实体，以及如何操作它们。你还将学习如何使用**枚举**将一组相关值组合在一起。

到本章结束时，你将学会如何创建和初始化一个类，从现有类创建子类，创建和初始化结构体，区分类和结构体，以及创建枚举。

本章将涵盖以下主题：

+   理解类

+   理解结构

+   理解枚举

# 技术要求

本章的Xcode游乐场位于本书代码包的`Chapter07`文件夹中，可以在此处下载：

[https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition](https://github.com/PacktPublishing/iOS-15-Programming-for-Beginners-Sixth-Edition)

查看以下视频以查看代码的实际操作：

[https://bit.ly/3HbRJTA](https://bit.ly/3HbRJTA)

如果你希望从头开始，创建一个新的游乐场，并将其命名为`Classes,StructuresAndEnumerations`。你可以一边输入一边运行本章中的所有代码。让我们从学习什么是类以及如何声明和定义它开始。

# 理解类

类对于表示复杂对象非常有用，例如：

+   公司的个别员工信息

+   在电子商务网站上出售的商品

+   为了保险目的而拥有的家庭物品

下面是一个类声明和定义的例子：

[PRE0]

每个类都有一个描述性的名称，它包含用于表示对象的变量或常量。与类关联的变量或常量称为**属性**。

一个类也可以包含执行特定任务的函数。与类关联的函数称为**方法**。

一旦你声明并定义了一个类，你就可以创建`Animal`类，你可以使用该类的实例来表示动物园中不同类型的动物。这些实例的属性值将各不相同。

重要信息

要了解更多关于类的信息，请访问：[https://docs.swift.org/swift-book/LanguageGuide/ClassesAndStructures.html](https://docs.swift.org/swift-book/LanguageGuide/ClassesAndStructures.html)。

让我们看看如何处理类。您将学习如何声明和定义类，根据类声明创建实例，并操作这些实例。您将从下一节中创建一个表示动物的类声明开始。

## 创建类声明

让我们声明并定义一个可以存储有关动物详情的类。将以下代码添加到您的游乐场中：

[PRE1]

您刚刚声明了一个非常简单的名为`Animal`的类。惯例规定，类名应以大写字母开头。此类具有存储动物名称、它发出的声音、它拥有的腿数以及它是否呼吸氧气的属性。此类还有一个`makeSound()`方法，该方法将打印的噪音输出到调试区域。

现在您已经有了`Animal`类，让我们在下一节中使用它来创建一个动物的实例。

## 创建类的实例

一旦声明并定义了一个类，您就可以创建该类的实例。现在，您将创建一个代表猫的`Animal`类的实例。请按照以下步骤操作：

1.  要创建`Animal`类的实例，列出其所有属性并调用其`makeSound()`方法，请在类声明之后输入以下内容并运行：

    [PRE2]

    您可以通过在实例名称后输入一个点，然后跟您想要的属性或方法来访问实例属性和方法。您将在调试区域看到实例属性和方法的值。由于这些值是在创建类时分配的默认值，因此`name`和`sound`包含空字符串，`numberOfLegs`包含`0`，`breathesOxygen`包含`true`，而`makeSound()`方法打印一个空字符串。

1.  让我们为此实例的属性分配一些值。按照以下所示修改您的代码：

    [PRE3]

1.  初始化器负责确保在创建类时所有实例属性都有有效的值。让我们为`Animal`类添加一个初始化器。按照以下所示修改您的类定义：

    [PRE4]

1.  在这一点上，您将看到一些代码错误。您需要更新您的函数调用以解决这个问题。按照以下所示修改您的代码并运行它：

    [PRE5]

结果与*步骤 2*中的相同，但您在一个指令中创建了实例并设置了其属性。太棒了！

现在有不同类型的动物，如哺乳动物、鸟类、爬行动物和鱼类。您可以创建每个类型的类，也可以基于现有类创建一个**子类**。让我们在下一节中看看如何做到这一点。

## 创建子类

一个类的子类继承了现有类的所有方法和属性。如果您愿意，还可以向其中添加额外的属性和方法。现在，您将创建`Mammal`类，它是`Animal`类的子类。请按照以下步骤操作：

1.  要声明`Mammal`类，请在`Animal`类声明之后输入以下代码：

    [PRE6]

    在类名后键入`: Animal`使`Mammal`类成为`Animal`类的子类。它具有在`Animal`类中声明的所有属性和方法，以及一个额外的属性`hasFurOrHair`。由于`Animal`类是`Mammal`类的父类，您可以将其称为`Mammal`类。

1.  按照以下所示修改创建类实例的代码，并运行它：

    [PRE7]

1.  在您的playground中所有其他代码之后输入以下代码以显示`hasFurOrHair`属性的值并运行它：

    [PRE8]

    由于`Animal`类的初始化器没有参数来分配`hasFurOrHair`的值，因此将使用默认值，并在调试区域显示`true`。

    您已经看到子类可以具有额外的属性。子类还可以具有额外的属性，子类中的方法实现可以与超类实现不同。让我们在下一节中看看如何做到这一点。

## 覆盖超类方法

到目前为止，您一直使用多个`print()`语句来显示类实例的值。您将实现一个`description()`方法来在调试区域显示所有实例属性，因此不再需要多个`print()`语句。请按照以下步骤操作：

1.  按照以下所示修改您的`Animal`类声明以实现一个`description()`方法：

    [PRE9]

1.  按照以下所示修改代码，以使用`description()`方法代替多个`print()`语句，并运行程序：

    [PRE10]

1.  您可以将`Mammal`类中`description()`方法的实现修改为显示`hasFurOrHair`属性值。将以下代码添加到您的`Mammal`类定义中并运行它：

    [PRE11]

    name: 猫 声音: 喵 拥有腿数: 4 呼吸氧气: 是 有毛或毛发: 是

    喵

    [PRE12]

`hasFurOrHair`属性的值在调试区域显示，表明您正在使用`Mammal`子类的`description()`方法实现。

你已经创建了类和子类声明，并创建了这两个类的实例。你还在两个类中添加了初始化器和方法。太棒了！让我们看看如何在下一节中声明和使用结构体。

# 理解结构体

与类一样，结构体也组合了用于表示对象和执行特定任务的属性和方法。还记得您创建的`Animal`类吗？您也可以使用结构体来完成相同的事情。不过，类和结构体之间有一些区别，您将在稍后了解更多。

下面是一个结构体声明和定义的例子：

[PRE13]

如您所见，结构体与类非常相似。它也有一个描述性的名称，可以包含属性和方法，并且您可以创建实例。

重要信息

要了解更多关于结构体的信息，请访问：[https://docs.swift.org/swift-book/LanguageGuide/ClassesAndStructures.html](https://docs.swift.org/swift-book/LanguageGuide/ClassesAndStructures.html)。

让我们看看如何处理结构。你将学习如何声明和定义结构，根据结构创建实例，并操作它们。你将从下一节创建一个表示爬行动物的结构开始。

## 创建结构声明

继续动物主题，让我们声明并定义一个可以存储爬行动物详细信息的结构。在你的游乐场中所有其他代码之后添加以下代码：

[PRE14]

正如你所见，这几乎和你之前所做的`Animal`类声明相同。结构名称通常也以大写字母开头，这个结构有属性来存储动物的名字、它发出的声音、它有多少条腿、它是否呼吸氧气，以及它是否有毛皮或毛发。这个结构还有一个方法，`makeSound()`，它会将发出的声音打印到调试区域。

现在你有了`Reptile`结构声明，让我们在下一节中使用它来创建一个代表蛇的实例。

## 创建结构的实例

与类一样，你可以从结构声明中创建实例。现在，你将创建一个`Reptile`结构实例，代表一条蛇，打印出该实例的属性值，并调用`makeSound()`方法。在你的结构声明之后输入以下代码并运行：

[PRE15]

注意，你不需要实现初始化器；结构会自动为其所有属性获取一个初始化器，称为**成员初始化器**。真方便！以下将在调试区域显示：

[PRE16]

尽管结构声明与类声明非常相似，但类和结构之间有两个区别：

+   结构不能从另一个结构继承。

+   类是**引用类型**，而结构是**值类型**。

让我们在下一节中看看值类型和引用类型之间的区别。

## 比较值类型和引用类型

类是引用类型。这意味着当你将一个类实例赋值给一个变量时，你实际上是在变量中存储原始实例的内存位置，而不是实例本身。

结构是值类型。这意味着当你将结构实例赋值给一个变量时，该实例将被复制，你对原始实例所做的任何更改都不会影响副本。

现在，你将创建一个类的实例和一个结构的实例，并观察它们之间的差异。按照以下步骤操作：

1.  你将首先创建一个包含结构实例的变量，并将其赋值给第二个变量，然后更改第二个变量中属性的值。输入以下代码并运行：

    [PRE17]

    在这个例子中，你声明了一个结构体，`SampleValueType`，它包含一个属性，`sampleProperty`。然后，你创建了该结构体的一个实例并将其赋值给变量`a`。之后，你将`a`赋值给一个新的变量`b`。接下来，你将`b`的`sampleProperty`值更改为`20`。当你打印出`a`的`sampleProperty`值时，在调试区域打印出`10`，这表明对`b`的`sampleProperty`值的任何更改都不会影响`a`的`sampleProperty`值。这是因为当你将`a`赋值给`b`时，`a`的一个副本被赋值给`b`，因此它们是完全独立的实例，不会相互影响。

1.  接下来，你将创建一个包含类实例的变量，并将其赋值给第二个变量，然后更改第二个变量的属性值。输入以下代码并运行：

    [PRE18]

在这个例子中，你声明了一个类，`SampleReferenceType`，它包含一个属性，`sampleProperty`。然后，你创建了该类的实例并将其赋值给变量`c`。之后，你将`c`赋值给一个新的变量`d`。接下来，你将`d`的`sampleProperty`值更改为`20`。当你打印出`c`的`sampleProperty`值时，在调试区域打印出`20`，这表明对`c`或`d`的任何更改都会影响相同的`SampleReferenceType`实例。

现在，问题是，你应该使用类还是结构体？让我们在下一节中探讨这个问题。

## 在类和结构体之间做出选择

你已经看到你可以使用类或结构体来表示一个复杂对象。那么，你应该使用哪一个？

建议使用结构体，除非你需要类才能实现的功能，例如子类。这实际上有助于防止由于类是引用类型而可能发生的某些微妙错误。

太棒了！现在你已经了解了类和结构体，让我们看看下一节中的**枚举**，它允许你将相关的值分组在一起。

# 理解枚举

枚举允许你将相关的值分组在一起，例如：

+   指南针方向（东、西、北、南）

+   交通灯颜色

+   彩虹的颜色

为了理解枚举为何适合这个目的，让我们考虑以下示例。

想象你正在编写交通灯的代码。你可以使用一个整型变量来表示不同的交通灯颜色，其中`0`代表红色，`1`代表黄色，`2`代表绿色，如下所示：

[PRE19]

虽然这是一种表示交通灯的可能方式，但当将`3`赋值给`trafficLightColor`时会发生什么？这将导致问题，因为`3`不代表有效的交通灯颜色。因此，如果能够将`trafficLightColor`的可能值限制为它可以显示的颜色，那就更好了。

下面是一个枚举声明的样子：

[PRE20]

每个枚举都有一个描述性的名称，其主体包含该枚举的关联值。

重要信息

要了解更多关于枚举的信息，请访问 [https://docs.swift.org/swift-book/LanguageGuide/Enumerations.html](https://docs.swift.org/swift-book/LanguageGuide/Enumerations.html)。

让我们看看如何与枚举一起工作。你将学习如何创建和操作它们。你将在下一节中创建一个表示交通灯颜色的枚举。

## 创建一个枚举

让我们创建一个枚举来表示交通灯。按照以下步骤进行：

1.  将以下代码添加到你的游乐场中并运行它：

    [PRE21]

    这创建了一个名为 `TrafficLightColor` 的枚举，它将红色、黄色和绿色值分组在一起。正如你所看到的，`trafficLightColor` 变量的值被限制为红色、黄色和绿色；设置任何其他值将生成错误。

1.  就像类和结构体一样，枚举也可以包含方法。让我们给 `TrafficLightColor` 添加一个方法。按照以下所示修改你的代码，使 `TrafficLightColor` 返回一个表示交通灯颜色的字符串，并运行它：

    [PRE22]

`description()` 方法返回一个字符串，取决于 `trafficLightColor` 的值。由于 `trafficLightColor` 的值是 `TrafficLightColor.red`，因此 `red` 将会在调试区域中显示。

你已经学会了如何创建和使用枚举来存储分组值，以及如何向它们添加方法。这章的内容到此结束。做得好！

# 摘要

在本章中，你学习了如何使用类声明复杂对象，创建类的实例，创建子类，以及重写类方法。你还学会了如何声明结构体，创建结构体的实例，并理解引用类型和值类型之间的区别。最后，你学习了如何使用枚举来表示一组特定的值。

你现在知道了如何使用类和结构体来表示复杂对象，以及如何在你的程序中使用枚举来将相关值分组在一起。

在下一章中，你将学习如何使用协议在类和结构体中指定共同特性，使用扩展扩展内置类的功能，以及处理程序中的错误。
