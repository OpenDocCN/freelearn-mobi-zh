<html><head></head><body>
		<div><h1 id="_idParaDest-47" class="chapter-number"><a id="_idTextAnchor125"/>3</h1>
			<h1 id="_idParaDest-48"><a id="_idTextAnchor126"/><a id="_idTextAnchor127"/>Mobile Input/Touch Controls</h1>
			<p>How players interact with your project is probably one of the most important things in it to get right. While player input is added for all projects, no matter what platform you are using, this is one area that can make or break your mobile game.</p>
			<p>If the controls that are implemented don’t fit the game that you’re making, or if the controls feel clunky, players will not play your game for long stretches of time. While many people consider Rockstar’s <em class="italic">Grand Theft Auto </em>series of games to work well on consoles and PC, playing the games on a mobile device provides a larger barrier of entry, due to all of the buttons on the screen and the replacement of joysticks with virtual versions that don’t provide haptic feedback in the same manner as other platforms.</p>
			<p>Mobile and tablet games that tend to do well typically have controls that are simple, finding as many ways to streamline the gameplay as possible. Many popular games require a single input, such as Dong Nguyen’s <em class="italic">Flappy Bird </em>and Ketchapp’s <em class="italic">Ballz</em>.</p>
			<p>There are various ways for games to interact with a mobile device that are different when compared to traditional games such as gestures and pinches, and we will explore a number of those in this chapter.</p>
			<p>In this chapter, we will cover the different ways that inputs will work on mobile devices. We will start with the input that is already built into our project, using the mouse, and then move on to touch events, gestures, the use of the accelerometer, and accessing information via the <code>Touch</code><strong class="bold"> </strong>class.</p>
			<p>This chapter will be split into a number of topics. It will contain a simple, step-by-step process from beginning to end. Here is the outline of our tasks:</p>
			<ul>
				<li>Using mouse input</li>
				<li>Moving via touch</li>
				<li>Using Unity Remote</li>
				<li>Implementing a gesture</li>
				<li>Scaling a player using pinches</li>
				<li>Using an accelerometer</li>
				<li>Detecting touch on game objects</li>
			</ul>
			<h1 id="_idParaDest-49"><a id="_idTextAnchor128"/>Technical requirements</h1>
			<p>This book utilizes <em class="italic">Unity 2022.1.0b16</em> and <em class="italic">Unity Hub 3.3.1</em>, but the steps should work with minimal changes in future versions of the editor. If you would like to download the exact version used in this book (and there is a new version out), you can visit Unity’s download archive at <a href="https://unity3d.com/get-unity/download/archive">https://unity3d.com/get-unity/download/archive</a>.</p>
			<p>You can also find the system requirements for Unity at <a href="https://docs.unity3d.com/2022.1/Documentation/Manual/system-requirements.html">https://docs.unity3d.com/2022.1/Documentation/Manual/system-requirements.html</a> under the <strong class="bold">Unity Editor system </strong><strong class="bold">requirements </strong>section.</p>
			<p>You can find the code files present in this chapter on GitHub at <a href="https://github.com/PacktPublishing/Unity-2022-Mobile-Game-Development-3rd-Edition/tree/main/Chapter03">https://github.com/PacktPublishing/Unity-2022-Mobile-Game-Development-3rd-Edition/tree/main/Chapter03</a>.</p>
			<h1 id="_idParaDest-50"><a id="_idTextAnchor129"/>Using mouse input</h1>
			<p>Before we dive into <a id="_idIndexMarker163"/>mobile-only solutions, I do want to point out that it is possible to write input that works on both mobile and PC by using mouse controls. Mobile devices support using mouse clicks as taps on the screen, with the position of the tap/click being the location where the finger has been pressed. This form of input provides just the position where the touch happened and indicates that a press has happened; it doesn’t give you all of the features that the mobile-only options do. We will discuss all of the features you have using mobile-specific input later on in this chapter, but I think it’s important to note how to have click events on the desktop as well. I personally use the desktop often for ease of testing on both a PC and my device, so I don’t have to deploy to a mobile device to test every single change made in a project.</p>
			<p>To use desktop-based mouse click events for the movement of a player, first, inside Unity, open up your <code>PlayerBehaviour</code> script and update the <code>FixedUpdate</code> function to the following:</p>
			<pre class="source-code">
/// &lt;summary&gt;
/// FixedUpdate is a prime place to put physics
/// calculations happening over a period of time.
/// &lt;/summary&gt;
void FixedUpdate()
{
    // Check if we're moving to the side
    var horizontalSpeed = Input.GetAxis("Horizontal") *
        dodgeSpeed;
    /* If the mouse is held down (or the screen is pressed
     * on Mobile) */
    if (Input.GetMouseButton(0))
    {
        /* Get a reference to the camera for converting
         * between spaces */
        var cam = Camera.main;
        /* Converts mouse position to a 0 to 1 range */
        var screenPos = Input.mousePosition;
        var viewPos = cam.ScreenToViewportPoint(screenPos);
        float xMove = 0;
        /* If we press the right side of the screen */
        if (viewPos.x &lt; 0.5f)
        {
            xMove = -1;
        }
        else
        {
            /* Otherwise we're on the left */
            xMove = 1;
        }
        /* Replace horizontalSpeed with our own value */
        horizontalSpeed = xMove * dodgeSpeed;
    }
    rb.AddForce(horizontalSpeed, 0, rollSpeed);
}</pre>
			<p>We have added a <a id="_idIndexMarker164"/>number of things to the preceding script. First, we check whether the mouse button had been held down or not through the use of the <code>Input.GetMouseButton</code> function. The function will return <code>true</code> if the mouse is held down, and <code>false</code> if it is not. The function takes in a parameter, which is for what mouse button we’d like to check, providing <code>0</code> for the left button, <code>1</code> for the right, and <code>2</code> for the middle button. For mobile, however, only <code>0</code> will be picked up as a click<a id="_idTextAnchor130"/>.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">For more information on the <code>Input.GetMouseButton</code> function, check out <a href="https://docs.unity3d.com/ScriptReference/Input.GetMouseButton.html">https://docs.unity3d.com/ScriptReference/Input.GetMouseButton.html</a>.</p>
			<p>We can get the position that the mouse is at by using the <code>Input.mousePosition</code> property. However, this value is given to us in screen space. What is screen space? Well, let’s first talk about<a id="_idIndexMarker165"/> how we traditionally deal with positions in Unity by making use of world space.</p>
			<h2 id="_idParaDest-51"><a id="_idTextAnchor131"/>Screen space versus world space</h2>
			<p>When dealing <a id="_idIndexMarker166"/>with positions in Unity <a id="_idIndexMarker167"/>through <a id="_idIndexMarker168"/>the <strong class="bold">Inspector </strong>window, we have the <strong class="bold">(0,0,0) </strong>point in the middle of our game’s world, which we call the origin, and then we refer to everything else based on an offset from there. We typically refer to this method of positioning as <strong class="bold">world space</strong>. Assuming that we have our camera pointing toward the origin, world space<strong class="bold"> </strong>looks like this:</p>
			<div><div><img src="img/B18868_03_01.jpg" alt="Figure 3.1 – An example of world space"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.1 – An example of world space</p>
			<p>The lines are the <em class="italic">x</em>, <em class="italic">y</em>, and <em class="italic">z </em>axes of our world. If I were to move an object to the right or left, it would move along the <em class="italic">x </em>axis positively or negatively respectively. When in school, you may have learned about using graphs and points, and world space works very much like that.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Children of parented objects use a different system in the <strong class="bold">Inspector</strong> window, in that they are given positions relative to their parents instead. This system is called <em class="italic">local space</em>.</p>
			<p>When using mouse input, Unity gives us this information in another space, <strong class="bold">screen space</strong>. In this space, the position is based on where the camera is and isn’t involved with the actual game world. This space is also just in 2D, so there’s only an <em class="italic">x </em>and <em class="italic">y </em>position, with <em class="italic">z </em>always being stuck a<a id="_idTextAnchor132"/>t <strong class="bold">0</strong>:</p>
			<div><div><img src="img/B18868_03_02.jpg" alt="Figure 3.2 – An example of screen space"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.2 – An example of screen space</p>
			<p>In the <a id="_idIndexMarker169"/>preceding case, the bottom left of <a id="_idIndexMarker170"/>the<a id="_idIndexMarker171"/> screen would be <strong class="bold">(0,0) </strong>and the top right would be <strong class="bold">(Screen.width, Screen.height)</strong>. <em class="italic">Screen.width</em><strong class="bold"> </strong>and <em class="italic">Screen.height</em><strong class="bold"> </strong>are values in Unity that will give us the screen size of the screen window in pixels.</p>
			<p>We could use these values as provided and then compare what side of the screen the player pressed, but in our case, I think it’d be better to convert the position into an easier space to work with. One such space is <a id="_idIndexMarker172"/>the <strong class="bold">viewport space</strong>, which goes from <strong class="bold">(0,0) </strong>to <strong class="bold">(1,1)</strong>:</p>
			<div><div><img src="img/B18868_03_03.jpg" alt="Figure 3.3 – An example of viewport﻿ space"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.3 – An example of viewport<a id="_idTextAnchor133"/> space</p>
			<p>Instead of searching whether our <em class="italic">x </em>position is less than half of the screen width, I can instead just check whether the value of <code>viewPos.x</code> is less than <code>0.5</code>, which is what we are doing in the preceding code. If the value is less than <code>0.5</code>, it’s on the left side of the screen, so <a id="_idIndexMarker173"/>we return <code>-1</code>; otherwise, it’s on <a id="_idIndexMarker174"/>the<a id="_idIndexMarker175"/> right side, so we give <code>1</code>.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Note that some of Unity’s functions will use <em class="italic">Vector3</em> instead of <em class="italic">Vector2</em> in order to work with 3D spaces as well.</p>
			<p>Once we know that, we can then set the horizontal speed variable to move to the left or right based on our movement.</p>
			<p>Save the script and dive back into Unity, and you will see the following:</p>
			<div><div><img src="img/B18868_03_04.jpg" alt="Figure 3.4 – The current status of the game"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.4 – The current status of the game</p>
			<p>As you can see in the preceding screenshot, we can now use either the mouse (via the <code>Input.GetMouseButton</code> function and the <code>Input.mousePosition</code> variable) or our keyboard (via the <code>GetAxis</code> function), as described previously, to move our player.</p>
			<p>This form of input works well enough for what we’re doing right now, but I’m assuming that you’ll <a id="_idIndexMarker176"/>want to know how to use the <a id="_idIndexMarker177"/>mobile <a id="_idIndexMarker178"/>device’s own way of moving, so we will go ahead and learn how to replicate the same functionality using tou<a id="_idTextAnchor134"/><a id="_idTextAnchor135"/>ch instead.</p>
			<h1 id="_idParaDest-52"><a id="_idTextAnchor136"/>Moving using touch controls</h1>
			<p>Unity’s Input <a id="_idIndexMarker179"/>engine has a property called <code>Input.touches</code>, which is an array of the <code>Touch</code> objects. The <code>Touch</code> struct contains information on the touch that occurred, with information such as the amount of pressure on the touch and how many times you tapped the screen. It also contains the position property, such as <code>Input.mousePosition</code>, that will tell you what position the tap occurred at, in pixels.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">For more information on the Touch struct, check out <a href="https://docs.unity3d.com/ScriptReference/Touch.html">https://docs.unity3d.com/ScriptReference/Touch.html</a>.</p>
			<p>Let’s look at the steps to use touch instead of mouse inputs:</p>
			<ol>
				<li>Adjust our preceding code to look something like the following:<pre class="source-code">
/// &lt;summary&gt;
/// FixedUpdate is a prime place to put physics
/// calculations happening over a period of time.
/// &lt;/summary&gt;
void FixedUpdate()
{
    // Check if we're moving to the side
    var horizontalSpeed = Input.GetAxis("Horizontal")
        * dodgeSpeed;
    /* Check if Input has registered more than 0
       touches */
    if (Input.touchCount &gt; 0)
    {
        /* Get a reference to the camera for
           converting between spaces */
        var cam = Camera.main;
        /* Store the first touch detected */
        var firstTouch = Input.touches[0];
        /* Converts mouse position to a 0 to 1 range
        */
        var screenPos = firstTouch.position;
        var viewPos =
            cam.ScreenToViewportPoint(screenPos);
        float xMove = 0;
        /* If we press the right side of the screen */
        if (viewPos.x &lt; 0.5f)
        {
            xMove = -1;
        }
        else
        {
            /* Otherwise we're on the left */
            xMove = 1;
        }
        /* Replace horizontalSpeed with our own value
        */
        horizontalSpeed = xMove * dodgeSpeed;
    }
    rb.AddForce(horizontalSpeed, 0, ro<a id="_idTextAnchor137"/>llSpeed);
}</pre></li>
			</ol>
			<p>Now, note that this code looks very similar to what we’ve written in the preceding section. With that in mind, instead of copying and pasting the appropriate code twice and making changes, as a number of starting programmers would do, we can instead take the similarities and make a function. For the <a id="_idIndexMarker180"/>differences, we can use parameters to change the value instead.</p>
			<ol>
				<li value="2">Keeping that in mind, let’s add the following function to the <code>PlayerBehaviour</code> class:<pre class="source-code">
/// &lt;summary&gt;
/// Will figure out where to move the player
/// horizontally
/// &lt;/summary&gt;
/// &lt;param name="screenPos"&gt;The position the player
/// has touched/clicked on in screen space&lt;/param&gt;
/// &lt;returns&gt;The direction to move in the x
    axis&lt;/returns&gt;
private float CalculateMovement(Vector3 screenPos)
{
    /* Get a reference to the camera for converting
     * between spaces */
    var cam = Camera.main;
    /* Converts mouse position to a 0 to 1 range */
    var viewPos =
        cam.ScreenToViewportPoint(screenPos);
    float xMove = 0;
    /* If we press the right side of the screen */
    if (viewPos.x &lt; 0.5f)
    {
        xMove = -1;
    }
    else
    {
        /* Otherwise we're on the left */
        xMove = 1;
    }
    /* Replace horizontalSpeed with our own value */
    return xMove * dodgeSpeed;
}</pre></li>
			</ol>
			<p>In the preceding <a id="_idIndexMarker181"/>code, instead of using <code>Input.mousePosition</code> or the touch position, we use a parameter for the function. Also, unlike previous functions we’ve written, this one will actually use a return value; in this case, it will give us a floating-point value. We will use this value in the <code>Update</code> function to set <code>horiztonalSpeed</code> to a new value when this function is called. Now that the function exists, we can call it when appropriate.</p>
			<ol>
				<li value="3">Now, update <a id="_idIndexMarker182"/>the <code>Update</code><strong class="bold"> </strong>function, as follows:<pre class="source-code">
/// &lt;summary&gt;
/// FixedUpdate is a prime place to put physics
/// calculations happening over a period of time.
/// &lt;/summary&gt;
void FixedUpdate()
{
    // Check if we're moving to the side
    var horizontalSpeed = Input.GetAxis("Horizontal")
        * dodgeSpeed;
    /* Check if we are running either in the Unity
       editor or in a * standalone build.*/
    #if UNITY_STANDALONE || UNITY_WEBPLAYER ||
        UNITY_EDITOR
        /* If the mouse is held down (or the screen is
           tapped * on Mobile */
        if (Input.GetMouseButton(0))
        {
            var screenPos = Input.mousePosition;
            horizontalSpeed =
                CalculateMovement(screenPos);
        }
    /* Check if we are running on a mobile device */
    #elif UNITY_IOS || UNITY_ANDROID
        // Check if Input has registered more than
        // zero touches
        if (Input.touchCount &gt; 0)
        {
            /* Store the first touch detected */
            var firstTouch = Input.touches[0];
            var screenPos = firstTouch.position;
            horizontalSpeed =
                CalculateMovement(screenPos);
        }
    #endif
    rb.AddForce(horizontalSpeed, 0, rollSpeed);
}</pre></li>
			</ol>
			<p>In the preceding<a id="_idIndexMarker183"/> example, I am using a <code>#if</code> directive based on the platform selected. Unity will automatically create <code>#define</code>, depending on what has been selected as the platform we are deploying for. What this <code>#if</code> does, along with <code>#elif</code> and <code>#endif</code>, is allow us to include or exclude code from our project based on t<a id="_idTextAnchor138"/>hese directives.</p>
			<p>In Visual Studio, note that if you’re building for iOS or Android, the code within the <code>UNITY_IOS || UNITY_ANDROID</code><strong class="bold"> </strong>section is grayed out, meaning that it won’t be called currently because we are running the game in the <em class="italic">Unity Editor</em>. However, when we export the code to our platform, the appropriate code will be used.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">To take a look at all of the other platform-dependent <code>#define</code> directives, check out <a href="https://docs.unity3d.com/Manual/PlatformDependentCompilation.html">https://docs.unity3d.com/Manual/PlatformDependentCompilation.html</a>.</p>
			<p>Making use of the aforementioned directives, we can specify the code for different versions of our project, which is vital when dealing with multi-platform development.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">In addition to Unity’s built-in <code>#define</code> directives, you can create your own by going to <strong class="bold">Edit </strong>| <strong class="bold">Project Settings </strong>| <strong class="bold">Player</strong>, scrolling down to <strong class="bold">Other Settings </strong>in the <strong class="bold">Inspector </strong>window, and changing <strong class="bold">Scripting </strong><strong class="bold">Define Symbols</strong>.</p>
			<p class="callout">This can be great for targeting specific devices or for showing certain pieces of debug information, in addition to a number of other things.</p>
			<ol>
				<li value="4">Save the<a id="_idIndexMarker184"/> script and dive back into Unity.</li>
			</ol>
			<p>Upon exporting our game to your Android device, note that the controls now work correctly using our newly created touch code. This allows us to have something that works on mobile as well as PC.</p>
			<p>We already know that we can export our game to an Android device, but there is another way that we can test our game on a device without having to do a full export. This can be done by downloading a special app, which will allow us to stream our games from our computer to our mobile device and is what we will be discussing next.</p>
			<h1 id="_idParaDest-53"><a id="_idTextAnchor139"/>Using Unity Remote</h1>
			<p>Another way to<a id="_idIndexMarker185"/> check how our game works using mobile devices is through an application that Unity has created called the <strong class="bold">Unity Remote</strong>. Created with Unity 5, it has been a while since the application has been updated, but it still works with the current version of Unity; however, it does require us to do some additional work and setup.</p>
			<h2 id="_idParaDest-54"><a id="_idTextAnchor140"/>Android setup For Unity Remote</h2>
			<p>In order to set up a <a id="_idIndexMarker186"/>phone to use Unity Remote, we will need <a id="_idIndexMarker187"/>to download the app and learn how to enable debugging mode, so in this section, we’re going to see just how to do that:</p>
			<ol>
				<li>To start, open up the <em class="italic">Google Play</em> app, and from there in the search bar, type in <code>unity remote</code>:</li>
			</ol>
			<div><div><img src="img/B18868_03_05.jpg" alt="Figure 3.5 – Searching for the Unity Remote application"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.5 – Searching for the Unity Remote application</p>
			<ol>
				<li value="2">Select the <strong class="bold">Unity Remote 5</strong> app. Afterward, you’ll be brought to the screen in order to<a id="_idIndexMarker188"/> install it, so<a id="_idIndexMarker189"/> click on the <strong class="bold">Install</strong> button and wait for it to finish downloading.</li>
			</ol>
			<div><div><img src="img/B18868_03_06.jpg" alt="Figure 3.6 – The Unity Remote 5 app page on Google Play"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.6 – The Unity Remote 5 app page on Google Play</p>
			<ol>
				<li value="3">Once it’s<a id="_idIndexMarker190"/> completed, you<a id="_idIndexMarker191"/> should see it show up on your phone, ready to be opened.</li>
			</ol>
			<div><div><img src="img/B18868_03_07.jpg" alt="Figure 3.7 – Application on your device"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.7 – Application on your device</p>
			<ol>
				<li value="4">Click on the application, and you’ll be brought to a screen that asks you whether the <a id="_idIndexMarker192"/>application is <a id="_idIndexMarker193"/>allowed to take pictures and record video. This is due to the features that your games may use, so feel free to choose whether your game can use those features.</li>
			</ol>
			<div><div><img src="img/B18868_03_08.jpg" alt="Figure 3.8 – The permissions screen"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.8 – The permissions screen</p>
			<ol>
				<li value="5">Afterward, you <a id="_idIndexMarker194"/>should <a id="_idIndexMarker195"/>see a screen that looks like this:</li>
			</ol>
			<div><div><img src="img/B18868_03_09.jpg" alt="Figure 3.9 – Running the Unity Remote 5 app"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.9 – Running the Unity Remote 5 app</p>
			<p>This is the setup screen that you should see before playing your games, but if you try to play your project<a id="_idIndexMarker196"/> right now, nothing would happen; therefore, there’s<a id="_idIndexMarker197"/> still a few things that we need to do in preparation.</p>
			<h2 id="_idParaDest-55"><a id="_idTextAnchor141"/>Enabling developer mode and debugging</h2>
			<p>To start off <a id="_idIndexMarker198"/>with, we’re going to need to change our phone<a id="_idIndexMarker199"/> to be in developer mode so that we can enable debugging:</p>
			<ol>
				<li>First, in the Unity Editor, go to the <strong class="bold">Project Settings</strong> menu and open up the<strong class="bold"> Editor</strong> section. From there, under the <strong class="bold">Unity Remote</strong> options, change <strong class="bold">Device</strong> from <strong class="bold">None</strong> to <strong class="bold">Any </strong><strong class="bold">Android Device</strong>.</li>
			</ol>
			<div><div><img src="img/B18868_03_10.jpg" alt="Figure 3.10 – Setting the Unity Remote device"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.10 – Setting the Unity Remote device</p>
			<ol>
				<li value="2">If you have not <a id="_idIndexMarker200"/>done <a id="_idIndexMarker201"/>so already, connect your phone to your PC via USB. From the <strong class="bold">Settings</strong> menu, you’ll want to select the <strong class="bold">USB accessory connected</strong> notification from your notifications.</li>
			</ol>
			<div><div><img src="img/B18868_03_11.jpg" alt="Figure 3.11 – The notifications window upon plugging in the phone to the computer"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.11 – The notifications window upon plugging in the phone to the computer</p>
			<ol>
				<li value="3">From the menu <a id="_idIndexMarker202"/>that <a id="_idIndexMarker203"/>pops up, select the <strong class="bold">USB </strong><strong class="bold">tethering</strong> option.</li>
			</ol>
			<div><div><img src="img/B18868_03_12.jpg" alt="Figure 3.12 – Changing the mode to USB tethering"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.12 – Changing the mode to USB tethering</p>
			<p>If you don’t see this on your device, you may look for the <strong class="bold">Mobile Hotspot and Tethering </strong>section of your phone or using your internet search engine of choice to see how to enable USB tethering for your device.</p>
			<ol>
				<li value="4">Then, on <a id="_idIndexMarker204"/>the <a id="_idIndexMarker205"/>device, go to <strong class="bold">Settings</strong> | <strong class="bold">About phone</strong>.</li>
				<li>Tap the <strong class="bold">Build number</strong> property seven times to enable <em class="italic">developer mode</em>.</li>
			</ol>
			<div><div><img src="img/B18868_03_13.jpg" alt="Figure 3.13 – The About phone menu on my phone"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.13 – The About phone menu on my phone</p>
			<ol>
				<li value="6">From there, go<a id="_idIndexMarker206"/> to the <strong class="bold">Developer options</strong> section. I <a id="_idIndexMarker207"/>used the <strong class="bold">Settings</strong> window’s search function to find the exact location.</li>
			</ol>
			<div><div><img src="img/B18868_03_14.jpg" alt="Figure 3.14 – The Developer options menu"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.14 – The Developer options menu</p>
			<ol>
				<li value="7">From there, scroll <a id="_idIndexMarker208"/>down and select <a id="_idIndexMarker209"/>the <strong class="bold">USB debugging</strong> option. You may see a window explaining what USB debugging is for. Click on the <strong class="bold">OK</strong> button.</li>
			</ol>
			<div><div><img src="img/B18868_03_15.jpg" alt="Figure 3.15 – Enabling USB debugging"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.15 – Enabling USB debugging</p>
			<ol>
				<li value="8">Next, you’ll have a window popup that says <strong class="bold">Allow USB debugging?.</strong> Click on the <strong class="bold">Allow</strong> button.</li>
				<li>Now, you should be able to return to the <em class="italic">Unity Remote 5</em> application. Back on your PC, click on the <strong class="bold">Play</strong> button, and you may see the computer appear to freeze for a bit, but after a short period of time, you should see your phone change<a id="_idIndexMarker210"/> to <a id="_idIndexMarker211"/>reflect the gameplay on the PC:</li>
			</ol>
			<div><div><img src="img/B18868_03_16.jpg" alt="Figure 3.16 – Unity Remote gameplay"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.16 – Unity Remote gameplay</p>
			<p>You may see some blurriness or graphical issues when playing the game on your device using Unity Remote. This is because Unity is sending an image of what the game looks like to the device to interact with; the game is not actually on the device. The quality isn’t anywhere near what the game on the actual device would be, but it does allow us to check the current state of our game on the actual device itself!</p>
			<p>The enabling of developer mode and debugging also has the benefit of allowing us to deploy our game to our device straight through the build menu, without having to install it manually. To do so, go to the <strong class="bold">Build Settings</strong> menu, and under the <strong class="bold">Run Device</strong> option, select your phone.</p>
			<div><div><img src="img/B18868_03_17.jpg" alt="Figure 3.17 – Setting a run device"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.17 – Setting a run device</p>
			<p>Now, if <a id="_idIndexMarker212"/>you<a id="_idIndexMarker213"/> select <strong class="bold">Build and Run</strong> when the game finishes, the build you should see is the game directly running upon opening your phone:</p>
			<div><div><img src="img/B18868_03_18.jpg" alt="Figure 3.18 – The game installed directly on the device"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.18 – The game installed directly on the device</p>
			<p>Now that we’ve learned how to use Unity Remote on an Android device, we can now see how we can <a id="_idIndexMarker214"/>set <a id="_idIndexMarker215"/>up Unity Remote on an iOS device.</p>
			<h2 id="_idParaDest-56"><a id="_idTextAnchor142"/>Unity Remote setup for iOS</h2>
			<p>Getting Unity <a id="_idIndexMarker216"/>Remote set up on iOS is possible on a Mac computer or a <a id="_idIndexMarker217"/>Windows computer that has <em class="italic">iTunes</em> installed. However, the steps will be similar to working with Android, aside from not needing to enable debugging. For the purpose of this section, I will be using a Mac:</p>
			<ol>
				<li>First, in the Unity Editor, go to the <strong class="bold">Project Settings</strong> menu and open up the<strong class="bold"> Editor</strong> section. From there, under the <strong class="bold">Unity Remote</strong> options, change <strong class="bold">Device</strong> from <strong class="bold">None</strong> to <strong class="bold">Any </strong><strong class="bold">iOS Device</strong>.</li>
			</ol>
			<div><div><img src="img/B18868_03_19.jpg" alt="Figure 3.19 – Selecting the Any iOS Device option"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.19 – Selecting the Any iOS Device option</p>
			<ol>
				<li value="2">Then, from your iOS device, open up the App Store and search for <code>unity remote</code>.</li>
			</ol>
			<div><div><img src="img/B18868_03_20.jpg" alt="Figure 3.20 – Searching for the Unity Remote app"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.20 – Searching for the Unity Remote app</p>
			<ol>
				<li value="3">Select the Unity Remote 5 app and install it on your device. Once it has finished installing, it <a id="_idIndexMarker218"/>should <a id="_idIndexMarker219"/>be located on your phone:</li>
			</ol>
			<div><div><img src="img/B18868_03_21.jpg" alt="Figure 3.21 – Unity Remote installed"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.21 – Unity Remote installed</p>
			<ol>
				<li value="4">Open up the app, and you should see something similar to the following, asking you <a id="_idIndexMarker220"/>whether <a id="_idIndexMarker221"/>you’d like to trust this computer. Go ahead and hit the <strong class="bold">Trust </strong>button:</li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div><div><img src="img/B18868_03_22.jpg" alt="Figure 3.22 – The Trust This Computer option"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.22 – The Trust This Computer option</p>
			<ol>
				<li value="5">From your computer, go ahead and play the game. It may take a moment, but you should see the game streaming to your device, and you can play as usual:</li>
			</ol>
			<div><div><img src="img/B18868_03_23.jpg" alt="Figure 3.23 – Footage of Unity Remote streaming our game"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.23 – Footage of Unity Remote streaming our game</p>
			<p>As noted when we built the Android version, you may see some blurriness or graphical issues when playing the game on your device using Unity Remote. This is because Unity is sending an image of what the game looks like to the device to interact with; the game is not actually on the device. The quality isn’t anywhere near what the game on the actual device would be, but it does allow us to check the current state of our game on the actual device itself!</p>
			<p>And with that, we can now play our games on our respective devices without having to do a build! This can be a great way to quickly check whether things are working correctly on your<a id="_idIndexMarker222"/> device <a id="_idIndexMarker223"/>without having to do a build every time. Now, let’s take a lo<a id="_idTextAnchor143"/>ok at some of the mobile-speci<a id="_idTextAnchor144"/>fic ways that we can interpret input.</p>
			<h1 id="_idParaDest-57"><a id="_idTextAnchor145"/>Implementing a gesture</h1>
			<p>Another type of input that <a id="_idIndexMarker224"/>you’ll find in mobile games is that of a swipe, such as in Kiloo’s <em class="italic">Subway Surfers</em>. This allows us to use the general movement of the touch to dictate a direction for us to move in. This is usually used to have our players <em class="italic">jump </em>from one position to another or move quickly in a certain direction. So, we’ll go ahead and implement that using the following steps, instead of our previous movement system:</p>
			<ol>
				<li>In the <code>PlayerBehaviour</code><strong class="bold"> </strong>script, go<a id="_idIndexMarker225"/> ahead and add some new variables for us to work with:<pre class="source-code">
[Header("Swipe Properties")]
[Tooltip("How far will the player move upon swiping")]
public float swipeMove = 2f;
[Tooltip("How far must the player swipe before we will
    execute the action (in inches)")]
public float minSwipeDistance = 0.25f;
/// &lt;summary&gt;
/// Used to hold the value that converts
/// minSwipeDistance to pixels
/// &lt;/summary&gt;
private float minSwipeDistancePixels;
/// &lt;summary&gt;
/// Stores the starting position of mobile touch
/// events
/// &lt;/summary&gt;
private Vector2 touchStart;</pre></li>
			</ol>
			<p>In order to determine whether we are swiping, we will need to first check the start and the end of our movement. We will store the starting position in the <code>touchStart</code><code>swipeMove</code><code>minSwipeDistance</code> variable, which will make sure that the player has moved on the <em class="italic">x </em>axis a little before actually making the jump – in this case, we want the user to move at least a quarter of an inch in order for the input to be counted as a swipe.</p>
			<p>Also note that the <code>Header</code> attribute has been added to the top of the first variable. This will add a header to the <strong class="bold">Inspector </strong>tab, making it easier to break apart different sections of your script. If you were to save the script and dive into Unity, you should <a id="_idIndexMarker226"/>see that this new attribute has be<a id="_idTextAnchor146"/>en added when you select the player:</p>
			<div><div><img src="img/B18868_03_24.jpg" alt="Figure 3.24 – The newly added mobile input/touch controls under Swipe Properties"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.24 – The newly added mobile input/touch controls under Swipe Properties</p>
			<p>Our next step is to convert the <code>MinSwipeDistance</code> value from inches into the pixel equivalent, which can be used to see how far the user’s swiping motion moves the player’s character.</p>
			<ol>
				<li value="2">Go back to the <code>PlayerBehaviour</code><code>Start</code><strong class="bold"> </strong>function to add the following highlighted code:<pre class="source-code">
// Start is called before the first frame update
public void Start()
{
    // Get access to our Rigidbody component
    rb = GetComponent&lt;Rigidbody&gt;();
    minSwipeDistancePixels = minSwipeDistance *
        Screen.dpi;
}</pre></li>
			</ol>
			<p>The <code>Screen.dpi</code><code>minSwipeDistance</code> by <code>Screen.dpi</code>, we know how long the movement in <a id="_idIndexMarker228"/>pixels needs to be for it to be counted as a swipe.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">For more information on the <code>Screen.dpi</code> variable, check out <a href="https://docs.unity3d.com/ScriptReference/Screen-dpi.html">https://docs.unity3d.com/ScriptReference/Screen-dpi.html</a>.</p>
			<p>Now that we know the length of a swipe, we need to add the ability to trigger one. As we mentioned before, we have been using the <code>FixedUpdate</code><code>FixedUpdate</code>, which is generally called less often than the <code>Update</code> function.</p>
			<p>We use the <code>Input.GetAxis</code> and <code>Input.GetMouseButton</code> functions, which return <code>true</code> every single frame that the button is held down and will continue to respond during <code>FixedUpdate</code><code>FixedUpdate</code> can miss the start and ending frames where input events happen, which is required for swipe events and certain actions, such as jumping, in games. If you want something to happen the moment an input starts or finishes, you will likely want to utilize the <code>Update</code> function instead, and that is what we will be doing with our gesture.</p>
			<ol>
				<li value="3">Now, back in <a id="_idIndexMarker229"/>the <code>PlayerBehaviour</code><strong class="bold"> </strong>script, add the following function to the project:<pre class="source-code">
/// &lt;summary&gt;
/// Update is called once per frame
/// &lt;/summary&gt;
private void Update()
{
    /* Check if we are running on a mobile device */
    #if UNITY_IOS || UNITY_ANDROID
        /* Check if Input has registered more than
           zero touches */
        if (Input.touchCount &gt; 0)
        {
            /* Store the first touch detected */
            Touch touch = Input.touches[0];
            Swi<a id="_idTextAnchor147"/>peTeleport(touch);
        }
    #endif
}</pre></li>
			</ol>
			<p>In the preceding code, we added a new behavior called <code>SwipeTeleport</code><code>Touch</code><strong class="bold"> </strong>event and use its properties to move the player if a swipe happens.</p>
			<p>We will then create<a id="_idIndexMarker230"/> a function to handle this new swiping behavior, as follows:</p>
			<pre class="source-code">
/// &lt;summary&gt;
/// Will teleport the player if swiped to the left or
/// right
/// &lt;/summary&gt;
/// &lt;param name="touch"&gt;Current touch event&lt;/param&gt;
private void SwipeTeleport(Touch touch)
{
    /* Check if the touch just started */
    if (touch.phase == TouchPhase.Began)
    {
        /* If so, set touchStart */
        touchStart = touch.position;
    }
    /* If the touch has ended */
    else if (touch.phase == TouchPhase.Ended)
    {
        /* Get the position the touch ended at */
        Vector2 touchEnd = touch.position;
        /* Calculate the difference between the
           beginning and end of the touch on the x
           axis. */
        float x = touchEnd.x - touchStart.x;
        /* If not moving far enough, don't do the
           teleport */
        if (Mathf.Abs(x) &lt; minSwipeDistancePixels)
        {
            return;
        }
        Vector3 moveDirection;
        /* If moved negatively in the x axis, move
           left */
        if (x &lt; 0)
        {
            moveDirection = Vector3.left;
        }
        else
        {
            /* Otherwise player is on the right */
            moveDirection = Vector3.right;
        }
        RaycastHit hit;
        /* Only move if player wouldn't hit something
        */
        if (!rb.SweepTest(moveDirection, out hit,
        swipeMove))
        {
            /* Move the player */
            var movement = moveDirection * swipeMove;
            var newPos = rb.position + movement;
            rb.MovePosition(newPos);
        }
    }
}</pre>
			<p>In this function, instead<a id="_idIndexMarker231"/> of just using the current touch position, we instead store the starting position when the touch begins. When the player lifts their finger, we get the position as well. We then get the direction of that movement and then apply it to the ball, checking whether we’ll collide with something before actually causing the movement.</p>
			<ol>
				<li value="4">Save your script and dive back into Unity, exporting your project to your mobile device or an emulator.</li>
			</ol>
			<div><div><img src="img/B18868_03_25.jpg" alt="Figure 3.25 – A visual of the game after performing a swipe"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.25 – A visual of the game after performing a swipe</p>
			<p>Now, whenever we swipe to the left or right, the player will move accordingly. Let’s learn about another<a id="_idIndexMarker232"/> action that we can use<a id="_idTextAnchor148"/><a id="_idTextAnchor149"/> while playing the game in the next section.</p>
			<h1 id="_idParaDest-58"><a id="_idTextAnchor150"/>Scaling the player using pinches</h1>
			<p>The concept of <a id="_idIndexMarker233"/>using<a id="_idIndexMarker234"/> touch events to modify things in the game can also be applied to other methods of touch interaction, such as using finger pinches to zoom in and out. To see how to do this, let’s adjust the <code>PlayerBehaviour</code><strong class="bold"> </strong>script so that we can change the player’s scale, using two fingers to pinch or stretch out the view:</p>
			<ol>
				<li>Open up the <code>PlayerBehaviour</code><strong class="bold"> </strong>script and add the following properties:<pre class="source-code">
[Header("Scaling Properties")]
[Tooltip("The minimum size (in Unity units) that the
    player should be")]
public float minScale = 0.5f;
[Tooltip("The maximum size (in Unity units) that the
    player should be")]
public float maxScale = 3.0f;
/// &lt;summary&gt;
/// The current scale of the player
/// &lt;/summary&gt;
private float currentScale = 1;</pre></li>
				<li>Next, add<a id="_idIndexMarker235"/> the<a id="_idIndexMarker236"/> following function:<pre class="source-code">
/// &lt;summary&gt;
/// Will change the player's scale via pinching and
/// stretching two touch events
/// &lt;/summary&gt;
private void ScalePlayer()
{
    /* We must have two touches to check if we are
     * scaling the object */
    if (Input.touchCount != 2)
    {
        return;
    }
    else
    {
        /* Store the touches detected. */
        Touch touch0 = Input.touches[0];
        Touch touch1 = Input.touches[1];
        Vector2 t0Pos = touch0.position;
        Vector2 t0Delta = touch0.deltaPosition;
        Vector2 t1Pos = touch1.position;
        Vector2 t1Delta = touch1.deltaPosition;
        /* Find the previous frame position of each
           touch. */
        Vector2 t0Prev = t0Pos - t0Delta;
        Vector2 t1Prev = t1Pos - t1Delta;
        /* Find the the distance (or magnitude)
           between the * touches in each frame. */
        float prevTDeltaMag =
            (t0Prev - t1Prev).magnitude;
        float tDeltaMag = (t0Pos - t1Pos).magnitude;
        /* Find the difference in the distances
         * between each frame. */
        float deltaMagDiff =
            prevTDeltaMag - tDeltaMag;
        /* Keep the change consistent no matter what
         * the framerate is */
        float newScale = currentScale;
        newScale -= (deltaMagDiff * Time.deltaTime);
        // Ensure that the new value is valid
        newScale = Mathf.Clamp(newScale, minScale,
            maxScale);
        /* Update the player's scale */
        transform.localScale = Vector3.one * newScale;
        /* Set our current scale for the next frame */
        currentScale = newScale;
    }
}</pre></li>
			</ol>
			<p>Instead of using a<a id="_idIndexMarker237"/> single<a id="_idIndexMarker238"/> touch event, in this example, we are using two. Using both touch events, we can see how the touches have changed over the course of the previous frame (the delta). We then use that difference to modify the scale of the player. To ensure the ball will always have a valid value, we use the <code>Mathf.Clamp</code> function to keep the values between what is set in <code>minScale</code><code>maxScale</code>.</p>
			<ol>
				<li value="3">Next, we need to call<a id="_idIndexMarker239"/> the<a id="_idIndexMarker240"/> function by updating the <code>Update</code><strong class="bold"> </strong>function:<pre class="source-code">
/// &lt;summary&gt;
/// Update is called once per frame
/// &lt;/summary&gt;
private void Update()
{
    /* Check if we are running on a mobile device */
    #if UNITY_IOS || UNITY_ANDROID
        /* Check if Input has registered more than
           zero touches */
        if (Input.touchCount &gt; 0)
        {
            /* Store the first touch detected */
            Touch touch = Input.touches[0];
            SwipeTeleport(touch);
            <strong class="bold">ScalePlayer();</strong>
        }
    #endif
}</pre></li>
				<li>Save your script and return to the Unity editor. Export your game, and you should be able to see the player scaling in action – by moving two fingers apart, you’ll see the ball expand, and vice versa:</li>
			</ol>
			<div><div><img src="img/B18868_03_26.jpg" alt="Figure 3.26 – The result of our pinch gesture in the current state of the game"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.26 – The result of our pinch gesture in the current state of the game</p>
			<p class="callout-heading">Note</p>
			<p class="callout">For those using LDPlayer, it is possible to replicate a pinch/zoom effect by pressing <em class="italic">Ctrl</em> and then scrolling the mouse wheel.</p>
			<p>Hopefully, this demonstrates <a id="_idIndexMarker241"/>the<a id="_idIndexMarker242"/> power given by being able to use multi-touch and some of the advantages of utilizing touch events, instead of just a single mouse click. Next, we will expl<a id="_idTextAnchor151"/><a id="_idTextAnchor152"/>ore another type of input method that PCs don’t have.</p>
			<h1 id="_idParaDest-59"><a id="_idTextAnchor153"/>Using the accelerometer</h1>
			<p>Another type of input<a id="_idIndexMarker243"/> that mobile has, but PC doesn’t, is the accelerometer. This allows you to move in the game by tilting the physical position of the phone. The most popular example of this is likely the movement of the player in games such as Lima Sky’s <em class="italic">Doodle Jump</em> and Gameloft’s <em class="italic">Asphalt</em> series. To do something similar, we can retrieve the acceleration of our device with the <code>Input.acceleration</code> property and use it to move the player. Let’s look at the steps to do just that:</p>
			<ol>
				<li>We may want to allow our designers to set whether they want to use the <code>Accelerometer</code> mode or <code>ScreenTouch</code>, which we used previously. With that in mind, let’s create a new <code>enum</code><code>PlayerBehaviour</code><strong class="bold"> </strong>script above the <strong class="bold">Swipe </strong><strong class="bold">Properties </strong>header:<pre class="source-code">
[Tooltip("How fast the ball moves forwards
    automatically")]
[Range(0, 10)]
public float rollSpeed = 5;
public enum MobileHorizMovement
{
    Accelerometer,
    ScreenTouch
}
[Tooltip("What horizontal movement type should be
    used")]
public MobileHorizMovement horizMovement =
    MobileHorizMovement.Accelerometer;
[Header("Swipe Properties")]
[Tooltip("How far will the player move upon swiping")]
public float swipeMove = 2f;</pre></li>
			</ol>
			<p>The preceding script utilizes <code>enum</code> to define a custom type called <code>MobileHorizMovement</code>, which can be one of two values, <code>Accelerometer</code><code>ScreenTouch</code>. We then create a variable of this new type called <code>horizMovement</code>.</p>
			<p>Now, if you save the <code>PlayerBehaviour</code> script and dive back into the <strong class="bold">Inspector </strong>tab, you will see we can select one of these two options (<strong class="bold">Accelerometer </strong>or <strong class="bold">Screen Touch</strong>). By using this drop-down menu, the game designer of the project can easily select which of the two options we’d like to use, and then <a id="_idIndexMarker244"/>we can expand to even more if want to in the future (which we will in the next chapter):</p>
			<div><div><img src="img/B18868_03_27.jpg" alt="Figure 3.27 – Adjusting the Horiz Movement property from the Inspector"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.27 – Adjusting the Horiz Movement property from the Inspector</p>
			<ol>
				<li value="2">Next, let’s update the <code>Update</code><code>#elif UNITY_IOS || UNITY_ANDROID</code> block of code:<pre class="source-code">
/* Check if we are running on a mobile device */
#elif UNITY_IOS || UNITY_ANDROID
    switch (horizMovement)
    {
        case MobileHorizMovement.Accelerometer:
            /* Move player based on accelerometer
               direction */
            horizontalSpeed = Input.acceleration.x *
                dodgeSpeed;
            break;
        case MobileHorizMovement.ScreenTouch:
            /* Check if Input registered more than
               zero touches */
            if (Input.touchCount &gt; 0)
            {
                /* Store the first touch detected */
                var firstTouch = Input.touches[0];
                var screenPos = firstTouch.position;
                horizontalSpeed =
                    CalculateMovement(screenPos);
            }
            break;
    }
#endif
// Check if we are running on a mobile device
#elif UNITY_IOS || UNITY_ANDROID
if(horizMovement == MobileHorizMovement.Accelerometer)
{
// Move player based on direction of the accelerometer
horizontalSpeed = Input.acceleration.x * dodgeSpeed;
}
//Check if Input has registered more than zero touches if (Input.touchCount &gt; 0)
{
    if (horizMovement ==
    MobileHorizMovement.ScreenTouch)
    {
        //Store the first touch detected.
        Touch touch = Input.touches[0];
        horizontalSpeed =
            CalculateMovement(touch.position);
    }
}
#endif</pre></li>
			</ol>
			<p>If the <code>horizMovement</code> variable is <a id="_idIndexMarker245"/>set to <strong class="bold">Accelerometer</strong>, this new snippet of code will use the acceleration of our device instead of touches detected on the screen.</p>
			<ol>
				<li value="3">Save your script and export the project.</li>
			</ol>
			<div><div><img src="img/B18868_03_28.jpg" alt="Figure 3.28 – Moving the player via the accelerometer"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.28 – Moving the player via the accelerometer</p>
			<p>With that, you’ll note that we can now tilt our screen to the right or left, <a id="_idTextAnchor154"/>and the player will move in the appropriate direction.</p>
			<p>In Unity, acceleration is measured in <em class="italic">g</em>-force values, with 1 being 1 g of force. If you hold the device upright (with the<a id="_idIndexMarker246"/> home button at the bottom) in front of you, the <em class="italic">x </em>axis is positive along the right, the <em class="italic">y </em>axis is positive upward, and the <em class="italic">z </em>axis is positive when pointing toward you.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">For more information on the accelerometer, check out <a href="https://docs.unity3d.com/Manual/MobileInput.html">https://docs.unity3d.com/Manual/MobileInput.html</a>.</p>
			<p>It’s great to know that our regular input is working, but you may want to check whether a game object in our scene has been<a id="_idTextAnchor155"/> touche<a id="_idTextAnchor156"/>d so that the game can react to it. Let’s do that next.</p>
			<h1 id="_idParaDest-60"><a id="_idTextAnchor157"/>Detecting touch on game objects</h1>
			<p>To add <a id="_idIndexMarker247"/>something else for our player to do, as well as to<a id="_idIndexMarker248"/> demonstrate some additional input functionality, we’ll ensure that if the player taps an obstacle, it will be destroyed. We will use the following steps to modify our existing code to add this new functionality, utilizing the<a id="_idIndexMarker249"/> concept of <strong class="bold">raycasts</strong>:</p>
			<ol>
				<li>In the <code>PlayerBehaviour</code><strong class="bold"> </strong>script, add the following new function:<pre class="source-code">
/// &lt;summary&gt;
/// Will determine if we are touching a game object
/// and if so call events for it
/// &lt;/summary&gt;
/// &lt;param name="screenPos"&gt;The position of the touch
/// in screen space&lt;/param&gt;
private static void TouchObjects(Vector2 screenPos)
{
    /* Convert the position into a ray */
    Ray touchRay =
        Camera.main.ScreenPointToRay(screenPos);
    RaycastHit hit;
    /* Create a LayerMask that will collide with all
     * possible channels */
    int layerMask = ~0;
    /* Are we touching an object with a collider? */
    if (Physics.Raycast(touchRay, out hit,
    Mathf.Infinity, layerMask,
    QueryTriggerInteraction.Ignore))
    {
        /* Call the PlayerTouch function if it exists
         * on a component attached to this object */
        hit.transform.SendMessage("PlayerTouch",
        SendMessageOptions.DontRequireReceiver);
    }
}
/// &lt;summary&gt;
/// Will determine if we are touching a game object
/// and if so call events for it
/// &lt;/summary&gt;
/// &lt;param name="touch"&gt;Our touch event&lt;/param&gt; private static void TouchObjects(Touch touch)
{
// Convert the position into a ray
Ray touchRay =
    Camera.main.ScreenPointToRay(touch.position);
RaycastHit hit;
// Create a LayerMask that will collide with all
// possible channels
int layerMask = ~0;
// Are we touching an object with a collider?
if (Physics.Raycast(touchRay, out hit, Mathf.Infinity, layerMask, QueryTriggerInteraction.Ignore)<a id="_idTextAnchor158"/>)
{
    // Call the PlayerTouch function if it exists on a
    // component attached to this object
    hit.transform.SendMessage("PlayerTouch",
        SendMessageOptions.DontRequireReceiver);
}
}</pre></li>
			</ol>
			<p>Here, we use a different version to determine collisions – a <code>raycast</code>. This<strong class="bold"> </strong>is basically an <a id="_idIndexMarker250"/>invisible<a id="_idIndexMarker251"/> vector leading in a given direction, and we will use it to check whether it collides with any object inside of our scenes. This is often used in games, such as first-person shooters, to determine whether a player has hit an enemy or not without spawning a projectile and moving it there.</p>
			<p>The version of <code>Physics.Raycast</code><strong class="bold"> </strong>that we use here takes in five parameters:</p>
			<ul>
				<li>The first specifies what ray to use.</li>
				<li>The second is <code>hit</code>, which holds information about the collision if it occurred.</li>
				<li>The third parameter specifies how far to check for a collision.</li>
				<li>The fourth is a layer mask, which dictates with which objects you can collide. In our case, we want to collide with all colliders, so we use the bit-wise complement operator (<code>~</code>) to change <code>0</code> into the number possible by flipping all the bits used to create the number.</li>
				<li>Lastly, we have an enumeration called <code>QueryTriggerInteraction</code>, which we set to <code>Ignore</code>. This means that the <code>Tile End</code><strong class="bold"> </strong>objects with the triggers that we created in <a href="B18868_01.xhtml#_idTextAnchor015"><em class="italic">Chapter 1</em></a>,<em class="italic"> Building Your Game</em>,<em class="italic"> </em>will not block our touch events, which would happen by default even if we couldn’t see them.</li>
			</ul>
			<p class="callout-heading">Note</p>
			<p class="callout">For more information on the bitwise complement operator (<code>~</code>), check out <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/bitwise-and-shift-operators#bitwise-complement-operator-">https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/bitwise-and-shift-operators#bitwise-complement-operator-</a>.</p>
			<p class="callout">For more information on <em class="italic">raycasting</em>, check out <a href="https://docs.unity3d.com/ScriptReference/Physics.Raycast.html">https://docs.unity3d.com/ScriptReference/Physics.Raycast.html</a>.</p>
			<p>If we do hit<a id="_idIndexMarker252"/> something, we <a id="_idIndexMarker253"/>call a function named <code>SendMessage</code><strong class="bold"> </strong>on the object that we collided with. This function will attempt to call a function with the same name as the first parameter if it exists on any component of the game object. The second parameter lets us know whether we should display an error if it doesn’t exist.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">For more info on the <code>SendMessage</code><strong class="bold"> </strong>function, check out <a href="https://docs.unity3d.com/ScriptReference/GameObject.SendMessage.html">https://docs.unity3d.com/ScriptReference/GameObject.SendMessage.html</a>.</p>
			<ol>
				<li value="2">Now, in the <code>Update</code><code>TouchObjects</code><strong class="bold"> </strong>function and adjust the code so that we can test the functionality within the<a id="_idIndexMarker254"/> Unity <a id="_idIndexMarker255"/>Editor as well:<pre class="source-code">
/// &lt;summary&gt;
/// Update is called once per frame
/// &lt;/summary&gt;
private void Update()
{
    /* Check if we are running either in the Unity
       editor or in a
     * standalone build.*/
    #if UNITY_STANDALONE || UNITY_WEBPLAYER ||
        UNITY_EDITOR
    /* If the mouse is tapped */
    if (Input.GetMouseButtonDown(0))
    {
        Vector2 screenPos = new Vector2(
            Input.mousePosition.x,
                Input.mousePosition.y);
        TouchObjects(screenPos);
    }
    /* Check if we are running on a mobile device */
    #elif UNITY_IOS || UNITY_ANDROID
        /* Check if Input has registered more than
           zero touches */
        if (Input.touchCount &gt; 0)
        {
            /* Store the first touch detected */
            Touch touch = Input.touches[0];
            TouchObjects(touch.position);
            SwipeTeleport(touch);
            ScalePlayer();
        }
    #endif
}</pre></li>
				<li>Save the <code>PlayerBehaviour</code><strong class="bold"> </strong>script at this point.</li>
				<li>Finally, we call a <code>PlayerTouch</code><code>ObstacleBehaviour</code><strong class="bold"> </strong>script and <a id="_idIndexMarker256"/>add<a id="_idIndexMarker257"/> the following code:<pre class="source-code">
[Tooltip("Explosion effect to play when tapped")]
public GameObject explosion;
/// &lt;summary&gt;
/// If the object is tapped, we spawn an explosion and
/// destroy this object
/// &lt;/summary&gt;
private void PlayerTouch()
{
    if (explosion != null)
    {
        var particles = Instantiate(explosion,
            transform.position,
                Quaternion.identity);
        Destroy(particles, 1.0f);
    }
    Destroy(this.gameObject);
}
public GameObject explosion;
/// &lt;summary&gt;
/// If the object is tapped, we spawn an explosion and
/// destroy this object
/// &lt;/summary&gt;
private void PlayerTouch()
{
    if (explosion != null)
    {
        var particles = Instantiate(explosion,
            transform.position, Quaternion.identity);
        Destroy(particles, 1.0f);
    }
    Destroy(this.gameObject);
}</pre></li>
			</ol>
			<p>This function will <a id="_idIndexMarker258"/>basically <a id="_idIndexMarker259"/>destroy the game object it is attached to, and create an explosion that will also destroy itself after <code>1</code><strong class="bold"> </strong>second.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">It is possible to get similar results to what we are writing by making use of Unity’s <code>OnMouseDown</code> function. As we have already discussed, it is possible to use mouse events when developing for mobile. Keep in mind, though, that the use of that function is computationally more expensive than the method I’m suggesting here.</p>
			<p class="callout">This is because when you tap the screen, every object that has an <code>OnMouseDown</code> method will do a <code>raycast</code> and 100, and it’s important to keep performance in mind when dealing with mobile development. For more information on this, check out <a href="http://answers.unity3d.com/questions/1064394/onmousedown-and-mobile.html">http://answers.unity3d.com/questions/1064394/onmousedown-and-mobile.html</a>.</p>
			<ol>
				<li value="5">Save the scripts and return to Unity.</li>
			</ol>
			<p>We haven’t created an explosion particle effect yet. To create this effect, we will make use of a <em class="italic">particle system</em>. We’ll be diving into particle systems at a much deeper level in <a href="B18868_12.xhtml#_idTextAnchor347"><em class="italic">Chapter 12</em></a><em class="italic">, Improving Game Feel</em>, but, for now, we can consider a particle system as a game object that is made as simple as possible so that we can spawn many of them on the screen at once, without causing the game to slow down too much. This is mostly used for things such <a id="_idIndexMarker261"/>as <a id="_idIndexMarker262"/>smoke or fire, but, in this case, we will have our obstacle explode.</p>
			<p>Use the following steps to create an explosion particle effect:</p>
			<ol>
				<li>Create a particle system by going to <code>Explosion</code> and hit the <em class="italic">Enter</em> key.</li>
				<li>Select the game object in the <strong class="bold">Hierarchy </strong>window and then open the <strong class="bold">Particle System </strong>component in the <strong class="bold">Inspector </strong>tab. In there, click on the <strong class="bold">Renderer </strong>section to expand it, and change <strong class="bold">RenderMode </strong>to <strong class="bold">Mesh </strong>and <strong class="bold">Material </strong>to <strong class="bold">Default-Material </strong>by clicking on the circle next to the name and selecting <strong class="bold">Default-Material </strong>from the menu that pops up:</li>
			</ol>
			<div><div><img src="img/B18868_03_29.jpg" alt="Figure 3.29 – Selecting the Default-Material material"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.29 – Selecting the Default-Material material</p>
			<p>This will make the <a id="_idIndexMarker263"/>particles <a id="_idIndexMarker264"/>look like the obstacles that we’ve already created, as a box with the default material.</p>
			<div><div><img src="img/B18868_03_30.jpg" alt="Figure 3.30 – The visual of the boxes"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.30 – The visual of the boxes</p>
			<ol>
				<li value="3">Next, under the top <strong class="bold">Particle System </strong>section, change the <strong class="bold">Gravity Modifier </strong>property to <strong class="bold">1</strong>. This ensures that objects will fall gradually, much like normal objects with rigid bodies do, but with less computation.</li>
				<li>Then, under <strong class="bold">Start Speed</strong>, move to the right side and click on the downward-facing <a id="_idIndexMarker265"/>arrow, and <a id="_idIndexMarker266"/>from that menu, select <strong class="bold">Random Between </strong><strong class="bold">Two Constants</strong>:</li>
			</ol>
			<div><div><img src="img/B18868_03_31.jpg" alt="Figure 3.31 – Using a random value between two constants"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.31 – Using a random value between two constants</p>
			<ol>
				<li value="5">This will change the single window to two, signifying the minimum and maximum values<a id="_idIndexMarker267"/> that<a id="_idIndexMarker268"/> can be used for this property. From there, set the two values to <code>0</code><code>8</code>. This makes the objects spawned start at speeds between <em class="italic">0</em><strong class="bold"> </strong>and <em class="italic">8</em>.</li>
				<li>Then, change <strong class="bold">Start Size </strong>to something between <strong class="bold">0 </strong>and <strong class="bold">0.25</strong>. This will ensure that we are creating a bunch of cubes that are smaller than the one we are planning to replace.</li>
				<li>Change <code>1</code><strong class="bold"> </strong>and uncheck the <strong class="bold">Looping </strong>option. This ensures that the particle system will last only for <em class="italic">1</em> second, and unchecking looping means that the particle system will activate only once by default.</li>
			</ol>
			<p class="callout-heading">Note</p>
			<p class="callout">You can still see the effect of each of the changes made, by clicking on the <strong class="bold">Play </strong>button on the botto<a id="_idTextAnchor160"/>m-right menu of the <strong class="bold">Scene </strong>window with the <strong class="bold">Particle System </strong>object selected.</p>
			<ol>
				<li value="8">Finally, change <a id="_idIndexMarker269"/>the <strong class="bold">Start Lifetime </strong>property to <strong class="bold">1 </strong>to ensure<a id="_idIndexMarker270"/> that all of the particles will be dead before the game object is destroyed.</li>
				<li>Under the <strong class="bold">Emission </strong>section, change <strong class="bold">Rate over Time </strong>to <strong class="bold">0</strong>. Then, under <strong class="bold">Bursts</strong>, click on the <strong class="bold">+ </strong>button and then set <strong class="bold">Count </strong>to <strong class="bold">50</strong>:</li>
			</ol>
			<div><div><img src="img/B18868_03_32.jpg" alt="Figure 3.32 – Creating a single burst upon creation"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.32 – Creating a single burst upon creation</p>
			<p>This means that 50 particles will be spawned right at the beginning of the particle system being created, much like an explosion.</p>
			<ol>
				<li value="10">Then, check <strong class="bold">Size over Lifetime </strong>and click on the text next to the checkmark to show more details. From there, change the <strong class="bold">Size </strong>property by selecting a curve that decreases gradually so that at the end, they’ll all be <strong class="bold">0.0</strong>. This can be done by first selecting <a id="_idIndexMarker271"/>the <a id="_idIndexMarker272"/>curve itself and then going to the <strong class="bold">Particle System Curves </strong>section at the bottom of the <strong class="bold">Inspector </strong>window. If you do not see the contents shown in the following screenshot, you can click and drag the name upward to make it pop ou<a id="_idTextAnchor161"/>t. From there, you can click on the option that has the downward-facing curve:</li>
			</ol>
			<div><div><img src="img/B18868_03_33.jpg" alt="Figure 3.33 – Setting the Size over Lifetime curve"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.33 – Setting the Size over Lifetime curve</p>
			<p>This will make<a id="_idIndexMarker273"/> the <a id="_idIndexMarker274"/>particles smaller gradually, and they will destroy themselves only after they become invisible (a scale of <strong class="bold">0.0</strong>).</p>
			<ol>
				<li value="11">Finally, check the <strong class="bold">Collision </strong>property and open it, setting the <strong class="bold">Type </strong>property to <strong class="bold">World</strong>. This will cause the particles to hit the ground.</li>
				<li>Then, make your object a prefab by dragging and dropping it from the <strong class="bold">Hierarchy </strong>tab into the <strong class="bold">Project </strong>tab in the <strong class="bold">Assets</strong> | <strong class="bold">Prefabs</strong> folder. Once the prefab is created (you should see the text on the object in the Hierarchy turn blue), remove the original from the scene by selecting it and pressing the <em class="italic">Delete </em>key.</li>
				<li>Next, assign the <strong class="bold">Explosion</strong> property of <strong class="bold">Obstacle Behaviour (Script) </strong>in the <strong class="bold">Obstacle </strong>prefab:</li>
			</ol>
			<div><div><img src="img/B18868_03_34.jpg" alt="Figure 3.34 – Assigning the Explosion property in the Obstacle prefab"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.34 – Assigning the Explosion property in the Obstacle prefab</p>
			<ol>
				<li value="14">Save your <a id="_idIndexMarker275"/>project <a id="_idIndexMarker276"/>and run the game:</li>
			</ol>
			<div><div><img src="img/B18868_03_35.jpg" alt="Figure 3.35 – Exploding obstacles on touch"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.35 – Exploding obstacles on touch</p>
			<p>Now, when we<a id="_idIndexMarker277"/> tap <a id="_idIndexMarker278"/>on one of the obstacles, we can see the object gets destroyed and an explosion effect is played!</p>
			<p>If you export t<a id="_idTextAnchor162"/>he game to your mobile device, you should see the same functionality as well:</p>
			<div><div><img src="img/B18868_03_36.jpg" alt="Figure 3.36 – The current state of the game"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.36 – The current state of the game</p>
			<p>From now<a id="_idIndexMarker279"/> on<a id="_idTextAnchor163"/>, whenever <a id="_idIndexMarker280"/>we tap on the obstacles on our mobile device, they will be destroyed.</p>
			<h1 id="_idParaDest-61"><a id="_idTextAnchor164"/>Summary</h1>
			<p>In this chapter, we have learned the main ways in which games are controlled when working on mobile devices. We also learned how we can use mouse inputs, touch events, gestures, and the accelerometer to allow players to interact with our game.</p>
			<p>In the next chapter, we will explore the other main way that players interact with a game by diving into the world of user interfaces and creating menus that can be enjoyed, no matter what device a user is playing the game on.</p>
		</div>
	</body></html>