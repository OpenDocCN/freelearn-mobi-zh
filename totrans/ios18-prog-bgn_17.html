<html><head></head><body><div><div><div><h1 class="chapterNumber">14</h1>
    <h1 id="_idParaDest-195" class="chapterTitle">Getting Started with MVC and Table Views</h1>
    <p class="normal">In the previous chapter, you modified the Journal List screen, the Add New Journal Entry screen, and the Journal Entry Detail screen to match the app tour shown in <em class="chapterRef">Chapter 10</em>, <em class="italic">Setting Up the User Interface</em>. You have completed the initial UI for the <em class="italic">JRNL</em> app, and that concluded <em class="italic">Part 2</em> of this book.</p>
    <p class="normal">This chapter begins <em class="italic">Part 3</em> of this book, where you will focus on the code that makes your app work. In this <a id="_idIndexMarker594"/>chapter, you will learn about the <strong class="keyWord">Model-View-Controller</strong> (<strong class="keyWord">MVC</strong>) design pattern and how the different parts of an app interact with one another. Then, you’ll implement a table view programmatically (which means implementing it using code instead of storyboards) using a playground, to understand how table views work. Finally, you’ll revisit the table view you implemented on the Journal List screen, so you can see the differences between implementing it in a storyboard and implementing it programmatically.</p>
    <p class="normal">By the end of this chapter, you’ll understand the MVC design pattern, you’ll have learned how to create a table view controller programmatically, and you’ll know how to use table view delegate and data source protocols.</p>
    <p class="normal">The following topics will be covered in this chapter:</p>
    <ul>
      <li class="bulletList">Understanding the MVC design pattern</li>
      <li class="bulletList">Understanding table views</li>
      <li class="bulletList">Revisiting the Journal List screen</li>
    </ul>
    <h1 id="_idParaDest-196" class="heading-1">Technical requirements</h1>
    <p class="normal">The completed Xcode playground and project for this chapter are in the <code class="inlineCode">Chapter14</code> folder of the code bundle for this book, which can be downloaded here:</p>
    <p class="normal"><a href="https://github.com/PacktPublishing/iOS-18-Programming-for-Beginners-Ninth-Edition%0D">https://github.com/PacktPublishing/iOS-18-Programming-for-Beginners-Ninth-Edition</a></p>
    <p class="normal">Check out the following video to see the code in action:</p>
    <p class="normal"><a href="https://youtu.be/tvnmgByShF4%0D">https://youtu.be/tvnmgByShF4</a></p>
    <p class="normal">Create a new playground and call it <code class="inlineCode">TableViewBasics</code>. You can use this playground to type in and run all the code in this chapter as you go along. Before you do, let’s look at the MVC design pattern, an approach commonly used when writing iOS apps.</p>
    <h1 id="_idParaDest-197" class="heading-1">Understanding the MVC design pattern</h1>
    <p class="normal">The <strong class="keyWord">Model-View-Controller</strong> (<strong class="keyWord">MVC</strong>) design <a id="_idIndexMarker595"/>pattern is a common <a id="_idIndexMarker596"/>approach used when building iOS apps. MVC divides an app into three different parts:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Model</strong>: This handles data storage and representation and data processing tasks.</li>
      <li class="bulletList"><strong class="keyWord">View</strong>: This includes all the things that are on the screen that the user can interact with.</li>
      <li class="bulletList"><strong class="keyWord">Controller</strong>: This manages the flow of information between the model and view.</li>
    </ul>
    <p class="normal">One notable feature of MVC is that the view and model do not interact with one another; instead, all communication is managed by the controller.</p>
    <p class="normal">For example, imagine you’re at a restaurant. You look at a menu and choose something you want. Then, a waiter comes, takes your order, and sends it to the cook. The cook prepares your order, and, when it is done, the waiter takes the order and brings it out to you. In this scenario, the menu is the view, the waiter is the controller, and the cook is the model. Also, note that all interactions between you and the kitchen are only through the waiter; there is no interaction between you and the cook.</p>
    <div><p class="normal">To find out more about MVC, visit <a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/DevPedia-CocoaCore/MVC.html">https://developer.apple.com/library/archive/documentation/General/Conceptual/DevPedia-CocoaCore/MVC.html</a>.</p>
    </div>
    <p class="normal">To see how <a id="_idIndexMarker597"/>MVC works in the context of an iOS app, let’s learn more about view controllers. You will see what it takes to implement a view controller that is required to manage a table view, which is used on the Journal List screen.</p>
    <h2 id="_idParaDest-198" class="heading-2">Exploring view controllers</h2>
    <p class="normal">So far, you have implemented <code class="inlineCode">JournalListViewController</code>, a view controller that manages <a id="_idIndexMarker598"/>the table view on the Journal List screen. However, you still <a id="_idIndexMarker599"/>haven’t learned how the code you added to it works, so let’s look at that now.</p>
    <div><p class="normal">You may wish to re-read <em class="chapterRef">Chapter 11</em>, <em class="italic">Building Your User Interface</em>, where you implemented the <code class="inlineCode">JournalListViewController</code> class.</p>
    </div>
    <p class="normal">When an iOS app is launched, the view controller for the first screen to be displayed is loaded. The view controller has a <code class="inlineCode">view</code> property and automatically loads the view instance assigned to its <code class="inlineCode">view</code> property. That view may have subviews, which are also loaded.</p>
    <p class="normal">If one of the subviews is a table view, it will have <code class="inlineCode">dataSource</code> and <code class="inlineCode">delegate</code> properties. The <code class="inlineCode">dataSource</code> property is assigned to an object that provides data to the table view. The <code class="inlineCode">delegate</code> property is assigned to an object that handles user interaction with the table view. Typically, the view controller for the table view will be assigned to the table view’s <code class="inlineCode">dataSource</code> and <code class="inlineCode">delegate</code> properties.</p>
    <p class="normal">The method calls that a table view will send to its view controller are declared in the <code class="inlineCode">UITableViewDataSource</code> and <code class="inlineCode">UITableViewDelegate</code> protocols. Remember that protocols only provide method declarations; the implementation of those method calls is in the view controller. The view controller will then get the data from the model objects and provide it for the table view. The view controller also handles user input and modifies the model objects as required.</p>
    <p class="normal">Let’s take a closer look at table views and table view protocols in the next section.</p>
    <h1 id="_idParaDest-199" class="heading-1">Understanding table views</h1>
    <p class="normal">The <em class="italic">JRNL</em> app uses <a id="_idIndexMarker600"/>a table view on the Journal List screen. A table view presents table view cells using rows arranged in a single column.</p>
    <div><p class="normal">To learn <a id="_idIndexMarker601"/>more about table views, visit <a href="https://developer.apple.com/documentation/uikit/uitableview">https://developer.apple.com/documentation/uikit/uitableview</a>.</p>
    </div>
    <p class="normal">The data displayed by a table view is usually provided by a view controller. A view controller providing data for a table view must conform to the <code class="inlineCode">UITableViewDataSource</code> protocol. This protocol declares a list of methods that tells the table view how many cells to display and what to display in each cell.</p>
    <div><p class="normal">To learn <a id="_idIndexMarker602"/>more about the <code class="inlineCode">UITableViewDataSource</code> protocol, visit <a href="https://developer.apple.com/documentation/uikit/uitableviewdatasource">https://developer.apple.com/documentation/uikit/uitableviewdatasource</a>.</p>
    </div>
    <p class="normal">To enable user interaction, a view controller for a table view must also conform to the <code class="inlineCode">UITableViewDelegate</code> protocol, which declares a list of methods that are triggered when a user interacts with the table view.</p>
    <div><p class="normal">To learn <a id="_idIndexMarker603"/>more about the <code class="inlineCode">UITableViewDelegate</code> protocol, visit <a href="https://developer.apple.com/documentation/uikit/uitableviewdelegate">https://developer.apple.com/documentation/uikit/uitableviewdelegate</a>.</p>
    </div>
    <p class="normal">To learn how table views work, you’ll implement a view controller subclass that controls a table view in your <code class="inlineCode">TableViewBasics</code> playground. Since there is no storyboard in the playground, you can’t add the UI elements using the library, as you did in the previous chapters. Instead, you will do everything programmatically.</p>
    <p class="normal">You’ll start by creating the <code class="inlineCode">TableViewExampleController</code> class, an implementation of a view controller that manages a table view. After that, you’ll create an instance of <code class="inlineCode">TableViewExampleController</code> and make it display a table view in the playground’s live view. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">Open the <code class="inlineCode">TableViewBasics</code> playground that you have created, remove the <code class="inlineCode">var</code> statement, and add an <code class="inlineCode">import PlaygroundSupport</code> statement. Your playground should now contain the following:
        <pre class="programlisting code-one"><code class="hljs-code">import UIKit
<strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> PlaygroundSupport</strong>
</code></pre>
      </li>
    </ol>
    <p class="normal-one">The first <code class="inlineCode">import</code> statement imports the API for creating iOS apps. The second statement enables the playground to display a live view, which you will use to display the table view.</p>
    <ol>
      <li class="numberedList" value="2">Add the <a id="_idIndexMarker604"/>following code after the <code class="inlineCode">import</code> statements to declare the <code class="inlineCode">TableViewExampleController</code> class:
        <pre class="programlisting code-one"><code class="hljs-code">class TableViewExampleController: UIViewController {
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This class is a subclass of <code class="inlineCode">UIViewController</code>, a class that Apple provides to manage views on the screen.</p>
    <ol>
      <li class="numberedList" value="3">Add the following code inside the curly braces to declare a table view property and an array property in the <code class="inlineCode">TableViewExampleController</code> class:
        <pre class="programlisting code-one"><code class="hljs-code">class TableViewExampleController: UIViewController {
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">var</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">tableView</strong><strong class="hljs-slc">: UITableView?</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">var</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">journalEntries</strong><strong class="hljs-slc">: [[</strong><strong class="hljs-type-slc">String</strong><strong class="hljs-slc">]] </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> [</strong>
<strong class="hljs-slc">    [</strong><strong class="hljs-string-slc">"sun.max"</strong><strong class="hljs-slc">,</strong><strong class="hljs-string-slc">"12 Sept 2024"</strong><strong class="hljs-slc">,</strong><strong class="hljs-string-slc">"Nice weather today"</strong><strong class="hljs-slc">],</strong>
<strong class="hljs-slc">    [</strong><strong class="hljs-string-slc">"cloud.rain"</strong><strong class="hljs-slc">,</strong><strong class="hljs-string-slc">"13 Sept 2024"</strong><strong class="hljs-slc">,</strong><strong class="hljs-string-slc">"Heavy rain today"</strong><strong class="hljs-slc">],</strong>
<strong class="hljs-slc">    [</strong><strong class="hljs-string-slc">"cloud.sun"</strong><strong class="hljs-slc">,</strong><strong class="hljs-string-slc">"14 Sept 2024"</strong><strong class="hljs-slc">,</strong><strong class="hljs-string-slc">"It's cloudy out"</strong><strong class="hljs-slc">]</strong>
<strong class="hljs-slc">  ]</strong>
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">The <code class="inlineCode">tableView</code> property is an optional property that will be assigned a <code class="inlineCode">UITableView</code> instance. The <code class="inlineCode">journalEntries</code> array is the model object that will be used to provide data to the table view.</p>
    <p class="normal">You have just declared and defined the initial implementation of the <code class="inlineCode">TableViewExampleController</code> class. Cool! In the next section, you’ll learn how to set the number of cells for a table view to display, how to set the contents of each cell, and how to remove a row from a table view.</p>
    <h2 id="_idParaDest-200" class="heading-2">Conforming to the UITableViewDataSource protocol</h2>
    <p class="normal">A table view presents table view cells using rows arranged in a single column. However, before it <a id="_idIndexMarker605"/>can do this, it needs to know how many cells <a id="_idIndexMarker606"/>to display and what to put in each cell. To provide this information to the table view, you will make the <code class="inlineCode">TableViewExampleController</code> class conform to the <code class="inlineCode">UITableViewDataSource</code> protocol.</p>
    <p class="normal">This protocol has two required methods:</p>
    <ul>
      <li class="bulletList"><code class="inlineCode">tableview(_:numberOfRowsInSection:)</code> is <a id="_idIndexMarker607"/>called by the table view to determine how many table view cells to display.</li>
      <li class="bulletList"><code class="inlineCode">tableView(_:cellForRowAt:)</code> is <a id="_idIndexMarker608"/>called by the table view to determine what to display in each table view cell.</li>
    </ul>
    <p class="normal">The <code class="inlineCode">UITableViewDataSource</code> protocol also has an optional method, <code class="inlineCode">tableView(_:commit:forRowAt:)</code>, which is called by the table view when the user swipes left on a row. You’ll use this method to handle what happens when a user wants to delete a row.</p>
    <p class="normal">Let’s add some code to make the <code class="inlineCode">TableViewExampleController</code> class conform to the <code class="inlineCode">UITableViewDataSource</code> protocol. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">To make the <code class="inlineCode">TableViewExampleController</code> class adopt the <code class="inlineCode">UITableViewDataSource</code> protocol, type a comma after the superclass name and then type <code class="inlineCode">UITableViewDataSource</code>. Your code should look like this:
        <pre class="programlisting code-one"><code class="hljs-code">class TableViewExampleController: UIViewController<strong class="hljs-slc">, UITableViewDataSource</strong> {
</code></pre>
      </li>
      <li class="numberedList">An error will appear because you haven’t implemented the two required methods. Click the error icon:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B31371_14_01.png" alt="" width="776" height="212"/></figure>
    <p class="packt_figref">Figure 14.1: Editor area showing error icon</p>
    <p class="normal-one">The error <a id="_idIndexMarker609"/>message states that the <code class="inlineCode">TableViewExampleController</code> class does not conform to the <code class="inlineCode">UITableViewDataSource</code> protocol.</p>
    <ol>
      <li class="numberedList" value="3">Click <a id="_idIndexMarker610"/>the <strong class="screenText">Fix</strong> button to add the stubs needed for conformance to the class:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B31371_14_02.png" alt="" width="775" height="229"/></figure>
    <p class="packt_figref">Figure 14.2: Error explanation and Fix button</p>
    <ol>
      <li class="numberedList" value="4">Verify that your code looks like this:
        <pre class="programlisting code-one"><code class="hljs-code">class TableViewExampleController: UIViewController,
UITableViewDataSource {
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">func</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">tableView</strong><strong class="hljs-slc">(</strong><strong class="hljs-template-variable-slc">_</strong><strong class="hljs-slc"> </strong><strong class="hljs-params-slc">tableView</strong><strong class="hljs-slc">: UITableView, </strong>
<strong class="hljs-params-slc">  </strong><strong class="hljs-template-variable-slc">numberOfRowsInSection</strong><strong class="hljs-params-slc"> section</strong><strong class="hljs-slc">: </strong><strong class="hljs-type-slc">Int</strong><strong class="hljs-slc">) -&gt; </strong><strong class="hljs-type-slc">Int</strong><strong class="hljs-slc"> {</strong>
<strong class="hljs-slc">    code</strong>
<strong class="hljs-slc">  }</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">func</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">tableView</strong><strong class="hljs-slc">(</strong><strong class="hljs-template-variable-slc">_</strong><strong class="hljs-slc"> </strong><strong class="hljs-params-slc">tableView</strong><strong class="hljs-slc">: UITableView, </strong><strong class="hljs-template-variable-slc">cellForRowAt</strong><strong class="hljs-slc"> </strong>
<strong class="hljs-params-slc">  indexPath</strong><strong class="hljs-slc">: IndexPath) -&gt; UITableViewCell  {</strong>
<strong class="hljs-slc">    code</strong>
<strong class="hljs-slc">  }</strong>
  var tableView: UITableView?
  var journalEntries: [[String]] = [
    ["sun.max","12 Sept 2024","Nice weather today"],
    ["cloud.rain","13 Sept 2024","Heavy rain today"],
    ["cloud.sun","14 Sept 2024","It's cloudy out"]
  ]
}
</code></pre>
      </li>
      <li class="numberedList">In a class <a id="_idIndexMarker611"/>definition, convention <a id="_idIndexMarker612"/>dictates that properties are declared at the top before any method declarations. Rearrange the code so that the property declarations are at the top, as follows:
        <pre class="programlisting code-one"><code class="hljs-code">class TableViewExampleController: UIViewController,
UITableViewDataSource {
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">var</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">tableView</strong><strong class="hljs-slc">: UITableView?</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">var</strong><strong class="hljs-slc"> </strong><strong class="hljs-template-variable-slc">journalEntries</strong><strong class="hljs-slc">: [[</strong><strong class="hljs-type-slc">String</strong><strong class="hljs-slc">]] </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> [</strong>
<strong class="hljs-slc">    [</strong><strong class="hljs-string-slc">"sun.max"</strong><strong class="hljs-slc">,</strong><strong class="hljs-string-slc">"12 Sept 2024"</strong><strong class="hljs-slc">,</strong><strong class="hljs-string-slc">"Nice weather today"</strong><strong class="hljs-slc">],</strong>
<strong class="hljs-slc">    [</strong><strong class="hljs-string-slc">"cloud.rain"</strong><strong class="hljs-slc">,</strong><strong class="hljs-string-slc">"13 Sept 2024"</strong><strong class="hljs-slc">,</strong><strong class="hljs-string-slc">"Heavy rain today"</strong><strong class="hljs-slc">],</strong>
<strong class="hljs-slc">    [</strong><strong class="hljs-string-slc">"cloud.sun"</strong><strong class="hljs-slc">,</strong><strong class="hljs-string-slc">"</strong><strong class="hljs-string-slc">14 Sept 2024"</strong><strong class="hljs-slc">,</strong><strong class="hljs-string-slc">"It's cloudy out"</strong><strong class="hljs-slc">]</strong>
<strong class="hljs-slc">  ]</strong>
  func tableView(_ tableView: UITableView, 
  numberOfRowsInSection section: Int) -&gt; Int {
</code></pre>
      </li>
      <li class="numberedList">To make the table view display a row for each element inside the <code class="inlineCode">journalEntries</code> array, click the <strong class="screenText">code</strong> placeholder inside the <code class="inlineCode">tableView(_:numberOfRowsInSection:)</code> method definition and type in <code class="inlineCode">journalEntries.count</code>. The completed method should look like this:
        <pre class="programlisting code-one"><code class="hljs-code">func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&gt; Int {
  <strong class="hljs-variable-slc">journalEntries</strong><strong class="hljs-slc">.count</strong>
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one"><code class="inlineCode">journalEntries.count</code> returns the number of elements inside the <code class="inlineCode">journalEntries</code> array. Since there are three elements in it, this will make the table view display three rows.</p>
    <ol>
      <li class="numberedList" value="7">To make the table view display journal entry details in each cell, click the <strong class="screenText">code</strong> placeholder inside the <code class="inlineCode">tableView(_:cellForRowAt:)</code> method definition and type the following:
        <pre class="programlisting code-one"><code class="hljs-code">func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell {
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">let</strong><strong class="hljs-slc"> cell </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> tableView.dequeueReusableCell(withIdentifier: </strong>
<strong class="hljs-string-slc">  "cell"</strong><strong class="hljs-slc">, for: indexPath)</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">let</strong><strong class="hljs-slc"> journalEntry </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> </strong><strong class="hljs-variable-slc">journalEntries</strong><strong class="hljs-slc">[indexPath.row]</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">var</strong><strong class="hljs-slc"> content </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> cell.defaultContentConfiguration()</strong>
<strong class="hljs-slc">  content.image </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> UIImage(systemName: journalEntry[</strong><strong class="hljs-number-slc">0</strong><strong class="hljs-slc">])</strong>
<strong class="hljs-slc">  content.text </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> journalEntry[</strong><strong class="hljs-number-slc">1</strong><strong class="hljs-slc">]</strong>
<strong class="hljs-slc">  content.secondaryText </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> journalEntry[</strong><strong class="hljs-number-slc">2</strong><strong class="hljs-slc">]</strong>
<strong class="hljs-slc">  cell.contentConfiguration </strong><strong class="hljs-operator-slc">=</strong><strong class="hljs-slc"> content</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">return</strong><strong class="hljs-slc"> cell</strong>
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">Let’s break this down:</p>
    <pre class="programlisting code-one"><code class="hljs-code">let cell = tableView.dequeueReusableCell(withIdentifier: "cell", for: indexPath)
</code></pre>
    <p class="normal-one">This statement creates a new table view cell or reuses an existing table view cell and <a id="_idIndexMarker613"/>assigns it to <code class="inlineCode">cell</code>. Imagine you have 1,000 items to display in a table view. You don’t need 1,000 rows containing 1,000 table view cells—you only need just enough to fill the screen. Table <a id="_idIndexMarker614"/>view cells that scroll off the top of the screen can be reused to display items that appear at the bottom of the screen, and vice versa. As table views can display more than one type of cell, you set the cell reuse identifier to <code class="inlineCode">"cell"</code> to identify this particular table view cell type. This identifier will be registered with the table view later.</p>
    <pre class="programlisting code-one"><code class="hljs-code">let journalEntry = journalEntries[indexPath.row]
</code></pre>
    <p class="normal-one">The <code class="inlineCode">indexPath</code> value locates the row in the table view. The first row has an <code class="inlineCode">indexPath</code> containing section <code class="inlineCode">0</code> and row <code class="inlineCode">0</code>. <code class="inlineCode">indexPath.row</code> returns <code class="inlineCode">0</code> for the first row, so this statement assigns the first element in the <code class="inlineCode">journalEntries</code> array to <code class="inlineCode">journalEntry</code>.</p>
    <pre class="programlisting code-one"><code class="hljs-code">var content = cell.defaultContentConfiguration()
</code></pre>
    <p class="normal-one">By default, a <code class="inlineCode">UITableViewCell</code> instance can store an image, a text string, and a secondary text string. You set these by using the table view cell’s content configuration property. This statement retrieves the default content configuration for the table view cell’s style and assigns it to a variable, <code class="inlineCode">content</code>.</p>
    <pre class="programlisting code-one"><code class="hljs-code">content.image = UIImage(systemName: journalEntry[0])
content.text = journalEntry[1]
content.secondaryText = journalEntry[2]
cell.contentConfiguration = content
</code></pre>
    <p class="normal-one">These statements update <code class="inlineCode">content</code> with details from <code class="inlineCode">journalEntry</code>, which is an array <a id="_idIndexMarker615"/>that has three elements. The <a id="_idIndexMarker616"/>first element is used to specify an image that is assigned to the <code class="inlineCode">image</code> property. The second element is assigned to the <code class="inlineCode">text</code> property. The third element is assigned to the <code class="inlineCode">secondaryText</code> property. The last line assigns <code class="inlineCode">content</code> to the table view cell’s <code class="inlineCode">contentConfiguration</code> property.</p>
    <pre class="programlisting code-one"><code class="hljs-code">return cell
</code></pre>
    <p class="normal-one">This statement returns the table view cell, which is then displayed on the screen.</p>
    <p class="normal-one">The <code class="inlineCode">tableView(_:cellForRowAt:)</code> method is executed for each row in the table view.</p>
    <ol>
      <li class="numberedList" value="8">To handle table view cell deletion, type the following code after the implementation of <code class="inlineCode">tableView(_:cellForRowAt:)</code>:
        <pre class="programlisting code-one"><code class="hljs-code">func tableView(_ tableView: UITableView, commit editingStyle: UITableViewCell.EditingStyle, forRowAt indexPath: IndexPath) {
  if editingStyle == .delete {
    journalEntries.remove(at: indexPath.row)
    tableView.reloadData()
  }
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This removes the <code class="inlineCode">journalEntries</code> element corresponding to the table view cell that the user swiped left on and reloads the table view.</p>
    <p class="normal">The <code class="inlineCode">TableViewExampleController</code> class now conforms to the <code class="inlineCode">UITableViewDataSource</code> protocol. In the next section, you will make it conform to the <code class="inlineCode">UITableViewDelegate</code> protocol.</p>
    <h2 id="_idParaDest-201" class="heading-2">Conforming to the UITableViewDelegate protocol</h2>
    <p class="normal">A user can tap on a table view cell to select it. To handle user interaction, you will make the <code class="inlineCode">TableViewExampleController</code> class conform to the <code class="inlineCode">UITableViewDelegate</code> protocol. You will <a id="_idIndexMarker617"/>implement one optional method from this protocol, <code class="inlineCode">tableView(_:didSelectRowAt:)</code>, which is called by the table view when the user taps a row. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">To make the <code class="inlineCode">TableViewExampleController</code> class adopt the <code class="inlineCode">UITableViewDelegate</code> protocol, type a comma after <code class="inlineCode">UITableViewDataSource</code> in the class declaration and then type <code class="inlineCode">UITableViewDelegate</code>. Your code should look like this:
        <pre class="programlisting code-one"><code class="hljs-code">class TableViewExampleController: UIViewController, UITableViewDataSource<strong class="hljs-slc">, UITableViewDelegate</strong> {
</code></pre>
      </li>
      <li class="numberedList">Type the following after the implementation of <code class="inlineCode">tableView(_:commit:forRowAt:)</code>:
        <pre class="programlisting code-one"><code class="hljs-code">func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
  let selectedJournalEntry = journalEntries[indexPath.row]
  print(selectedJournalEntry)
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This method will get the <code class="inlineCode">journalEntries</code> array element corresponding to the tapped row and print it to the Debug area.</p>
    <ol>
      <li class="numberedList" value="3">Verify that your <code class="inlineCode">TableViewExampleController</code> class looks like this:
        <pre class="programlisting code-one"><code class="hljs-code">class TableViewExampleController: UIViewController, UITableViewDataSource, UITableViewDelegate {
  var tableView: UITableView?
  var journalEntries: [[String]] = [
    ["sun.max","12 Sept 2024","Nice weather today"],
    ["cloud.rain","13 Sept 2024","Heavy rain today"],
    ["cloud.sun","14 Sept 2024","It's cloudy out"]
  ]
  func tableView(_ tableView: UITableView, 
  numberOfRowsInSection section: Int) -&gt; Int {
    journalEntries.count
  }
  func tableView(_ tableView: UITableView, cellForRowAt 
  indexPath: IndexPath) -&gt; UITableViewCell {
    let cell = tableView.dequeueReusableCell(
    withIdentifier: "cell", for: indexPath)
    let journalEntry = journalEntries[indexPath.row]
    var content = cell.defaultContentConfiguration()
    content.image = UIImage(systemName: journalEntry[0])
    content.text = journalEntry[1]
    content.secondaryText = journalEntry[2]
    cell.contentConfiguration = content
    return cell
  }
  func tableView(_ tableView: UITableView, commit 
  editingStyle: UITableViewCell.EditingStyle, 
  forRowAt indexPath: IndexPath) {
    if editingStyle == .delete {
      journalEntries.remove(at: indexPath.row)
      tableView.reloadData()
    }
  }
  func tableView(_ tableView: UITableView, didSelectRowAt 
  indexPath: IndexPath) {
    let selectedjournalEntry = 
    journalEntries[indexPath.row]
    print(selectedjournalEntry)
  }
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">The <code class="inlineCode">TableViewExampleController</code> class now conforms to the <code class="inlineCode">UITableViewDelegate</code> protocol.</p>
    <p class="normal">You have <a id="_idIndexMarker618"/>completed the implementation of the <code class="inlineCode">TableViewExampleController</code> class. In the next section, you’ll learn how to create an instance of this class.</p>
    <h2 id="_idParaDest-202" class="heading-2">Creating a TableViewExampleController instance</h2>
    <p class="normal">Now that <a id="_idIndexMarker619"/>you have declared and defined the <code class="inlineCode">TableViewExampleController</code> class, you will write a method to create an instance of it. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">Type in the following code after the <code class="inlineCode">journalEntries</code> variable declaration to declare a new method:
        <pre class="programlisting code-one"><code class="hljs-code">func createTableView() {
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This declares a new method, <code class="inlineCode">createTableView()</code>, which you’ll use to create an instance of a table view and assign it to the <code class="inlineCode">tableView</code> property.</p>
    <ol>
      <li class="numberedList" value="2">Type in the following code after the opening curly brace:
        <pre class="programlisting code-one"><code class="hljs-code">tableView = UITableView(frame: CGRect(x: 0, y: 0, width: view.frame.width, height: view.frame.height))
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This creates a new table view instance and assigns it to <code class="inlineCode">tableView</code>.</p>
    <ol>
      <li class="numberedList" value="3">On the next line, type in the following code to set the table view’s <code class="inlineCode">dataSource</code> and <code class="inlineCode">delegate</code> properties to an instance of <code class="inlineCode">TableViewExampleController</code>:
        <pre class="programlisting code-one"><code class="hljs-code">tableView?.dataSource = self
tableView?.delegate = self
</code></pre>
      </li>
    </ol>
    <p class="normal-one">The <code class="inlineCode">dataSource</code> and <code class="inlineCode">delegate</code> properties of a table view specify the object that contains the implementation of the <code class="inlineCode">UITableViewDataSource</code> and <code class="inlineCode">UITableViewDelegate</code> methods.</p>
    <ol>
      <li class="numberedList" value="4">On the next line, type in the following code to set the table view’s background color:
        <pre class="programlisting code-one"><code class="hljs-code">tableView?.backgroundColor = .white
</code></pre>
      </li>
      <li class="numberedList">On the next line, type in the following code to set the identifier for the table view cells to <code class="inlineCode">"cell"</code>:
        <pre class="programlisting code-one"><code class="hljs-code">tableView?.register(UITableViewCell.self, forCellReuseIdentifier: "cell")
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This identifier will be used in the <code class="inlineCode">tableView(_:cellForRowAt:)</code> method to identify the type of table view cells to be used.</p>
    <ol>
      <li class="numberedList" value="6">On the next line, type in the following code to add the table view as a subview of the view of the <code class="inlineCode">TableViewExampleController</code> instance:
        <pre class="programlisting code-one"><code class="hljs-code">view.addSubview(tableView!)
</code></pre>
      </li>
      <li class="numberedList">Verify <a id="_idIndexMarker620"/>that the completed method looks like the following:
        <pre class="programlisting code-one"><code class="hljs-code">func createTableView() {
  tableView = UITableView(frame: CGRect(x: 0, y: 0, 
  width: view.frame.width, 
  height: view.frame.height))
  tableView?.dataSource = self
  tableView?.delegate = self
  tableView?.backgroundColor = .white
  tableView?.register(UITableViewCell.self, 
  forCellReuseIdentifier: "cell")
  view.addSubview(tableView!)
}
</code></pre>
      </li>
    </ol>
    <p class="normal">Now you must determine when to call this method. View controllers have a <code class="inlineCode">view</code> property. The view assigned to the <code class="inlineCode">view</code> property will be automatically loaded when the view controller is loaded. After a view has been loaded successfully, the view controller’s <code class="inlineCode">viewDidLoad()</code> method will be called. You will override the <code class="inlineCode">viewDidLoad()</code> method in your <code class="inlineCode">TableViewControllerExample</code> class to call <code class="inlineCode">createTableView()</code>. Type in the following code just before the <code class="inlineCode">createTableView()</code> method:</p>
    <pre class="programlisting code"><code class="hljs-code">override func viewDidLoad() {
   super.viewDidLoad()
   view.bounds = CGRect(x: 0, y: 0, width: 375, 
   height: 667)
   createTableView()
}
</code></pre>
    <p class="normal">This sets the size of the live view, creates a table view instance, assigns it to <code class="inlineCode">tableView</code>, and adds it as a subview to the view of the <code class="inlineCode">TableViewExampleController</code> instance. The table view then calls the data source methods to determine how many table view cells to display and what to display in each cell. <code class="inlineCode">tableView(_:numberOfRowsInSection:) </code>returns the number of elements in <code class="inlineCode">journalEntries</code>, so three table view cells will be displayed. <code class="inlineCode">tableView(_:cellForRowAt:)</code> creates the cell, creates a new cell configuration, sets the properties of the cell configuration, and assigns the updated configuration to the cell.</p>
    <p class="normal">Verify <a id="_idIndexMarker621"/>that your completed playground looks like this:</p>
    <pre class="programlisting code"><code class="hljs-code">import UIKit
import PlaygroundSupport
class TableViewExampleController: UIViewController, UITableViewDataSource, UITableViewDelegate {   
  var tableView: UITableView?
  var journalEntries: [[String]] = [
    ["sun.max","12 Sept 2024","Nice weather today"],
    ["cloud.rain","13 Sept 2024","Heavy rain today"],
    ["cloud.sun","14 Sept 2024","It's cloudy out"]
  ]
  override func viewDidLoad() {
    super.viewDidLoad()
    view.bounds = CGRect(x: 0, y: 0, width: 375, height: 667)
    createTableView()
  }
  func createTableView() {
    tableView = UITableView(frame: CGRect(x: 0, y: 0, 
    width: view.frame.width,
    height: view.frame.height))
    tableView?.dataSource = self
    tableView?.delegate = self
    tableView?.backgroundColor = .white
    tableView?.register(UITableViewCell.self,   
    forCellReuseIdentifier: "cell")
    view.addSubview(tableView!)
  }
  func tableView(_ tableView: UITableView, 
  numberOfRowsInSection section: Int) -&gt; Int {
    journalEntries.count
  }
  func tableView(_ tableView: UITableView, cellForRowAt 
  indexPath: IndexPath) -&gt; UITableViewCell {
    let cell = tableView.dequeueReusableCell(withIdentifier: 
    "cell", for: indexPath)
    let journalEntry = journalEntries[indexPath.row]
    var content = cell.defaultContentConfiguration()
    content.image = UIImage(systemName: journalEntry[0])
    content.text = journalEntry[1]
    content.secondaryText = journalEntry[2]
    cell.contentConfiguration = content
    return cell
  }
  func tableView(_ tableView: UITableView, commit editingStyle:
  UITableViewCell.EditingStyle, forRowAt indexPath: IndexPath) {
    if editingStyle == .delete {
      journalEntries.remove(at: indexPath.row)
      tableView.reloadData()
    }
  }
  func tableView(_ tableView: UITableView, didSelectRowAt 
  indexPath: IndexPath) {
    let selectedjournalEntry = journalEntries[indexPath.row]
    print(selectedjournalEntry)
  }
}
</code></pre>
    <p class="normal">Now <a id="_idIndexMarker622"/>it’s time to see it in action. Follow these steps:</p>
    <ol>
      <li class="numberedList" value="1">Type the following after all the other code in the playground:
        <pre class="programlisting code-one"><code class="hljs-code">PlaygroundPage.current.liveView = TableViewExampleController()
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This command creates the instance of <code class="inlineCode">TableViewExampleController</code> and displays its view in the playground’s live view. The <code class="inlineCode">createTableView()</code> method will create a table view and add it as a subview to the <code class="inlineCode">TableViewExampleController</code> instance’s view, and it will appear on the screen.</p>
    <ol>
      <li class="numberedList" value="2">To see a representation of the table view on your screen, the playground’s live view must be enabled. Click the Adjust Editor Options button and verify that<strong class="screenText"> Live View</strong> is selected:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B31371_14_03.png" alt="" width="481" height="335"/></figure>
    <p class="packt_figref">Figure 14.3: Adjust Editor Options menu with Live View selected</p>
    <ol>
      <li class="numberedList" value="3">Run your <a id="_idIndexMarker623"/>code and verify that the table view is displaying three table view cells in the live view:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B31371_14_04.png" alt="" width="812" height="326"/></figure>
    <p class="packt_figref">Figure 14.4: Playground live view showing table view with three table view cells</p>
    <ol>
      <li class="numberedList" value="4">Tap a row. The journal entry details for that row will be printed in the Debug area:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B31371_14_05.png" alt="" width="812" height="411"/></figure>
    <p class="packt_figref">Figure 14.5: Debug area showing journal entry details</p>
    <ol>
      <li class="numberedList" value="5">Swipe <a id="_idIndexMarker624"/>left on a row. A <strong class="screenText">Delete</strong> button will appear:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B31371_14_06.png" alt="" width="567" height="254"/></figure>
    <p class="packt_figref">Figure 14.6: Table view row showing a Delete button</p>
    <ol>
      <li class="numberedList" value="6"> Tap the <strong class="screenText">Delete</strong> button to remove the row from the table view:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B31371_14_07.png" alt="" width="328" height="186"/></figure>
    <p class="packt_figref">Figure 14.7: Table view with one row removed</p>
    <p class="normal">You’ve <a id="_idIndexMarker625"/>just created a view controller for a table view, created an instance of it, and displayed a table view in the playground’s live view. Good job!</p>
    <p class="normal">In the next section, you’ll revisit how view controllers are used on the Journal List screen that you implemented in <em class="chapterRef">Chapter 11</em>, <em class="italic">Building Your User Interface</em>. Using what you have learned in this section as a reference, you should have a better understanding of how it works.</p>
    <h1 id="_idParaDest-203" class="heading-1">Revisiting the Journal List screen</h1>
    <p class="normal">Remember the <code class="inlineCode">JournalListViewController</code> class in <em class="chapterRef">Chapter 11</em>, <em class="italic">Building Your User Interface</em>? This is <a id="_idIndexMarker626"/>an example of a view controller that manages a table view. Note that the code for this class is very similar to that in your playground. The differences are as follows:</p>
    <ul>
      <li class="bulletList">You created and assigned the table view to the <code class="inlineCode">tableView</code> in <code class="inlineCode">TableViewExampleController</code> programmatically, instead of using the assistant.</li>
      <li class="bulletList">You set the dimensions of the table view programmatically in <code class="inlineCode">UITableView(frame:)</code>, instead of using the Size inspector and constraints.</li>
      <li class="bulletList">You connected the data source and delegate outlets to the view controller programmatically, instead of using the Connections inspector.</li>
      <li class="bulletList">You set the reuse identifier and UI element color programmatically, instead of using the Attributes inspector.</li>
      <li class="bulletList">You added the table view as a subview of the view for <code class="inlineCode">TableViewExampleController</code> programmatically, instead of dragging in a <strong class="screenText">Table View</strong> object from the library.</li>
    </ul>
    <p class="normal">You may wish <a id="_idIndexMarker627"/>to open the <em class="italic">JRNL</em> project and review <em class="chapterRef">Chapter 11</em>, <em class="italic">Building Your User Interface</em>, once more, to compare the table view implementation using the storyboard and the table view implementation done programmatically as you have done in this chapter.</p>
    <h1 id="_idParaDest-204" class="heading-1">Summary</h1>
    <p class="normal">In this chapter, you learned about the MVC design pattern and table view controllers in detail. You then revisited the table view used on the Journal List screen and learned how table view controllers work.</p>
    <p class="normal">You should now understand the MVC design pattern, how to create a table view controller, and how to use the table view data source and delegate protocols. This will enable you to implement table view controllers for your own apps.</p>
    <p class="normal">Up to this point, you have set up the views and view controllers for the Journal List screen, but it just displays a column of cells. In the next chapter, you’re going to implement the model objects for the Journal List screen so it can display a list of journal entries. To do this, you will create structures to store data and provide it to the <code class="inlineCode">JournalListViewController</code> instance so that it may be displayed by the table view on the Journal List screen.</p>
    <h1 id="_idParaDest-205" class="heading-1">Join us on Discord!</h1>
    <p class="normal">Read this book alongside other users, experts, and the author himself. Ask questions, provide solutions to other readers, chat with the author via Ask Me Anything sessions, and much more. Scan the QR code or visit the link to join the community.</p>
    <p class="normal"><a href="https://packt.link/ios-Swift%0D">https://packt.link/ios-Swift</a></p>
    <p class="normal"><a href="https://packt.link/ios-Swift%0D"><img src="img/QR_Code2370024260177612484.png" alt="" width="177" height="177"/></a></p>
  </div>
</div></div></body></html>