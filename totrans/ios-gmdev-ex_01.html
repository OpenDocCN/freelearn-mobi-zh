<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch01"/>Chapter 1. An Introduction to Sprite Kit</h1></div></div></div><p>In this book we will be discussing about iOS game development using Sprite Kit. We will be taking a fun approach and shall make an actual 2D platform game on the iPhone in the process. We are going to develop a 2D (two dimensional) game; a game which relies on only two coordinates. Some famous 2D games include <em>Mario</em>, <em>Hill Climb Racing</em>, <em>Angry Birds</em>, <em>Cut the Rope</em>, and so on.</p><p>A 2D game only deals with two dimensions along <em>x</em> and <em>y</em> axes (left/right and up/down) but not along the <em>z</em> axis (forward/backward). So basically, players cannot rotate or move the camera freely in a 3D space to view objects from other angles and perspectives. Although there are exceptions such as 2.5D games; we will be talking about that in later chapters. So, let's not keep things waiting and dive into the book.</p><div><div><div><div><h1 class="title"><a id="ch01lvl1sec08"/>What's new in iOS 8?</h1></div></div></div><p>You might be<a id="id0" class="indexterm"/> familiar with Apple's mobile operating system, popularly known as iOS; the latest version of this operating system is iOS 8. This version has a lot of new additions over its predecessor, iOS 7. Some of the additions in this version are the introduction of the Swift programming language, loads of new API's, and most importantly, improvements in Sprite Kit and its peripheral frameworks.</p><p>In this book, we will be using the Swift programming language over Objective-C. Although, you can use Sprite Kit with either Objective-C or Swift, Swift offers much easier syntax, and has a simpler learning curve.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Getting to know Swift</h1></div></div></div><p>Swift <a id="id1" class="indexterm"/>is Apple's entirely new multi-paradigm programming language for developing applications on Apple devices. Swift has been in development for 4 years, and was announced in 2014 at the <a id="id2" class="indexterm"/>
<strong>Worldwide Developer Conference</strong> (<strong>WWDC</strong>). Swift is both, a scripting and programming language; it has the ability to return multiple return values. Swift takes different constructs that are loved from many languages including Objective-C, Rust, Haskell, Ruby, Python, C#, CLU, and more. It has type safety feature that is, to prevent you passing string as <code class="literal">int</code> thus minimizing possible errors in your code.</p><p>We will be discussing more about Swift, as and when required, in the further topics covered.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Getting to know Sprite Kit</h1></div></div></div><p>Sprite Kit<a id="id3" class="indexterm"/> is a framework from Apple, meant for developing 2D games for iOS devices. It is one of the best ways to make games for iOS devices. It is easy to learn, powerful and fully supported by Apple, which makes it more reliable to use than third-party game development engines.</p><p>Sprite Kit was introduced in iOS 7 and allowed easy, fast game development; it has similarities with Cocos2d, which is a popular library for game development. If you are somewhat familiar with Cocos2d, Sprite Kit will be a breeze for you.</p><p>Sprite Kit provides various functionalities that are useful for games, such as graphics rendering, animation utilities, sound playback, a particle system, and physics simulation. In Sprite Kit, every node will have a property name and physics body, which can consist of arbitrary shapes such as rectangles, polygons, circles, paths, and so on. Sprite Kit provides a richer particle system, where any aspect can be changed by code during the animation. In Sprite Kit's particle system, you can also add custom actions to the particles created. In addition, Xcode provides built-in support for Sprite Kit so that you can create complex special effects and texture atlases directly in Xcode. This combination of framework and tools makes Sprite Kit a good choice for games and other apps that require similar kinds of animation.</p><p>Because Sprite Kit supports a rich rendering infrastructure, and handles all of the low-level work to submit drawing commands to OpenGL, you can focus your efforts on solving higher-level design problems and creating your game functionality.</p><p>As Sprite Kit is a native framework of iOS, it provides in-built support for using the particle effects, texture effects, and physics simulations. The performance of Sprite Kit is better than other third-party frameworks/gaming engines, as it is a native framework.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Advantages of Sprite Kit</h1></div></div></div><p>The main advantage<a id="id4" class="indexterm"/> of Sprite Kit is that it's built into iOS. There is no need to download any other third-party libraries or depend on external resources to develop 2D games. Other iOS APIs such as, iAd, In-App purchases, and so on, can be easily used without banking on extra plugins. You don't have to get familiar with any new programming language, the languages supported for Sprite Kit can also be used for app development on iOS. The best thing of all is that it is free, you get all the functionalities of Sprite Kit at no cost. You can run your game on both Mac and iOS without much effort, all you need to do is change its controls.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Elements of Sprite Kit</h1></div></div></div><p>Now we are going to <a id="id5" class="indexterm"/>discuss some elements of Sprite Kit, which are essential for game development. A game made in Sprite Kit consists of many scenes which are made of nodes, and the functioning of a node in a scene is determined by actions.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec08"/>Scenes</h2></div></div></div><p>A level or environment in a <a id="id6" class="indexterm"/>game is termed as a <a id="id7" class="indexterm"/>scene. We make scenes as per our requirement, such as menus, levels, and so on. So, there are different scenes for different levels and also for different menus in a game. It's like a canvas where you position your elements.</p><p>A scene in Sprite Kit is represented by an <code class="literal">SKScene</code> object. A scene holds sprites and other contents to be rendered. To switch scenes, we can use the <code class="literal">SKTransition</code> class.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec09"/>Nodes</h2></div></div></div><p>Nodes <a id="id8" class="indexterm"/>are fundamental<a id="id9" class="indexterm"/> building blocks for all content in a scene. The <code class="literal">SKScene</code> class is a descendant of the <code class="literal">SKNode</code> class, so a scene is a root node. The <code class="literal">SKNode</code> class does not draw anything on scene by itself; we can think of it as a base class for other node classes. There are node subclasses as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">SKSpriteNode</code>: This can <a id="id10" class="indexterm"/>be used for drawing textured sprites, playing video content, and more</li><li class="listitem" style="list-style-type: disc"><code class="literal">SK3DNode</code>: This<a id="id11" class="indexterm"/> can be used for rendering a Scene Kit scene as a 2D textured image</li><li class="listitem" style="list-style-type: disc"><code class="literal">SKVideoNode</code>: This can <a id="id12" class="indexterm"/>be used for playing video content</li><li class="listitem" style="list-style-type: disc"><code class="literal">SKLabelNode</code>: This can be<a id="id13" class="indexterm"/> used for rendering a text<a id="id14" class="indexterm"/> string</li><li class="listitem" style="list-style-type: disc"><code class="literal">SKShapeNode</code>: This can be <a id="id15" class="indexterm"/>used for rendering shape, based on a core graphics path</li><li class="listitem" style="list-style-type: disc"><code class="literal">SKEmitterNode</code>: This can be<a id="id16" class="indexterm"/> used for creating and rendering particles</li><li class="listitem" style="list-style-type: disc"><code class="literal">SKCropNode</code>: This can be used for<a id="id17" class="indexterm"/> cropping child nodes using a mask</li><li class="listitem" style="list-style-type: disc"><code class="literal">SKEffectNode</code>: This<a id="id18" class="indexterm"/> can be used for applying a core image filter to its child node</li><li class="listitem" style="list-style-type: disc"><code class="literal">SKLightNode</code>: This can be <a id="id19" class="indexterm"/>used for applying lighting and shadows to a scene</li><li class="listitem" style="list-style-type: disc"><code class="literal">SKFieldNode</code>: This can be<a id="id20" class="indexterm"/> used for applying physics effects to a specific portion of the scene</li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec10"/>Actions</h2></div></div></div><p>An action <a id="id21" class="indexterm"/>tells a node<a id="id22" class="indexterm"/> what to do and allows you to perform different things, such as:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Moving nodes in any direction</li><li class="listitem" style="list-style-type: disc">Making any node follow a path</li><li class="listitem" style="list-style-type: disc">Rotating nodes</li><li class="listitem" style="list-style-type: disc">Scaling of nodes</li><li class="listitem" style="list-style-type: disc">Showing or hiding a node</li><li class="listitem" style="list-style-type: disc">Changing the content of a sprite node</li><li class="listitem" style="list-style-type: disc">Playing sound</li><li class="listitem" style="list-style-type: disc">Removing nodes from a scene</li><li class="listitem" style="list-style-type: disc">Performing action on a child's node, and so on</li></ul></div><p> To create a run action, first, create<a id="id23" class="indexterm"/> the action using the particular action class, configure the properties for the created action, and call a run action by passing action object as a parameter. When the scene processes the node, the actions of that particular node will be executed.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Features of Sprite Kit</h1></div></div></div><p>Sprite Kit provides <a id="id24" class="indexterm"/>many features to facilitate the development of a game. These features<a id="id25" class="indexterm"/> can be used for enhancing the experience as well as performance of the game. Let's discuss them in brief.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec11"/>Particle editor</h2></div></div></div><p>This feature was<a id="id26" class="indexterm"/> introduced<a id="id27" class="indexterm"/> in iOS 7. Particle editor is used to add special effects in a game, like adding a mist effect in a game scene. Here, we can customize many things, such as:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The number of particles</li><li class="listitem" style="list-style-type: disc">Limit of particles allowed</li><li class="listitem" style="list-style-type: disc">The color of particles</li><li class="listitem" style="list-style-type: disc">The size of a particle</li><li class="listitem" style="list-style-type: disc">The life of a particle</li><li class="listitem" style="list-style-type: disc">The location of a particle in a scene, and so on</li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec12"/>Texture atlas generator</h2></div></div></div><p>Texture atlas <a id="id28" class="indexterm"/>generator combines all image files into one or more<a id="id29" class="indexterm"/> large images, in order to improve performance. We will discuss this in detail in the later chapters. It is recommended to use a lesser number of images to reduce draw calls (number of images rendering on a scene).</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec13"/>Shaders</h2></div></div></div><p>Shaders <a id="id30" class="indexterm"/>were introduced in iOS 8. They are used to produce a variety of special <a id="id31" class="indexterm"/>effects; they calculate rendering effects on graphic hardware with a high degree of flexibility, for example, we have seen ripple effects in many apps/games. Wherever a user touches the screen, a ripple effect will be produced.</p><p>In Sprite Kit, shaders are represented by the <code class="literal">SKShaderNode</code> class object.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec14"/>Lighting and shadows</h2></div></div></div><p>Lighting<a id="id32" class="indexterm"/> and <a id="id33" class="indexterm"/>shadows were introduced in iOS 8. These effects are<a id="id34" class="indexterm"/> produced<a id="id35" class="indexterm"/> using the <code class="literal">SKLightNode</code> class object. The <code class="literal">SKLightNode</code> object can:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Spread a lighting effect at any desirable position on the scene</li><li class="listitem" style="list-style-type: disc">Add lighting in any sprite</li><li class="listitem" style="list-style-type: disc">Support colors and shadows</li></ul></div><p>It's just a type <code class="literal">SKNode,</code> so we can apply any property that we apply to any <code class="literal">SKNode</code>.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec15"/>Physics</h2></div></div></div><p>Simulating <a id="id36" class="indexterm"/>physics in Sprite Kit can be achieved by adding physics bodies to the scenes. A physics <a id="id37" class="indexterm"/>engine has the sole purpose of moving objects around in a simulated world. The physics bodies take the properties of objects, such as mass, shape material, current trajectory, and so on, and calculate a new position for all those objects.</p><p>Every object on the Sprite Kit game scene will have a physics body. A physics body object is connected to a node on the node tree of a particular scene. The scene will simulate the effect of forces and collisions on those particular physics bodies that are connected to the node tree, whenever the scene computes a new frame of animation. We can apply a particular physics property on those nodes using their particular physics properties such as gravity, mass, force, friction, and so on.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec16"/>The game loop</h2></div></div></div><p>Following is a <a id="id38" class="indexterm"/>frame life <a id="id39" class="indexterm"/>cycle diagram:</p><div><img src="img/4201_01_01.jpg" alt="The game loop"/></div><p>At the start, the update function is called to where we set up the logic of the game. After that, the scene evaluates the actions. After the actions are evaluated, we get a callback. After that, we set up physics, if any. When the physics simulation is finished, we get another call with <code class="literal">didSimulatePhysics</code>. Then, we apply constraint and get another callback, <code class="literal">didApplyConstraints</code>. The last callback method is <code class="literal">didFinishUpdate</code>; we get it just before frame is completed and view is ready to render. Finally <code class="literal">SKView</code> renders the scene; the frame is complete and it continues 60 times per second.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec14"/>Setting up a project</h1></div></div></div><p>We have discussed many <a id="id40" class="indexterm"/>things about Sprite Kit, now it's time to see a project in action and gain some practical knowledge.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec17"/>The Hello World project</h2></div></div></div><p>We'll need to create<a id="id41" class="indexterm"/> a new project to build <code class="literal">Hello World</code>. An Xcode project organizes everything your app needs into one convenient place. Let's begin by creating a brand new game project in Xcode by carrying out either of the first two points, and then continuing as shown in the list:</p><div><ol class="orderedlist arabic"><li class="listitem">Click on <strong>Create a new Xcode project</strong> on the welcome screen:<div><img src="img/B04201_01_02.jpg" alt="The Hello World project"/></div></li><li class="listitem">Instead, you can also select <strong>File</strong> | <strong>New</strong> | <strong>Project…</strong> from the file menu:<div><img src="img/B04201_01_03.jpg" alt="The Hello World project"/></div></li><li class="listitem">Select <strong>Game</strong> from <a id="id42" class="indexterm"/>the new project selection window:<div><img src="img/B04201_01_04.jpg" alt="The Hello World project"/></div></li><li class="listitem">The next window <a id="id43" class="indexterm"/>asks you to customize options for your project. Fill out the fields as shown in the following screenshot:<div><img src="img/B04201_01_05.jpg" alt="The Hello World project"/></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Product Name</strong>: It is the name of the game</li><li class="listitem" style="list-style-type: disc"><strong>Organization Name</strong>: If you are an individual, then your name, or the name of the organization</li><li class="listitem" style="list-style-type: disc"><strong>Organization Identifier</strong>: A<a id="id44" class="indexterm"/> unique identifier of your organization</li><li class="listitem" style="list-style-type: disc"><strong>Bundle Identifier</strong>: It is a default ID generated automatically using organization identifier and product name.</li><li class="listitem" style="list-style-type: disc"><strong>Language</strong>: The programming language you are using, that is, Objective-C or Swift</li><li class="listitem" style="list-style-type: disc"><strong>Game Technology</strong>: The game framework being used, like Scene Kit, Sprite Kit, Metal, and so on</li><li class="listitem" style="list-style-type: disc"><strong>Devices</strong>: The devices you want your game to run on; iPad, iPhone, or both</li><li class="listitem" style="list-style-type: disc">These fields can be anything you want</li></ul></div></li><li class="listitem">Press <strong>Next</strong> and Xcode will ask where to save your new project. Choose a directory and then click on <strong>Create</strong>.</li><li class="listitem">After saving, it should open Xcode to your brand new <code class="literal">Hello World</code> project, specifically to the project properties screen. On this screen, unselect the <strong>Portrait</strong> option under <strong>Device Orientation</strong>. This file will be automatically saved, so you won't <a id="id45" class="indexterm"/>have to do anything further:<div><img src="img/B04201_01_06.jpg" alt="The Hello World project"/></div></li></ol></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec15"/>Result</h1></div></div></div><p>Run the default <a id="id46" class="indexterm"/>game project by pressing <em>⌘</em> + <em>R</em> on your keyboard, or by clicking on the little play button in the top left corner. If a simulator isn't present, Xcode will <a id="id47" class="indexterm"/>download one for you before launching the app. The result will look as follows:</p><div><img src="img/B04201_01_07.jpg" alt="Result"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec16"/>Summary</h1></div></div></div><p>We also learned how to create a Sprite Kit project and run <code class="literal">Hello World</code> in it.</p><p>In the next chapter, we will be diving deeply into scenes, and also into adding scenes to our <em>Platformer</em> game.</p></div></body></html>